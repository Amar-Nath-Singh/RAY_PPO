{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8536711934022605, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.778624070684115, "policy_loss": -0.006398532548337244, "vf_loss": 9.783490619063377, "vf_explained_var": 0.012007356931765875, "kl": 0.008362284966066606, "entropy": 1.404460330804189, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -42.413292648096416, "episode_reward_min": -1436.9360930799025, "episode_reward_mean": -862.5066754379453, "episode_len_mean": 137.20833333333334, "episode_media": {}, "episodes_timesteps_total": 3293, "policy_reward_min": {"policy_0": -1436.9360930799025}, "policy_reward_max": {"policy_0": -42.413292648096416}, "policy_reward_mean": {"policy_0": -862.5066754379453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1230.587451746233, -1436.9360930799025, -966.2129881461328, -492.0778325320191, -721.4475103562111, -983.4556272006348, -813.8512581997702, -956.5784505923968, -1185.7821143137191, -208.13419007068563, -702.1584582655134, -1155.1320456786339, -42.413292648096416, -324.5303696609079, -1158.432877580369, -1117.8010584317838, -843.2312609394165, -1014.7947845175889, -745.4381101045929, -243.73082394049462, -968.2631664908548, -1173.2253214337602, -1214.8137519704192, -1001.1313726105464], "episode_lengths": [150, 150, 150, 111, 150, 150, 150, 150, 150, 73, 150, 150, 48, 118, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150], "policy_policy_0_reward": [-1230.587451746233, -1436.9360930799025, -966.2129881461328, -492.0778325320191, -721.4475103562111, -983.4556272006348, -813.8512581997702, -956.5784505923968, -1185.7821143137191, -208.13419007068563, -702.1584582655134, -1155.1320456786339, -42.413292648096416, -324.5303696609079, -1158.432877580369, -1117.8010584317838, -843.2312609394165, -1014.7947845175889, -745.4381101045929, -243.73082394049462, -968.2631664908548, -1173.2253214337602, -1214.8137519704192, -1001.1313726105464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5701549502102874, "mean_inference_ms": 1.6707656125129737, "mean_action_processing_ms": 0.28085489023821436, "mean_env_wait_ms": 3.3643928925457325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011537472407023111, "StateBufferConnector_ms": 0.00823835531870524, "ViewRequirementAgentConnector_ms": 0.18215477466583252}, "num_episodes": 24, "episode_return_max": -42.413292648096416, "episode_return_min": -1436.9360930799025, "episode_return_mean": -862.5066754379453, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7497410999955, "num_env_steps_trained_throughput_per_sec": 303.7497410999955, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13168.746, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13168.669, "sample_time_ms": 1146.588, "learn_time_ms": 11938.299, "learn_throughput": 335.056, "synch_weights_time_ms": 82.919}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00009", "date": "2024-08-04_06-18-10", "timestamp": 1722732490, "time_this_iter_s": 13.180806398391724, "time_total_s": 13.180806398391724, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.180806398391724, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.673684210526318, "ram_util_percent": 27.889473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1419283031485974, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.642226195335388, "policy_loss": -0.008596117832348682, "vf_loss": 9.648770981033643, "vf_explained_var": 0.06586772985756398, "kl": 0.010969999333853292, "entropy": 1.4265714798122644, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -42.413292648096416, "episode_reward_min": -1436.9360930799025, "episode_reward_mean": -789.7879097995952, "episode_len_mean": 135.58333333333334, "episode_media": {}, "episodes_timesteps_total": 6508, "policy_reward_min": {"policy_0": -1436.9360930799025}, "policy_reward_max": {"policy_0": -42.413292648096416}, "policy_reward_mean": {"policy_0": -789.7879097995952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1230.587451746233, -1436.9360930799025, -966.2129881461328, -492.0778325320191, -721.4475103562111, -983.4556272006348, -813.8512581997702, -956.5784505923968, -1185.7821143137191, -208.13419007068563, -702.1584582655134, -1155.1320456786339, -42.413292648096416, -324.5303696609079, -1158.432877580369, -1117.8010584317838, -843.2312609394165, -1014.7947845175889, -745.4381101045929, -243.73082394049462, -968.2631664908548, -1173.2253214337602, -1214.8137519704192, -1001.1313726105464, -1295.8174992400407, -352.8378024373138, -211.01497266302732, -416.85342784460033, -956.5727354582048, -1112.904229341655, -1234.1557003355379, -1047.8895342859055, -842.2737551834387, -824.1880786068812, -978.3089607906154, -988.3554000606701, -311.48263933495303, -739.624846641396, -738.4892644447098, -704.5357597646984, -265.5694392508212, -949.9387658614434, -915.9804873757112, -636.6088419251422, -416.763485949598, -770.64660804303, -304.5264000347925, -194.32082499570384], "episode_lengths": [150, 150, 150, 111, 150, 150, 150, 150, 150, 73, 150, 150, 48, 118, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 98, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 143, 150, 100, 150, 142, 142, 150, 150, 96, 83], "policy_policy_0_reward": [-1230.587451746233, -1436.9360930799025, -966.2129881461328, -492.0778325320191, -721.4475103562111, -983.4556272006348, -813.8512581997702, -956.5784505923968, -1185.7821143137191, -208.13419007068563, -702.1584582655134, -1155.1320456786339, -42.413292648096416, -324.5303696609079, -1158.432877580369, -1117.8010584317838, -843.2312609394165, -1014.7947845175889, -745.4381101045929, -243.73082394049462, -968.2631664908548, -1173.2253214337602, -1214.8137519704192, -1001.1313726105464, -1295.8174992400407, -352.8378024373138, -211.01497266302732, -416.85342784460033, -956.5727354582048, -1112.904229341655, -1234.1557003355379, -1047.8895342859055, -842.2737551834387, -824.1880786068812, -978.3089607906154, -988.3554000606701, -311.48263933495303, -739.624846641396, -738.4892644447098, -704.5357597646984, -265.5694392508212, -949.9387658614434, -915.9804873757112, -636.6088419251422, -416.763485949598, -770.64660804303, -304.5264000347925, -194.32082499570384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5681575720637368, "mean_inference_ms": 1.6657973496994776, "mean_action_processing_ms": 0.27941847479858, "mean_env_wait_ms": 3.372549764439144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013655424118041992, "StateBufferConnector_ms": 0.00837246576944987, "ViewRequirementAgentConnector_ms": 0.1836488644282023}, "num_episodes": 24, "episode_return_max": -42.413292648096416, "episode_return_min": -1436.9360930799025, "episode_return_mean": -789.7879097995952, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.6791712742755, "num_env_steps_trained_throughput_per_sec": 394.6791712742755, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11651.786, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11651.714, "sample_time_ms": 1121.705, "learn_time_ms": 10457.726, "learn_throughput": 382.492, "synch_weights_time_ms": 71.42}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00009", "date": "2024-08-04_06-18-20", "timestamp": 1722732500, "time_this_iter_s": 10.145556688308716, "time_total_s": 23.32636308670044, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01423b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.32636308670044, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.89333333333333, "ram_util_percent": 27.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0311794950937232, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.764460883537929, "policy_loss": -0.008719145598782537, "vf_loss": 9.770949540535609, "vf_explained_var": 0.05268026348203421, "kl": 0.011864291815974563, "entropy": 1.4235454821338256, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -18.676796232099967, "episode_reward_min": -1500.6872221292406, "episode_reward_mean": -769.2127819958167, "episode_len_mean": 132.15584415584416, "episode_media": {}, "episodes_timesteps_total": 10176, "policy_reward_min": {"policy_0": -1500.6872221292406}, "policy_reward_max": {"policy_0": -18.676796232099967}, "policy_reward_mean": {"policy_0": -769.2127819958167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1230.587451746233, -1436.9360930799025, -966.2129881461328, -492.0778325320191, -721.4475103562111, -983.4556272006348, -813.8512581997702, -956.5784505923968, -1185.7821143137191, -208.13419007068563, -702.1584582655134, -1155.1320456786339, -42.413292648096416, -324.5303696609079, -1158.432877580369, -1117.8010584317838, -843.2312609394165, -1014.7947845175889, -745.4381101045929, -243.73082394049462, -968.2631664908548, -1173.2253214337602, -1214.8137519704192, -1001.1313726105464, -1295.8174992400407, -352.8378024373138, -211.01497266302732, -416.85342784460033, -956.5727354582048, -1112.904229341655, -1234.1557003355379, -1047.8895342859055, -842.2737551834387, -824.1880786068812, -978.3089607906154, -988.3554000606701, -311.48263933495303, -739.624846641396, -738.4892644447098, -704.5357597646984, -265.5694392508212, -949.9387658614434, -915.9804873757112, -636.6088419251422, -416.763485949598, -770.64660804303, -304.5264000347925, -194.32082499570384, -518.1108455101236, -606.3155293281493, -808.2642178587831, -130.0110411491084, -810.6568130646658, -934.4087740934464, -1069.5346984588846, -235.81246399682104, -611.9778981280404, -23.66480673716571, -1231.2029387439295, -923.7254748690594, -18.676796232099967, -968.6820726476672, -354.03337217754927, -615.4239868350686, -196.91972938786182, -1081.5832260165475, -1500.6872221292406, -153.1044517065224, -637.5826190845851, -554.2795595206616, -990.1661157361506, -1325.8010651630345, -1073.829447639135, -1223.2017935624003, -855.2792505831604, -879.2116178286489, -987.4167151087788], "episode_lengths": [150, 150, 150, 111, 150, 150, 150, 150, 150, 73, 150, 150, 48, 118, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 98, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 143, 150, 100, 150, 142, 142, 150, 150, 96, 83, 146, 150, 150, 53, 150, 150, 150, 69, 150, 43, 150, 150, 34, 150, 87, 146, 61, 150, 150, 68, 150, 111, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1230.587451746233, -1436.9360930799025, -966.2129881461328, -492.0778325320191, -721.4475103562111, -983.4556272006348, -813.8512581997702, -956.5784505923968, -1185.7821143137191, -208.13419007068563, -702.1584582655134, -1155.1320456786339, -42.413292648096416, -324.5303696609079, -1158.432877580369, -1117.8010584317838, -843.2312609394165, -1014.7947845175889, -745.4381101045929, -243.73082394049462, -968.2631664908548, -1173.2253214337602, -1214.8137519704192, -1001.1313726105464, -1295.8174992400407, -352.8378024373138, -211.01497266302732, -416.85342784460033, -956.5727354582048, -1112.904229341655, -1234.1557003355379, -1047.8895342859055, -842.2737551834387, -824.1880786068812, -978.3089607906154, -988.3554000606701, -311.48263933495303, -739.624846641396, -738.4892644447098, -704.5357597646984, -265.5694392508212, -949.9387658614434, -915.9804873757112, -636.6088419251422, -416.763485949598, -770.64660804303, -304.5264000347925, -194.32082499570384, -518.1108455101236, -606.3155293281493, -808.2642178587831, -130.0110411491084, -810.6568130646658, -934.4087740934464, -1069.5346984588846, -235.81246399682104, -611.9778981280404, -23.66480673716571, -1231.2029387439295, -923.7254748690594, -18.676796232099967, -968.6820726476672, -354.03337217754927, -615.4239868350686, -196.91972938786182, -1081.5832260165475, -1500.6872221292406, -153.1044517065224, -637.5826190845851, -554.2795595206616, -990.1661157361506, -1325.8010651630345, -1073.829447639135, -1223.2017935624003, -855.2792505831604, -879.2116178286489, -987.4167151087788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5677286547775732, "mean_inference_ms": 1.670846252482727, "mean_action_processing_ms": 0.27917008441213303, "mean_env_wait_ms": 3.3945942164181666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013326360033704089, "StateBufferConnector_ms": 0.00850813729422433, "ViewRequirementAgentConnector_ms": 0.19773322266417664}, "num_episodes": 29, "episode_return_max": -18.676796232099967, "episode_return_min": -1500.6872221292406, "episode_return_mean": -769.2127819958167, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.1318849501263, "num_env_steps_trained_throughput_per_sec": 300.1318849501263, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12210.352, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12210.284, "sample_time_ms": 1163.331, "learn_time_ms": 10976.536, "learn_throughput": 364.414, "synch_weights_time_ms": 69.566}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00009", "date": "2024-08-04_06-18-34", "timestamp": 1722732514, "time_this_iter_s": 13.337343215942383, "time_total_s": 36.66370630264282, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270e710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.66370630264282, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.089473684210525, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.214401248563081, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.812387885649999, "policy_loss": -0.007113779282857043, "vf_loss": 9.816995789607367, "vf_explained_var": 0.10752377267926931, "kl": 0.013275790179913352, "entropy": 1.4928912245978911, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -18.676796232099967, "episode_reward_min": -1500.6872221292406, "episode_reward_mean": -795.5812636944456, "episode_len_mean": 132.71, "episode_media": {}, "episodes_timesteps_total": 13271, "policy_reward_min": {"policy_0": -1500.6872221292406}, "policy_reward_max": {"policy_0": -18.676796232099967}, "policy_reward_mean": {"policy_0": -795.5812636944456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-208.13419007068563, -702.1584582655134, -1155.1320456786339, -42.413292648096416, -324.5303696609079, -1158.432877580369, -1117.8010584317838, -843.2312609394165, -1014.7947845175889, -745.4381101045929, -243.73082394049462, -968.2631664908548, -1173.2253214337602, -1214.8137519704192, -1001.1313726105464, -1295.8174992400407, -352.8378024373138, -211.01497266302732, -416.85342784460033, -956.5727354582048, -1112.904229341655, -1234.1557003355379, -1047.8895342859055, -842.2737551834387, -824.1880786068812, -978.3089607906154, -988.3554000606701, -311.48263933495303, -739.624846641396, -738.4892644447098, -704.5357597646984, -265.5694392508212, -949.9387658614434, -915.9804873757112, -636.6088419251422, -416.763485949598, -770.64660804303, -304.5264000347925, -194.32082499570384, -518.1108455101236, -606.3155293281493, -808.2642178587831, -130.0110411491084, -810.6568130646658, -934.4087740934464, -1069.5346984588846, -235.81246399682104, -611.9778981280404, -23.66480673716571, -1231.2029387439295, -923.7254748690594, -18.676796232099967, -968.6820726476672, -354.03337217754927, -615.4239868350686, -196.91972938786182, -1081.5832260165475, -1500.6872221292406, -153.1044517065224, -637.5826190845851, -554.2795595206616, -990.1661157361506, -1325.8010651630345, -1073.829447639135, -1223.2017935624003, -855.2792505831604, -879.2116178286489, -987.4167151087788, -1140.1055392508213, -1217.28556271716, -887.6529942074937, -620.8561223903697, -944.974965002031, -181.57706100350762, -783.7764193853925, -1139.7383024888231, -1371.7998731325604, -988.5146992037559, -100.44701468955857, -161.9741471020979, -1173.7102375316795, -1143.9182884392822, -626.1219100219438, -1059.0023458066153, -1310.523079987741, -1372.8590535727726, -807.1464138802539, -640.1642351620823, -800.0037547261967, -672.032313542592, -179.28875008975993, -872.9566815888426, -818.9556229268288, -1155.5251838345541, -970.2403978577812, -1293.8109553569127, -1111.2554496487985, -1047.5162642629366, -1294.0522204738386, -1227.8856226487476], "episode_lengths": [73, 150, 150, 48, 118, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 98, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 143, 150, 100, 150, 142, 142, 150, 150, 96, 83, 146, 150, 150, 53, 150, 150, 150, 69, 150, 43, 150, 150, 34, 150, 87, 146, 61, 150, 150, 68, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 80, 150, 150, 150, 150, 49, 56, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-208.13419007068563, -702.1584582655134, -1155.1320456786339, -42.413292648096416, -324.5303696609079, -1158.432877580369, -1117.8010584317838, -843.2312609394165, -1014.7947845175889, -745.4381101045929, -243.73082394049462, -968.2631664908548, -1173.2253214337602, -1214.8137519704192, -1001.1313726105464, -1295.8174992400407, -352.8378024373138, -211.01497266302732, -416.85342784460033, -956.5727354582048, -1112.904229341655, -1234.1557003355379, -1047.8895342859055, -842.2737551834387, -824.1880786068812, -978.3089607906154, -988.3554000606701, -311.48263933495303, -739.624846641396, -738.4892644447098, -704.5357597646984, -265.5694392508212, -949.9387658614434, -915.9804873757112, -636.6088419251422, -416.763485949598, -770.64660804303, -304.5264000347925, -194.32082499570384, -518.1108455101236, -606.3155293281493, -808.2642178587831, -130.0110411491084, -810.6568130646658, -934.4087740934464, -1069.5346984588846, -235.81246399682104, -611.9778981280404, -23.66480673716571, -1231.2029387439295, -923.7254748690594, -18.676796232099967, -968.6820726476672, -354.03337217754927, -615.4239868350686, -196.91972938786182, -1081.5832260165475, -1500.6872221292406, -153.1044517065224, -637.5826190845851, -554.2795595206616, -990.1661157361506, -1325.8010651630345, -1073.829447639135, -1223.2017935624003, -855.2792505831604, -879.2116178286489, -987.4167151087788, -1140.1055392508213, -1217.28556271716, -887.6529942074937, -620.8561223903697, -944.974965002031, -181.57706100350762, -783.7764193853925, -1139.7383024888231, -1371.7998731325604, -988.5146992037559, -100.44701468955857, -161.9741471020979, -1173.7102375316795, -1143.9182884392822, -626.1219100219438, -1059.0023458066153, -1310.523079987741, -1372.8590535727726, -807.1464138802539, -640.1642351620823, -800.0037547261967, -672.032313542592, -179.28875008975993, -872.9566815888426, -818.9556229268288, -1155.5251838345541, -970.2403978577812, -1293.8109553569127, -1111.2554496487985, -1047.5162642629366, -1294.0522204738386, -1227.8856226487476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5654344729832892, "mean_inference_ms": 1.6744300407497132, "mean_action_processing_ms": 0.2794010288425561, "mean_env_wait_ms": 3.411691848339031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013367414474487305, "StateBufferConnector_ms": 0.008591651916503906, "ViewRequirementAgentConnector_ms": 0.19489502906799316}, "num_episodes": 32, "episode_return_max": -18.676796232099967, "episode_return_min": -1500.6872221292406, "episode_return_mean": -795.5812636944456, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.93485971401094, "num_env_steps_trained_throughput_per_sec": 299.93485971401094, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12491.824, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12491.757, "sample_time_ms": 1172.531, "learn_time_ms": 11248.348, "learn_throughput": 355.608, "synch_weights_time_ms": 70.033}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00009", "date": "2024-08-04_06-18-47", "timestamp": 1722732527, "time_this_iter_s": 13.348143339157104, "time_total_s": 50.01184964179993, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270c5e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.01184964179993, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.068421052631578, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6698424079765877, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.435218676924706, "policy_loss": -0.010354662121487005, "vf_loss": 9.44256356259187, "vf_explained_var": 0.15516830639292797, "kl": 0.01576511003171012, "entropy": 1.4326736353337766, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -12.815395673946211, "episode_reward_min": -1500.6872221292406, "episode_reward_mean": -785.639693233662, "episode_len_mean": 132.05, "episode_media": {}, "episodes_timesteps_total": 13205, "policy_reward_min": {"policy_0": -1500.6872221292406}, "policy_reward_max": {"policy_0": -12.815395673946211}, "policy_reward_mean": {"policy_0": -785.639693233662}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-265.5694392508212, -949.9387658614434, -915.9804873757112, -636.6088419251422, -416.763485949598, -770.64660804303, -304.5264000347925, -194.32082499570384, -518.1108455101236, -606.3155293281493, -808.2642178587831, -130.0110411491084, -810.6568130646658, -934.4087740934464, -1069.5346984588846, -235.81246399682104, -611.9778981280404, -23.66480673716571, -1231.2029387439295, -923.7254748690594, -18.676796232099967, -968.6820726476672, -354.03337217754927, -615.4239868350686, -196.91972938786182, -1081.5832260165475, -1500.6872221292406, -153.1044517065224, -637.5826190845851, -554.2795595206616, -990.1661157361506, -1325.8010651630345, -1073.829447639135, -1223.2017935624003, -855.2792505831604, -879.2116178286489, -987.4167151087788, -1140.1055392508213, -1217.28556271716, -887.6529942074937, -620.8561223903697, -944.974965002031, -181.57706100350762, -783.7764193853925, -1139.7383024888231, -1371.7998731325604, -988.5146992037559, -100.44701468955857, -161.9741471020979, -1173.7102375316795, -1143.9182884392822, -626.1219100219438, -1059.0023458066153, -1310.523079987741, -1372.8590535727726, -807.1464138802539, -640.1642351620823, -800.0037547261967, -672.032313542592, -179.28875008975993, -872.9566815888426, -818.9556229268288, -1155.5251838345541, -970.2403978577812, -1293.8109553569127, -1111.2554496487985, -1047.5162642629366, -1294.0522204738386, -1227.8856226487476, -1043.8741988662405, -1142.8020148507787, -751.4000065905468, -1139.1896801360635, -1040.0024166045787, -317.90301356314956, -1124.9851907140492, -764.0106067735495, -1195.7102798319286, -844.4528840717026, -704.1931761193887, -506.8988003939914, -1205.5206284336552, -412.6714958367019, -878.2610243508224, -477.42292130987744, -141.6675294754246, -736.8885926031891, -970.2589238706611, -154.67573212899444, -1093.7422101414631, -444.7532993098984, -861.6108725499215, -923.2211944609861, -684.9997449500335, -395.8961507872266, -1179.7264061502049, -420.78448741670854, -1174.5768136256675, -929.4627531075885, -12.815395673946211], "episode_lengths": [100, 150, 142, 142, 150, 150, 96, 83, 146, 150, 150, 53, 150, 150, 150, 69, 150, 43, 150, 150, 34, 150, 87, 146, 61, 150, 150, 68, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 80, 150, 150, 150, 150, 49, 56, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 137, 150, 97, 150, 135, 50, 149, 150, 90, 150, 122, 150, 150, 150, 104, 150, 111, 150, 150, 33], "policy_policy_0_reward": [-265.5694392508212, -949.9387658614434, -915.9804873757112, -636.6088419251422, -416.763485949598, -770.64660804303, -304.5264000347925, -194.32082499570384, -518.1108455101236, -606.3155293281493, -808.2642178587831, -130.0110411491084, -810.6568130646658, -934.4087740934464, -1069.5346984588846, -235.81246399682104, -611.9778981280404, -23.66480673716571, -1231.2029387439295, -923.7254748690594, -18.676796232099967, -968.6820726476672, -354.03337217754927, -615.4239868350686, -196.91972938786182, -1081.5832260165475, -1500.6872221292406, -153.1044517065224, -637.5826190845851, -554.2795595206616, -990.1661157361506, -1325.8010651630345, -1073.829447639135, -1223.2017935624003, -855.2792505831604, -879.2116178286489, -987.4167151087788, -1140.1055392508213, -1217.28556271716, -887.6529942074937, -620.8561223903697, -944.974965002031, -181.57706100350762, -783.7764193853925, -1139.7383024888231, -1371.7998731325604, -988.5146992037559, -100.44701468955857, -161.9741471020979, -1173.7102375316795, -1143.9182884392822, -626.1219100219438, -1059.0023458066153, -1310.523079987741, -1372.8590535727726, -807.1464138802539, -640.1642351620823, -800.0037547261967, -672.032313542592, -179.28875008975993, -872.9566815888426, -818.9556229268288, -1155.5251838345541, -970.2403978577812, -1293.8109553569127, -1111.2554496487985, -1047.5162642629366, -1294.0522204738386, -1227.8856226487476, -1043.8741988662405, -1142.8020148507787, -751.4000065905468, -1139.1896801360635, -1040.0024166045787, -317.90301356314956, -1124.9851907140492, -764.0106067735495, -1195.7102798319286, -844.4528840717026, -704.1931761193887, -506.8988003939914, -1205.5206284336552, -412.6714958367019, -878.2610243508224, -477.42292130987744, -141.6675294754246, -736.8885926031891, -970.2589238706611, -154.67573212899444, -1093.7422101414631, -444.7532993098984, -861.6108725499215, -923.2211944609861, -684.9997449500335, -395.8961507872266, -1179.7264061502049, -420.78448741670854, -1174.5768136256675, -929.4627531075885, -12.815395673946211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5643893247251119, "mean_inference_ms": 1.6838095304469058, "mean_action_processing_ms": 0.27994354848088837, "mean_env_wait_ms": 3.436502550996812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013325214385986328, "StateBufferConnector_ms": 0.008701086044311523, "ViewRequirementAgentConnector_ms": 0.1965789794921875}, "num_episodes": 31, "episode_return_max": -12.815395673946211, "episode_return_min": -1500.6872221292406, "episode_return_mean": -785.639693233662, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.914183777599, "num_env_steps_trained_throughput_per_sec": 316.914183777599, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12517.805, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12517.732, "sample_time_ms": 1171.402, "learn_time_ms": 11275.489, "learn_throughput": 354.752, "synch_weights_time_ms": 70.004}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00009", "date": "2024-08-04_06-19-00", "timestamp": 1722732540, "time_this_iter_s": 12.63427472114563, "time_total_s": 62.64612436294556, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.64612436294556, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.711111111111112, "ram_util_percent": 27.994444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.254772500321269, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.45131416618824, "policy_loss": -0.006248537754678788, "vf_loss": 9.455016815662384, "vf_explained_var": 0.20722172011931736, "kl": 0.013449113442190234, "entropy": 1.4391284962495168, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -12.815395673946211, "episode_reward_min": -1441.8626827567368, "episode_reward_mean": -813.2867736787152, "episode_len_mean": 132.11, "episode_media": {}, "episodes_timesteps_total": 13211, "policy_reward_min": {"policy_0": -1441.8626827567368}, "policy_reward_max": {"policy_0": -12.815395673946211}, "policy_reward_mean": {"policy_0": -813.2867736787152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-990.1661157361506, -1325.8010651630345, -1073.829447639135, -1223.2017935624003, -855.2792505831604, -879.2116178286489, -987.4167151087788, -1140.1055392508213, -1217.28556271716, -887.6529942074937, -620.8561223903697, -944.974965002031, -181.57706100350762, -783.7764193853925, -1139.7383024888231, -1371.7998731325604, -988.5146992037559, -100.44701468955857, -161.9741471020979, -1173.7102375316795, -1143.9182884392822, -626.1219100219438, -1059.0023458066153, -1310.523079987741, -1372.8590535727726, -807.1464138802539, -640.1642351620823, -800.0037547261967, -672.032313542592, -179.28875008975993, -872.9566815888426, -818.9556229268288, -1155.5251838345541, -970.2403978577812, -1293.8109553569127, -1111.2554496487985, -1047.5162642629366, -1294.0522204738386, -1227.8856226487476, -1043.8741988662405, -1142.8020148507787, -751.4000065905468, -1139.1896801360635, -1040.0024166045787, -317.90301356314956, -1124.9851907140492, -764.0106067735495, -1195.7102798319286, -844.4528840717026, -704.1931761193887, -506.8988003939914, -1205.5206284336552, -412.6714958367019, -878.2610243508224, -477.42292130987744, -141.6675294754246, -736.8885926031891, -970.2589238706611, -154.67573212899444, -1093.7422101414631, -444.7532993098984, -861.6108725499215, -923.2211944609861, -684.9997449500335, -395.8961507872266, -1179.7264061502049, -420.78448741670854, -1174.5768136256675, -929.4627531075885, -12.815395673946211, -1134.7914549962627, -806.8720938545453, -1056.655781552643, -1367.9856428220507, -307.736180847709, -296.00332086449333, -223.3626603715942, -45.97702455212591, -1020.8790200961536, -115.37584505994279, -1237.0973685329436, -307.42374532307383, -632.5695580564662, -1186.0617323265478, -651.9413232175536, -165.8751449843491, -915.568548628506, -1033.246078437417, -890.1251741207641, -410.3680688895534, -288.72592696152793, -1322.4788000792532, -1203.8885481634713, -64.6228972617382, -1441.8626827567368, -820.3128791205174, -137.03781211027874, -1048.2068169494462, -948.7889837000298, -121.88032097985239], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 80, 150, 150, 150, 150, 49, 56, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 137, 150, 97, 150, 135, 50, 149, 150, 90, 150, 122, 150, 150, 150, 104, 150, 111, 150, 150, 33, 150, 150, 150, 150, 95, 78, 97, 50, 150, 52, 150, 78, 144, 150, 150, 87, 150, 150, 150, 105, 87, 150, 150, 64, 150, 150, 81, 150, 150, 69], "policy_policy_0_reward": [-990.1661157361506, -1325.8010651630345, -1073.829447639135, -1223.2017935624003, -855.2792505831604, -879.2116178286489, -987.4167151087788, -1140.1055392508213, -1217.28556271716, -887.6529942074937, -620.8561223903697, -944.974965002031, -181.57706100350762, -783.7764193853925, -1139.7383024888231, -1371.7998731325604, -988.5146992037559, -100.44701468955857, -161.9741471020979, -1173.7102375316795, -1143.9182884392822, -626.1219100219438, -1059.0023458066153, -1310.523079987741, -1372.8590535727726, -807.1464138802539, -640.1642351620823, -800.0037547261967, -672.032313542592, -179.28875008975993, -872.9566815888426, -818.9556229268288, -1155.5251838345541, -970.2403978577812, -1293.8109553569127, -1111.2554496487985, -1047.5162642629366, -1294.0522204738386, -1227.8856226487476, -1043.8741988662405, -1142.8020148507787, -751.4000065905468, -1139.1896801360635, -1040.0024166045787, -317.90301356314956, -1124.9851907140492, -764.0106067735495, -1195.7102798319286, -844.4528840717026, -704.1931761193887, -506.8988003939914, -1205.5206284336552, -412.6714958367019, -878.2610243508224, -477.42292130987744, -141.6675294754246, -736.8885926031891, -970.2589238706611, -154.67573212899444, -1093.7422101414631, -444.7532993098984, -861.6108725499215, -923.2211944609861, -684.9997449500335, -395.8961507872266, -1179.7264061502049, -420.78448741670854, -1174.5768136256675, -929.4627531075885, -12.815395673946211, -1134.7914549962627, -806.8720938545453, -1056.655781552643, -1367.9856428220507, -307.736180847709, -296.00332086449333, -223.3626603715942, -45.97702455212591, -1020.8790200961536, -115.37584505994279, -1237.0973685329436, -307.42374532307383, -632.5695580564662, -1186.0617323265478, -651.9413232175536, -165.8751449843491, -915.568548628506, -1033.246078437417, -890.1251741207641, -410.3680688895534, -288.72592696152793, -1322.4788000792532, -1203.8885481634713, -64.6228972617382, -1441.8626827567368, -820.3128791205174, -137.03781211027874, -1048.2068169494462, -948.7889837000298, -121.88032097985239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630163362053433, "mean_inference_ms": 1.6885527712908424, "mean_action_processing_ms": 0.28086588783917366, "mean_env_wait_ms": 3.4451833783724792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013583898544311523, "StateBufferConnector_ms": 0.00863194465637207, "ViewRequirementAgentConnector_ms": 0.18644237518310547}, "num_episodes": 30, "episode_return_max": -12.815395673946211, "episode_return_min": -1441.8626827567368, "episode_return_mean": -813.2867736787152, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.62952560633335, "num_env_steps_trained_throughput_per_sec": 317.62952560633335, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12530.387, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12530.314, "sample_time_ms": 1163.558, "learn_time_ms": 11296.402, "learn_throughput": 354.095, "synch_weights_time_ms": 69.529}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00009", "date": "2024-08-04_06-19-12", "timestamp": 1722732552, "time_this_iter_s": 12.605890989303589, "time_total_s": 75.25201535224915, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b77f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.25201535224915, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.255555555555556, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.395742297855516, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.6646677116553, "policy_loss": -0.008076534246598991, "vf_loss": 9.66988601088524, "vf_explained_var": 0.20004010784129303, "kl": 0.015007706739106652, "entropy": 1.4328478982051214, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -12.815395673946211, "episode_reward_min": -1441.8626827567368, "episode_reward_mean": -808.5098026448126, "episode_len_mean": 132.31, "episode_media": {}, "episodes_timesteps_total": 13231, "policy_reward_min": {"policy_0": -1441.8626827567368}, "policy_reward_max": {"policy_0": -12.815395673946211}, "policy_reward_mean": {"policy_0": -808.5098026448126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.28875008975993, -872.9566815888426, -818.9556229268288, -1155.5251838345541, -970.2403978577812, -1293.8109553569127, -1111.2554496487985, -1047.5162642629366, -1294.0522204738386, -1227.8856226487476, -1043.8741988662405, -1142.8020148507787, -751.4000065905468, -1139.1896801360635, -1040.0024166045787, -317.90301356314956, -1124.9851907140492, -764.0106067735495, -1195.7102798319286, -844.4528840717026, -704.1931761193887, -506.8988003939914, -1205.5206284336552, -412.6714958367019, -878.2610243508224, -477.42292130987744, -141.6675294754246, -736.8885926031891, -970.2589238706611, -154.67573212899444, -1093.7422101414631, -444.7532993098984, -861.6108725499215, -923.2211944609861, -684.9997449500335, -395.8961507872266, -1179.7264061502049, -420.78448741670854, -1174.5768136256675, -929.4627531075885, -12.815395673946211, -1134.7914549962627, -806.8720938545453, -1056.655781552643, -1367.9856428220507, -307.736180847709, -296.00332086449333, -223.3626603715942, -45.97702455212591, -1020.8790200961536, -115.37584505994279, -1237.0973685329436, -307.42374532307383, -632.5695580564662, -1186.0617323265478, -651.9413232175536, -165.8751449843491, -915.568548628506, -1033.246078437417, -890.1251741207641, -410.3680688895534, -288.72592696152793, -1322.4788000792532, -1203.8885481634713, -64.6228972617382, -1441.8626827567368, -820.3128791205174, -137.03781211027874, -1048.2068169494462, -948.7889837000298, -121.88032097985239, -823.3961693592893, -1195.2625126120938, -1217.0840194509537, -505.10455676655124, -977.2517987666133, -825.8653202432718, -1096.5848249645662, -872.645847050798, -695.1582755736032, -1139.8748217721059, -1153.6903587444142, -1199.593951346077, -223.6820525549009, -1287.3534278298587, -861.2590290273172, -996.6606843725357, -1023.8393538461715, -1216.9861258641536, -431.1998273299016, -115.9641342459603, -1013.0277946057303, -1080.356877364514, -1260.2955886822956, -1087.3256799672267, -964.7749027455612, -115.25967403178839, -669.6299293662391, -732.6428731780339, -1219.622823813244], "episode_lengths": [68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 137, 150, 97, 150, 135, 50, 149, 150, 90, 150, 122, 150, 150, 150, 104, 150, 111, 150, 150, 33, 150, 150, 150, 150, 95, 78, 97, 50, 150, 52, 150, 78, 144, 150, 150, 87, 150, 150, 150, 105, 87, 150, 150, 64, 150, 150, 81, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 96, 65, 150, 150, 150, 150, 150, 74, 150, 150, 150], "policy_policy_0_reward": [-179.28875008975993, -872.9566815888426, -818.9556229268288, -1155.5251838345541, -970.2403978577812, -1293.8109553569127, -1111.2554496487985, -1047.5162642629366, -1294.0522204738386, -1227.8856226487476, -1043.8741988662405, -1142.8020148507787, -751.4000065905468, -1139.1896801360635, -1040.0024166045787, -317.90301356314956, -1124.9851907140492, -764.0106067735495, -1195.7102798319286, -844.4528840717026, -704.1931761193887, -506.8988003939914, -1205.5206284336552, -412.6714958367019, -878.2610243508224, -477.42292130987744, -141.6675294754246, -736.8885926031891, -970.2589238706611, -154.67573212899444, -1093.7422101414631, -444.7532993098984, -861.6108725499215, -923.2211944609861, -684.9997449500335, -395.8961507872266, -1179.7264061502049, -420.78448741670854, -1174.5768136256675, -929.4627531075885, -12.815395673946211, -1134.7914549962627, -806.8720938545453, -1056.655781552643, -1367.9856428220507, -307.736180847709, -296.00332086449333, -223.3626603715942, -45.97702455212591, -1020.8790200961536, -115.37584505994279, -1237.0973685329436, -307.42374532307383, -632.5695580564662, -1186.0617323265478, -651.9413232175536, -165.8751449843491, -915.568548628506, -1033.246078437417, -890.1251741207641, -410.3680688895534, -288.72592696152793, -1322.4788000792532, -1203.8885481634713, -64.6228972617382, -1441.8626827567368, -820.3128791205174, -137.03781211027874, -1048.2068169494462, -948.7889837000298, -121.88032097985239, -823.3961693592893, -1195.2625126120938, -1217.0840194509537, -505.10455676655124, -977.2517987666133, -825.8653202432718, -1096.5848249645662, -872.645847050798, -695.1582755736032, -1139.8748217721059, -1153.6903587444142, -1199.593951346077, -223.6820525549009, -1287.3534278298587, -861.2590290273172, -996.6606843725357, -1023.8393538461715, -1216.9861258641536, -431.1998273299016, -115.9641342459603, -1013.0277946057303, -1080.356877364514, -1260.2955886822956, -1087.3256799672267, -964.7749027455612, -115.25967403178839, -669.6299293662391, -732.6428731780339, -1219.622823813244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623750248323917, "mean_inference_ms": 1.6884574514922988, "mean_action_processing_ms": 0.28039944691067664, "mean_env_wait_ms": 3.4491955361931197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013422250747680664, "StateBufferConnector_ms": 0.008363723754882812, "ViewRequirementAgentConnector_ms": 0.18661999702453613}, "num_episodes": 29, "episode_return_max": -12.815395673946211, "episode_return_min": -1441.8626827567368, "episode_return_mean": -808.5098026448126, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.7057052944895, "num_env_steps_trained_throughput_per_sec": 308.7057052944895, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12591.38, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12591.308, "sample_time_ms": 1159.827, "learn_time_ms": 11361.793, "learn_throughput": 352.057, "synch_weights_time_ms": 68.874}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00009", "date": "2024-08-04_06-19-25", "timestamp": 1722732565, "time_this_iter_s": 12.967942714691162, "time_total_s": 88.21995806694031, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b7760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.21995806694031, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.222222222222225, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.619313874654472, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.548214900493623, "policy_loss": -0.0048047888243066455, "vf_loss": 9.549748738606771, "vf_explained_var": 0.3447586992134651, "kl": 0.01700379096031006, "entropy": 1.2982858508825301, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -12.815395673946211, "episode_reward_min": -1441.8626827567368, "episode_reward_mean": -746.6569255508656, "episode_len_mean": 128.75, "episode_media": {}, "episodes_timesteps_total": 12875, "policy_reward_min": {"policy_0": -1441.8626827567368}, "policy_reward_max": {"policy_0": -12.815395673946211}, "policy_reward_mean": {"policy_0": -746.6569255508656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-861.6108725499215, -923.2211944609861, -684.9997449500335, -395.8961507872266, -1179.7264061502049, -420.78448741670854, -1174.5768136256675, -929.4627531075885, -12.815395673946211, -1134.7914549962627, -806.8720938545453, -1056.655781552643, -1367.9856428220507, -307.736180847709, -296.00332086449333, -223.3626603715942, -45.97702455212591, -1020.8790200961536, -115.37584505994279, -1237.0973685329436, -307.42374532307383, -632.5695580564662, -1186.0617323265478, -651.9413232175536, -165.8751449843491, -915.568548628506, -1033.246078437417, -890.1251741207641, -410.3680688895534, -288.72592696152793, -1322.4788000792532, -1203.8885481634713, -64.6228972617382, -1441.8626827567368, -820.3128791205174, -137.03781211027874, -1048.2068169494462, -948.7889837000298, -121.88032097985239, -823.3961693592893, -1195.2625126120938, -1217.0840194509537, -505.10455676655124, -977.2517987666133, -825.8653202432718, -1096.5848249645662, -872.645847050798, -695.1582755736032, -1139.8748217721059, -1153.6903587444142, -1199.593951346077, -223.6820525549009, -1287.3534278298587, -861.2590290273172, -996.6606843725357, -1023.8393538461715, -1216.9861258641536, -431.1998273299016, -115.9641342459603, -1013.0277946057303, -1080.356877364514, -1260.2955886822956, -1087.3256799672267, -964.7749027455612, -115.25967403178839, -669.6299293662391, -732.6428731780339, -1219.622823813244, -137.48382788421878, -296.50619496668475, -1022.9275007582996, -401.5798574615793, -926.7243727139329, -464.84499166120827, -964.6584729486211, -1016.2590251639714, -819.8333861241646, -698.4091629164718, -49.120795344758605, -123.67486617353367, -243.7073623437304, -1150.3566263268328, -380.6978979274492, -542.9030938403444, -253.1848238832676, -1020.8414544225543, -788.62739290193, -719.9143953678188, -1108.4199885352002, -315.8282865732902, -440.9311998789786, -1003.8005577373038, -737.9173334203292, -467.14714687766394, -1138.5009707734287, -1007.427010441631, -672.7316745942572, -195.64652697460969, -868.1052246978395, -898.7726436350605], "episode_lengths": [150, 150, 150, 104, 150, 111, 150, 150, 33, 150, 150, 150, 150, 95, 78, 97, 50, 150, 52, 150, 78, 144, 150, 150, 87, 150, 150, 150, 105, 87, 150, 150, 64, 150, 150, 81, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 96, 65, 150, 150, 150, 150, 150, 74, 150, 150, 150, 69, 81, 150, 150, 150, 113, 150, 150, 150, 150, 56, 76, 76, 150, 111, 150, 69, 150, 150, 150, 150, 88, 109, 150, 150, 114, 150, 150, 150, 70, 150, 150], "policy_policy_0_reward": [-861.6108725499215, -923.2211944609861, -684.9997449500335, -395.8961507872266, -1179.7264061502049, -420.78448741670854, -1174.5768136256675, -929.4627531075885, -12.815395673946211, -1134.7914549962627, -806.8720938545453, -1056.655781552643, -1367.9856428220507, -307.736180847709, -296.00332086449333, -223.3626603715942, -45.97702455212591, -1020.8790200961536, -115.37584505994279, -1237.0973685329436, -307.42374532307383, -632.5695580564662, -1186.0617323265478, -651.9413232175536, -165.8751449843491, -915.568548628506, -1033.246078437417, -890.1251741207641, -410.3680688895534, -288.72592696152793, -1322.4788000792532, -1203.8885481634713, -64.6228972617382, -1441.8626827567368, -820.3128791205174, -137.03781211027874, -1048.2068169494462, -948.7889837000298, -121.88032097985239, -823.3961693592893, -1195.2625126120938, -1217.0840194509537, -505.10455676655124, -977.2517987666133, -825.8653202432718, -1096.5848249645662, -872.645847050798, -695.1582755736032, -1139.8748217721059, -1153.6903587444142, -1199.593951346077, -223.6820525549009, -1287.3534278298587, -861.2590290273172, -996.6606843725357, -1023.8393538461715, -1216.9861258641536, -431.1998273299016, -115.9641342459603, -1013.0277946057303, -1080.356877364514, -1260.2955886822956, -1087.3256799672267, -964.7749027455612, -115.25967403178839, -669.6299293662391, -732.6428731780339, -1219.622823813244, -137.48382788421878, -296.50619496668475, -1022.9275007582996, -401.5798574615793, -926.7243727139329, -464.84499166120827, -964.6584729486211, -1016.2590251639714, -819.8333861241646, -698.4091629164718, -49.120795344758605, -123.67486617353367, -243.7073623437304, -1150.3566263268328, -380.6978979274492, -542.9030938403444, -253.1848238832676, -1020.8414544225543, -788.62739290193, -719.9143953678188, -1108.4199885352002, -315.8282865732902, -440.9311998789786, -1003.8005577373038, -737.9173334203292, -467.14714687766394, -1138.5009707734287, -1007.427010441631, -672.7316745942572, -195.64652697460969, -868.1052246978395, -898.7726436350605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613508173819128, "mean_inference_ms": 1.6821111052885387, "mean_action_processing_ms": 0.2796835028748458, "mean_env_wait_ms": 3.440348404379372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012602806091308594, "StateBufferConnector_ms": 0.008078813552856445, "ViewRequirementAgentConnector_ms": 0.1858978271484375}, "num_episodes": 32, "episode_return_max": -12.815395673946211, "episode_return_min": -1441.8626827567368, "episode_return_mean": -746.6569255508656, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.7464763249721, "num_env_steps_trained_throughput_per_sec": 305.7464763249721, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12652.801, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12652.728, "sample_time_ms": 1154.757, "learn_time_ms": 11428.164, "learn_throughput": 350.012, "synch_weights_time_ms": 68.99}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00009", "date": "2024-08-04_06-19-38", "timestamp": 1722732578, "time_this_iter_s": 13.093512535095215, "time_total_s": 101.31347060203552, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b71c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.31347060203552, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.16842105263158, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.997462470519046, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.305434255798657, "policy_loss": -0.013823782520679137, "vf_loss": 9.315554520487785, "vf_explained_var": 0.2939176520332694, "kl": 0.019266325673152097, "entropy": 1.4979543248812357, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -11.008200405374902, "episode_reward_min": -1470.4375925076595, "episode_reward_mean": -766.0833070197264, "episode_len_mean": 129.34, "episode_media": {}, "episodes_timesteps_total": 12934, "policy_reward_min": {"policy_0": -1470.4375925076595}, "policy_reward_max": {"policy_0": -11.008200405374902}, "policy_reward_mean": {"policy_0": -766.0833070197264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.6228972617382, -1441.8626827567368, -820.3128791205174, -137.03781211027874, -1048.2068169494462, -948.7889837000298, -121.88032097985239, -823.3961693592893, -1195.2625126120938, -1217.0840194509537, -505.10455676655124, -977.2517987666133, -825.8653202432718, -1096.5848249645662, -872.645847050798, -695.1582755736032, -1139.8748217721059, -1153.6903587444142, -1199.593951346077, -223.6820525549009, -1287.3534278298587, -861.2590290273172, -996.6606843725357, -1023.8393538461715, -1216.9861258641536, -431.1998273299016, -115.9641342459603, -1013.0277946057303, -1080.356877364514, -1260.2955886822956, -1087.3256799672267, -964.7749027455612, -115.25967403178839, -669.6299293662391, -732.6428731780339, -1219.622823813244, -137.48382788421878, -296.50619496668475, -1022.9275007582996, -401.5798574615793, -926.7243727139329, -464.84499166120827, -964.6584729486211, -1016.2590251639714, -819.8333861241646, -698.4091629164718, -49.120795344758605, -123.67486617353367, -243.7073623437304, -1150.3566263268328, -380.6978979274492, -542.9030938403444, -253.1848238832676, -1020.8414544225543, -788.62739290193, -719.9143953678188, -1108.4199885352002, -315.8282865732902, -440.9311998789786, -1003.8005577373038, -737.9173334203292, -467.14714687766394, -1138.5009707734287, -1007.427010441631, -672.7316745942572, -195.64652697460969, -868.1052246978395, -898.7726436350605, -1142.229290989111, -567.8320577445211, -1470.4375925076595, -652.1855468961063, -98.32972007666409, -963.7278525107043, -689.6594296486722, -224.157692872685, -11.008200405374902, -1055.2804466401358, -1075.1779464044448, -930.2582233186536, -75.21612155633896, -814.8008374993884, -743.2441671694879, -751.8475891115196, -798.361864171065, -1385.9560515048415, -1128.1435000551899, -1044.5213343564667, -358.1268065150222, -978.720598589813, -16.386271865116647, -1114.1867274952576, -143.67983471978732, -1280.3221735462787, -467.1147430471947, -1020.2523229081033, -216.32830777044742, -1439.1851271559378, -1348.1862848411643, -1141.8763444541219], "episode_lengths": [64, 150, 150, 81, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 96, 65, 150, 150, 150, 150, 150, 74, 150, 150, 150, 69, 81, 150, 150, 150, 113, 150, 150, 150, 150, 56, 76, 76, 150, 111, 150, 69, 150, 150, 150, 150, 88, 109, 150, 150, 114, 150, 150, 150, 70, 150, 150, 150, 140, 150, 150, 60, 150, 121, 74, 46, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 98, 150, 47, 150, 53, 150, 113, 150, 69, 150, 150, 150], "policy_policy_0_reward": [-64.6228972617382, -1441.8626827567368, -820.3128791205174, -137.03781211027874, -1048.2068169494462, -948.7889837000298, -121.88032097985239, -823.3961693592893, -1195.2625126120938, -1217.0840194509537, -505.10455676655124, -977.2517987666133, -825.8653202432718, -1096.5848249645662, -872.645847050798, -695.1582755736032, -1139.8748217721059, -1153.6903587444142, -1199.593951346077, -223.6820525549009, -1287.3534278298587, -861.2590290273172, -996.6606843725357, -1023.8393538461715, -1216.9861258641536, -431.1998273299016, -115.9641342459603, -1013.0277946057303, -1080.356877364514, -1260.2955886822956, -1087.3256799672267, -964.7749027455612, -115.25967403178839, -669.6299293662391, -732.6428731780339, -1219.622823813244, -137.48382788421878, -296.50619496668475, -1022.9275007582996, -401.5798574615793, -926.7243727139329, -464.84499166120827, -964.6584729486211, -1016.2590251639714, -819.8333861241646, -698.4091629164718, -49.120795344758605, -123.67486617353367, -243.7073623437304, -1150.3566263268328, -380.6978979274492, -542.9030938403444, -253.1848238832676, -1020.8414544225543, -788.62739290193, -719.9143953678188, -1108.4199885352002, -315.8282865732902, -440.9311998789786, -1003.8005577373038, -737.9173334203292, -467.14714687766394, -1138.5009707734287, -1007.427010441631, -672.7316745942572, -195.64652697460969, -868.1052246978395, -898.7726436350605, -1142.229290989111, -567.8320577445211, -1470.4375925076595, -652.1855468961063, -98.32972007666409, -963.7278525107043, -689.6594296486722, -224.157692872685, -11.008200405374902, -1055.2804466401358, -1075.1779464044448, -930.2582233186536, -75.21612155633896, -814.8008374993884, -743.2441671694879, -751.8475891115196, -798.361864171065, -1385.9560515048415, -1128.1435000551899, -1044.5213343564667, -358.1268065150222, -978.720598589813, -16.386271865116647, -1114.1867274952576, -143.67983471978732, -1280.3221735462787, -467.1147430471947, -1020.2523229081033, -216.32830777044742, -1439.1851271559378, -1348.1862848411643, -1141.8763444541219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5592360652049386, "mean_inference_ms": 1.6778967311237643, "mean_action_processing_ms": 0.2787092360159201, "mean_env_wait_ms": 3.43883959062347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012282371520996094, "StateBufferConnector_ms": 0.007915496826171875, "ViewRequirementAgentConnector_ms": 0.18820834159851074}, "num_episodes": 32, "episode_return_max": -11.008200405374902, "episode_return_min": -1470.4375925076595, "episode_return_mean": -766.0833070197264, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.35852938039443, "num_env_steps_trained_throughput_per_sec": 306.35852938039443, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12697.669, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12697.595, "sample_time_ms": 1152.351, "learn_time_ms": 11475.627, "learn_throughput": 348.565, "synch_weights_time_ms": 68.8}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00009", "date": "2024-08-04_06-19-52", "timestamp": 1722732592, "time_this_iter_s": 13.068670988082886, "time_total_s": 114.38214159011841, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.38214159011841, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.438888888888886, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.5765596006065605, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.275942293802897, "policy_loss": -0.011439574133449544, "vf_loss": 9.283915028969448, "vf_explained_var": 0.46453651233265797, "kl": 0.018053594655172377, "entropy": 1.438777004679044, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -11.008200405374902, "episode_reward_min": -1470.4375925076595, "episode_reward_mean": -728.9264560261421, "episode_len_mean": 127.33, "episode_media": {}, "episodes_timesteps_total": 12733, "policy_reward_min": {"policy_0": -1470.4375925076595}, "policy_reward_max": {"policy_0": -11.008200405374902}, "policy_reward_mean": {"policy_0": -728.9264560261421}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-964.7749027455612, -115.25967403178839, -669.6299293662391, -732.6428731780339, -1219.622823813244, -137.48382788421878, -296.50619496668475, -1022.9275007582996, -401.5798574615793, -926.7243727139329, -464.84499166120827, -964.6584729486211, -1016.2590251639714, -819.8333861241646, -698.4091629164718, -49.120795344758605, -123.67486617353367, -243.7073623437304, -1150.3566263268328, -380.6978979274492, -542.9030938403444, -253.1848238832676, -1020.8414544225543, -788.62739290193, -719.9143953678188, -1108.4199885352002, -315.8282865732902, -440.9311998789786, -1003.8005577373038, -737.9173334203292, -467.14714687766394, -1138.5009707734287, -1007.427010441631, -672.7316745942572, -195.64652697460969, -868.1052246978395, -898.7726436350605, -1142.229290989111, -567.8320577445211, -1470.4375925076595, -652.1855468961063, -98.32972007666409, -963.7278525107043, -689.6594296486722, -224.157692872685, -11.008200405374902, -1055.2804466401358, -1075.1779464044448, -930.2582233186536, -75.21612155633896, -814.8008374993884, -743.2441671694879, -751.8475891115196, -798.361864171065, -1385.9560515048415, -1128.1435000551899, -1044.5213343564667, -358.1268065150222, -978.720598589813, -16.386271865116647, -1114.1867274952576, -143.67983471978732, -1280.3221735462787, -467.1147430471947, -1020.2523229081033, -216.32830777044742, -1439.1851271559378, -1348.1862848411643, -1141.8763444541219, -528.2036504407887, -1077.4817009496292, -988.589202765357, -1020.7605364239173, -702.0374112972033, -1133.9325510415536, -649.9850515760836, -120.32587959808976, -883.1841728210356, -1262.1524629595153, -94.77099334835495, -17.852500449942006, -80.6016729983226, -985.2574816552865, -90.11440878410104, -115.77220965868086, -1171.8374453487743, -1166.847952365183, -820.2102991862058, -573.56185640229, -171.12839086742292, -1314.7022781665082, -1012.8885117535259, -1018.870232922951, -839.2508586476197, -399.7139292302045, -956.0979359065012, -1130.1244444601202, -795.8598773104791, -888.6903581933879, -1155.6840683320777], "episode_lengths": [150, 74, 150, 150, 150, 69, 81, 150, 150, 150, 113, 150, 150, 150, 150, 56, 76, 76, 150, 111, 150, 69, 150, 150, 150, 150, 88, 109, 150, 150, 114, 150, 150, 150, 70, 150, 150, 150, 140, 150, 150, 60, 150, 121, 74, 46, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 98, 150, 47, 150, 53, 150, 113, 150, 69, 150, 150, 150, 141, 150, 150, 150, 150, 150, 141, 88, 150, 150, 59, 43, 45, 150, 66, 51, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150], "policy_policy_0_reward": [-964.7749027455612, -115.25967403178839, -669.6299293662391, -732.6428731780339, -1219.622823813244, -137.48382788421878, -296.50619496668475, -1022.9275007582996, -401.5798574615793, -926.7243727139329, -464.84499166120827, -964.6584729486211, -1016.2590251639714, -819.8333861241646, -698.4091629164718, -49.120795344758605, -123.67486617353367, -243.7073623437304, -1150.3566263268328, -380.6978979274492, -542.9030938403444, -253.1848238832676, -1020.8414544225543, -788.62739290193, -719.9143953678188, -1108.4199885352002, -315.8282865732902, -440.9311998789786, -1003.8005577373038, -737.9173334203292, -467.14714687766394, -1138.5009707734287, -1007.427010441631, -672.7316745942572, -195.64652697460969, -868.1052246978395, -898.7726436350605, -1142.229290989111, -567.8320577445211, -1470.4375925076595, -652.1855468961063, -98.32972007666409, -963.7278525107043, -689.6594296486722, -224.157692872685, -11.008200405374902, -1055.2804466401358, -1075.1779464044448, -930.2582233186536, -75.21612155633896, -814.8008374993884, -743.2441671694879, -751.8475891115196, -798.361864171065, -1385.9560515048415, -1128.1435000551899, -1044.5213343564667, -358.1268065150222, -978.720598589813, -16.386271865116647, -1114.1867274952576, -143.67983471978732, -1280.3221735462787, -467.1147430471947, -1020.2523229081033, -216.32830777044742, -1439.1851271559378, -1348.1862848411643, -1141.8763444541219, -528.2036504407887, -1077.4817009496292, -988.589202765357, -1020.7605364239173, -702.0374112972033, -1133.9325510415536, -649.9850515760836, -120.32587959808976, -883.1841728210356, -1262.1524629595153, -94.77099334835495, -17.852500449942006, -80.6016729983226, -985.2574816552865, -90.11440878410104, -115.77220965868086, -1171.8374453487743, -1166.847952365183, -820.2102991862058, -573.56185640229, -171.12839086742292, -1314.7022781665082, -1012.8885117535259, -1018.870232922951, -839.2508586476197, -399.7139292302045, -956.0979359065012, -1130.1244444601202, -795.8598773104791, -888.6903581933879, -1155.6840683320777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581105674007261, "mean_inference_ms": 1.676134500501781, "mean_action_processing_ms": 0.27861256666849643, "mean_env_wait_ms": 3.4397646966460282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012176513671875, "StateBufferConnector_ms": 0.007953405380249023, "ViewRequirementAgentConnector_ms": 0.1883089542388916}, "num_episodes": 31, "episode_return_max": -11.008200405374902, "episode_return_min": -1470.4375925076595, "episode_return_mean": -728.9264560261421, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.5495586917322, "num_env_steps_trained_throughput_per_sec": 305.5495586917322, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12737.02, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12736.946, "sample_time_ms": 1153.336, "learn_time_ms": 11513.802, "learn_throughput": 347.409, "synch_weights_time_ms": 68.994}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00009", "date": "2024-08-04_06-20-05", "timestamp": 1722732605, "time_this_iter_s": 13.103784561157227, "time_total_s": 127.48592615127563, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b7d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.48592615127563, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.273684210526316, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.230499595155319, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.094106803834439, "policy_loss": -0.009686193149536847, "vf_loss": 9.100280077258747, "vf_explained_var": 0.5387281445165475, "kl": 0.018225595815783903, "entropy": 1.32194188075761, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -6.363418317803329, "episode_reward_min": -1470.4375925076595, "episode_reward_mean": -740.0328280237932, "episode_len_mean": 130.89, "episode_media": {}, "episodes_timesteps_total": 13089, "policy_reward_min": {"policy_0": -1470.4375925076595}, "policy_reward_max": {"policy_0": -6.363418317803329}, "policy_reward_mean": {"policy_0": -740.0328280237932}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-467.14714687766394, -1138.5009707734287, -1007.427010441631, -672.7316745942572, -195.64652697460969, -868.1052246978395, -898.7726436350605, -1142.229290989111, -567.8320577445211, -1470.4375925076595, -652.1855468961063, -98.32972007666409, -963.7278525107043, -689.6594296486722, -224.157692872685, -11.008200405374902, -1055.2804466401358, -1075.1779464044448, -930.2582233186536, -75.21612155633896, -814.8008374993884, -743.2441671694879, -751.8475891115196, -798.361864171065, -1385.9560515048415, -1128.1435000551899, -1044.5213343564667, -358.1268065150222, -978.720598589813, -16.386271865116647, -1114.1867274952576, -143.67983471978732, -1280.3221735462787, -467.1147430471947, -1020.2523229081033, -216.32830777044742, -1439.1851271559378, -1348.1862848411643, -1141.8763444541219, -528.2036504407887, -1077.4817009496292, -988.589202765357, -1020.7605364239173, -702.0374112972033, -1133.9325510415536, -649.9850515760836, -120.32587959808976, -883.1841728210356, -1262.1524629595153, -94.77099334835495, -17.852500449942006, -80.6016729983226, -985.2574816552865, -90.11440878410104, -115.77220965868086, -1171.8374453487743, -1166.847952365183, -820.2102991862058, -573.56185640229, -171.12839086742292, -1314.7022781665082, -1012.8885117535259, -1018.870232922951, -839.2508586476197, -399.7139292302045, -956.0979359065012, -1130.1244444601202, -795.8598773104791, -888.6903581933879, -1155.6840683320777, -694.0769823563242, -492.610073375253, -780.3704337817753, -456.46195259730297, -652.2170675611071, -1130.7729514865391, -6.363418317803329, -669.8086804344404, -776.7479243838565, -703.4574464039908, -289.55193765740347, -1253.3813841769079, -574.9646560924672, -965.4609579296219, -386.4574938876122, -645.4529156854563, -986.1747366651131, -140.13316556323062, -1107.055469896926, -904.9793191477723, -562.0391323873793, -1193.9965536971629, -765.4906215009051, -750.1655855681087, -733.2390758633402, -308.5934268354336, -716.8063872933078, -819.2783223607007, -184.61005223014553, -791.0021450390426], "episode_lengths": [114, 150, 150, 150, 70, 150, 150, 150, 140, 150, 150, 60, 150, 121, 74, 46, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 98, 150, 47, 150, 53, 150, 113, 150, 69, 150, 150, 150, 141, 150, 150, 150, 150, 150, 141, 88, 150, 150, 59, 43, 45, 150, 66, 51, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 140, 150, 96, 150, 150, 41, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150], "policy_policy_0_reward": [-467.14714687766394, -1138.5009707734287, -1007.427010441631, -672.7316745942572, -195.64652697460969, -868.1052246978395, -898.7726436350605, -1142.229290989111, -567.8320577445211, -1470.4375925076595, -652.1855468961063, -98.32972007666409, -963.7278525107043, -689.6594296486722, -224.157692872685, -11.008200405374902, -1055.2804466401358, -1075.1779464044448, -930.2582233186536, -75.21612155633896, -814.8008374993884, -743.2441671694879, -751.8475891115196, -798.361864171065, -1385.9560515048415, -1128.1435000551899, -1044.5213343564667, -358.1268065150222, -978.720598589813, -16.386271865116647, -1114.1867274952576, -143.67983471978732, -1280.3221735462787, -467.1147430471947, -1020.2523229081033, -216.32830777044742, -1439.1851271559378, -1348.1862848411643, -1141.8763444541219, -528.2036504407887, -1077.4817009496292, -988.589202765357, -1020.7605364239173, -702.0374112972033, -1133.9325510415536, -649.9850515760836, -120.32587959808976, -883.1841728210356, -1262.1524629595153, -94.77099334835495, -17.852500449942006, -80.6016729983226, -985.2574816552865, -90.11440878410104, -115.77220965868086, -1171.8374453487743, -1166.847952365183, -820.2102991862058, -573.56185640229, -171.12839086742292, -1314.7022781665082, -1012.8885117535259, -1018.870232922951, -839.2508586476197, -399.7139292302045, -956.0979359065012, -1130.1244444601202, -795.8598773104791, -888.6903581933879, -1155.6840683320777, -694.0769823563242, -492.610073375253, -780.3704337817753, -456.46195259730297, -652.2170675611071, -1130.7729514865391, -6.363418317803329, -669.8086804344404, -776.7479243838565, -703.4574464039908, -289.55193765740347, -1253.3813841769079, -574.9646560924672, -965.4609579296219, -386.4574938876122, -645.4529156854563, -986.1747366651131, -140.13316556323062, -1107.055469896926, -904.9793191477723, -562.0391323873793, -1193.9965536971629, -765.4906215009051, -750.1655855681087, -733.2390758633402, -308.5934268354336, -716.8063872933078, -819.2783223607007, -184.61005223014553, -791.0021450390426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569957145258916, "mean_inference_ms": 1.6772548141096362, "mean_action_processing_ms": 0.278972302260289, "mean_env_wait_ms": 3.44522492163458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01206660270690918, "StateBufferConnector_ms": 0.007967472076416016, "ViewRequirementAgentConnector_ms": 0.19235873222351074}, "num_episodes": 30, "episode_return_max": -6.363418317803329, "episode_return_min": -1470.4375925076595, "episode_return_mean": -740.0328280237932, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.2380207798947, "num_env_steps_trained_throughput_per_sec": 304.2380207798947, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12734.907, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12734.833, "sample_time_ms": 1159.933, "learn_time_ms": 11506.47, "learn_throughput": 347.631, "synch_weights_time_ms": 67.626}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00009", "date": "2024-08-04_06-20-18", "timestamp": 1722732618, "time_this_iter_s": 13.159255266189575, "time_total_s": 140.6451814174652, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270f0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.6451814174652, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.33157894736842, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.796032853921254, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.685796874264875, "policy_loss": -0.013877966695387538, "vf_loss": 8.69617161800464, "vf_explained_var": 0.5727291101589799, "kl": 0.01822555434749424, "entropy": 1.4188412209351857, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -6.363418317803329, "episode_reward_min": -1439.1851271559378, "episode_reward_mean": -701.0225174619959, "episode_len_mean": 129.42, "episode_media": {}, "episodes_timesteps_total": 12942, "policy_reward_min": {"policy_0": -1439.1851271559378}, "policy_reward_max": {"policy_0": -6.363418317803329}, "policy_reward_mean": {"policy_0": -701.0225174619959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.386271865116647, -1114.1867274952576, -143.67983471978732, -1280.3221735462787, -467.1147430471947, -1020.2523229081033, -216.32830777044742, -1439.1851271559378, -1348.1862848411643, -1141.8763444541219, -528.2036504407887, -1077.4817009496292, -988.589202765357, -1020.7605364239173, -702.0374112972033, -1133.9325510415536, -649.9850515760836, -120.32587959808976, -883.1841728210356, -1262.1524629595153, -94.77099334835495, -17.852500449942006, -80.6016729983226, -985.2574816552865, -90.11440878410104, -115.77220965868086, -1171.8374453487743, -1166.847952365183, -820.2102991862058, -573.56185640229, -171.12839086742292, -1314.7022781665082, -1012.8885117535259, -1018.870232922951, -839.2508586476197, -399.7139292302045, -956.0979359065012, -1130.1244444601202, -795.8598773104791, -888.6903581933879, -1155.6840683320777, -694.0769823563242, -492.610073375253, -780.3704337817753, -456.46195259730297, -652.2170675611071, -1130.7729514865391, -6.363418317803329, -669.8086804344404, -776.7479243838565, -703.4574464039908, -289.55193765740347, -1253.3813841769079, -574.9646560924672, -965.4609579296219, -386.4574938876122, -645.4529156854563, -986.1747366651131, -140.13316556323062, -1107.055469896926, -904.9793191477723, -562.0391323873793, -1193.9965536971629, -765.4906215009051, -750.1655855681087, -733.2390758633402, -308.5934268354336, -716.8063872933078, -819.2783223607007, -184.61005223014553, -791.0021450390426, -1274.9535565283359, -1063.4576908825911, -348.6134578691819, -1063.9551687984408, -251.2785482729021, -1154.7574561129065, -73.50032533423573, -722.8754827426384, -417.7621773087292, -571.5236327366765, -1137.112979679843, -116.95102550052476, -66.23444719273276, -294.56367901748143, -106.06432565607965, -231.55912381439347, -563.4839100880993, -450.5568582059434, -1071.3628023780898, -353.9384085552825, -345.16053683405715, -937.0272127109531, -590.1645615077896, -743.4163146084794, -84.83079795367127, -1159.5128027023918, -1001.2821039577144, -769.8005435886978, -1340.823081819779], "episode_lengths": [47, 150, 53, 150, 113, 150, 69, 150, 150, 150, 141, 150, 150, 150, 150, 150, 141, 88, 150, 150, 59, 43, 45, 150, 66, 51, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 140, 150, 96, 150, 150, 41, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 98, 150, 105, 150, 42, 150, 150, 150, 150, 76, 48, 95, 54, 101, 150, 150, 150, 150, 100, 150, 150, 150, 66, 150, 150, 150, 150], "policy_policy_0_reward": [-16.386271865116647, -1114.1867274952576, -143.67983471978732, -1280.3221735462787, -467.1147430471947, -1020.2523229081033, -216.32830777044742, -1439.1851271559378, -1348.1862848411643, -1141.8763444541219, -528.2036504407887, -1077.4817009496292, -988.589202765357, -1020.7605364239173, -702.0374112972033, -1133.9325510415536, -649.9850515760836, -120.32587959808976, -883.1841728210356, -1262.1524629595153, -94.77099334835495, -17.852500449942006, -80.6016729983226, -985.2574816552865, -90.11440878410104, -115.77220965868086, -1171.8374453487743, -1166.847952365183, -820.2102991862058, -573.56185640229, -171.12839086742292, -1314.7022781665082, -1012.8885117535259, -1018.870232922951, -839.2508586476197, -399.7139292302045, -956.0979359065012, -1130.1244444601202, -795.8598773104791, -888.6903581933879, -1155.6840683320777, -694.0769823563242, -492.610073375253, -780.3704337817753, -456.46195259730297, -652.2170675611071, -1130.7729514865391, -6.363418317803329, -669.8086804344404, -776.7479243838565, -703.4574464039908, -289.55193765740347, -1253.3813841769079, -574.9646560924672, -965.4609579296219, -386.4574938876122, -645.4529156854563, -986.1747366651131, -140.13316556323062, -1107.055469896926, -904.9793191477723, -562.0391323873793, -1193.9965536971629, -765.4906215009051, -750.1655855681087, -733.2390758633402, -308.5934268354336, -716.8063872933078, -819.2783223607007, -184.61005223014553, -791.0021450390426, -1274.9535565283359, -1063.4576908825911, -348.6134578691819, -1063.9551687984408, -251.2785482729021, -1154.7574561129065, -73.50032533423573, -722.8754827426384, -417.7621773087292, -571.5236327366765, -1137.112979679843, -116.95102550052476, -66.23444719273276, -294.56367901748143, -106.06432565607965, -231.55912381439347, -563.4839100880993, -450.5568582059434, -1071.3628023780898, -353.9384085552825, -345.16053683405715, -937.0272127109531, -590.1645615077896, -743.4163146084794, -84.83079795367127, -1159.5128027023918, -1001.2821039577144, -769.8005435886978, -1340.823081819779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560054375957718, "mean_inference_ms": 1.6763091537967076, "mean_action_processing_ms": 0.27836660964496646, "mean_env_wait_ms": 3.4442249298065235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012060880661010742, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.19243574142456055}, "num_episodes": 29, "episode_return_max": -6.363418317803329, "episode_return_min": -1439.1851271559378, "episode_return_mean": -701.0225174619959, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2497107245788, "num_env_steps_trained_throughput_per_sec": 310.2497107245788, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13010.709, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13010.636, "sample_time_ms": 1161.4, "learn_time_ms": 11781.084, "learn_throughput": 339.527, "synch_weights_time_ms": 67.359}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00009", "date": "2024-08-04_06-20-31", "timestamp": 1722732631, "time_this_iter_s": 12.90490174293518, "time_total_s": 153.5500831604004, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1a050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.5500831604004, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.594444444444445, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.578094186882177, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.969274854163329, "policy_loss": -0.014077683845243882, "vf_loss": 8.979246157407761, "vf_explained_var": 0.38494173691918454, "kl": 0.0213065886661146, "entropy": 1.5489839469393094, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -6.363418317803329, "episode_reward_min": -1379.5456802782987, "episode_reward_mean": -721.1632510557153, "episode_len_mean": 135.47, "episode_media": {}, "episodes_timesteps_total": 13547, "policy_reward_min": {"policy_0": -1379.5456802782987}, "policy_reward_max": {"policy_0": -6.363418317803329}, "policy_reward_mean": {"policy_0": -721.1632510557153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-573.56185640229, -171.12839086742292, -1314.7022781665082, -1012.8885117535259, -1018.870232922951, -839.2508586476197, -399.7139292302045, -956.0979359065012, -1130.1244444601202, -795.8598773104791, -888.6903581933879, -1155.6840683320777, -694.0769823563242, -492.610073375253, -780.3704337817753, -456.46195259730297, -652.2170675611071, -1130.7729514865391, -6.363418317803329, -669.8086804344404, -776.7479243838565, -703.4574464039908, -289.55193765740347, -1253.3813841769079, -574.9646560924672, -965.4609579296219, -386.4574938876122, -645.4529156854563, -986.1747366651131, -140.13316556323062, -1107.055469896926, -904.9793191477723, -562.0391323873793, -1193.9965536971629, -765.4906215009051, -750.1655855681087, -733.2390758633402, -308.5934268354336, -716.8063872933078, -819.2783223607007, -184.61005223014553, -791.0021450390426, -1274.9535565283359, -1063.4576908825911, -348.6134578691819, -1063.9551687984408, -251.2785482729021, -1154.7574561129065, -73.50032533423573, -722.8754827426384, -417.7621773087292, -571.5236327366765, -1137.112979679843, -116.95102550052476, -66.23444719273276, -294.56367901748143, -106.06432565607965, -231.55912381439347, -563.4839100880993, -450.5568582059434, -1071.3628023780898, -353.9384085552825, -345.16053683405715, -937.0272127109531, -590.1645615077896, -743.4163146084794, -84.83079795367127, -1159.5128027023918, -1001.2821039577144, -769.8005435886978, -1340.823081819779, -484.53354431233646, -1016.9958739806749, -1379.5456802782987, -1313.7769885346058, -733.0189514765688, -1210.2286434305154, -973.5802554480691, -921.545376366779, -431.26177640615276, -466.6816818805584, -500.03746931562205, -1134.4375246030559, -954.3791691923278, -484.44657875226346, -363.5997585695264, -986.7158702875971, -1140.3256848924607, -1161.8069446769111, -629.8506298013299, -1008.4457492960471, -764.5662063924699, -1096.702536123029, -1034.7444931922537, -869.348398399875, -505.8300854016921, -492.9339787728369, -218.14543618804353, -391.20725587280464, -442.8165389986414], "episode_lengths": [150, 73, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 140, 150, 96, 150, 150, 41, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 98, 150, 105, 150, 42, 150, 150, 150, 150, 76, 48, 95, 54, 101, 150, 150, 150, 150, 100, 150, 150, 150, 66, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 99, 73, 150, 100], "policy_policy_0_reward": [-573.56185640229, -171.12839086742292, -1314.7022781665082, -1012.8885117535259, -1018.870232922951, -839.2508586476197, -399.7139292302045, -956.0979359065012, -1130.1244444601202, -795.8598773104791, -888.6903581933879, -1155.6840683320777, -694.0769823563242, -492.610073375253, -780.3704337817753, -456.46195259730297, -652.2170675611071, -1130.7729514865391, -6.363418317803329, -669.8086804344404, -776.7479243838565, -703.4574464039908, -289.55193765740347, -1253.3813841769079, -574.9646560924672, -965.4609579296219, -386.4574938876122, -645.4529156854563, -986.1747366651131, -140.13316556323062, -1107.055469896926, -904.9793191477723, -562.0391323873793, -1193.9965536971629, -765.4906215009051, -750.1655855681087, -733.2390758633402, -308.5934268354336, -716.8063872933078, -819.2783223607007, -184.61005223014553, -791.0021450390426, -1274.9535565283359, -1063.4576908825911, -348.6134578691819, -1063.9551687984408, -251.2785482729021, -1154.7574561129065, -73.50032533423573, -722.8754827426384, -417.7621773087292, -571.5236327366765, -1137.112979679843, -116.95102550052476, -66.23444719273276, -294.56367901748143, -106.06432565607965, -231.55912381439347, -563.4839100880993, -450.5568582059434, -1071.3628023780898, -353.9384085552825, -345.16053683405715, -937.0272127109531, -590.1645615077896, -743.4163146084794, -84.83079795367127, -1159.5128027023918, -1001.2821039577144, -769.8005435886978, -1340.823081819779, -484.53354431233646, -1016.9958739806749, -1379.5456802782987, -1313.7769885346058, -733.0189514765688, -1210.2286434305154, -973.5802554480691, -921.545376366779, -431.26177640615276, -466.6816818805584, -500.03746931562205, -1134.4375246030559, -954.3791691923278, -484.44657875226346, -363.5997585695264, -986.7158702875971, -1140.3256848924607, -1161.8069446769111, -629.8506298013299, -1008.4457492960471, -764.5662063924699, -1096.702536123029, -1034.7444931922537, -869.348398399875, -505.8300854016921, -492.9339787728369, -218.14543618804353, -391.20725587280464, -442.8165389986414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562090349748654, "mean_inference_ms": 1.6778175228772334, "mean_action_processing_ms": 0.27837171738328015, "mean_env_wait_ms": 3.44637509658938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012618780136108398, "StateBufferConnector_ms": 0.007922649383544922, "ViewRequirementAgentConnector_ms": 0.2020092010498047}, "num_episodes": 29, "episode_return_max": -6.363418317803329, "episode_return_min": -1379.5456802782987, "episode_return_mean": -721.1632510557153, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.9649869540958, "num_env_steps_trained_throughput_per_sec": 299.9649869540958, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13011.451, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13011.376, "sample_time_ms": 1150.71, "learn_time_ms": 11792.72, "learn_throughput": 339.192, "synch_weights_time_ms": 67.154}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00009", "date": "2024-08-04_06-20-44", "timestamp": 1722732644, "time_this_iter_s": 13.347487926483154, "time_total_s": 166.89757108688354, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b7d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.89757108688354, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.115789473684213, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.310792131721975, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.812295272449653, "policy_loss": -0.016174506478516076, "vf_loss": 8.821956028044223, "vf_explained_var": 0.6587982663263877, "kl": 0.022143042384383686, "entropy": 1.2914688859134913, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -31.643750247291567, "episode_reward_min": -1379.5456802782987, "episode_reward_mean": -681.8612213163814, "episode_len_mean": 132.21, "episode_media": {}, "episodes_timesteps_total": 13221, "policy_reward_min": {"policy_0": -1379.5456802782987}, "policy_reward_max": {"policy_0": -31.643750247291567}, "policy_reward_mean": {"policy_0": -681.8612213163814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-750.1655855681087, -733.2390758633402, -308.5934268354336, -716.8063872933078, -819.2783223607007, -184.61005223014553, -791.0021450390426, -1274.9535565283359, -1063.4576908825911, -348.6134578691819, -1063.9551687984408, -251.2785482729021, -1154.7574561129065, -73.50032533423573, -722.8754827426384, -417.7621773087292, -571.5236327366765, -1137.112979679843, -116.95102550052476, -66.23444719273276, -294.56367901748143, -106.06432565607965, -231.55912381439347, -563.4839100880993, -450.5568582059434, -1071.3628023780898, -353.9384085552825, -345.16053683405715, -937.0272127109531, -590.1645615077896, -743.4163146084794, -84.83079795367127, -1159.5128027023918, -1001.2821039577144, -769.8005435886978, -1340.823081819779, -484.53354431233646, -1016.9958739806749, -1379.5456802782987, -1313.7769885346058, -733.0189514765688, -1210.2286434305154, -973.5802554480691, -921.545376366779, -431.26177640615276, -466.6816818805584, -500.03746931562205, -1134.4375246030559, -954.3791691923278, -484.44657875226346, -363.5997585695264, -986.7158702875971, -1140.3256848924607, -1161.8069446769111, -629.8506298013299, -1008.4457492960471, -764.5662063924699, -1096.702536123029, -1034.7444931922537, -869.348398399875, -505.8300854016921, -492.9339787728369, -218.14543618804353, -391.20725587280464, -442.8165389986414, -923.8588974635342, -919.1110217508026, -964.0858527719045, -725.7551556650897, -505.92660944410994, -229.42690377370994, -31.684858608049296, -753.7576540001585, -85.96483306833487, -582.6050999654648, -470.70133979056874, -782.6509146706942, -523.9753952378835, -682.7354792604103, -373.16486869581746, -1080.1913662722177, -541.3775236652789, -31.643750247291567, -806.0294209932961, -186.3807142995675, -1108.3774897597475, -711.0154692046644, -725.9857363600883, -1200.5271550943946, -901.7299890327325, -1290.4350793950632, -850.1410275560435, -213.62830769457156, -160.76093999187108, -119.68517201366201, -864.3460026800667, -1110.0220886676095, -453.16496958707677, -470.50920704572906, -1083.038749518565], "episode_lengths": [150, 150, 150, 150, 150, 86, 150, 150, 150, 98, 150, 105, 150, 42, 150, 150, 150, 150, 76, 48, 95, 54, 101, 150, 150, 150, 150, 100, 150, 150, 150, 66, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 99, 73, 150, 100, 150, 150, 150, 150, 150, 94, 40, 150, 57, 150, 150, 150, 150, 150, 108, 150, 150, 47, 150, 61, 150, 150, 150, 150, 150, 150, 150, 85, 61, 76, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-750.1655855681087, -733.2390758633402, -308.5934268354336, -716.8063872933078, -819.2783223607007, -184.61005223014553, -791.0021450390426, -1274.9535565283359, -1063.4576908825911, -348.6134578691819, -1063.9551687984408, -251.2785482729021, -1154.7574561129065, -73.50032533423573, -722.8754827426384, -417.7621773087292, -571.5236327366765, -1137.112979679843, -116.95102550052476, -66.23444719273276, -294.56367901748143, -106.06432565607965, -231.55912381439347, -563.4839100880993, -450.5568582059434, -1071.3628023780898, -353.9384085552825, -345.16053683405715, -937.0272127109531, -590.1645615077896, -743.4163146084794, -84.83079795367127, -1159.5128027023918, -1001.2821039577144, -769.8005435886978, -1340.823081819779, -484.53354431233646, -1016.9958739806749, -1379.5456802782987, -1313.7769885346058, -733.0189514765688, -1210.2286434305154, -973.5802554480691, -921.545376366779, -431.26177640615276, -466.6816818805584, -500.03746931562205, -1134.4375246030559, -954.3791691923278, -484.44657875226346, -363.5997585695264, -986.7158702875971, -1140.3256848924607, -1161.8069446769111, -629.8506298013299, -1008.4457492960471, -764.5662063924699, -1096.702536123029, -1034.7444931922537, -869.348398399875, -505.8300854016921, -492.9339787728369, -218.14543618804353, -391.20725587280464, -442.8165389986414, -923.8588974635342, -919.1110217508026, -964.0858527719045, -725.7551556650897, -505.92660944410994, -229.42690377370994, -31.684858608049296, -753.7576540001585, -85.96483306833487, -582.6050999654648, -470.70133979056874, -782.6509146706942, -523.9753952378835, -682.7354792604103, -373.16486869581746, -1080.1913662722177, -541.3775236652789, -31.643750247291567, -806.0294209932961, -186.3807142995675, -1108.3774897597475, -711.0154692046644, -725.9857363600883, -1200.5271550943946, -901.7299890327325, -1290.4350793950632, -850.1410275560435, -213.62830769457156, -160.76093999187108, -119.68517201366201, -864.3460026800667, -1110.0220886676095, -453.16496958707677, -470.50920704572906, -1083.038749518565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556506012091713, "mean_inference_ms": 1.6778996035921552, "mean_action_processing_ms": 0.27778886726444574, "mean_env_wait_ms": 3.4507056486460543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012569665908813477, "StateBufferConnector_ms": 0.008092641830444336, "ViewRequirementAgentConnector_ms": 0.19929718971252441}, "num_episodes": 35, "episode_return_max": -31.643750247291567, "episode_return_min": -1379.5456802782987, "episode_return_mean": -681.8612213163814, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.41757601726846, "num_env_steps_trained_throughput_per_sec": 305.41757601726846, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12987.511, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12987.434, "sample_time_ms": 1141.67, "learn_time_ms": 11778.733, "learn_throughput": 339.595, "synch_weights_time_ms": 66.243}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00009", "date": "2024-08-04_06-20-57", "timestamp": 1722732657, "time_this_iter_s": 13.108078718185425, "time_total_s": 180.00564980506897, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b63b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.00564980506897, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.96315789473684, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.627988653630018, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 9.106463318566481, "policy_loss": -0.011862050633256634, "vf_loss": 9.11164367844661, "vf_explained_var": 0.4906172424554825, "kl": 0.015228316364482469, "entropy": 1.7107706847290198, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -12.26905543000068, "episode_reward_min": -1406.0438008821225, "episode_reward_mean": -724.7892424963397, "episode_len_mean": 134.12, "episode_media": {}, "episodes_timesteps_total": 13412, "policy_reward_min": {"policy_0": -1406.0438008821225}, "policy_reward_max": {"policy_0": -12.26905543000068}, "policy_reward_mean": {"policy_0": -724.7892424963397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-937.0272127109531, -590.1645615077896, -743.4163146084794, -84.83079795367127, -1159.5128027023918, -1001.2821039577144, -769.8005435886978, -1340.823081819779, -484.53354431233646, -1016.9958739806749, -1379.5456802782987, -1313.7769885346058, -733.0189514765688, -1210.2286434305154, -973.5802554480691, -921.545376366779, -431.26177640615276, -466.6816818805584, -500.03746931562205, -1134.4375246030559, -954.3791691923278, -484.44657875226346, -363.5997585695264, -986.7158702875971, -1140.3256848924607, -1161.8069446769111, -629.8506298013299, -1008.4457492960471, -764.5662063924699, -1096.702536123029, -1034.7444931922537, -869.348398399875, -505.8300854016921, -492.9339787728369, -218.14543618804353, -391.20725587280464, -442.8165389986414, -923.8588974635342, -919.1110217508026, -964.0858527719045, -725.7551556650897, -505.92660944410994, -229.42690377370994, -31.684858608049296, -753.7576540001585, -85.96483306833487, -582.6050999654648, -470.70133979056874, -782.6509146706942, -523.9753952378835, -682.7354792604103, -373.16486869581746, -1080.1913662722177, -541.3775236652789, -31.643750247291567, -806.0294209932961, -186.3807142995675, -1108.3774897597475, -711.0154692046644, -725.9857363600883, -1200.5271550943946, -901.7299890327325, -1290.4350793950632, -850.1410275560435, -213.62830769457156, -160.76093999187108, -119.68517201366201, -864.3460026800667, -1110.0220886676095, -453.16496958707677, -470.50920704572906, -1083.038749518565, -544.0176896259162, -308.35014534250666, -612.3496289722418, -576.8196537380123, -117.36829657446009, -439.12092957711474, -595.1751645962757, -669.9728371189402, -806.6892488675252, -806.6845610984774, -479.45939999765903, -12.26905543000068, -172.69090394633673, -1324.7467437093364, -1260.4852867140964, -1320.1965598737415, -616.1584062721984, -1209.509463020173, -600.4944979250241, -1241.7921615234598, -571.7176142914202, -1188.7101090070826, -787.6470929442145, -114.67631557084373, -623.993082366028, -953.6719981789403, -1406.0438008821225, -915.3520595309456], "episode_lengths": [150, 150, 150, 66, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 99, 73, 150, 100, 150, 150, 150, 150, 150, 94, 40, 150, 57, 150, 150, 150, 150, 150, 108, 150, 150, 47, 150, 61, 150, 150, 150, 150, 150, 150, 150, 85, 61, 76, 150, 150, 150, 150, 150, 150, 106, 150, 150, 71, 99, 150, 150, 150, 150, 150, 40, 68, 150, 150, 150, 125, 150, 150, 150, 146, 150, 150, 65, 126, 150, 150, 150], "policy_policy_0_reward": [-937.0272127109531, -590.1645615077896, -743.4163146084794, -84.83079795367127, -1159.5128027023918, -1001.2821039577144, -769.8005435886978, -1340.823081819779, -484.53354431233646, -1016.9958739806749, -1379.5456802782987, -1313.7769885346058, -733.0189514765688, -1210.2286434305154, -973.5802554480691, -921.545376366779, -431.26177640615276, -466.6816818805584, -500.03746931562205, -1134.4375246030559, -954.3791691923278, -484.44657875226346, -363.5997585695264, -986.7158702875971, -1140.3256848924607, -1161.8069446769111, -629.8506298013299, -1008.4457492960471, -764.5662063924699, -1096.702536123029, -1034.7444931922537, -869.348398399875, -505.8300854016921, -492.9339787728369, -218.14543618804353, -391.20725587280464, -442.8165389986414, -923.8588974635342, -919.1110217508026, -964.0858527719045, -725.7551556650897, -505.92660944410994, -229.42690377370994, -31.684858608049296, -753.7576540001585, -85.96483306833487, -582.6050999654648, -470.70133979056874, -782.6509146706942, -523.9753952378835, -682.7354792604103, -373.16486869581746, -1080.1913662722177, -541.3775236652789, -31.643750247291567, -806.0294209932961, -186.3807142995675, -1108.3774897597475, -711.0154692046644, -725.9857363600883, -1200.5271550943946, -901.7299890327325, -1290.4350793950632, -850.1410275560435, -213.62830769457156, -160.76093999187108, -119.68517201366201, -864.3460026800667, -1110.0220886676095, -453.16496958707677, -470.50920704572906, -1083.038749518565, -544.0176896259162, -308.35014534250666, -612.3496289722418, -576.8196537380123, -117.36829657446009, -439.12092957711474, -595.1751645962757, -669.9728371189402, -806.6892488675252, -806.6845610984774, -479.45939999765903, -12.26905543000068, -172.69090394633673, -1324.7467437093364, -1260.4852867140964, -1320.1965598737415, -616.1584062721984, -1209.509463020173, -600.4944979250241, -1241.7921615234598, -571.7176142914202, -1188.7101090070826, -787.6470929442145, -114.67631557084373, -623.993082366028, -953.6719981789403, -1406.0438008821225, -915.3520595309456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565042362390111, "mean_inference_ms": 1.676623597406695, "mean_action_processing_ms": 0.2775042866600669, "mean_env_wait_ms": 3.4529355921193483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575149536132812, "StateBufferConnector_ms": 0.00804758071899414, "ViewRequirementAgentConnector_ms": 0.19933652877807617}, "num_episodes": 28, "episode_return_max": -12.26905543000068, "episode_return_min": -1406.0438008821225, "episode_return_mean": -724.7892424963397, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.3075103777798, "num_env_steps_trained_throughput_per_sec": 354.3075103777798, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12854.302, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12854.228, "sample_time_ms": 1136.206, "learn_time_ms": 11651.131, "learn_throughput": 343.314, "synch_weights_time_ms": 66.106}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00009", "date": "2024-08-04_06-21-09", "timestamp": 1722732669, "time_this_iter_s": 11.301718950271606, "time_total_s": 191.30736875534058, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b7490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 191.30736875534058, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.4125, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.530519383649033, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.665203053752581, "policy_loss": -0.010185214495868422, "vf_loss": 8.669280284146469, "vf_explained_var": 0.6200761399542292, "kl": 0.013890535330695784, "entropy": 1.4278557292496166, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -10.768766884989244, "episode_reward_min": -1546.2082383924862, "episode_reward_mean": -713.2550367085853, "episode_len_mean": 133.56, "episode_media": {}, "episodes_timesteps_total": 13356, "policy_reward_min": {"policy_0": -1546.2082383924862}, "policy_reward_max": {"policy_0": -10.768766884989244}, "policy_reward_mean": {"policy_0": -713.2550367085853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1096.702536123029, -1034.7444931922537, -869.348398399875, -505.8300854016921, -492.9339787728369, -218.14543618804353, -391.20725587280464, -442.8165389986414, -923.8588974635342, -919.1110217508026, -964.0858527719045, -725.7551556650897, -505.92660944410994, -229.42690377370994, -31.684858608049296, -753.7576540001585, -85.96483306833487, -582.6050999654648, -470.70133979056874, -782.6509146706942, -523.9753952378835, -682.7354792604103, -373.16486869581746, -1080.1913662722177, -541.3775236652789, -31.643750247291567, -806.0294209932961, -186.3807142995675, -1108.3774897597475, -711.0154692046644, -725.9857363600883, -1200.5271550943946, -901.7299890327325, -1290.4350793950632, -850.1410275560435, -213.62830769457156, -160.76093999187108, -119.68517201366201, -864.3460026800667, -1110.0220886676095, -453.16496958707677, -470.50920704572906, -1083.038749518565, -544.0176896259162, -308.35014534250666, -612.3496289722418, -576.8196537380123, -117.36829657446009, -439.12092957711474, -595.1751645962757, -669.9728371189402, -806.6892488675252, -806.6845610984774, -479.45939999765903, -12.26905543000068, -172.69090394633673, -1324.7467437093364, -1260.4852867140964, -1320.1965598737415, -616.1584062721984, -1209.509463020173, -600.4944979250241, -1241.7921615234598, -571.7176142914202, -1188.7101090070826, -787.6470929442145, -114.67631557084373, -623.993082366028, -953.6719981789403, -1406.0438008821225, -915.3520595309456, -416.821242935982, -1061.1695969937311, -991.8600685499964, -896.2100472262414, -443.82659066626275, -1546.2082383924862, -906.3565731159084, -1306.0885367843705, -509.08332986767203, -996.797538958434, -406.2473784470803, -1414.8103475637529, -10.768766884989244, -652.184687873098, -704.3095056112231, -603.7578695820619, -768.763905486381, -207.5076336895347, -525.8448713165672, -371.67459370567644, -1104.05791967589, -1152.7823363691027, -631.9501543730789, -1037.399770214435, -504.92902634939315, -1246.6696682711226, -958.8661402075877, -1175.1344683493655, -981.1363905067666], "episode_lengths": [150, 150, 150, 150, 99, 73, 150, 100, 150, 150, 150, 150, 150, 94, 40, 150, 57, 150, 150, 150, 150, 150, 108, 150, 150, 47, 150, 61, 150, 150, 150, 150, 150, 150, 150, 85, 61, 76, 150, 150, 150, 150, 150, 150, 106, 150, 150, 71, 99, 150, 150, 150, 150, 150, 40, 68, 150, 150, 150, 125, 150, 150, 150, 146, 150, 150, 65, 126, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 67, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1096.702536123029, -1034.7444931922537, -869.348398399875, -505.8300854016921, -492.9339787728369, -218.14543618804353, -391.20725587280464, -442.8165389986414, -923.8588974635342, -919.1110217508026, -964.0858527719045, -725.7551556650897, -505.92660944410994, -229.42690377370994, -31.684858608049296, -753.7576540001585, -85.96483306833487, -582.6050999654648, -470.70133979056874, -782.6509146706942, -523.9753952378835, -682.7354792604103, -373.16486869581746, -1080.1913662722177, -541.3775236652789, -31.643750247291567, -806.0294209932961, -186.3807142995675, -1108.3774897597475, -711.0154692046644, -725.9857363600883, -1200.5271550943946, -901.7299890327325, -1290.4350793950632, -850.1410275560435, -213.62830769457156, -160.76093999187108, -119.68517201366201, -864.3460026800667, -1110.0220886676095, -453.16496958707677, -470.50920704572906, -1083.038749518565, -544.0176896259162, -308.35014534250666, -612.3496289722418, -576.8196537380123, -117.36829657446009, -439.12092957711474, -595.1751645962757, -669.9728371189402, -806.6892488675252, -806.6845610984774, -479.45939999765903, -12.26905543000068, -172.69090394633673, -1324.7467437093364, -1260.4852867140964, -1320.1965598737415, -616.1584062721984, -1209.509463020173, -600.4944979250241, -1241.7921615234598, -571.7176142914202, -1188.7101090070826, -787.6470929442145, -114.67631557084373, -623.993082366028, -953.6719981789403, -1406.0438008821225, -915.3520595309456, -416.821242935982, -1061.1695969937311, -991.8600685499964, -896.2100472262414, -443.82659066626275, -1546.2082383924862, -906.3565731159084, -1306.0885367843705, -509.08332986767203, -996.797538958434, -406.2473784470803, -1414.8103475637529, -10.768766884989244, -652.184687873098, -704.3095056112231, -603.7578695820619, -768.763905486381, -207.5076336895347, -525.8448713165672, -371.67459370567644, -1104.05791967589, -1152.7823363691027, -631.9501543730789, -1037.399770214435, -504.92902634939315, -1246.6696682711226, -958.8661402075877, -1175.1344683493655, -981.1363905067666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556193589971785, "mean_inference_ms": 1.6745713439594672, "mean_action_processing_ms": 0.2770962445599331, "mean_env_wait_ms": 3.45626745410777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01204538345336914, "StateBufferConnector_ms": 0.008097410202026367, "ViewRequirementAgentConnector_ms": 0.19968080520629883}, "num_episodes": 29, "episode_return_max": -10.768766884989244, "episode_return_min": -1546.2082383924862, "episode_return_mean": -713.2550367085853, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.38452034041865, "num_env_steps_trained_throughput_per_sec": 305.38452034041865, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12904.797, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12904.724, "sample_time_ms": 1139.008, "learn_time_ms": 11698.362, "learn_throughput": 341.928, "synch_weights_time_ms": 66.569}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00009", "date": "2024-08-04_06-21-22", "timestamp": 1722732682, "time_this_iter_s": 13.110080003738403, "time_total_s": 204.41744875907898, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b7d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.41744875907898, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.14736842105263, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.481425526738168, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.59809727370739, "policy_loss": -0.015360849832359236, "vf_loss": 8.605898619691532, "vf_explained_var": 0.6343845638756951, "kl": 0.017101934532418775, "entropy": 1.3636929776519537, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -10.768766884989244, "episode_reward_min": -1546.2082383924862, "episode_reward_mean": -731.8346443548048, "episode_len_mean": 133.61, "episode_media": {}, "episodes_timesteps_total": 13361, "policy_reward_min": {"policy_0": -1546.2082383924862}, "policy_reward_max": {"policy_0": -10.768766884989244}, "policy_reward_mean": {"policy_0": -731.8346443548048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-725.9857363600883, -1200.5271550943946, -901.7299890327325, -1290.4350793950632, -850.1410275560435, -213.62830769457156, -160.76093999187108, -119.68517201366201, -864.3460026800667, -1110.0220886676095, -453.16496958707677, -470.50920704572906, -1083.038749518565, -544.0176896259162, -308.35014534250666, -612.3496289722418, -576.8196537380123, -117.36829657446009, -439.12092957711474, -595.1751645962757, -669.9728371189402, -806.6892488675252, -806.6845610984774, -479.45939999765903, -12.26905543000068, -172.69090394633673, -1324.7467437093364, -1260.4852867140964, -1320.1965598737415, -616.1584062721984, -1209.509463020173, -600.4944979250241, -1241.7921615234598, -571.7176142914202, -1188.7101090070826, -787.6470929442145, -114.67631557084373, -623.993082366028, -953.6719981789403, -1406.0438008821225, -915.3520595309456, -416.821242935982, -1061.1695969937311, -991.8600685499964, -896.2100472262414, -443.82659066626275, -1546.2082383924862, -906.3565731159084, -1306.0885367843705, -509.08332986767203, -996.797538958434, -406.2473784470803, -1414.8103475637529, -10.768766884989244, -652.184687873098, -704.3095056112231, -603.7578695820619, -768.763905486381, -207.5076336895347, -525.8448713165672, -371.67459370567644, -1104.05791967589, -1152.7823363691027, -631.9501543730789, -1037.399770214435, -504.92902634939315, -1246.6696682711226, -958.8661402075877, -1175.1344683493655, -981.1363905067666, -727.7078604591626, -116.07276476309141, -568.3774531840143, -847.4668057427842, -607.7399763623204, -155.67085862555277, -661.850097927717, -461.0080782274828, -181.18135595373002, -196.08190445091088, -23.160468453874948, -1048.636520887872, -821.4538469974464, -1285.7722683099419, -549.2016844889449, -1307.078766713643, -1137.267252133536, -1170.5533887233419, -933.049667161731, -133.50466294643832, -675.2535789956794, -723.0388291719144, -1031.2314764216153, -10.776262303535317, -733.6500923624055, -118.0810135546401, -1231.4809905821603, -1241.9379174245355, -393.4206259168303, -838.4036369328488], "episode_lengths": [150, 150, 150, 150, 150, 85, 61, 76, 150, 150, 150, 150, 150, 150, 106, 150, 150, 71, 99, 150, 150, 150, 150, 150, 40, 68, 150, 150, 150, 125, 150, 150, 150, 146, 150, 150, 65, 126, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 67, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 147, 150, 150, 100, 150, 150, 75, 101, 41, 150, 142, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 38, 150, 58, 150, 150, 150, 150], "policy_policy_0_reward": [-725.9857363600883, -1200.5271550943946, -901.7299890327325, -1290.4350793950632, -850.1410275560435, -213.62830769457156, -160.76093999187108, -119.68517201366201, -864.3460026800667, -1110.0220886676095, -453.16496958707677, -470.50920704572906, -1083.038749518565, -544.0176896259162, -308.35014534250666, -612.3496289722418, -576.8196537380123, -117.36829657446009, -439.12092957711474, -595.1751645962757, -669.9728371189402, -806.6892488675252, -806.6845610984774, -479.45939999765903, -12.26905543000068, -172.69090394633673, -1324.7467437093364, -1260.4852867140964, -1320.1965598737415, -616.1584062721984, -1209.509463020173, -600.4944979250241, -1241.7921615234598, -571.7176142914202, -1188.7101090070826, -787.6470929442145, -114.67631557084373, -623.993082366028, -953.6719981789403, -1406.0438008821225, -915.3520595309456, -416.821242935982, -1061.1695969937311, -991.8600685499964, -896.2100472262414, -443.82659066626275, -1546.2082383924862, -906.3565731159084, -1306.0885367843705, -509.08332986767203, -996.797538958434, -406.2473784470803, -1414.8103475637529, -10.768766884989244, -652.184687873098, -704.3095056112231, -603.7578695820619, -768.763905486381, -207.5076336895347, -525.8448713165672, -371.67459370567644, -1104.05791967589, -1152.7823363691027, -631.9501543730789, -1037.399770214435, -504.92902634939315, -1246.6696682711226, -958.8661402075877, -1175.1344683493655, -981.1363905067666, -727.7078604591626, -116.07276476309141, -568.3774531840143, -847.4668057427842, -607.7399763623204, -155.67085862555277, -661.850097927717, -461.0080782274828, -181.18135595373002, -196.08190445091088, -23.160468453874948, -1048.636520887872, -821.4538469974464, -1285.7722683099419, -549.2016844889449, -1307.078766713643, -1137.267252133536, -1170.5533887233419, -933.049667161731, -133.50466294643832, -675.2535789956794, -723.0388291719144, -1031.2314764216153, -10.776262303535317, -733.6500923624055, -118.0810135546401, -1231.4809905821603, -1241.9379174245355, -393.4206259168303, -838.4036369328488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556088414472051, "mean_inference_ms": 1.67492571314733, "mean_action_processing_ms": 0.2772462020120713, "mean_env_wait_ms": 3.4620618043241915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01215982437133789, "StateBufferConnector_ms": 0.008471250534057617, "ViewRequirementAgentConnector_ms": 0.19206881523132324}, "num_episodes": 30, "episode_return_max": -10.768766884989244, "episode_return_min": -1546.2082383924862, "episode_return_mean": -731.8346443548048, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.9809303871053, "num_env_steps_trained_throughput_per_sec": 401.9809303871053, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12604.137, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12604.062, "sample_time_ms": 1144.955, "learn_time_ms": 11391.346, "learn_throughput": 351.144, "synch_weights_time_ms": 66.927}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00009", "date": "2024-08-04_06-21-32", "timestamp": 1722732692, "time_this_iter_s": 9.962618827819824, "time_total_s": 214.3800675868988, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b79a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.3800675868988, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.67142857142857, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.72828075985114, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.435394394397736, "policy_loss": -0.014159874183436234, "vf_loss": 8.441145732998848, "vf_explained_var": 0.6983408826713761, "kl": 0.018995954967734503, "entropy": 1.3964915189892053, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -7.505807685954899, "episode_reward_min": -1546.2082383924862, "episode_reward_mean": -699.9304113526316, "episode_len_mean": 128.42, "episode_media": {}, "episodes_timesteps_total": 12842, "policy_reward_min": {"policy_0": -1546.2082383924862}, "policy_reward_max": {"policy_0": -7.505807685954899}, "policy_reward_mean": {"policy_0": -699.9304113526316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1241.7921615234598, -571.7176142914202, -1188.7101090070826, -787.6470929442145, -114.67631557084373, -623.993082366028, -953.6719981789403, -1406.0438008821225, -915.3520595309456, -416.821242935982, -1061.1695969937311, -991.8600685499964, -896.2100472262414, -443.82659066626275, -1546.2082383924862, -906.3565731159084, -1306.0885367843705, -509.08332986767203, -996.797538958434, -406.2473784470803, -1414.8103475637529, -10.768766884989244, -652.184687873098, -704.3095056112231, -603.7578695820619, -768.763905486381, -207.5076336895347, -525.8448713165672, -371.67459370567644, -1104.05791967589, -1152.7823363691027, -631.9501543730789, -1037.399770214435, -504.92902634939315, -1246.6696682711226, -958.8661402075877, -1175.1344683493655, -981.1363905067666, -727.7078604591626, -116.07276476309141, -568.3774531840143, -847.4668057427842, -607.7399763623204, -155.67085862555277, -661.850097927717, -461.0080782274828, -181.18135595373002, -196.08190445091088, -23.160468453874948, -1048.636520887872, -821.4538469974464, -1285.7722683099419, -549.2016844889449, -1307.078766713643, -1137.267252133536, -1170.5533887233419, -933.049667161731, -133.50466294643832, -675.2535789956794, -723.0388291719144, -1031.2314764216153, -10.776262303535317, -733.6500923624055, -118.0810135546401, -1231.4809905821603, -1241.9379174245355, -393.4206259168303, -838.4036369328488, -1407.5005177449368, -643.580212822059, -423.42442671972907, -59.487079050289815, -34.036299770163225, -596.1900465751658, -134.61221441911854, -658.2729547525621, -395.08530832717963, -985.3893368723192, -1235.0785647986033, -1318.328377600617, -47.21282163700722, -515.1217305887442, -721.3146850110263, -94.41877119046211, -406.6564936828395, -1219.3464449489586, -202.01374506301647, -795.8915638097712, -1019.2087826720827, -1245.3991465395322, -604.6480166429528, -74.92598831299264, -58.49517845578625, -811.4661947818112, -484.03738248036217, -7.505807685954899, -23.907397245881725, -1138.1137720947206, -1159.8913370621851, -205.54899746137235], "episode_lengths": [150, 146, 150, 150, 65, 126, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 67, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 147, 150, 150, 100, 150, 150, 75, 101, 41, 150, 142, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 38, 150, 58, 150, 150, 150, 150, 150, 121, 150, 49, 42, 150, 57, 150, 88, 150, 150, 150, 63, 150, 150, 68, 102, 150, 83, 150, 150, 150, 150, 71, 50, 150, 120, 37, 51, 150, 150, 110], "policy_policy_0_reward": [-1241.7921615234598, -571.7176142914202, -1188.7101090070826, -787.6470929442145, -114.67631557084373, -623.993082366028, -953.6719981789403, -1406.0438008821225, -915.3520595309456, -416.821242935982, -1061.1695969937311, -991.8600685499964, -896.2100472262414, -443.82659066626275, -1546.2082383924862, -906.3565731159084, -1306.0885367843705, -509.08332986767203, -996.797538958434, -406.2473784470803, -1414.8103475637529, -10.768766884989244, -652.184687873098, -704.3095056112231, -603.7578695820619, -768.763905486381, -207.5076336895347, -525.8448713165672, -371.67459370567644, -1104.05791967589, -1152.7823363691027, -631.9501543730789, -1037.399770214435, -504.92902634939315, -1246.6696682711226, -958.8661402075877, -1175.1344683493655, -981.1363905067666, -727.7078604591626, -116.07276476309141, -568.3774531840143, -847.4668057427842, -607.7399763623204, -155.67085862555277, -661.850097927717, -461.0080782274828, -181.18135595373002, -196.08190445091088, -23.160468453874948, -1048.636520887872, -821.4538469974464, -1285.7722683099419, -549.2016844889449, -1307.078766713643, -1137.267252133536, -1170.5533887233419, -933.049667161731, -133.50466294643832, -675.2535789956794, -723.0388291719144, -1031.2314764216153, -10.776262303535317, -733.6500923624055, -118.0810135546401, -1231.4809905821603, -1241.9379174245355, -393.4206259168303, -838.4036369328488, -1407.5005177449368, -643.580212822059, -423.42442671972907, -59.487079050289815, -34.036299770163225, -596.1900465751658, -134.61221441911854, -658.2729547525621, -395.08530832717963, -985.3893368723192, -1235.0785647986033, -1318.328377600617, -47.21282163700722, -515.1217305887442, -721.3146850110263, -94.41877119046211, -406.6564936828395, -1219.3464449489586, -202.01374506301647, -795.8915638097712, -1019.2087826720827, -1245.3991465395322, -604.6480166429528, -74.92598831299264, -58.49517845578625, -811.4661947818112, -484.03738248036217, -7.505807685954899, -23.907397245881725, -1138.1137720947206, -1159.8913370621851, -205.54899746137235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55592222816635, "mean_inference_ms": 1.6756686056537162, "mean_action_processing_ms": 0.277480693231399, "mean_env_wait_ms": 3.4691358791866858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012115955352783203, "StateBufferConnector_ms": 0.008274555206298828, "ViewRequirementAgentConnector_ms": 0.1942129135131836}, "num_episodes": 32, "episode_return_max": -7.505807685954899, "episode_return_min": -1546.2082383924862, "episode_return_mean": -699.9304113526316, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.20992947838494, "num_env_steps_trained_throughput_per_sec": 316.20992947838494, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12560.846, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12560.772, "sample_time_ms": 1148.55, "learn_time_ms": 11344.178, "learn_throughput": 352.604, "synch_weights_time_ms": 67.217}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00009", "date": "2024-08-04_06-21-45", "timestamp": 1722732705, "time_this_iter_s": 12.66268801689148, "time_total_s": 227.04275560379028, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b7490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.04275560379028, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.505555555555556, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.64473335494598, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.690696730216344, "policy_loss": -0.011651488686038648, "vf_loss": 7.695345163345337, "vf_explained_var": 0.6837327799449364, "kl": 0.015886346435581827, "entropy": 1.4581933360546828, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -7.505807685954899, "episode_reward_min": -1485.3836896838823, "episode_reward_mean": -698.8080663962791, "episode_len_mean": 129.08, "episode_media": {}, "episodes_timesteps_total": 12908, "policy_reward_min": {"policy_0": -1485.3836896838823}, "policy_reward_max": {"policy_0": -7.505807685954899}, "policy_reward_mean": {"policy_0": -698.8080663962791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.5076336895347, -525.8448713165672, -371.67459370567644, -1104.05791967589, -1152.7823363691027, -631.9501543730789, -1037.399770214435, -504.92902634939315, -1246.6696682711226, -958.8661402075877, -1175.1344683493655, -981.1363905067666, -727.7078604591626, -116.07276476309141, -568.3774531840143, -847.4668057427842, -607.7399763623204, -155.67085862555277, -661.850097927717, -461.0080782274828, -181.18135595373002, -196.08190445091088, -23.160468453874948, -1048.636520887872, -821.4538469974464, -1285.7722683099419, -549.2016844889449, -1307.078766713643, -1137.267252133536, -1170.5533887233419, -933.049667161731, -133.50466294643832, -675.2535789956794, -723.0388291719144, -1031.2314764216153, -10.776262303535317, -733.6500923624055, -118.0810135546401, -1231.4809905821603, -1241.9379174245355, -393.4206259168303, -838.4036369328488, -1407.5005177449368, -643.580212822059, -423.42442671972907, -59.487079050289815, -34.036299770163225, -596.1900465751658, -134.61221441911854, -658.2729547525621, -395.08530832717963, -985.3893368723192, -1235.0785647986033, -1318.328377600617, -47.21282163700722, -515.1217305887442, -721.3146850110263, -94.41877119046211, -406.6564936828395, -1219.3464449489586, -202.01374506301647, -795.8915638097712, -1019.2087826720827, -1245.3991465395322, -604.6480166429528, -74.92598831299264, -58.49517845578625, -811.4661947818112, -484.03738248036217, -7.505807685954899, -23.907397245881725, -1138.1137720947206, -1159.8913370621851, -205.54899746137235, -700.4785148600672, -1289.6185404062242, -609.4446472256744, -1101.1558816663942, -442.58212681434065, -862.5891730761412, -895.573335699828, -858.2270296983611, -587.3918891817735, -1293.0186524908022, -1332.4981152311452, -1104.1893602259347, -397.75775504377896, -1137.1789467325325, -1241.7827841401536, -554.3327631759341, -1485.3836896838823, -1292.2578354625998, -640.8627825479532, -125.69050718425754, -549.7479570918812, -1238.8984255254713, -515.7964135481889, -100.88004543615291, -464.7335572309401, -504.5632342190765], "episode_lengths": [67, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 147, 150, 150, 100, 150, 150, 75, 101, 41, 150, 142, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 38, 150, 58, 150, 150, 150, 150, 150, 121, 150, 49, 42, 150, 57, 150, 88, 150, 150, 150, 63, 150, 150, 68, 102, 150, 83, 150, 150, 150, 150, 71, 50, 150, 120, 37, 51, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 77, 150, 106], "policy_policy_0_reward": [-207.5076336895347, -525.8448713165672, -371.67459370567644, -1104.05791967589, -1152.7823363691027, -631.9501543730789, -1037.399770214435, -504.92902634939315, -1246.6696682711226, -958.8661402075877, -1175.1344683493655, -981.1363905067666, -727.7078604591626, -116.07276476309141, -568.3774531840143, -847.4668057427842, -607.7399763623204, -155.67085862555277, -661.850097927717, -461.0080782274828, -181.18135595373002, -196.08190445091088, -23.160468453874948, -1048.636520887872, -821.4538469974464, -1285.7722683099419, -549.2016844889449, -1307.078766713643, -1137.267252133536, -1170.5533887233419, -933.049667161731, -133.50466294643832, -675.2535789956794, -723.0388291719144, -1031.2314764216153, -10.776262303535317, -733.6500923624055, -118.0810135546401, -1231.4809905821603, -1241.9379174245355, -393.4206259168303, -838.4036369328488, -1407.5005177449368, -643.580212822059, -423.42442671972907, -59.487079050289815, -34.036299770163225, -596.1900465751658, -134.61221441911854, -658.2729547525621, -395.08530832717963, -985.3893368723192, -1235.0785647986033, -1318.328377600617, -47.21282163700722, -515.1217305887442, -721.3146850110263, -94.41877119046211, -406.6564936828395, -1219.3464449489586, -202.01374506301647, -795.8915638097712, -1019.2087826720827, -1245.3991465395322, -604.6480166429528, -74.92598831299264, -58.49517845578625, -811.4661947818112, -484.03738248036217, -7.505807685954899, -23.907397245881725, -1138.1137720947206, -1159.8913370621851, -205.54899746137235, -700.4785148600672, -1289.6185404062242, -609.4446472256744, -1101.1558816663942, -442.58212681434065, -862.5891730761412, -895.573335699828, -858.2270296983611, -587.3918891817735, -1293.0186524908022, -1332.4981152311452, -1104.1893602259347, -397.75775504377896, -1137.1789467325325, -1241.7827841401536, -554.3327631759341, -1485.3836896838823, -1292.2578354625998, -640.8627825479532, -125.69050718425754, -549.7479570918812, -1238.8984255254713, -515.7964135481889, -100.88004543615291, -464.7335572309401, -504.5632342190765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556990574448419, "mean_inference_ms": 1.6752667419885947, "mean_action_processing_ms": 0.2772852030615728, "mean_env_wait_ms": 3.4688314892006167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012413978576660156, "StateBufferConnector_ms": 0.008175373077392578, "ViewRequirementAgentConnector_ms": 0.2008531093597412}, "num_episodes": 26, "episode_return_max": -7.505807685954899, "episode_return_min": -1485.3836896838823, "episode_return_mean": -698.8080663962791, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.43857658989856, "num_env_steps_trained_throughput_per_sec": 303.43857658989856, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12573.41, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12573.337, "sample_time_ms": 1148.457, "learn_time_ms": 11356.545, "learn_throughput": 352.22, "synch_weights_time_ms": 67.514}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00009", "date": "2024-08-04_06-21-58", "timestamp": 1722732718, "time_this_iter_s": 13.19456434249878, "time_total_s": 240.23731994628906, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1b6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.23731994628906, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.247368421052627, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.112945088247457, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.642102956771851, "policy_loss": -0.011956492226454429, "vf_loss": 7.646818088491758, "vf_explained_var": 0.7650064911072453, "kl": 0.016363084238158413, "entropy": 1.2204558985307812, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -3.5149132071016416, "episode_reward_min": -1485.3836896838823, "episode_reward_mean": -672.1703842005636, "episode_len_mean": 129.82, "episode_media": {}, "episodes_timesteps_total": 12982, "policy_reward_min": {"policy_0": -1485.3836896838823}, "policy_reward_max": {"policy_0": -3.5149132071016416}, "policy_reward_mean": {"policy_0": -672.1703842005636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1231.4809905821603, -1241.9379174245355, -393.4206259168303, -838.4036369328488, -1407.5005177449368, -643.580212822059, -423.42442671972907, -59.487079050289815, -34.036299770163225, -596.1900465751658, -134.61221441911854, -658.2729547525621, -395.08530832717963, -985.3893368723192, -1235.0785647986033, -1318.328377600617, -47.21282163700722, -515.1217305887442, -721.3146850110263, -94.41877119046211, -406.6564936828395, -1219.3464449489586, -202.01374506301647, -795.8915638097712, -1019.2087826720827, -1245.3991465395322, -604.6480166429528, -74.92598831299264, -58.49517845578625, -811.4661947818112, -484.03738248036217, -7.505807685954899, -23.907397245881725, -1138.1137720947206, -1159.8913370621851, -205.54899746137235, -700.4785148600672, -1289.6185404062242, -609.4446472256744, -1101.1558816663942, -442.58212681434065, -862.5891730761412, -895.573335699828, -858.2270296983611, -587.3918891817735, -1293.0186524908022, -1332.4981152311452, -1104.1893602259347, -397.75775504377896, -1137.1789467325325, -1241.7827841401536, -554.3327631759341, -1485.3836896838823, -1292.2578354625998, -640.8627825479532, -125.69050718425754, -549.7479570918812, -1238.8984255254713, -515.7964135481889, -100.88004543615291, -464.7335572309401, -504.5632342190765, -1312.212129530259, -646.4150049017594, -605.1773589037257, -51.706199605069195, -533.3183953553278, -585.0631043654998, -636.8253139303307, -233.28893564425942, -697.7125826235253, -88.82225900907065, -3.5149132071016416, -476.90934649736437, -1157.2963648384232, -950.3333244305538, -112.2611002845226, -465.11946026700474, -452.0876596154173, -1306.9984770132514, -181.12219961069422, -1132.0422510181902, -952.5734612646073, -332.13504823035606, -609.1905754127722, -585.1327920243396, -1149.6614729174207, -715.4044005424328, -978.1544201309738, -564.9366235899696, -1276.4152554256082, -151.5537340191647, -503.52288693536826, -108.96714220388806, -951.2007580690342, -597.252261748418, -775.7138660507443, -491.4705167122984, -579.2091927420674, -508.33090010945705], "episode_lengths": [150, 150, 150, 150, 150, 121, 150, 49, 42, 150, 57, 150, 88, 150, 150, 150, 63, 150, 150, 68, 102, 150, 83, 150, 150, 150, 150, 71, 50, 150, 120, 37, 51, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 77, 150, 106, 150, 150, 150, 48, 150, 126, 150, 110, 150, 75, 33, 150, 150, 150, 68, 150, 150, 150, 94, 150, 150, 96, 150, 150, 150, 140, 150, 150, 150, 98, 150, 67, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1231.4809905821603, -1241.9379174245355, -393.4206259168303, -838.4036369328488, -1407.5005177449368, -643.580212822059, -423.42442671972907, -59.487079050289815, -34.036299770163225, -596.1900465751658, -134.61221441911854, -658.2729547525621, -395.08530832717963, -985.3893368723192, -1235.0785647986033, -1318.328377600617, -47.21282163700722, -515.1217305887442, -721.3146850110263, -94.41877119046211, -406.6564936828395, -1219.3464449489586, -202.01374506301647, -795.8915638097712, -1019.2087826720827, -1245.3991465395322, -604.6480166429528, -74.92598831299264, -58.49517845578625, -811.4661947818112, -484.03738248036217, -7.505807685954899, -23.907397245881725, -1138.1137720947206, -1159.8913370621851, -205.54899746137235, -700.4785148600672, -1289.6185404062242, -609.4446472256744, -1101.1558816663942, -442.58212681434065, -862.5891730761412, -895.573335699828, -858.2270296983611, -587.3918891817735, -1293.0186524908022, -1332.4981152311452, -1104.1893602259347, -397.75775504377896, -1137.1789467325325, -1241.7827841401536, -554.3327631759341, -1485.3836896838823, -1292.2578354625998, -640.8627825479532, -125.69050718425754, -549.7479570918812, -1238.8984255254713, -515.7964135481889, -100.88004543615291, -464.7335572309401, -504.5632342190765, -1312.212129530259, -646.4150049017594, -605.1773589037257, -51.706199605069195, -533.3183953553278, -585.0631043654998, -636.8253139303307, -233.28893564425942, -697.7125826235253, -88.82225900907065, -3.5149132071016416, -476.90934649736437, -1157.2963648384232, -950.3333244305538, -112.2611002845226, -465.11946026700474, -452.0876596154173, -1306.9984770132514, -181.12219961069422, -1132.0422510181902, -952.5734612646073, -332.13504823035606, -609.1905754127722, -585.1327920243396, -1149.6614729174207, -715.4044005424328, -978.1544201309738, -564.9366235899696, -1276.4152554256082, -151.5537340191647, -503.52288693536826, -108.96714220388806, -951.2007580690342, -597.252261748418, -775.7138660507443, -491.4705167122984, -579.2091927420674, -508.33090010945705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551745087846323, "mean_inference_ms": 1.67515654677629, "mean_action_processing_ms": 0.2771430517128216, "mean_env_wait_ms": 3.4709930577329358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012315988540649414, "StateBufferConnector_ms": 0.007849931716918945, "ViewRequirementAgentConnector_ms": 0.20125889778137207}, "num_episodes": 38, "episode_return_max": -3.5149132071016416, "episode_return_min": -1485.3836896838823, "episode_return_mean": -672.1703842005636, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.68696032991784, "num_env_steps_trained_throughput_per_sec": 302.68696032991784, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12585.79, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12585.719, "sample_time_ms": 1145.351, "learn_time_ms": 11372.484, "learn_throughput": 351.726, "synch_weights_time_ms": 67.061}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00009", "date": "2024-08-04_06-22-11", "timestamp": 1722732731, "time_this_iter_s": 13.22848629951477, "time_total_s": 253.46580624580383, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b71c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.46580624580383, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.13888888888889, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.811942689617474, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.652731269101301, "policy_loss": -0.013732089205101753, "vf_loss": 7.658769717315833, "vf_explained_var": 0.6447808584198356, "kl": 0.017457542466703096, "entropy": 1.622467311595877, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -3.5149132071016416, "episode_reward_min": -1485.3836896838823, "episode_reward_mean": -707.5719264685848, "episode_len_mean": 134.9, "episode_media": {}, "episodes_timesteps_total": 13490, "policy_reward_min": {"policy_0": -1485.3836896838823}, "policy_reward_max": {"policy_0": -3.5149132071016416}, "policy_reward_mean": {"policy_0": -707.5719264685848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1245.3991465395322, -604.6480166429528, -74.92598831299264, -58.49517845578625, -811.4661947818112, -484.03738248036217, -7.505807685954899, -23.907397245881725, -1138.1137720947206, -1159.8913370621851, -205.54899746137235, -700.4785148600672, -1289.6185404062242, -609.4446472256744, -1101.1558816663942, -442.58212681434065, -862.5891730761412, -895.573335699828, -858.2270296983611, -587.3918891817735, -1293.0186524908022, -1332.4981152311452, -1104.1893602259347, -397.75775504377896, -1137.1789467325325, -1241.7827841401536, -554.3327631759341, -1485.3836896838823, -1292.2578354625998, -640.8627825479532, -125.69050718425754, -549.7479570918812, -1238.8984255254713, -515.7964135481889, -100.88004543615291, -464.7335572309401, -504.5632342190765, -1312.212129530259, -646.4150049017594, -605.1773589037257, -51.706199605069195, -533.3183953553278, -585.0631043654998, -636.8253139303307, -233.28893564425942, -697.7125826235253, -88.82225900907065, -3.5149132071016416, -476.90934649736437, -1157.2963648384232, -950.3333244305538, -112.2611002845226, -465.11946026700474, -452.0876596154173, -1306.9984770132514, -181.12219961069422, -1132.0422510181902, -952.5734612646073, -332.13504823035606, -609.1905754127722, -585.1327920243396, -1149.6614729174207, -715.4044005424328, -978.1544201309738, -564.9366235899696, -1276.4152554256082, -151.5537340191647, -503.52288693536826, -108.96714220388806, -951.2007580690342, -597.252261748418, -775.7138660507443, -491.4705167122984, -579.2091927420674, -508.33090010945705, -569.7034558346868, -789.3944655767132, -531.935408993722, -685.9081743678097, -493.26446545333846, -672.7153811164733, -79.78492394291823, -720.4585847456192, -1128.972701844067, -1138.3428285602881, -797.5771751495103, -1353.1641175437417, -830.6518166343903, -1310.104783438649, -857.6598168943507, -546.6782015397857, -838.533288894949, -1078.1179669524784, -733.79338159316, -644.083286882001, -938.5168648557759, -169.641852051839, -1149.6014349279476, -1189.9352118695335, -909.0281860514169], "episode_lengths": [150, 150, 71, 50, 150, 120, 37, 51, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 77, 150, 106, 150, 150, 150, 48, 150, 126, 150, 110, 150, 75, 33, 150, 150, 150, 68, 150, 150, 150, 94, 150, 150, 96, 150, 150, 150, 140, 150, 150, 150, 98, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150], "policy_policy_0_reward": [-1245.3991465395322, -604.6480166429528, -74.92598831299264, -58.49517845578625, -811.4661947818112, -484.03738248036217, -7.505807685954899, -23.907397245881725, -1138.1137720947206, -1159.8913370621851, -205.54899746137235, -700.4785148600672, -1289.6185404062242, -609.4446472256744, -1101.1558816663942, -442.58212681434065, -862.5891730761412, -895.573335699828, -858.2270296983611, -587.3918891817735, -1293.0186524908022, -1332.4981152311452, -1104.1893602259347, -397.75775504377896, -1137.1789467325325, -1241.7827841401536, -554.3327631759341, -1485.3836896838823, -1292.2578354625998, -640.8627825479532, -125.69050718425754, -549.7479570918812, -1238.8984255254713, -515.7964135481889, -100.88004543615291, -464.7335572309401, -504.5632342190765, -1312.212129530259, -646.4150049017594, -605.1773589037257, -51.706199605069195, -533.3183953553278, -585.0631043654998, -636.8253139303307, -233.28893564425942, -697.7125826235253, -88.82225900907065, -3.5149132071016416, -476.90934649736437, -1157.2963648384232, -950.3333244305538, -112.2611002845226, -465.11946026700474, -452.0876596154173, -1306.9984770132514, -181.12219961069422, -1132.0422510181902, -952.5734612646073, -332.13504823035606, -609.1905754127722, -585.1327920243396, -1149.6614729174207, -715.4044005424328, -978.1544201309738, -564.9366235899696, -1276.4152554256082, -151.5537340191647, -503.52288693536826, -108.96714220388806, -951.2007580690342, -597.252261748418, -775.7138660507443, -491.4705167122984, -579.2091927420674, -508.33090010945705, -569.7034558346868, -789.3944655767132, -531.935408993722, -685.9081743678097, -493.26446545333846, -672.7153811164733, -79.78492394291823, -720.4585847456192, -1128.972701844067, -1138.3428285602881, -797.5771751495103, -1353.1641175437417, -830.6518166343903, -1310.104783438649, -857.6598168943507, -546.6782015397857, -838.533288894949, -1078.1179669524784, -733.79338159316, -644.083286882001, -938.5168648557759, -169.641852051839, -1149.6014349279476, -1189.9352118695335, -909.0281860514169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55489347668004, "mean_inference_ms": 1.674953052455525, "mean_action_processing_ms": 0.27717695110064644, "mean_env_wait_ms": 3.4720365096635017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011989593505859375, "StateBufferConnector_ms": 0.007831573486328125, "ViewRequirementAgentConnector_ms": 0.20036911964416504}, "num_episodes": 25, "episode_return_max": -3.5149132071016416, "episode_return_min": -1485.3836896838823, "episode_return_mean": -707.5719264685848, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8931310672855, "num_env_steps_trained_throughput_per_sec": 302.8931310672855, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12591.628, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12591.557, "sample_time_ms": 1149.88, "learn_time_ms": 11374.706, "learn_throughput": 351.657, "synch_weights_time_ms": 66.15}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00009", "date": "2024-08-04_06-22-24", "timestamp": 1722732744, "time_this_iter_s": 13.217700719833374, "time_total_s": 266.6835069656372, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b7250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.6835069656372, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.32105263157895, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.15194024393956, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.5121451263626415, "policy_loss": -0.00637239460775163, "vf_loss": 7.51263972868522, "vf_explained_var": 0.7018934583291412, "kl": 0.013386290312943553, "entropy": 1.4605587917069593, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -3.5149132071016416, "episode_reward_min": -1424.160384335872, "episode_reward_mean": -706.4324065871768, "episode_len_mean": 136.42, "episode_media": {}, "episodes_timesteps_total": 13642, "policy_reward_min": {"policy_0": -1424.160384335872}, "policy_reward_max": {"policy_0": -3.5149132071016416}, "policy_reward_mean": {"policy_0": -706.4324065871768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-640.8627825479532, -125.69050718425754, -549.7479570918812, -1238.8984255254713, -515.7964135481889, -100.88004543615291, -464.7335572309401, -504.5632342190765, -1312.212129530259, -646.4150049017594, -605.1773589037257, -51.706199605069195, -533.3183953553278, -585.0631043654998, -636.8253139303307, -233.28893564425942, -697.7125826235253, -88.82225900907065, -3.5149132071016416, -476.90934649736437, -1157.2963648384232, -950.3333244305538, -112.2611002845226, -465.11946026700474, -452.0876596154173, -1306.9984770132514, -181.12219961069422, -1132.0422510181902, -952.5734612646073, -332.13504823035606, -609.1905754127722, -585.1327920243396, -1149.6614729174207, -715.4044005424328, -978.1544201309738, -564.9366235899696, -1276.4152554256082, -151.5537340191647, -503.52288693536826, -108.96714220388806, -951.2007580690342, -597.252261748418, -775.7138660507443, -491.4705167122984, -579.2091927420674, -508.33090010945705, -569.7034558346868, -789.3944655767132, -531.935408993722, -685.9081743678097, -493.26446545333846, -672.7153811164733, -79.78492394291823, -720.4585847456192, -1128.972701844067, -1138.3428285602881, -797.5771751495103, -1353.1641175437417, -830.6518166343903, -1310.104783438649, -857.6598168943507, -546.6782015397857, -838.533288894949, -1078.1179669524784, -733.79338159316, -644.083286882001, -938.5168648557759, -169.641852051839, -1149.6014349279476, -1189.9352118695335, -909.0281860514169, -544.3136458474928, -207.49358794390096, -697.9416652947938, -691.108713211775, -1424.160384335872, -1067.4140573739926, -558.1828313580032, -83.13144819549196, -1375.3023154822097, -435.26858622019614, -1212.3284722158298, -989.3297781198268, -616.9187425973947, -743.0799689286292, -602.9070953781527, -1384.7671442806814, -1065.723123478524, -996.8192221443848, -784.716330706886, -1412.5491773673234, -686.8423793697368, -842.955294090415, -833.4989364548792, -735.630655311057, -131.0967936322445, -92.65412263345011, -895.4331194106584, -1167.3680417827259, -606.512638271792], "episode_lengths": [150, 82, 150, 150, 150, 77, 150, 106, 150, 150, 150, 48, 150, 126, 150, 110, 150, 75, 33, 150, 150, 150, 68, 150, 150, 150, 94, 150, 150, 96, 150, 150, 150, 140, 150, 150, 150, 98, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 104, 150, 139, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 65, 150, 150, 135], "policy_policy_0_reward": [-640.8627825479532, -125.69050718425754, -549.7479570918812, -1238.8984255254713, -515.7964135481889, -100.88004543615291, -464.7335572309401, -504.5632342190765, -1312.212129530259, -646.4150049017594, -605.1773589037257, -51.706199605069195, -533.3183953553278, -585.0631043654998, -636.8253139303307, -233.28893564425942, -697.7125826235253, -88.82225900907065, -3.5149132071016416, -476.90934649736437, -1157.2963648384232, -950.3333244305538, -112.2611002845226, -465.11946026700474, -452.0876596154173, -1306.9984770132514, -181.12219961069422, -1132.0422510181902, -952.5734612646073, -332.13504823035606, -609.1905754127722, -585.1327920243396, -1149.6614729174207, -715.4044005424328, -978.1544201309738, -564.9366235899696, -1276.4152554256082, -151.5537340191647, -503.52288693536826, -108.96714220388806, -951.2007580690342, -597.252261748418, -775.7138660507443, -491.4705167122984, -579.2091927420674, -508.33090010945705, -569.7034558346868, -789.3944655767132, -531.935408993722, -685.9081743678097, -493.26446545333846, -672.7153811164733, -79.78492394291823, -720.4585847456192, -1128.972701844067, -1138.3428285602881, -797.5771751495103, -1353.1641175437417, -830.6518166343903, -1310.104783438649, -857.6598168943507, -546.6782015397857, -838.533288894949, -1078.1179669524784, -733.79338159316, -644.083286882001, -938.5168648557759, -169.641852051839, -1149.6014349279476, -1189.9352118695335, -909.0281860514169, -544.3136458474928, -207.49358794390096, -697.9416652947938, -691.108713211775, -1424.160384335872, -1067.4140573739926, -558.1828313580032, -83.13144819549196, -1375.3023154822097, -435.26858622019614, -1212.3284722158298, -989.3297781198268, -616.9187425973947, -743.0799689286292, -602.9070953781527, -1384.7671442806814, -1065.723123478524, -996.8192221443848, -784.716330706886, -1412.5491773673234, -686.8423793697368, -842.955294090415, -833.4989364548792, -735.630655311057, -131.0967936322445, -92.65412263345011, -895.4331194106584, -1167.3680417827259, -606.512638271792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551021784461541, "mean_inference_ms": 1.674118011523561, "mean_action_processing_ms": 0.27708972649527935, "mean_env_wait_ms": 3.473314331243675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011778593063354492, "StateBufferConnector_ms": 0.007859468460083008, "ViewRequirementAgentConnector_ms": 0.199737548828125}, "num_episodes": 29, "episode_return_max": -3.5149132071016416, "episode_return_min": -1424.160384335872, "episode_return_mean": -706.4324065871768, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.71955514466765, "num_env_steps_trained_throughput_per_sec": 310.71955514466765, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12589.678, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12589.607, "sample_time_ms": 1150.707, "learn_time_ms": 11371.2, "learn_throughput": 351.766, "synch_weights_time_ms": 66.871}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00009", "date": "2024-08-04_06-22-37", "timestamp": 1722732757, "time_this_iter_s": 12.886183023452759, "time_total_s": 279.56968998908997, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b6200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.56968998908997, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.13157894736842, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.2890990421176, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.347204078237215, "policy_loss": -0.004815562368215372, "vf_loss": 7.346427276730537, "vf_explained_var": 0.6374033870175481, "kl": 0.012781001039547872, "entropy": 1.59074958289663, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -79.78492394291823, "episode_reward_min": -1493.1228652262182, "episode_reward_mean": -765.0433494018729, "episode_len_mean": 140.98, "episode_media": {}, "episodes_timesteps_total": 14098, "policy_reward_min": {"policy_0": -1493.1228652262182}, "policy_reward_max": {"policy_0": -79.78492394291823}, "policy_reward_mean": {"policy_0": -765.0433494018729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.12219961069422, -1132.0422510181902, -952.5734612646073, -332.13504823035606, -609.1905754127722, -585.1327920243396, -1149.6614729174207, -715.4044005424328, -978.1544201309738, -564.9366235899696, -1276.4152554256082, -151.5537340191647, -503.52288693536826, -108.96714220388806, -951.2007580690342, -597.252261748418, -775.7138660507443, -491.4705167122984, -579.2091927420674, -508.33090010945705, -569.7034558346868, -789.3944655767132, -531.935408993722, -685.9081743678097, -493.26446545333846, -672.7153811164733, -79.78492394291823, -720.4585847456192, -1128.972701844067, -1138.3428285602881, -797.5771751495103, -1353.1641175437417, -830.6518166343903, -1310.104783438649, -857.6598168943507, -546.6782015397857, -838.533288894949, -1078.1179669524784, -733.79338159316, -644.083286882001, -938.5168648557759, -169.641852051839, -1149.6014349279476, -1189.9352118695335, -909.0281860514169, -544.3136458474928, -207.49358794390096, -697.9416652947938, -691.108713211775, -1424.160384335872, -1067.4140573739926, -558.1828313580032, -83.13144819549196, -1375.3023154822097, -435.26858622019614, -1212.3284722158298, -989.3297781198268, -616.9187425973947, -743.0799689286292, -602.9070953781527, -1384.7671442806814, -1065.723123478524, -996.8192221443848, -784.716330706886, -1412.5491773673234, -686.8423793697368, -842.955294090415, -833.4989364548792, -735.630655311057, -131.0967936322445, -92.65412263345011, -895.4331194106584, -1167.3680417827259, -606.512638271792, -670.247759247373, -429.9361357556553, -678.1487066036611, -716.9464927085539, -1493.1228652262182, -207.00024941023239, -562.7510518853715, -630.9124619926133, -639.5678115825056, -657.9860049713402, -685.1061966747654, -1290.977455455586, -678.523526726553, -521.5574494077558, -895.5724096305966, -1297.8462726687424, -1213.4764187300389, -635.3361912882407, -561.3850262235408, -1258.8220221825743, -690.8781707705176, -714.0457158949221, -267.52477314894173, -988.5236279759182, -1300.4600171517227, -630.6743209620589], "episode_lengths": [94, 150, 150, 96, 150, 150, 150, 140, 150, 150, 150, 98, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 104, 150, 139, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 65, 150, 150, 135, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150], "policy_policy_0_reward": [-181.12219961069422, -1132.0422510181902, -952.5734612646073, -332.13504823035606, -609.1905754127722, -585.1327920243396, -1149.6614729174207, -715.4044005424328, -978.1544201309738, -564.9366235899696, -1276.4152554256082, -151.5537340191647, -503.52288693536826, -108.96714220388806, -951.2007580690342, -597.252261748418, -775.7138660507443, -491.4705167122984, -579.2091927420674, -508.33090010945705, -569.7034558346868, -789.3944655767132, -531.935408993722, -685.9081743678097, -493.26446545333846, -672.7153811164733, -79.78492394291823, -720.4585847456192, -1128.972701844067, -1138.3428285602881, -797.5771751495103, -1353.1641175437417, -830.6518166343903, -1310.104783438649, -857.6598168943507, -546.6782015397857, -838.533288894949, -1078.1179669524784, -733.79338159316, -644.083286882001, -938.5168648557759, -169.641852051839, -1149.6014349279476, -1189.9352118695335, -909.0281860514169, -544.3136458474928, -207.49358794390096, -697.9416652947938, -691.108713211775, -1424.160384335872, -1067.4140573739926, -558.1828313580032, -83.13144819549196, -1375.3023154822097, -435.26858622019614, -1212.3284722158298, -989.3297781198268, -616.9187425973947, -743.0799689286292, -602.9070953781527, -1384.7671442806814, -1065.723123478524, -996.8192221443848, -784.716330706886, -1412.5491773673234, -686.8423793697368, -842.955294090415, -833.4989364548792, -735.630655311057, -131.0967936322445, -92.65412263345011, -895.4331194106584, -1167.3680417827259, -606.512638271792, -670.247759247373, -429.9361357556553, -678.1487066036611, -716.9464927085539, -1493.1228652262182, -207.00024941023239, -562.7510518853715, -630.9124619926133, -639.5678115825056, -657.9860049713402, -685.1061966747654, -1290.977455455586, -678.523526726553, -521.5574494077558, -895.5724096305966, -1297.8462726687424, -1213.4764187300389, -635.3361912882407, -561.3850262235408, -1258.8220221825743, -690.8781707705176, -714.0457158949221, -267.52477314894173, -988.5236279759182, -1300.4600171517227, -630.6743209620589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554102768326125, "mean_inference_ms": 1.6730645689401842, "mean_action_processing_ms": 0.2765400069257925, "mean_env_wait_ms": 3.47468232866694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012198448181152344, "StateBufferConnector_ms": 0.007851600646972656, "ViewRequirementAgentConnector_ms": 0.19147086143493652}, "num_episodes": 26, "episode_return_max": -79.78492394291823, "episode_return_min": -1493.1228652262182, "episode_return_mean": -765.0433494018729, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.51994161503796, "num_env_steps_trained_throughput_per_sec": 307.51994161503796, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12556.918, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12556.847, "sample_time_ms": 1146.449, "learn_time_ms": 11343.14, "learn_throughput": 352.636, "synch_weights_time_ms": 66.433}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00009", "date": "2024-08-04_06-22-50", "timestamp": 1722732770, "time_this_iter_s": 13.020323753356934, "time_total_s": 292.5900137424469, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1a440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.5900137424469, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.233333333333334, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.06866478423277, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.397218763828278, "policy_loss": -0.012365729662027055, "vf_loss": 7.402909631530444, "vf_explained_var": 0.6563521346698205, "kl": 0.015197736646769067, "entropy": 1.6410323372731606, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -72.30214895417122, "episode_reward_min": -1493.1228652262182, "episode_reward_mean": -815.6253938758326, "episode_len_mean": 142.08, "episode_media": {}, "episodes_timesteps_total": 14208, "policy_reward_min": {"policy_0": -1493.1228652262182}, "policy_reward_max": {"policy_0": -72.30214895417122}, "policy_reward_mean": {"policy_0": -815.6253938758326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-797.5771751495103, -1353.1641175437417, -830.6518166343903, -1310.104783438649, -857.6598168943507, -546.6782015397857, -838.533288894949, -1078.1179669524784, -733.79338159316, -644.083286882001, -938.5168648557759, -169.641852051839, -1149.6014349279476, -1189.9352118695335, -909.0281860514169, -544.3136458474928, -207.49358794390096, -697.9416652947938, -691.108713211775, -1424.160384335872, -1067.4140573739926, -558.1828313580032, -83.13144819549196, -1375.3023154822097, -435.26858622019614, -1212.3284722158298, -989.3297781198268, -616.9187425973947, -743.0799689286292, -602.9070953781527, -1384.7671442806814, -1065.723123478524, -996.8192221443848, -784.716330706886, -1412.5491773673234, -686.8423793697368, -842.955294090415, -833.4989364548792, -735.630655311057, -131.0967936322445, -92.65412263345011, -895.4331194106584, -1167.3680417827259, -606.512638271792, -670.247759247373, -429.9361357556553, -678.1487066036611, -716.9464927085539, -1493.1228652262182, -207.00024941023239, -562.7510518853715, -630.9124619926133, -639.5678115825056, -657.9860049713402, -685.1061966747654, -1290.977455455586, -678.523526726553, -521.5574494077558, -895.5724096305966, -1297.8462726687424, -1213.4764187300389, -635.3361912882407, -561.3850262235408, -1258.8220221825743, -690.8781707705176, -714.0457158949221, -267.52477314894173, -988.5236279759182, -1300.4600171517227, -630.6743209620589, -1257.9252598522824, -538.0707025496056, -438.43384158837137, -1447.0987930991557, -743.39081391714, -809.1616428895737, -579.7497533114047, -663.5868572876731, -601.5412218355434, -1097.9390712874078, -959.4568408714686, -72.30214895417122, -616.0891158970479, -1076.7077948870644, -1010.4600893537591, -553.1996654130951, -502.76089561939426, -1457.5820620189563, -631.2300199758133, -1364.133332723898, -479.44011108952895, -140.78803522923374, -1110.776108679112, -752.4288252348929, -679.3510433691656, -1009.0045734521473, -1295.8946041203371, -1051.9281176015666, -854.7313845773291, -1217.5118699032812], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 104, 150, 139, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 65, 150, 150, 135, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 118, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-797.5771751495103, -1353.1641175437417, -830.6518166343903, -1310.104783438649, -857.6598168943507, -546.6782015397857, -838.533288894949, -1078.1179669524784, -733.79338159316, -644.083286882001, -938.5168648557759, -169.641852051839, -1149.6014349279476, -1189.9352118695335, -909.0281860514169, -544.3136458474928, -207.49358794390096, -697.9416652947938, -691.108713211775, -1424.160384335872, -1067.4140573739926, -558.1828313580032, -83.13144819549196, -1375.3023154822097, -435.26858622019614, -1212.3284722158298, -989.3297781198268, -616.9187425973947, -743.0799689286292, -602.9070953781527, -1384.7671442806814, -1065.723123478524, -996.8192221443848, -784.716330706886, -1412.5491773673234, -686.8423793697368, -842.955294090415, -833.4989364548792, -735.630655311057, -131.0967936322445, -92.65412263345011, -895.4331194106584, -1167.3680417827259, -606.512638271792, -670.247759247373, -429.9361357556553, -678.1487066036611, -716.9464927085539, -1493.1228652262182, -207.00024941023239, -562.7510518853715, -630.9124619926133, -639.5678115825056, -657.9860049713402, -685.1061966747654, -1290.977455455586, -678.523526726553, -521.5574494077558, -895.5724096305966, -1297.8462726687424, -1213.4764187300389, -635.3361912882407, -561.3850262235408, -1258.8220221825743, -690.8781707705176, -714.0457158949221, -267.52477314894173, -988.5236279759182, -1300.4600171517227, -630.6743209620589, -1257.9252598522824, -538.0707025496056, -438.43384158837137, -1447.0987930991557, -743.39081391714, -809.1616428895737, -579.7497533114047, -663.5868572876731, -601.5412218355434, -1097.9390712874078, -959.4568408714686, -72.30214895417122, -616.0891158970479, -1076.7077948870644, -1010.4600893537591, -553.1996654130951, -502.76089561939426, -1457.5820620189563, -631.2300199758133, -1364.133332723898, -479.44011108952895, -140.78803522923374, -1110.776108679112, -752.4288252348929, -679.3510433691656, -1009.0045734521473, -1295.8946041203371, -1051.9281176015666, -854.7313845773291, -1217.5118699032812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538790510412445, "mean_inference_ms": 1.6724900211819158, "mean_action_processing_ms": 0.27640504213408645, "mean_env_wait_ms": 3.479114912643352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012135982513427734, "StateBufferConnector_ms": 0.00792074203491211, "ViewRequirementAgentConnector_ms": 0.19067835807800293}, "num_episodes": 30, "episode_return_max": -72.30214895417122, "episode_return_min": -1493.1228652262182, "episode_return_mean": -815.6253938758326, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.3301116937172, "num_env_steps_trained_throughput_per_sec": 304.3301116937172, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12561.598, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12561.527, "sample_time_ms": 1163.41, "learn_time_ms": 11329.141, "learn_throughput": 353.072, "synch_weights_time_ms": 68.141}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00009", "date": "2024-08-04_06-23-04", "timestamp": 1722732784, "time_this_iter_s": 13.156193971633911, "time_total_s": 305.7462077140808, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.7462077140808, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.44736842105263, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.74513018031915, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.017212981482347, "policy_loss": -0.0127630791219417, "vf_loss": 7.021994776030382, "vf_explained_var": 0.7852335090438525, "kl": 0.018041238773882196, "entropy": 1.3727334306264918, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -10.003800393045564, "episode_reward_min": -1493.1228652262182, "episode_reward_mean": -759.3980463547326, "episode_len_mean": 137.01, "episode_media": {}, "episodes_timesteps_total": 13701, "policy_reward_min": {"policy_0": -1493.1228652262182}, "policy_reward_max": {"policy_0": -10.003800393045564}, "policy_reward_mean": {"policy_0": -759.3980463547326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1384.7671442806814, -1065.723123478524, -996.8192221443848, -784.716330706886, -1412.5491773673234, -686.8423793697368, -842.955294090415, -833.4989364548792, -735.630655311057, -131.0967936322445, -92.65412263345011, -895.4331194106584, -1167.3680417827259, -606.512638271792, -670.247759247373, -429.9361357556553, -678.1487066036611, -716.9464927085539, -1493.1228652262182, -207.00024941023239, -562.7510518853715, -630.9124619926133, -639.5678115825056, -657.9860049713402, -685.1061966747654, -1290.977455455586, -678.523526726553, -521.5574494077558, -895.5724096305966, -1297.8462726687424, -1213.4764187300389, -635.3361912882407, -561.3850262235408, -1258.8220221825743, -690.8781707705176, -714.0457158949221, -267.52477314894173, -988.5236279759182, -1300.4600171517227, -630.6743209620589, -1257.9252598522824, -538.0707025496056, -438.43384158837137, -1447.0987930991557, -743.39081391714, -809.1616428895737, -579.7497533114047, -663.5868572876731, -601.5412218355434, -1097.9390712874078, -959.4568408714686, -72.30214895417122, -616.0891158970479, -1076.7077948870644, -1010.4600893537591, -553.1996654130951, -502.76089561939426, -1457.5820620189563, -631.2300199758133, -1364.133332723898, -479.44011108952895, -140.78803522923374, -1110.776108679112, -752.4288252348929, -679.3510433691656, -1009.0045734521473, -1295.8946041203371, -1051.9281176015666, -854.7313845773291, -1217.5118699032812, -649.5866722738647, -10.003800393045564, -1451.4561354466289, -504.91803046927583, -540.3275867926639, -702.749536566248, -1168.4572974715238, -57.094653632868855, -515.4825266771531, -707.5112396125644, -658.5753812003518, -112.8869105020299, -651.6069242568891, -677.8200498776017, -816.3572803821497, -555.4903168778004, -1318.4688748818273, -1469.5019457678363, -144.3942780904475, -709.2995676523841, -729.7102777429477, -679.8438640941808, -82.29007352592683, -638.9710889822313, -1079.2363316245946, -166.88755291640058, -875.9673987970974, -83.83107881346787, -1045.616946511011, -168.89030384006222], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 65, 150, 150, 135, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 118, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 33, 150, 150, 150, 132, 150, 46, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 65, 150, 150, 99, 150, 48, 150, 60], "policy_policy_0_reward": [-1384.7671442806814, -1065.723123478524, -996.8192221443848, -784.716330706886, -1412.5491773673234, -686.8423793697368, -842.955294090415, -833.4989364548792, -735.630655311057, -131.0967936322445, -92.65412263345011, -895.4331194106584, -1167.3680417827259, -606.512638271792, -670.247759247373, -429.9361357556553, -678.1487066036611, -716.9464927085539, -1493.1228652262182, -207.00024941023239, -562.7510518853715, -630.9124619926133, -639.5678115825056, -657.9860049713402, -685.1061966747654, -1290.977455455586, -678.523526726553, -521.5574494077558, -895.5724096305966, -1297.8462726687424, -1213.4764187300389, -635.3361912882407, -561.3850262235408, -1258.8220221825743, -690.8781707705176, -714.0457158949221, -267.52477314894173, -988.5236279759182, -1300.4600171517227, -630.6743209620589, -1257.9252598522824, -538.0707025496056, -438.43384158837137, -1447.0987930991557, -743.39081391714, -809.1616428895737, -579.7497533114047, -663.5868572876731, -601.5412218355434, -1097.9390712874078, -959.4568408714686, -72.30214895417122, -616.0891158970479, -1076.7077948870644, -1010.4600893537591, -553.1996654130951, -502.76089561939426, -1457.5820620189563, -631.2300199758133, -1364.133332723898, -479.44011108952895, -140.78803522923374, -1110.776108679112, -752.4288252348929, -679.3510433691656, -1009.0045734521473, -1295.8946041203371, -1051.9281176015666, -854.7313845773291, -1217.5118699032812, -649.5866722738647, -10.003800393045564, -1451.4561354466289, -504.91803046927583, -540.3275867926639, -702.749536566248, -1168.4572974715238, -57.094653632868855, -515.4825266771531, -707.5112396125644, -658.5753812003518, -112.8869105020299, -651.6069242568891, -677.8200498776017, -816.3572803821497, -555.4903168778004, -1318.4688748818273, -1469.5019457678363, -144.3942780904475, -709.2995676523841, -729.7102777429477, -679.8438640941808, -82.29007352592683, -638.9710889822313, -1079.2363316245946, -166.88755291640058, -875.9673987970974, -83.83107881346787, -1045.616946511011, -168.89030384006222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553415295120555, "mean_inference_ms": 1.6728528042565234, "mean_action_processing_ms": 0.27648362963433326, "mean_env_wait_ms": 3.4785973583172485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012341737747192383, "StateBufferConnector_ms": 0.007950067520141602, "ViewRequirementAgentConnector_ms": 0.1919395923614502}, "num_episodes": 30, "episode_return_max": -10.003800393045564, "episode_return_min": -1493.1228652262182, "episode_return_mean": -759.3980463547326, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.51280477570356, "num_env_steps_trained_throughput_per_sec": 303.51280477570356, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12750.537, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12750.467, "sample_time_ms": 1162.06, "learn_time_ms": 11519.794, "learn_throughput": 347.228, "synch_weights_time_ms": 67.771}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00009", "date": "2024-08-04_06-23-17", "timestamp": 1722732797, "time_this_iter_s": 13.191161155700684, "time_total_s": 318.9373688697815, "pid": 582514, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1ba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.9373688697815, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.947368421052634, "ram_util_percent": 28.0}}
