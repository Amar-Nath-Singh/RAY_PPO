{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8466350862601151, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.755289691686631, "policy_loss": -0.010622516689666857, "vf_loss": 9.777506053447723, "vf_explained_var": 0.0056653384740153944, "kl": 0.013461092185586191, "entropy": 1.4286066014319658, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -50.69638690436812, "episode_reward_min": -1259.1913738561013, "episode_reward_mean": -826.4070806389402, "episode_len_mean": 134.7826086956522, "episode_media": {}, "episodes_timesteps_total": 3100, "policy_reward_min": {"policy_0": -1259.1913738561013}, "policy_reward_max": {"policy_0": -50.69638690436812}, "policy_reward_mean": {"policy_0": -826.4070806389402}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.69638690436812, -735.4094344367676, -962.3742332452658, -66.08938257000213, -820.0726407813586, -882.880664237476, -1180.5539074668145, -1084.8636219413347, -871.2670795365138, -260.68754806965956, -962.2507901249149, -1166.6141837316775, -1075.137271112536, -766.368670209364, -1259.1913738561013, -757.268285142495, -1006.5815315168235, -148.8290510127467, -1001.2763407436826, -919.1154890323265, -1155.0965258900578, -1030.3310279821262, -844.4074151512092], "episode_lengths": [38, 150, 150, 62, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-50.69638690436812, -735.4094344367676, -962.3742332452658, -66.08938257000213, -820.0726407813586, -882.880664237476, -1180.5539074668145, -1084.8636219413347, -871.2670795365138, -260.68754806965956, -962.2507901249149, -1166.6141837316775, -1075.137271112536, -766.368670209364, -1259.1913738561013, -757.268285142495, -1006.5815315168235, -148.8290510127467, -1001.2763407436826, -919.1154890323265, -1155.0965258900578, -1030.3310279821262, -844.4074151512092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5792367934091296, "mean_inference_ms": 1.6682716116214484, "mean_action_processing_ms": 0.2801424418525862, "mean_env_wait_ms": 3.4100939833122994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011500068332837976, "StateBufferConnector_ms": 0.008075133613918139, "ViewRequirementAgentConnector_ms": 0.1806653064230214}, "num_episodes": 23, "episode_return_max": -50.69638690436812, "episode_return_min": -1259.1913738561013, "episode_return_mean": -826.4070806389402, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.8271725728575, "num_env_steps_trained_throughput_per_sec": 350.8271725728575, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11401.635, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11401.571, "sample_time_ms": 1102.829, "learn_time_ms": 10228.099, "learn_throughput": 391.08, "synch_weights_time_ms": 69.899}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00005", "date": "2024-08-04_05-55-35", "timestamp": 1722731135, "time_this_iter_s": 11.411837816238403, "time_total_s": 11.411837816238403, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc702950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.411837816238403, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.141176470588235, "ram_util_percent": 27.788235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0599752269374827, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.666398624579111, "policy_loss": -0.006453115850066146, "vf_loss": 9.685198471943538, "vf_explained_var": 0.03087337234367927, "kl": 0.01115770837341188, "entropy": 1.4578297966470322, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -48.817975999811075, "episode_reward_min": -1370.0235125192585, "episode_reward_mean": -844.6032153287346, "episode_len_mean": 134.24489795918367, "episode_media": {}, "episodes_timesteps_total": 6578, "policy_reward_min": {"policy_0": -1370.0235125192585}, "policy_reward_max": {"policy_0": -48.817975999811075}, "policy_reward_mean": {"policy_0": -844.6032153287346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.69638690436812, -735.4094344367676, -962.3742332452658, -66.08938257000213, -820.0726407813586, -882.880664237476, -1180.5539074668145, -1084.8636219413347, -871.2670795365138, -260.68754806965956, -962.2507901249149, -1166.6141837316775, -1075.137271112536, -766.368670209364, -1259.1913738561013, -757.268285142495, -1006.5815315168235, -148.8290510127467, -1001.2763407436826, -919.1154890323265, -1155.0965258900578, -1030.3310279821262, -844.4074151512092, -508.94556372890986, -48.817975999811075, -1207.8814861570384, -1225.1803017188968, -1057.6673943351211, -341.7550601583672, -360.07319186064825, -132.2437429120963, -1243.243139259564, -665.9794239755769, -1347.199622320129, -1370.0235125192585, -613.3092765246274, -958.5143754368171, -1352.7090289602345, -1085.687022205144, -196.57768348069783, -406.1357166569624, -1304.9018729209156, -1032.005019048074, -1056.4637476240987, -949.448674449255, -1234.533621605414, -930.1265045128646, -608.1262731879966, -1140.6454648538472], "episode_lengths": [38, 150, 150, 62, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 101, 143, 52, 150, 135, 150, 150, 150, 150, 150, 150, 63, 91, 150, 150, 150, 150, 150, 150, 142, 150], "policy_policy_0_reward": [-50.69638690436812, -735.4094344367676, -962.3742332452658, -66.08938257000213, -820.0726407813586, -882.880664237476, -1180.5539074668145, -1084.8636219413347, -871.2670795365138, -260.68754806965956, -962.2507901249149, -1166.6141837316775, -1075.137271112536, -766.368670209364, -1259.1913738561013, -757.268285142495, -1006.5815315168235, -148.8290510127467, -1001.2763407436826, -919.1154890323265, -1155.0965258900578, -1030.3310279821262, -844.4074151512092, -508.94556372890986, -48.817975999811075, -1207.8814861570384, -1225.1803017188968, -1057.6673943351211, -341.7550601583672, -360.07319186064825, -132.2437429120963, -1243.243139259564, -665.9794239755769, -1347.199622320129, -1370.0235125192585, -613.3092765246274, -958.5143754368171, -1352.7090289602345, -1085.687022205144, -196.57768348069783, -406.1357166569624, -1304.9018729209156, -1032.005019048074, -1056.4637476240987, -949.448674449255, -1234.533621605414, -930.1265045128646, -608.1262731879966, -1140.6454648538472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5743962692019253, "mean_inference_ms": 1.669684986859724, "mean_action_processing_ms": 0.2804441827809317, "mean_env_wait_ms": 3.417673825803408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013705662318638392, "StateBufferConnector_ms": 0.008215223039899553, "ViewRequirementAgentConnector_ms": 0.18216103923564053}, "num_episodes": 26, "episode_return_max": -48.817975999811075, "episode_return_min": -1370.0235125192585, "episode_return_mean": -844.6032153287346, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.64941476343415, "num_env_steps_trained_throughput_per_sec": 340.64941476343415, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11571.962, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11571.897, "sample_time_ms": 1112.184, "learn_time_ms": 10394.477, "learn_throughput": 384.82, "synch_weights_time_ms": 64.499}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00005", "date": "2024-08-04_05-55-47", "timestamp": 1722731147, "time_this_iter_s": 11.755133390426636, "time_total_s": 23.16697120666504, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.16697120666504, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.15625, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2575654425658285, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.554147696495056, "policy_loss": -0.009215928009750012, "vf_loss": 9.575130739808083, "vf_explained_var": 0.14142972870419424, "kl": 0.011964229014476286, "entropy": 1.4159969771901766, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -48.817975999811075, "episode_reward_min": -1370.0235125192585, "episode_reward_mean": -837.5079489270014, "episode_len_mean": 136.14473684210526, "episode_media": {}, "episodes_timesteps_total": 10347, "policy_reward_min": {"policy_0": -1370.0235125192585}, "policy_reward_max": {"policy_0": -48.817975999811075}, "policy_reward_mean": {"policy_0": -837.5079489270014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.69638690436812, -735.4094344367676, -962.3742332452658, -66.08938257000213, -820.0726407813586, -882.880664237476, -1180.5539074668145, -1084.8636219413347, -871.2670795365138, -260.68754806965956, -962.2507901249149, -1166.6141837316775, -1075.137271112536, -766.368670209364, -1259.1913738561013, -757.268285142495, -1006.5815315168235, -148.8290510127467, -1001.2763407436826, -919.1154890323265, -1155.0965258900578, -1030.3310279821262, -844.4074151512092, -508.94556372890986, -48.817975999811075, -1207.8814861570384, -1225.1803017188968, -1057.6673943351211, -341.7550601583672, -360.07319186064825, -132.2437429120963, -1243.243139259564, -665.9794239755769, -1347.199622320129, -1370.0235125192585, -613.3092765246274, -958.5143754368171, -1352.7090289602345, -1085.687022205144, -196.57768348069783, -406.1357166569624, -1304.9018729209156, -1032.005019048074, -1056.4637476240987, -949.448674449255, -1234.533621605414, -930.1265045128646, -608.1262731879966, -1140.6454648538472, -434.8102058745687, -367.03243949675857, -818.6819899137885, -1223.3717610179206, -892.298646639752, -477.49794490890247, -990.3183493107059, -1083.1869804502812, -1143.9571338582361, -837.4156709952924, -69.75181353768947, -397.36960038779506, -1265.205760589395, -261.4013549079743, -290.6165295209881, -985.6398965797237, -916.6903713739472, -1292.7796329219993, -989.131639877688, -1092.6153968714425, -952.4448406194902, -886.2592307393481, -1188.8754426056762, -470.0331792205953, -1053.7037475118775, -972.238868230813, -911.7181393814682], "episode_lengths": [38, 150, 150, 62, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 101, 143, 52, 150, 135, 150, 150, 150, 150, 150, 150, 63, 91, 150, 150, 150, 150, 150, 150, 142, 150, 150, 132, 150, 150, 150, 113, 150, 150, 150, 150, 69, 141, 150, 100, 94, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150], "policy_policy_0_reward": [-50.69638690436812, -735.4094344367676, -962.3742332452658, -66.08938257000213, -820.0726407813586, -882.880664237476, -1180.5539074668145, -1084.8636219413347, -871.2670795365138, -260.68754806965956, -962.2507901249149, -1166.6141837316775, -1075.137271112536, -766.368670209364, -1259.1913738561013, -757.268285142495, -1006.5815315168235, -148.8290510127467, -1001.2763407436826, -919.1154890323265, -1155.0965258900578, -1030.3310279821262, -844.4074151512092, -508.94556372890986, -48.817975999811075, -1207.8814861570384, -1225.1803017188968, -1057.6673943351211, -341.7550601583672, -360.07319186064825, -132.2437429120963, -1243.243139259564, -665.9794239755769, -1347.199622320129, -1370.0235125192585, -613.3092765246274, -958.5143754368171, -1352.7090289602345, -1085.687022205144, -196.57768348069783, -406.1357166569624, -1304.9018729209156, -1032.005019048074, -1056.4637476240987, -949.448674449255, -1234.533621605414, -930.1265045128646, -608.1262731879966, -1140.6454648538472, -434.8102058745687, -367.03243949675857, -818.6819899137885, -1223.3717610179206, -892.298646639752, -477.49794490890247, -990.3183493107059, -1083.1869804502812, -1143.9571338582361, -837.4156709952924, -69.75181353768947, -397.36960038779506, -1265.205760589395, -261.4013549079743, -290.6165295209881, -985.6398965797237, -916.6903713739472, -1292.7796329219993, -989.131639877688, -1092.6153968714425, -952.4448406194902, -886.2592307393481, -1188.8754426056762, -470.0331792205953, -1053.7037475118775, -972.238868230813, -911.7181393814682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5725566486206136, "mean_inference_ms": 1.6740467700214496, "mean_action_processing_ms": 0.28088959492869653, "mean_env_wait_ms": 3.425833086792173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0134461804440147, "StateBufferConnector_ms": 0.008377903386166221, "ViewRequirementAgentConnector_ms": 0.18575097385205722}, "num_episodes": 27, "episode_return_max": -48.817975999811075, "episode_return_min": -1370.0235125192585, "episode_return_mean": -837.5079489270014, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.72564576162756, "num_env_steps_trained_throughput_per_sec": 318.72564576162756, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11897.972, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11897.902, "sample_time_ms": 1109.726, "learn_time_ms": 10725.589, "learn_throughput": 372.94, "synch_weights_time_ms": 61.841}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00005", "date": "2024-08-04_05-56-00", "timestamp": 1722731160, "time_this_iter_s": 12.561916589736938, "time_total_s": 35.72888779640198, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 35.72888779640198, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.34444444444444, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.533386873826385, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.255210673809051, "policy_loss": -0.007029575768198507, "vf_loss": 9.27324250737826, "vf_explained_var": 0.29575130585581066, "kl": 0.015128679173115719, "entropy": 1.4027971691141525, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -15.765799993212122, "episode_reward_min": -1370.0235125192585, "episode_reward_mean": -785.2031555395722, "episode_len_mean": 131.61, "episode_media": {}, "episodes_timesteps_total": 13161, "policy_reward_min": {"policy_0": -1370.0235125192585}, "policy_reward_max": {"policy_0": -15.765799993212122}, "policy_reward_mean": {"policy_0": -785.2031555395722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-962.2507901249149, -1166.6141837316775, -1075.137271112536, -766.368670209364, -1259.1913738561013, -757.268285142495, -1006.5815315168235, -148.8290510127467, -1001.2763407436826, -919.1154890323265, -1155.0965258900578, -1030.3310279821262, -844.4074151512092, -508.94556372890986, -48.817975999811075, -1207.8814861570384, -1225.1803017188968, -1057.6673943351211, -341.7550601583672, -360.07319186064825, -132.2437429120963, -1243.243139259564, -665.9794239755769, -1347.199622320129, -1370.0235125192585, -613.3092765246274, -958.5143754368171, -1352.7090289602345, -1085.687022205144, -196.57768348069783, -406.1357166569624, -1304.9018729209156, -1032.005019048074, -1056.4637476240987, -949.448674449255, -1234.533621605414, -930.1265045128646, -608.1262731879966, -1140.6454648538472, -434.8102058745687, -367.03243949675857, -818.6819899137885, -1223.3717610179206, -892.298646639752, -477.49794490890247, -990.3183493107059, -1083.1869804502812, -1143.9571338582361, -837.4156709952924, -69.75181353768947, -397.36960038779506, -1265.205760589395, -261.4013549079743, -290.6165295209881, -985.6398965797237, -916.6903713739472, -1292.7796329219993, -989.131639877688, -1092.6153968714425, -952.4448406194902, -886.2592307393481, -1188.8754426056762, -470.0331792205953, -1053.7037475118775, -972.238868230813, -911.7181393814682, -991.0006436906724, -35.947673295127046, -128.16622832699272, -877.9001434177462, -1071.7417917757232, -15.765799993212122, -808.3493746113686, -698.5369724755046, -67.28487645678287, -1326.305921762093, -1074.5778918941785, -195.87365754711624, -848.9053430352701, -1212.8167089335082, -1172.8543486616395, -167.57855982187675, -587.6379695006096, -146.74292433067814, -970.4752643314026, -395.28536030116754, -984.5340572672868, -1055.510835162919, -569.6618455782208, -721.9928354394551, -778.7649751761735, -892.1529882707123, -130.46317715363475, -1013.070859094617, -172.45486604100572, -1070.5027293309865, -1015.7981218983501, -326.87204054834433, -107.80893276278998, -151.27061680749236], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 101, 143, 52, 150, 135, 150, 150, 150, 150, 150, 150, 63, 91, 150, 150, 150, 150, 150, 150, 142, 150, 150, 132, 150, 150, 150, 113, 150, 150, 150, 150, 69, 141, 150, 100, 94, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 45, 59, 150, 150, 35, 150, 150, 43, 150, 150, 82, 150, 150, 150, 56, 150, 85, 150, 90, 150, 150, 150, 140, 150, 150, 67, 150, 76, 150, 150, 116, 79, 65], "policy_policy_0_reward": [-962.2507901249149, -1166.6141837316775, -1075.137271112536, -766.368670209364, -1259.1913738561013, -757.268285142495, -1006.5815315168235, -148.8290510127467, -1001.2763407436826, -919.1154890323265, -1155.0965258900578, -1030.3310279821262, -844.4074151512092, -508.94556372890986, -48.817975999811075, -1207.8814861570384, -1225.1803017188968, -1057.6673943351211, -341.7550601583672, -360.07319186064825, -132.2437429120963, -1243.243139259564, -665.9794239755769, -1347.199622320129, -1370.0235125192585, -613.3092765246274, -958.5143754368171, -1352.7090289602345, -1085.687022205144, -196.57768348069783, -406.1357166569624, -1304.9018729209156, -1032.005019048074, -1056.4637476240987, -949.448674449255, -1234.533621605414, -930.1265045128646, -608.1262731879966, -1140.6454648538472, -434.8102058745687, -367.03243949675857, -818.6819899137885, -1223.3717610179206, -892.298646639752, -477.49794490890247, -990.3183493107059, -1083.1869804502812, -1143.9571338582361, -837.4156709952924, -69.75181353768947, -397.36960038779506, -1265.205760589395, -261.4013549079743, -290.6165295209881, -985.6398965797237, -916.6903713739472, -1292.7796329219993, -989.131639877688, -1092.6153968714425, -952.4448406194902, -886.2592307393481, -1188.8754426056762, -470.0331792205953, -1053.7037475118775, -972.238868230813, -911.7181393814682, -991.0006436906724, -35.947673295127046, -128.16622832699272, -877.9001434177462, -1071.7417917757232, -15.765799993212122, -808.3493746113686, -698.5369724755046, -67.28487645678287, -1326.305921762093, -1074.5778918941785, -195.87365754711624, -848.9053430352701, -1212.8167089335082, -1172.8543486616395, -167.57855982187675, -587.6379695006096, -146.74292433067814, -970.4752643314026, -395.28536030116754, -984.5340572672868, -1055.510835162919, -569.6618455782208, -721.9928354394551, -778.7649751761735, -892.1529882707123, -130.46317715363475, -1013.070859094617, -172.45486604100572, -1070.5027293309865, -1015.7981218983501, -326.87204054834433, -107.80893276278998, -151.27061680749236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5699524927949899, "mean_inference_ms": 1.6798108821472209, "mean_action_processing_ms": 0.28109296377702003, "mean_env_wait_ms": 3.4375632653264843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013815164566040039, "StateBufferConnector_ms": 0.008492469787597656, "ViewRequirementAgentConnector_ms": 0.18721723556518555}, "num_episodes": 34, "episode_return_max": -15.765799993212122, "episode_return_min": -1370.0235125192585, "episode_return_mean": -785.2031555395722, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.472367930331, "num_env_steps_trained_throughput_per_sec": 300.472367930331, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12251.575, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12251.505, "sample_time_ms": 1138.555, "learn_time_ms": 11051.743, "learn_throughput": 361.934, "synch_weights_time_ms": 60.459}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00005", "date": "2024-08-04_05-56-13", "timestamp": 1722731173, "time_this_iter_s": 13.324506759643555, "time_total_s": 49.05339455604553, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a6830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.05339455604553, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.063157894736843, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.775679055104653, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.090737430751323, "policy_loss": -0.009170747986354399, "vf_loss": 9.11170903146267, "vf_explained_var": 0.3630601749445001, "kl": 0.014243540955779588, "entropy": 1.4649589760849873, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": 1.6868978302023314, "episode_reward_min": -1326.305921762093, "episode_reward_mean": -735.443419915055, "episode_len_mean": 128.79, "episode_media": {}, "episodes_timesteps_total": 12879, "policy_reward_min": {"policy_0": -1326.305921762093}, "policy_reward_max": {"policy_0": 1.6868978302023314}, "policy_reward_mean": {"policy_0": -735.443419915055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-406.1357166569624, -1304.9018729209156, -1032.005019048074, -1056.4637476240987, -949.448674449255, -1234.533621605414, -930.1265045128646, -608.1262731879966, -1140.6454648538472, -434.8102058745687, -367.03243949675857, -818.6819899137885, -1223.3717610179206, -892.298646639752, -477.49794490890247, -990.3183493107059, -1083.1869804502812, -1143.9571338582361, -837.4156709952924, -69.75181353768947, -397.36960038779506, -1265.205760589395, -261.4013549079743, -290.6165295209881, -985.6398965797237, -916.6903713739472, -1292.7796329219993, -989.131639877688, -1092.6153968714425, -952.4448406194902, -886.2592307393481, -1188.8754426056762, -470.0331792205953, -1053.7037475118775, -972.238868230813, -911.7181393814682, -991.0006436906724, -35.947673295127046, -128.16622832699272, -877.9001434177462, -1071.7417917757232, -15.765799993212122, -808.3493746113686, -698.5369724755046, -67.28487645678287, -1326.305921762093, -1074.5778918941785, -195.87365754711624, -848.9053430352701, -1212.8167089335082, -1172.8543486616395, -167.57855982187675, -587.6379695006096, -146.74292433067814, -970.4752643314026, -395.28536030116754, -984.5340572672868, -1055.510835162919, -569.6618455782208, -721.9928354394551, -778.7649751761735, -892.1529882707123, -130.46317715363475, -1013.070859094617, -172.45486604100572, -1070.5027293309865, -1015.7981218983501, -326.87204054834433, -107.80893276278998, -151.27061680749236, -363.8683828097217, -912.9989811625845, -1037.242977966722, -254.78183345450012, -1117.701987384647, -270.32507483454435, -549.4468019011567, -912.8095139292112, 1.6868978302023314, -1033.6694063035318, -289.72699492571417, -907.9980235356782, -26.498383185617698, -243.88143119330664, -1064.8478878961664, -199.80359977773998, -290.1782147622638, -978.5873983415305, -1129.3034558206941, -1090.611132648591, -634.6885480385744, -1057.2183740882792, -172.066347202437, -1148.6160859275597, -1036.7729488426892, -379.0735942422053, -1052.7586413416302, -1110.3042993138506, -1153.4654024267047, -414.7433691796447], "episode_lengths": [91, 150, 150, 150, 150, 150, 150, 142, 150, 150, 132, 150, 150, 150, 113, 150, 150, 150, 150, 69, 141, 150, 100, 94, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 45, 59, 150, 150, 35, 150, 150, 43, 150, 150, 82, 150, 150, 150, 56, 150, 85, 150, 90, 150, 150, 150, 140, 150, 150, 67, 150, 76, 150, 150, 116, 79, 65, 113, 150, 150, 74, 150, 135, 150, 150, 32, 150, 94, 150, 44, 73, 150, 79, 106, 150, 150, 150, 150, 150, 86, 150, 150, 126, 150, 150, 150, 127], "policy_policy_0_reward": [-406.1357166569624, -1304.9018729209156, -1032.005019048074, -1056.4637476240987, -949.448674449255, -1234.533621605414, -930.1265045128646, -608.1262731879966, -1140.6454648538472, -434.8102058745687, -367.03243949675857, -818.6819899137885, -1223.3717610179206, -892.298646639752, -477.49794490890247, -990.3183493107059, -1083.1869804502812, -1143.9571338582361, -837.4156709952924, -69.75181353768947, -397.36960038779506, -1265.205760589395, -261.4013549079743, -290.6165295209881, -985.6398965797237, -916.6903713739472, -1292.7796329219993, -989.131639877688, -1092.6153968714425, -952.4448406194902, -886.2592307393481, -1188.8754426056762, -470.0331792205953, -1053.7037475118775, -972.238868230813, -911.7181393814682, -991.0006436906724, -35.947673295127046, -128.16622832699272, -877.9001434177462, -1071.7417917757232, -15.765799993212122, -808.3493746113686, -698.5369724755046, -67.28487645678287, -1326.305921762093, -1074.5778918941785, -195.87365754711624, -848.9053430352701, -1212.8167089335082, -1172.8543486616395, -167.57855982187675, -587.6379695006096, -146.74292433067814, -970.4752643314026, -395.28536030116754, -984.5340572672868, -1055.510835162919, -569.6618455782208, -721.9928354394551, -778.7649751761735, -892.1529882707123, -130.46317715363475, -1013.070859094617, -172.45486604100572, -1070.5027293309865, -1015.7981218983501, -326.87204054834433, -107.80893276278998, -151.27061680749236, -363.8683828097217, -912.9989811625845, -1037.242977966722, -254.78183345450012, -1117.701987384647, -270.32507483454435, -549.4468019011567, -912.8095139292112, 1.6868978302023314, -1033.6694063035318, -289.72699492571417, -907.9980235356782, -26.498383185617698, -243.88143119330664, -1064.8478878961664, -199.80359977773998, -290.1782147622638, -978.5873983415305, -1129.3034558206941, -1090.611132648591, -634.6885480385744, -1057.2183740882792, -172.066347202437, -1148.6160859275597, -1036.7729488426892, -379.0735942422053, -1052.7586413416302, -1110.3042993138506, -1153.4654024267047, -414.7433691796447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5663872457552863, "mean_inference_ms": 1.6846773769526553, "mean_action_processing_ms": 0.2814784124850763, "mean_env_wait_ms": 3.4506683103573392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013463020324707031, "StateBufferConnector_ms": 0.008627176284790039, "ViewRequirementAgentConnector_ms": 0.20161771774291992}, "num_episodes": 30, "episode_return_max": 1.6868978302023314, "episode_return_min": -1326.305921762093, "episode_return_mean": -735.443419915055, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.28603003132133, "num_env_steps_trained_throughput_per_sec": 311.28603003132133, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12371.247, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12371.173, "sample_time_ms": 1138.357, "learn_time_ms": 11169.227, "learn_throughput": 358.127, "synch_weights_time_ms": 62.843}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00005", "date": "2024-08-04_05-56-26", "timestamp": 1722731186, "time_this_iter_s": 12.861123323440552, "time_total_s": 61.914517879486084, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 61.914517879486084, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.931578947368422, "ram_util_percent": 27.894736842105257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.600621567045649, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.292113526165485, "policy_loss": -0.012466222407238093, "vf_loss": 9.315381507078806, "vf_explained_var": 0.40152549631893636, "kl": 0.018313321042721032, "entropy": 1.4464419610798358, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 1.6868978302023314, "episode_reward_min": -1351.016212306827, "episode_reward_mean": -690.9380825122666, "episode_len_mean": 124.33, "episode_media": {}, "episodes_timesteps_total": 12433, "policy_reward_min": {"policy_0": -1351.016212306827}, "policy_reward_max": {"policy_0": 1.6868978302023314}, "policy_reward_mean": {"policy_0": -690.9380825122666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1188.8754426056762, -470.0331792205953, -1053.7037475118775, -972.238868230813, -911.7181393814682, -991.0006436906724, -35.947673295127046, -128.16622832699272, -877.9001434177462, -1071.7417917757232, -15.765799993212122, -808.3493746113686, -698.5369724755046, -67.28487645678287, -1326.305921762093, -1074.5778918941785, -195.87365754711624, -848.9053430352701, -1212.8167089335082, -1172.8543486616395, -167.57855982187675, -587.6379695006096, -146.74292433067814, -970.4752643314026, -395.28536030116754, -984.5340572672868, -1055.510835162919, -569.6618455782208, -721.9928354394551, -778.7649751761735, -892.1529882707123, -130.46317715363475, -1013.070859094617, -172.45486604100572, -1070.5027293309865, -1015.7981218983501, -326.87204054834433, -107.80893276278998, -151.27061680749236, -363.8683828097217, -912.9989811625845, -1037.242977966722, -254.78183345450012, -1117.701987384647, -270.32507483454435, -549.4468019011567, -912.8095139292112, 1.6868978302023314, -1033.6694063035318, -289.72699492571417, -907.9980235356782, -26.498383185617698, -243.88143119330664, -1064.8478878961664, -199.80359977773998, -290.1782147622638, -978.5873983415305, -1129.3034558206941, -1090.611132648591, -634.6885480385744, -1057.2183740882792, -172.066347202437, -1148.6160859275597, -1036.7729488426892, -379.0735942422053, -1052.7586413416302, -1110.3042993138506, -1153.4654024267047, -414.7433691796447, -500.1995102021568, -1351.016212306827, -43.31575036306861, -1218.4381630526095, -1017.9016694996284, -841.5734666516693, -326.10524456340204, -954.9873544759236, -758.9742299327153, -102.94011466278181, -704.2255834048974, -887.3471667060298, -853.3036148815775, -328.16593119055375, -155.71709047888598, -1041.1605835295607, -1104.7043060747594, -257.5439075244653, -133.73549988434965, -1194.600123007765, -1130.271010617466, -384.9549317887582, -1109.3800347234294, -16.18044329110491, -157.80654400738754, -653.280699254131, -737.3281724398014, -1108.7950740512972, -614.7717493609581, -936.425317561244, -1255.1808454850952], "episode_lengths": [150, 120, 150, 150, 150, 150, 45, 59, 150, 150, 35, 150, 150, 43, 150, 150, 82, 150, 150, 150, 56, 150, 85, 150, 90, 150, 150, 150, 140, 150, 150, 67, 150, 76, 150, 150, 116, 79, 65, 113, 150, 150, 74, 150, 135, 150, 150, 32, 150, 94, 150, 44, 73, 150, 79, 106, 150, 150, 150, 150, 150, 86, 150, 150, 126, 150, 150, 150, 127, 150, 150, 51, 150, 150, 150, 93, 150, 150, 52, 150, 150, 150, 103, 56, 150, 150, 92, 50, 150, 150, 150, 150, 45, 85, 132, 150, 150, 127, 150, 150], "policy_policy_0_reward": [-1188.8754426056762, -470.0331792205953, -1053.7037475118775, -972.238868230813, -911.7181393814682, -991.0006436906724, -35.947673295127046, -128.16622832699272, -877.9001434177462, -1071.7417917757232, -15.765799993212122, -808.3493746113686, -698.5369724755046, -67.28487645678287, -1326.305921762093, -1074.5778918941785, -195.87365754711624, -848.9053430352701, -1212.8167089335082, -1172.8543486616395, -167.57855982187675, -587.6379695006096, -146.74292433067814, -970.4752643314026, -395.28536030116754, -984.5340572672868, -1055.510835162919, -569.6618455782208, -721.9928354394551, -778.7649751761735, -892.1529882707123, -130.46317715363475, -1013.070859094617, -172.45486604100572, -1070.5027293309865, -1015.7981218983501, -326.87204054834433, -107.80893276278998, -151.27061680749236, -363.8683828097217, -912.9989811625845, -1037.242977966722, -254.78183345450012, -1117.701987384647, -270.32507483454435, -549.4468019011567, -912.8095139292112, 1.6868978302023314, -1033.6694063035318, -289.72699492571417, -907.9980235356782, -26.498383185617698, -243.88143119330664, -1064.8478878961664, -199.80359977773998, -290.1782147622638, -978.5873983415305, -1129.3034558206941, -1090.611132648591, -634.6885480385744, -1057.2183740882792, -172.066347202437, -1148.6160859275597, -1036.7729488426892, -379.0735942422053, -1052.7586413416302, -1110.3042993138506, -1153.4654024267047, -414.7433691796447, -500.1995102021568, -1351.016212306827, -43.31575036306861, -1218.4381630526095, -1017.9016694996284, -841.5734666516693, -326.10524456340204, -954.9873544759236, -758.9742299327153, -102.94011466278181, -704.2255834048974, -887.3471667060298, -853.3036148815775, -328.16593119055375, -155.71709047888598, -1041.1605835295607, -1104.7043060747594, -257.5439075244653, -133.73549988434965, -1194.600123007765, -1130.271010617466, -384.9549317887582, -1109.3800347234294, -16.18044329110491, -157.80654400738754, -653.280699254131, -737.3281724398014, -1108.7950740512972, -614.7717493609581, -936.425317561244, -1255.1808454850952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5648194081154287, "mean_inference_ms": 1.6866969188846108, "mean_action_processing_ms": 0.28158694195516504, "mean_env_wait_ms": 3.460363539358831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013180017471313477, "StateBufferConnector_ms": 0.008657693862915039, "ViewRequirementAgentConnector_ms": 0.202653169631958}, "num_episodes": 31, "episode_return_max": 1.6868978302023314, "episode_return_min": -1351.016212306827, "episode_return_mean": -690.9380825122666, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.4636248393998, "num_env_steps_trained_throughput_per_sec": 299.4636248393998, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12535.577, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12535.503, "sample_time_ms": 1146.178, "learn_time_ms": 11324.963, "learn_throughput": 353.202, "synch_weights_time_ms": 63.614}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00005", "date": "2024-08-04_05-56-39", "timestamp": 1722731199, "time_this_iter_s": 13.369559288024902, "time_total_s": 75.28407716751099, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a4940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.28407716751099, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.936842105263157, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.440532209227483, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.35896466175715, "policy_loss": -0.010375530933379196, "vf_loss": 9.381594992677371, "vf_explained_var": 0.4734402118250728, "kl": 0.016717978482347462, "entropy": 1.5598391878108184, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": 1.6868978302023314, "episode_reward_min": -1407.6820955107416, "episode_reward_mean": -711.2320214925742, "episode_len_mean": 126.69, "episode_media": {}, "episodes_timesteps_total": 12669, "policy_reward_min": {"policy_0": -1407.6820955107416}, "policy_reward_max": {"policy_0": 1.6868978302023314}, "policy_reward_mean": {"policy_0": -711.2320214925742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1013.070859094617, -172.45486604100572, -1070.5027293309865, -1015.7981218983501, -326.87204054834433, -107.80893276278998, -151.27061680749236, -363.8683828097217, -912.9989811625845, -1037.242977966722, -254.78183345450012, -1117.701987384647, -270.32507483454435, -549.4468019011567, -912.8095139292112, 1.6868978302023314, -1033.6694063035318, -289.72699492571417, -907.9980235356782, -26.498383185617698, -243.88143119330664, -1064.8478878961664, -199.80359977773998, -290.1782147622638, -978.5873983415305, -1129.3034558206941, -1090.611132648591, -634.6885480385744, -1057.2183740882792, -172.066347202437, -1148.6160859275597, -1036.7729488426892, -379.0735942422053, -1052.7586413416302, -1110.3042993138506, -1153.4654024267047, -414.7433691796447, -500.1995102021568, -1351.016212306827, -43.31575036306861, -1218.4381630526095, -1017.9016694996284, -841.5734666516693, -326.10524456340204, -954.9873544759236, -758.9742299327153, -102.94011466278181, -704.2255834048974, -887.3471667060298, -853.3036148815775, -328.16593119055375, -155.71709047888598, -1041.1605835295607, -1104.7043060747594, -257.5439075244653, -133.73549988434965, -1194.600123007765, -1130.271010617466, -384.9549317887582, -1109.3800347234294, -16.18044329110491, -157.80654400738754, -653.280699254131, -737.3281724398014, -1108.7950740512972, -614.7717493609581, -936.425317561244, -1255.1808454850952, -1052.9223807360781, -334.10365524127417, -1022.0631999005499, -1154.853720391797, -1315.0349746332981, -961.4332355211067, -539.7296121316197, -918.0321181067851, -977.0447738811409, -1296.2368816250664, -1216.0484893310631, -965.7411760076717, -817.9753065666978, -506.89566322774647, -907.9127091746815, -115.28055146059407, -1175.6418352015137, -1127.4960082625503, -1020.4996107238759, -1197.9857870109333, -96.91456580028844, -2.076386760377707, -1114.7996013098684, -659.6713531919736, -1407.6820955107416, -430.7305450196748, -449.131638830942, -48.08133659810395, -521.4505512037064, -22.178220098340425, -522.2813214423458, -654.8621382898264], "episode_lengths": [150, 76, 150, 150, 116, 79, 65, 113, 150, 150, 74, 150, 135, 150, 150, 32, 150, 94, 150, 44, 73, 150, 79, 106, 150, 150, 150, 150, 150, 86, 150, 150, 126, 150, 150, 150, 127, 150, 150, 51, 150, 150, 150, 93, 150, 150, 52, 150, 150, 150, 103, 56, 150, 150, 92, 50, 150, 150, 150, 150, 45, 85, 132, 150, 150, 127, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 73, 35, 150, 150, 150, 135, 150, 44, 150, 36, 101, 150], "policy_policy_0_reward": [-1013.070859094617, -172.45486604100572, -1070.5027293309865, -1015.7981218983501, -326.87204054834433, -107.80893276278998, -151.27061680749236, -363.8683828097217, -912.9989811625845, -1037.242977966722, -254.78183345450012, -1117.701987384647, -270.32507483454435, -549.4468019011567, -912.8095139292112, 1.6868978302023314, -1033.6694063035318, -289.72699492571417, -907.9980235356782, -26.498383185617698, -243.88143119330664, -1064.8478878961664, -199.80359977773998, -290.1782147622638, -978.5873983415305, -1129.3034558206941, -1090.611132648591, -634.6885480385744, -1057.2183740882792, -172.066347202437, -1148.6160859275597, -1036.7729488426892, -379.0735942422053, -1052.7586413416302, -1110.3042993138506, -1153.4654024267047, -414.7433691796447, -500.1995102021568, -1351.016212306827, -43.31575036306861, -1218.4381630526095, -1017.9016694996284, -841.5734666516693, -326.10524456340204, -954.9873544759236, -758.9742299327153, -102.94011466278181, -704.2255834048974, -887.3471667060298, -853.3036148815775, -328.16593119055375, -155.71709047888598, -1041.1605835295607, -1104.7043060747594, -257.5439075244653, -133.73549988434965, -1194.600123007765, -1130.271010617466, -384.9549317887582, -1109.3800347234294, -16.18044329110491, -157.80654400738754, -653.280699254131, -737.3281724398014, -1108.7950740512972, -614.7717493609581, -936.425317561244, -1255.1808454850952, -1052.9223807360781, -334.10365524127417, -1022.0631999005499, -1154.853720391797, -1315.0349746332981, -961.4332355211067, -539.7296121316197, -918.0321181067851, -977.0447738811409, -1296.2368816250664, -1216.0484893310631, -965.7411760076717, -817.9753065666978, -506.89566322774647, -907.9127091746815, -115.28055146059407, -1175.6418352015137, -1127.4960082625503, -1020.4996107238759, -1197.9857870109333, -96.91456580028844, -2.076386760377707, -1114.7996013098684, -659.6713531919736, -1407.6820955107416, -430.7305450196748, -449.131638830942, -48.08133659810395, -521.4505512037064, -22.178220098340425, -522.2813214423458, -654.8621382898264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5622999007556136, "mean_inference_ms": 1.6870223535664064, "mean_action_processing_ms": 0.2815418404403094, "mean_env_wait_ms": 3.468301088178965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012675762176513672, "StateBufferConnector_ms": 0.008669614791870117, "ViewRequirementAgentConnector_ms": 0.20602965354919434}, "num_episodes": 32, "episode_return_max": 1.6868978302023314, "episode_return_min": -1407.6820955107416, "episode_return_mean": -711.2320214925742, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.93236701416197, "num_env_steps_trained_throughput_per_sec": 327.93236701416197, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12487.302, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12487.228, "sample_time_ms": 1142.237, "learn_time_ms": 11281.231, "learn_throughput": 354.571, "synch_weights_time_ms": 63.015}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00005", "date": "2024-08-04_05-56-52", "timestamp": 1722731212, "time_this_iter_s": 12.209407806396484, "time_total_s": 87.49348497390747, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a6830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.49348497390747, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.7, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.309960652018587, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.936166773239771, "policy_loss": -0.011061759050547456, "vf_loss": 8.958725901444753, "vf_explained_var": 0.4891159347568949, "kl": 0.01638188155596557, "entropy": 1.4773768335580826, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -2.076386760377707, "episode_reward_min": -1407.6820955107416, "episode_reward_mean": -767.2823266512228, "episode_len_mean": 133.11, "episode_media": {}, "episodes_timesteps_total": 13311, "policy_reward_min": {"policy_0": -1407.6820955107416}, "policy_reward_max": {"policy_0": -2.076386760377707}, "policy_reward_mean": {"policy_0": -767.2823266512228}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.066347202437, -1148.6160859275597, -1036.7729488426892, -379.0735942422053, -1052.7586413416302, -1110.3042993138506, -1153.4654024267047, -414.7433691796447, -500.1995102021568, -1351.016212306827, -43.31575036306861, -1218.4381630526095, -1017.9016694996284, -841.5734666516693, -326.10524456340204, -954.9873544759236, -758.9742299327153, -102.94011466278181, -704.2255834048974, -887.3471667060298, -853.3036148815775, -328.16593119055375, -155.71709047888598, -1041.1605835295607, -1104.7043060747594, -257.5439075244653, -133.73549988434965, -1194.600123007765, -1130.271010617466, -384.9549317887582, -1109.3800347234294, -16.18044329110491, -157.80654400738754, -653.280699254131, -737.3281724398014, -1108.7950740512972, -614.7717493609581, -936.425317561244, -1255.1808454850952, -1052.9223807360781, -334.10365524127417, -1022.0631999005499, -1154.853720391797, -1315.0349746332981, -961.4332355211067, -539.7296121316197, -918.0321181067851, -977.0447738811409, -1296.2368816250664, -1216.0484893310631, -965.7411760076717, -817.9753065666978, -506.89566322774647, -907.9127091746815, -115.28055146059407, -1175.6418352015137, -1127.4960082625503, -1020.4996107238759, -1197.9857870109333, -96.91456580028844, -2.076386760377707, -1114.7996013098684, -659.6713531919736, -1407.6820955107416, -430.7305450196748, -449.131638830942, -48.08133659810395, -521.4505512037064, -22.178220098340425, -522.2813214423458, -654.8621382898264, -1120.7212533249499, -879.155519982308, -464.73325793634643, -779.5629900601228, -467.4666591486652, -201.2597204950269, -671.7178914150313, -1275.4451818525026, -1138.7906655839413, -1272.2790628890145, -1156.4877137698838, -764.8414793327389, -675.3014013873958, -201.5136547569193, -286.56780006643083, -1028.0271329688221, -1022.2610607319639, -320.44484106586265, -1363.877173753444, -1311.804506759814, -207.49746033353563, -1138.4732604036667, -843.1793397170264, -1121.5432663019687, -574.9405748466836, -917.9008553008872, -806.5259716102616, -1384.0986817969924, -430.89181088680203], "episode_lengths": [86, 150, 150, 126, 150, 150, 150, 127, 150, 150, 51, 150, 150, 150, 93, 150, 150, 52, 150, 150, 150, 103, 56, 150, 150, 92, 50, 150, 150, 150, 150, 45, 85, 132, 150, 150, 127, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 73, 35, 150, 150, 150, 135, 150, 44, 150, 36, 101, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 104, 131, 150, 150, 112, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-172.066347202437, -1148.6160859275597, -1036.7729488426892, -379.0735942422053, -1052.7586413416302, -1110.3042993138506, -1153.4654024267047, -414.7433691796447, -500.1995102021568, -1351.016212306827, -43.31575036306861, -1218.4381630526095, -1017.9016694996284, -841.5734666516693, -326.10524456340204, -954.9873544759236, -758.9742299327153, -102.94011466278181, -704.2255834048974, -887.3471667060298, -853.3036148815775, -328.16593119055375, -155.71709047888598, -1041.1605835295607, -1104.7043060747594, -257.5439075244653, -133.73549988434965, -1194.600123007765, -1130.271010617466, -384.9549317887582, -1109.3800347234294, -16.18044329110491, -157.80654400738754, -653.280699254131, -737.3281724398014, -1108.7950740512972, -614.7717493609581, -936.425317561244, -1255.1808454850952, -1052.9223807360781, -334.10365524127417, -1022.0631999005499, -1154.853720391797, -1315.0349746332981, -961.4332355211067, -539.7296121316197, -918.0321181067851, -977.0447738811409, -1296.2368816250664, -1216.0484893310631, -965.7411760076717, -817.9753065666978, -506.89566322774647, -907.9127091746815, -115.28055146059407, -1175.6418352015137, -1127.4960082625503, -1020.4996107238759, -1197.9857870109333, -96.91456580028844, -2.076386760377707, -1114.7996013098684, -659.6713531919736, -1407.6820955107416, -430.7305450196748, -449.131638830942, -48.08133659810395, -521.4505512037064, -22.178220098340425, -522.2813214423458, -654.8621382898264, -1120.7212533249499, -879.155519982308, -464.73325793634643, -779.5629900601228, -467.4666591486652, -201.2597204950269, -671.7178914150313, -1275.4451818525026, -1138.7906655839413, -1272.2790628890145, -1156.4877137698838, -764.8414793327389, -675.3014013873958, -201.5136547569193, -286.56780006643083, -1028.0271329688221, -1022.2610607319639, -320.44484106586265, -1363.877173753444, -1311.804506759814, -207.49746033353563, -1138.4732604036667, -843.1793397170264, -1121.5432663019687, -574.9405748466836, -917.9008553008872, -806.5259716102616, -1384.0986817969924, -430.89181088680203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616960829325898, "mean_inference_ms": 1.685816973436646, "mean_action_processing_ms": 0.28122731611203144, "mean_env_wait_ms": 3.4759881060002416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012393951416015625, "StateBufferConnector_ms": 0.008396387100219727, "ViewRequirementAgentConnector_ms": 0.19304227828979492}, "num_episodes": 29, "episode_return_max": -2.076386760377707, "episode_return_min": -1407.6820955107416, "episode_return_mean": -767.2823266512228, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.788244520978, "num_env_steps_trained_throughput_per_sec": 311.788244520978, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12530.044, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12529.969, "sample_time_ms": 1137.528, "learn_time_ms": 11329.577, "learn_throughput": 353.058, "synch_weights_time_ms": 62.121}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00005", "date": "2024-08-04_05-57-04", "timestamp": 1722731224, "time_this_iter_s": 12.841383934020996, "time_total_s": 100.33486890792847, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.33486890792847, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.366666666666667, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.584969930599133, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.832568874458472, "policy_loss": -0.012492846196012881, "vf_loss": 8.85592202891906, "vf_explained_var": 0.5581195178752144, "kl": 0.019030607288671793, "entropy": 1.466642596696814, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -2.076386760377707, "episode_reward_min": -1407.6820955107416, "episode_reward_mean": -783.0233651405616, "episode_len_mean": 136.43, "episode_media": {}, "episodes_timesteps_total": 13643, "policy_reward_min": {"policy_0": -1407.6820955107416}, "policy_reward_max": {"policy_0": -2.076386760377707}, "policy_reward_mean": {"policy_0": -783.0233651405616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157.80654400738754, -653.280699254131, -737.3281724398014, -1108.7950740512972, -614.7717493609581, -936.425317561244, -1255.1808454850952, -1052.9223807360781, -334.10365524127417, -1022.0631999005499, -1154.853720391797, -1315.0349746332981, -961.4332355211067, -539.7296121316197, -918.0321181067851, -977.0447738811409, -1296.2368816250664, -1216.0484893310631, -965.7411760076717, -817.9753065666978, -506.89566322774647, -907.9127091746815, -115.28055146059407, -1175.6418352015137, -1127.4960082625503, -1020.4996107238759, -1197.9857870109333, -96.91456580028844, -2.076386760377707, -1114.7996013098684, -659.6713531919736, -1407.6820955107416, -430.7305450196748, -449.131638830942, -48.08133659810395, -521.4505512037064, -22.178220098340425, -522.2813214423458, -654.8621382898264, -1120.7212533249499, -879.155519982308, -464.73325793634643, -779.5629900601228, -467.4666591486652, -201.2597204950269, -671.7178914150313, -1275.4451818525026, -1138.7906655839413, -1272.2790628890145, -1156.4877137698838, -764.8414793327389, -675.3014013873958, -201.5136547569193, -286.56780006643083, -1028.0271329688221, -1022.2610607319639, -320.44484106586265, -1363.877173753444, -1311.804506759814, -207.49746033353563, -1138.4732604036667, -843.1793397170264, -1121.5432663019687, -574.9405748466836, -917.9008553008872, -806.5259716102616, -1384.0986817969924, -430.89181088680203, -912.2685180329446, -796.4795380550215, -910.5533954118879, -572.4422852235728, -934.8856473654189, -1018.830582374999, -785.0688986627612, -181.47973611810795, -1307.445651447563, -1264.1927686002127, -853.3151471163312, -834.4802194926342, -18.843036231751395, -514.0768327901345, -546.1359416540195, -1238.6836103785745, -1169.4872028640677, -501.25552658909464, -1109.0746654592142, -50.03919447878458, -512.2872284650495, -968.4643017297208, -1160.8171349809659, -13.123811899122721, -547.6433721558575, -899.8534573387419, -505.3972606022615, -1092.4846822250956, -1015.4769342479818, -425.7469129543299, -1113.7746209428874, -684.5383643358912], "episode_lengths": [85, 132, 150, 150, 127, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 73, 35, 150, 150, 150, 135, 150, 44, 150, 36, 101, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 104, 131, 150, 150, 112, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 140, 144, 47, 150, 150, 150, 150, 136, 150, 46, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-157.80654400738754, -653.280699254131, -737.3281724398014, -1108.7950740512972, -614.7717493609581, -936.425317561244, -1255.1808454850952, -1052.9223807360781, -334.10365524127417, -1022.0631999005499, -1154.853720391797, -1315.0349746332981, -961.4332355211067, -539.7296121316197, -918.0321181067851, -977.0447738811409, -1296.2368816250664, -1216.0484893310631, -965.7411760076717, -817.9753065666978, -506.89566322774647, -907.9127091746815, -115.28055146059407, -1175.6418352015137, -1127.4960082625503, -1020.4996107238759, -1197.9857870109333, -96.91456580028844, -2.076386760377707, -1114.7996013098684, -659.6713531919736, -1407.6820955107416, -430.7305450196748, -449.131638830942, -48.08133659810395, -521.4505512037064, -22.178220098340425, -522.2813214423458, -654.8621382898264, -1120.7212533249499, -879.155519982308, -464.73325793634643, -779.5629900601228, -467.4666591486652, -201.2597204950269, -671.7178914150313, -1275.4451818525026, -1138.7906655839413, -1272.2790628890145, -1156.4877137698838, -764.8414793327389, -675.3014013873958, -201.5136547569193, -286.56780006643083, -1028.0271329688221, -1022.2610607319639, -320.44484106586265, -1363.877173753444, -1311.804506759814, -207.49746033353563, -1138.4732604036667, -843.1793397170264, -1121.5432663019687, -574.9405748466836, -917.9008553008872, -806.5259716102616, -1384.0986817969924, -430.89181088680203, -912.2685180329446, -796.4795380550215, -910.5533954118879, -572.4422852235728, -934.8856473654189, -1018.830582374999, -785.0688986627612, -181.47973611810795, -1307.445651447563, -1264.1927686002127, -853.3151471163312, -834.4802194926342, -18.843036231751395, -514.0768327901345, -546.1359416540195, -1238.6836103785745, -1169.4872028640677, -501.25552658909464, -1109.0746654592142, -50.03919447878458, -512.2872284650495, -968.4643017297208, -1160.8171349809659, -13.123811899122721, -547.6433721558575, -899.8534573387419, -505.3972606022615, -1092.4846822250956, -1015.4769342479818, -425.7469129543299, -1113.7746209428874, -684.5383643358912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5607493254271815, "mean_inference_ms": 1.6851744518736589, "mean_action_processing_ms": 0.280799072547713, "mean_env_wait_ms": 3.482086452781197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012179136276245117, "StateBufferConnector_ms": 0.008213281631469727, "ViewRequirementAgentConnector_ms": 0.1931629180908203}, "num_episodes": 32, "episode_return_max": -2.076386760377707, "episode_return_min": -1407.6820955107416, "episode_return_mean": -783.0233651405616, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.96643981120457, "num_env_steps_trained_throughput_per_sec": 308.96643981120457, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12576.306, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12576.231, "sample_time_ms": 1133.496, "learn_time_ms": 11378.965, "learn_throughput": 351.526, "synch_weights_time_ms": 63.026}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00005", "date": "2024-08-04_05-57-18", "timestamp": 1722731238, "time_this_iter_s": 12.958926439285278, "time_total_s": 113.29379534721375, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.29379534721375, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.131578947368425, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.41608693897724, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.882300516963005, "policy_loss": -0.021503210272445963, "vf_loss": 8.913327368597189, "vf_explained_var": 0.5623761311794321, "kl": 0.02535566877780487, "entropy": 1.459474338715275, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -2.076386760377707, "episode_reward_min": -1407.6820955107416, "episode_reward_mean": -715.116238274207, "episode_len_mean": 131.75, "episode_media": {}, "episodes_timesteps_total": 13175, "policy_reward_min": {"policy_0": -1407.6820955107416}, "policy_reward_max": {"policy_0": -2.076386760377707}, "policy_reward_mean": {"policy_0": -715.116238274207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.91456580028844, -2.076386760377707, -1114.7996013098684, -659.6713531919736, -1407.6820955107416, -430.7305450196748, -449.131638830942, -48.08133659810395, -521.4505512037064, -22.178220098340425, -522.2813214423458, -654.8621382898264, -1120.7212533249499, -879.155519982308, -464.73325793634643, -779.5629900601228, -467.4666591486652, -201.2597204950269, -671.7178914150313, -1275.4451818525026, -1138.7906655839413, -1272.2790628890145, -1156.4877137698838, -764.8414793327389, -675.3014013873958, -201.5136547569193, -286.56780006643083, -1028.0271329688221, -1022.2610607319639, -320.44484106586265, -1363.877173753444, -1311.804506759814, -207.49746033353563, -1138.4732604036667, -843.1793397170264, -1121.5432663019687, -574.9405748466836, -917.9008553008872, -806.5259716102616, -1384.0986817969924, -430.89181088680203, -912.2685180329446, -796.4795380550215, -910.5533954118879, -572.4422852235728, -934.8856473654189, -1018.830582374999, -785.0688986627612, -181.47973611810795, -1307.445651447563, -1264.1927686002127, -853.3151471163312, -834.4802194926342, -18.843036231751395, -514.0768327901345, -546.1359416540195, -1238.6836103785745, -1169.4872028640677, -501.25552658909464, -1109.0746654592142, -50.03919447878458, -512.2872284650495, -968.4643017297208, -1160.8171349809659, -13.123811899122721, -547.6433721558575, -899.8534573387419, -505.3972606022615, -1092.4846822250956, -1015.4769342479818, -425.7469129543299, -1113.7746209428874, -684.5383643358912, -945.1421014747526, -17.028235720896507, -834.1794675238976, -868.7797720111553, -1342.2552727162908, -559.0325572266064, -509.45360619059136, -419.18354682022294, -122.56435668866058, -978.2490248043182, -140.80457347195596, -938.0622142960958, -459.28669502738927, -813.2493098078957, -442.1906359747497, -780.4871809232247, -61.50289086864506, -240.7823327101187, -551.8131298398988, -1226.3241743508424, -127.14173911081875, -707.6531397427198, -197.0893662244981, -848.0939935497314, -794.2027872188575, -1112.8859967532667, -1258.3693036124048], "episode_lengths": [73, 35, 150, 150, 150, 135, 150, 44, 150, 36, 101, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 104, 131, 150, 150, 112, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 140, 144, 47, 150, 150, 150, 150, 136, 150, 46, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 129, 150, 150, 46, 150, 81, 150, 150, 150, 97, 150, 40, 72, 150, 150, 71, 150, 83, 150, 150, 150, 150], "policy_policy_0_reward": [-96.91456580028844, -2.076386760377707, -1114.7996013098684, -659.6713531919736, -1407.6820955107416, -430.7305450196748, -449.131638830942, -48.08133659810395, -521.4505512037064, -22.178220098340425, -522.2813214423458, -654.8621382898264, -1120.7212533249499, -879.155519982308, -464.73325793634643, -779.5629900601228, -467.4666591486652, -201.2597204950269, -671.7178914150313, -1275.4451818525026, -1138.7906655839413, -1272.2790628890145, -1156.4877137698838, -764.8414793327389, -675.3014013873958, -201.5136547569193, -286.56780006643083, -1028.0271329688221, -1022.2610607319639, -320.44484106586265, -1363.877173753444, -1311.804506759814, -207.49746033353563, -1138.4732604036667, -843.1793397170264, -1121.5432663019687, -574.9405748466836, -917.9008553008872, -806.5259716102616, -1384.0986817969924, -430.89181088680203, -912.2685180329446, -796.4795380550215, -910.5533954118879, -572.4422852235728, -934.8856473654189, -1018.830582374999, -785.0688986627612, -181.47973611810795, -1307.445651447563, -1264.1927686002127, -853.3151471163312, -834.4802194926342, -18.843036231751395, -514.0768327901345, -546.1359416540195, -1238.6836103785745, -1169.4872028640677, -501.25552658909464, -1109.0746654592142, -50.03919447878458, -512.2872284650495, -968.4643017297208, -1160.8171349809659, -13.123811899122721, -547.6433721558575, -899.8534573387419, -505.3972606022615, -1092.4846822250956, -1015.4769342479818, -425.7469129543299, -1113.7746209428874, -684.5383643358912, -945.1421014747526, -17.028235720896507, -834.1794675238976, -868.7797720111553, -1342.2552727162908, -559.0325572266064, -509.45360619059136, -419.18354682022294, -122.56435668866058, -978.2490248043182, -140.80457347195596, -938.0622142960958, -459.28669502738927, -813.2493098078957, -442.1906359747497, -780.4871809232247, -61.50289086864506, -240.7823327101187, -551.8131298398988, -1226.3241743508424, -127.14173911081875, -707.6531397427198, -197.0893662244981, -848.0939935497314, -794.2027872188575, -1112.8859967532667, -1258.3693036124048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598330537717109, "mean_inference_ms": 1.682662995539178, "mean_action_processing_ms": 0.2801056179839263, "mean_env_wait_ms": 3.485201551253035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01192784309387207, "StateBufferConnector_ms": 0.008043766021728516, "ViewRequirementAgentConnector_ms": 0.19211959838867188}, "num_episodes": 27, "episode_return_max": -2.076386760377707, "episode_return_min": -1407.6820955107416, "episode_return_mean": -715.116238274207, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.1495745715404, "num_env_steps_trained_throughput_per_sec": 303.1495745715404, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12638.157, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12638.081, "sample_time_ms": 1130.06, "learn_time_ms": 11443.991, "learn_throughput": 349.528, "synch_weights_time_ms": 63.285}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00005", "date": "2024-08-04_05-57-31", "timestamp": 1722731251, "time_this_iter_s": 13.20841097831726, "time_total_s": 126.502206325531, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.502206325531, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.926315789473687, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.265325188512604, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.877237399915854, "policy_loss": -0.009727588570482719, "vf_loss": 8.896930230160555, "vf_explained_var": 0.5566550790021817, "kl": 0.01734531639085617, "entropy": 1.5168820569912593, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -13.123811899122721, "episode_reward_min": -1384.0986817969924, "episode_reward_mean": -761.3703845150892, "episode_len_mean": 135.91, "episode_media": {}, "episodes_timesteps_total": 13591, "policy_reward_min": {"policy_0": -1384.0986817969924}, "policy_reward_max": {"policy_0": -13.123811899122721}, "policy_reward_mean": {"policy_0": -761.3703845150892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.56780006643083, -1028.0271329688221, -1022.2610607319639, -320.44484106586265, -1363.877173753444, -1311.804506759814, -207.49746033353563, -1138.4732604036667, -843.1793397170264, -1121.5432663019687, -574.9405748466836, -917.9008553008872, -806.5259716102616, -1384.0986817969924, -430.89181088680203, -912.2685180329446, -796.4795380550215, -910.5533954118879, -572.4422852235728, -934.8856473654189, -1018.830582374999, -785.0688986627612, -181.47973611810795, -1307.445651447563, -1264.1927686002127, -853.3151471163312, -834.4802194926342, -18.843036231751395, -514.0768327901345, -546.1359416540195, -1238.6836103785745, -1169.4872028640677, -501.25552658909464, -1109.0746654592142, -50.03919447878458, -512.2872284650495, -968.4643017297208, -1160.8171349809659, -13.123811899122721, -547.6433721558575, -899.8534573387419, -505.3972606022615, -1092.4846822250956, -1015.4769342479818, -425.7469129543299, -1113.7746209428874, -684.5383643358912, -945.1421014747526, -17.028235720896507, -834.1794675238976, -868.7797720111553, -1342.2552727162908, -559.0325572266064, -509.45360619059136, -419.18354682022294, -122.56435668866058, -978.2490248043182, -140.80457347195596, -938.0622142960958, -459.28669502738927, -813.2493098078957, -442.1906359747497, -780.4871809232247, -61.50289086864506, -240.7823327101187, -551.8131298398988, -1226.3241743508424, -127.14173911081875, -707.6531397427198, -197.0893662244981, -848.0939935497314, -794.2027872188575, -1112.8859967532667, -1258.3693036124048, -180.81708906721593, -422.80624184169517, -1056.024556007753, -825.6053802294831, -432.92856048101214, -1142.0394562090237, -784.9199357220587, -952.4305189280037, -1150.192312577867, -432.4942123029836, -717.9529794581666, -905.6615143274138, -1040.488911010541, -948.3720038295564, -1282.163810646873, -616.3382727261572, -441.29922154471785, -1237.2081171359257, -539.7554922980703, -1152.799239612014, -490.61153609031237, -1192.6226134062945, -1024.2144167981983, -1177.751205009737, -663.2848610452278, -813.768371772945], "episode_lengths": [131, 150, 150, 112, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 140, 144, 47, 150, 150, 150, 150, 136, 150, 46, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 129, 150, 150, 46, 150, 81, 150, 150, 150, 97, 150, 40, 72, 150, 150, 71, 150, 83, 150, 150, 150, 150, 74, 120, 150, 141, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150], "policy_policy_0_reward": [-286.56780006643083, -1028.0271329688221, -1022.2610607319639, -320.44484106586265, -1363.877173753444, -1311.804506759814, -207.49746033353563, -1138.4732604036667, -843.1793397170264, -1121.5432663019687, -574.9405748466836, -917.9008553008872, -806.5259716102616, -1384.0986817969924, -430.89181088680203, -912.2685180329446, -796.4795380550215, -910.5533954118879, -572.4422852235728, -934.8856473654189, -1018.830582374999, -785.0688986627612, -181.47973611810795, -1307.445651447563, -1264.1927686002127, -853.3151471163312, -834.4802194926342, -18.843036231751395, -514.0768327901345, -546.1359416540195, -1238.6836103785745, -1169.4872028640677, -501.25552658909464, -1109.0746654592142, -50.03919447878458, -512.2872284650495, -968.4643017297208, -1160.8171349809659, -13.123811899122721, -547.6433721558575, -899.8534573387419, -505.3972606022615, -1092.4846822250956, -1015.4769342479818, -425.7469129543299, -1113.7746209428874, -684.5383643358912, -945.1421014747526, -17.028235720896507, -834.1794675238976, -868.7797720111553, -1342.2552727162908, -559.0325572266064, -509.45360619059136, -419.18354682022294, -122.56435668866058, -978.2490248043182, -140.80457347195596, -938.0622142960958, -459.28669502738927, -813.2493098078957, -442.1906359747497, -780.4871809232247, -61.50289086864506, -240.7823327101187, -551.8131298398988, -1226.3241743508424, -127.14173911081875, -707.6531397427198, -197.0893662244981, -848.0939935497314, -794.2027872188575, -1112.8859967532667, -1258.3693036124048, -180.81708906721593, -422.80624184169517, -1056.024556007753, -825.6053802294831, -432.92856048101214, -1142.0394562090237, -784.9199357220587, -952.4305189280037, -1150.192312577867, -432.4942123029836, -717.9529794581666, -905.6615143274138, -1040.488911010541, -948.3720038295564, -1282.163810646873, -616.3382727261572, -441.29922154471785, -1237.2081171359257, -539.7554922980703, -1152.799239612014, -490.61153609031237, -1192.6226134062945, -1024.2144167981983, -1177.751205009737, -663.2848610452278, -813.768371772945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5583857155191978, "mean_inference_ms": 1.6802145013894938, "mean_action_processing_ms": 0.27953780328151934, "mean_env_wait_ms": 3.4866364154875633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011729717254638672, "StateBufferConnector_ms": 0.008087873458862305, "ViewRequirementAgentConnector_ms": 0.19261932373046875}, "num_episodes": 26, "episode_return_max": -13.123811899122721, "episode_return_min": -1384.0986817969924, "episode_return_mean": -761.3703845150892, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.8346325801373, "num_env_steps_trained_throughput_per_sec": 309.8346325801373, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12789.006, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12788.93, "sample_time_ms": 1133.223, "learn_time_ms": 11592.259, "learn_throughput": 345.058, "synch_weights_time_ms": 62.701}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00005", "date": "2024-08-04_05-57-44", "timestamp": 1722731264, "time_this_iter_s": 12.922691822052002, "time_total_s": 139.424898147583, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.424898147583, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.42222222222222, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.4161828118066, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.443813660244148, "policy_loss": -0.011399076646678925, "vf_loss": 8.465555666883786, "vf_explained_var": 0.6602127213651935, "kl": 0.01806218563409252, "entropy": 1.5761597526570161, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -13.123811899122721, "episode_reward_min": -1409.0993465471283, "episode_reward_mean": -738.6990295073614, "episode_len_mean": 136.48, "episode_media": {}, "episodes_timesteps_total": 13648, "policy_reward_min": {"policy_0": -1409.0993465471283}, "policy_reward_max": {"policy_0": -13.123811899122721}, "policy_reward_mean": {"policy_0": -738.6990295073614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1169.4872028640677, -501.25552658909464, -1109.0746654592142, -50.03919447878458, -512.2872284650495, -968.4643017297208, -1160.8171349809659, -13.123811899122721, -547.6433721558575, -899.8534573387419, -505.3972606022615, -1092.4846822250956, -1015.4769342479818, -425.7469129543299, -1113.7746209428874, -684.5383643358912, -945.1421014747526, -17.028235720896507, -834.1794675238976, -868.7797720111553, -1342.2552727162908, -559.0325572266064, -509.45360619059136, -419.18354682022294, -122.56435668866058, -978.2490248043182, -140.80457347195596, -938.0622142960958, -459.28669502738927, -813.2493098078957, -442.1906359747497, -780.4871809232247, -61.50289086864506, -240.7823327101187, -551.8131298398988, -1226.3241743508424, -127.14173911081875, -707.6531397427198, -197.0893662244981, -848.0939935497314, -794.2027872188575, -1112.8859967532667, -1258.3693036124048, -180.81708906721593, -422.80624184169517, -1056.024556007753, -825.6053802294831, -432.92856048101214, -1142.0394562090237, -784.9199357220587, -952.4305189280037, -1150.192312577867, -432.4942123029836, -717.9529794581666, -905.6615143274138, -1040.488911010541, -948.3720038295564, -1282.163810646873, -616.3382727261572, -441.29922154471785, -1237.2081171359257, -539.7554922980703, -1152.799239612014, -490.61153609031237, -1192.6226134062945, -1024.2144167981983, -1177.751205009737, -663.2848610452278, -813.768371772945, -713.8509882756748, -475.33185260128147, -404.22614982480513, -546.5872509326684, -410.8595023648877, -1193.7043602544347, -637.0757020175511, -42.42897737036026, -696.1767725231085, -559.860192255781, -323.46255257026, -849.0960986194809, -756.9522171247462, -598.1935051948635, -1054.662249055409, -844.4343477153463, -951.5873497528455, -1409.0993465471283, -282.53731970156525, -720.4013976824106, -1218.7036192114356, -681.9611362649717, -915.1113034456353, -45.50224004152283, -755.8173033093468, -1349.438711173513, -971.3046558220747, -852.2744551413755, -922.7394193757284, -807.9866264088603, -1188.7124421482265], "episode_lengths": [150, 136, 150, 46, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 129, 150, 150, 46, 150, 81, 150, 150, 150, 97, 150, 40, 72, 150, 150, 71, 150, 83, 150, 150, 150, 150, 74, 120, 150, 141, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1169.4872028640677, -501.25552658909464, -1109.0746654592142, -50.03919447878458, -512.2872284650495, -968.4643017297208, -1160.8171349809659, -13.123811899122721, -547.6433721558575, -899.8534573387419, -505.3972606022615, -1092.4846822250956, -1015.4769342479818, -425.7469129543299, -1113.7746209428874, -684.5383643358912, -945.1421014747526, -17.028235720896507, -834.1794675238976, -868.7797720111553, -1342.2552727162908, -559.0325572266064, -509.45360619059136, -419.18354682022294, -122.56435668866058, -978.2490248043182, -140.80457347195596, -938.0622142960958, -459.28669502738927, -813.2493098078957, -442.1906359747497, -780.4871809232247, -61.50289086864506, -240.7823327101187, -551.8131298398988, -1226.3241743508424, -127.14173911081875, -707.6531397427198, -197.0893662244981, -848.0939935497314, -794.2027872188575, -1112.8859967532667, -1258.3693036124048, -180.81708906721593, -422.80624184169517, -1056.024556007753, -825.6053802294831, -432.92856048101214, -1142.0394562090237, -784.9199357220587, -952.4305189280037, -1150.192312577867, -432.4942123029836, -717.9529794581666, -905.6615143274138, -1040.488911010541, -948.3720038295564, -1282.163810646873, -616.3382727261572, -441.29922154471785, -1237.2081171359257, -539.7554922980703, -1152.799239612014, -490.61153609031237, -1192.6226134062945, -1024.2144167981983, -1177.751205009737, -663.2848610452278, -813.768371772945, -713.8509882756748, -475.33185260128147, -404.22614982480513, -546.5872509326684, -410.8595023648877, -1193.7043602544347, -637.0757020175511, -42.42897737036026, -696.1767725231085, -559.860192255781, -323.46255257026, -849.0960986194809, -756.9522171247462, -598.1935051948635, -1054.662249055409, -844.4343477153463, -951.5873497528455, -1409.0993465471283, -282.53731970156525, -720.4013976824106, -1218.7036192114356, -681.9611362649717, -915.1113034456353, -45.50224004152283, -755.8173033093468, -1349.438711173513, -971.3046558220747, -852.2744551413755, -922.7394193757284, -807.9866264088603, -1188.7124421482265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570089599113064, "mean_inference_ms": 1.6775572148358648, "mean_action_processing_ms": 0.2788383415403392, "mean_env_wait_ms": 3.4893201673244643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011593103408813477, "StateBufferConnector_ms": 0.008126497268676758, "ViewRequirementAgentConnector_ms": 0.1959850788116455}, "num_episodes": 31, "episode_return_max": -13.123811899122721, "episode_return_min": -1409.0993465471283, "episode_return_mean": -738.6990295073614, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.130452147054, "num_env_steps_trained_throughput_per_sec": 299.130452147054, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12951.988, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12951.909, "sample_time_ms": 1156.863, "learn_time_ms": 11729.209, "learn_throughput": 341.029, "synch_weights_time_ms": 65.075}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00005", "date": "2024-08-04_05-57-57", "timestamp": 1722731277, "time_this_iter_s": 13.384346961975098, "time_total_s": 152.8092451095581, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01124d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.8092451095581, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.189473684210526, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.94973966181278, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.94884931097428, "policy_loss": -0.011244026105850935, "vf_loss": 7.970011594891548, "vf_explained_var": 0.6444479000444213, "kl": 0.015588119232385619, "entropy": 1.4594699817399184, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -39.71309255811316, "episode_reward_min": -1435.4886703662967, "episode_reward_mean": -750.6475426957543, "episode_len_mean": 137.79, "episode_media": {}, "episodes_timesteps_total": 13779, "policy_reward_min": {"policy_0": -1435.4886703662967}, "policy_reward_max": {"policy_0": -39.71309255811316}, "policy_reward_mean": {"policy_0": -750.6475426957543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.4871809232247, -61.50289086864506, -240.7823327101187, -551.8131298398988, -1226.3241743508424, -127.14173911081875, -707.6531397427198, -197.0893662244981, -848.0939935497314, -794.2027872188575, -1112.8859967532667, -1258.3693036124048, -180.81708906721593, -422.80624184169517, -1056.024556007753, -825.6053802294831, -432.92856048101214, -1142.0394562090237, -784.9199357220587, -952.4305189280037, -1150.192312577867, -432.4942123029836, -717.9529794581666, -905.6615143274138, -1040.488911010541, -948.3720038295564, -1282.163810646873, -616.3382727261572, -441.29922154471785, -1237.2081171359257, -539.7554922980703, -1152.799239612014, -490.61153609031237, -1192.6226134062945, -1024.2144167981983, -1177.751205009737, -663.2848610452278, -813.768371772945, -713.8509882756748, -475.33185260128147, -404.22614982480513, -546.5872509326684, -410.8595023648877, -1193.7043602544347, -637.0757020175511, -42.42897737036026, -696.1767725231085, -559.860192255781, -323.46255257026, -849.0960986194809, -756.9522171247462, -598.1935051948635, -1054.662249055409, -844.4343477153463, -951.5873497528455, -1409.0993465471283, -282.53731970156525, -720.4013976824106, -1218.7036192114356, -681.9611362649717, -915.1113034456353, -45.50224004152283, -755.8173033093468, -1349.438711173513, -971.3046558220747, -852.2744551413755, -922.7394193757284, -807.9866264088603, -1188.7124421482265, -1340.6735694385625, -542.935062002602, -368.40982399319734, -960.2909993039195, -104.34194831215927, -39.71309255811316, -630.9158157627969, -629.5076935549572, -783.6782228002454, -431.6567319721567, -659.4625794353975, -752.3119185736189, -333.4317094432253, -320.59217256761286, -939.9314547013734, -41.37162736694663, -1292.8394999428212, -495.3973090374537, -826.352563555149, -390.94392410881187, -599.6727434319157, -766.2945642352222, -1236.2792109411714, -790.2584740943088, -669.259878992769, -1183.8957740361157, -1131.076039686323, -1435.4886703662967, -1063.9017690742776, -615.9979494483721, -976.8945671259538], "episode_lengths": [150, 40, 72, 150, 150, 71, 150, 83, 150, 150, 150, 150, 74, 120, 150, 141, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 60, 48, 150, 150, 150, 150, 122, 150, 101, 104, 150, 47, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-780.4871809232247, -61.50289086864506, -240.7823327101187, -551.8131298398988, -1226.3241743508424, -127.14173911081875, -707.6531397427198, -197.0893662244981, -848.0939935497314, -794.2027872188575, -1112.8859967532667, -1258.3693036124048, -180.81708906721593, -422.80624184169517, -1056.024556007753, -825.6053802294831, -432.92856048101214, -1142.0394562090237, -784.9199357220587, -952.4305189280037, -1150.192312577867, -432.4942123029836, -717.9529794581666, -905.6615143274138, -1040.488911010541, -948.3720038295564, -1282.163810646873, -616.3382727261572, -441.29922154471785, -1237.2081171359257, -539.7554922980703, -1152.799239612014, -490.61153609031237, -1192.6226134062945, -1024.2144167981983, -1177.751205009737, -663.2848610452278, -813.768371772945, -713.8509882756748, -475.33185260128147, -404.22614982480513, -546.5872509326684, -410.8595023648877, -1193.7043602544347, -637.0757020175511, -42.42897737036026, -696.1767725231085, -559.860192255781, -323.46255257026, -849.0960986194809, -756.9522171247462, -598.1935051948635, -1054.662249055409, -844.4343477153463, -951.5873497528455, -1409.0993465471283, -282.53731970156525, -720.4013976824106, -1218.7036192114356, -681.9611362649717, -915.1113034456353, -45.50224004152283, -755.8173033093468, -1349.438711173513, -971.3046558220747, -852.2744551413755, -922.7394193757284, -807.9866264088603, -1188.7124421482265, -1340.6735694385625, -542.935062002602, -368.40982399319734, -960.2909993039195, -104.34194831215927, -39.71309255811316, -630.9158157627969, -629.5076935549572, -783.6782228002454, -431.6567319721567, -659.4625794353975, -752.3119185736189, -333.4317094432253, -320.59217256761286, -939.9314547013734, -41.37162736694663, -1292.8394999428212, -495.3973090374537, -826.352563555149, -390.94392410881187, -599.6727434319157, -766.2945642352222, -1236.2792109411714, -790.2584740943088, -669.259878992769, -1183.8957740361157, -1131.076039686323, -1435.4886703662967, -1063.9017690742776, -615.9979494483721, -976.8945671259538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562766182286286, "mean_inference_ms": 1.6780983280044866, "mean_action_processing_ms": 0.27870484327258105, "mean_env_wait_ms": 3.4949631836041974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011441230773925781, "StateBufferConnector_ms": 0.008041858673095703, "ViewRequirementAgentConnector_ms": 0.1945507526397705}, "num_episodes": 31, "episode_return_max": -39.71309255811316, "episode_return_min": -1435.4886703662967, "episode_return_mean": -750.6475426957543, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.1586230799247, "num_env_steps_trained_throughput_per_sec": 297.1586230799247, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13043.073, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13042.994, "sample_time_ms": 1159.685, "learn_time_ms": 11816.465, "learn_throughput": 338.511, "synch_weights_time_ms": 66.081}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00005", "date": "2024-08-04_05-58-11", "timestamp": 1722731291, "time_this_iter_s": 13.473048210144043, "time_total_s": 166.28229331970215, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.28229331970215, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.884210526315787, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.895479901631674, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.687477552394072, "policy_loss": -0.016076004263595678, "vf_loss": 7.70965962211291, "vf_explained_var": 0.8197025104115406, "kl": 0.020089675441128444, "entropy": 1.2132998051742712, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -39.71309255811316, "episode_reward_min": -1435.4886703662967, "episode_reward_mean": -679.0605669574699, "episode_len_mean": 135.81, "episode_media": {}, "episodes_timesteps_total": 13581, "policy_reward_min": {"policy_0": -1435.4886703662967}, "policy_reward_max": {"policy_0": -39.71309255811316}, "policy_reward_mean": {"policy_0": -679.0605669574699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-490.61153609031237, -1192.6226134062945, -1024.2144167981983, -1177.751205009737, -663.2848610452278, -813.768371772945, -713.8509882756748, -475.33185260128147, -404.22614982480513, -546.5872509326684, -410.8595023648877, -1193.7043602544347, -637.0757020175511, -42.42897737036026, -696.1767725231085, -559.860192255781, -323.46255257026, -849.0960986194809, -756.9522171247462, -598.1935051948635, -1054.662249055409, -844.4343477153463, -951.5873497528455, -1409.0993465471283, -282.53731970156525, -720.4013976824106, -1218.7036192114356, -681.9611362649717, -915.1113034456353, -45.50224004152283, -755.8173033093468, -1349.438711173513, -971.3046558220747, -852.2744551413755, -922.7394193757284, -807.9866264088603, -1188.7124421482265, -1340.6735694385625, -542.935062002602, -368.40982399319734, -960.2909993039195, -104.34194831215927, -39.71309255811316, -630.9158157627969, -629.5076935549572, -783.6782228002454, -431.6567319721567, -659.4625794353975, -752.3119185736189, -333.4317094432253, -320.59217256761286, -939.9314547013734, -41.37162736694663, -1292.8394999428212, -495.3973090374537, -826.352563555149, -390.94392410881187, -599.6727434319157, -766.2945642352222, -1236.2792109411714, -790.2584740943088, -669.259878992769, -1183.8957740361157, -1131.076039686323, -1435.4886703662967, -1063.9017690742776, -615.9979494483721, -976.8945671259538, -425.95759921766887, -305.0696074877257, -574.9262705302225, -527.2687032694917, -40.72554757381282, -543.5728403580478, -581.3963532553976, -1240.1948420273836, -57.395289070220635, -154.9352104225925, -144.41047303149597, -789.4492995589969, -81.90675405761594, -1224.3305618973664, -475.28293057802074, -392.73444656486157, -1201.4354503465702, -645.6150128880221, -694.6654651941793, -401.7972698114854, -457.92605734888093, -1044.276421989584, -361.50990138664383, -299.83319431333666, -232.1310661612062, -704.0207909627505, -138.330844313582, -965.2575612515103, -544.410401130005, -450.77730818713553, -879.7778778026217, -428.624935044668], "episode_lengths": [150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 60, 48, 150, 150, 150, 150, 122, 150, 101, 104, 150, 47, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 53, 150, 147, 150, 62, 66, 80, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 93, 150, 73, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-490.61153609031237, -1192.6226134062945, -1024.2144167981983, -1177.751205009737, -663.2848610452278, -813.768371772945, -713.8509882756748, -475.33185260128147, -404.22614982480513, -546.5872509326684, -410.8595023648877, -1193.7043602544347, -637.0757020175511, -42.42897737036026, -696.1767725231085, -559.860192255781, -323.46255257026, -849.0960986194809, -756.9522171247462, -598.1935051948635, -1054.662249055409, -844.4343477153463, -951.5873497528455, -1409.0993465471283, -282.53731970156525, -720.4013976824106, -1218.7036192114356, -681.9611362649717, -915.1113034456353, -45.50224004152283, -755.8173033093468, -1349.438711173513, -971.3046558220747, -852.2744551413755, -922.7394193757284, -807.9866264088603, -1188.7124421482265, -1340.6735694385625, -542.935062002602, -368.40982399319734, -960.2909993039195, -104.34194831215927, -39.71309255811316, -630.9158157627969, -629.5076935549572, -783.6782228002454, -431.6567319721567, -659.4625794353975, -752.3119185736189, -333.4317094432253, -320.59217256761286, -939.9314547013734, -41.37162736694663, -1292.8394999428212, -495.3973090374537, -826.352563555149, -390.94392410881187, -599.6727434319157, -766.2945642352222, -1236.2792109411714, -790.2584740943088, -669.259878992769, -1183.8957740361157, -1131.076039686323, -1435.4886703662967, -1063.9017690742776, -615.9979494483721, -976.8945671259538, -425.95759921766887, -305.0696074877257, -574.9262705302225, -527.2687032694917, -40.72554757381282, -543.5728403580478, -581.3963532553976, -1240.1948420273836, -57.395289070220635, -154.9352104225925, -144.41047303149597, -789.4492995589969, -81.90675405761594, -1224.3305618973664, -475.28293057802074, -392.73444656486157, -1201.4354503465702, -645.6150128880221, -694.6654651941793, -401.7972698114854, -457.92605734888093, -1044.276421989584, -361.50990138664383, -299.83319431333666, -232.1310661612062, -704.0207909627505, -138.330844313582, -965.2575612515103, -544.410401130005, -450.77730818713553, -879.7778778026217, -428.624935044668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561785122684418, "mean_inference_ms": 1.6804864119778593, "mean_action_processing_ms": 0.2787506613923553, "mean_env_wait_ms": 3.503408986378436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011637449264526367, "StateBufferConnector_ms": 0.007958650588989258, "ViewRequirementAgentConnector_ms": 0.19533157348632812}, "num_episodes": 32, "episode_return_max": -39.71309255811316, "episode_return_min": -1435.4886703662967, "episode_return_mean": -679.0605669574699, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.32319472665665, "num_env_steps_trained_throughput_per_sec": 306.32319472665665, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13017.646, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13017.567, "sample_time_ms": 1148.527, "learn_time_ms": 11800.741, "learn_throughput": 338.962, "synch_weights_time_ms": 67.538}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00005", "date": "2024-08-04_05-58-24", "timestamp": 1722731304, "time_this_iter_s": 13.069404125213623, "time_total_s": 179.35169744491577, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0af910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.35169744491577, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.07894736842105, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.88216518163681, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.806275090575218, "policy_loss": -0.014577374143603569, "vf_loss": 7.827710590263208, "vf_explained_var": 0.7591228070979317, "kl": 0.01634355917732745, "entropy": 1.4212714596341054, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -31.580941462589912, "episode_reward_min": -1435.4886703662967, "episode_reward_mean": -687.5320065940018, "episode_len_mean": 136.34, "episode_media": {}, "episodes_timesteps_total": 13634, "policy_reward_min": {"policy_0": -1435.4886703662967}, "policy_reward_max": {"policy_0": -31.580941462589912}, "policy_reward_mean": {"policy_0": -687.5320065940018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-720.4013976824106, -1218.7036192114356, -681.9611362649717, -915.1113034456353, -45.50224004152283, -755.8173033093468, -1349.438711173513, -971.3046558220747, -852.2744551413755, -922.7394193757284, -807.9866264088603, -1188.7124421482265, -1340.6735694385625, -542.935062002602, -368.40982399319734, -960.2909993039195, -104.34194831215927, -39.71309255811316, -630.9158157627969, -629.5076935549572, -783.6782228002454, -431.6567319721567, -659.4625794353975, -752.3119185736189, -333.4317094432253, -320.59217256761286, -939.9314547013734, -41.37162736694663, -1292.8394999428212, -495.3973090374537, -826.352563555149, -390.94392410881187, -599.6727434319157, -766.2945642352222, -1236.2792109411714, -790.2584740943088, -669.259878992769, -1183.8957740361157, -1131.076039686323, -1435.4886703662967, -1063.9017690742776, -615.9979494483721, -976.8945671259538, -425.95759921766887, -305.0696074877257, -574.9262705302225, -527.2687032694917, -40.72554757381282, -543.5728403580478, -581.3963532553976, -1240.1948420273836, -57.395289070220635, -154.9352104225925, -144.41047303149597, -789.4492995589969, -81.90675405761594, -1224.3305618973664, -475.28293057802074, -392.73444656486157, -1201.4354503465702, -645.6150128880221, -694.6654651941793, -401.7972698114854, -457.92605734888093, -1044.276421989584, -361.50990138664383, -299.83319431333666, -232.1310661612062, -704.0207909627505, -138.330844313582, -965.2575612515103, -544.410401130005, -450.77730818713553, -879.7778778026217, -428.624935044668, -711.8016122973702, -465.45277587663037, -1266.9269511609618, -195.75100307614053, -675.4712857790714, -1033.2597036225789, -818.6284285455749, -31.580941462589912, -860.0386357816133, -1172.5538482084592, -886.4817320795663, -353.7539605711412, -1144.0665452760059, -546.6462038213479, -698.3056381691589, -607.1494150737252, -1008.968537127892, -804.6747917911068, -608.0835296974774, -592.8251925358304, -973.54705611594, -1231.6615824617509, -837.3154715932922, -931.1555678131515, -503.42329253976203], "episode_lengths": [150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 60, 48, 150, 150, 150, 150, 122, 150, 101, 104, 150, 47, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 53, 150, 147, 150, 62, 66, 80, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 93, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-720.4013976824106, -1218.7036192114356, -681.9611362649717, -915.1113034456353, -45.50224004152283, -755.8173033093468, -1349.438711173513, -971.3046558220747, -852.2744551413755, -922.7394193757284, -807.9866264088603, -1188.7124421482265, -1340.6735694385625, -542.935062002602, -368.40982399319734, -960.2909993039195, -104.34194831215927, -39.71309255811316, -630.9158157627969, -629.5076935549572, -783.6782228002454, -431.6567319721567, -659.4625794353975, -752.3119185736189, -333.4317094432253, -320.59217256761286, -939.9314547013734, -41.37162736694663, -1292.8394999428212, -495.3973090374537, -826.352563555149, -390.94392410881187, -599.6727434319157, -766.2945642352222, -1236.2792109411714, -790.2584740943088, -669.259878992769, -1183.8957740361157, -1131.076039686323, -1435.4886703662967, -1063.9017690742776, -615.9979494483721, -976.8945671259538, -425.95759921766887, -305.0696074877257, -574.9262705302225, -527.2687032694917, -40.72554757381282, -543.5728403580478, -581.3963532553976, -1240.1948420273836, -57.395289070220635, -154.9352104225925, -144.41047303149597, -789.4492995589969, -81.90675405761594, -1224.3305618973664, -475.28293057802074, -392.73444656486157, -1201.4354503465702, -645.6150128880221, -694.6654651941793, -401.7972698114854, -457.92605734888093, -1044.276421989584, -361.50990138664383, -299.83319431333666, -232.1310661612062, -704.0207909627505, -138.330844313582, -965.2575612515103, -544.410401130005, -450.77730818713553, -879.7778778026217, -428.624935044668, -711.8016122973702, -465.45277587663037, -1266.9269511609618, -195.75100307614053, -675.4712857790714, -1033.2597036225789, -818.6284285455749, -31.580941462589912, -860.0386357816133, -1172.5538482084592, -886.4817320795663, -353.7539605711412, -1144.0665452760059, -546.6462038213479, -698.3056381691589, -607.1494150737252, -1008.968537127892, -804.6747917911068, -608.0835296974774, -592.8251925358304, -973.54705611594, -1231.6615824617509, -837.3154715932922, -931.1555678131515, -503.42329253976203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556040785626007, "mean_inference_ms": 1.6810540083756182, "mean_action_processing_ms": 0.2785498373152514, "mean_env_wait_ms": 3.5056271108761536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011945724487304688, "StateBufferConnector_ms": 0.008026123046875, "ViewRequirementAgentConnector_ms": 0.19584369659423828}, "num_episodes": 25, "episode_return_max": -31.580941462589912, "episode_return_min": -1435.4886703662967, "episode_return_mean": -687.5320065940018, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.83781376857934, "num_env_steps_trained_throughput_per_sec": 306.83781376857934, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13036.274, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13036.197, "sample_time_ms": 1148.284, "learn_time_ms": 11821.377, "learn_throughput": 338.37, "synch_weights_time_ms": 65.767}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00005", "date": "2024-08-04_05-58-37", "timestamp": 1722731317, "time_this_iter_s": 13.04734182357788, "time_total_s": 192.39903926849365, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.39903926849365, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.878947368421056, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.35433813879887, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.21547227948904, "policy_loss": -0.008510942901678694, "vf_loss": 7.2307488108674685, "vf_explained_var": 0.8462180313964685, "kl": 0.016000822481942123, "entropy": 1.3965949727843205, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -23.86537075110803, "episode_reward_min": -1438.224948276031, "episode_reward_mean": -669.2254128395913, "episode_len_mean": 139.62, "episode_media": {}, "episodes_timesteps_total": 13962, "policy_reward_min": {"policy_0": -1438.224948276031}, "policy_reward_max": {"policy_0": -23.86537075110803}, "policy_reward_mean": {"policy_0": -669.2254128395913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.37162736694663, -1292.8394999428212, -495.3973090374537, -826.352563555149, -390.94392410881187, -599.6727434319157, -766.2945642352222, -1236.2792109411714, -790.2584740943088, -669.259878992769, -1183.8957740361157, -1131.076039686323, -1435.4886703662967, -1063.9017690742776, -615.9979494483721, -976.8945671259538, -425.95759921766887, -305.0696074877257, -574.9262705302225, -527.2687032694917, -40.72554757381282, -543.5728403580478, -581.3963532553976, -1240.1948420273836, -57.395289070220635, -154.9352104225925, -144.41047303149597, -789.4492995589969, -81.90675405761594, -1224.3305618973664, -475.28293057802074, -392.73444656486157, -1201.4354503465702, -645.6150128880221, -694.6654651941793, -401.7972698114854, -457.92605734888093, -1044.276421989584, -361.50990138664383, -299.83319431333666, -232.1310661612062, -704.0207909627505, -138.330844313582, -965.2575612515103, -544.410401130005, -450.77730818713553, -879.7778778026217, -428.624935044668, -711.8016122973702, -465.45277587663037, -1266.9269511609618, -195.75100307614053, -675.4712857790714, -1033.2597036225789, -818.6284285455749, -31.580941462589912, -860.0386357816133, -1172.5538482084592, -886.4817320795663, -353.7539605711412, -1144.0665452760059, -546.6462038213479, -698.3056381691589, -607.1494150737252, -1008.968537127892, -804.6747917911068, -608.0835296974774, -592.8251925358304, -973.54705611594, -1231.6615824617509, -837.3154715932922, -931.1555678131515, -503.42329253976203, -473.82652811308077, -712.7252870670028, -583.336030223185, -885.6738234406905, -1438.224948276031, -23.86537075110803, -298.6992912661645, -450.96292197240984, -864.0733362147873, -443.99395899757593, -717.5788692105064, -543.1412819206935, -714.1504077708806, -602.313431882882, -842.6086254772315, -1036.266057506445, -784.0861521148913, -585.3935349801417, -1164.5999308273, -602.3308360080149, -314.80477046618785, -373.5368795657934, -485.89021824051355, -796.6662138250225, -356.90529817008843, -711.7538648561989, -629.738859859154], "episode_lengths": [47, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 53, 150, 147, 150, 62, 66, 80, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 93, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-41.37162736694663, -1292.8394999428212, -495.3973090374537, -826.352563555149, -390.94392410881187, -599.6727434319157, -766.2945642352222, -1236.2792109411714, -790.2584740943088, -669.259878992769, -1183.8957740361157, -1131.076039686323, -1435.4886703662967, -1063.9017690742776, -615.9979494483721, -976.8945671259538, -425.95759921766887, -305.0696074877257, -574.9262705302225, -527.2687032694917, -40.72554757381282, -543.5728403580478, -581.3963532553976, -1240.1948420273836, -57.395289070220635, -154.9352104225925, -144.41047303149597, -789.4492995589969, -81.90675405761594, -1224.3305618973664, -475.28293057802074, -392.73444656486157, -1201.4354503465702, -645.6150128880221, -694.6654651941793, -401.7972698114854, -457.92605734888093, -1044.276421989584, -361.50990138664383, -299.83319431333666, -232.1310661612062, -704.0207909627505, -138.330844313582, -965.2575612515103, -544.410401130005, -450.77730818713553, -879.7778778026217, -428.624935044668, -711.8016122973702, -465.45277587663037, -1266.9269511609618, -195.75100307614053, -675.4712857790714, -1033.2597036225789, -818.6284285455749, -31.580941462589912, -860.0386357816133, -1172.5538482084592, -886.4817320795663, -353.7539605711412, -1144.0665452760059, -546.6462038213479, -698.3056381691589, -607.1494150737252, -1008.968537127892, -804.6747917911068, -608.0835296974774, -592.8251925358304, -973.54705611594, -1231.6615824617509, -837.3154715932922, -931.1555678131515, -503.42329253976203, -473.82652811308077, -712.7252870670028, -583.336030223185, -885.6738234406905, -1438.224948276031, -23.86537075110803, -298.6992912661645, -450.96292197240984, -864.0733362147873, -443.99395899757593, -717.5788692105064, -543.1412819206935, -714.1504077708806, -602.313431882882, -842.6086254772315, -1036.266057506445, -784.0861521148913, -585.3935349801417, -1164.5999308273, -602.3308360080149, -314.80477046618785, -373.5368795657934, -485.89021824051355, -796.6662138250225, -356.90529817008843, -711.7538648561989, -629.738859859154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554726578954309, "mean_inference_ms": 1.6802347316282025, "mean_action_processing_ms": 0.2781362676180944, "mean_env_wait_ms": 3.504176979292873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011909008026123047, "StateBufferConnector_ms": 0.00796651840209961, "ViewRequirementAgentConnector_ms": 0.19301533699035645}, "num_episodes": 27, "episode_return_max": -23.86537075110803, "episode_return_min": -1438.224948276031, "episode_return_mean": -669.2254128395913, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.1533785571454, "num_env_steps_trained_throughput_per_sec": 323.1533785571454, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12938.355, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12938.279, "sample_time_ms": 1144.388, "learn_time_ms": 11727.745, "learn_throughput": 341.072, "synch_weights_time_ms": 65.377}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00005", "date": "2024-08-04_05-58-49", "timestamp": 1722731329, "time_this_iter_s": 12.390464067459106, "time_total_s": 204.78950333595276, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a60e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.78950333595276, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.635294117647057, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.56366606156031, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.800540658583244, "policy_loss": -0.017057134023828743, "vf_loss": 6.825025128821532, "vf_explained_var": 0.8380010847623149, "kl": 0.016741169647260298, "entropy": 1.4960889454931021, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -23.86537075110803, "episode_reward_min": -1438.224948276031, "episode_reward_mean": -698.0425088593611, "episode_len_mean": 143.02, "episode_media": {}, "episodes_timesteps_total": 14302, "policy_reward_min": {"policy_0": -1438.224948276031}, "policy_reward_max": {"policy_0": -23.86537075110803}, "policy_reward_mean": {"policy_0": -698.0425088593611}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1224.3305618973664, -475.28293057802074, -392.73444656486157, -1201.4354503465702, -645.6150128880221, -694.6654651941793, -401.7972698114854, -457.92605734888093, -1044.276421989584, -361.50990138664383, -299.83319431333666, -232.1310661612062, -704.0207909627505, -138.330844313582, -965.2575612515103, -544.410401130005, -450.77730818713553, -879.7778778026217, -428.624935044668, -711.8016122973702, -465.45277587663037, -1266.9269511609618, -195.75100307614053, -675.4712857790714, -1033.2597036225789, -818.6284285455749, -31.580941462589912, -860.0386357816133, -1172.5538482084592, -886.4817320795663, -353.7539605711412, -1144.0665452760059, -546.6462038213479, -698.3056381691589, -607.1494150737252, -1008.968537127892, -804.6747917911068, -608.0835296974774, -592.8251925358304, -973.54705611594, -1231.6615824617509, -837.3154715932922, -931.1555678131515, -503.42329253976203, -473.82652811308077, -712.7252870670028, -583.336030223185, -885.6738234406905, -1438.224948276031, -23.86537075110803, -298.6992912661645, -450.96292197240984, -864.0733362147873, -443.99395899757593, -717.5788692105064, -543.1412819206935, -714.1504077708806, -602.313431882882, -842.6086254772315, -1036.266057506445, -784.0861521148913, -585.3935349801417, -1164.5999308273, -602.3308360080149, -314.80477046618785, -373.5368795657934, -485.89021824051355, -796.6662138250225, -356.90529817008843, -711.7538648561989, -629.738859859154, -572.2375206779368, -859.1259629495216, -470.4803696875667, -884.1523665744382, -806.9308602022558, -988.2172481520796, -838.2653304241038, -787.001073883367, -884.6928168628466, -1006.591141144199, -1232.3173870249702, -838.532824868034, -39.26862065960072, -532.5729131166047, -839.2614793513883, -810.0571284329047, -1244.9235774870824, -753.9095419924811, -623.354054893967, -161.0760973936467, -507.40986060972716, -1187.996961861725, -426.9839332234139, -740.6109820888912, -653.828124122967, -1072.1657486282159, -813.7987509992762, -230.00550573141894, -1059.0747742369213], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 93, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 100, 150], "policy_policy_0_reward": [-1224.3305618973664, -475.28293057802074, -392.73444656486157, -1201.4354503465702, -645.6150128880221, -694.6654651941793, -401.7972698114854, -457.92605734888093, -1044.276421989584, -361.50990138664383, -299.83319431333666, -232.1310661612062, -704.0207909627505, -138.330844313582, -965.2575612515103, -544.410401130005, -450.77730818713553, -879.7778778026217, -428.624935044668, -711.8016122973702, -465.45277587663037, -1266.9269511609618, -195.75100307614053, -675.4712857790714, -1033.2597036225789, -818.6284285455749, -31.580941462589912, -860.0386357816133, -1172.5538482084592, -886.4817320795663, -353.7539605711412, -1144.0665452760059, -546.6462038213479, -698.3056381691589, -607.1494150737252, -1008.968537127892, -804.6747917911068, -608.0835296974774, -592.8251925358304, -973.54705611594, -1231.6615824617509, -837.3154715932922, -931.1555678131515, -503.42329253976203, -473.82652811308077, -712.7252870670028, -583.336030223185, -885.6738234406905, -1438.224948276031, -23.86537075110803, -298.6992912661645, -450.96292197240984, -864.0733362147873, -443.99395899757593, -717.5788692105064, -543.1412819206935, -714.1504077708806, -602.313431882882, -842.6086254772315, -1036.266057506445, -784.0861521148913, -585.3935349801417, -1164.5999308273, -602.3308360080149, -314.80477046618785, -373.5368795657934, -485.89021824051355, -796.6662138250225, -356.90529817008843, -711.7538648561989, -629.738859859154, -572.2375206779368, -859.1259629495216, -470.4803696875667, -884.1523665744382, -806.9308602022558, -988.2172481520796, -838.2653304241038, -787.001073883367, -884.6928168628466, -1006.591141144199, -1232.3173870249702, -838.532824868034, -39.26862065960072, -532.5729131166047, -839.2614793513883, -810.0571284329047, -1244.9235774870824, -753.9095419924811, -623.354054893967, -161.0760973936467, -507.40986060972716, -1187.996961861725, -426.9839332234139, -740.6109820888912, -653.828124122967, -1072.1657486282159, -813.7987509992762, -230.00550573141894, -1059.0747742369213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555354316050828, "mean_inference_ms": 1.678381586283911, "mean_action_processing_ms": 0.2776300520368052, "mean_env_wait_ms": 3.5001406295571393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012028217315673828, "StateBufferConnector_ms": 0.007982254028320312, "ViewRequirementAgentConnector_ms": 0.1933271884918213}, "num_episodes": 29, "episode_return_max": -23.86537075110803, "episode_return_min": -1438.224948276031, "episode_return_mean": -698.0425088593611, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.28195161252023, "num_env_steps_trained_throughput_per_sec": 302.28195161252023, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13041.859, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13041.783, "sample_time_ms": 1151.63, "learn_time_ms": 11823.876, "learn_throughput": 338.299, "synch_weights_time_ms": 65.506}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00005", "date": "2024-08-04_05-59-03", "timestamp": 1722731343, "time_this_iter_s": 13.244035005569458, "time_total_s": 218.03353834152222, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0af910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.03353834152222, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.010526315789473, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.37560346027215, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.580877258876959, "policy_loss": -0.00889870988369997, "vf_loss": 6.595535651842753, "vf_explained_var": 0.8979136883591612, "kl": 0.015334989970627573, "entropy": 1.266040882219871, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -23.86537075110803, "episode_reward_min": -1438.224948276031, "episode_reward_mean": -686.4427604953628, "episode_len_mean": 142.74, "episode_media": {}, "episodes_timesteps_total": 14274, "policy_reward_min": {"policy_0": -1438.224948276031}, "policy_reward_max": {"policy_0": -23.86537075110803}, "policy_reward_mean": {"policy_0": -686.4427604953628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-546.6462038213479, -698.3056381691589, -607.1494150737252, -1008.968537127892, -804.6747917911068, -608.0835296974774, -592.8251925358304, -973.54705611594, -1231.6615824617509, -837.3154715932922, -931.1555678131515, -503.42329253976203, -473.82652811308077, -712.7252870670028, -583.336030223185, -885.6738234406905, -1438.224948276031, -23.86537075110803, -298.6992912661645, -450.96292197240984, -864.0733362147873, -443.99395899757593, -717.5788692105064, -543.1412819206935, -714.1504077708806, -602.313431882882, -842.6086254772315, -1036.266057506445, -784.0861521148913, -585.3935349801417, -1164.5999308273, -602.3308360080149, -314.80477046618785, -373.5368795657934, -485.89021824051355, -796.6662138250225, -356.90529817008843, -711.7538648561989, -629.738859859154, -572.2375206779368, -859.1259629495216, -470.4803696875667, -884.1523665744382, -806.9308602022558, -988.2172481520796, -838.2653304241038, -787.001073883367, -884.6928168628466, -1006.591141144199, -1232.3173870249702, -838.532824868034, -39.26862065960072, -532.5729131166047, -839.2614793513883, -810.0571284329047, -1244.9235774870824, -753.9095419924811, -623.354054893967, -161.0760973936467, -507.40986060972716, -1187.996961861725, -426.9839332234139, -740.6109820888912, -653.828124122967, -1072.1657486282159, -813.7987509992762, -230.00550573141894, -1059.0747742369213, -753.4469196627618, -678.7538491939763, -1257.9778721758457, -709.3249182353422, -679.4973067025613, -664.1045582056242, -1087.5773500337145, -741.7417457599507, -785.4977710824128, -848.0827231228344, -596.1759240452702, -57.20055511527265, -444.36554463798444, -84.93054638905066, -712.439072178121, -538.4103813310242, -369.862873289641, -330.9450746601345, -480.79083612857875, -603.6756637829643, -1055.7241093074288, -331.7199994782035, -1081.658847467741, -499.2532413528959, -719.8421870750042, -910.8082391659276, -559.5628117314388, -222.04540400655193, -310.84248127190443, -761.782311783508, -495.2626288189814, -625.2263373176742], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 103, 69, 150, 150, 150, 93, 150, 150, 150, 125, 150, 150, 150, 150, 150, 100, 122, 150, 150, 150], "policy_policy_0_reward": [-546.6462038213479, -698.3056381691589, -607.1494150737252, -1008.968537127892, -804.6747917911068, -608.0835296974774, -592.8251925358304, -973.54705611594, -1231.6615824617509, -837.3154715932922, -931.1555678131515, -503.42329253976203, -473.82652811308077, -712.7252870670028, -583.336030223185, -885.6738234406905, -1438.224948276031, -23.86537075110803, -298.6992912661645, -450.96292197240984, -864.0733362147873, -443.99395899757593, -717.5788692105064, -543.1412819206935, -714.1504077708806, -602.313431882882, -842.6086254772315, -1036.266057506445, -784.0861521148913, -585.3935349801417, -1164.5999308273, -602.3308360080149, -314.80477046618785, -373.5368795657934, -485.89021824051355, -796.6662138250225, -356.90529817008843, -711.7538648561989, -629.738859859154, -572.2375206779368, -859.1259629495216, -470.4803696875667, -884.1523665744382, -806.9308602022558, -988.2172481520796, -838.2653304241038, -787.001073883367, -884.6928168628466, -1006.591141144199, -1232.3173870249702, -838.532824868034, -39.26862065960072, -532.5729131166047, -839.2614793513883, -810.0571284329047, -1244.9235774870824, -753.9095419924811, -623.354054893967, -161.0760973936467, -507.40986060972716, -1187.996961861725, -426.9839332234139, -740.6109820888912, -653.828124122967, -1072.1657486282159, -813.7987509992762, -230.00550573141894, -1059.0747742369213, -753.4469196627618, -678.7538491939763, -1257.9778721758457, -709.3249182353422, -679.4973067025613, -664.1045582056242, -1087.5773500337145, -741.7417457599507, -785.4977710824128, -848.0827231228344, -596.1759240452702, -57.20055511527265, -444.36554463798444, -84.93054638905066, -712.439072178121, -538.4103813310242, -369.862873289641, -330.9450746601345, -480.79083612857875, -603.6756637829643, -1055.7241093074288, -331.7199994782035, -1081.658847467741, -499.2532413528959, -719.8421870750042, -910.8082391659276, -559.5628117314388, -222.04540400655193, -310.84248127190443, -761.782311783508, -495.2626288189814, -625.2263373176742]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547731272136409, "mean_inference_ms": 1.6771844794841408, "mean_action_processing_ms": 0.2773575541230281, "mean_env_wait_ms": 3.4996338855400206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011748313903808594, "StateBufferConnector_ms": 0.007887840270996094, "ViewRequirementAgentConnector_ms": 0.19139957427978516}, "num_episodes": 32, "episode_return_max": -23.86537075110803, "episode_return_min": -1438.224948276031, "episode_return_mean": -686.4427604953628, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.55228916478063, "num_env_steps_trained_throughput_per_sec": 308.55228916478063, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13055.313, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13055.239, "sample_time_ms": 1155.201, "learn_time_ms": 11833.693, "learn_throughput": 338.018, "synch_weights_time_ms": 65.563}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00005", "date": "2024-08-04_05-59-16", "timestamp": 1722731356, "time_this_iter_s": 12.975759506225586, "time_total_s": 231.0092978477478, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.0092978477478, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.678947368421053, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.63971513708432, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.791990208625793, "policy_loss": -0.01127204935764894, "vf_loss": 6.811132310827573, "vf_explained_var": 0.8890399930998683, "kl": 0.016479861299565832, "entropy": 1.5285994427899519, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -34.587977411197855, "episode_reward_min": -1301.444337630185, "episode_reward_mean": -682.3199841854588, "episode_len_mean": 141.16, "episode_media": {}, "episodes_timesteps_total": 14116, "policy_reward_min": {"policy_0": -1301.444337630185}, "policy_reward_max": {"policy_0": -34.587977411197855}, "policy_reward_mean": {"policy_0": -682.3199841854588}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-842.6086254772315, -1036.266057506445, -784.0861521148913, -585.3935349801417, -1164.5999308273, -602.3308360080149, -314.80477046618785, -373.5368795657934, -485.89021824051355, -796.6662138250225, -356.90529817008843, -711.7538648561989, -629.738859859154, -572.2375206779368, -859.1259629495216, -470.4803696875667, -884.1523665744382, -806.9308602022558, -988.2172481520796, -838.2653304241038, -787.001073883367, -884.6928168628466, -1006.591141144199, -1232.3173870249702, -838.532824868034, -39.26862065960072, -532.5729131166047, -839.2614793513883, -810.0571284329047, -1244.9235774870824, -753.9095419924811, -623.354054893967, -161.0760973936467, -507.40986060972716, -1187.996961861725, -426.9839332234139, -740.6109820888912, -653.828124122967, -1072.1657486282159, -813.7987509992762, -230.00550573141894, -1059.0747742369213, -753.4469196627618, -678.7538491939763, -1257.9778721758457, -709.3249182353422, -679.4973067025613, -664.1045582056242, -1087.5773500337145, -741.7417457599507, -785.4977710824128, -848.0827231228344, -596.1759240452702, -57.20055511527265, -444.36554463798444, -84.93054638905066, -712.439072178121, -538.4103813310242, -369.862873289641, -330.9450746601345, -480.79083612857875, -603.6756637829643, -1055.7241093074288, -331.7199994782035, -1081.658847467741, -499.2532413528959, -719.8421870750042, -910.8082391659276, -559.5628117314388, -222.04540400655193, -310.84248127190443, -761.782311783508, -495.2626288189814, -625.2263373176742, -844.982554498525, -919.9317873104384, -1301.444337630185, -691.0876506012612, -873.3149849817345, -692.5014244298451, -34.587977411197855, -522.2560238862955, -743.3471879589889, -831.9024907114768, -812.4871400879009, -129.23565268379332, -70.00935115790398, -680.8922249494136, -557.3274659134921, -719.7363470327002, -660.2708856498232, -483.62811641740745, -1056.4291929341894, -655.1935307541056, -403.2871146255955, -994.2450431311606, -959.9835062193722, -673.2557505722215, -778.6549356266578, -594.0514576813264], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 103, 69, 150, 150, 150, 93, 150, 150, 150, 125, 150, 150, 150, 150, 150, 100, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 68, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-842.6086254772315, -1036.266057506445, -784.0861521148913, -585.3935349801417, -1164.5999308273, -602.3308360080149, -314.80477046618785, -373.5368795657934, -485.89021824051355, -796.6662138250225, -356.90529817008843, -711.7538648561989, -629.738859859154, -572.2375206779368, -859.1259629495216, -470.4803696875667, -884.1523665744382, -806.9308602022558, -988.2172481520796, -838.2653304241038, -787.001073883367, -884.6928168628466, -1006.591141144199, -1232.3173870249702, -838.532824868034, -39.26862065960072, -532.5729131166047, -839.2614793513883, -810.0571284329047, -1244.9235774870824, -753.9095419924811, -623.354054893967, -161.0760973936467, -507.40986060972716, -1187.996961861725, -426.9839332234139, -740.6109820888912, -653.828124122967, -1072.1657486282159, -813.7987509992762, -230.00550573141894, -1059.0747742369213, -753.4469196627618, -678.7538491939763, -1257.9778721758457, -709.3249182353422, -679.4973067025613, -664.1045582056242, -1087.5773500337145, -741.7417457599507, -785.4977710824128, -848.0827231228344, -596.1759240452702, -57.20055511527265, -444.36554463798444, -84.93054638905066, -712.439072178121, -538.4103813310242, -369.862873289641, -330.9450746601345, -480.79083612857875, -603.6756637829643, -1055.7241093074288, -331.7199994782035, -1081.658847467741, -499.2532413528959, -719.8421870750042, -910.8082391659276, -559.5628117314388, -222.04540400655193, -310.84248127190443, -761.782311783508, -495.2626288189814, -625.2263373176742, -844.982554498525, -919.9317873104384, -1301.444337630185, -691.0876506012612, -873.3149849817345, -692.5014244298451, -34.587977411197855, -522.2560238862955, -743.3471879589889, -831.9024907114768, -812.4871400879009, -129.23565268379332, -70.00935115790398, -680.8922249494136, -557.3274659134921, -719.7363470327002, -660.2708856498232, -483.62811641740745, -1056.4291929341894, -655.1935307541056, -403.2871146255955, -994.2450431311606, -959.9835062193722, -673.2557505722215, -778.6549356266578, -594.0514576813264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544172973543863, "mean_inference_ms": 1.676824727848438, "mean_action_processing_ms": 0.277083098341074, "mean_env_wait_ms": 3.4999198659577018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01182103157043457, "StateBufferConnector_ms": 0.007922649383544922, "ViewRequirementAgentConnector_ms": 0.19270634651184082}, "num_episodes": 26, "episode_return_max": -34.587977411197855, "episode_return_min": -1301.444337630185, "episode_return_mean": -682.3199841854588, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.85984751135265, "num_env_steps_trained_throughput_per_sec": 322.85984751135265, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12999.602, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12999.528, "sample_time_ms": 1159.071, "learn_time_ms": 11774.771, "learn_throughput": 339.709, "synch_weights_time_ms": 64.903}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00005", "date": "2024-08-04_05-59-28", "timestamp": 1722731368, "time_this_iter_s": 12.402602910995483, "time_total_s": 243.4119007587433, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0113d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 243.4119007587433, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.835294117647063, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.581757252415024, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.523516500989596, "policy_loss": -0.01457096856320277, "vf_loss": 6.546888402104377, "vf_explained_var": 0.8797765438134472, "kl": 0.013740981529645094, "entropy": 1.4984380559374888, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -34.587977411197855, "episode_reward_min": -1383.9819395270342, "episode_reward_mean": -666.0401828129559, "episode_len_mean": 138.6, "episode_media": {}, "episodes_timesteps_total": 13860, "policy_reward_min": {"policy_0": -1383.9819395270342}, "policy_reward_max": {"policy_0": -34.587977411197855}, "policy_reward_mean": {"policy_0": -666.0401828129559}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-753.9095419924811, -623.354054893967, -161.0760973936467, -507.40986060972716, -1187.996961861725, -426.9839332234139, -740.6109820888912, -653.828124122967, -1072.1657486282159, -813.7987509992762, -230.00550573141894, -1059.0747742369213, -753.4469196627618, -678.7538491939763, -1257.9778721758457, -709.3249182353422, -679.4973067025613, -664.1045582056242, -1087.5773500337145, -741.7417457599507, -785.4977710824128, -848.0827231228344, -596.1759240452702, -57.20055511527265, -444.36554463798444, -84.93054638905066, -712.439072178121, -538.4103813310242, -369.862873289641, -330.9450746601345, -480.79083612857875, -603.6756637829643, -1055.7241093074288, -331.7199994782035, -1081.658847467741, -499.2532413528959, -719.8421870750042, -910.8082391659276, -559.5628117314388, -222.04540400655193, -310.84248127190443, -761.782311783508, -495.2626288189814, -625.2263373176742, -844.982554498525, -919.9317873104384, -1301.444337630185, -691.0876506012612, -873.3149849817345, -692.5014244298451, -34.587977411197855, -522.2560238862955, -743.3471879589889, -831.9024907114768, -812.4871400879009, -129.23565268379332, -70.00935115790398, -680.8922249494136, -557.3274659134921, -719.7363470327002, -660.2708856498232, -483.62811641740745, -1056.4291929341894, -655.1935307541056, -403.2871146255955, -994.2450431311606, -959.9835062193722, -673.2557505722215, -778.6549356266578, -594.0514576813264, -1103.3226293863086, -389.2251456480598, -926.3707033352498, -631.7286130267553, -212.56175124586028, -1032.663552930924, -93.19886356393232, -1383.9819395270342, -928.1349730912989, -732.6991163774148, -791.4864789953903, -753.3250083646394, -570.0660698103668, -755.2574804029624, -262.0641695575988, -265.72458899832145, -810.9479341855584, -538.5338268321736, -470.4649654515878, -734.5662532587572, -656.3258527718824, -552.4623750754655, -726.0287370230903, -672.8099897845533, -83.32489441400561, -765.0576880447753, -737.7713740622723, -634.9929403344498, -1137.4136814469177, -1338.7181291979964], "episode_lengths": [150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 103, 69, 150, 150, 150, 93, 150, 150, 150, 125, 150, 150, 150, 150, 150, 100, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 68, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 88, 150, 69, 150, 150, 150, 150, 150, 150, 150, 85, 107, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-753.9095419924811, -623.354054893967, -161.0760973936467, -507.40986060972716, -1187.996961861725, -426.9839332234139, -740.6109820888912, -653.828124122967, -1072.1657486282159, -813.7987509992762, -230.00550573141894, -1059.0747742369213, -753.4469196627618, -678.7538491939763, -1257.9778721758457, -709.3249182353422, -679.4973067025613, -664.1045582056242, -1087.5773500337145, -741.7417457599507, -785.4977710824128, -848.0827231228344, -596.1759240452702, -57.20055511527265, -444.36554463798444, -84.93054638905066, -712.439072178121, -538.4103813310242, -369.862873289641, -330.9450746601345, -480.79083612857875, -603.6756637829643, -1055.7241093074288, -331.7199994782035, -1081.658847467741, -499.2532413528959, -719.8421870750042, -910.8082391659276, -559.5628117314388, -222.04540400655193, -310.84248127190443, -761.782311783508, -495.2626288189814, -625.2263373176742, -844.982554498525, -919.9317873104384, -1301.444337630185, -691.0876506012612, -873.3149849817345, -692.5014244298451, -34.587977411197855, -522.2560238862955, -743.3471879589889, -831.9024907114768, -812.4871400879009, -129.23565268379332, -70.00935115790398, -680.8922249494136, -557.3274659134921, -719.7363470327002, -660.2708856498232, -483.62811641740745, -1056.4291929341894, -655.1935307541056, -403.2871146255955, -994.2450431311606, -959.9835062193722, -673.2557505722215, -778.6549356266578, -594.0514576813264, -1103.3226293863086, -389.2251456480598, -926.3707033352498, -631.7286130267553, -212.56175124586028, -1032.663552930924, -93.19886356393232, -1383.9819395270342, -928.1349730912989, -732.6991163774148, -791.4864789953903, -753.3250083646394, -570.0660698103668, -755.2574804029624, -262.0641695575988, -265.72458899832145, -810.9479341855584, -538.5338268321736, -470.4649654515878, -734.5662532587572, -656.3258527718824, -552.4623750754655, -726.0287370230903, -672.8099897845533, -83.32489441400561, -765.0576880447753, -737.7713740622723, -634.9929403344498, -1137.4136814469177, -1338.7181291979964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537787785480711, "mean_inference_ms": 1.6766421822582305, "mean_action_processing_ms": 0.2772534752405257, "mean_env_wait_ms": 3.501573807133549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011617898941040039, "StateBufferConnector_ms": 0.007811069488525391, "ViewRequirementAgentConnector_ms": 0.1913437843322754}, "num_episodes": 30, "episode_return_max": -34.587977411197855, "episode_return_min": -1383.9819395270342, "episode_return_mean": -666.0401828129559, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2431187780547, "num_env_steps_trained_throughput_per_sec": 310.2431187780547, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12969.432, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12969.358, "sample_time_ms": 1170.666, "learn_time_ms": 11733.852, "learn_throughput": 340.894, "synch_weights_time_ms": 64.057}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00005", "date": "2024-08-04_05-59-41", "timestamp": 1722731381, "time_this_iter_s": 12.905371904373169, "time_total_s": 256.31727266311646, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0113370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.31727266311646, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.036842105263162, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.58371244172255, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.486290588478247, "policy_loss": -0.01371610385152356, "vf_loss": 6.507668533921242, "vf_explained_var": 0.913022826363643, "kl": 0.01715981915466121, "entropy": 1.5383756724496682, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -14.51495014795809, "episode_reward_min": -1383.9819395270342, "episode_reward_mean": -688.5802005849246, "episode_len_mean": 138.77, "episode_media": {}, "episodes_timesteps_total": 13877, "policy_reward_min": {"policy_0": -1383.9819395270342}, "policy_reward_max": {"policy_0": -14.51495014795809}, "policy_reward_mean": {"policy_0": -688.5802005849246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-480.79083612857875, -603.6756637829643, -1055.7241093074288, -331.7199994782035, -1081.658847467741, -499.2532413528959, -719.8421870750042, -910.8082391659276, -559.5628117314388, -222.04540400655193, -310.84248127190443, -761.782311783508, -495.2626288189814, -625.2263373176742, -844.982554498525, -919.9317873104384, -1301.444337630185, -691.0876506012612, -873.3149849817345, -692.5014244298451, -34.587977411197855, -522.2560238862955, -743.3471879589889, -831.9024907114768, -812.4871400879009, -129.23565268379332, -70.00935115790398, -680.8922249494136, -557.3274659134921, -719.7363470327002, -660.2708856498232, -483.62811641740745, -1056.4291929341894, -655.1935307541056, -403.2871146255955, -994.2450431311606, -959.9835062193722, -673.2557505722215, -778.6549356266578, -594.0514576813264, -1103.3226293863086, -389.2251456480598, -926.3707033352498, -631.7286130267553, -212.56175124586028, -1032.663552930924, -93.19886356393232, -1383.9819395270342, -928.1349730912989, -732.6991163774148, -791.4864789953903, -753.3250083646394, -570.0660698103668, -755.2574804029624, -262.0641695575988, -265.72458899832145, -810.9479341855584, -538.5338268321736, -470.4649654515878, -734.5662532587572, -656.3258527718824, -552.4623750754655, -726.0287370230903, -672.8099897845533, -83.32489441400561, -765.0576880447753, -737.7713740622723, -634.9929403344498, -1137.4136814469177, -1338.7181291979964, -548.9379795003334, -1030.4780858510833, -983.2810762200562, -594.0060912371621, -959.1526264760809, -71.16220986754314, -856.3377622451571, -1053.410848434519, -1009.2547067046601, -151.82284081058532, -791.5548444118156, -460.36038288268855, -583.847630457859, -701.090917785262, -958.5981481990485, -715.5399170905836, -78.74485463170626, -622.7658354451889, -804.044350069826, -600.0327208654489, -671.8457924987375, -14.51495014795809, -1183.154584363858, -809.6648491631919, -977.4118490051536, -722.0750430741605, -1065.469102991352, -1010.2604565705633, -535.9229093310714, -1259.8077324683857], "episode_lengths": [150, 150, 150, 125, 150, 150, 150, 150, 150, 100, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 68, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 88, 150, 69, 150, 150, 150, 150, 150, 150, 150, 85, 107, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-480.79083612857875, -603.6756637829643, -1055.7241093074288, -331.7199994782035, -1081.658847467741, -499.2532413528959, -719.8421870750042, -910.8082391659276, -559.5628117314388, -222.04540400655193, -310.84248127190443, -761.782311783508, -495.2626288189814, -625.2263373176742, -844.982554498525, -919.9317873104384, -1301.444337630185, -691.0876506012612, -873.3149849817345, -692.5014244298451, -34.587977411197855, -522.2560238862955, -743.3471879589889, -831.9024907114768, -812.4871400879009, -129.23565268379332, -70.00935115790398, -680.8922249494136, -557.3274659134921, -719.7363470327002, -660.2708856498232, -483.62811641740745, -1056.4291929341894, -655.1935307541056, -403.2871146255955, -994.2450431311606, -959.9835062193722, -673.2557505722215, -778.6549356266578, -594.0514576813264, -1103.3226293863086, -389.2251456480598, -926.3707033352498, -631.7286130267553, -212.56175124586028, -1032.663552930924, -93.19886356393232, -1383.9819395270342, -928.1349730912989, -732.6991163774148, -791.4864789953903, -753.3250083646394, -570.0660698103668, -755.2574804029624, -262.0641695575988, -265.72458899832145, -810.9479341855584, -538.5338268321736, -470.4649654515878, -734.5662532587572, -656.3258527718824, -552.4623750754655, -726.0287370230903, -672.8099897845533, -83.32489441400561, -765.0576880447753, -737.7713740622723, -634.9929403344498, -1137.4136814469177, -1338.7181291979964, -548.9379795003334, -1030.4780858510833, -983.2810762200562, -594.0060912371621, -959.1526264760809, -71.16220986754314, -856.3377622451571, -1053.410848434519, -1009.2547067046601, -151.82284081058532, -791.5548444118156, -460.36038288268855, -583.847630457859, -701.090917785262, -958.5981481990485, -715.5399170905836, -78.74485463170626, -622.7658354451889, -804.044350069826, -600.0327208654489, -671.8457924987375, -14.51495014795809, -1183.154584363858, -809.6648491631919, -977.4118490051536, -722.0750430741605, -1065.469102991352, -1010.2604565705633, -535.9229093310714, -1259.8077324683857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531480052413841, "mean_inference_ms": 1.6748402563094706, "mean_action_processing_ms": 0.2770384069976367, "mean_env_wait_ms": 3.500349507587763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011775732040405273, "StateBufferConnector_ms": 0.00792384147644043, "ViewRequirementAgentConnector_ms": 0.20260858535766602}, "num_episodes": 30, "episode_return_max": -14.51495014795809, "episode_return_min": -1383.9819395270342, "episode_return_mean": -688.5802005849246, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.1635325888339, "num_env_steps_trained_throughput_per_sec": 305.1635325888339, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12989.194, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12989.119, "sample_time_ms": 1170.767, "learn_time_ms": 11753.51, "learn_throughput": 340.324, "synch_weights_time_ms": 64.058}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00005", "date": "2024-08-04_05-59-54", "timestamp": 1722731394, "time_this_iter_s": 13.120166778564453, "time_total_s": 269.4374394416809, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0113760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.4374394416809, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.216666666666665, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.04515978395939, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.434793277581533, "policy_loss": -0.009590546776598785, "vf_loss": 6.453813892602921, "vf_explained_var": 0.8941562760621309, "kl": 0.014946158840029967, "entropy": 1.6155846672753493, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -14.51495014795809, "episode_reward_min": -1383.9819395270342, "episode_reward_mean": -701.731298413976, "episode_len_mean": 138.53, "episode_media": {}, "episodes_timesteps_total": 13853, "policy_reward_min": {"policy_0": -1383.9819395270342}, "policy_reward_max": {"policy_0": -14.51495014795809}, "policy_reward_mean": {"policy_0": -701.731298413976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.8922249494136, -557.3274659134921, -719.7363470327002, -660.2708856498232, -483.62811641740745, -1056.4291929341894, -655.1935307541056, -403.2871146255955, -994.2450431311606, -959.9835062193722, -673.2557505722215, -778.6549356266578, -594.0514576813264, -1103.3226293863086, -389.2251456480598, -926.3707033352498, -631.7286130267553, -212.56175124586028, -1032.663552930924, -93.19886356393232, -1383.9819395270342, -928.1349730912989, -732.6991163774148, -791.4864789953903, -753.3250083646394, -570.0660698103668, -755.2574804029624, -262.0641695575988, -265.72458899832145, -810.9479341855584, -538.5338268321736, -470.4649654515878, -734.5662532587572, -656.3258527718824, -552.4623750754655, -726.0287370230903, -672.8099897845533, -83.32489441400561, -765.0576880447753, -737.7713740622723, -634.9929403344498, -1137.4136814469177, -1338.7181291979964, -548.9379795003334, -1030.4780858510833, -983.2810762200562, -594.0060912371621, -959.1526264760809, -71.16220986754314, -856.3377622451571, -1053.410848434519, -1009.2547067046601, -151.82284081058532, -791.5548444118156, -460.36038288268855, -583.847630457859, -701.090917785262, -958.5981481990485, -715.5399170905836, -78.74485463170626, -622.7658354451889, -804.044350069826, -600.0327208654489, -671.8457924987375, -14.51495014795809, -1183.154584363858, -809.6648491631919, -977.4118490051536, -722.0750430741605, -1065.469102991352, -1010.2604565705633, -535.9229093310714, -1259.8077324683857, -610.7968833247886, -579.6473727786143, -1177.1308171321566, -520.9312380375503, -42.25110271707288, -354.0269467267271, -172.3511009219766, -636.428361939093, -1148.5014262320772, -958.84220377463, -616.313855485666, -673.3632629084982, -137.62073823381408, -408.71384120034634, -953.759282695681, -600.9297956230305, -909.6532244324735, -521.82476206441, -899.2952087479945, -73.74006652669634, -1096.427974634765, -819.3821615375361, -1202.0059877288231, -906.5204662068078, -588.4413502003869, -968.2903899174465, -863.2036232144378], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 88, 150, 69, 150, 150, 150, 150, 150, 150, 150, 85, 107, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 72, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 105, 150, 69, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-680.8922249494136, -557.3274659134921, -719.7363470327002, -660.2708856498232, -483.62811641740745, -1056.4291929341894, -655.1935307541056, -403.2871146255955, -994.2450431311606, -959.9835062193722, -673.2557505722215, -778.6549356266578, -594.0514576813264, -1103.3226293863086, -389.2251456480598, -926.3707033352498, -631.7286130267553, -212.56175124586028, -1032.663552930924, -93.19886356393232, -1383.9819395270342, -928.1349730912989, -732.6991163774148, -791.4864789953903, -753.3250083646394, -570.0660698103668, -755.2574804029624, -262.0641695575988, -265.72458899832145, -810.9479341855584, -538.5338268321736, -470.4649654515878, -734.5662532587572, -656.3258527718824, -552.4623750754655, -726.0287370230903, -672.8099897845533, -83.32489441400561, -765.0576880447753, -737.7713740622723, -634.9929403344498, -1137.4136814469177, -1338.7181291979964, -548.9379795003334, -1030.4780858510833, -983.2810762200562, -594.0060912371621, -959.1526264760809, -71.16220986754314, -856.3377622451571, -1053.410848434519, -1009.2547067046601, -151.82284081058532, -791.5548444118156, -460.36038288268855, -583.847630457859, -701.090917785262, -958.5981481990485, -715.5399170905836, -78.74485463170626, -622.7658354451889, -804.044350069826, -600.0327208654489, -671.8457924987375, -14.51495014795809, -1183.154584363858, -809.6648491631919, -977.4118490051536, -722.0750430741605, -1065.469102991352, -1010.2604565705633, -535.9229093310714, -1259.8077324683857, -610.7968833247886, -579.6473727786143, -1177.1308171321566, -520.9312380375503, -42.25110271707288, -354.0269467267271, -172.3511009219766, -636.428361939093, -1148.5014262320772, -958.84220377463, -616.313855485666, -673.3632629084982, -137.62073823381408, -408.71384120034634, -953.759282695681, -600.9297956230305, -909.6532244324735, -521.82476206441, -899.2952087479945, -73.74006652669634, -1096.427974634765, -819.3821615375361, -1202.0059877288231, -906.5204662068078, -588.4413502003869, -968.2903899174465, -863.2036232144378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536051784160121, "mean_inference_ms": 1.6749461474878158, "mean_action_processing_ms": 0.27712494310344415, "mean_env_wait_ms": 3.5028698454897507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011998414993286133, "StateBufferConnector_ms": 0.007938861846923828, "ViewRequirementAgentConnector_ms": 0.2039947509765625}, "num_episodes": 27, "episode_return_max": -14.51495014795809, "episode_return_min": -1383.9819395270342, "episode_return_mean": -701.731298413976, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.88940945551707, "num_env_steps_trained_throughput_per_sec": 304.88940945551707, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12963.936, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12963.859, "sample_time_ms": 1148.484, "learn_time_ms": 11751.356, "learn_throughput": 340.386, "synch_weights_time_ms": 63.247}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00005", "date": "2024-08-04_06-00-07", "timestamp": 1722731407, "time_this_iter_s": 13.132691621780396, "time_total_s": 282.5701310634613, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0112950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 282.5701310634613, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.14736842105263, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.44789305528005, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.778954414029916, "policy_loss": -0.011650582112391323, "vf_loss": 5.79851734439532, "vf_explained_var": 0.9175329092890024, "kl": 0.015452777138004152, "entropy": 1.4866099192450444, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -14.51495014795809, "episode_reward_min": -1506.7937309388756, "episode_reward_mean": -700.270903627023, "episode_len_mean": 137.27, "episode_media": {}, "episodes_timesteps_total": 13727, "policy_reward_min": {"policy_0": -1506.7937309388756}, "policy_reward_max": {"policy_0": -14.51495014795809}, "policy_reward_mean": {"policy_0": -700.270903627023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-265.72458899832145, -810.9479341855584, -538.5338268321736, -470.4649654515878, -734.5662532587572, -656.3258527718824, -552.4623750754655, -726.0287370230903, -672.8099897845533, -83.32489441400561, -765.0576880447753, -737.7713740622723, -634.9929403344498, -1137.4136814469177, -1338.7181291979964, -548.9379795003334, -1030.4780858510833, -983.2810762200562, -594.0060912371621, -959.1526264760809, -71.16220986754314, -856.3377622451571, -1053.410848434519, -1009.2547067046601, -151.82284081058532, -791.5548444118156, -460.36038288268855, -583.847630457859, -701.090917785262, -958.5981481990485, -715.5399170905836, -78.74485463170626, -622.7658354451889, -804.044350069826, -600.0327208654489, -671.8457924987375, -14.51495014795809, -1183.154584363858, -809.6648491631919, -977.4118490051536, -722.0750430741605, -1065.469102991352, -1010.2604565705633, -535.9229093310714, -1259.8077324683857, -610.7968833247886, -579.6473727786143, -1177.1308171321566, -520.9312380375503, -42.25110271707288, -354.0269467267271, -172.3511009219766, -636.428361939093, -1148.5014262320772, -958.84220377463, -616.313855485666, -673.3632629084982, -137.62073823381408, -408.71384120034634, -953.759282695681, -600.9297956230305, -909.6532244324735, -521.82476206441, -899.2952087479945, -73.74006652669634, -1096.427974634765, -819.3821615375361, -1202.0059877288231, -906.5204662068078, -588.4413502003869, -968.2903899174465, -863.2036232144378, -672.2891873189848, -1254.409286513603, -863.0236756491946, -115.66870201972206, -1317.2724930992983, -558.3529412955195, -675.6205297347525, -452.1098872344897, -529.6005749873113, -728.1776311626143, -612.343094639419, -573.8800277021295, -714.8798456661626, -193.7099459240468, -518.2872333419297, -631.0074533576528, -522.1213686049016, -640.4334679158179, -922.5462009056014, -931.5385562996994, -1506.7937309388756, -586.6692866587495, -874.8165091790904, -23.342023495648025, -31.145275316261394, -1089.0955438485576, -1374.1899404060084, -723.6781748599147], "episode_lengths": [107, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 72, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 105, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 51, 150, 150, 150], "policy_policy_0_reward": [-265.72458899832145, -810.9479341855584, -538.5338268321736, -470.4649654515878, -734.5662532587572, -656.3258527718824, -552.4623750754655, -726.0287370230903, -672.8099897845533, -83.32489441400561, -765.0576880447753, -737.7713740622723, -634.9929403344498, -1137.4136814469177, -1338.7181291979964, -548.9379795003334, -1030.4780858510833, -983.2810762200562, -594.0060912371621, -959.1526264760809, -71.16220986754314, -856.3377622451571, -1053.410848434519, -1009.2547067046601, -151.82284081058532, -791.5548444118156, -460.36038288268855, -583.847630457859, -701.090917785262, -958.5981481990485, -715.5399170905836, -78.74485463170626, -622.7658354451889, -804.044350069826, -600.0327208654489, -671.8457924987375, -14.51495014795809, -1183.154584363858, -809.6648491631919, -977.4118490051536, -722.0750430741605, -1065.469102991352, -1010.2604565705633, -535.9229093310714, -1259.8077324683857, -610.7968833247886, -579.6473727786143, -1177.1308171321566, -520.9312380375503, -42.25110271707288, -354.0269467267271, -172.3511009219766, -636.428361939093, -1148.5014262320772, -958.84220377463, -616.313855485666, -673.3632629084982, -137.62073823381408, -408.71384120034634, -953.759282695681, -600.9297956230305, -909.6532244324735, -521.82476206441, -899.2952087479945, -73.74006652669634, -1096.427974634765, -819.3821615375361, -1202.0059877288231, -906.5204662068078, -588.4413502003869, -968.2903899174465, -863.2036232144378, -672.2891873189848, -1254.409286513603, -863.0236756491946, -115.66870201972206, -1317.2724930992983, -558.3529412955195, -675.6205297347525, -452.1098872344897, -529.6005749873113, -728.1776311626143, -612.343094639419, -573.8800277021295, -714.8798456661626, -193.7099459240468, -518.2872333419297, -631.0074533576528, -522.1213686049016, -640.4334679158179, -922.5462009056014, -931.5385562996994, -1506.7937309388756, -586.6692866587495, -874.8165091790904, -23.342023495648025, -31.145275316261394, -1089.0955438485576, -1374.1899404060084, -723.6781748599147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537322712736364, "mean_inference_ms": 1.674693478402044, "mean_action_processing_ms": 0.2768911195037782, "mean_env_wait_ms": 3.5064174962105286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857271194458008, "StateBufferConnector_ms": 0.0079345703125, "ViewRequirementAgentConnector_ms": 0.20452404022216797}, "num_episodes": 28, "episode_return_max": -14.51495014795809, "episode_return_min": -1506.7937309388756, "episode_return_mean": -700.270903627023, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.79597865138885, "num_env_steps_trained_throughput_per_sec": 301.79597865138885, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12943.252, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12943.176, "sample_time_ms": 1149.419, "learn_time_ms": 11730.284, "learn_throughput": 340.998, "synch_weights_time_ms": 62.702}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00005", "date": "2024-08-04_06-00-21", "timestamp": 1722731421, "time_this_iter_s": 13.266637325286865, "time_total_s": 295.83676838874817, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5e710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.83676838874817, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.157894736842106, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.75430042942365, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.298521930972735, "policy_loss": -0.011627877509939329, "vf_loss": 6.316858225564162, "vf_explained_var": 0.9295127771173914, "kl": 0.017364924731858387, "entropy": 1.4522613594929377, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -14.51495014795809, "episode_reward_min": -1506.7937309388756, "episode_reward_mean": -683.7180338357119, "episode_len_mean": 136.53, "episode_media": {}, "episodes_timesteps_total": 13653, "policy_reward_min": {"policy_0": -1506.7937309388756}, "policy_reward_max": {"policy_0": -14.51495014795809}, "policy_reward_mean": {"policy_0": -683.7180338357119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-715.5399170905836, -78.74485463170626, -622.7658354451889, -804.044350069826, -600.0327208654489, -671.8457924987375, -14.51495014795809, -1183.154584363858, -809.6648491631919, -977.4118490051536, -722.0750430741605, -1065.469102991352, -1010.2604565705633, -535.9229093310714, -1259.8077324683857, -610.7968833247886, -579.6473727786143, -1177.1308171321566, -520.9312380375503, -42.25110271707288, -354.0269467267271, -172.3511009219766, -636.428361939093, -1148.5014262320772, -958.84220377463, -616.313855485666, -673.3632629084982, -137.62073823381408, -408.71384120034634, -953.759282695681, -600.9297956230305, -909.6532244324735, -521.82476206441, -899.2952087479945, -73.74006652669634, -1096.427974634765, -819.3821615375361, -1202.0059877288231, -906.5204662068078, -588.4413502003869, -968.2903899174465, -863.2036232144378, -672.2891873189848, -1254.409286513603, -863.0236756491946, -115.66870201972206, -1317.2724930992983, -558.3529412955195, -675.6205297347525, -452.1098872344897, -529.6005749873113, -728.1776311626143, -612.343094639419, -573.8800277021295, -714.8798456661626, -193.7099459240468, -518.2872333419297, -631.0074533576528, -522.1213686049016, -640.4334679158179, -922.5462009056014, -931.5385562996994, -1506.7937309388756, -586.6692866587495, -874.8165091790904, -23.342023495648025, -31.145275316261394, -1089.0955438485576, -1374.1899404060084, -723.6781748599147, -600.7436528292992, -445.5375061355257, -135.89591754127076, -501.81979682275954, -769.422020358845, -888.9970187364884, -969.4189737417443, -842.1068266930394, -1273.211099834456, -473.2885004105723, -558.6307283030642, -1142.3517069637057, -529.2953384839736, -644.3259432673711, -941.1084192951907, -551.3323928072255, -56.098543588136536, -113.0555402314948, -571.3381564253876, -794.6917744952447, -977.0434428753641, -406.0467050147003, -759.7490281092427, -251.02818530289252, -508.85058249332667, -229.23742219494142, -593.8963221437102, -500.1432321811977, -957.1078551009625, -1237.3797704534184], "episode_lengths": [150, 56, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 72, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 105, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 51, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 77, 150, 145, 150, 150, 150, 69, 150, 87, 150, 150, 150, 150], "policy_policy_0_reward": [-715.5399170905836, -78.74485463170626, -622.7658354451889, -804.044350069826, -600.0327208654489, -671.8457924987375, -14.51495014795809, -1183.154584363858, -809.6648491631919, -977.4118490051536, -722.0750430741605, -1065.469102991352, -1010.2604565705633, -535.9229093310714, -1259.8077324683857, -610.7968833247886, -579.6473727786143, -1177.1308171321566, -520.9312380375503, -42.25110271707288, -354.0269467267271, -172.3511009219766, -636.428361939093, -1148.5014262320772, -958.84220377463, -616.313855485666, -673.3632629084982, -137.62073823381408, -408.71384120034634, -953.759282695681, -600.9297956230305, -909.6532244324735, -521.82476206441, -899.2952087479945, -73.74006652669634, -1096.427974634765, -819.3821615375361, -1202.0059877288231, -906.5204662068078, -588.4413502003869, -968.2903899174465, -863.2036232144378, -672.2891873189848, -1254.409286513603, -863.0236756491946, -115.66870201972206, -1317.2724930992983, -558.3529412955195, -675.6205297347525, -452.1098872344897, -529.6005749873113, -728.1776311626143, -612.343094639419, -573.8800277021295, -714.8798456661626, -193.7099459240468, -518.2872333419297, -631.0074533576528, -522.1213686049016, -640.4334679158179, -922.5462009056014, -931.5385562996994, -1506.7937309388756, -586.6692866587495, -874.8165091790904, -23.342023495648025, -31.145275316261394, -1089.0955438485576, -1374.1899404060084, -723.6781748599147, -600.7436528292992, -445.5375061355257, -135.89591754127076, -501.81979682275954, -769.422020358845, -888.9970187364884, -969.4189737417443, -842.1068266930394, -1273.211099834456, -473.2885004105723, -558.6307283030642, -1142.3517069637057, -529.2953384839736, -644.3259432673711, -941.1084192951907, -551.3323928072255, -56.098543588136536, -113.0555402314948, -571.3381564253876, -794.6917744952447, -977.0434428753641, -406.0467050147003, -759.7490281092427, -251.02818530289252, -508.85058249332667, -229.23742219494142, -593.8963221437102, -500.1432321811977, -957.1078551009625, -1237.3797704534184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538139979838557, "mean_inference_ms": 1.6747396074695176, "mean_action_processing_ms": 0.27667431297024675, "mean_env_wait_ms": 3.507616922806498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012250423431396484, "StateBufferConnector_ms": 0.00803232192993164, "ViewRequirementAgentConnector_ms": 0.19916200637817383}, "num_episodes": 30, "episode_return_max": -14.51495014795809, "episode_return_min": -1506.7937309388756, "episode_return_mean": -683.7180338357119, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.5276438396442, "num_env_steps_trained_throughput_per_sec": 315.5276438396442, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12905.16, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12905.084, "sample_time_ms": 1152.725, "learn_time_ms": 11689.267, "learn_throughput": 342.194, "synch_weights_time_ms": 62.315}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00005", "date": "2024-08-04_06-00-33", "timestamp": 1722731433, "time_this_iter_s": 12.68910813331604, "time_total_s": 308.5258765220642, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0113760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.5258765220642, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.38888888888889, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.99122656782468, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.787500143547853, "policy_loss": -0.00933564445246399, "vf_loss": 6.804822914799055, "vf_explained_var": 0.9058525718127688, "kl": 0.015921785309789507, "entropy": 1.5151933930814265, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -23.342023495648025, "episode_reward_min": -1506.7937309388756, "episode_reward_mean": -689.0404840967385, "episode_len_mean": 137.79, "episode_media": {}, "episodes_timesteps_total": 13779, "policy_reward_min": {"policy_0": -1506.7937309388756}, "policy_reward_max": {"policy_0": -23.342023495648025}, "policy_reward_mean": {"policy_0": -689.0404840967385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-600.9297956230305, -909.6532244324735, -521.82476206441, -899.2952087479945, -73.74006652669634, -1096.427974634765, -819.3821615375361, -1202.0059877288231, -906.5204662068078, -588.4413502003869, -968.2903899174465, -863.2036232144378, -672.2891873189848, -1254.409286513603, -863.0236756491946, -115.66870201972206, -1317.2724930992983, -558.3529412955195, -675.6205297347525, -452.1098872344897, -529.6005749873113, -728.1776311626143, -612.343094639419, -573.8800277021295, -714.8798456661626, -193.7099459240468, -518.2872333419297, -631.0074533576528, -522.1213686049016, -640.4334679158179, -922.5462009056014, -931.5385562996994, -1506.7937309388756, -586.6692866587495, -874.8165091790904, -23.342023495648025, -31.145275316261394, -1089.0955438485576, -1374.1899404060084, -723.6781748599147, -600.7436528292992, -445.5375061355257, -135.89591754127076, -501.81979682275954, -769.422020358845, -888.9970187364884, -969.4189737417443, -842.1068266930394, -1273.211099834456, -473.2885004105723, -558.6307283030642, -1142.3517069637057, -529.2953384839736, -644.3259432673711, -941.1084192951907, -551.3323928072255, -56.098543588136536, -113.0555402314948, -571.3381564253876, -794.6917744952447, -977.0434428753641, -406.0467050147003, -759.7490281092427, -251.02818530289252, -508.85058249332667, -229.23742219494142, -593.8963221437102, -500.1432321811977, -957.1078551009625, -1237.3797704534184, -689.4536737277308, -1228.6609286309215, -82.14077340819266, -1081.2980385991775, -1030.6420602359992, -73.16090568096351, -540.2090815587227, -739.778813696274, -111.95981562522473, -746.0949517393992, -1195.1159448773085, -635.1012318476096, -713.216791394234, -1052.687183784959, -416.21890991208363, -1118.6795713031408, -700.7180408705042, -760.4142073614242, -653.0011087525266, -1022.9248977613435, -603.9198114896649, -697.9557380287888, -768.1129045607155, -440.87273118157833, -509.9507771332449, -1095.79759078682, -643.6318545576968, -272.8094205693879, -407.9947537005172, -561.6558951523837], "episode_lengths": [150, 150, 105, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 51, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 77, 150, 145, 150, 150, 150, 69, 150, 87, 150, 150, 150, 150, 150, 150, 73, 150, 150, 64, 150, 150, 71, 150, 150, 126, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 127, 150], "policy_policy_0_reward": [-600.9297956230305, -909.6532244324735, -521.82476206441, -899.2952087479945, -73.74006652669634, -1096.427974634765, -819.3821615375361, -1202.0059877288231, -906.5204662068078, -588.4413502003869, -968.2903899174465, -863.2036232144378, -672.2891873189848, -1254.409286513603, -863.0236756491946, -115.66870201972206, -1317.2724930992983, -558.3529412955195, -675.6205297347525, -452.1098872344897, -529.6005749873113, -728.1776311626143, -612.343094639419, -573.8800277021295, -714.8798456661626, -193.7099459240468, -518.2872333419297, -631.0074533576528, -522.1213686049016, -640.4334679158179, -922.5462009056014, -931.5385562996994, -1506.7937309388756, -586.6692866587495, -874.8165091790904, -23.342023495648025, -31.145275316261394, -1089.0955438485576, -1374.1899404060084, -723.6781748599147, -600.7436528292992, -445.5375061355257, -135.89591754127076, -501.81979682275954, -769.422020358845, -888.9970187364884, -969.4189737417443, -842.1068266930394, -1273.211099834456, -473.2885004105723, -558.6307283030642, -1142.3517069637057, -529.2953384839736, -644.3259432673711, -941.1084192951907, -551.3323928072255, -56.098543588136536, -113.0555402314948, -571.3381564253876, -794.6917744952447, -977.0434428753641, -406.0467050147003, -759.7490281092427, -251.02818530289252, -508.85058249332667, -229.23742219494142, -593.8963221437102, -500.1432321811977, -957.1078551009625, -1237.3797704534184, -689.4536737277308, -1228.6609286309215, -82.14077340819266, -1081.2980385991775, -1030.6420602359992, -73.16090568096351, -540.2090815587227, -739.778813696274, -111.95981562522473, -746.0949517393992, -1195.1159448773085, -635.1012318476096, -713.216791394234, -1052.687183784959, -416.21890991208363, -1118.6795713031408, -700.7180408705042, -760.4142073614242, -653.0011087525266, -1022.9248977613435, -603.9198114896649, -697.9557380287888, -768.1129045607155, -440.87273118157833, -509.9507771332449, -1095.79759078682, -643.6318545576968, -272.8094205693879, -407.9947537005172, -561.6558951523837]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536845680575931, "mean_inference_ms": 1.6753055936858854, "mean_action_processing_ms": 0.2766201445728147, "mean_env_wait_ms": 3.508729428591246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01218104362487793, "StateBufferConnector_ms": 0.008105039596557617, "ViewRequirementAgentConnector_ms": 0.1973726749420166}, "num_episodes": 30, "episode_return_max": -23.342023495648025, "episode_return_min": -1506.7937309388756, "episode_return_mean": -689.0404840967385, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.4876508247078, "num_env_steps_trained_throughput_per_sec": 409.4876508247078, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12578.37, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12578.291, "sample_time_ms": 1155.243, "learn_time_ms": 11359.833, "learn_throughput": 352.118, "synch_weights_time_ms": 62.44}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00005", "date": "2024-08-04_06-00-43", "timestamp": 1722731443, "time_this_iter_s": 9.78069543838501, "time_total_s": 318.3065719604492, "pid": 575916, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0112b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.3065719604492, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 20.485714285714288, "ram_util_percent": 27.899999999999995}}
