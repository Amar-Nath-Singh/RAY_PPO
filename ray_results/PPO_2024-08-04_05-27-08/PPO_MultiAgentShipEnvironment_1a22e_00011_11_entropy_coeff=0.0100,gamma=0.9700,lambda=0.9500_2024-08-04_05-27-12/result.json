{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8134669960476458, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.73623299797376, "policy_loss": -0.007581390011667585, "vf_loss": 9.756106854478519, "vf_explained_var": 0.06338914719720681, "kl": 0.011302720007264119, "entropy": 1.455298345287641, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": 1.4386899615969864, "episode_reward_min": -1247.426575209483, "episode_reward_mean": -577.0407185154379, "episode_len_mean": 109.5, "episode_media": {}, "episodes_timesteps_total": 2628, "policy_reward_min": {"policy_0": -1247.426575209483}, "policy_reward_max": {"policy_0": 1.4386899615969864}, "policy_reward_mean": {"policy_0": -577.0407185154379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-556.5038092123012, -419.28149223059404, -308.9197784249224, -249.57343352860192, -634.1332844851747, -472.8077216716911, -706.6781927062289, -393.56088254047177, -215.25153333367373, -236.07676297758678, -159.14857279123925, -1047.194233309438, -379.2497893711739, -8.355489077257907, 1.4386899615969864, -1221.896672413314, -1134.2941205531251, -958.1206722396826, -288.749227109091, -1003.2925891040815, -253.23041099751336, -926.530699734719, -1247.426575209483, -1030.1399913107412], "episode_lengths": [118, 98, 77, 68, 124, 112, 150, 97, 83, 66, 86, 150, 89, 36, 32, 150, 150, 150, 96, 150, 96, 150, 150, 150], "policy_policy_0_reward": [-556.5038092123012, -419.28149223059404, -308.9197784249224, -249.57343352860192, -634.1332844851747, -472.8077216716911, -706.6781927062289, -393.56088254047177, -215.25153333367373, -236.07676297758678, -159.14857279123925, -1047.194233309438, -379.2497893711739, -8.355489077257907, 1.4386899615969864, -1221.896672413314, -1134.2941205531251, -958.1206722396826, -288.749227109091, -1003.2925891040815, -253.23041099751336, -926.530699734719, -1247.426575209483, -1030.1399913107412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5633903616559134, "mean_inference_ms": 1.6580630229611704, "mean_action_processing_ms": 0.27727042056200085, "mean_env_wait_ms": 3.4004901521637847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011328856150309244, "StateBufferConnector_ms": 0.008263190587361654, "ViewRequirementAgentConnector_ms": 0.18171767393747965}, "num_episodes": 24, "episode_return_max": 1.4386899615969864, "episode_return_min": -1247.426575209483, "episode_return_mean": -577.0407185154379, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6348090180911, "num_env_steps_trained_throughput_per_sec": 308.6348090180911, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12960.311, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12960.246, "sample_time_ms": 1148.267, "learn_time_ms": 11736.606, "learn_throughput": 340.814, "synch_weights_time_ms": 74.628}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00011", "date": "2024-08-04_06-29-20", "timestamp": 1722733160, "time_this_iter_s": 12.971028089523315, "time_total_s": 12.971028089523315, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1ac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.971028089523315, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.326315789473682, "ram_util_percent": 27.894736842105257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0148084023656945, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.695511650045713, "policy_loss": -0.009219112142939896, "vf_loss": 9.716907030344009, "vf_explained_var": 0.015767848615845046, "kl": 0.012807270699462, "entropy": 1.4737737358858187, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 1.4386899615969864, "episode_reward_min": -1317.0150319395566, "episode_reward_mean": -678.9694002518881, "episode_len_mean": 122.15686274509804, "episode_media": {}, "episodes_timesteps_total": 6230, "policy_reward_min": {"policy_0": -1317.0150319395566}, "policy_reward_max": {"policy_0": 1.4386899615969864}, "policy_reward_mean": {"policy_0": -678.9694002518881}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-556.5038092123012, -419.28149223059404, -308.9197784249224, -249.57343352860192, -634.1332844851747, -472.8077216716911, -706.6781927062289, -393.56088254047177, -215.25153333367373, -236.07676297758678, -159.14857279123925, -1047.194233309438, -379.2497893711739, -8.355489077257907, 1.4386899615969864, -1221.896672413314, -1134.2941205531251, -958.1206722396826, -288.749227109091, -1003.2925891040815, -253.23041099751336, -926.530699734719, -1247.426575209483, -1030.1399913107412, -559.6897816813357, -599.7399250933759, -1080.7269635943553, -938.4550075141749, -691.9381063415336, -458.7867649714299, -946.2830830284166, -1142.1549659697043, -789.6949760395967, -376.29697150778145, -1122.0350701643454, -122.05488371058773, -425.32255799847627, -342.1509328990884, -1219.3545292898134, -1317.0150319395566, -970.6630378746037, -776.8194878353474, -875.3524542152823, -805.9025456058932, -1195.5488999966872, -857.83312379263, -34.43364528220865, -836.0028261925191, -344.5816835584635, -1045.8006929079843, -903.8242194705946], "episode_lengths": [118, 98, 77, 68, 124, 112, 150, 97, 83, 66, 86, 150, 89, 36, 32, 150, 150, 150, 96, 150, 96, 150, 150, 150, 150, 119, 150, 150, 143, 109, 150, 150, 150, 99, 150, 78, 117, 86, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 113, 150, 150], "policy_policy_0_reward": [-556.5038092123012, -419.28149223059404, -308.9197784249224, -249.57343352860192, -634.1332844851747, -472.8077216716911, -706.6781927062289, -393.56088254047177, -215.25153333367373, -236.07676297758678, -159.14857279123925, -1047.194233309438, -379.2497893711739, -8.355489077257907, 1.4386899615969864, -1221.896672413314, -1134.2941205531251, -958.1206722396826, -288.749227109091, -1003.2925891040815, -253.23041099751336, -926.530699734719, -1247.426575209483, -1030.1399913107412, -559.6897816813357, -599.7399250933759, -1080.7269635943553, -938.4550075141749, -691.9381063415336, -458.7867649714299, -946.2830830284166, -1142.1549659697043, -789.6949760395967, -376.29697150778145, -1122.0350701643454, -122.05488371058773, -425.32255799847627, -342.1509328990884, -1219.3545292898134, -1317.0150319395566, -970.6630378746037, -776.8194878353474, -875.3524542152823, -805.9025456058932, -1195.5488999966872, -857.83312379263, -34.43364528220865, -836.0028261925191, -344.5816835584635, -1045.8006929079843, -903.8242194705946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5648778412749543, "mean_inference_ms": 1.6695405412459703, "mean_action_processing_ms": 0.2784881203679718, "mean_env_wait_ms": 3.43209011435493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013060195773255592, "StateBufferConnector_ms": 0.008570446687586167, "ViewRequirementAgentConnector_ms": 0.18787430781944126}, "num_episodes": 27, "episode_return_max": 1.4386899615969864, "episode_return_min": -1317.0150319395566, "episode_return_mean": -678.9694002518881, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.55054513946124, "num_env_steps_trained_throughput_per_sec": 301.55054513946124, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13112.55, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13112.48, "sample_time_ms": 1193.256, "learn_time_ms": 11853.763, "learn_throughput": 337.446, "synch_weights_time_ms": 64.728}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00011", "date": "2024-08-04_06-29-34", "timestamp": 1722733174, "time_this_iter_s": 13.277583360671997, "time_total_s": 26.248611450195312, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f189d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.248611450195312, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.226315789473684, "ram_util_percent": 27.95263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.767049499383817, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.440566273530324, "policy_loss": -0.007861072182519517, "vf_loss": 9.461063607533772, "vf_explained_var": 0.08722520644466082, "kl": 0.011676625414596253, "entropy": 1.49715635056297, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 1.4386899615969864, "episode_reward_min": -1351.5258247202792, "episode_reward_mean": -656.9810770768617, "episode_len_mean": 120.79545454545455, "episode_media": {}, "episodes_timesteps_total": 10630, "policy_reward_min": {"policy_0": -1351.5258247202792}, "policy_reward_max": {"policy_0": 1.4386899615969864}, "policy_reward_mean": {"policy_0": -656.9810770768617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-556.5038092123012, -419.28149223059404, -308.9197784249224, -249.57343352860192, -634.1332844851747, -472.8077216716911, -706.6781927062289, -393.56088254047177, -215.25153333367373, -236.07676297758678, -159.14857279123925, -1047.194233309438, -379.2497893711739, -8.355489077257907, 1.4386899615969864, -1221.896672413314, -1134.2941205531251, -958.1206722396826, -288.749227109091, -1003.2925891040815, -253.23041099751336, -926.530699734719, -1247.426575209483, -1030.1399913107412, -559.6897816813357, -599.7399250933759, -1080.7269635943553, -938.4550075141749, -691.9381063415336, -458.7867649714299, -946.2830830284166, -1142.1549659697043, -789.6949760395967, -376.29697150778145, -1122.0350701643454, -122.05488371058773, -425.32255799847627, -342.1509328990884, -1219.3545292898134, -1317.0150319395566, -970.6630378746037, -776.8194878353474, -875.3524542152823, -805.9025456058932, -1195.5488999966872, -857.83312379263, -34.43364528220865, -836.0028261925191, -344.5816835584635, -1045.8006929079843, -903.8242194705946, -591.7446189436657, -544.6045751431155, -778.1594321571172, -925.6197790426061, -945.7179806485108, -871.0192476924128, -790.1232399767157, -809.5606083685354, -83.98449898961803, -112.48362894552932, -1294.5214738568188, -1283.2305025052449, -413.67806387352454, -505.7067575812343, -108.20423061993446, -1215.363692937639, -1107.952481562145, -139.52114848379907, -965.1066375275917, -1151.8409770377607, -1351.5258247202792, -827.3101448189342, -159.23315892877895, -19.064700381231273, -128.19235626827646, -1067.6945302155561, -95.28590361079705, -840.7670990029693, -132.56582684743327, -482.10707510073064, -863.797116655367, -956.1152969987978, -201.30832775378556, -436.80886297898377, -80.070546104804, -96.25365682042495, -810.6513668168625], "episode_lengths": [118, 98, 77, 68, 124, 112, 150, 97, 83, 66, 86, 150, 89, 36, 32, 150, 150, 150, 96, 150, 96, 150, 150, 150, 150, 119, 150, 150, 143, 109, 150, 150, 150, 99, 150, 78, 117, 86, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 113, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 58, 57, 150, 150, 119, 149, 61, 150, 150, 67, 150, 150, 150, 150, 73, 43, 59, 150, 66, 150, 69, 126, 148, 150, 83, 96, 68, 62, 150], "policy_policy_0_reward": [-556.5038092123012, -419.28149223059404, -308.9197784249224, -249.57343352860192, -634.1332844851747, -472.8077216716911, -706.6781927062289, -393.56088254047177, -215.25153333367373, -236.07676297758678, -159.14857279123925, -1047.194233309438, -379.2497893711739, -8.355489077257907, 1.4386899615969864, -1221.896672413314, -1134.2941205531251, -958.1206722396826, -288.749227109091, -1003.2925891040815, -253.23041099751336, -926.530699734719, -1247.426575209483, -1030.1399913107412, -559.6897816813357, -599.7399250933759, -1080.7269635943553, -938.4550075141749, -691.9381063415336, -458.7867649714299, -946.2830830284166, -1142.1549659697043, -789.6949760395967, -376.29697150778145, -1122.0350701643454, -122.05488371058773, -425.32255799847627, -342.1509328990884, -1219.3545292898134, -1317.0150319395566, -970.6630378746037, -776.8194878353474, -875.3524542152823, -805.9025456058932, -1195.5488999966872, -857.83312379263, -34.43364528220865, -836.0028261925191, -344.5816835584635, -1045.8006929079843, -903.8242194705946, -591.7446189436657, -544.6045751431155, -778.1594321571172, -925.6197790426061, -945.7179806485108, -871.0192476924128, -790.1232399767157, -809.5606083685354, -83.98449898961803, -112.48362894552932, -1294.5214738568188, -1283.2305025052449, -413.67806387352454, -505.7067575812343, -108.20423061993446, -1215.363692937639, -1107.952481562145, -139.52114848379907, -965.1066375275917, -1151.8409770377607, -1351.5258247202792, -827.3101448189342, -159.23315892877895, -19.064700381231273, -128.19235626827646, -1067.6945302155561, -95.28590361079705, -840.7670990029693, -132.56582684743327, -482.10707510073064, -863.797116655367, -956.1152969987978, -201.30832775378556, -436.80886297898377, -80.070546104804, -96.25365682042495, -810.6513668168625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5664097411365578, "mean_inference_ms": 1.6745509887461105, "mean_action_processing_ms": 0.2790295716777741, "mean_env_wait_ms": 3.4508696941167347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012738054448908026, "StateBufferConnector_ms": 0.008677894418889826, "ViewRequirementAgentConnector_ms": 0.19143711436878552}, "num_episodes": 37, "episode_return_max": 1.4386899615969864, "episode_return_min": -1351.5258247202792, "episode_return_mean": -656.9810770768617, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.4617747873146, "num_env_steps_trained_throughput_per_sec": 304.4617747873146, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13121.018, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13120.938, "sample_time_ms": 1171.902, "learn_time_ms": 11884.351, "learn_throughput": 336.577, "synch_weights_time_ms": 63.955}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00011", "date": "2024-08-04_06-29-47", "timestamp": 1722733187, "time_this_iter_s": 13.151058673858643, "time_total_s": 39.399670124053955, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f49120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.399670124053955, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.18421052631579, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.088786915782839, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.528181191285451, "policy_loss": -0.010100282628748876, "vf_loss": 9.55068790813287, "vf_explained_var": 0.09544349325199922, "kl": 0.014880543993937564, "entropy": 1.5382510244846344, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -19.064700381231273, "episode_reward_min": -1412.1368086641833, "episode_reward_mean": -723.1541319423563, "episode_len_mean": 126.88, "episode_media": {}, "episodes_timesteps_total": 12688, "policy_reward_min": {"policy_0": -1412.1368086641833}, "policy_reward_max": {"policy_0": -19.064700381231273}, "policy_reward_mean": {"policy_0": -723.1541319423563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-288.749227109091, -1003.2925891040815, -253.23041099751336, -926.530699734719, -1247.426575209483, -1030.1399913107412, -559.6897816813357, -599.7399250933759, -1080.7269635943553, -938.4550075141749, -691.9381063415336, -458.7867649714299, -946.2830830284166, -1142.1549659697043, -789.6949760395967, -376.29697150778145, -1122.0350701643454, -122.05488371058773, -425.32255799847627, -342.1509328990884, -1219.3545292898134, -1317.0150319395566, -970.6630378746037, -776.8194878353474, -875.3524542152823, -805.9025456058932, -1195.5488999966872, -857.83312379263, -34.43364528220865, -836.0028261925191, -344.5816835584635, -1045.8006929079843, -903.8242194705946, -591.7446189436657, -544.6045751431155, -778.1594321571172, -925.6197790426061, -945.7179806485108, -871.0192476924128, -790.1232399767157, -809.5606083685354, -83.98449898961803, -112.48362894552932, -1294.5214738568188, -1283.2305025052449, -413.67806387352454, -505.7067575812343, -108.20423061993446, -1215.363692937639, -1107.952481562145, -139.52114848379907, -965.1066375275917, -1151.8409770377607, -1351.5258247202792, -827.3101448189342, -159.23315892877895, -19.064700381231273, -128.19235626827646, -1067.6945302155561, -95.28590361079705, -840.7670990029693, -132.56582684743327, -482.10707510073064, -863.797116655367, -956.1152969987978, -201.30832775378556, -436.80886297898377, -80.070546104804, -96.25365682042495, -810.6513668168625, -953.5603722735177, -165.480993337582, -1332.8296116893011, -1227.8009470801799, -235.80824722388388, -147.3525864677716, -996.9257086722649, -471.8328094457383, -38.834225874821115, -597.9298539511362, -62.39533302635722, -130.52223785618577, -808.0795043169031, -1081.0452725096045, -1197.4524200810079, -973.970327298977, -977.1417230773224, -897.3723725331562, -375.66258246953015, -1051.6888854305244, -1122.7076429954823, -954.3699725948969, -991.3293312175507, -1412.1368086641833, -929.6682127018645, -459.3705646455392, -1181.7071838527102, -1046.0426962405834, -1175.028500575741, -604.6392342723765], "episode_lengths": [96, 150, 96, 150, 150, 150, 150, 119, 150, 150, 143, 109, 150, 150, 150, 99, 150, 78, 117, 86, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 113, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 58, 57, 150, 150, 119, 149, 61, 150, 150, 67, 150, 150, 150, 150, 73, 43, 59, 150, 66, 150, 69, 126, 148, 150, 83, 96, 68, 62, 150, 150, 62, 150, 150, 73, 78, 150, 150, 48, 150, 42, 55, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150], "policy_policy_0_reward": [-288.749227109091, -1003.2925891040815, -253.23041099751336, -926.530699734719, -1247.426575209483, -1030.1399913107412, -559.6897816813357, -599.7399250933759, -1080.7269635943553, -938.4550075141749, -691.9381063415336, -458.7867649714299, -946.2830830284166, -1142.1549659697043, -789.6949760395967, -376.29697150778145, -1122.0350701643454, -122.05488371058773, -425.32255799847627, -342.1509328990884, -1219.3545292898134, -1317.0150319395566, -970.6630378746037, -776.8194878353474, -875.3524542152823, -805.9025456058932, -1195.5488999966872, -857.83312379263, -34.43364528220865, -836.0028261925191, -344.5816835584635, -1045.8006929079843, -903.8242194705946, -591.7446189436657, -544.6045751431155, -778.1594321571172, -925.6197790426061, -945.7179806485108, -871.0192476924128, -790.1232399767157, -809.5606083685354, -83.98449898961803, -112.48362894552932, -1294.5214738568188, -1283.2305025052449, -413.67806387352454, -505.7067575812343, -108.20423061993446, -1215.363692937639, -1107.952481562145, -139.52114848379907, -965.1066375275917, -1151.8409770377607, -1351.5258247202792, -827.3101448189342, -159.23315892877895, -19.064700381231273, -128.19235626827646, -1067.6945302155561, -95.28590361079705, -840.7670990029693, -132.56582684743327, -482.10707510073064, -863.797116655367, -956.1152969987978, -201.30832775378556, -436.80886297898377, -80.070546104804, -96.25365682042495, -810.6513668168625, -953.5603722735177, -165.480993337582, -1332.8296116893011, -1227.8009470801799, -235.80824722388388, -147.3525864677716, -996.9257086722649, -471.8328094457383, -38.834225874821115, -597.9298539511362, -62.39533302635722, -130.52223785618577, -808.0795043169031, -1081.0452725096045, -1197.4524200810079, -973.970327298977, -977.1417230773224, -897.3723725331562, -375.66258246953015, -1051.6888854305244, -1122.7076429954823, -954.3699725948969, -991.3293312175507, -1412.1368086641833, -929.6682127018645, -459.3705646455392, -1181.7071838527102, -1046.0426962405834, -1175.028500575741, -604.6392342723765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5663021217145721, "mean_inference_ms": 1.678974319839412, "mean_action_processing_ms": 0.2793178902637012, "mean_env_wait_ms": 3.4628651161417965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013211488723754883, "StateBufferConnector_ms": 0.008856534957885742, "ViewRequirementAgentConnector_ms": 0.19231772422790527}, "num_episodes": 30, "episode_return_max": -19.064700381231273, "episode_return_min": -1412.1368086641833, "episode_return_mean": -723.1541319423563, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.8748570146438, "num_env_steps_trained_throughput_per_sec": 309.8748570146438, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13067.877, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13067.797, "sample_time_ms": 1163.255, "learn_time_ms": 11836.552, "learn_throughput": 337.936, "synch_weights_time_ms": 67.243}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00011", "date": "2024-08-04_06-30-00", "timestamp": 1722733200, "time_this_iter_s": 12.921523094177246, "time_total_s": 52.3211932182312, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1a050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.3211932182312, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.377777777777776, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8902546855310598, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.506244353453319, "policy_loss": -0.007832597622958322, "vf_loss": 9.526463866233826, "vf_explained_var": 0.15575998419274886, "kl": 0.013076964581280966, "entropy": 1.5002297752847273, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -17.273963780471725, "episode_reward_min": -1412.1368086641833, "episode_reward_mean": -724.647163675763, "episode_len_mean": 125.69, "episode_media": {}, "episodes_timesteps_total": 12569, "policy_reward_min": {"policy_0": -1412.1368086641833}, "policy_reward_max": {"policy_0": -17.273963780471725}, "policy_reward_mean": {"policy_0": -724.647163675763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-903.8242194705946, -591.7446189436657, -544.6045751431155, -778.1594321571172, -925.6197790426061, -945.7179806485108, -871.0192476924128, -790.1232399767157, -809.5606083685354, -83.98449898961803, -112.48362894552932, -1294.5214738568188, -1283.2305025052449, -413.67806387352454, -505.7067575812343, -108.20423061993446, -1215.363692937639, -1107.952481562145, -139.52114848379907, -965.1066375275917, -1151.8409770377607, -1351.5258247202792, -827.3101448189342, -159.23315892877895, -19.064700381231273, -128.19235626827646, -1067.6945302155561, -95.28590361079705, -840.7670990029693, -132.56582684743327, -482.10707510073064, -863.797116655367, -956.1152969987978, -201.30832775378556, -436.80886297898377, -80.070546104804, -96.25365682042495, -810.6513668168625, -953.5603722735177, -165.480993337582, -1332.8296116893011, -1227.8009470801799, -235.80824722388388, -147.3525864677716, -996.9257086722649, -471.8328094457383, -38.834225874821115, -597.9298539511362, -62.39533302635722, -130.52223785618577, -808.0795043169031, -1081.0452725096045, -1197.4524200810079, -973.970327298977, -977.1417230773224, -897.3723725331562, -375.66258246953015, -1051.6888854305244, -1122.7076429954823, -954.3699725948969, -991.3293312175507, -1412.1368086641833, -929.6682127018645, -459.3705646455392, -1181.7071838527102, -1046.0426962405834, -1175.028500575741, -604.6392342723765, -481.3194385297402, -82.17788859332771, -1003.0724036977033, -1203.9863987799806, -160.06957717926466, -449.8200876458902, -484.2279358756523, -1266.3335519626462, -551.4546506929888, -867.015732271799, -960.2840291141173, -778.9419756428671, -695.339971510001, -745.5007693473636, -1344.0274547097456, -1154.2858530266658, -1063.0792069050667, -56.3683614727824, -364.4348791300047, -962.0592191238984, -118.82818588577953, -953.8239890016479, -1339.2524126800479, -432.32838766579226, -1252.4572909452734, -936.7337457461434, -17.273963780471725, -1203.3449602304845, -1174.760688374401, -1007.0319189170883, -755.519000215739, -908.1566871571239], "episode_lengths": [150, 150, 150, 146, 150, 150, 150, 150, 150, 58, 57, 150, 150, 119, 149, 61, 150, 150, 67, 150, 150, 150, 150, 73, 43, 59, 150, 66, 150, 69, 126, 148, 150, 83, 96, 68, 62, 150, 150, 62, 150, 150, 73, 78, 150, 150, 48, 150, 42, 55, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 57, 150, 150, 79, 105, 106, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 41, 116, 150, 47, 150, 150, 150, 150, 150, 35, 150, 150, 150, 130, 150], "policy_policy_0_reward": [-903.8242194705946, -591.7446189436657, -544.6045751431155, -778.1594321571172, -925.6197790426061, -945.7179806485108, -871.0192476924128, -790.1232399767157, -809.5606083685354, -83.98449898961803, -112.48362894552932, -1294.5214738568188, -1283.2305025052449, -413.67806387352454, -505.7067575812343, -108.20423061993446, -1215.363692937639, -1107.952481562145, -139.52114848379907, -965.1066375275917, -1151.8409770377607, -1351.5258247202792, -827.3101448189342, -159.23315892877895, -19.064700381231273, -128.19235626827646, -1067.6945302155561, -95.28590361079705, -840.7670990029693, -132.56582684743327, -482.10707510073064, -863.797116655367, -956.1152969987978, -201.30832775378556, -436.80886297898377, -80.070546104804, -96.25365682042495, -810.6513668168625, -953.5603722735177, -165.480993337582, -1332.8296116893011, -1227.8009470801799, -235.80824722388388, -147.3525864677716, -996.9257086722649, -471.8328094457383, -38.834225874821115, -597.9298539511362, -62.39533302635722, -130.52223785618577, -808.0795043169031, -1081.0452725096045, -1197.4524200810079, -973.970327298977, -977.1417230773224, -897.3723725331562, -375.66258246953015, -1051.6888854305244, -1122.7076429954823, -954.3699725948969, -991.3293312175507, -1412.1368086641833, -929.6682127018645, -459.3705646455392, -1181.7071838527102, -1046.0426962405834, -1175.028500575741, -604.6392342723765, -481.3194385297402, -82.17788859332771, -1003.0724036977033, -1203.9863987799806, -160.06957717926466, -449.8200876458902, -484.2279358756523, -1266.3335519626462, -551.4546506929888, -867.015732271799, -960.2840291141173, -778.9419756428671, -695.339971510001, -745.5007693473636, -1344.0274547097456, -1154.2858530266658, -1063.0792069050667, -56.3683614727824, -364.4348791300047, -962.0592191238984, -118.82818588577953, -953.8239890016479, -1339.2524126800479, -432.32838766579226, -1252.4572909452734, -936.7337457461434, -17.273963780471725, -1203.3449602304845, -1174.760688374401, -1007.0319189170883, -755.519000215739, -908.1566871571239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5662703928359814, "mean_inference_ms": 1.6854824971320814, "mean_action_processing_ms": 0.2803971005550029, "mean_env_wait_ms": 3.4826416336595347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012988805770874023, "StateBufferConnector_ms": 0.008883953094482422, "ViewRequirementAgentConnector_ms": 0.19256234169006348}, "num_episodes": 32, "episode_return_max": -17.273963780471725, "episode_return_min": -1412.1368086641833, "episode_return_mean": -724.647163675763, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.76119986047183, "num_env_steps_trained_throughput_per_sec": 336.76119986047183, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12829.874, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12829.798, "sample_time_ms": 1166.048, "learn_time_ms": 11597.383, "learn_throughput": 344.905, "synch_weights_time_ms": 65.624}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00011", "date": "2024-08-04_06-30-12", "timestamp": 1722733212, "time_this_iter_s": 11.889912843704224, "time_total_s": 64.21110606193542, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f189d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.21110606193542, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.38823529411765, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7713442706813414, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.661065496007602, "policy_loss": -0.011423332233971451, "vf_loss": 9.68437699576219, "vf_explained_var": 0.11113684674104055, "kl": 0.017140734801826818, "entropy": 1.531632810086012, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -17.273963780471725, "episode_reward_min": -1443.17377933023, "episode_reward_mean": -740.6555248752405, "episode_len_mean": 126.39, "episode_media": {}, "episodes_timesteps_total": 12639, "policy_reward_min": {"policy_0": -1443.17377933023}, "policy_reward_max": {"policy_0": -17.273963780471725}, "policy_reward_mean": {"policy_0": -740.6555248752405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-132.56582684743327, -482.10707510073064, -863.797116655367, -956.1152969987978, -201.30832775378556, -436.80886297898377, -80.070546104804, -96.25365682042495, -810.6513668168625, -953.5603722735177, -165.480993337582, -1332.8296116893011, -1227.8009470801799, -235.80824722388388, -147.3525864677716, -996.9257086722649, -471.8328094457383, -38.834225874821115, -597.9298539511362, -62.39533302635722, -130.52223785618577, -808.0795043169031, -1081.0452725096045, -1197.4524200810079, -973.970327298977, -977.1417230773224, -897.3723725331562, -375.66258246953015, -1051.6888854305244, -1122.7076429954823, -954.3699725948969, -991.3293312175507, -1412.1368086641833, -929.6682127018645, -459.3705646455392, -1181.7071838527102, -1046.0426962405834, -1175.028500575741, -604.6392342723765, -481.3194385297402, -82.17788859332771, -1003.0724036977033, -1203.9863987799806, -160.06957717926466, -449.8200876458902, -484.2279358756523, -1266.3335519626462, -551.4546506929888, -867.015732271799, -960.2840291141173, -778.9419756428671, -695.339971510001, -745.5007693473636, -1344.0274547097456, -1154.2858530266658, -1063.0792069050667, -56.3683614727824, -364.4348791300047, -962.0592191238984, -118.82818588577953, -953.8239890016479, -1339.2524126800479, -432.32838766579226, -1252.4572909452734, -936.7337457461434, -17.273963780471725, -1203.3449602304845, -1174.760688374401, -1007.0319189170883, -755.519000215739, -908.1566871571239, -629.4330288655977, -327.7140355114095, -906.66895823189, -763.1205919989242, -362.29812549398224, -330.2861128013703, -926.4597090999453, -900.5642148858478, -93.57305872089424, -294.6786385980115, -966.8133056074489, -47.57530957908872, -1443.17377933023, -1014.4909495527863, -952.5684119209246, -1129.1833341135418, -713.6451503661046, -903.1014258050857, -575.1753484253304, -321.18088875489093, -979.172218893875, -959.1316564241948, -976.1333099210236, -227.21379774289227, -161.3705944920274, -1222.1621439505343, -1031.7615247510923, -1103.987236422449, -1369.2407729972565], "episode_lengths": [69, 126, 148, 150, 83, 96, 68, 62, 150, 150, 62, 150, 150, 73, 78, 150, 150, 48, 150, 42, 55, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 57, 150, 150, 79, 105, 106, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 41, 116, 150, 47, 150, 150, 150, 150, 150, 35, 150, 150, 150, 130, 150, 150, 91, 150, 150, 114, 85, 150, 150, 49, 84, 150, 44, 150, 150, 150, 150, 136, 150, 139, 82, 150, 150, 150, 73, 71, 150, 150, 150, 150], "policy_policy_0_reward": [-132.56582684743327, -482.10707510073064, -863.797116655367, -956.1152969987978, -201.30832775378556, -436.80886297898377, -80.070546104804, -96.25365682042495, -810.6513668168625, -953.5603722735177, -165.480993337582, -1332.8296116893011, -1227.8009470801799, -235.80824722388388, -147.3525864677716, -996.9257086722649, -471.8328094457383, -38.834225874821115, -597.9298539511362, -62.39533302635722, -130.52223785618577, -808.0795043169031, -1081.0452725096045, -1197.4524200810079, -973.970327298977, -977.1417230773224, -897.3723725331562, -375.66258246953015, -1051.6888854305244, -1122.7076429954823, -954.3699725948969, -991.3293312175507, -1412.1368086641833, -929.6682127018645, -459.3705646455392, -1181.7071838527102, -1046.0426962405834, -1175.028500575741, -604.6392342723765, -481.3194385297402, -82.17788859332771, -1003.0724036977033, -1203.9863987799806, -160.06957717926466, -449.8200876458902, -484.2279358756523, -1266.3335519626462, -551.4546506929888, -867.015732271799, -960.2840291141173, -778.9419756428671, -695.339971510001, -745.5007693473636, -1344.0274547097456, -1154.2858530266658, -1063.0792069050667, -56.3683614727824, -364.4348791300047, -962.0592191238984, -118.82818588577953, -953.8239890016479, -1339.2524126800479, -432.32838766579226, -1252.4572909452734, -936.7337457461434, -17.273963780471725, -1203.3449602304845, -1174.760688374401, -1007.0319189170883, -755.519000215739, -908.1566871571239, -629.4330288655977, -327.7140355114095, -906.66895823189, -763.1205919989242, -362.29812549398224, -330.2861128013703, -926.4597090999453, -900.5642148858478, -93.57305872089424, -294.6786385980115, -966.8133056074489, -47.57530957908872, -1443.17377933023, -1014.4909495527863, -952.5684119209246, -1129.1833341135418, -713.6451503661046, -903.1014258050857, -575.1753484253304, -321.18088875489093, -979.172218893875, -959.1316564241948, -976.1333099210236, -227.21379774289227, -161.3705944920274, -1222.1621439505343, -1031.7615247510923, -1103.987236422449, -1369.2407729972565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5646161225144745, "mean_inference_ms": 1.6861373996028397, "mean_action_processing_ms": 0.280581542181943, "mean_env_wait_ms": 3.483071281157396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013112068176269531, "StateBufferConnector_ms": 0.008896827697753906, "ViewRequirementAgentConnector_ms": 0.1904737949371338}, "num_episodes": 29, "episode_return_max": -17.273963780471725, "episode_return_min": -1443.17377933023, "episode_return_mean": -740.6555248752405, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.3882879603768, "num_env_steps_trained_throughput_per_sec": 320.3882879603768, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12772.372, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12772.298, "sample_time_ms": 1159.303, "learn_time_ms": 11546.382, "learn_throughput": 346.429, "synch_weights_time_ms": 65.867}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00011", "date": "2024-08-04_06-30-24", "timestamp": 1722733224, "time_this_iter_s": 12.495682954788208, "time_total_s": 76.70678901672363, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb9f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.70678901672363, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.633333333333336, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4458442325393355, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.44375025232633, "policy_loss": -0.0152652624087447, "vf_loss": 9.472229119141897, "vf_explained_var": 0.23706647362560035, "kl": 0.0172354450931986, "entropy": 1.6660736283908288, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -17.273963780471725, "episode_reward_min": -1443.17377933023, "episode_reward_mean": -783.6758354960489, "episode_len_mean": 130.02, "episode_media": {}, "episodes_timesteps_total": 13002, "policy_reward_min": {"policy_0": -1443.17377933023}, "policy_reward_max": {"policy_0": -17.273963780471725}, "policy_reward_mean": {"policy_0": -783.6758354960489}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1122.7076429954823, -954.3699725948969, -991.3293312175507, -1412.1368086641833, -929.6682127018645, -459.3705646455392, -1181.7071838527102, -1046.0426962405834, -1175.028500575741, -604.6392342723765, -481.3194385297402, -82.17788859332771, -1003.0724036977033, -1203.9863987799806, -160.06957717926466, -449.8200876458902, -484.2279358756523, -1266.3335519626462, -551.4546506929888, -867.015732271799, -960.2840291141173, -778.9419756428671, -695.339971510001, -745.5007693473636, -1344.0274547097456, -1154.2858530266658, -1063.0792069050667, -56.3683614727824, -364.4348791300047, -962.0592191238984, -118.82818588577953, -953.8239890016479, -1339.2524126800479, -432.32838766579226, -1252.4572909452734, -936.7337457461434, -17.273963780471725, -1203.3449602304845, -1174.760688374401, -1007.0319189170883, -755.519000215739, -908.1566871571239, -629.4330288655977, -327.7140355114095, -906.66895823189, -763.1205919989242, -362.29812549398224, -330.2861128013703, -926.4597090999453, -900.5642148858478, -93.57305872089424, -294.6786385980115, -966.8133056074489, -47.57530957908872, -1443.17377933023, -1014.4909495527863, -952.5684119209246, -1129.1833341135418, -713.6451503661046, -903.1014258050857, -575.1753484253304, -321.18088875489093, -979.172218893875, -959.1316564241948, -976.1333099210236, -227.21379774289227, -161.3705944920274, -1222.1621439505343, -1031.7615247510923, -1103.987236422449, -1369.2407729972565, -216.84286886787606, -672.8760858260285, -1068.4834795945133, -466.52941806566446, -53.89302651875464, -989.481109158398, -1259.207174541237, -1075.8096047418553, -1077.8570851972643, -850.5385443346315, -275.1313485224854, -1155.9823179534844, -229.86515362121708, -165.64462995663686, -939.4561451560676, -1019.9487067193589, -1063.0124205700274, -1381.9478779273195, -748.956266978875, -343.77076813892467, -1125.7106361827473, -421.15194454674815, -84.61004023063991, -917.6804761833774, -1272.5048599117292, -678.7861069712534, -1026.8357296605097, -966.9379972427147, -535.943329453467], "episode_lengths": [150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 57, 150, 150, 79, 105, 106, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 41, 116, 150, 47, 150, 150, 150, 150, 150, 35, 150, 150, 150, 130, 150, 150, 91, 150, 150, 114, 85, 150, 150, 49, 84, 150, 44, 150, 150, 150, 150, 136, 150, 139, 82, 150, 150, 150, 73, 71, 150, 150, 150, 150, 84, 150, 150, 137, 45, 150, 150, 150, 150, 150, 74, 150, 75, 62, 150, 150, 150, 150, 138, 89, 150, 150, 67, 150, 150, 150, 150, 150, 115], "policy_policy_0_reward": [-1122.7076429954823, -954.3699725948969, -991.3293312175507, -1412.1368086641833, -929.6682127018645, -459.3705646455392, -1181.7071838527102, -1046.0426962405834, -1175.028500575741, -604.6392342723765, -481.3194385297402, -82.17788859332771, -1003.0724036977033, -1203.9863987799806, -160.06957717926466, -449.8200876458902, -484.2279358756523, -1266.3335519626462, -551.4546506929888, -867.015732271799, -960.2840291141173, -778.9419756428671, -695.339971510001, -745.5007693473636, -1344.0274547097456, -1154.2858530266658, -1063.0792069050667, -56.3683614727824, -364.4348791300047, -962.0592191238984, -118.82818588577953, -953.8239890016479, -1339.2524126800479, -432.32838766579226, -1252.4572909452734, -936.7337457461434, -17.273963780471725, -1203.3449602304845, -1174.760688374401, -1007.0319189170883, -755.519000215739, -908.1566871571239, -629.4330288655977, -327.7140355114095, -906.66895823189, -763.1205919989242, -362.29812549398224, -330.2861128013703, -926.4597090999453, -900.5642148858478, -93.57305872089424, -294.6786385980115, -966.8133056074489, -47.57530957908872, -1443.17377933023, -1014.4909495527863, -952.5684119209246, -1129.1833341135418, -713.6451503661046, -903.1014258050857, -575.1753484253304, -321.18088875489093, -979.172218893875, -959.1316564241948, -976.1333099210236, -227.21379774289227, -161.3705944920274, -1222.1621439505343, -1031.7615247510923, -1103.987236422449, -1369.2407729972565, -216.84286886787606, -672.8760858260285, -1068.4834795945133, -466.52941806566446, -53.89302651875464, -989.481109158398, -1259.207174541237, -1075.8096047418553, -1077.8570851972643, -850.5385443346315, -275.1313485224854, -1155.9823179534844, -229.86515362121708, -165.64462995663686, -939.4561451560676, -1019.9487067193589, -1063.0124205700274, -1381.9478779273195, -748.956266978875, -343.77076813892467, -1125.7106361827473, -421.15194454674815, -84.61004023063991, -917.6804761833774, -1272.5048599117292, -678.7861069712534, -1026.8357296605097, -966.9379972427147, -535.943329453467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5638818383759499, "mean_inference_ms": 1.690664648206382, "mean_action_processing_ms": 0.28165975522284986, "mean_env_wait_ms": 3.489888319806218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013002634048461914, "StateBufferConnector_ms": 0.008639812469482422, "ViewRequirementAgentConnector_ms": 0.19083905220031738}, "num_episodes": 29, "episode_return_max": -17.273963780471725, "episode_return_min": -1443.17377933023, "episode_return_mean": -783.6758354960489, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.9286941547586, "num_env_steps_trained_throughput_per_sec": 312.9286941547586, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12773.816, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12773.741, "sample_time_ms": 1161.626, "learn_time_ms": 11544.074, "learn_throughput": 346.498, "synch_weights_time_ms": 67.296}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00011", "date": "2024-08-04_06-30-37", "timestamp": 1722733237, "time_this_iter_s": 12.79640007019043, "time_total_s": 89.50318908691406, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0111ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.50318908691406, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.361111111111114, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.576964470868309, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.490375243624051, "policy_loss": -0.013624235918784203, "vf_loss": 9.517269499103229, "vf_explained_var": 0.3202121653904518, "kl": 0.018644062069796526, "entropy": 1.699883101756374, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -17.273963780471725, "episode_reward_min": -1488.7207274236812, "episode_reward_mean": -757.7981698165585, "episode_len_mean": 128.5, "episode_media": {}, "episodes_timesteps_total": 12850, "policy_reward_min": {"policy_0": -1488.7207274236812}, "policy_reward_max": {"policy_0": -17.273963780471725}, "policy_reward_mean": {"policy_0": -757.7981698165585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-936.7337457461434, -17.273963780471725, -1203.3449602304845, -1174.760688374401, -1007.0319189170883, -755.519000215739, -908.1566871571239, -629.4330288655977, -327.7140355114095, -906.66895823189, -763.1205919989242, -362.29812549398224, -330.2861128013703, -926.4597090999453, -900.5642148858478, -93.57305872089424, -294.6786385980115, -966.8133056074489, -47.57530957908872, -1443.17377933023, -1014.4909495527863, -952.5684119209246, -1129.1833341135418, -713.6451503661046, -903.1014258050857, -575.1753484253304, -321.18088875489093, -979.172218893875, -959.1316564241948, -976.1333099210236, -227.21379774289227, -161.3705944920274, -1222.1621439505343, -1031.7615247510923, -1103.987236422449, -1369.2407729972565, -216.84286886787606, -672.8760858260285, -1068.4834795945133, -466.52941806566446, -53.89302651875464, -989.481109158398, -1259.207174541237, -1075.8096047418553, -1077.8570851972643, -850.5385443346315, -275.1313485224854, -1155.9823179534844, -229.86515362121708, -165.64462995663686, -939.4561451560676, -1019.9487067193589, -1063.0124205700274, -1381.9478779273195, -748.956266978875, -343.77076813892467, -1125.7106361827473, -421.15194454674815, -84.61004023063991, -917.6804761833774, -1272.5048599117292, -678.7861069712534, -1026.8357296605097, -966.9379972427147, -535.943329453467, -1303.832800549624, -705.9473504959869, -1092.3819101960535, -182.3106434383627, -862.8124582079919, -664.369926407324, -793.2424364969881, -697.7451321727191, -150.22224250167847, -1033.7954586970006, -293.2289505777296, -917.6924157842776, -663.0918933485175, -387.4238922086868, -682.9817397831124, -301.40638317038645, -505.31794417418246, -1105.4041389157321, -95.99476607999239, -751.7312705696363, -1488.7207274236812, -1201.4995412719643, -132.0429607777433, -1169.5787538882585, -221.19953526059456, -148.4984718213165, -1099.708810527454, -746.5871948879201, -528.8005718446336, -1484.158860553281, -1306.3347733230262, -151.94191722309745, -1218.3027410277787, -760.9558812850235, -1210.458736310207], "episode_lengths": [150, 35, 150, 150, 150, 130, 150, 150, 91, 150, 150, 114, 85, 150, 150, 49, 84, 150, 44, 150, 150, 150, 150, 136, 150, 139, 82, 150, 150, 150, 73, 71, 150, 150, 150, 150, 84, 150, 150, 137, 45, 150, 150, 150, 150, 150, 74, 150, 75, 62, 150, 150, 150, 150, 138, 89, 150, 150, 67, 150, 150, 150, 150, 150, 115, 150, 150, 150, 61, 150, 150, 150, 150, 68, 150, 85, 150, 150, 120, 150, 102, 138, 150, 83, 150, 150, 150, 65, 150, 79, 64, 150, 150, 150, 150, 150, 79, 150, 137, 150], "policy_policy_0_reward": [-936.7337457461434, -17.273963780471725, -1203.3449602304845, -1174.760688374401, -1007.0319189170883, -755.519000215739, -908.1566871571239, -629.4330288655977, -327.7140355114095, -906.66895823189, -763.1205919989242, -362.29812549398224, -330.2861128013703, -926.4597090999453, -900.5642148858478, -93.57305872089424, -294.6786385980115, -966.8133056074489, -47.57530957908872, -1443.17377933023, -1014.4909495527863, -952.5684119209246, -1129.1833341135418, -713.6451503661046, -903.1014258050857, -575.1753484253304, -321.18088875489093, -979.172218893875, -959.1316564241948, -976.1333099210236, -227.21379774289227, -161.3705944920274, -1222.1621439505343, -1031.7615247510923, -1103.987236422449, -1369.2407729972565, -216.84286886787606, -672.8760858260285, -1068.4834795945133, -466.52941806566446, -53.89302651875464, -989.481109158398, -1259.207174541237, -1075.8096047418553, -1077.8570851972643, -850.5385443346315, -275.1313485224854, -1155.9823179534844, -229.86515362121708, -165.64462995663686, -939.4561451560676, -1019.9487067193589, -1063.0124205700274, -1381.9478779273195, -748.956266978875, -343.77076813892467, -1125.7106361827473, -421.15194454674815, -84.61004023063991, -917.6804761833774, -1272.5048599117292, -678.7861069712534, -1026.8357296605097, -966.9379972427147, -535.943329453467, -1303.832800549624, -705.9473504959869, -1092.3819101960535, -182.3106434383627, -862.8124582079919, -664.369926407324, -793.2424364969881, -697.7451321727191, -150.22224250167847, -1033.7954586970006, -293.2289505777296, -917.6924157842776, -663.0918933485175, -387.4238922086868, -682.9817397831124, -301.40638317038645, -505.31794417418246, -1105.4041389157321, -95.99476607999239, -751.7312705696363, -1488.7207274236812, -1201.4995412719643, -132.0429607777433, -1169.5787538882585, -221.19953526059456, -148.4984718213165, -1099.708810527454, -746.5871948879201, -528.8005718446336, -1484.158860553281, -1306.3347733230262, -151.94191722309745, -1218.3027410277787, -760.9558812850235, -1210.458736310207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5640231091282649, "mean_inference_ms": 1.689946764095887, "mean_action_processing_ms": 0.28111526111437574, "mean_env_wait_ms": 3.497164847873199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01285099983215332, "StateBufferConnector_ms": 0.008398056030273438, "ViewRequirementAgentConnector_ms": 0.19291043281555176}, "num_episodes": 35, "episode_return_max": -17.273963780471725, "episode_return_min": -1488.7207274236812, "episode_return_mean": -757.7981698165585, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8671412435778, "num_env_steps_trained_throughput_per_sec": 323.8671412435778, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12720.934, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12720.859, "sample_time_ms": 1157.421, "learn_time_ms": 11495.298, "learn_throughput": 347.968, "synch_weights_time_ms": 67.389}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00011", "date": "2024-08-04_06-30-49", "timestamp": 1722733249, "time_this_iter_s": 12.362720251083374, "time_total_s": 101.86590933799744, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f49e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.86590933799744, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.117647058823525, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.291705271291237, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.075953354934851, "policy_loss": -0.008960306000274917, "vf_loss": 9.097993031144142, "vf_explained_var": 0.3690144284938773, "kl": 0.015528246179807572, "entropy": 1.6185034147153299, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -43.99965024026947, "episode_reward_min": -1488.7207274236812, "episode_reward_mean": -745.8706519526927, "episode_len_mean": 126.59, "episode_media": {}, "episodes_timesteps_total": 12659, "policy_reward_min": {"policy_0": -1488.7207274236812}, "policy_reward_max": {"policy_0": -43.99965024026947}, "policy_reward_mean": {"policy_0": -745.8706519526927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1222.1621439505343, -1031.7615247510923, -1103.987236422449, -1369.2407729972565, -216.84286886787606, -672.8760858260285, -1068.4834795945133, -466.52941806566446, -53.89302651875464, -989.481109158398, -1259.207174541237, -1075.8096047418553, -1077.8570851972643, -850.5385443346315, -275.1313485224854, -1155.9823179534844, -229.86515362121708, -165.64462995663686, -939.4561451560676, -1019.9487067193589, -1063.0124205700274, -1381.9478779273195, -748.956266978875, -343.77076813892467, -1125.7106361827473, -421.15194454674815, -84.61004023063991, -917.6804761833774, -1272.5048599117292, -678.7861069712534, -1026.8357296605097, -966.9379972427147, -535.943329453467, -1303.832800549624, -705.9473504959869, -1092.3819101960535, -182.3106434383627, -862.8124582079919, -664.369926407324, -793.2424364969881, -697.7451321727191, -150.22224250167847, -1033.7954586970006, -293.2289505777296, -917.6924157842776, -663.0918933485175, -387.4238922086868, -682.9817397831124, -301.40638317038645, -505.31794417418246, -1105.4041389157321, -95.99476607999239, -751.7312705696363, -1488.7207274236812, -1201.4995412719643, -132.0429607777433, -1169.5787538882585, -221.19953526059456, -148.4984718213165, -1099.708810527454, -746.5871948879201, -528.8005718446336, -1484.158860553281, -1306.3347733230262, -151.94191722309745, -1218.3027410277787, -760.9558812850235, -1210.458736310207, -222.20720718675182, -386.7372896995791, -1353.4721793499714, -1039.7068196980374, -234.90468689708007, -1121.1422522899186, -410.54096806445193, -1295.6825382640918, -887.876150607919, -912.1692488623983, -1437.897069353905, -351.47466175547237, -1027.3522123846203, -150.1725842157647, -898.0435480433811, -1184.9790963830428, -116.98269555935863, -861.0283371959347, -507.89449909662716, -1179.358994582333, -119.7377904860646, -1090.99142148127, -43.99965024026947, -1186.6072266334904, -1022.5058628852756, -85.8733745965852, -151.72968387786494, -877.3913197740026, -164.4159758537258, -1025.8151529247127, -64.17293803176689, -301.93169689649443], "episode_lengths": [150, 150, 150, 150, 84, 150, 150, 137, 45, 150, 150, 150, 150, 150, 74, 150, 75, 62, 150, 150, 150, 150, 138, 89, 150, 150, 67, 150, 150, 150, 150, 150, 115, 150, 150, 150, 61, 150, 150, 150, 150, 68, 150, 85, 150, 150, 120, 150, 102, 138, 150, 83, 150, 150, 150, 65, 150, 79, 64, 150, 150, 150, 150, 150, 79, 150, 137, 150, 73, 150, 150, 150, 91, 150, 96, 150, 150, 147, 150, 107, 150, 78, 150, 150, 52, 150, 150, 150, 72, 150, 52, 150, 150, 57, 55, 150, 63, 150, 64, 85], "policy_policy_0_reward": [-1222.1621439505343, -1031.7615247510923, -1103.987236422449, -1369.2407729972565, -216.84286886787606, -672.8760858260285, -1068.4834795945133, -466.52941806566446, -53.89302651875464, -989.481109158398, -1259.207174541237, -1075.8096047418553, -1077.8570851972643, -850.5385443346315, -275.1313485224854, -1155.9823179534844, -229.86515362121708, -165.64462995663686, -939.4561451560676, -1019.9487067193589, -1063.0124205700274, -1381.9478779273195, -748.956266978875, -343.77076813892467, -1125.7106361827473, -421.15194454674815, -84.61004023063991, -917.6804761833774, -1272.5048599117292, -678.7861069712534, -1026.8357296605097, -966.9379972427147, -535.943329453467, -1303.832800549624, -705.9473504959869, -1092.3819101960535, -182.3106434383627, -862.8124582079919, -664.369926407324, -793.2424364969881, -697.7451321727191, -150.22224250167847, -1033.7954586970006, -293.2289505777296, -917.6924157842776, -663.0918933485175, -387.4238922086868, -682.9817397831124, -301.40638317038645, -505.31794417418246, -1105.4041389157321, -95.99476607999239, -751.7312705696363, -1488.7207274236812, -1201.4995412719643, -132.0429607777433, -1169.5787538882585, -221.19953526059456, -148.4984718213165, -1099.708810527454, -746.5871948879201, -528.8005718446336, -1484.158860553281, -1306.3347733230262, -151.94191722309745, -1218.3027410277787, -760.9558812850235, -1210.458736310207, -222.20720718675182, -386.7372896995791, -1353.4721793499714, -1039.7068196980374, -234.90468689708007, -1121.1422522899186, -410.54096806445193, -1295.6825382640918, -887.876150607919, -912.1692488623983, -1437.897069353905, -351.47466175547237, -1027.3522123846203, -150.1725842157647, -898.0435480433811, -1184.9790963830428, -116.98269555935863, -861.0283371959347, -507.89449909662716, -1179.358994582333, -119.7377904860646, -1090.99142148127, -43.99965024026947, -1186.6072266334904, -1022.5058628852756, -85.8733745965852, -151.72968387786494, -877.3913197740026, -164.4159758537258, -1025.8151529247127, -64.17293803176689, -301.93169689649443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624735374141288, "mean_inference_ms": 1.6888888281752323, "mean_action_processing_ms": 0.28070479827325034, "mean_env_wait_ms": 3.5051844912858767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012197732925415039, "StateBufferConnector_ms": 0.008016824722290039, "ViewRequirementAgentConnector_ms": 0.19078683853149414}, "num_episodes": 32, "episode_return_max": -43.99965024026947, "episode_return_min": -1488.7207274236812, "episode_return_mean": -745.8706519526927, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.7261385789251, "num_env_steps_trained_throughput_per_sec": 310.7261385789251, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12737.84, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12737.766, "sample_time_ms": 1154.173, "learn_time_ms": 11516.331, "learn_throughput": 347.333, "synch_weights_time_ms": 66.508}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00011", "date": "2024-08-04_06-31-02", "timestamp": 1722733262, "time_this_iter_s": 12.886314630508423, "time_total_s": 114.75222396850586, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1add0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.75222396850586, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.057894736842105, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.967841366430124, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.00670856287082, "policy_loss": -0.015875772864577205, "vf_loss": 9.035039180517197, "vf_explained_var": 0.43188507153342165, "kl": 0.020941946397275993, "entropy": 1.6643235084911188, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -20.441646802578415, "episode_reward_min": -1488.7207274236812, "episode_reward_mean": -725.412502155425, "episode_len_mean": 123.97, "episode_media": {}, "episodes_timesteps_total": 12397, "policy_reward_min": {"policy_0": -1488.7207274236812}, "policy_reward_max": {"policy_0": -20.441646802578415}, "policy_reward_mean": {"policy_0": -725.412502155425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-535.943329453467, -1303.832800549624, -705.9473504959869, -1092.3819101960535, -182.3106434383627, -862.8124582079919, -664.369926407324, -793.2424364969881, -697.7451321727191, -150.22224250167847, -1033.7954586970006, -293.2289505777296, -917.6924157842776, -663.0918933485175, -387.4238922086868, -682.9817397831124, -301.40638317038645, -505.31794417418246, -1105.4041389157321, -95.99476607999239, -751.7312705696363, -1488.7207274236812, -1201.4995412719643, -132.0429607777433, -1169.5787538882585, -221.19953526059456, -148.4984718213165, -1099.708810527454, -746.5871948879201, -528.8005718446336, -1484.158860553281, -1306.3347733230262, -151.94191722309745, -1218.3027410277787, -760.9558812850235, -1210.458736310207, -222.20720718675182, -386.7372896995791, -1353.4721793499714, -1039.7068196980374, -234.90468689708007, -1121.1422522899186, -410.54096806445193, -1295.6825382640918, -887.876150607919, -912.1692488623983, -1437.897069353905, -351.47466175547237, -1027.3522123846203, -150.1725842157647, -898.0435480433811, -1184.9790963830428, -116.98269555935863, -861.0283371959347, -507.89449909662716, -1179.358994582333, -119.7377904860646, -1090.99142148127, -43.99965024026947, -1186.6072266334904, -1022.5058628852756, -85.8733745965852, -151.72968387786494, -877.3913197740026, -164.4159758537258, -1025.8151529247127, -64.17293803176689, -301.93169689649443, -1192.496493692572, -568.0959622678612, -83.65679534000769, -113.84692449363205, -1305.4386649052624, -486.7116881645828, -389.6326405899969, -1434.1549381867387, -696.6885591474235, -222.30341458147987, -1442.6448369702514, -821.9735631100187, -933.4902024498023, -1216.430658034294, -1179.1026056943992, -1080.1683146524674, -918.4262594407777, -1225.6232464764523, -821.7721743264846, -1161.9308372117712, -991.1895394363643, -213.5367342401045, -793.8127172062625, -46.01661148138158, -1045.6189351165367, -141.21368660378917, -77.57539677578686, -496.3051657094539, -1043.695687138396, -1172.8340317788739, -893.9595896891145, -20.441646802578415], "episode_lengths": [115, 150, 150, 150, 61, 150, 150, 150, 150, 68, 150, 85, 150, 150, 120, 150, 102, 138, 150, 83, 150, 150, 150, 65, 150, 79, 64, 150, 150, 150, 150, 150, 79, 150, 137, 150, 73, 150, 150, 150, 91, 150, 96, 150, 150, 147, 150, 107, 150, 78, 150, 150, 52, 150, 150, 150, 72, 150, 52, 150, 150, 57, 55, 150, 63, 150, 64, 85, 150, 118, 70, 51, 150, 123, 113, 150, 129, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 147, 49, 150, 62, 49, 150, 150, 150, 150, 35], "policy_policy_0_reward": [-535.943329453467, -1303.832800549624, -705.9473504959869, -1092.3819101960535, -182.3106434383627, -862.8124582079919, -664.369926407324, -793.2424364969881, -697.7451321727191, -150.22224250167847, -1033.7954586970006, -293.2289505777296, -917.6924157842776, -663.0918933485175, -387.4238922086868, -682.9817397831124, -301.40638317038645, -505.31794417418246, -1105.4041389157321, -95.99476607999239, -751.7312705696363, -1488.7207274236812, -1201.4995412719643, -132.0429607777433, -1169.5787538882585, -221.19953526059456, -148.4984718213165, -1099.708810527454, -746.5871948879201, -528.8005718446336, -1484.158860553281, -1306.3347733230262, -151.94191722309745, -1218.3027410277787, -760.9558812850235, -1210.458736310207, -222.20720718675182, -386.7372896995791, -1353.4721793499714, -1039.7068196980374, -234.90468689708007, -1121.1422522899186, -410.54096806445193, -1295.6825382640918, -887.876150607919, -912.1692488623983, -1437.897069353905, -351.47466175547237, -1027.3522123846203, -150.1725842157647, -898.0435480433811, -1184.9790963830428, -116.98269555935863, -861.0283371959347, -507.89449909662716, -1179.358994582333, -119.7377904860646, -1090.99142148127, -43.99965024026947, -1186.6072266334904, -1022.5058628852756, -85.8733745965852, -151.72968387786494, -877.3913197740026, -164.4159758537258, -1025.8151529247127, -64.17293803176689, -301.93169689649443, -1192.496493692572, -568.0959622678612, -83.65679534000769, -113.84692449363205, -1305.4386649052624, -486.7116881645828, -389.6326405899969, -1434.1549381867387, -696.6885591474235, -222.30341458147987, -1442.6448369702514, -821.9735631100187, -933.4902024498023, -1216.430658034294, -1179.1026056943992, -1080.1683146524674, -918.4262594407777, -1225.6232464764523, -821.7721743264846, -1161.9308372117712, -991.1895394363643, -213.5367342401045, -793.8127172062625, -46.01661148138158, -1045.6189351165367, -141.21368660378917, -77.57539677578686, -496.3051657094539, -1043.695687138396, -1172.8340317788739, -893.9595896891145, -20.441646802578415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5608740747599118, "mean_inference_ms": 1.6876930197038351, "mean_action_processing_ms": 0.27987206910956763, "mean_env_wait_ms": 3.5106347583279636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01211237907409668, "StateBufferConnector_ms": 0.007930994033813477, "ViewRequirementAgentConnector_ms": 0.19218707084655762}, "num_episodes": 32, "episode_return_max": -20.441646802578415, "episode_return_min": -1488.7207274236812, "episode_return_mean": -725.412502155425, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8947438931203, "num_env_steps_trained_throughput_per_sec": 307.8947438931203, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12763.202, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12763.129, "sample_time_ms": 1152.766, "learn_time_ms": 11543.449, "learn_throughput": 346.517, "synch_weights_time_ms": 66.161}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00011", "date": "2024-08-04_06-31-15", "timestamp": 1722733275, "time_this_iter_s": 13.004762411117554, "time_total_s": 127.75698637962341, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fbb370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.75698637962341, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.605555555555554, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.073155564193923, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.26741239776214, "policy_loss": -0.010891466207491854, "vf_loss": 9.289776942133903, "vf_explained_var": 0.30055695343762634, "kl": 0.01750092248754907, "entropy": 1.6723333045840263, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -20.441646802578415, "episode_reward_min": -1484.158860553281, "episode_reward_mean": -751.3883898390061, "episode_len_mean": 128.04, "episode_media": {}, "episodes_timesteps_total": 12804, "policy_reward_min": {"policy_0": -1484.158860553281}, "policy_reward_max": {"policy_0": -20.441646802578415}, "policy_reward_mean": {"policy_0": -751.3883898390061}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-528.8005718446336, -1484.158860553281, -1306.3347733230262, -151.94191722309745, -1218.3027410277787, -760.9558812850235, -1210.458736310207, -222.20720718675182, -386.7372896995791, -1353.4721793499714, -1039.7068196980374, -234.90468689708007, -1121.1422522899186, -410.54096806445193, -1295.6825382640918, -887.876150607919, -912.1692488623983, -1437.897069353905, -351.47466175547237, -1027.3522123846203, -150.1725842157647, -898.0435480433811, -1184.9790963830428, -116.98269555935863, -861.0283371959347, -507.89449909662716, -1179.358994582333, -119.7377904860646, -1090.99142148127, -43.99965024026947, -1186.6072266334904, -1022.5058628852756, -85.8733745965852, -151.72968387786494, -877.3913197740026, -164.4159758537258, -1025.8151529247127, -64.17293803176689, -301.93169689649443, -1192.496493692572, -568.0959622678612, -83.65679534000769, -113.84692449363205, -1305.4386649052624, -486.7116881645828, -389.6326405899969, -1434.1549381867387, -696.6885591474235, -222.30341458147987, -1442.6448369702514, -821.9735631100187, -933.4902024498023, -1216.430658034294, -1179.1026056943992, -1080.1683146524674, -918.4262594407777, -1225.6232464764523, -821.7721743264846, -1161.9308372117712, -991.1895394363643, -213.5367342401045, -793.8127172062625, -46.01661148138158, -1045.6189351165367, -141.21368660378917, -77.57539677578686, -496.3051657094539, -1043.695687138396, -1172.8340317788739, -893.9595896891145, -20.441646802578415, -1191.336167196149, -1076.0432994851265, -938.5975558794997, -1268.7933288350068, -138.95027618758337, -638.6665535529302, -1334.0412366701107, -892.6844992097024, -760.1434045778225, -888.4018199063726, -431.7628053092034, -811.2189387782755, -685.0263576455858, -535.532926527267, -267.6110737888459, -518.8548936471675, -1077.1124367725406, -1059.987635774466, -1295.5121858848506, -724.5917117315646, -415.1882540736171, -454.69873376806146, -551.8396606698137, -1163.0369377954007, -1218.5444075286703, -800.4293555908832, -215.76469751627542, -453.05631896014904, -724.8743741835493], "episode_lengths": [150, 150, 150, 79, 150, 137, 150, 73, 150, 150, 150, 91, 150, 96, 150, 150, 147, 150, 107, 150, 78, 150, 150, 52, 150, 150, 150, 72, 150, 52, 150, 150, 57, 55, 150, 63, 150, 64, 85, 150, 118, 70, 51, 150, 123, 113, 150, 129, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 147, 49, 150, 62, 49, 150, 150, 150, 150, 35, 150, 150, 150, 150, 63, 142, 150, 150, 150, 150, 150, 150, 133, 150, 119, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 78, 150, 150], "policy_policy_0_reward": [-528.8005718446336, -1484.158860553281, -1306.3347733230262, -151.94191722309745, -1218.3027410277787, -760.9558812850235, -1210.458736310207, -222.20720718675182, -386.7372896995791, -1353.4721793499714, -1039.7068196980374, -234.90468689708007, -1121.1422522899186, -410.54096806445193, -1295.6825382640918, -887.876150607919, -912.1692488623983, -1437.897069353905, -351.47466175547237, -1027.3522123846203, -150.1725842157647, -898.0435480433811, -1184.9790963830428, -116.98269555935863, -861.0283371959347, -507.89449909662716, -1179.358994582333, -119.7377904860646, -1090.99142148127, -43.99965024026947, -1186.6072266334904, -1022.5058628852756, -85.8733745965852, -151.72968387786494, -877.3913197740026, -164.4159758537258, -1025.8151529247127, -64.17293803176689, -301.93169689649443, -1192.496493692572, -568.0959622678612, -83.65679534000769, -113.84692449363205, -1305.4386649052624, -486.7116881645828, -389.6326405899969, -1434.1549381867387, -696.6885591474235, -222.30341458147987, -1442.6448369702514, -821.9735631100187, -933.4902024498023, -1216.430658034294, -1179.1026056943992, -1080.1683146524674, -918.4262594407777, -1225.6232464764523, -821.7721743264846, -1161.9308372117712, -991.1895394363643, -213.5367342401045, -793.8127172062625, -46.01661148138158, -1045.6189351165367, -141.21368660378917, -77.57539677578686, -496.3051657094539, -1043.695687138396, -1172.8340317788739, -893.9595896891145, -20.441646802578415, -1191.336167196149, -1076.0432994851265, -938.5975558794997, -1268.7933288350068, -138.95027618758337, -638.6665535529302, -1334.0412366701107, -892.6844992097024, -760.1434045778225, -888.4018199063726, -431.7628053092034, -811.2189387782755, -685.0263576455858, -535.532926527267, -267.6110737888459, -518.8548936471675, -1077.1124367725406, -1059.987635774466, -1295.5121858848506, -724.5917117315646, -415.1882540736171, -454.69873376806146, -551.8396606698137, -1163.0369377954007, -1218.5444075286703, -800.4293555908832, -215.76469751627542, -453.05631896014904, -724.8743741835493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589375738202653, "mean_inference_ms": 1.684298770403151, "mean_action_processing_ms": 0.2795911022238799, "mean_env_wait_ms": 3.5113032271793156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012329578399658203, "StateBufferConnector_ms": 0.007906913757324219, "ViewRequirementAgentConnector_ms": 0.1907961368560791}, "num_episodes": 29, "episode_return_max": -20.441646802578415, "episode_return_min": -1484.158860553281, "episode_return_mean": -751.3883898390061, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.5108855545802, "num_env_steps_trained_throughput_per_sec": 306.5108855545802, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12772.183, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12772.109, "sample_time_ms": 1151.869, "learn_time_ms": 11554.041, "learn_throughput": 346.199, "synch_weights_time_ms": 65.437}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00011", "date": "2024-08-04_06-31-29", "timestamp": 1722733289, "time_this_iter_s": 13.062686681747437, "time_total_s": 140.81967306137085, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb9bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.81967306137085, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.378947368421052, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.064931507408619, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.07972097893556, "policy_loss": -0.007742864524576968, "vf_loss": 9.102541400988896, "vf_explained_var": 0.38240932828436297, "kl": 0.012066748791645902, "entropy": 1.8697611402720213, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -20.441646802578415, "episode_reward_min": -1447.2726709713386, "episode_reward_mean": -751.4355391876305, "episode_len_mean": 130.42, "episode_media": {}, "episodes_timesteps_total": 13042, "policy_reward_min": {"policy_0": -1447.2726709713386}, "policy_reward_max": {"policy_0": -20.441646802578415}, "policy_reward_mean": {"policy_0": -751.4355391876305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1090.99142148127, -43.99965024026947, -1186.6072266334904, -1022.5058628852756, -85.8733745965852, -151.72968387786494, -877.3913197740026, -164.4159758537258, -1025.8151529247127, -64.17293803176689, -301.93169689649443, -1192.496493692572, -568.0959622678612, -83.65679534000769, -113.84692449363205, -1305.4386649052624, -486.7116881645828, -389.6326405899969, -1434.1549381867387, -696.6885591474235, -222.30341458147987, -1442.6448369702514, -821.9735631100187, -933.4902024498023, -1216.430658034294, -1179.1026056943992, -1080.1683146524674, -918.4262594407777, -1225.6232464764523, -821.7721743264846, -1161.9308372117712, -991.1895394363643, -213.5367342401045, -793.8127172062625, -46.01661148138158, -1045.6189351165367, -141.21368660378917, -77.57539677578686, -496.3051657094539, -1043.695687138396, -1172.8340317788739, -893.9595896891145, -20.441646802578415, -1191.336167196149, -1076.0432994851265, -938.5975558794997, -1268.7933288350068, -138.95027618758337, -638.6665535529302, -1334.0412366701107, -892.6844992097024, -760.1434045778225, -888.4018199063726, -431.7628053092034, -811.2189387782755, -685.0263576455858, -535.532926527267, -267.6110737888459, -518.8548936471675, -1077.1124367725406, -1059.987635774466, -1295.5121858848506, -724.5917117315646, -415.1882540736171, -454.69873376806146, -551.8396606698137, -1163.0369377954007, -1218.5444075286703, -800.4293555908832, -215.76469751627542, -453.05631896014904, -724.8743741835493, -744.2883059145043, -329.4340263999624, -905.9738907063412, -1118.4555133262768, -1087.5235863712685, -1223.3790391647865, -517.8770832739458, -521.4934385301525, -822.5069512994762, -855.9878410002215, -268.4768908374576, -1129.2738037525448, -304.60608406289526, -747.3299314944134, -958.941573104619, -945.2259216796375, -1104.826580339338, -742.8715879387952, -557.3252281228896, -870.4954384856557, -1132.0164869327873, -914.6835043339669, -154.38144019727238, -1447.2726709713386, -1166.3859296073642, -1038.130803898449, -257.53317705894267, -498.3325176008969], "episode_lengths": [150, 52, 150, 150, 57, 55, 150, 63, 150, 64, 85, 150, 118, 70, 51, 150, 123, 113, 150, 129, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 147, 49, 150, 62, 49, 150, 150, 150, 150, 35, 150, 150, 150, 150, 63, 142, 150, 150, 150, 150, 150, 150, 133, 150, 119, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 78, 150, 150, 129, 150, 150, 150, 150, 150, 150, 124, 150, 150, 105, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 83, 106], "policy_policy_0_reward": [-1090.99142148127, -43.99965024026947, -1186.6072266334904, -1022.5058628852756, -85.8733745965852, -151.72968387786494, -877.3913197740026, -164.4159758537258, -1025.8151529247127, -64.17293803176689, -301.93169689649443, -1192.496493692572, -568.0959622678612, -83.65679534000769, -113.84692449363205, -1305.4386649052624, -486.7116881645828, -389.6326405899969, -1434.1549381867387, -696.6885591474235, -222.30341458147987, -1442.6448369702514, -821.9735631100187, -933.4902024498023, -1216.430658034294, -1179.1026056943992, -1080.1683146524674, -918.4262594407777, -1225.6232464764523, -821.7721743264846, -1161.9308372117712, -991.1895394363643, -213.5367342401045, -793.8127172062625, -46.01661148138158, -1045.6189351165367, -141.21368660378917, -77.57539677578686, -496.3051657094539, -1043.695687138396, -1172.8340317788739, -893.9595896891145, -20.441646802578415, -1191.336167196149, -1076.0432994851265, -938.5975558794997, -1268.7933288350068, -138.95027618758337, -638.6665535529302, -1334.0412366701107, -892.6844992097024, -760.1434045778225, -888.4018199063726, -431.7628053092034, -811.2189387782755, -685.0263576455858, -535.532926527267, -267.6110737888459, -518.8548936471675, -1077.1124367725406, -1059.987635774466, -1295.5121858848506, -724.5917117315646, -415.1882540736171, -454.69873376806146, -551.8396606698137, -1163.0369377954007, -1218.5444075286703, -800.4293555908832, -215.76469751627542, -453.05631896014904, -724.8743741835493, -744.2883059145043, -329.4340263999624, -905.9738907063412, -1118.4555133262768, -1087.5235863712685, -1223.3790391647865, -517.8770832739458, -521.4934385301525, -822.5069512994762, -855.9878410002215, -268.4768908374576, -1129.2738037525448, -304.60608406289526, -747.3299314944134, -958.941573104619, -945.2259216796375, -1104.826580339338, -742.8715879387952, -557.3252281228896, -870.4954384856557, -1132.0164869327873, -914.6835043339669, -154.38144019727238, -1447.2726709713386, -1166.3859296073642, -1038.130803898449, -257.53317705894267, -498.3325176008969]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5583666545135543, "mean_inference_ms": 1.6829547615350753, "mean_action_processing_ms": 0.27934168815343763, "mean_env_wait_ms": 3.5161923827648502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012343168258666992, "StateBufferConnector_ms": 0.007860183715820312, "ViewRequirementAgentConnector_ms": 0.19060587882995605}, "num_episodes": 28, "episode_return_max": -20.441646802578415, "episode_return_min": -1447.2726709713386, "episode_return_mean": -751.4355391876305, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.05440586463703, "num_env_steps_trained_throughput_per_sec": 511.05440586463703, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12228.401, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12228.327, "sample_time_ms": 1143.331, "learn_time_ms": 11019.54, "learn_throughput": 362.992, "synch_weights_time_ms": 64.696}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00011", "date": "2024-08-04_06-31-36", "timestamp": 1722733296, "time_this_iter_s": 7.839389801025391, "time_total_s": 148.65906286239624, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fbbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 148.65906286239624, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.29090909090909, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.381624035164714, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.102157183984916, "policy_loss": -0.016695416787600455, "vf_loss": 9.13156363517046, "vf_explained_var": 0.36259835921227934, "kl": 0.01802416677962054, "entropy": 1.8118269855777422, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -20.441646802578415, "episode_reward_min": -1460.6634297329135, "episode_reward_mean": -760.3917550246945, "episode_len_mean": 135.28, "episode_media": {}, "episodes_timesteps_total": 13528, "policy_reward_min": {"policy_0": -1460.6634297329135}, "policy_reward_max": {"policy_0": -20.441646802578415}, "policy_reward_mean": {"policy_0": -760.3917550246945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.5367342401045, -793.8127172062625, -46.01661148138158, -1045.6189351165367, -141.21368660378917, -77.57539677578686, -496.3051657094539, -1043.695687138396, -1172.8340317788739, -893.9595896891145, -20.441646802578415, -1191.336167196149, -1076.0432994851265, -938.5975558794997, -1268.7933288350068, -138.95027618758337, -638.6665535529302, -1334.0412366701107, -892.6844992097024, -760.1434045778225, -888.4018199063726, -431.7628053092034, -811.2189387782755, -685.0263576455858, -535.532926527267, -267.6110737888459, -518.8548936471675, -1077.1124367725406, -1059.987635774466, -1295.5121858848506, -724.5917117315646, -415.1882540736171, -454.69873376806146, -551.8396606698137, -1163.0369377954007, -1218.5444075286703, -800.4293555908832, -215.76469751627542, -453.05631896014904, -724.8743741835493, -744.2883059145043, -329.4340263999624, -905.9738907063412, -1118.4555133262768, -1087.5235863712685, -1223.3790391647865, -517.8770832739458, -521.4934385301525, -822.5069512994762, -855.9878410002215, -268.4768908374576, -1129.2738037525448, -304.60608406289526, -747.3299314944134, -958.941573104619, -945.2259216796375, -1104.826580339338, -742.8715879387952, -557.3252281228896, -870.4954384856557, -1132.0164869327873, -914.6835043339669, -154.38144019727238, -1447.2726709713386, -1166.3859296073642, -1038.130803898449, -257.53317705894267, -498.3325176008969, -290.6290206424662, -768.1972600781787, -786.6439742265792, -1025.4736989259143, -917.17354765866, -506.46225734084896, -1016.392596581396, -561.5509287624747, -597.3199687234032, -1460.6634297329135, -1002.6431581824368, -490.7041598872139, -1034.9352231012112, -920.9819551164462, -1088.4172448884694, -974.598431191028, -963.3159179266029, -656.7350990240732, -529.4285791751637, -833.5422187295028, -675.89846270689, -61.717023312285406, -59.51638990294366, -125.10953830991565, -366.444872245598, -632.4476600906984, -1226.46886004955, -940.3738078957407, -1204.9694402539924, -987.0183784413508, -1173.9927680157157, -1317.0683349548233], "episode_lengths": [67, 147, 49, 150, 62, 49, 150, 150, 150, 150, 35, 150, 150, 150, 150, 63, 142, 150, 150, 150, 150, 150, 150, 133, 150, 119, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 78, 150, 150, 129, 150, 150, 150, 150, 150, 150, 124, 150, 150, 105, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 83, 106, 86, 150, 150, 150, 150, 150, 150, 140, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 64, 71, 118, 143, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-213.5367342401045, -793.8127172062625, -46.01661148138158, -1045.6189351165367, -141.21368660378917, -77.57539677578686, -496.3051657094539, -1043.695687138396, -1172.8340317788739, -893.9595896891145, -20.441646802578415, -1191.336167196149, -1076.0432994851265, -938.5975558794997, -1268.7933288350068, -138.95027618758337, -638.6665535529302, -1334.0412366701107, -892.6844992097024, -760.1434045778225, -888.4018199063726, -431.7628053092034, -811.2189387782755, -685.0263576455858, -535.532926527267, -267.6110737888459, -518.8548936471675, -1077.1124367725406, -1059.987635774466, -1295.5121858848506, -724.5917117315646, -415.1882540736171, -454.69873376806146, -551.8396606698137, -1163.0369377954007, -1218.5444075286703, -800.4293555908832, -215.76469751627542, -453.05631896014904, -724.8743741835493, -744.2883059145043, -329.4340263999624, -905.9738907063412, -1118.4555133262768, -1087.5235863712685, -1223.3790391647865, -517.8770832739458, -521.4934385301525, -822.5069512994762, -855.9878410002215, -268.4768908374576, -1129.2738037525448, -304.60608406289526, -747.3299314944134, -958.941573104619, -945.2259216796375, -1104.826580339338, -742.8715879387952, -557.3252281228896, -870.4954384856557, -1132.0164869327873, -914.6835043339669, -154.38144019727238, -1447.2726709713386, -1166.3859296073642, -1038.130803898449, -257.53317705894267, -498.3325176008969, -290.6290206424662, -768.1972600781787, -786.6439742265792, -1025.4736989259143, -917.17354765866, -506.46225734084896, -1016.392596581396, -561.5509287624747, -597.3199687234032, -1460.6634297329135, -1002.6431581824368, -490.7041598872139, -1034.9352231012112, -920.9819551164462, -1088.4172448884694, -974.598431191028, -963.3159179266029, -656.7350990240732, -529.4285791751637, -833.5422187295028, -675.89846270689, -61.717023312285406, -59.51638990294366, -125.10953830991565, -366.444872245598, -632.4476600906984, -1226.46886004955, -940.3738078957407, -1204.9694402539924, -987.0183784413508, -1173.9927680157157, -1317.0683349548233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581590649259818, "mean_inference_ms": 1.6813396696926568, "mean_action_processing_ms": 0.27923638804420237, "mean_env_wait_ms": 3.5185864978024046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012159109115600586, "StateBufferConnector_ms": 0.007903099060058594, "ViewRequirementAgentConnector_ms": 0.1906898021697998}, "num_episodes": 32, "episode_return_max": -20.441646802578415, "episode_return_min": -1460.6634297329135, "episode_return_mean": -760.3917550246945, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.50503988915585, "num_env_steps_trained_throughput_per_sec": 314.50503988915585, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12186.447, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12186.376, "sample_time_ms": 1145.967, "learn_time_ms": 10975.649, "learn_throughput": 364.443, "synch_weights_time_ms": 63.999}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00011", "date": "2024-08-04_06-31-49", "timestamp": 1722733309, "time_this_iter_s": 12.730679273605347, "time_total_s": 161.3897421360016, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fbb520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 161.3897421360016, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.522222222222222, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.04109874094526, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.979452526569366, "policy_loss": -0.011837360251229256, "vf_loss": 9.00532854894797, "vf_explained_var": 0.3633526561781764, "kl": 0.01890159131053224, "entropy": 1.9709178635229667, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -27.97714903254403, "episode_reward_min": -1498.3614270112416, "episode_reward_mean": -780.8566668551997, "episode_len_mean": 135.67, "episode_media": {}, "episodes_timesteps_total": 13567, "policy_reward_min": {"policy_0": -1498.3614270112416}, "policy_reward_max": {"policy_0": -27.97714903254403}, "policy_reward_mean": {"policy_0": -780.8566668551997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1059.987635774466, -1295.5121858848506, -724.5917117315646, -415.1882540736171, -454.69873376806146, -551.8396606698137, -1163.0369377954007, -1218.5444075286703, -800.4293555908832, -215.76469751627542, -453.05631896014904, -724.8743741835493, -744.2883059145043, -329.4340263999624, -905.9738907063412, -1118.4555133262768, -1087.5235863712685, -1223.3790391647865, -517.8770832739458, -521.4934385301525, -822.5069512994762, -855.9878410002215, -268.4768908374576, -1129.2738037525448, -304.60608406289526, -747.3299314944134, -958.941573104619, -945.2259216796375, -1104.826580339338, -742.8715879387952, -557.3252281228896, -870.4954384856557, -1132.0164869327873, -914.6835043339669, -154.38144019727238, -1447.2726709713386, -1166.3859296073642, -1038.130803898449, -257.53317705894267, -498.3325176008969, -290.6290206424662, -768.1972600781787, -786.6439742265792, -1025.4736989259143, -917.17354765866, -506.46225734084896, -1016.392596581396, -561.5509287624747, -597.3199687234032, -1460.6634297329135, -1002.6431581824368, -490.7041598872139, -1034.9352231012112, -920.9819551164462, -1088.4172448884694, -974.598431191028, -963.3159179266029, -656.7350990240732, -529.4285791751637, -833.5422187295028, -675.89846270689, -61.717023312285406, -59.51638990294366, -125.10953830991565, -366.444872245598, -632.4476600906984, -1226.46886004955, -940.3738078957407, -1204.9694402539924, -987.0183784413508, -1173.9927680157157, -1317.0683349548233, -1278.363275872482, -215.85090357265122, -977.0040393761225, -908.1507877143534, -839.3092559255936, -154.97439713245893, -619.2103236368802, -1076.7382458097652, -433.35681254995376, -869.5099462077485, -105.59681597994702, -672.8416500209422, -1059.2414775787217, -478.7858611544306, -604.8084415721714, -1188.5198126319601, -1075.7608884849801, -431.6771810448314, -1023.7436984183305, -1048.5416007547735, -889.3729475650314, -1365.0091896391548, -1251.1879946657223, -27.97714903254403, -271.5306990093378, -887.1047000084122, -193.7494371914531, -1498.3614270112416], "episode_lengths": [150, 150, 150, 150, 102, 150, 150, 150, 150, 78, 150, 150, 129, 150, 150, 150, 150, 150, 150, 124, 150, 150, 105, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 83, 106, 86, 150, 150, 150, 150, 150, 150, 140, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 64, 71, 118, 143, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 57, 126, 150, 150, 150, 68, 150, 150, 142, 150, 150, 150, 95, 150, 150, 150, 150, 150, 54, 71, 150, 75, 150], "policy_policy_0_reward": [-1059.987635774466, -1295.5121858848506, -724.5917117315646, -415.1882540736171, -454.69873376806146, -551.8396606698137, -1163.0369377954007, -1218.5444075286703, -800.4293555908832, -215.76469751627542, -453.05631896014904, -724.8743741835493, -744.2883059145043, -329.4340263999624, -905.9738907063412, -1118.4555133262768, -1087.5235863712685, -1223.3790391647865, -517.8770832739458, -521.4934385301525, -822.5069512994762, -855.9878410002215, -268.4768908374576, -1129.2738037525448, -304.60608406289526, -747.3299314944134, -958.941573104619, -945.2259216796375, -1104.826580339338, -742.8715879387952, -557.3252281228896, -870.4954384856557, -1132.0164869327873, -914.6835043339669, -154.38144019727238, -1447.2726709713386, -1166.3859296073642, -1038.130803898449, -257.53317705894267, -498.3325176008969, -290.6290206424662, -768.1972600781787, -786.6439742265792, -1025.4736989259143, -917.17354765866, -506.46225734084896, -1016.392596581396, -561.5509287624747, -597.3199687234032, -1460.6634297329135, -1002.6431581824368, -490.7041598872139, -1034.9352231012112, -920.9819551164462, -1088.4172448884694, -974.598431191028, -963.3159179266029, -656.7350990240732, -529.4285791751637, -833.5422187295028, -675.89846270689, -61.717023312285406, -59.51638990294366, -125.10953830991565, -366.444872245598, -632.4476600906984, -1226.46886004955, -940.3738078957407, -1204.9694402539924, -987.0183784413508, -1173.9927680157157, -1317.0683349548233, -1278.363275872482, -215.85090357265122, -977.0040393761225, -908.1507877143534, -839.3092559255936, -154.97439713245893, -619.2103236368802, -1076.7382458097652, -433.35681254995376, -869.5099462077485, -105.59681597994702, -672.8416500209422, -1059.2414775787217, -478.7858611544306, -604.8084415721714, -1188.5198126319601, -1075.7608884849801, -431.6771810448314, -1023.7436984183305, -1048.5416007547735, -889.3729475650314, -1365.0091896391548, -1251.1879946657223, -27.97714903254403, -271.5306990093378, -887.1047000084122, -193.7494371914531, -1498.3614270112416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557484551439483, "mean_inference_ms": 1.6812050546228918, "mean_action_processing_ms": 0.278697840074558, "mean_env_wait_ms": 3.528640876796635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012337446212768555, "StateBufferConnector_ms": 0.007919073104858398, "ViewRequirementAgentConnector_ms": 0.1920161247253418}, "num_episodes": 28, "episode_return_max": -27.97714903254403, "episode_return_min": -1498.3614270112416, "episode_return_mean": -780.8566668551997, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.31536444553694, "num_env_steps_trained_throughput_per_sec": 340.31536444553694, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12070.983, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12070.913, "sample_time_ms": 1157.816, "learn_time_ms": 10848.343, "learn_throughput": 368.72, "synch_weights_time_ms": 63.975}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00011", "date": "2024-08-04_06-32-01", "timestamp": 1722733321, "time_this_iter_s": 11.76648736000061, "time_total_s": 173.1562294960022, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.1562294960022, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.982352941176472, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.844743721932172, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.710445410509903, "policy_loss": -0.014313439938996452, "vf_loss": 8.737111169099808, "vf_explained_var": 0.48976607657968996, "kl": 0.0194825953345268, "entropy": 1.819709690536062, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -27.97714903254403, "episode_reward_min": -1498.3614270112416, "episode_reward_mean": -749.5465314109217, "episode_len_mean": 134.11, "episode_media": {}, "episodes_timesteps_total": 13411, "policy_reward_min": {"policy_0": -1498.3614270112416}, "policy_reward_max": {"policy_0": -27.97714903254403}, "policy_reward_mean": {"policy_0": -749.5465314109217}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-557.3252281228896, -870.4954384856557, -1132.0164869327873, -914.6835043339669, -154.38144019727238, -1447.2726709713386, -1166.3859296073642, -1038.130803898449, -257.53317705894267, -498.3325176008969, -290.6290206424662, -768.1972600781787, -786.6439742265792, -1025.4736989259143, -917.17354765866, -506.46225734084896, -1016.392596581396, -561.5509287624747, -597.3199687234032, -1460.6634297329135, -1002.6431581824368, -490.7041598872139, -1034.9352231012112, -920.9819551164462, -1088.4172448884694, -974.598431191028, -963.3159179266029, -656.7350990240732, -529.4285791751637, -833.5422187295028, -675.89846270689, -61.717023312285406, -59.51638990294366, -125.10953830991565, -366.444872245598, -632.4476600906984, -1226.46886004955, -940.3738078957407, -1204.9694402539924, -987.0183784413508, -1173.9927680157157, -1317.0683349548233, -1278.363275872482, -215.85090357265122, -977.0040393761225, -908.1507877143534, -839.3092559255936, -154.97439713245893, -619.2103236368802, -1076.7382458097652, -433.35681254995376, -869.5099462077485, -105.59681597994702, -672.8416500209422, -1059.2414775787217, -478.7858611544306, -604.8084415721714, -1188.5198126319601, -1075.7608884849801, -431.6771810448314, -1023.7436984183305, -1048.5416007547735, -889.3729475650314, -1365.0091896391548, -1251.1879946657223, -27.97714903254403, -271.5306990093378, -887.1047000084122, -193.7494371914531, -1498.3614270112416, -792.7247538633595, -1005.5411975368921, -75.38709111706805, -751.8575393537479, -1366.2447365002652, -711.896564450399, -1166.8542411605351, -1015.815545418496, -514.2044628554911, -819.8740117018284, -1197.7858225194454, -732.1120771723727, -489.3610644852659, -567.7482776516179, -558.8484168598867, -46.902702932138546, -519.7071067257697, -407.93097560427043, -516.2017870363536, -559.2477394619439, -900.7387516413147, -167.3242246256517, -707.020930162355, -508.8049621813882, -579.9147396854474, -1010.1970791425041, -1021.9698100033181, -416.5571680342668, -273.37348862243977, -872.8355097402924], "episode_lengths": [150, 150, 150, 150, 76, 150, 150, 150, 83, 106, 86, 150, 150, 150, 150, 150, 150, 140, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 64, 71, 118, 143, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 57, 126, 150, 150, 150, 68, 150, 150, 142, 150, 150, 150, 95, 150, 150, 150, 150, 150, 54, 71, 150, 75, 150, 150, 150, 45, 134, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 51, 114, 150, 127, 130, 150, 95, 139, 150, 145, 150, 150, 150, 106, 150], "policy_policy_0_reward": [-557.3252281228896, -870.4954384856557, -1132.0164869327873, -914.6835043339669, -154.38144019727238, -1447.2726709713386, -1166.3859296073642, -1038.130803898449, -257.53317705894267, -498.3325176008969, -290.6290206424662, -768.1972600781787, -786.6439742265792, -1025.4736989259143, -917.17354765866, -506.46225734084896, -1016.392596581396, -561.5509287624747, -597.3199687234032, -1460.6634297329135, -1002.6431581824368, -490.7041598872139, -1034.9352231012112, -920.9819551164462, -1088.4172448884694, -974.598431191028, -963.3159179266029, -656.7350990240732, -529.4285791751637, -833.5422187295028, -675.89846270689, -61.717023312285406, -59.51638990294366, -125.10953830991565, -366.444872245598, -632.4476600906984, -1226.46886004955, -940.3738078957407, -1204.9694402539924, -987.0183784413508, -1173.9927680157157, -1317.0683349548233, -1278.363275872482, -215.85090357265122, -977.0040393761225, -908.1507877143534, -839.3092559255936, -154.97439713245893, -619.2103236368802, -1076.7382458097652, -433.35681254995376, -869.5099462077485, -105.59681597994702, -672.8416500209422, -1059.2414775787217, -478.7858611544306, -604.8084415721714, -1188.5198126319601, -1075.7608884849801, -431.6771810448314, -1023.7436984183305, -1048.5416007547735, -889.3729475650314, -1365.0091896391548, -1251.1879946657223, -27.97714903254403, -271.5306990093378, -887.1047000084122, -193.7494371914531, -1498.3614270112416, -792.7247538633595, -1005.5411975368921, -75.38709111706805, -751.8575393537479, -1366.2447365002652, -711.896564450399, -1166.8542411605351, -1015.815545418496, -514.2044628554911, -819.8740117018284, -1197.7858225194454, -732.1120771723727, -489.3610644852659, -567.7482776516179, -558.8484168598867, -46.902702932138546, -519.7071067257697, -407.93097560427043, -516.2017870363536, -559.2477394619439, -900.7387516413147, -167.3242246256517, -707.020930162355, -508.8049621813882, -579.9147396854474, -1010.1970791425041, -1021.9698100033181, -416.5571680342668, -273.37348862243977, -872.8355097402924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573311702350614, "mean_inference_ms": 1.6800065832326456, "mean_action_processing_ms": 0.2778966962726274, "mean_env_wait_ms": 3.5309152548362435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012325286865234375, "StateBufferConnector_ms": 0.007941961288452148, "ViewRequirementAgentConnector_ms": 0.19422411918640137}, "num_episodes": 30, "episode_return_max": -27.97714903254403, "episode_return_min": -1498.3614270112416, "episode_return_mean": -749.5465314109217, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.16101232971425, "num_env_steps_trained_throughput_per_sec": 303.16101232971425, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12202.629, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12202.557, "sample_time_ms": 1158.198, "learn_time_ms": 10978.277, "learn_throughput": 364.356, "synch_weights_time_ms": 65.292}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00011", "date": "2024-08-04_06-32-14", "timestamp": 1722733334, "time_this_iter_s": 13.206532955169678, "time_total_s": 186.36276245117188, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.36276245117188, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.3, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.33989179469645, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.876627531150977, "policy_loss": -0.017258550452728134, "vf_loss": 8.907316386202972, "vf_explained_var": 0.514821018713216, "kl": 0.02151198834765942, "entropy": 1.9883926153182983, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -27.97714903254403, "episode_reward_min": -1501.017711730132, "episode_reward_mean": -759.8696204017398, "episode_len_mean": 132.1, "episode_media": {}, "episodes_timesteps_total": 13210, "policy_reward_min": {"policy_0": -1501.017711730132}, "policy_reward_max": {"policy_0": -27.97714903254403}, "policy_reward_mean": {"policy_0": -759.8696204017398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-675.89846270689, -61.717023312285406, -59.51638990294366, -125.10953830991565, -366.444872245598, -632.4476600906984, -1226.46886004955, -940.3738078957407, -1204.9694402539924, -987.0183784413508, -1173.9927680157157, -1317.0683349548233, -1278.363275872482, -215.85090357265122, -977.0040393761225, -908.1507877143534, -839.3092559255936, -154.97439713245893, -619.2103236368802, -1076.7382458097652, -433.35681254995376, -869.5099462077485, -105.59681597994702, -672.8416500209422, -1059.2414775787217, -478.7858611544306, -604.8084415721714, -1188.5198126319601, -1075.7608884849801, -431.6771810448314, -1023.7436984183305, -1048.5416007547735, -889.3729475650314, -1365.0091896391548, -1251.1879946657223, -27.97714903254403, -271.5306990093378, -887.1047000084122, -193.7494371914531, -1498.3614270112416, -792.7247538633595, -1005.5411975368921, -75.38709111706805, -751.8575393537479, -1366.2447365002652, -711.896564450399, -1166.8542411605351, -1015.815545418496, -514.2044628554911, -819.8740117018284, -1197.7858225194454, -732.1120771723727, -489.3610644852659, -567.7482776516179, -558.8484168598867, -46.902702932138546, -519.7071067257697, -407.93097560427043, -516.2017870363536, -559.2477394619439, -900.7387516413147, -167.3242246256517, -707.020930162355, -508.8049621813882, -579.9147396854474, -1010.1970791425041, -1021.9698100033181, -416.5571680342668, -273.37348862243977, -872.8355097402924, -1220.8401949168858, -336.8175597895227, -180.69071359150587, -63.64368558856373, -1098.1090349775302, -905.5771645560424, -1092.9808735797626, -897.935819218615, -1134.3782616329572, -301.43537525915286, -994.9813625657046, -1322.2750699590235, -503.39714328614747, -486.3184437752751, -670.4677547879709, -877.897771716226, -1501.017711730132, -1304.7871957302787, -925.8694471524843, -151.59294211130754, -1014.9717943699405, -1090.2369920064666, -1113.98738167977, -342.0804909240926, -1046.8583933747293, -1346.3261376717717, -1155.720216188729, -68.62221452493469, -1374.0396258406054, -970.8179936802209], "episode_lengths": [150, 60, 64, 71, 118, 143, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 57, 126, 150, 150, 150, 68, 150, 150, 142, 150, 150, 150, 95, 150, 150, 150, 150, 150, 54, 71, 150, 75, 150, 150, 150, 45, 134, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 51, 114, 150, 127, 130, 150, 95, 139, 150, 145, 150, 150, 150, 106, 150, 150, 150, 68, 58, 150, 150, 150, 142, 150, 84, 150, 150, 150, 150, 117, 150, 150, 150, 150, 67, 150, 150, 150, 126, 150, 150, 150, 58, 150, 150], "policy_policy_0_reward": [-675.89846270689, -61.717023312285406, -59.51638990294366, -125.10953830991565, -366.444872245598, -632.4476600906984, -1226.46886004955, -940.3738078957407, -1204.9694402539924, -987.0183784413508, -1173.9927680157157, -1317.0683349548233, -1278.363275872482, -215.85090357265122, -977.0040393761225, -908.1507877143534, -839.3092559255936, -154.97439713245893, -619.2103236368802, -1076.7382458097652, -433.35681254995376, -869.5099462077485, -105.59681597994702, -672.8416500209422, -1059.2414775787217, -478.7858611544306, -604.8084415721714, -1188.5198126319601, -1075.7608884849801, -431.6771810448314, -1023.7436984183305, -1048.5416007547735, -889.3729475650314, -1365.0091896391548, -1251.1879946657223, -27.97714903254403, -271.5306990093378, -887.1047000084122, -193.7494371914531, -1498.3614270112416, -792.7247538633595, -1005.5411975368921, -75.38709111706805, -751.8575393537479, -1366.2447365002652, -711.896564450399, -1166.8542411605351, -1015.815545418496, -514.2044628554911, -819.8740117018284, -1197.7858225194454, -732.1120771723727, -489.3610644852659, -567.7482776516179, -558.8484168598867, -46.902702932138546, -519.7071067257697, -407.93097560427043, -516.2017870363536, -559.2477394619439, -900.7387516413147, -167.3242246256517, -707.020930162355, -508.8049621813882, -579.9147396854474, -1010.1970791425041, -1021.9698100033181, -416.5571680342668, -273.37348862243977, -872.8355097402924, -1220.8401949168858, -336.8175597895227, -180.69071359150587, -63.64368558856373, -1098.1090349775302, -905.5771645560424, -1092.9808735797626, -897.935819218615, -1134.3782616329572, -301.43537525915286, -994.9813625657046, -1322.2750699590235, -503.39714328614747, -486.3184437752751, -670.4677547879709, -877.897771716226, -1501.017711730132, -1304.7871957302787, -925.8694471524843, -151.59294211130754, -1014.9717943699405, -1090.2369920064666, -1113.98738167977, -342.0804909240926, -1046.8583933747293, -1346.3261376717717, -1155.720216188729, -68.62221452493469, -1374.0396258406054, -970.8179936802209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571506675679989, "mean_inference_ms": 1.6795458819538955, "mean_action_processing_ms": 0.2777895446639806, "mean_env_wait_ms": 3.537981899141441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012764453887939453, "StateBufferConnector_ms": 0.008086919784545898, "ViewRequirementAgentConnector_ms": 0.19543194770812988}, "num_episodes": 30, "episode_return_max": -27.97714903254403, "episode_return_min": -1501.017711730132, "episode_return_mean": -759.8696204017398, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.6313881264235, "num_env_steps_trained_throughput_per_sec": 344.6313881264235, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12114.804, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12114.732, "sample_time_ms": 1162.496, "learn_time_ms": 10887.133, "learn_throughput": 367.406, "synch_weights_time_ms": 64.316}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00011", "date": "2024-08-04_06-32-26", "timestamp": 1722733346, "time_this_iter_s": 11.617713689804077, "time_total_s": 197.98047614097595, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f189d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.98047614097595, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.25294117647059, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.86624869927764, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.568801909685135, "policy_loss": -0.014752089059523616, "vf_loss": 8.596502405405044, "vf_explained_var": 0.5717624404157201, "kl": 0.016026778998396687, "entropy": 2.0160456247627736, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -27.97714903254403, "episode_reward_min": -1501.017711730132, "episode_reward_mean": -762.5263916076813, "episode_len_mean": 134.58, "episode_media": {}, "episodes_timesteps_total": 13458, "policy_reward_min": {"policy_0": -1501.017711730132}, "policy_reward_max": {"policy_0": -27.97714903254403}, "policy_reward_mean": {"policy_0": -762.5263916076813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1075.7608884849801, -431.6771810448314, -1023.7436984183305, -1048.5416007547735, -889.3729475650314, -1365.0091896391548, -1251.1879946657223, -27.97714903254403, -271.5306990093378, -887.1047000084122, -193.7494371914531, -1498.3614270112416, -792.7247538633595, -1005.5411975368921, -75.38709111706805, -751.8575393537479, -1366.2447365002652, -711.896564450399, -1166.8542411605351, -1015.815545418496, -514.2044628554911, -819.8740117018284, -1197.7858225194454, -732.1120771723727, -489.3610644852659, -567.7482776516179, -558.8484168598867, -46.902702932138546, -519.7071067257697, -407.93097560427043, -516.2017870363536, -559.2477394619439, -900.7387516413147, -167.3242246256517, -707.020930162355, -508.8049621813882, -579.9147396854474, -1010.1970791425041, -1021.9698100033181, -416.5571680342668, -273.37348862243977, -872.8355097402924, -1220.8401949168858, -336.8175597895227, -180.69071359150587, -63.64368558856373, -1098.1090349775302, -905.5771645560424, -1092.9808735797626, -897.935819218615, -1134.3782616329572, -301.43537525915286, -994.9813625657046, -1322.2750699590235, -503.39714328614747, -486.3184437752751, -670.4677547879709, -877.897771716226, -1501.017711730132, -1304.7871957302787, -925.8694471524843, -151.59294211130754, -1014.9717943699405, -1090.2369920064666, -1113.98738167977, -342.0804909240926, -1046.8583933747293, -1346.3261376717717, -1155.720216188729, -68.62221452493469, -1374.0396258406054, -970.8179936802209, -586.4118392134621, -357.6557483217588, -266.7895926112155, -1044.598489427097, -978.1016993000583, -1080.4635350099, -104.26688251868497, -926.7082155916967, -1327.7866615994199, -476.6132505606257, -654.2836287548894, -68.99198355810275, -1120.9535861277695, -1013.1397086981219, -994.9086423623457, -1335.7308652495335, -871.604742857332, -529.08405752393, -303.2762193134173, -536.9095791075582, -1344.9276349774484, -436.32008467017647, -661.8019207510409, -796.0772910225883, -1182.2527284772584, -537.2872585481039, -439.6337254823371, -542.3851318739925], "episode_lengths": [150, 95, 150, 150, 150, 150, 150, 54, 71, 150, 75, 150, 150, 150, 45, 134, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 51, 114, 150, 127, 130, 150, 95, 139, 150, 145, 150, 150, 150, 106, 150, 150, 150, 68, 58, 150, 150, 150, 142, 150, 84, 150, 150, 150, 150, 117, 150, 150, 150, 150, 67, 150, 150, 150, 126, 150, 150, 150, 58, 150, 150, 121, 150, 94, 150, 150, 150, 65, 150, 150, 150, 142, 68, 150, 150, 150, 150, 150, 150, 141, 120, 150, 128, 135, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1075.7608884849801, -431.6771810448314, -1023.7436984183305, -1048.5416007547735, -889.3729475650314, -1365.0091896391548, -1251.1879946657223, -27.97714903254403, -271.5306990093378, -887.1047000084122, -193.7494371914531, -1498.3614270112416, -792.7247538633595, -1005.5411975368921, -75.38709111706805, -751.8575393537479, -1366.2447365002652, -711.896564450399, -1166.8542411605351, -1015.815545418496, -514.2044628554911, -819.8740117018284, -1197.7858225194454, -732.1120771723727, -489.3610644852659, -567.7482776516179, -558.8484168598867, -46.902702932138546, -519.7071067257697, -407.93097560427043, -516.2017870363536, -559.2477394619439, -900.7387516413147, -167.3242246256517, -707.020930162355, -508.8049621813882, -579.9147396854474, -1010.1970791425041, -1021.9698100033181, -416.5571680342668, -273.37348862243977, -872.8355097402924, -1220.8401949168858, -336.8175597895227, -180.69071359150587, -63.64368558856373, -1098.1090349775302, -905.5771645560424, -1092.9808735797626, -897.935819218615, -1134.3782616329572, -301.43537525915286, -994.9813625657046, -1322.2750699590235, -503.39714328614747, -486.3184437752751, -670.4677547879709, -877.897771716226, -1501.017711730132, -1304.7871957302787, -925.8694471524843, -151.59294211130754, -1014.9717943699405, -1090.2369920064666, -1113.98738167977, -342.0804909240926, -1046.8583933747293, -1346.3261376717717, -1155.720216188729, -68.62221452493469, -1374.0396258406054, -970.8179936802209, -586.4118392134621, -357.6557483217588, -266.7895926112155, -1044.598489427097, -978.1016993000583, -1080.4635350099, -104.26688251868497, -926.7082155916967, -1327.7866615994199, -476.6132505606257, -654.2836287548894, -68.99198355810275, -1120.9535861277695, -1013.1397086981219, -994.9086423623457, -1335.7308652495335, -871.604742857332, -529.08405752393, -303.2762193134173, -536.9095791075582, -1344.9276349774484, -436.32008467017647, -661.8019207510409, -796.0772910225883, -1182.2527284772584, -537.2872585481039, -439.6337254823371, -542.3851318739925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570981889390683, "mean_inference_ms": 1.6815182039768002, "mean_action_processing_ms": 0.2779581499552335, "mean_env_wait_ms": 3.5436754023919526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012340307235717773, "StateBufferConnector_ms": 0.008021116256713867, "ViewRequirementAgentConnector_ms": 0.194016695022583}, "num_episodes": 28, "episode_return_max": -27.97714903254403, "episode_return_min": -1501.017711730132, "episode_return_mean": -762.5263916076813, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.62174557345196, "num_env_steps_trained_throughput_per_sec": 318.62174557345196, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12091.965, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12091.894, "sample_time_ms": 1161.428, "learn_time_ms": 10865.884, "learn_throughput": 368.125, "synch_weights_time_ms": 63.791}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00011", "date": "2024-08-04_06-32-39", "timestamp": 1722733359, "time_this_iter_s": 12.567589282989502, "time_total_s": 210.54806542396545, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.54806542396545, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.13529411764706, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.259380794564883, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.11480431507031, "policy_loss": -0.017678456360590643, "vf_loss": 8.14575177182754, "vf_explained_var": 0.5325949006403486, "kl": 0.016071130894757365, "entropy": 2.0501006194700797, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -13.586121929238919, "episode_reward_min": -1501.017711730132, "episode_reward_mean": -783.4001079452279, "episode_len_mean": 136.8, "episode_media": {}, "episodes_timesteps_total": 13680, "policy_reward_min": {"policy_0": -1501.017711730132}, "policy_reward_max": {"policy_0": -13.586121929238919}, "policy_reward_mean": {"policy_0": -783.4001079452279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559.2477394619439, -900.7387516413147, -167.3242246256517, -707.020930162355, -508.8049621813882, -579.9147396854474, -1010.1970791425041, -1021.9698100033181, -416.5571680342668, -273.37348862243977, -872.8355097402924, -1220.8401949168858, -336.8175597895227, -180.69071359150587, -63.64368558856373, -1098.1090349775302, -905.5771645560424, -1092.9808735797626, -897.935819218615, -1134.3782616329572, -301.43537525915286, -994.9813625657046, -1322.2750699590235, -503.39714328614747, -486.3184437752751, -670.4677547879709, -877.897771716226, -1501.017711730132, -1304.7871957302787, -925.8694471524843, -151.59294211130754, -1014.9717943699405, -1090.2369920064666, -1113.98738167977, -342.0804909240926, -1046.8583933747293, -1346.3261376717717, -1155.720216188729, -68.62221452493469, -1374.0396258406054, -970.8179936802209, -586.4118392134621, -357.6557483217588, -266.7895926112155, -1044.598489427097, -978.1016993000583, -1080.4635350099, -104.26688251868497, -926.7082155916967, -1327.7866615994199, -476.6132505606257, -654.2836287548894, -68.99198355810275, -1120.9535861277695, -1013.1397086981219, -994.9086423623457, -1335.7308652495335, -871.604742857332, -529.08405752393, -303.2762193134173, -536.9095791075582, -1344.9276349774484, -436.32008467017647, -661.8019207510409, -796.0772910225883, -1182.2527284772584, -537.2872585481039, -439.6337254823371, -542.3851318739925, -1302.4593418016357, -904.8837920083357, -316.70833787473197, -1415.6131455544376, -1174.664974565457, -902.5269196102313, -1000.3792153001815, -1126.886470071453, -1200.2278100704732, -267.92664645489936, -406.6550433837416, -477.9429493458766, -1475.537904755396, -525.1303951230244, -814.6229955991253, -13.586121929238919, -941.7971928224666, -892.308835441704, -1310.639967467571, -1284.5019381630784, -465.4093944724828, -406.76590110679757, -790.2838584236629, -898.1814186180094, -666.8757452784395, -1112.8156415353199, -386.18010619618696, -914.0154355414766, -297.4427169331193, -651.0361994389494, -964.3805066381411], "episode_lengths": [130, 150, 95, 139, 150, 145, 150, 150, 150, 106, 150, 150, 150, 68, 58, 150, 150, 150, 142, 150, 84, 150, 150, 150, 150, 117, 150, 150, 150, 150, 67, 150, 150, 150, 126, 150, 150, 150, 58, 150, 150, 121, 150, 94, 150, 150, 150, 65, 150, 150, 150, 142, 68, 150, 150, 150, 150, 150, 150, 141, 120, 150, 128, 135, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 117, 146, 41, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 146, 84, 150, 150], "policy_policy_0_reward": [-559.2477394619439, -900.7387516413147, -167.3242246256517, -707.020930162355, -508.8049621813882, -579.9147396854474, -1010.1970791425041, -1021.9698100033181, -416.5571680342668, -273.37348862243977, -872.8355097402924, -1220.8401949168858, -336.8175597895227, -180.69071359150587, -63.64368558856373, -1098.1090349775302, -905.5771645560424, -1092.9808735797626, -897.935819218615, -1134.3782616329572, -301.43537525915286, -994.9813625657046, -1322.2750699590235, -503.39714328614747, -486.3184437752751, -670.4677547879709, -877.897771716226, -1501.017711730132, -1304.7871957302787, -925.8694471524843, -151.59294211130754, -1014.9717943699405, -1090.2369920064666, -1113.98738167977, -342.0804909240926, -1046.8583933747293, -1346.3261376717717, -1155.720216188729, -68.62221452493469, -1374.0396258406054, -970.8179936802209, -586.4118392134621, -357.6557483217588, -266.7895926112155, -1044.598489427097, -978.1016993000583, -1080.4635350099, -104.26688251868497, -926.7082155916967, -1327.7866615994199, -476.6132505606257, -654.2836287548894, -68.99198355810275, -1120.9535861277695, -1013.1397086981219, -994.9086423623457, -1335.7308652495335, -871.604742857332, -529.08405752393, -303.2762193134173, -536.9095791075582, -1344.9276349774484, -436.32008467017647, -661.8019207510409, -796.0772910225883, -1182.2527284772584, -537.2872585481039, -439.6337254823371, -542.3851318739925, -1302.4593418016357, -904.8837920083357, -316.70833787473197, -1415.6131455544376, -1174.664974565457, -902.5269196102313, -1000.3792153001815, -1126.886470071453, -1200.2278100704732, -267.92664645489936, -406.6550433837416, -477.9429493458766, -1475.537904755396, -525.1303951230244, -814.6229955991253, -13.586121929238919, -941.7971928224666, -892.308835441704, -1310.639967467571, -1284.5019381630784, -465.4093944724828, -406.76590110679757, -790.2838584236629, -898.1814186180094, -666.8757452784395, -1112.8156415353199, -386.18010619618696, -914.0154355414766, -297.4427169331193, -651.0361994389494, -964.3805066381411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565899261704071, "mean_inference_ms": 1.6803875062435685, "mean_action_processing_ms": 0.2775594749538828, "mean_env_wait_ms": 3.548613790062667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01228475570678711, "StateBufferConnector_ms": 0.007943868637084961, "ViewRequirementAgentConnector_ms": 0.19136548042297363}, "num_episodes": 31, "episode_return_max": -13.586121929238919, "episode_return_min": -1501.017711730132, "episode_return_mean": -783.4001079452279, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.82265226423993, "num_env_steps_trained_throughput_per_sec": 326.82265226423993, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12080.797, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12080.72, "sample_time_ms": 1169.362, "learn_time_ms": 10847.213, "learn_throughput": 368.758, "synch_weights_time_ms": 63.351}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00011", "date": "2024-08-04_06-32-51", "timestamp": 1722733371, "time_this_iter_s": 12.251046895980835, "time_total_s": 222.7991123199463, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.7991123199463, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.522222222222226, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.615936686595282, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.827121189733345, "policy_loss": -0.008347776345423578, "vf_loss": 8.849224486450355, "vf_explained_var": 0.5547058263172706, "kl": 0.016622025833991454, "entropy": 2.1235459449390572, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -13.586121929238919, "episode_reward_min": -1558.2754361656732, "episode_reward_mean": -802.4638105897164, "episode_len_mean": 135.83, "episode_media": {}, "episodes_timesteps_total": 13583, "policy_reward_min": {"policy_0": -1558.2754361656732}, "policy_reward_max": {"policy_0": -13.586121929238919}, "policy_reward_mean": {"policy_0": -802.4638105897164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1090.2369920064666, -1113.98738167977, -342.0804909240926, -1046.8583933747293, -1346.3261376717717, -1155.720216188729, -68.62221452493469, -1374.0396258406054, -970.8179936802209, -586.4118392134621, -357.6557483217588, -266.7895926112155, -1044.598489427097, -978.1016993000583, -1080.4635350099, -104.26688251868497, -926.7082155916967, -1327.7866615994199, -476.6132505606257, -654.2836287548894, -68.99198355810275, -1120.9535861277695, -1013.1397086981219, -994.9086423623457, -1335.7308652495335, -871.604742857332, -529.08405752393, -303.2762193134173, -536.9095791075582, -1344.9276349774484, -436.32008467017647, -661.8019207510409, -796.0772910225883, -1182.2527284772584, -537.2872585481039, -439.6337254823371, -542.3851318739925, -1302.4593418016357, -904.8837920083357, -316.70833787473197, -1415.6131455544376, -1174.664974565457, -902.5269196102313, -1000.3792153001815, -1126.886470071453, -1200.2278100704732, -267.92664645489936, -406.6550433837416, -477.9429493458766, -1475.537904755396, -525.1303951230244, -814.6229955991253, -13.586121929238919, -941.7971928224666, -892.308835441704, -1310.639967467571, -1284.5019381630784, -465.4093944724828, -406.76590110679757, -790.2838584236629, -898.1814186180094, -666.8757452784395, -1112.8156415353199, -386.18010619618696, -914.0154355414766, -297.4427169331193, -651.0361994389494, -964.3805066381411, -1032.2818007532649, -919.4600086734382, -1145.3936872812358, -1373.6953231990506, -1263.471216089485, -718.2156222451007, -1350.3795709722283, -1088.8132309181792, -567.6192211244676, -788.470999742321, -164.0325113656408, -105.52346032601909, -920.2515829239358, -137.4864289864931, -1257.116568087667, -1231.479480929877, -180.45723153429861, -823.1252827532888, -114.34752386517128, -940.9674100330291, -316.18209597224563, -669.4716099510139, -1199.8219749102411, -550.3137870804711, -924.0229016454957, -96.72364526625104, -1558.2754361656732, -1036.5909393602062, -443.6304920156031, -1047.018728765809, -1399.2065167698818, -546.4936983377365], "episode_lengths": [150, 150, 126, 150, 150, 150, 58, 150, 150, 121, 150, 94, 150, 150, 150, 65, 150, 150, 150, 142, 68, 150, 150, 150, 150, 150, 150, 141, 120, 150, 128, 135, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 117, 146, 41, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 146, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 59, 45, 150, 52, 150, 150, 80, 150, 57, 150, 125, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1090.2369920064666, -1113.98738167977, -342.0804909240926, -1046.8583933747293, -1346.3261376717717, -1155.720216188729, -68.62221452493469, -1374.0396258406054, -970.8179936802209, -586.4118392134621, -357.6557483217588, -266.7895926112155, -1044.598489427097, -978.1016993000583, -1080.4635350099, -104.26688251868497, -926.7082155916967, -1327.7866615994199, -476.6132505606257, -654.2836287548894, -68.99198355810275, -1120.9535861277695, -1013.1397086981219, -994.9086423623457, -1335.7308652495335, -871.604742857332, -529.08405752393, -303.2762193134173, -536.9095791075582, -1344.9276349774484, -436.32008467017647, -661.8019207510409, -796.0772910225883, -1182.2527284772584, -537.2872585481039, -439.6337254823371, -542.3851318739925, -1302.4593418016357, -904.8837920083357, -316.70833787473197, -1415.6131455544376, -1174.664974565457, -902.5269196102313, -1000.3792153001815, -1126.886470071453, -1200.2278100704732, -267.92664645489936, -406.6550433837416, -477.9429493458766, -1475.537904755396, -525.1303951230244, -814.6229955991253, -13.586121929238919, -941.7971928224666, -892.308835441704, -1310.639967467571, -1284.5019381630784, -465.4093944724828, -406.76590110679757, -790.2838584236629, -898.1814186180094, -666.8757452784395, -1112.8156415353199, -386.18010619618696, -914.0154355414766, -297.4427169331193, -651.0361994389494, -964.3805066381411, -1032.2818007532649, -919.4600086734382, -1145.3936872812358, -1373.6953231990506, -1263.471216089485, -718.2156222451007, -1350.3795709722283, -1088.8132309181792, -567.6192211244676, -788.470999742321, -164.0325113656408, -105.52346032601909, -920.2515829239358, -137.4864289864931, -1257.116568087667, -1231.479480929877, -180.45723153429861, -823.1252827532888, -114.34752386517128, -940.9674100330291, -316.18209597224563, -669.4716099510139, -1199.8219749102411, -550.3137870804711, -924.0229016454957, -96.72364526625104, -1558.2754361656732, -1036.5909393602062, -443.6304920156031, -1047.018728765809, -1399.2065167698818, -546.4936983377365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557494709159938, "mean_inference_ms": 1.679378843637596, "mean_action_processing_ms": 0.277040043717045, "mean_env_wait_ms": 3.5524846108227965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012113809585571289, "StateBufferConnector_ms": 0.007825613021850586, "ViewRequirementAgentConnector_ms": 0.18799400329589844}, "num_episodes": 32, "episode_return_max": -13.586121929238919, "episode_return_min": -1558.2754361656732, "episode_return_mean": -802.4638105897164, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.7133000599871, "num_env_steps_trained_throughput_per_sec": 324.7133000599871, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12025.346, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12025.268, "sample_time_ms": 1175.476, "learn_time_ms": 10785.944, "learn_throughput": 370.853, "synch_weights_time_ms": 63.056}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00011", "date": "2024-08-04_06-33-03", "timestamp": 1722733383, "time_this_iter_s": 12.33129334449768, "time_total_s": 235.13040566444397, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1b7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.13040566444397, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.755555555555553, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.412937513490517, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.909042256573835, "policy_loss": -0.00958646922032737, "vf_loss": 8.934054544071357, "vf_explained_var": 0.6118167485420902, "kl": 0.014672645958065307, "entropy": 2.202847891052564, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -13.586121929238919, "episode_reward_min": -1558.2754361656732, "episode_reward_mean": -794.3702931514343, "episode_len_mean": 135.42, "episode_media": {}, "episodes_timesteps_total": 13542, "policy_reward_min": {"policy_0": -1558.2754361656732}, "policy_reward_max": {"policy_0": -13.586121929238919}, "policy_reward_mean": {"policy_0": -794.3702931514343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-303.2762193134173, -536.9095791075582, -1344.9276349774484, -436.32008467017647, -661.8019207510409, -796.0772910225883, -1182.2527284772584, -537.2872585481039, -439.6337254823371, -542.3851318739925, -1302.4593418016357, -904.8837920083357, -316.70833787473197, -1415.6131455544376, -1174.664974565457, -902.5269196102313, -1000.3792153001815, -1126.886470071453, -1200.2278100704732, -267.92664645489936, -406.6550433837416, -477.9429493458766, -1475.537904755396, -525.1303951230244, -814.6229955991253, -13.586121929238919, -941.7971928224666, -892.308835441704, -1310.639967467571, -1284.5019381630784, -465.4093944724828, -406.76590110679757, -790.2838584236629, -898.1814186180094, -666.8757452784395, -1112.8156415353199, -386.18010619618696, -914.0154355414766, -297.4427169331193, -651.0361994389494, -964.3805066381411, -1032.2818007532649, -919.4600086734382, -1145.3936872812358, -1373.6953231990506, -1263.471216089485, -718.2156222451007, -1350.3795709722283, -1088.8132309181792, -567.6192211244676, -788.470999742321, -164.0325113656408, -105.52346032601909, -920.2515829239358, -137.4864289864931, -1257.116568087667, -1231.479480929877, -180.45723153429861, -823.1252827532888, -114.34752386517128, -940.9674100330291, -316.18209597224563, -669.4716099510139, -1199.8219749102411, -550.3137870804711, -924.0229016454957, -96.72364526625104, -1558.2754361656732, -1036.5909393602062, -443.6304920156031, -1047.018728765809, -1399.2065167698818, -546.4936983377365, -263.80525625868677, -396.00251182016024, -891.5478805065849, -1043.3637277615906, -1300.7394674261436, -962.1230866709351, -1229.5169185191003, -647.2378168275341, -186.40791398511894, -364.0968213899457, -1201.6561759601645, -1326.0692761275798, -174.0400242147619, -1292.0970269035683, -509.80817797446565, -345.9906631442781, -681.0217216365777, -1199.9752779439177, -226.2214122651889, -106.29096519157247, -717.6628547281144, -1078.5058986997597, -1219.597826196796, -513.6697875568251, -1147.4788566789084, -1372.4312879257795, -1040.072197034979], "episode_lengths": [141, 120, 150, 128, 135, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 117, 146, 41, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 146, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 59, 45, 150, 52, 150, 150, 80, 150, 57, 150, 125, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 142, 114, 146, 150, 150, 77, 150, 150, 124, 138, 150, 64, 67, 126, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-303.2762193134173, -536.9095791075582, -1344.9276349774484, -436.32008467017647, -661.8019207510409, -796.0772910225883, -1182.2527284772584, -537.2872585481039, -439.6337254823371, -542.3851318739925, -1302.4593418016357, -904.8837920083357, -316.70833787473197, -1415.6131455544376, -1174.664974565457, -902.5269196102313, -1000.3792153001815, -1126.886470071453, -1200.2278100704732, -267.92664645489936, -406.6550433837416, -477.9429493458766, -1475.537904755396, -525.1303951230244, -814.6229955991253, -13.586121929238919, -941.7971928224666, -892.308835441704, -1310.639967467571, -1284.5019381630784, -465.4093944724828, -406.76590110679757, -790.2838584236629, -898.1814186180094, -666.8757452784395, -1112.8156415353199, -386.18010619618696, -914.0154355414766, -297.4427169331193, -651.0361994389494, -964.3805066381411, -1032.2818007532649, -919.4600086734382, -1145.3936872812358, -1373.6953231990506, -1263.471216089485, -718.2156222451007, -1350.3795709722283, -1088.8132309181792, -567.6192211244676, -788.470999742321, -164.0325113656408, -105.52346032601909, -920.2515829239358, -137.4864289864931, -1257.116568087667, -1231.479480929877, -180.45723153429861, -823.1252827532888, -114.34752386517128, -940.9674100330291, -316.18209597224563, -669.4716099510139, -1199.8219749102411, -550.3137870804711, -924.0229016454957, -96.72364526625104, -1558.2754361656732, -1036.5909393602062, -443.6304920156031, -1047.018728765809, -1399.2065167698818, -546.4936983377365, -263.80525625868677, -396.00251182016024, -891.5478805065849, -1043.3637277615906, -1300.7394674261436, -962.1230866709351, -1229.5169185191003, -647.2378168275341, -186.40791398511894, -364.0968213899457, -1201.6561759601645, -1326.0692761275798, -174.0400242147619, -1292.0970269035683, -509.80817797446565, -345.9906631442781, -681.0217216365777, -1199.9752779439177, -226.2214122651889, -106.29096519157247, -717.6628547281144, -1078.5058986997597, -1219.597826196796, -513.6697875568251, -1147.4788566789084, -1372.4312879257795, -1040.072197034979]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555698823303811, "mean_inference_ms": 1.678201248408553, "mean_action_processing_ms": 0.27692887005801464, "mean_env_wait_ms": 3.553733376003061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01193690299987793, "StateBufferConnector_ms": 0.007890939712524414, "ViewRequirementAgentConnector_ms": 0.18964433670043945}, "num_episodes": 27, "episode_return_max": -13.586121929238919, "episode_return_min": -1558.2754361656732, "episode_return_mean": -794.3702931514343, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.6137882721343, "num_env_steps_trained_throughput_per_sec": 306.6137882721343, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12030.773, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12030.695, "sample_time_ms": 1179.629, "learn_time_ms": 10786.744, "learn_throughput": 370.826, "synch_weights_time_ms": 63.528}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00011", "date": "2024-08-04_06-33-16", "timestamp": 1722733396, "time_this_iter_s": 13.058700561523438, "time_total_s": 248.1891062259674, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 248.1891062259674, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.461111111111112, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.761641116812825, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.615871793031692, "policy_loss": -0.014478461928956677, "vf_loss": 8.644708336889744, "vf_explained_var": 0.5912680706009269, "kl": 0.015927214893902936, "entropy": 2.1525301249076922, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -0.13225479874238555, "episode_reward_min": -1558.2754361656732, "episode_reward_mean": -789.4792549821224, "episode_len_mean": 132.8, "episode_media": {}, "episodes_timesteps_total": 13280, "policy_reward_min": {"policy_0": -1558.2754361656732}, "policy_reward_max": {"policy_0": -0.13225479874238555}, "policy_reward_mean": {"policy_0": -789.4792549821224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-465.4093944724828, -406.76590110679757, -790.2838584236629, -898.1814186180094, -666.8757452784395, -1112.8156415353199, -386.18010619618696, -914.0154355414766, -297.4427169331193, -651.0361994389494, -964.3805066381411, -1032.2818007532649, -919.4600086734382, -1145.3936872812358, -1373.6953231990506, -1263.471216089485, -718.2156222451007, -1350.3795709722283, -1088.8132309181792, -567.6192211244676, -788.470999742321, -164.0325113656408, -105.52346032601909, -920.2515829239358, -137.4864289864931, -1257.116568087667, -1231.479480929877, -180.45723153429861, -823.1252827532888, -114.34752386517128, -940.9674100330291, -316.18209597224563, -669.4716099510139, -1199.8219749102411, -550.3137870804711, -924.0229016454957, -96.72364526625104, -1558.2754361656732, -1036.5909393602062, -443.6304920156031, -1047.018728765809, -1399.2065167698818, -546.4936983377365, -263.80525625868677, -396.00251182016024, -891.5478805065849, -1043.3637277615906, -1300.7394674261436, -962.1230866709351, -1229.5169185191003, -647.2378168275341, -186.40791398511894, -364.0968213899457, -1201.6561759601645, -1326.0692761275798, -174.0400242147619, -1292.0970269035683, -509.80817797446565, -345.9906631442781, -681.0217216365777, -1199.9752779439177, -226.2214122651889, -106.29096519157247, -717.6628547281144, -1078.5058986997597, -1219.597826196796, -513.6697875568251, -1147.4788566789084, -1372.4312879257795, -1040.072197034979, -953.833996056932, -269.5508935551776, -893.556689181692, -1007.895330684089, -1119.859095514533, -192.97103561425874, -453.2449430886233, -1508.39476582512, -161.3672781692425, -0.13225479874238555, -770.8536587618016, -1356.3056851377717, -1315.4724401138046, -319.2107897410091, -1407.3769229178238, -1182.7126619222752, -1011.2530008265455, -1158.7737495608076, -671.0043666910199, -1065.7763162146962, -1285.498396720512, -414.6052719460257, -290.8992760282159, -303.13170128179615, -88.06095273484858, -1210.7913796250525, -1255.1386193137466, -1048.732650534723, -306.8733295157243, -1023.4903025591728], "episode_lengths": [150, 150, 129, 150, 150, 150, 150, 146, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 59, 45, 150, 52, 150, 150, 80, 150, 57, 150, 125, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 142, 114, 146, 150, 150, 77, 150, 150, 124, 138, 150, 64, 67, 126, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 84, 118, 150, 80, 36, 135, 150, 150, 82, 150, 150, 150, 150, 143, 150, 150, 150, 144, 121, 66, 150, 150, 150, 81, 150], "policy_policy_0_reward": [-465.4093944724828, -406.76590110679757, -790.2838584236629, -898.1814186180094, -666.8757452784395, -1112.8156415353199, -386.18010619618696, -914.0154355414766, -297.4427169331193, -651.0361994389494, -964.3805066381411, -1032.2818007532649, -919.4600086734382, -1145.3936872812358, -1373.6953231990506, -1263.471216089485, -718.2156222451007, -1350.3795709722283, -1088.8132309181792, -567.6192211244676, -788.470999742321, -164.0325113656408, -105.52346032601909, -920.2515829239358, -137.4864289864931, -1257.116568087667, -1231.479480929877, -180.45723153429861, -823.1252827532888, -114.34752386517128, -940.9674100330291, -316.18209597224563, -669.4716099510139, -1199.8219749102411, -550.3137870804711, -924.0229016454957, -96.72364526625104, -1558.2754361656732, -1036.5909393602062, -443.6304920156031, -1047.018728765809, -1399.2065167698818, -546.4936983377365, -263.80525625868677, -396.00251182016024, -891.5478805065849, -1043.3637277615906, -1300.7394674261436, -962.1230866709351, -1229.5169185191003, -647.2378168275341, -186.40791398511894, -364.0968213899457, -1201.6561759601645, -1326.0692761275798, -174.0400242147619, -1292.0970269035683, -509.80817797446565, -345.9906631442781, -681.0217216365777, -1199.9752779439177, -226.2214122651889, -106.29096519157247, -717.6628547281144, -1078.5058986997597, -1219.597826196796, -513.6697875568251, -1147.4788566789084, -1372.4312879257795, -1040.072197034979, -953.833996056932, -269.5508935551776, -893.556689181692, -1007.895330684089, -1119.859095514533, -192.97103561425874, -453.2449430886233, -1508.39476582512, -161.3672781692425, -0.13225479874238555, -770.8536587618016, -1356.3056851377717, -1315.4724401138046, -319.2107897410091, -1407.3769229178238, -1182.7126619222752, -1011.2530008265455, -1158.7737495608076, -671.0043666910199, -1065.7763162146962, -1285.498396720512, -414.6052719460257, -290.8992760282159, -303.13170128179615, -88.06095273484858, -1210.7913796250525, -1255.1386193137466, -1048.732650534723, -306.8733295157243, -1023.4903025591728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550703078257587, "mean_inference_ms": 1.6772048407305409, "mean_action_processing_ms": 0.27674052303836466, "mean_env_wait_ms": 3.5579590903263996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01177978515625, "StateBufferConnector_ms": 0.007938623428344727, "ViewRequirementAgentConnector_ms": 0.18954014778137207}, "num_episodes": 30, "episode_return_max": -0.13225479874238555, "episode_return_min": -1558.2754361656732, "episode_return_mean": -789.4792549821224, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.15577023774557, "num_env_steps_trained_throughput_per_sec": 301.15577023774557, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12053.979, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12053.9, "sample_time_ms": 1182.323, "learn_time_ms": 10807.391, "learn_throughput": 370.117, "synch_weights_time_ms": 63.402}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00011", "date": "2024-08-04_06-33-30", "timestamp": 1722733410, "time_this_iter_s": 13.293972253799438, "time_total_s": 261.48307847976685, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fbb400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 261.48307847976685, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.384210526315787, "ram_util_percent": 28.010526315789477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.571274226655564, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.29638814330101, "policy_loss": -0.01317155985161662, "vf_loss": 8.323479206363361, "vf_explained_var": 0.574112024779121, "kl": 0.016273772196291277, "entropy": 2.1242694767812886, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -0.13225479874238555, "episode_reward_min": -1558.2754361656732, "episode_reward_mean": -803.5201322122198, "episode_len_mean": 133.36, "episode_media": {}, "episodes_timesteps_total": 13336, "policy_reward_min": {"policy_0": -1558.2754361656732}, "policy_reward_max": {"policy_0": -0.13225479874238555}, "policy_reward_mean": {"policy_0": -803.5201322122198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.34752386517128, -940.9674100330291, -316.18209597224563, -669.4716099510139, -1199.8219749102411, -550.3137870804711, -924.0229016454957, -96.72364526625104, -1558.2754361656732, -1036.5909393602062, -443.6304920156031, -1047.018728765809, -1399.2065167698818, -546.4936983377365, -263.80525625868677, -396.00251182016024, -891.5478805065849, -1043.3637277615906, -1300.7394674261436, -962.1230866709351, -1229.5169185191003, -647.2378168275341, -186.40791398511894, -364.0968213899457, -1201.6561759601645, -1326.0692761275798, -174.0400242147619, -1292.0970269035683, -509.80817797446565, -345.9906631442781, -681.0217216365777, -1199.9752779439177, -226.2214122651889, -106.29096519157247, -717.6628547281144, -1078.5058986997597, -1219.597826196796, -513.6697875568251, -1147.4788566789084, -1372.4312879257795, -1040.072197034979, -953.833996056932, -269.5508935551776, -893.556689181692, -1007.895330684089, -1119.859095514533, -192.97103561425874, -453.2449430886233, -1508.39476582512, -161.3672781692425, -0.13225479874238555, -770.8536587618016, -1356.3056851377717, -1315.4724401138046, -319.2107897410091, -1407.3769229178238, -1182.7126619222752, -1011.2530008265455, -1158.7737495608076, -671.0043666910199, -1065.7763162146962, -1285.498396720512, -414.6052719460257, -290.8992760282159, -303.13170128179615, -88.06095273484858, -1210.7913796250525, -1255.1386193137466, -1048.732650534723, -306.8733295157243, -1023.4903025591728, -743.0959622593876, -599.1786946996126, -1157.08068350873, -139.82721278749926, -1026.1863657040724, -1056.7052060042838, -906.1688487938345, -778.7133204707161, -601.5320564461064, -916.5173971632685, -297.2599953874373, -1489.2153280536413, -1448.143196279131, -1297.0890213756988, -998.6749770451773, -450.6772671071797, -262.3161434578581, -1350.4563099472675, -962.6844187651639, -1069.8347350802603, -993.0594862328065, -24.407212083861562, -1511.971279923499, -753.4812949146539, -843.941311870223, -470.47741629944744, -206.9625884293628, -631.1988547134608, -1037.891290294688], "episode_lengths": [57, 150, 125, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 142, 114, 146, 150, 150, 77, 150, 150, 124, 138, 150, 64, 67, 126, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 84, 118, 150, 80, 36, 135, 150, 150, 82, 150, 150, 150, 150, 143, 150, 150, 150, 144, 121, 66, 150, 150, 150, 81, 150, 134, 122, 150, 75, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 38, 150, 150, 150, 147, 65, 131, 150], "policy_policy_0_reward": [-114.34752386517128, -940.9674100330291, -316.18209597224563, -669.4716099510139, -1199.8219749102411, -550.3137870804711, -924.0229016454957, -96.72364526625104, -1558.2754361656732, -1036.5909393602062, -443.6304920156031, -1047.018728765809, -1399.2065167698818, -546.4936983377365, -263.80525625868677, -396.00251182016024, -891.5478805065849, -1043.3637277615906, -1300.7394674261436, -962.1230866709351, -1229.5169185191003, -647.2378168275341, -186.40791398511894, -364.0968213899457, -1201.6561759601645, -1326.0692761275798, -174.0400242147619, -1292.0970269035683, -509.80817797446565, -345.9906631442781, -681.0217216365777, -1199.9752779439177, -226.2214122651889, -106.29096519157247, -717.6628547281144, -1078.5058986997597, -1219.597826196796, -513.6697875568251, -1147.4788566789084, -1372.4312879257795, -1040.072197034979, -953.833996056932, -269.5508935551776, -893.556689181692, -1007.895330684089, -1119.859095514533, -192.97103561425874, -453.2449430886233, -1508.39476582512, -161.3672781692425, -0.13225479874238555, -770.8536587618016, -1356.3056851377717, -1315.4724401138046, -319.2107897410091, -1407.3769229178238, -1182.7126619222752, -1011.2530008265455, -1158.7737495608076, -671.0043666910199, -1065.7763162146962, -1285.498396720512, -414.6052719460257, -290.8992760282159, -303.13170128179615, -88.06095273484858, -1210.7913796250525, -1255.1386193137466, -1048.732650534723, -306.8733295157243, -1023.4903025591728, -743.0959622593876, -599.1786946996126, -1157.08068350873, -139.82721278749926, -1026.1863657040724, -1056.7052060042838, -906.1688487938345, -778.7133204707161, -601.5320564461064, -916.5173971632685, -297.2599953874373, -1489.2153280536413, -1448.143196279131, -1297.0890213756988, -998.6749770451773, -450.6772671071797, -262.3161434578581, -1350.4563099472675, -962.6844187651639, -1069.8347350802603, -993.0594862328065, -24.407212083861562, -1511.971279923499, -753.4812949146539, -843.941311870223, -470.47741629944744, -206.9625884293628, -631.1988547134608, -1037.891290294688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554900124950785, "mean_inference_ms": 1.6772823402323227, "mean_action_processing_ms": 0.2766626090070066, "mean_env_wait_ms": 3.5626006682051257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011896848678588867, "StateBufferConnector_ms": 0.00803518295288086, "ViewRequirementAgentConnector_ms": 0.19139647483825684}, "num_episodes": 29, "episode_return_max": -0.13225479874238555, "episode_return_min": -1558.2754361656732, "episode_return_mean": -803.5201322122198, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.73550553774317, "num_env_steps_trained_throughput_per_sec": 304.73550553774317, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12583.897, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12583.819, "sample_time_ms": 1182.046, "learn_time_ms": 11336.325, "learn_throughput": 352.848, "synch_weights_time_ms": 64.647}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00011", "date": "2024-08-04_06-33-43", "timestamp": 1722733423, "time_this_iter_s": 13.13823390007019, "time_total_s": 274.62131237983704, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fbb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 274.62131237983704, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.363157894736837, "ram_util_percent": 28.094736842105267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.092444839080176, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.042152722676596, "policy_loss": -0.011878875239441792, "vf_loss": 8.065750888983409, "vf_explained_var": 0.653165377303958, "kl": 0.017352037636616538, "entropy": 1.9527691216518481, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -0.13225479874238555, "episode_reward_min": -1511.971279923499, "episode_reward_mean": -775.2965954590104, "episode_len_mean": 131.3, "episode_media": {}, "episodes_timesteps_total": 13130, "policy_reward_min": {"policy_0": -1511.971279923499}, "policy_reward_max": {"policy_0": -0.13225479874238555}, "policy_reward_mean": {"policy_0": -775.2965954590104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-681.0217216365777, -1199.9752779439177, -226.2214122651889, -106.29096519157247, -717.6628547281144, -1078.5058986997597, -1219.597826196796, -513.6697875568251, -1147.4788566789084, -1372.4312879257795, -1040.072197034979, -953.833996056932, -269.5508935551776, -893.556689181692, -1007.895330684089, -1119.859095514533, -192.97103561425874, -453.2449430886233, -1508.39476582512, -161.3672781692425, -0.13225479874238555, -770.8536587618016, -1356.3056851377717, -1315.4724401138046, -319.2107897410091, -1407.3769229178238, -1182.7126619222752, -1011.2530008265455, -1158.7737495608076, -671.0043666910199, -1065.7763162146962, -1285.498396720512, -414.6052719460257, -290.8992760282159, -303.13170128179615, -88.06095273484858, -1210.7913796250525, -1255.1386193137466, -1048.732650534723, -306.8733295157243, -1023.4903025591728, -743.0959622593876, -599.1786946996126, -1157.08068350873, -139.82721278749926, -1026.1863657040724, -1056.7052060042838, -906.1688487938345, -778.7133204707161, -601.5320564461064, -916.5173971632685, -297.2599953874373, -1489.2153280536413, -1448.143196279131, -1297.0890213756988, -998.6749770451773, -450.6772671071797, -262.3161434578581, -1350.4563099472675, -962.6844187651639, -1069.8347350802603, -993.0594862328065, -24.407212083861562, -1511.971279923499, -753.4812949146539, -843.941311870223, -470.47741629944744, -206.9625884293628, -631.1988547134608, -1037.891290294688, -1067.2575885734423, -585.9023245543373, -817.7097739391544, -849.6877519674358, -149.1157638555032, -250.94471294521293, -975.8943769949649, -227.41330749239623, -297.43128344754234, -464.650751328549, -328.90394914303334, -1311.6499117707208, -889.3310742334481, -230.9410639364582, -378.6258382439931, -631.8715033753485, -1397.8255793711685, -1092.8571445084795, -1162.111452720016, -551.6995751428454, -224.97513172594884, -1184.0991429959108, -846.9745966412546, -541.8138308830112, -123.54544940227532, -901.7441627682977, -90.41983934126701, -508.4752131535829, -1126.4517074237797, -944.8920284291331], "episode_lengths": [138, 150, 64, 67, 126, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 84, 118, 150, 80, 36, 135, 150, 150, 82, 150, 150, 150, 150, 143, 150, 150, 150, 144, 121, 66, 150, 150, 150, 81, 150, 134, 122, 150, 75, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 38, 150, 150, 150, 147, 65, 131, 150, 150, 150, 144, 138, 85, 121, 150, 73, 126, 150, 120, 150, 150, 78, 150, 150, 150, 150, 150, 150, 69, 150, 150, 120, 66, 150, 67, 106, 150, 150], "policy_policy_0_reward": [-681.0217216365777, -1199.9752779439177, -226.2214122651889, -106.29096519157247, -717.6628547281144, -1078.5058986997597, -1219.597826196796, -513.6697875568251, -1147.4788566789084, -1372.4312879257795, -1040.072197034979, -953.833996056932, -269.5508935551776, -893.556689181692, -1007.895330684089, -1119.859095514533, -192.97103561425874, -453.2449430886233, -1508.39476582512, -161.3672781692425, -0.13225479874238555, -770.8536587618016, -1356.3056851377717, -1315.4724401138046, -319.2107897410091, -1407.3769229178238, -1182.7126619222752, -1011.2530008265455, -1158.7737495608076, -671.0043666910199, -1065.7763162146962, -1285.498396720512, -414.6052719460257, -290.8992760282159, -303.13170128179615, -88.06095273484858, -1210.7913796250525, -1255.1386193137466, -1048.732650534723, -306.8733295157243, -1023.4903025591728, -743.0959622593876, -599.1786946996126, -1157.08068350873, -139.82721278749926, -1026.1863657040724, -1056.7052060042838, -906.1688487938345, -778.7133204707161, -601.5320564461064, -916.5173971632685, -297.2599953874373, -1489.2153280536413, -1448.143196279131, -1297.0890213756988, -998.6749770451773, -450.6772671071797, -262.3161434578581, -1350.4563099472675, -962.6844187651639, -1069.8347350802603, -993.0594862328065, -24.407212083861562, -1511.971279923499, -753.4812949146539, -843.941311870223, -470.47741629944744, -206.9625884293628, -631.1988547134608, -1037.891290294688, -1067.2575885734423, -585.9023245543373, -817.7097739391544, -849.6877519674358, -149.1157638555032, -250.94471294521293, -975.8943769949649, -227.41330749239623, -297.43128344754234, -464.650751328549, -328.90394914303334, -1311.6499117707208, -889.3310742334481, -230.9410639364582, -378.6258382439931, -631.8715033753485, -1397.8255793711685, -1092.8571445084795, -1162.111452720016, -551.6995751428454, -224.97513172594884, -1184.0991429959108, -846.9745966412546, -541.8138308830112, -123.54544940227532, -901.7441627682977, -90.41983934126701, -508.4752131535829, -1126.4517074237797, -944.8920284291331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546079698757755, "mean_inference_ms": 1.6779827696422194, "mean_action_processing_ms": 0.2768574541107983, "mean_env_wait_ms": 3.565308141764699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012149810791015625, "StateBufferConnector_ms": 0.00801229476928711, "ViewRequirementAgentConnector_ms": 0.19365358352661133}, "num_episodes": 30, "episode_return_max": -0.13225479874238555, "episode_return_min": -1511.971279923499, "episode_return_mean": -775.2965954590104, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.9846598651627, "num_env_steps_trained_throughput_per_sec": 308.9846598651627, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12606.619, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12606.542, "sample_time_ms": 1178.876, "learn_time_ms": 11361.12, "learn_throughput": 352.078, "synch_weights_time_ms": 65.741}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00011", "date": "2024-08-04_06-33-56", "timestamp": 1722733436, "time_this_iter_s": 12.95812177658081, "time_total_s": 287.57943415641785, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091db40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.57943415641785, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.55, "ram_util_percent": 28.09444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.475822566449644, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.497675272325674, "policy_loss": -0.01409457909273139, "vf_loss": 8.526739109059175, "vf_explained_var": 0.6419755226622025, "kl": 0.016402476641057272, "entropy": 2.2350375721851985, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -24.407212083861562, "episode_reward_min": -1511.971279923499, "episode_reward_mean": -767.068963392479, "episode_len_mean": 134.12, "episode_media": {}, "episodes_timesteps_total": 13412, "policy_reward_min": {"policy_0": -1511.971279923499}, "policy_reward_max": {"policy_0": -24.407212083861562}, "policy_reward_mean": {"policy_0": -767.068963392479}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-671.0043666910199, -1065.7763162146962, -1285.498396720512, -414.6052719460257, -290.8992760282159, -303.13170128179615, -88.06095273484858, -1210.7913796250525, -1255.1386193137466, -1048.732650534723, -306.8733295157243, -1023.4903025591728, -743.0959622593876, -599.1786946996126, -1157.08068350873, -139.82721278749926, -1026.1863657040724, -1056.7052060042838, -906.1688487938345, -778.7133204707161, -601.5320564461064, -916.5173971632685, -297.2599953874373, -1489.2153280536413, -1448.143196279131, -1297.0890213756988, -998.6749770451773, -450.6772671071797, -262.3161434578581, -1350.4563099472675, -962.6844187651639, -1069.8347350802603, -993.0594862328065, -24.407212083861562, -1511.971279923499, -753.4812949146539, -843.941311870223, -470.47741629944744, -206.9625884293628, -631.1988547134608, -1037.891290294688, -1067.2575885734423, -585.9023245543373, -817.7097739391544, -849.6877519674358, -149.1157638555032, -250.94471294521293, -975.8943769949649, -227.41330749239623, -297.43128344754234, -464.650751328549, -328.90394914303334, -1311.6499117707208, -889.3310742334481, -230.9410639364582, -378.6258382439931, -631.8715033753485, -1397.8255793711685, -1092.8571445084795, -1162.111452720016, -551.6995751428454, -224.97513172594884, -1184.0991429959108, -846.9745966412546, -541.8138308830112, -123.54544940227532, -901.7441627682977, -90.41983934126701, -508.4752131535829, -1126.4517074237797, -944.8920284291331, -372.7585025106911, -630.5911723767443, -153.87062319456004, -878.168437694543, -672.1899076911693, -1076.2112768776421, -632.2454368131256, -539.4439522026253, -1089.6731958695066, -940.663203313182, -984.2084304302296, -1342.1417391749987, -1104.5027298904638, -198.67254326390432, -640.4608722761113, -285.46911390493113, -1368.000070702498, -1177.6355783674103, -1467.0901215282645, -844.8793509342487, -854.6024081775022, -1149.2016994958528, -169.93352634578332, -1131.1338354688692, -1136.24876245662, -799.7097293475217, -448.7886902097656, -495.3180146030164, -979.1171455537399], "episode_lengths": [143, 150, 150, 150, 144, 121, 66, 150, 150, 150, 81, 150, 134, 122, 150, 75, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 38, 150, 150, 150, 147, 65, 131, 150, 150, 150, 144, 138, 85, 121, 150, 73, 126, 150, 120, 150, 150, 78, 150, 150, 150, 150, 150, 150, 69, 150, 150, 120, 66, 150, 67, 106, 150, 150, 150, 150, 85, 150, 150, 150, 144, 120, 150, 150, 150, 150, 150, 59, 150, 81, 150, 150, 150, 150, 150, 150, 71, 150, 150, 146, 150, 150, 150], "policy_policy_0_reward": [-671.0043666910199, -1065.7763162146962, -1285.498396720512, -414.6052719460257, -290.8992760282159, -303.13170128179615, -88.06095273484858, -1210.7913796250525, -1255.1386193137466, -1048.732650534723, -306.8733295157243, -1023.4903025591728, -743.0959622593876, -599.1786946996126, -1157.08068350873, -139.82721278749926, -1026.1863657040724, -1056.7052060042838, -906.1688487938345, -778.7133204707161, -601.5320564461064, -916.5173971632685, -297.2599953874373, -1489.2153280536413, -1448.143196279131, -1297.0890213756988, -998.6749770451773, -450.6772671071797, -262.3161434578581, -1350.4563099472675, -962.6844187651639, -1069.8347350802603, -993.0594862328065, -24.407212083861562, -1511.971279923499, -753.4812949146539, -843.941311870223, -470.47741629944744, -206.9625884293628, -631.1988547134608, -1037.891290294688, -1067.2575885734423, -585.9023245543373, -817.7097739391544, -849.6877519674358, -149.1157638555032, -250.94471294521293, -975.8943769949649, -227.41330749239623, -297.43128344754234, -464.650751328549, -328.90394914303334, -1311.6499117707208, -889.3310742334481, -230.9410639364582, -378.6258382439931, -631.8715033753485, -1397.8255793711685, -1092.8571445084795, -1162.111452720016, -551.6995751428454, -224.97513172594884, -1184.0991429959108, -846.9745966412546, -541.8138308830112, -123.54544940227532, -901.7441627682977, -90.41983934126701, -508.4752131535829, -1126.4517074237797, -944.8920284291331, -372.7585025106911, -630.5911723767443, -153.87062319456004, -878.168437694543, -672.1899076911693, -1076.2112768776421, -632.2454368131256, -539.4439522026253, -1089.6731958695066, -940.663203313182, -984.2084304302296, -1342.1417391749987, -1104.5027298904638, -198.67254326390432, -640.4608722761113, -285.46911390493113, -1368.000070702498, -1177.6355783674103, -1467.0901215282645, -844.8793509342487, -854.6024081775022, -1149.2016994958528, -169.93352634578332, -1131.1338354688692, -1136.24876245662, -799.7097293475217, -448.7886902097656, -495.3180146030164, -979.1171455537399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547080801897927, "mean_inference_ms": 1.6777701934373106, "mean_action_processing_ms": 0.2770782827851926, "mean_env_wait_ms": 3.566100638886659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012309789657592773, "StateBufferConnector_ms": 0.008034944534301758, "ViewRequirementAgentConnector_ms": 0.19512462615966797}, "num_episodes": 29, "episode_return_max": -24.407212083861562, "episode_return_min": -1511.971279923499, "episode_return_mean": -767.068963392479, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.1148277272971, "num_env_steps_trained_throughput_per_sec": 421.1148277272971, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12381.099, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12381.02, "sample_time_ms": 1174.036, "learn_time_ms": 11143.696, "learn_throughput": 358.947, "synch_weights_time_ms": 62.511}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00011", "date": "2024-08-04_06-34-05", "timestamp": 1722733445, "time_this_iter_s": 9.510716915130615, "time_total_s": 297.09015107154846, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091c670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.09015107154846, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 21.107142857142858, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.92107017238935, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.246422073245048, "policy_loss": -0.01445657458777229, "vf_loss": 8.274971286952496, "vf_explained_var": 0.7107851677884658, "kl": 0.016944531924188336, "entropy": 2.1717700329919656, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -24.407212083861562, "episode_reward_min": -1511.971279923499, "episode_reward_mean": -744.9512851041768, "episode_len_mean": 133.63, "episode_media": {}, "episodes_timesteps_total": 13363, "policy_reward_min": {"policy_0": -1511.971279923499}, "policy_reward_max": {"policy_0": -24.407212083861562}, "policy_reward_mean": {"policy_0": -744.9512851041768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1069.8347350802603, -993.0594862328065, -24.407212083861562, -1511.971279923499, -753.4812949146539, -843.941311870223, -470.47741629944744, -206.9625884293628, -631.1988547134608, -1037.891290294688, -1067.2575885734423, -585.9023245543373, -817.7097739391544, -849.6877519674358, -149.1157638555032, -250.94471294521293, -975.8943769949649, -227.41330749239623, -297.43128344754234, -464.650751328549, -328.90394914303334, -1311.6499117707208, -889.3310742334481, -230.9410639364582, -378.6258382439931, -631.8715033753485, -1397.8255793711685, -1092.8571445084795, -1162.111452720016, -551.6995751428454, -224.97513172594884, -1184.0991429959108, -846.9745966412546, -541.8138308830112, -123.54544940227532, -901.7441627682977, -90.41983934126701, -508.4752131535829, -1126.4517074237797, -944.8920284291331, -372.7585025106911, -630.5911723767443, -153.87062319456004, -878.168437694543, -672.1899076911693, -1076.2112768776421, -632.2454368131256, -539.4439522026253, -1089.6731958695066, -940.663203313182, -984.2084304302296, -1342.1417391749987, -1104.5027298904638, -198.67254326390432, -640.4608722761113, -285.46911390493113, -1368.000070702498, -1177.6355783674103, -1467.0901215282645, -844.8793509342487, -854.6024081775022, -1149.2016994958528, -169.93352634578332, -1131.1338354688692, -1136.24876245662, -799.7097293475217, -448.7886902097656, -495.3180146030164, -979.1171455537399, -884.5837435637125, -1342.6918391155484, -883.3141075163976, -519.5024706382886, -322.04828894116594, -208.99022878597395, -1267.774174307981, -747.5888668604281, -1353.5110340034582, -1051.8414044987503, -748.7037641226032, -170.2410386745972, -956.2879225074809, -188.56660554724306, -632.6284117570352, -562.6498614059988, -877.7340925523746, -474.3356037413334, -601.1930654578736, -1267.521757548134, -687.0311808146756, -421.48937696893927, -706.0314221029344, -1070.02224129285, -382.3274835841293, -1295.8916012239986, -35.568623397979785, -106.17742573834332, -1059.7221348678345, -1133.1581933599234, -1274.629174693401], "episode_lengths": [150, 150, 38, 150, 150, 150, 147, 65, 131, 150, 150, 150, 144, 138, 85, 121, 150, 73, 126, 150, 120, 150, 150, 78, 150, 150, 150, 150, 150, 150, 69, 150, 150, 120, 66, 150, 67, 106, 150, 150, 150, 150, 85, 150, 150, 150, 144, 120, 150, 150, 150, 150, 150, 59, 150, 81, 150, 150, 150, 150, 150, 150, 71, 150, 150, 146, 150, 150, 150, 150, 150, 150, 114, 130, 106, 150, 150, 150, 150, 150, 88, 150, 93, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 51, 60, 150, 150, 150], "policy_policy_0_reward": [-1069.8347350802603, -993.0594862328065, -24.407212083861562, -1511.971279923499, -753.4812949146539, -843.941311870223, -470.47741629944744, -206.9625884293628, -631.1988547134608, -1037.891290294688, -1067.2575885734423, -585.9023245543373, -817.7097739391544, -849.6877519674358, -149.1157638555032, -250.94471294521293, -975.8943769949649, -227.41330749239623, -297.43128344754234, -464.650751328549, -328.90394914303334, -1311.6499117707208, -889.3310742334481, -230.9410639364582, -378.6258382439931, -631.8715033753485, -1397.8255793711685, -1092.8571445084795, -1162.111452720016, -551.6995751428454, -224.97513172594884, -1184.0991429959108, -846.9745966412546, -541.8138308830112, -123.54544940227532, -901.7441627682977, -90.41983934126701, -508.4752131535829, -1126.4517074237797, -944.8920284291331, -372.7585025106911, -630.5911723767443, -153.87062319456004, -878.168437694543, -672.1899076911693, -1076.2112768776421, -632.2454368131256, -539.4439522026253, -1089.6731958695066, -940.663203313182, -984.2084304302296, -1342.1417391749987, -1104.5027298904638, -198.67254326390432, -640.4608722761113, -285.46911390493113, -1368.000070702498, -1177.6355783674103, -1467.0901215282645, -844.8793509342487, -854.6024081775022, -1149.2016994958528, -169.93352634578332, -1131.1338354688692, -1136.24876245662, -799.7097293475217, -448.7886902097656, -495.3180146030164, -979.1171455537399, -884.5837435637125, -1342.6918391155484, -883.3141075163976, -519.5024706382886, -322.04828894116594, -208.99022878597395, -1267.774174307981, -747.5888668604281, -1353.5110340034582, -1051.8414044987503, -748.7037641226032, -170.2410386745972, -956.2879225074809, -188.56660554724306, -632.6284117570352, -562.6498614059988, -877.7340925523746, -474.3356037413334, -601.1930654578736, -1267.521757548134, -687.0311808146756, -421.48937696893927, -706.0314221029344, -1070.02224129285, -382.3274835841293, -1295.8916012239986, -35.568623397979785, -106.17742573834332, -1059.7221348678345, -1133.1581933599234, -1274.629174693401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555251578329489, "mean_inference_ms": 1.678989194808168, "mean_action_processing_ms": 0.2770321703208445, "mean_env_wait_ms": 3.567794188616277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012090206146240234, "StateBufferConnector_ms": 0.008054971694946289, "ViewRequirementAgentConnector_ms": 0.19734644889831543}, "num_episodes": 31, "episode_return_max": -24.407212083861562, "episode_return_min": -1511.971279923499, "episode_return_mean": -744.9512851041768, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.1407945347605, "num_env_steps_trained_throughput_per_sec": 463.1407945347605, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 11925.336, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11925.26, "sample_time_ms": 1165.346, "learn_time_ms": 10699.163, "learn_throughput": 373.861, "synch_weights_time_ms": 59.991}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00011", "date": "2024-08-04_06-34-14", "timestamp": 1722733454, "time_this_iter_s": 8.650435447692871, "time_total_s": 305.74058651924133, "pid": 585768, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.74058651924133, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 22.400000000000002, "ram_util_percent": 28.100000000000005}}
