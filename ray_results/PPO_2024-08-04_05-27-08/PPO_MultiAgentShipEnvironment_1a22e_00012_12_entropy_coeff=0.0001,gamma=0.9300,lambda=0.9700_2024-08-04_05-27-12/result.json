{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8873259817870954, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.686235545078913, "policy_loss": -0.008677072129406346, "vf_loss": 9.692971845467886, "vf_explained_var": 0.026593650442858538, "kl": 0.010409638148250149, "entropy": 1.411528395116329, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -85.10445229349799, "episode_reward_min": -1351.3991617230663, "episode_reward_mean": -887.7808275782327, "episode_len_mean": 134.52173913043478, "episode_media": {}, "episodes_timesteps_total": 3094, "policy_reward_min": {"policy_0": -1351.3991617230663}, "policy_reward_max": {"policy_0": -85.10445229349799}, "policy_reward_mean": {"policy_0": -887.7808275782327}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1232.8193886006143, -1070.3039141541044, -216.02472510347312, -957.0744909327375, -1329.0644779551653, -923.2217708359303, -1163.9867252482734, -742.1914975692308, -258.63481986946204, -1124.2673562220457, -1105.0375017917597, -1144.3994165028198, -159.862747807765, -85.10445229349799, -1351.3991617230663, -1130.7584716588028, -1103.1757658629458, -1110.6600783220933, -204.4868133786443, -1058.9296901824578, -1133.7106773506687, -897.0098794016073, -916.8352115321873], "episode_lengths": [150, 150, 92, 150, 150, 150, 150, 150, 73, 150, 150, 150, 74, 71, 150, 150, 150, 150, 84, 150, 150, 150, 150], "policy_policy_0_reward": [-1232.8193886006143, -1070.3039141541044, -216.02472510347312, -957.0744909327375, -1329.0644779551653, -923.2217708359303, -1163.9867252482734, -742.1914975692308, -258.63481986946204, -1124.2673562220457, -1105.0375017917597, -1144.3994165028198, -159.862747807765, -85.10445229349799, -1351.3991617230663, -1130.7584716588028, -1103.1757658629458, -1110.6600783220933, -204.4868133786443, -1058.9296901824578, -1133.7106773506687, -897.0098794016073, -916.8352115321873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.575191732425544, "mean_inference_ms": 1.684066013034699, "mean_action_processing_ms": 0.28095111300877706, "mean_env_wait_ms": 3.443427208090029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012089895165484884, "StateBufferConnector_ms": 0.009764795717985733, "ViewRequirementAgentConnector_ms": 0.19223482712455417}, "num_episodes": 23, "episode_return_max": -85.10445229349799, "episode_return_min": -1351.3991617230663, "episode_return_mean": -887.7808275782327, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2875753795185, "num_env_steps_trained_throughput_per_sec": 310.2875753795185, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12891.276, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12891.213, "sample_time_ms": 1150.495, "learn_time_ms": 11659.59, "learn_throughput": 343.065, "synch_weights_time_ms": 80.38}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00012", "date": "2024-08-04_06-34-44", "timestamp": 1722733484, "time_this_iter_s": 12.9010751247406, "time_total_s": 12.9010751247406, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.9010751247406, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.58947368421052, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5803454244509338, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.594052914778391, "policy_loss": -0.010889309869768719, "vf_loss": 9.601898489395778, "vf_explained_var": 0.08087871509293715, "kl": 0.015945110706540314, "entropy": 1.4533205563823381, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -85.10445229349799, "episode_reward_min": -1351.3991617230663, "episode_reward_mean": -841.5162381590523, "episode_len_mean": 133.89583333333334, "episode_media": {}, "episodes_timesteps_total": 6427, "policy_reward_min": {"policy_0": -1351.3991617230663}, "policy_reward_max": {"policy_0": -85.10445229349799}, "policy_reward_mean": {"policy_0": -841.5162381590523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1232.8193886006143, -1070.3039141541044, -216.02472510347312, -957.0744909327375, -1329.0644779551653, -923.2217708359303, -1163.9867252482734, -742.1914975692308, -258.63481986946204, -1124.2673562220457, -1105.0375017917597, -1144.3994165028198, -159.862747807765, -85.10445229349799, -1351.3991617230663, -1130.7584716588028, -1103.1757658629458, -1110.6600783220933, -204.4868133786443, -1058.9296901824578, -1133.7106773506687, -897.0098794016073, -916.8352115321873, -1078.9855512851884, -532.7253062741148, -804.0949384192336, -279.94889736726896, -394.32504894673923, -865.2037520889975, -655.6795281517557, -122.76743875636605, -943.7552829841421, -780.2150576494741, -1103.669539288597, -1258.3032520527315, -833.9698547590157, -1212.8745554275476, -607.1357224025813, -632.9930300202217, -105.40810590052914, -502.86969891230274, -1071.0947474416025, -966.0458477047787, -1195.7988982577924, -794.439826131131, -1000.0737015410967, -1098.236276258444, -1133.2065393135015], "episode_lengths": [150, 150, 92, 150, 150, 150, 150, 150, 73, 150, 150, 150, 74, 71, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 123, 150, 79, 114, 150, 134, 53, 150, 150, 150, 150, 150, 150, 150, 129, 44, 118, 150, 150, 150, 139, 150, 150, 150], "policy_policy_0_reward": [-1232.8193886006143, -1070.3039141541044, -216.02472510347312, -957.0744909327375, -1329.0644779551653, -923.2217708359303, -1163.9867252482734, -742.1914975692308, -258.63481986946204, -1124.2673562220457, -1105.0375017917597, -1144.3994165028198, -159.862747807765, -85.10445229349799, -1351.3991617230663, -1130.7584716588028, -1103.1757658629458, -1110.6600783220933, -204.4868133786443, -1058.9296901824578, -1133.7106773506687, -897.0098794016073, -916.8352115321873, -1078.9855512851884, -532.7253062741148, -804.0949384192336, -279.94889736726896, -394.32504894673923, -865.2037520889975, -655.6795281517557, -122.76743875636605, -943.7552829841421, -780.2150576494741, -1103.669539288597, -1258.3032520527315, -833.9698547590157, -1212.8745554275476, -607.1357224025813, -632.9930300202217, -105.40810590052914, -502.86969891230274, -1071.0947474416025, -966.0458477047787, -1195.7988982577924, -794.439826131131, -1000.0737015410967, -1098.236276258444, -1133.2065393135015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5718236917553842, "mean_inference_ms": 1.6804464676252628, "mean_action_processing_ms": 0.28063762375367135, "mean_env_wait_ms": 3.4506734381485393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014001627763112387, "StateBufferConnector_ms": 0.009199480215708414, "ViewRequirementAgentConnector_ms": 0.1892934242884318}, "num_episodes": 25, "episode_return_max": -85.10445229349799, "episode_return_min": -1351.3991617230663, "episode_return_mean": -841.5162381590523, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.7400014143487, "num_env_steps_trained_throughput_per_sec": 301.7400014143487, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13073.868, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13073.798, "sample_time_ms": 1155.126, "learn_time_ms": 11843.436, "learn_throughput": 337.74, "synch_weights_time_ms": 74.482}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00012", "date": "2024-08-04_06-34-57", "timestamp": 1722733497, "time_this_iter_s": 13.26739501953125, "time_total_s": 26.16847014427185, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb9990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.16847014427185, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.36315789473684, "ram_util_percent": 27.99473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.181720523970823, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.161321907738845, "policy_loss": -0.008345403246251711, "vf_loss": 9.166592208544413, "vf_explained_var": 0.17993040438741445, "kl": 0.01610648885568177, "entropy": 1.4620391504218182, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -14.022848568884998, "episode_reward_min": -1469.7848101659833, "episode_reward_mean": -785.1449584649404, "episode_len_mean": 127.3170731707317, "episode_media": {}, "episodes_timesteps_total": 10440, "policy_reward_min": {"policy_0": -1469.7848101659833}, "policy_reward_max": {"policy_0": -14.022848568884998}, "policy_reward_mean": {"policy_0": -785.1449584649404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1232.8193886006143, -1070.3039141541044, -216.02472510347312, -957.0744909327375, -1329.0644779551653, -923.2217708359303, -1163.9867252482734, -742.1914975692308, -258.63481986946204, -1124.2673562220457, -1105.0375017917597, -1144.3994165028198, -159.862747807765, -85.10445229349799, -1351.3991617230663, -1130.7584716588028, -1103.1757658629458, -1110.6600783220933, -204.4868133786443, -1058.9296901824578, -1133.7106773506687, -897.0098794016073, -916.8352115321873, -1078.9855512851884, -532.7253062741148, -804.0949384192336, -279.94889736726896, -394.32504894673923, -865.2037520889975, -655.6795281517557, -122.76743875636605, -943.7552829841421, -780.2150576494741, -1103.669539288597, -1258.3032520527315, -833.9698547590157, -1212.8745554275476, -607.1357224025813, -632.9930300202217, -105.40810590052914, -502.86969891230274, -1071.0947474416025, -966.0458477047787, -1195.7988982577924, -794.439826131131, -1000.0737015410967, -1098.236276258444, -1133.2065393135015, -1239.0901641771059, -989.0705231928704, -1008.9956409336354, -1226.9821577016962, -154.4329732193176, -1469.7848101659833, -121.03486376353644, -851.0509253362777, -1241.8402017971343, -1159.363881335306, -1235.6057581338985, -1115.5450872673807, -1200.226268315359, -408.500777395103, -153.9141288953022, -79.94609433784632, -715.3082618689044, -288.11557074842415, -1132.8199810130784, -1061.432681460127, -1128.6401285050588, -1078.463570110232, -141.1637782497283, -352.10175726876963, -14.022848568884998, -579.0540914946952, -422.44843567416046, -138.65516686612753, -913.1900981134459, -580.7646653869425, -365.4422161197208, -220.4092492411014, -92.01813079055529, -1109.6722750428855], "episode_lengths": [150, 150, 92, 150, 150, 150, 150, 150, 73, 150, 150, 150, 74, 71, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 123, 150, 79, 114, 150, 134, 53, 150, 150, 150, 150, 150, 150, 150, 129, 44, 118, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 73, 150, 53, 150, 150, 150, 150, 150, 150, 112, 80, 67, 150, 77, 150, 150, 150, 150, 76, 86, 38, 125, 100, 55, 150, 150, 94, 64, 63, 150], "policy_policy_0_reward": [-1232.8193886006143, -1070.3039141541044, -216.02472510347312, -957.0744909327375, -1329.0644779551653, -923.2217708359303, -1163.9867252482734, -742.1914975692308, -258.63481986946204, -1124.2673562220457, -1105.0375017917597, -1144.3994165028198, -159.862747807765, -85.10445229349799, -1351.3991617230663, -1130.7584716588028, -1103.1757658629458, -1110.6600783220933, -204.4868133786443, -1058.9296901824578, -1133.7106773506687, -897.0098794016073, -916.8352115321873, -1078.9855512851884, -532.7253062741148, -804.0949384192336, -279.94889736726896, -394.32504894673923, -865.2037520889975, -655.6795281517557, -122.76743875636605, -943.7552829841421, -780.2150576494741, -1103.669539288597, -1258.3032520527315, -833.9698547590157, -1212.8745554275476, -607.1357224025813, -632.9930300202217, -105.40810590052914, -502.86969891230274, -1071.0947474416025, -966.0458477047787, -1195.7988982577924, -794.439826131131, -1000.0737015410967, -1098.236276258444, -1133.2065393135015, -1239.0901641771059, -989.0705231928704, -1008.9956409336354, -1226.9821577016962, -154.4329732193176, -1469.7848101659833, -121.03486376353644, -851.0509253362777, -1241.8402017971343, -1159.363881335306, -1235.6057581338985, -1115.5450872673807, -1200.226268315359, -408.500777395103, -153.9141288953022, -79.94609433784632, -715.3082618689044, -288.11557074842415, -1132.8199810130784, -1061.432681460127, -1128.6401285050588, -1078.463570110232, -141.1637782497283, -352.10175726876963, -14.022848568884998, -579.0540914946952, -422.44843567416046, -138.65516686612753, -913.1900981134459, -580.7646653869425, -365.4422161197208, -220.4092492411014, -92.01813079055529, -1109.6722750428855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5704451516722965, "mean_inference_ms": 1.6816254914079003, "mean_action_processing_ms": 0.28084754153533587, "mean_env_wait_ms": 3.4568442806502246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013541303029874475, "StateBufferConnector_ms": 0.009014257570592368, "ViewRequirementAgentConnector_ms": 0.19094856773934712}, "num_episodes": 34, "episode_return_max": -14.022848568884998, "episode_return_min": -1469.7848101659833, "episode_return_mean": -785.1449584649404, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.5576546124329, "num_env_steps_trained_throughput_per_sec": 303.5576546124329, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13108.273, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13108.195, "sample_time_ms": 1147.591, "learn_time_ms": 11890.273, "learn_throughput": 336.409, "synch_weights_time_ms": 69.565}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00012", "date": "2024-08-04_06-35-11", "timestamp": 1722733511, "time_this_iter_s": 13.188311100006104, "time_total_s": 39.356781244277954, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fbbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.356781244277954, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.25263157894737, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.5184448312968, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.564684225122134, "policy_loss": -0.009485420694788142, "vf_loss": 8.571470563113689, "vf_explained_var": 0.4090597596019506, "kl": 0.014229563481118626, "entropy": 1.4682518529395263, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -7.054085525350634, "episode_reward_min": -1469.7848101659833, "episode_reward_mean": -743.5344101539512, "episode_len_mean": 126.14, "episode_media": {}, "episodes_timesteps_total": 12614, "policy_reward_min": {"policy_0": -1469.7848101659833}, "policy_reward_max": {"policy_0": -7.054085525350634}, "policy_reward_mean": {"policy_0": -743.5344101539512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.10445229349799, -1351.3991617230663, -1130.7584716588028, -1103.1757658629458, -1110.6600783220933, -204.4868133786443, -1058.9296901824578, -1133.7106773506687, -897.0098794016073, -916.8352115321873, -1078.9855512851884, -532.7253062741148, -804.0949384192336, -279.94889736726896, -394.32504894673923, -865.2037520889975, -655.6795281517557, -122.76743875636605, -943.7552829841421, -780.2150576494741, -1103.669539288597, -1258.3032520527315, -833.9698547590157, -1212.8745554275476, -607.1357224025813, -632.9930300202217, -105.40810590052914, -502.86969891230274, -1071.0947474416025, -966.0458477047787, -1195.7988982577924, -794.439826131131, -1000.0737015410967, -1098.236276258444, -1133.2065393135015, -1239.0901641771059, -989.0705231928704, -1008.9956409336354, -1226.9821577016962, -154.4329732193176, -1469.7848101659833, -121.03486376353644, -851.0509253362777, -1241.8402017971343, -1159.363881335306, -1235.6057581338985, -1115.5450872673807, -1200.226268315359, -408.500777395103, -153.9141288953022, -79.94609433784632, -715.3082618689044, -288.11557074842415, -1132.8199810130784, -1061.432681460127, -1128.6401285050588, -1078.463570110232, -141.1637782497283, -352.10175726876963, -14.022848568884998, -579.0540914946952, -422.44843567416046, -138.65516686612753, -913.1900981134459, -580.7646653869425, -365.4422161197208, -220.4092492411014, -92.01813079055529, -1109.6722750428855, -266.27994504254286, -163.46197499539377, -525.523564497032, -827.4596437403073, -755.786834531473, -893.8905503276103, -1143.0977803596058, -113.72986818177543, -1107.771432943062, -1432.3355107543896, -1022.0369999080423, -824.814228933433, -242.08094256254566, -702.3936933164156, -719.1430241818515, -73.50247647134638, -498.32922949944316, -521.2808906828458, -437.44418792660036, -7.054085525350634, -1090.6831707942313, -962.4420544664874, -1225.8474936518887, -994.3669707591098, -558.2105362880735, -722.1100169439819, -78.25975051760987, -1154.8898459180689, -481.49153749160484, -1447.8210541373287, -404.9039585139472], "episode_lengths": [71, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 123, 150, 79, 114, 150, 134, 53, 150, 150, 150, 150, 150, 150, 150, 129, 44, 118, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 73, 150, 53, 150, 150, 150, 150, 150, 150, 112, 80, 67, 150, 77, 150, 150, 150, 150, 76, 86, 38, 125, 100, 55, 150, 150, 94, 64, 63, 150, 86, 61, 130, 150, 150, 150, 150, 62, 150, 150, 150, 150, 93, 150, 150, 50, 150, 131, 112, 34, 150, 150, 150, 150, 113, 134, 57, 150, 150, 150, 150], "policy_policy_0_reward": [-85.10445229349799, -1351.3991617230663, -1130.7584716588028, -1103.1757658629458, -1110.6600783220933, -204.4868133786443, -1058.9296901824578, -1133.7106773506687, -897.0098794016073, -916.8352115321873, -1078.9855512851884, -532.7253062741148, -804.0949384192336, -279.94889736726896, -394.32504894673923, -865.2037520889975, -655.6795281517557, -122.76743875636605, -943.7552829841421, -780.2150576494741, -1103.669539288597, -1258.3032520527315, -833.9698547590157, -1212.8745554275476, -607.1357224025813, -632.9930300202217, -105.40810590052914, -502.86969891230274, -1071.0947474416025, -966.0458477047787, -1195.7988982577924, -794.439826131131, -1000.0737015410967, -1098.236276258444, -1133.2065393135015, -1239.0901641771059, -989.0705231928704, -1008.9956409336354, -1226.9821577016962, -154.4329732193176, -1469.7848101659833, -121.03486376353644, -851.0509253362777, -1241.8402017971343, -1159.363881335306, -1235.6057581338985, -1115.5450872673807, -1200.226268315359, -408.500777395103, -153.9141288953022, -79.94609433784632, -715.3082618689044, -288.11557074842415, -1132.8199810130784, -1061.432681460127, -1128.6401285050588, -1078.463570110232, -141.1637782497283, -352.10175726876963, -14.022848568884998, -579.0540914946952, -422.44843567416046, -138.65516686612753, -913.1900981134459, -580.7646653869425, -365.4422161197208, -220.4092492411014, -92.01813079055529, -1109.6722750428855, -266.27994504254286, -163.46197499539377, -525.523564497032, -827.4596437403073, -755.786834531473, -893.8905503276103, -1143.0977803596058, -113.72986818177543, -1107.771432943062, -1432.3355107543896, -1022.0369999080423, -824.814228933433, -242.08094256254566, -702.3936933164156, -719.1430241818515, -73.50247647134638, -498.32922949944316, -521.2808906828458, -437.44418792660036, -7.054085525350634, -1090.6831707942313, -962.4420544664874, -1225.8474936518887, -994.3669707591098, -558.2105362880735, -722.1100169439819, -78.25975051760987, -1154.8898459180689, -481.49153749160484, -1447.8210541373287, -404.9039585139472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5676733896904276, "mean_inference_ms": 1.6802803805868334, "mean_action_processing_ms": 0.28028297826400156, "mean_env_wait_ms": 3.4550778390335926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013735771179199219, "StateBufferConnector_ms": 0.009063720703125, "ViewRequirementAgentConnector_ms": 0.20139455795288086}, "num_episodes": 31, "episode_return_max": -7.054085525350634, "episode_return_min": -1469.7848101659833, "episode_return_mean": -743.5344101539512, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.55339205571016, "num_env_steps_trained_throughput_per_sec": 314.55339205571016, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13010.318, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13010.244, "sample_time_ms": 1145.858, "learn_time_ms": 11793.682, "learn_throughput": 339.165, "synch_weights_time_ms": 69.896}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00012", "date": "2024-08-04_06-35-23", "timestamp": 1722733523, "time_this_iter_s": 12.728693008422852, "time_total_s": 52.085474252700806, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb9ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.085474252700806, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.650000000000002, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.317132537066936, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.64029893130064, "policy_loss": -0.010436163937750582, "vf_loss": 8.64741384088993, "vf_explained_var": 0.5637577508265773, "kl": 0.01736757441067312, "entropy": 1.522363338743647, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -7.054085525350634, "episode_reward_min": -1469.7848101659833, "episode_reward_mean": -726.1781898761816, "episode_len_mean": 123.54, "episode_media": {}, "episodes_timesteps_total": 12354, "policy_reward_min": {"policy_0": -1469.7848101659833}, "policy_reward_max": {"policy_0": -7.054085525350634}, "policy_reward_mean": {"policy_0": -726.1781898761816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-966.0458477047787, -1195.7988982577924, -794.439826131131, -1000.0737015410967, -1098.236276258444, -1133.2065393135015, -1239.0901641771059, -989.0705231928704, -1008.9956409336354, -1226.9821577016962, -154.4329732193176, -1469.7848101659833, -121.03486376353644, -851.0509253362777, -1241.8402017971343, -1159.363881335306, -1235.6057581338985, -1115.5450872673807, -1200.226268315359, -408.500777395103, -153.9141288953022, -79.94609433784632, -715.3082618689044, -288.11557074842415, -1132.8199810130784, -1061.432681460127, -1128.6401285050588, -1078.463570110232, -141.1637782497283, -352.10175726876963, -14.022848568884998, -579.0540914946952, -422.44843567416046, -138.65516686612753, -913.1900981134459, -580.7646653869425, -365.4422161197208, -220.4092492411014, -92.01813079055529, -1109.6722750428855, -266.27994504254286, -163.46197499539377, -525.523564497032, -827.4596437403073, -755.786834531473, -893.8905503276103, -1143.0977803596058, -113.72986818177543, -1107.771432943062, -1432.3355107543896, -1022.0369999080423, -824.814228933433, -242.08094256254566, -702.3936933164156, -719.1430241818515, -73.50247647134638, -498.32922949944316, -521.2808906828458, -437.44418792660036, -7.054085525350634, -1090.6831707942313, -962.4420544664874, -1225.8474936518887, -994.3669707591098, -558.2105362880735, -722.1100169439819, -78.25975051760987, -1154.8898459180689, -481.49153749160484, -1447.8210541373287, -404.9039585139472, -1178.6898190164536, -1111.5207517815563, -723.1735129138455, -410.4384818263872, -343.6926042706881, -252.97013562294296, -1102.6272237045575, -369.66937169442474, -129.5765752875399, -1027.9150701692713, -21.17265648661789, -824.5030291813459, -775.9821192568294, -894.1082587251724, -957.1475022037897, -940.846412539677, -1139.20123850321, -939.5852617536929, -26.72725535443128, -20.61415643416172, -710.4068483714767, -124.50134403951701, -822.5254473535072, -1173.7090762102443, -1152.0897901401022, -1460.5526925619533, -23.712919964625907, -1391.7215179573154, -993.0864087320755], "episode_lengths": [150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 73, 150, 53, 150, 150, 150, 150, 150, 150, 112, 80, 67, 150, 77, 150, 150, 150, 150, 76, 86, 38, 125, 100, 55, 150, 150, 94, 64, 63, 150, 86, 61, 130, 150, 150, 150, 150, 62, 150, 150, 150, 150, 93, 150, 150, 50, 150, 131, 112, 34, 150, 150, 150, 150, 113, 134, 57, 150, 150, 150, 150, 150, 150, 150, 100, 135, 68, 150, 95, 74, 150, 48, 150, 150, 150, 150, 150, 150, 150, 45, 36, 135, 61, 150, 150, 150, 150, 42, 150, 150], "policy_policy_0_reward": [-966.0458477047787, -1195.7988982577924, -794.439826131131, -1000.0737015410967, -1098.236276258444, -1133.2065393135015, -1239.0901641771059, -989.0705231928704, -1008.9956409336354, -1226.9821577016962, -154.4329732193176, -1469.7848101659833, -121.03486376353644, -851.0509253362777, -1241.8402017971343, -1159.363881335306, -1235.6057581338985, -1115.5450872673807, -1200.226268315359, -408.500777395103, -153.9141288953022, -79.94609433784632, -715.3082618689044, -288.11557074842415, -1132.8199810130784, -1061.432681460127, -1128.6401285050588, -1078.463570110232, -141.1637782497283, -352.10175726876963, -14.022848568884998, -579.0540914946952, -422.44843567416046, -138.65516686612753, -913.1900981134459, -580.7646653869425, -365.4422161197208, -220.4092492411014, -92.01813079055529, -1109.6722750428855, -266.27994504254286, -163.46197499539377, -525.523564497032, -827.4596437403073, -755.786834531473, -893.8905503276103, -1143.0977803596058, -113.72986818177543, -1107.771432943062, -1432.3355107543896, -1022.0369999080423, -824.814228933433, -242.08094256254566, -702.3936933164156, -719.1430241818515, -73.50247647134638, -498.32922949944316, -521.2808906828458, -437.44418792660036, -7.054085525350634, -1090.6831707942313, -962.4420544664874, -1225.8474936518887, -994.3669707591098, -558.2105362880735, -722.1100169439819, -78.25975051760987, -1154.8898459180689, -481.49153749160484, -1447.8210541373287, -404.9039585139472, -1178.6898190164536, -1111.5207517815563, -723.1735129138455, -410.4384818263872, -343.6926042706881, -252.97013562294296, -1102.6272237045575, -369.66937169442474, -129.5765752875399, -1027.9150701692713, -21.17265648661789, -824.5030291813459, -775.9821192568294, -894.1082587251724, -957.1475022037897, -940.846412539677, -1139.20123850321, -939.5852617536929, -26.72725535443128, -20.61415643416172, -710.4068483714767, -124.50134403951701, -822.5254473535072, -1173.7090762102443, -1152.0897901401022, -1460.5526925619533, -23.712919964625907, -1391.7215179573154, -993.0864087320755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5682220002723177, "mean_inference_ms": 1.684454170675408, "mean_action_processing_ms": 0.28094689955301544, "mean_env_wait_ms": 3.4741165235356033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013381242752075195, "StateBufferConnector_ms": 0.008841753005981445, "ViewRequirementAgentConnector_ms": 0.2114253044128418}, "num_episodes": 29, "episode_return_max": -7.054085525350634, "episode_return_min": -1469.7848101659833, "episode_return_mean": -726.1781898761816, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.04825811516525, "num_env_steps_trained_throughput_per_sec": 307.04825811516525, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13013.711, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13013.636, "sample_time_ms": 1163.454, "learn_time_ms": 11777.452, "learn_throughput": 339.632, "synch_weights_time_ms": 71.921}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00012", "date": "2024-08-04_06-35-37", "timestamp": 1722733537, "time_this_iter_s": 13.040138721466064, "time_total_s": 65.12561297416687, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.12561297416687, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.794444444444444, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.555019813776017, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.3791399220625555, "policy_loss": -0.00896176897949772, "vf_loss": 7.384816399713357, "vf_explained_var": 0.6862838834524154, "kl": 0.017158012181425875, "entropy": 1.463277837013205, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -7.054085525350634, "episode_reward_min": -1460.5526925619533, "episode_reward_mean": -712.7258994897712, "episode_len_mean": 124.98, "episode_media": {}, "episodes_timesteps_total": 12498, "policy_reward_min": {"policy_0": -1460.5526925619533}, "policy_reward_max": {"policy_0": -7.054085525350634}, "policy_reward_mean": {"policy_0": -712.7258994897712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-580.7646653869425, -365.4422161197208, -220.4092492411014, -92.01813079055529, -1109.6722750428855, -266.27994504254286, -163.46197499539377, -525.523564497032, -827.4596437403073, -755.786834531473, -893.8905503276103, -1143.0977803596058, -113.72986818177543, -1107.771432943062, -1432.3355107543896, -1022.0369999080423, -824.814228933433, -242.08094256254566, -702.3936933164156, -719.1430241818515, -73.50247647134638, -498.32922949944316, -521.2808906828458, -437.44418792660036, -7.054085525350634, -1090.6831707942313, -962.4420544664874, -1225.8474936518887, -994.3669707591098, -558.2105362880735, -722.1100169439819, -78.25975051760987, -1154.8898459180689, -481.49153749160484, -1447.8210541373287, -404.9039585139472, -1178.6898190164536, -1111.5207517815563, -723.1735129138455, -410.4384818263872, -343.6926042706881, -252.97013562294296, -1102.6272237045575, -369.66937169442474, -129.5765752875399, -1027.9150701692713, -21.17265648661789, -824.5030291813459, -775.9821192568294, -894.1082587251724, -957.1475022037897, -940.846412539677, -1139.20123850321, -939.5852617536929, -26.72725535443128, -20.61415643416172, -710.4068483714767, -124.50134403951701, -822.5254473535072, -1173.7090762102443, -1152.0897901401022, -1460.5526925619533, -23.712919964625907, -1391.7215179573154, -993.0864087320755, -998.8631098075841, -138.64478258711702, -925.5933054523512, -998.0589320369359, -1020.0838058949797, -257.66900649750625, -278.9306259376853, -1144.3009059754638, -1403.5408372119682, -28.093714257076307, -1228.3887141913735, -280.7436434710978, -1302.2032243582123, -1153.0732323406246, -921.7466592784154, -601.090697329623, -561.6049909912939, -375.38145129900226, -820.0787758075138, -1076.1486020782772, -1198.4034657074044, -258.32043953083166, -740.8116404526334, -243.91678502527333, -14.23073074713365, -1141.0330709466143, -789.3223159057171, -520.3002922386205, -357.00061071555643, -930.7313921708891, -1351.712781980021, -553.5917172361526, -869.5487720349078, -1039.2872789384965, -940.9223660407636], "episode_lengths": [150, 94, 64, 63, 150, 86, 61, 130, 150, 150, 150, 150, 62, 150, 150, 150, 150, 93, 150, 150, 50, 150, 131, 112, 34, 150, 150, 150, 150, 113, 134, 57, 150, 150, 150, 150, 150, 150, 150, 100, 135, 68, 150, 95, 74, 150, 48, 150, 150, 150, 150, 150, 150, 150, 45, 36, 135, 61, 150, 150, 150, 150, 42, 150, 150, 150, 52, 150, 150, 150, 74, 102, 150, 150, 49, 150, 86, 150, 150, 150, 150, 150, 92, 140, 150, 150, 86, 138, 70, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-580.7646653869425, -365.4422161197208, -220.4092492411014, -92.01813079055529, -1109.6722750428855, -266.27994504254286, -163.46197499539377, -525.523564497032, -827.4596437403073, -755.786834531473, -893.8905503276103, -1143.0977803596058, -113.72986818177543, -1107.771432943062, -1432.3355107543896, -1022.0369999080423, -824.814228933433, -242.08094256254566, -702.3936933164156, -719.1430241818515, -73.50247647134638, -498.32922949944316, -521.2808906828458, -437.44418792660036, -7.054085525350634, -1090.6831707942313, -962.4420544664874, -1225.8474936518887, -994.3669707591098, -558.2105362880735, -722.1100169439819, -78.25975051760987, -1154.8898459180689, -481.49153749160484, -1447.8210541373287, -404.9039585139472, -1178.6898190164536, -1111.5207517815563, -723.1735129138455, -410.4384818263872, -343.6926042706881, -252.97013562294296, -1102.6272237045575, -369.66937169442474, -129.5765752875399, -1027.9150701692713, -21.17265648661789, -824.5030291813459, -775.9821192568294, -894.1082587251724, -957.1475022037897, -940.846412539677, -1139.20123850321, -939.5852617536929, -26.72725535443128, -20.61415643416172, -710.4068483714767, -124.50134403951701, -822.5254473535072, -1173.7090762102443, -1152.0897901401022, -1460.5526925619533, -23.712919964625907, -1391.7215179573154, -993.0864087320755, -998.8631098075841, -138.64478258711702, -925.5933054523512, -998.0589320369359, -1020.0838058949797, -257.66900649750625, -278.9306259376853, -1144.3009059754638, -1403.5408372119682, -28.093714257076307, -1228.3887141913735, -280.7436434710978, -1302.2032243582123, -1153.0732323406246, -921.7466592784154, -601.090697329623, -561.6049909912939, -375.38145129900226, -820.0787758075138, -1076.1486020782772, -1198.4034657074044, -258.32043953083166, -740.8116404526334, -243.91678502527333, -14.23073074713365, -1141.0330709466143, -789.3223159057171, -520.3002922386205, -357.00061071555643, -930.7313921708891, -1351.712781980021, -553.5917172361526, -869.5487720349078, -1039.2872789384965, -940.9223660407636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666750600090743, "mean_inference_ms": 1.6884142529481292, "mean_action_processing_ms": 0.28106832038788865, "mean_env_wait_ms": 3.4880942646679447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013126611709594727, "StateBufferConnector_ms": 0.008919000625610352, "ViewRequirementAgentConnector_ms": 0.2122185230255127}, "num_episodes": 35, "episode_return_max": -7.054085525350634, "episode_return_min": -1460.5526925619533, "episode_return_mean": -712.7258994897712, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.6320387464637, "num_env_steps_trained_throughput_per_sec": 318.6320387464637, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12937.039, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12936.964, "sample_time_ms": 1167.898, "learn_time_ms": 11698.181, "learn_throughput": 341.933, "synch_weights_time_ms": 70.084}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00012", "date": "2024-08-04_06-35-49", "timestamp": 1722733549, "time_this_iter_s": 12.56554651260376, "time_total_s": 77.69115948677063, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091fd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.69115948677063, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.727777777777774, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.04111558943987, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.739623199403286, "policy_loss": -0.00867158616456436, "vf_loss": 6.745456735293071, "vf_explained_var": 0.700214289377133, "kl": 0.014937718507129232, "entropy": 1.4949396630128224, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -14.23073074713365, "episode_reward_min": -1460.5526925619533, "episode_reward_mean": -735.9177240744789, "episode_len_mean": 127.17, "episode_media": {}, "episodes_timesteps_total": 12717, "policy_reward_min": {"policy_0": -1460.5526925619533}, "policy_reward_max": {"policy_0": -14.23073074713365}, "policy_reward_mean": {"policy_0": -735.9177240744789}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-558.2105362880735, -722.1100169439819, -78.25975051760987, -1154.8898459180689, -481.49153749160484, -1447.8210541373287, -404.9039585139472, -1178.6898190164536, -1111.5207517815563, -723.1735129138455, -410.4384818263872, -343.6926042706881, -252.97013562294296, -1102.6272237045575, -369.66937169442474, -129.5765752875399, -1027.9150701692713, -21.17265648661789, -824.5030291813459, -775.9821192568294, -894.1082587251724, -957.1475022037897, -940.846412539677, -1139.20123850321, -939.5852617536929, -26.72725535443128, -20.61415643416172, -710.4068483714767, -124.50134403951701, -822.5254473535072, -1173.7090762102443, -1152.0897901401022, -1460.5526925619533, -23.712919964625907, -1391.7215179573154, -993.0864087320755, -998.8631098075841, -138.64478258711702, -925.5933054523512, -998.0589320369359, -1020.0838058949797, -257.66900649750625, -278.9306259376853, -1144.3009059754638, -1403.5408372119682, -28.093714257076307, -1228.3887141913735, -280.7436434710978, -1302.2032243582123, -1153.0732323406246, -921.7466592784154, -601.090697329623, -561.6049909912939, -375.38145129900226, -820.0787758075138, -1076.1486020782772, -1198.4034657074044, -258.32043953083166, -740.8116404526334, -243.91678502527333, -14.23073074713365, -1141.0330709466143, -789.3223159057171, -520.3002922386205, -357.00061071555643, -930.7313921708891, -1351.712781980021, -553.5917172361526, -869.5487720349078, -1039.2872789384965, -940.9223660407636, -1379.4700276973974, -860.3224612774245, -1410.005230741596, -1378.7167554666783, -711.5290047545718, -1201.930635931242, -367.09806329606266, -348.7208183584144, -751.7735098019851, -402.06157838430425, -336.6587773041006, -702.328501734516, -277.3779788863619, -1292.9879582226995, -473.8018889157654, -1340.5063006813243, -615.2731631110747, -322.9044458868057, -69.86976440535805, -125.91460392268883, -385.9509591661928, -644.5446280784192, -1169.3450941748397, -1179.2589666676913, -663.2186742220671, -575.6674925830761, -928.1572340055574, -1251.911051581174, -70.9399798453547], "episode_lengths": [113, 134, 57, 150, 150, 150, 150, 150, 150, 150, 100, 135, 68, 150, 95, 74, 150, 48, 150, 150, 150, 150, 150, 150, 150, 45, 36, 135, 61, 150, 150, 150, 150, 42, 150, 150, 150, 52, 150, 150, 150, 74, 102, 150, 150, 49, 150, 86, 150, 150, 150, 150, 150, 92, 140, 150, 150, 86, 138, 70, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 101, 81, 150, 78, 150, 142, 150, 150, 124, 70, 67, 107, 150, 150, 150, 150, 132, 150, 150, 60], "policy_policy_0_reward": [-558.2105362880735, -722.1100169439819, -78.25975051760987, -1154.8898459180689, -481.49153749160484, -1447.8210541373287, -404.9039585139472, -1178.6898190164536, -1111.5207517815563, -723.1735129138455, -410.4384818263872, -343.6926042706881, -252.97013562294296, -1102.6272237045575, -369.66937169442474, -129.5765752875399, -1027.9150701692713, -21.17265648661789, -824.5030291813459, -775.9821192568294, -894.1082587251724, -957.1475022037897, -940.846412539677, -1139.20123850321, -939.5852617536929, -26.72725535443128, -20.61415643416172, -710.4068483714767, -124.50134403951701, -822.5254473535072, -1173.7090762102443, -1152.0897901401022, -1460.5526925619533, -23.712919964625907, -1391.7215179573154, -993.0864087320755, -998.8631098075841, -138.64478258711702, -925.5933054523512, -998.0589320369359, -1020.0838058949797, -257.66900649750625, -278.9306259376853, -1144.3009059754638, -1403.5408372119682, -28.093714257076307, -1228.3887141913735, -280.7436434710978, -1302.2032243582123, -1153.0732323406246, -921.7466592784154, -601.090697329623, -561.6049909912939, -375.38145129900226, -820.0787758075138, -1076.1486020782772, -1198.4034657074044, -258.32043953083166, -740.8116404526334, -243.91678502527333, -14.23073074713365, -1141.0330709466143, -789.3223159057171, -520.3002922386205, -357.00061071555643, -930.7313921708891, -1351.712781980021, -553.5917172361526, -869.5487720349078, -1039.2872789384965, -940.9223660407636, -1379.4700276973974, -860.3224612774245, -1410.005230741596, -1378.7167554666783, -711.5290047545718, -1201.930635931242, -367.09806329606266, -348.7208183584144, -751.7735098019851, -402.06157838430425, -336.6587773041006, -702.328501734516, -277.3779788863619, -1292.9879582226995, -473.8018889157654, -1340.5063006813243, -615.2731631110747, -322.9044458868057, -69.86976440535805, -125.91460392268883, -385.9509591661928, -644.5446280784192, -1169.3450941748397, -1179.2589666676913, -663.2186742220671, -575.6674925830761, -928.1572340055574, -1251.911051581174, -70.9399798453547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5654525901447713, "mean_inference_ms": 1.6883278795127383, "mean_action_processing_ms": 0.2809228330238634, "mean_env_wait_ms": 3.492081699231006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012845993041992188, "StateBufferConnector_ms": 0.00867605209350586, "ViewRequirementAgentConnector_ms": 0.2022554874420166}, "num_episodes": 29, "episode_return_max": -14.23073074713365, "episode_return_min": -1460.5526925619533, "episode_return_mean": -735.9177240744789, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.5707732952256, "num_env_steps_trained_throughput_per_sec": 317.5707732952256, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12888.266, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12888.192, "sample_time_ms": 1161.703, "learn_time_ms": 11656.173, "learn_throughput": 343.166, "synch_weights_time_ms": 69.518}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00012", "date": "2024-08-04_06-36-02", "timestamp": 1722733562, "time_this_iter_s": 12.606888771057129, "time_total_s": 90.29804825782776, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.29804825782776, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.566666666666666, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.19254930218061, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.927492132534583, "policy_loss": -0.015325983747607097, "vf_loss": 4.9390525132417675, "vf_explained_var": 0.7936952318996191, "kl": 0.019542182661340734, "entropy": 1.428614130988717, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -14.23073074713365, "episode_reward_min": -1460.5526925619533, "episode_reward_mean": -778.7634651460842, "episode_len_mean": 132.86, "episode_media": {}, "episodes_timesteps_total": 13286, "policy_reward_min": {"policy_0": -1460.5526925619533}, "policy_reward_max": {"policy_0": -14.23073074713365}, "policy_reward_mean": {"policy_0": -778.7634651460842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-822.5254473535072, -1173.7090762102443, -1152.0897901401022, -1460.5526925619533, -23.712919964625907, -1391.7215179573154, -993.0864087320755, -998.8631098075841, -138.64478258711702, -925.5933054523512, -998.0589320369359, -1020.0838058949797, -257.66900649750625, -278.9306259376853, -1144.3009059754638, -1403.5408372119682, -28.093714257076307, -1228.3887141913735, -280.7436434710978, -1302.2032243582123, -1153.0732323406246, -921.7466592784154, -601.090697329623, -561.6049909912939, -375.38145129900226, -820.0787758075138, -1076.1486020782772, -1198.4034657074044, -258.32043953083166, -740.8116404526334, -243.91678502527333, -14.23073074713365, -1141.0330709466143, -789.3223159057171, -520.3002922386205, -357.00061071555643, -930.7313921708891, -1351.712781980021, -553.5917172361526, -869.5487720349078, -1039.2872789384965, -940.9223660407636, -1379.4700276973974, -860.3224612774245, -1410.005230741596, -1378.7167554666783, -711.5290047545718, -1201.930635931242, -367.09806329606266, -348.7208183584144, -751.7735098019851, -402.06157838430425, -336.6587773041006, -702.328501734516, -277.3779788863619, -1292.9879582226995, -473.8018889157654, -1340.5063006813243, -615.2731631110747, -322.9044458868057, -69.86976440535805, -125.91460392268883, -385.9509591661928, -644.5446280784192, -1169.3450941748397, -1179.2589666676913, -663.2186742220671, -575.6674925830761, -928.1572340055574, -1251.911051581174, -70.9399798453547, -585.9344596145585, -1051.797831196845, -954.7662469510641, -413.0194073515568, -1253.3479947398594, -767.0213113896295, -436.1390985109285, -1024.5946467929637, -1055.160695646784, -820.8192708928486, -555.7307691040629, -1202.853023631029, -856.0482435761162, -1251.5398530835741, -1177.360872709568, -87.42700157205016, -966.0101959471895, -149.45102277847235, -1044.228866493976, -860.079490052752, -486.7797269081798, -225.33279899914652, -731.6367546304674, -807.4641971606815, -831.4044275206337, -1042.7339648944373, -714.2435527622059, -1332.287796823254, -472.11691437391977], "episode_lengths": [150, 150, 150, 150, 42, 150, 150, 150, 52, 150, 150, 150, 74, 102, 150, 150, 49, 150, 86, 150, 150, 150, 150, 150, 92, 140, 150, 150, 86, 138, 70, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 101, 81, 150, 78, 150, 142, 150, 150, 124, 70, 67, 107, 150, 150, 150, 150, 132, 150, 150, 60, 149, 150, 150, 91, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 59, 150, 69, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-822.5254473535072, -1173.7090762102443, -1152.0897901401022, -1460.5526925619533, -23.712919964625907, -1391.7215179573154, -993.0864087320755, -998.8631098075841, -138.64478258711702, -925.5933054523512, -998.0589320369359, -1020.0838058949797, -257.66900649750625, -278.9306259376853, -1144.3009059754638, -1403.5408372119682, -28.093714257076307, -1228.3887141913735, -280.7436434710978, -1302.2032243582123, -1153.0732323406246, -921.7466592784154, -601.090697329623, -561.6049909912939, -375.38145129900226, -820.0787758075138, -1076.1486020782772, -1198.4034657074044, -258.32043953083166, -740.8116404526334, -243.91678502527333, -14.23073074713365, -1141.0330709466143, -789.3223159057171, -520.3002922386205, -357.00061071555643, -930.7313921708891, -1351.712781980021, -553.5917172361526, -869.5487720349078, -1039.2872789384965, -940.9223660407636, -1379.4700276973974, -860.3224612774245, -1410.005230741596, -1378.7167554666783, -711.5290047545718, -1201.930635931242, -367.09806329606266, -348.7208183584144, -751.7735098019851, -402.06157838430425, -336.6587773041006, -702.328501734516, -277.3779788863619, -1292.9879582226995, -473.8018889157654, -1340.5063006813243, -615.2731631110747, -322.9044458868057, -69.86976440535805, -125.91460392268883, -385.9509591661928, -644.5446280784192, -1169.3450941748397, -1179.2589666676913, -663.2186742220671, -575.6674925830761, -928.1572340055574, -1251.911051581174, -70.9399798453547, -585.9344596145585, -1051.797831196845, -954.7662469510641, -413.0194073515568, -1253.3479947398594, -767.0213113896295, -436.1390985109285, -1024.5946467929637, -1055.160695646784, -820.8192708928486, -555.7307691040629, -1202.853023631029, -856.0482435761162, -1251.5398530835741, -1177.360872709568, -87.42700157205016, -966.0101959471895, -149.45102277847235, -1044.228866493976, -860.079490052752, -486.7797269081798, -225.33279899914652, -731.6367546304674, -807.4641971606815, -831.4044275206337, -1042.7339648944373, -714.2435527622059, -1332.287796823254, -472.11691437391977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5646646244677825, "mean_inference_ms": 1.689280522751611, "mean_action_processing_ms": 0.28175960132438377, "mean_env_wait_ms": 3.4995090169336804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012559890747070312, "StateBufferConnector_ms": 0.008431196212768555, "ViewRequirementAgentConnector_ms": 0.2030036449432373}, "num_episodes": 29, "episode_return_max": -14.23073074713365, "episode_return_min": -1460.5526925619533, "episode_return_mean": -778.7634651460842, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.7794761929306, "num_env_steps_trained_throughput_per_sec": 300.7794761929306, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12939.582, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12939.508, "sample_time_ms": 1161.514, "learn_time_ms": 11708.611, "learn_throughput": 341.629, "synch_weights_time_ms": 68.586}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00012", "date": "2024-08-04_06-36-15", "timestamp": 1722733575, "time_this_iter_s": 13.309992551803589, "time_total_s": 103.60804080963135, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091e950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.60804080963135, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.40526315789474, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.98298848867417, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.650641137858232, "policy_loss": -0.00806032092756747, "vf_loss": 4.655820213754972, "vf_explained_var": 0.86873798177888, "kl": 0.01511960125802337, "entropy": 1.4266920837263266, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -14.23073074713365, "episode_reward_min": -1410.005230741596, "episode_reward_mean": -760.8318308653996, "episode_len_mean": 135.68, "episode_media": {}, "episodes_timesteps_total": 13568, "policy_reward_min": {"policy_0": -1410.005230741596}, "policy_reward_max": {"policy_0": -14.23073074713365}, "policy_reward_mean": {"policy_0": -760.8318308653996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.8116404526334, -243.91678502527333, -14.23073074713365, -1141.0330709466143, -789.3223159057171, -520.3002922386205, -357.00061071555643, -930.7313921708891, -1351.712781980021, -553.5917172361526, -869.5487720349078, -1039.2872789384965, -940.9223660407636, -1379.4700276973974, -860.3224612774245, -1410.005230741596, -1378.7167554666783, -711.5290047545718, -1201.930635931242, -367.09806329606266, -348.7208183584144, -751.7735098019851, -402.06157838430425, -336.6587773041006, -702.328501734516, -277.3779788863619, -1292.9879582226995, -473.8018889157654, -1340.5063006813243, -615.2731631110747, -322.9044458868057, -69.86976440535805, -125.91460392268883, -385.9509591661928, -644.5446280784192, -1169.3450941748397, -1179.2589666676913, -663.2186742220671, -575.6674925830761, -928.1572340055574, -1251.911051581174, -70.9399798453547, -585.9344596145585, -1051.797831196845, -954.7662469510641, -413.0194073515568, -1253.3479947398594, -767.0213113896295, -436.1390985109285, -1024.5946467929637, -1055.160695646784, -820.8192708928486, -555.7307691040629, -1202.853023631029, -856.0482435761162, -1251.5398530835741, -1177.360872709568, -87.42700157205016, -966.0101959471895, -149.45102277847235, -1044.228866493976, -860.079490052752, -486.7797269081798, -225.33279899914652, -731.6367546304674, -807.4641971606815, -831.4044275206337, -1042.7339648944373, -714.2435527622059, -1332.287796823254, -472.11691437391977, -802.4533740018941, -863.57046935308, -548.1154150072348, -280.6855551326783, -953.6237950751427, -527.3996602478601, -757.7604831688074, -647.1367696099949, -537.396593979451, -900.7491289596214, -982.0453467976535, -1245.2747425436708, -307.45028822042457, -810.1998067666727, -937.0207136399555, -664.1771164975851, -1248.8890714205136, -575.9875186886555, -1136.2094766571115, -1062.161099288473, -789.8089289911086, -981.8239492047458, -854.432664380793, -1131.97091518918, -660.3186717319371, -222.55857015136297, -151.32469951507576, -1270.1350879267895, -344.5174347462268], "episode_lengths": [138, 70, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 101, 81, 150, 78, 150, 142, 150, 150, 124, 70, 67, 107, 150, 150, 150, 150, 132, 150, 150, 60, 149, 150, 150, 91, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 59, 150, 69, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 146, 150, 150, 150, 93, 140, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 76, 150, 82], "policy_policy_0_reward": [-740.8116404526334, -243.91678502527333, -14.23073074713365, -1141.0330709466143, -789.3223159057171, -520.3002922386205, -357.00061071555643, -930.7313921708891, -1351.712781980021, -553.5917172361526, -869.5487720349078, -1039.2872789384965, -940.9223660407636, -1379.4700276973974, -860.3224612774245, -1410.005230741596, -1378.7167554666783, -711.5290047545718, -1201.930635931242, -367.09806329606266, -348.7208183584144, -751.7735098019851, -402.06157838430425, -336.6587773041006, -702.328501734516, -277.3779788863619, -1292.9879582226995, -473.8018889157654, -1340.5063006813243, -615.2731631110747, -322.9044458868057, -69.86976440535805, -125.91460392268883, -385.9509591661928, -644.5446280784192, -1169.3450941748397, -1179.2589666676913, -663.2186742220671, -575.6674925830761, -928.1572340055574, -1251.911051581174, -70.9399798453547, -585.9344596145585, -1051.797831196845, -954.7662469510641, -413.0194073515568, -1253.3479947398594, -767.0213113896295, -436.1390985109285, -1024.5946467929637, -1055.160695646784, -820.8192708928486, -555.7307691040629, -1202.853023631029, -856.0482435761162, -1251.5398530835741, -1177.360872709568, -87.42700157205016, -966.0101959471895, -149.45102277847235, -1044.228866493976, -860.079490052752, -486.7797269081798, -225.33279899914652, -731.6367546304674, -807.4641971606815, -831.4044275206337, -1042.7339648944373, -714.2435527622059, -1332.287796823254, -472.11691437391977, -802.4533740018941, -863.57046935308, -548.1154150072348, -280.6855551326783, -953.6237950751427, -527.3996602478601, -757.7604831688074, -647.1367696099949, -537.396593979451, -900.7491289596214, -982.0453467976535, -1245.2747425436708, -307.45028822042457, -810.1998067666727, -937.0207136399555, -664.1771164975851, -1248.8890714205136, -575.9875186886555, -1136.2094766571115, -1062.161099288473, -789.8089289911086, -981.8239492047458, -854.432664380793, -1131.97091518918, -660.3186717319371, -222.55857015136297, -151.32469951507576, -1270.1350879267895, -344.5174347462268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632960864854906, "mean_inference_ms": 1.6887593988380019, "mean_action_processing_ms": 0.28147094099228837, "mean_env_wait_ms": 3.5004241100152225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012293577194213867, "StateBufferConnector_ms": 0.008229494094848633, "ViewRequirementAgentConnector_ms": 0.20494604110717773}, "num_episodes": 29, "episode_return_max": -14.23073074713365, "episode_return_min": -1410.005230741596, "episode_return_mean": -760.8318308653996, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.6362882625116, "num_env_steps_trained_throughput_per_sec": 311.6362882625116, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12928.016, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12927.941, "sample_time_ms": 1161.216, "learn_time_ms": 11697.468, "learn_throughput": 341.954, "synch_weights_time_ms": 68.456}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00012", "date": "2024-08-04_06-36-28", "timestamp": 1722733588, "time_this_iter_s": 12.848845720291138, "time_total_s": 116.45688652992249, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091dab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.45688652992249, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.431578947368422, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 74.33807581166427, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.794007314741611, "policy_loss": -0.00896047939992665, "vf_loss": 4.800083238383134, "vf_explained_var": 0.8822755755235752, "kl": 0.015123987357261134, "entropy": 1.4024286191910504, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -68.02784009713665, "episode_reward_min": -1358.1473863944989, "episode_reward_mean": -736.9843334393315, "episode_len_mean": 133.24, "episode_media": {}, "episodes_timesteps_total": 13324, "policy_reward_min": {"policy_0": -1358.1473863944989}, "policy_reward_max": {"policy_0": -68.02784009713665}, "policy_reward_mean": {"policy_0": -736.9843334393315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.86976440535805, -125.91460392268883, -385.9509591661928, -644.5446280784192, -1169.3450941748397, -1179.2589666676913, -663.2186742220671, -575.6674925830761, -928.1572340055574, -1251.911051581174, -70.9399798453547, -585.9344596145585, -1051.797831196845, -954.7662469510641, -413.0194073515568, -1253.3479947398594, -767.0213113896295, -436.1390985109285, -1024.5946467929637, -1055.160695646784, -820.8192708928486, -555.7307691040629, -1202.853023631029, -856.0482435761162, -1251.5398530835741, -1177.360872709568, -87.42700157205016, -966.0101959471895, -149.45102277847235, -1044.228866493976, -860.079490052752, -486.7797269081798, -225.33279899914652, -731.6367546304674, -807.4641971606815, -831.4044275206337, -1042.7339648944373, -714.2435527622059, -1332.287796823254, -472.11691437391977, -802.4533740018941, -863.57046935308, -548.1154150072348, -280.6855551326783, -953.6237950751427, -527.3996602478601, -757.7604831688074, -647.1367696099949, -537.396593979451, -900.7491289596214, -982.0453467976535, -1245.2747425436708, -307.45028822042457, -810.1998067666727, -937.0207136399555, -664.1771164975851, -1248.8890714205136, -575.9875186886555, -1136.2094766571115, -1062.161099288473, -789.8089289911086, -981.8239492047458, -854.432664380793, -1131.97091518918, -660.3186717319371, -222.55857015136297, -151.32469951507576, -1270.1350879267895, -344.5174347462268, -79.51369484132596, -429.0708062232285, -983.1899007470655, -559.5085802347622, -635.510814412553, -713.48483109782, -1171.4962128052582, -912.4721742953731, -587.1217459224874, -191.60669297296033, -68.02784009713665, -771.9054175847641, -820.3530386802926, -1358.1473863944989, -95.00206542000082, -219.18958017579698, -1236.994046797062, -496.76354743094635, -500.60185897255263, -1122.7066916333183, -700.5831151767967, -1101.6889907457048, -1106.2084675752862, -595.8573741646707, -1190.007609719922, -509.7623377206955, -239.53574450226313, -1091.2815949740736, -605.332606973058, -985.8092359517078, -202.39310803491136], "episode_lengths": [70, 67, 107, 150, 150, 150, 150, 132, 150, 150, 60, 149, 150, 150, 91, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 59, 150, 69, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 146, 150, 150, 150, 93, 140, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 76, 150, 82, 50, 150, 150, 150, 132, 150, 150, 150, 120, 65, 47, 150, 142, 150, 66, 73, 150, 111, 150, 150, 142, 150, 150, 150, 150, 108, 74, 150, 150, 150, 83], "policy_policy_0_reward": [-69.86976440535805, -125.91460392268883, -385.9509591661928, -644.5446280784192, -1169.3450941748397, -1179.2589666676913, -663.2186742220671, -575.6674925830761, -928.1572340055574, -1251.911051581174, -70.9399798453547, -585.9344596145585, -1051.797831196845, -954.7662469510641, -413.0194073515568, -1253.3479947398594, -767.0213113896295, -436.1390985109285, -1024.5946467929637, -1055.160695646784, -820.8192708928486, -555.7307691040629, -1202.853023631029, -856.0482435761162, -1251.5398530835741, -1177.360872709568, -87.42700157205016, -966.0101959471895, -149.45102277847235, -1044.228866493976, -860.079490052752, -486.7797269081798, -225.33279899914652, -731.6367546304674, -807.4641971606815, -831.4044275206337, -1042.7339648944373, -714.2435527622059, -1332.287796823254, -472.11691437391977, -802.4533740018941, -863.57046935308, -548.1154150072348, -280.6855551326783, -953.6237950751427, -527.3996602478601, -757.7604831688074, -647.1367696099949, -537.396593979451, -900.7491289596214, -982.0453467976535, -1245.2747425436708, -307.45028822042457, -810.1998067666727, -937.0207136399555, -664.1771164975851, -1248.8890714205136, -575.9875186886555, -1136.2094766571115, -1062.161099288473, -789.8089289911086, -981.8239492047458, -854.432664380793, -1131.97091518918, -660.3186717319371, -222.55857015136297, -151.32469951507576, -1270.1350879267895, -344.5174347462268, -79.51369484132596, -429.0708062232285, -983.1899007470655, -559.5085802347622, -635.510814412553, -713.48483109782, -1171.4962128052582, -912.4721742953731, -587.1217459224874, -191.60669297296033, -68.02784009713665, -771.9054175847641, -820.3530386802926, -1358.1473863944989, -95.00206542000082, -219.18958017579698, -1236.994046797062, -496.76354743094635, -500.60185897255263, -1122.7066916333183, -700.5831151767967, -1101.6889907457048, -1106.2084675752862, -595.8573741646707, -1190.007609719922, -509.7623377206955, -239.53574450226313, -1091.2815949740736, -605.332606973058, -985.8092359517078, -202.39310803491136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619676817814155, "mean_inference_ms": 1.6862335063641587, "mean_action_processing_ms": 0.28128366559829243, "mean_env_wait_ms": 3.499322458714596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012443065643310547, "StateBufferConnector_ms": 0.008301258087158203, "ViewRequirementAgentConnector_ms": 0.20589947700500488}, "num_episodes": 31, "episode_return_max": -68.02784009713665, "episode_return_min": -1358.1473863944989, "episode_return_mean": -736.9843334393315, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.19194013779753, "num_env_steps_trained_throughput_per_sec": 308.19194013779753, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12933.108, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12933.033, "sample_time_ms": 1160.222, "learn_time_ms": 11703.856, "learn_throughput": 341.768, "synch_weights_time_ms": 68.156}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00012", "date": "2024-08-04_06-36-41", "timestamp": 1722733601, "time_this_iter_s": 12.99127197265625, "time_total_s": 129.44815850257874, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1b520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 129.44815850257874, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.494444444444444, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.87265817721685, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.477106236418089, "policy_loss": -0.012254995405479955, "vf_loss": 4.485968482991059, "vf_explained_var": 0.8780129870399833, "kl": 0.01767241338675376, "entropy": 1.417285980656743, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -68.02784009713665, "episode_reward_min": -1476.4623024724783, "episode_reward_mean": -740.9091014722145, "episode_len_mean": 132.28, "episode_media": {}, "episodes_timesteps_total": 13228, "policy_reward_min": {"policy_0": -1476.4623024724783}, "policy_reward_max": {"policy_0": -68.02784009713665}, "policy_reward_mean": {"policy_0": -740.9091014722145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-225.33279899914652, -731.6367546304674, -807.4641971606815, -831.4044275206337, -1042.7339648944373, -714.2435527622059, -1332.287796823254, -472.11691437391977, -802.4533740018941, -863.57046935308, -548.1154150072348, -280.6855551326783, -953.6237950751427, -527.3996602478601, -757.7604831688074, -647.1367696099949, -537.396593979451, -900.7491289596214, -982.0453467976535, -1245.2747425436708, -307.45028822042457, -810.1998067666727, -937.0207136399555, -664.1771164975851, -1248.8890714205136, -575.9875186886555, -1136.2094766571115, -1062.161099288473, -789.8089289911086, -981.8239492047458, -854.432664380793, -1131.97091518918, -660.3186717319371, -222.55857015136297, -151.32469951507576, -1270.1350879267895, -344.5174347462268, -79.51369484132596, -429.0708062232285, -983.1899007470655, -559.5085802347622, -635.510814412553, -713.48483109782, -1171.4962128052582, -912.4721742953731, -587.1217459224874, -191.60669297296033, -68.02784009713665, -771.9054175847641, -820.3530386802926, -1358.1473863944989, -95.00206542000082, -219.18958017579698, -1236.994046797062, -496.76354743094635, -500.60185897255263, -1122.7066916333183, -700.5831151767967, -1101.6889907457048, -1106.2084675752862, -595.8573741646707, -1190.007609719922, -509.7623377206955, -239.53574450226313, -1091.2815949740736, -605.332606973058, -985.8092359517078, -202.39310803491136, -449.5842848795474, -1145.854583678768, -282.4582634017502, -1196.5215002224386, -843.9085755760165, -1377.85655713297, -172.19483426747712, -274.6552730039974, -1476.4623024724783, -562.5189769414176, -873.249340776824, -1186.4951956628315, -1415.3284938590234, -977.1715316529092, -750.7093169088664, -286.31885517654024, -991.563786833754, -449.00626849575326, -1324.142080290512, -208.54704694024005, -1389.8594362683916, -1056.090753239396, -432.6436153321225, -753.613476585728, -75.5508359455234, -1061.4657779163497, -233.1512941172223, -806.7785713065373, -1108.5870831263928, -289.6765584835428, -378.66400280569763, -626.7368075836939], "episode_lengths": [150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 146, 150, 150, 150, 93, 140, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 76, 150, 82, 50, 150, 150, 150, 132, 150, 150, 150, 120, 65, 47, 150, 142, 150, 66, 73, 150, 111, 150, 150, 142, 150, 150, 150, 150, 108, 74, 150, 150, 150, 83, 150, 150, 80, 150, 149, 150, 57, 76, 150, 114, 150, 150, 150, 150, 141, 107, 150, 150, 150, 71, 150, 150, 150, 150, 66, 150, 77, 150, 150, 76, 106, 150], "policy_policy_0_reward": [-225.33279899914652, -731.6367546304674, -807.4641971606815, -831.4044275206337, -1042.7339648944373, -714.2435527622059, -1332.287796823254, -472.11691437391977, -802.4533740018941, -863.57046935308, -548.1154150072348, -280.6855551326783, -953.6237950751427, -527.3996602478601, -757.7604831688074, -647.1367696099949, -537.396593979451, -900.7491289596214, -982.0453467976535, -1245.2747425436708, -307.45028822042457, -810.1998067666727, -937.0207136399555, -664.1771164975851, -1248.8890714205136, -575.9875186886555, -1136.2094766571115, -1062.161099288473, -789.8089289911086, -981.8239492047458, -854.432664380793, -1131.97091518918, -660.3186717319371, -222.55857015136297, -151.32469951507576, -1270.1350879267895, -344.5174347462268, -79.51369484132596, -429.0708062232285, -983.1899007470655, -559.5085802347622, -635.510814412553, -713.48483109782, -1171.4962128052582, -912.4721742953731, -587.1217459224874, -191.60669297296033, -68.02784009713665, -771.9054175847641, -820.3530386802926, -1358.1473863944989, -95.00206542000082, -219.18958017579698, -1236.994046797062, -496.76354743094635, -500.60185897255263, -1122.7066916333183, -700.5831151767967, -1101.6889907457048, -1106.2084675752862, -595.8573741646707, -1190.007609719922, -509.7623377206955, -239.53574450226313, -1091.2815949740736, -605.332606973058, -985.8092359517078, -202.39310803491136, -449.5842848795474, -1145.854583678768, -282.4582634017502, -1196.5215002224386, -843.9085755760165, -1377.85655713297, -172.19483426747712, -274.6552730039974, -1476.4623024724783, -562.5189769414176, -873.249340776824, -1186.4951956628315, -1415.3284938590234, -977.1715316529092, -750.7093169088664, -286.31885517654024, -991.563786833754, -449.00626849575326, -1324.142080290512, -208.54704694024005, -1389.8594362683916, -1056.090753239396, -432.6436153321225, -753.613476585728, -75.5508359455234, -1061.4657779163497, -233.1512941172223, -806.7785713065373, -1108.5870831263928, -289.6765584835428, -378.66400280569763, -626.7368075836939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5610078038793848, "mean_inference_ms": 1.686674733239694, "mean_action_processing_ms": 0.28060118646968896, "mean_env_wait_ms": 3.5003642840281577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012734413146972656, "StateBufferConnector_ms": 0.008316278457641602, "ViewRequirementAgentConnector_ms": 0.19518709182739258}, "num_episodes": 32, "episode_return_max": -68.02784009713665, "episode_return_min": -1476.4623024724783, "episode_return_mean": -740.9091014722145, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.51575185124307, "num_env_steps_trained_throughput_per_sec": 306.51575185124307, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12948.972, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12948.896, "sample_time_ms": 1184.13, "learn_time_ms": 11696.46, "learn_throughput": 341.984, "synch_weights_time_ms": 67.491}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00012", "date": "2024-08-04_06-36-54", "timestamp": 1722733614, "time_this_iter_s": 13.061811447143555, "time_total_s": 142.5099699497223, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.5099699497223, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.27368421052632, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.01564203997454, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.452218635380268, "policy_loss": -0.00903403353052757, "vf_loss": 4.458161702007056, "vf_explained_var": 0.9211801324660579, "kl": 0.016200344721073633, "entropy": 1.4909428405265013, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -34.373016881751525, "episode_reward_min": -1476.4623024724783, "episode_reward_mean": -714.2302494118759, "episode_len_mean": 128.25, "episode_media": {}, "episodes_timesteps_total": 12825, "policy_reward_min": {"policy_0": -1476.4623024724783}, "policy_reward_max": {"policy_0": -34.373016881751525}, "policy_reward_mean": {"policy_0": -714.2302494118759}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-222.55857015136297, -151.32469951507576, -1270.1350879267895, -344.5174347462268, -79.51369484132596, -429.0708062232285, -983.1899007470655, -559.5085802347622, -635.510814412553, -713.48483109782, -1171.4962128052582, -912.4721742953731, -587.1217459224874, -191.60669297296033, -68.02784009713665, -771.9054175847641, -820.3530386802926, -1358.1473863944989, -95.00206542000082, -219.18958017579698, -1236.994046797062, -496.76354743094635, -500.60185897255263, -1122.7066916333183, -700.5831151767967, -1101.6889907457048, -1106.2084675752862, -595.8573741646707, -1190.007609719922, -509.7623377206955, -239.53574450226313, -1091.2815949740736, -605.332606973058, -985.8092359517078, -202.39310803491136, -449.5842848795474, -1145.854583678768, -282.4582634017502, -1196.5215002224386, -843.9085755760165, -1377.85655713297, -172.19483426747712, -274.6552730039974, -1476.4623024724783, -562.5189769414176, -873.249340776824, -1186.4951956628315, -1415.3284938590234, -977.1715316529092, -750.7093169088664, -286.31885517654024, -991.563786833754, -449.00626849575326, -1324.142080290512, -208.54704694024005, -1389.8594362683916, -1056.090753239396, -432.6436153321225, -753.613476585728, -75.5508359455234, -1061.4657779163497, -233.1512941172223, -806.7785713065373, -1108.5870831263928, -289.6765584835428, -378.66400280569763, -626.7368075836939, -1005.3839702696686, -909.8805882238573, -556.0688769485721, -949.806236991398, -1168.3689235738454, -778.7383731384523, -35.84064274412364, -1173.0797000838156, -921.7627717483804, -846.5311534639252, -1373.223768452605, -639.6257786142119, -648.5307427131121, -584.9710642366036, -1175.7879268184606, -725.8747229964051, -34.373016881751525, -109.54872361959868, -552.0159553561892, -610.4882031054714, -1156.6606189654085, -590.2556388895435, -287.55161156361885, -478.6670049870704, -840.8230698923696, -1189.9608642698402, -590.0303430543693, -879.2935463087076, -270.6957012004212, -1151.1044424525849, -580.0322176974219, -670.4632469411529, -210.5573094821735], "episode_lengths": [90, 76, 150, 82, 50, 150, 150, 150, 132, 150, 150, 150, 120, 65, 47, 150, 142, 150, 66, 73, 150, 111, 150, 150, 142, 150, 150, 150, 150, 108, 74, 150, 150, 150, 83, 150, 150, 80, 150, 149, 150, 57, 76, 150, 114, 150, 150, 150, 150, 141, 107, 150, 150, 150, 71, 150, 150, 150, 150, 66, 150, 77, 150, 150, 76, 106, 150, 150, 150, 150, 150, 150, 149, 40, 150, 150, 150, 150, 150, 150, 144, 150, 148, 49, 62, 108, 150, 150, 136, 79, 150, 150, 150, 118, 150, 103, 150, 128, 130, 150], "policy_policy_0_reward": [-222.55857015136297, -151.32469951507576, -1270.1350879267895, -344.5174347462268, -79.51369484132596, -429.0708062232285, -983.1899007470655, -559.5085802347622, -635.510814412553, -713.48483109782, -1171.4962128052582, -912.4721742953731, -587.1217459224874, -191.60669297296033, -68.02784009713665, -771.9054175847641, -820.3530386802926, -1358.1473863944989, -95.00206542000082, -219.18958017579698, -1236.994046797062, -496.76354743094635, -500.60185897255263, -1122.7066916333183, -700.5831151767967, -1101.6889907457048, -1106.2084675752862, -595.8573741646707, -1190.007609719922, -509.7623377206955, -239.53574450226313, -1091.2815949740736, -605.332606973058, -985.8092359517078, -202.39310803491136, -449.5842848795474, -1145.854583678768, -282.4582634017502, -1196.5215002224386, -843.9085755760165, -1377.85655713297, -172.19483426747712, -274.6552730039974, -1476.4623024724783, -562.5189769414176, -873.249340776824, -1186.4951956628315, -1415.3284938590234, -977.1715316529092, -750.7093169088664, -286.31885517654024, -991.563786833754, -449.00626849575326, -1324.142080290512, -208.54704694024005, -1389.8594362683916, -1056.090753239396, -432.6436153321225, -753.613476585728, -75.5508359455234, -1061.4657779163497, -233.1512941172223, -806.7785713065373, -1108.5870831263928, -289.6765584835428, -378.66400280569763, -626.7368075836939, -1005.3839702696686, -909.8805882238573, -556.0688769485721, -949.806236991398, -1168.3689235738454, -778.7383731384523, -35.84064274412364, -1173.0797000838156, -921.7627717483804, -846.5311534639252, -1373.223768452605, -639.6257786142119, -648.5307427131121, -584.9710642366036, -1175.7879268184606, -725.8747229964051, -34.373016881751525, -109.54872361959868, -552.0159553561892, -610.4882031054714, -1156.6606189654085, -590.2556388895435, -287.55161156361885, -478.6670049870704, -840.8230698923696, -1189.9608642698402, -590.0303430543693, -879.2935463087076, -270.6957012004212, -1151.1044424525849, -580.0322176974219, -670.4632469411529, -210.5573094821735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5602238466179158, "mean_inference_ms": 1.686766605019985, "mean_action_processing_ms": 0.28020772130845956, "mean_env_wait_ms": 3.501477585837917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012320995330810547, "StateBufferConnector_ms": 0.008280277252197266, "ViewRequirementAgentConnector_ms": 0.19486308097839355}, "num_episodes": 33, "episode_return_max": -34.373016881751525, "episode_return_min": -1476.4623024724783, "episode_return_mean": -714.2302494118759, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.56069174547326, "num_env_steps_trained_throughput_per_sec": 301.56069174547326, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12949.76, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12949.685, "sample_time_ms": 1181.758, "learn_time_ms": 11699.771, "learn_throughput": 341.887, "synch_weights_time_ms": 67.298}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00012", "date": "2024-08-04_06-37-08", "timestamp": 1722733628, "time_this_iter_s": 13.277732610702515, "time_total_s": 155.7877025604248, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.7877025604248, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.136842105263156, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.59809643924237, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.025102624545495, "policy_loss": -0.01024408484712088, "vf_loss": 3.0321331111093364, "vf_explained_var": 0.9702066101754705, "kl": 0.01679315033865502, "entropy": 1.4502925874044499, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -34.373016881751525, "episode_reward_min": -1476.4623024724783, "episode_reward_mean": -740.4886162801741, "episode_len_mean": 131.48, "episode_media": {}, "episodes_timesteps_total": 13148, "policy_reward_min": {"policy_0": -1476.4623024724783}, "policy_reward_max": {"policy_0": -34.373016881751525}, "policy_reward_mean": {"policy_0": -740.4886162801741}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-509.7623377206955, -239.53574450226313, -1091.2815949740736, -605.332606973058, -985.8092359517078, -202.39310803491136, -449.5842848795474, -1145.854583678768, -282.4582634017502, -1196.5215002224386, -843.9085755760165, -1377.85655713297, -172.19483426747712, -274.6552730039974, -1476.4623024724783, -562.5189769414176, -873.249340776824, -1186.4951956628315, -1415.3284938590234, -977.1715316529092, -750.7093169088664, -286.31885517654024, -991.563786833754, -449.00626849575326, -1324.142080290512, -208.54704694024005, -1389.8594362683916, -1056.090753239396, -432.6436153321225, -753.613476585728, -75.5508359455234, -1061.4657779163497, -233.1512941172223, -806.7785713065373, -1108.5870831263928, -289.6765584835428, -378.66400280569763, -626.7368075836939, -1005.3839702696686, -909.8805882238573, -556.0688769485721, -949.806236991398, -1168.3689235738454, -778.7383731384523, -35.84064274412364, -1173.0797000838156, -921.7627717483804, -846.5311534639252, -1373.223768452605, -639.6257786142119, -648.5307427131121, -584.9710642366036, -1175.7879268184606, -725.8747229964051, -34.373016881751525, -109.54872361959868, -552.0159553561892, -610.4882031054714, -1156.6606189654085, -590.2556388895435, -287.55161156361885, -478.6670049870704, -840.8230698923696, -1189.9608642698402, -590.0303430543693, -879.2935463087076, -270.6957012004212, -1151.1044424525849, -580.0322176974219, -670.4632469411529, -210.5573094821735, -968.5968888584327, -746.3756388279664, -137.73213226472544, -1121.6652033678424, -667.9984910298848, -1364.1036115603981, -626.7272803327534, -1089.5284341187448, -1169.4031476019381, -948.8141389537972, -736.3969538789505, -970.400253246141, -1114.3174493794343, -74.50652424323061, -960.09425516221, -179.80612120024648, -485.3868958931981, -1139.278724769772, -622.7172582362914, -1034.055454408653, -416.3644179623148, -1178.7381662690648, -655.2491028332219, -262.1680150522501, -398.8893791881332, -209.31685789168606, -1149.0659021110985, -783.655207935661, -1050.0330567128399], "episode_lengths": [108, 74, 150, 150, 150, 83, 150, 150, 80, 150, 149, 150, 57, 76, 150, 114, 150, 150, 150, 150, 141, 107, 150, 150, 150, 71, 150, 150, 150, 150, 66, 150, 77, 150, 150, 76, 106, 150, 150, 150, 150, 150, 150, 149, 40, 150, 150, 150, 150, 150, 150, 144, 150, 148, 49, 62, 108, 150, 150, 136, 79, 150, 150, 150, 118, 150, 103, 150, 128, 130, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 67, 139, 150, 150, 150, 101, 150, 150, 90, 93, 150, 150, 139, 150], "policy_policy_0_reward": [-509.7623377206955, -239.53574450226313, -1091.2815949740736, -605.332606973058, -985.8092359517078, -202.39310803491136, -449.5842848795474, -1145.854583678768, -282.4582634017502, -1196.5215002224386, -843.9085755760165, -1377.85655713297, -172.19483426747712, -274.6552730039974, -1476.4623024724783, -562.5189769414176, -873.249340776824, -1186.4951956628315, -1415.3284938590234, -977.1715316529092, -750.7093169088664, -286.31885517654024, -991.563786833754, -449.00626849575326, -1324.142080290512, -208.54704694024005, -1389.8594362683916, -1056.090753239396, -432.6436153321225, -753.613476585728, -75.5508359455234, -1061.4657779163497, -233.1512941172223, -806.7785713065373, -1108.5870831263928, -289.6765584835428, -378.66400280569763, -626.7368075836939, -1005.3839702696686, -909.8805882238573, -556.0688769485721, -949.806236991398, -1168.3689235738454, -778.7383731384523, -35.84064274412364, -1173.0797000838156, -921.7627717483804, -846.5311534639252, -1373.223768452605, -639.6257786142119, -648.5307427131121, -584.9710642366036, -1175.7879268184606, -725.8747229964051, -34.373016881751525, -109.54872361959868, -552.0159553561892, -610.4882031054714, -1156.6606189654085, -590.2556388895435, -287.55161156361885, -478.6670049870704, -840.8230698923696, -1189.9608642698402, -590.0303430543693, -879.2935463087076, -270.6957012004212, -1151.1044424525849, -580.0322176974219, -670.4632469411529, -210.5573094821735, -968.5968888584327, -746.3756388279664, -137.73213226472544, -1121.6652033678424, -667.9984910298848, -1364.1036115603981, -626.7272803327534, -1089.5284341187448, -1169.4031476019381, -948.8141389537972, -736.3969538789505, -970.400253246141, -1114.3174493794343, -74.50652424323061, -960.09425516221, -179.80612120024648, -485.3868958931981, -1139.278724769772, -622.7172582362914, -1034.055454408653, -416.3644179623148, -1178.7381662690648, -655.2491028332219, -262.1680150522501, -398.8893791881332, -209.31685789168606, -1149.0659021110985, -783.655207935661, -1050.0330567128399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596967713434772, "mean_inference_ms": 1.6881854524420856, "mean_action_processing_ms": 0.28002773542123915, "mean_env_wait_ms": 3.5069146581461847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012099742889404297, "StateBufferConnector_ms": 0.008281946182250977, "ViewRequirementAgentConnector_ms": 0.19544577598571777}, "num_episodes": 29, "episode_return_max": -34.373016881751525, "episode_return_min": -1476.4623024724783, "episode_return_mean": -740.4886162801741, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.9830371563612, "num_env_steps_trained_throughput_per_sec": 323.9830371563612, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12866.686, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12866.609, "sample_time_ms": 1182.804, "learn_time_ms": 11614.764, "learn_throughput": 344.389, "synch_weights_time_ms": 68.18}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00012", "date": "2024-08-04_06-37-20", "timestamp": 1722733640, "time_this_iter_s": 12.35785460472107, "time_total_s": 168.14555716514587, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091fd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.14555716514587, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.941176470588236, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 201.95214144587516, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.0426163602620364, "policy_loss": -0.0046076657066199305, "vf_loss": 3.0438929088413715, "vf_explained_var": 0.9469248841827115, "kl": 0.017481052672064835, "entropy": 1.6509377139310042, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -34.373016881751525, "episode_reward_min": -1389.8594362683916, "episode_reward_mean": -755.0353571014385, "episode_len_mean": 134.02, "episode_media": {}, "episodes_timesteps_total": 13402, "policy_reward_min": {"policy_0": -1389.8594362683916}, "policy_reward_max": {"policy_0": -34.373016881751525}, "policy_reward_mean": {"policy_0": -755.0353571014385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1389.8594362683916, -1056.090753239396, -432.6436153321225, -753.613476585728, -75.5508359455234, -1061.4657779163497, -233.1512941172223, -806.7785713065373, -1108.5870831263928, -289.6765584835428, -378.66400280569763, -626.7368075836939, -1005.3839702696686, -909.8805882238573, -556.0688769485721, -949.806236991398, -1168.3689235738454, -778.7383731384523, -35.84064274412364, -1173.0797000838156, -921.7627717483804, -846.5311534639252, -1373.223768452605, -639.6257786142119, -648.5307427131121, -584.9710642366036, -1175.7879268184606, -725.8747229964051, -34.373016881751525, -109.54872361959868, -552.0159553561892, -610.4882031054714, -1156.6606189654085, -590.2556388895435, -287.55161156361885, -478.6670049870704, -840.8230698923696, -1189.9608642698402, -590.0303430543693, -879.2935463087076, -270.6957012004212, -1151.1044424525849, -580.0322176974219, -670.4632469411529, -210.5573094821735, -968.5968888584327, -746.3756388279664, -137.73213226472544, -1121.6652033678424, -667.9984910298848, -1364.1036115603981, -626.7272803327534, -1089.5284341187448, -1169.4031476019381, -948.8141389537972, -736.3969538789505, -970.400253246141, -1114.3174493794343, -74.50652424323061, -960.09425516221, -179.80612120024648, -485.3868958931981, -1139.278724769772, -622.7172582362914, -1034.055454408653, -416.3644179623148, -1178.7381662690648, -655.2491028332219, -262.1680150522501, -398.8893791881332, -209.31685789168606, -1149.0659021110985, -783.655207935661, -1050.0330567128399, -1120.9961338894436, -995.7264147080173, -915.3558194405974, -323.2766305112043, -882.5746437254929, -1011.5145701453375, -941.9172684491292, -1147.2647269180695, -1025.182491965109, -171.1731598627219, -629.3960615527008, -946.8871759351324, -959.7070238152978, -707.3940314399975, -877.5836136240953, -669.6594383529279, -609.4870268314015, -1267.4961839053217, -292.7417459672212, -1350.1438651184583, -885.8584987995583, -1064.5483452371695, -693.7088462931679, -56.26679108965543, -1126.1805118230534, -661.2947590569578], "episode_lengths": [150, 150, 150, 150, 66, 150, 77, 150, 150, 76, 106, 150, 150, 150, 150, 150, 150, 149, 40, 150, 150, 150, 150, 150, 150, 144, 150, 148, 49, 62, 108, 150, 150, 136, 79, 150, 150, 150, 118, 150, 103, 150, 128, 130, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 67, 139, 150, 150, 150, 101, 150, 150, 90, 93, 150, 150, 139, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 122, 124, 150, 84, 150, 150, 150, 127, 55, 150, 150], "policy_policy_0_reward": [-1389.8594362683916, -1056.090753239396, -432.6436153321225, -753.613476585728, -75.5508359455234, -1061.4657779163497, -233.1512941172223, -806.7785713065373, -1108.5870831263928, -289.6765584835428, -378.66400280569763, -626.7368075836939, -1005.3839702696686, -909.8805882238573, -556.0688769485721, -949.806236991398, -1168.3689235738454, -778.7383731384523, -35.84064274412364, -1173.0797000838156, -921.7627717483804, -846.5311534639252, -1373.223768452605, -639.6257786142119, -648.5307427131121, -584.9710642366036, -1175.7879268184606, -725.8747229964051, -34.373016881751525, -109.54872361959868, -552.0159553561892, -610.4882031054714, -1156.6606189654085, -590.2556388895435, -287.55161156361885, -478.6670049870704, -840.8230698923696, -1189.9608642698402, -590.0303430543693, -879.2935463087076, -270.6957012004212, -1151.1044424525849, -580.0322176974219, -670.4632469411529, -210.5573094821735, -968.5968888584327, -746.3756388279664, -137.73213226472544, -1121.6652033678424, -667.9984910298848, -1364.1036115603981, -626.7272803327534, -1089.5284341187448, -1169.4031476019381, -948.8141389537972, -736.3969538789505, -970.400253246141, -1114.3174493794343, -74.50652424323061, -960.09425516221, -179.80612120024648, -485.3868958931981, -1139.278724769772, -622.7172582362914, -1034.055454408653, -416.3644179623148, -1178.7381662690648, -655.2491028332219, -262.1680150522501, -398.8893791881332, -209.31685789168606, -1149.0659021110985, -783.655207935661, -1050.0330567128399, -1120.9961338894436, -995.7264147080173, -915.3558194405974, -323.2766305112043, -882.5746437254929, -1011.5145701453375, -941.9172684491292, -1147.2647269180695, -1025.182491965109, -171.1731598627219, -629.3960615527008, -946.8871759351324, -959.7070238152978, -707.3940314399975, -877.5836136240953, -669.6594383529279, -609.4870268314015, -1267.4961839053217, -292.7417459672212, -1350.1438651184583, -885.8584987995583, -1064.5483452371695, -693.7088462931679, -56.26679108965543, -1126.1805118230534, -661.2947590569578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591368341000976, "mean_inference_ms": 1.6881315388811473, "mean_action_processing_ms": 0.2791377736153061, "mean_env_wait_ms": 3.5092698349559766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012108325958251953, "StateBufferConnector_ms": 0.016252994537353516, "ViewRequirementAgentConnector_ms": 0.19417572021484375}, "num_episodes": 26, "episode_return_max": -34.373016881751525, "episode_return_min": -1389.8594362683916, "episode_return_mean": -755.0353571014385, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.1764328349819, "num_env_steps_trained_throughput_per_sec": 518.1764328349819, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12366.98, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12366.903, "sample_time_ms": 1193.161, "learn_time_ms": 11107.382, "learn_throughput": 360.121, "synch_weights_time_ms": 65.521}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00012", "date": "2024-08-04_06-37-28", "timestamp": 1722733648, "time_this_iter_s": 7.734809160232544, "time_total_s": 175.88036632537842, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4b250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 175.88036632537842, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.63636363636363, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.38670685688655, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.075808608656128, "policy_loss": -0.003951502615624728, "vf_loss": 3.0768413222084443, "vf_explained_var": 0.9492725224544605, "kl": 0.015413101458792274, "entropy": 1.6383422238131364, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -3.214649466564473, "episode_reward_min": -1384.1966759922773, "episode_reward_mean": -789.226903493603, "episode_len_mean": 136.03, "episode_media": {}, "episodes_timesteps_total": 13603, "policy_reward_min": {"policy_0": -1384.1966759922773}, "policy_reward_max": {"policy_0": -3.214649466564473}, "policy_reward_mean": {"policy_0": -789.226903493603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-552.0159553561892, -610.4882031054714, -1156.6606189654085, -590.2556388895435, -287.55161156361885, -478.6670049870704, -840.8230698923696, -1189.9608642698402, -590.0303430543693, -879.2935463087076, -270.6957012004212, -1151.1044424525849, -580.0322176974219, -670.4632469411529, -210.5573094821735, -968.5968888584327, -746.3756388279664, -137.73213226472544, -1121.6652033678424, -667.9984910298848, -1364.1036115603981, -626.7272803327534, -1089.5284341187448, -1169.4031476019381, -948.8141389537972, -736.3969538789505, -970.400253246141, -1114.3174493794343, -74.50652424323061, -960.09425516221, -179.80612120024648, -485.3868958931981, -1139.278724769772, -622.7172582362914, -1034.055454408653, -416.3644179623148, -1178.7381662690648, -655.2491028332219, -262.1680150522501, -398.8893791881332, -209.31685789168606, -1149.0659021110985, -783.655207935661, -1050.0330567128399, -1120.9961338894436, -995.7264147080173, -915.3558194405974, -323.2766305112043, -882.5746437254929, -1011.5145701453375, -941.9172684491292, -1147.2647269180695, -1025.182491965109, -171.1731598627219, -629.3960615527008, -946.8871759351324, -959.7070238152978, -707.3940314399975, -877.5836136240953, -669.6594383529279, -609.4870268314015, -1267.4961839053217, -292.7417459672212, -1350.1438651184583, -885.8584987995583, -1064.5483452371695, -693.7088462931679, -56.26679108965543, -1126.1805118230534, -661.2947590569578, -874.0568488182262, -236.12383926998714, -400.2712820289759, -1242.330359383924, -848.6367727521255, -803.3852847624382, -954.9085981965151, -839.8592671593773, -894.0986095983253, -693.136843639028, -1187.5860526074302, -395.34378841634106, -1100.0518347469845, -999.3579907181803, -795.1563097902693, -811.5253064824733, -868.9662221661816, -415.2256939382879, -116.63782728036574, -1135.4657575492777, -891.8454182047128, -1004.9336223359049, -1107.271514321162, -1110.3761736075453, -616.0285578240934, -1379.3924443787391, -1197.3649263435489, -3.214649466564473, -962.6213616665787, -1384.1966759922773], "episode_lengths": [108, 150, 150, 136, 79, 150, 150, 150, 118, 150, 103, 150, 128, 130, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 67, 139, 150, 150, 150, 101, 150, 150, 90, 93, 150, 150, 139, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 122, 124, 150, 84, 150, 150, 150, 127, 55, 150, 150, 150, 90, 126, 150, 150, 150, 150, 149, 150, 150, 150, 119, 150, 150, 150, 150, 150, 97, 52, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150], "policy_policy_0_reward": [-552.0159553561892, -610.4882031054714, -1156.6606189654085, -590.2556388895435, -287.55161156361885, -478.6670049870704, -840.8230698923696, -1189.9608642698402, -590.0303430543693, -879.2935463087076, -270.6957012004212, -1151.1044424525849, -580.0322176974219, -670.4632469411529, -210.5573094821735, -968.5968888584327, -746.3756388279664, -137.73213226472544, -1121.6652033678424, -667.9984910298848, -1364.1036115603981, -626.7272803327534, -1089.5284341187448, -1169.4031476019381, -948.8141389537972, -736.3969538789505, -970.400253246141, -1114.3174493794343, -74.50652424323061, -960.09425516221, -179.80612120024648, -485.3868958931981, -1139.278724769772, -622.7172582362914, -1034.055454408653, -416.3644179623148, -1178.7381662690648, -655.2491028332219, -262.1680150522501, -398.8893791881332, -209.31685789168606, -1149.0659021110985, -783.655207935661, -1050.0330567128399, -1120.9961338894436, -995.7264147080173, -915.3558194405974, -323.2766305112043, -882.5746437254929, -1011.5145701453375, -941.9172684491292, -1147.2647269180695, -1025.182491965109, -171.1731598627219, -629.3960615527008, -946.8871759351324, -959.7070238152978, -707.3940314399975, -877.5836136240953, -669.6594383529279, -609.4870268314015, -1267.4961839053217, -292.7417459672212, -1350.1438651184583, -885.8584987995583, -1064.5483452371695, -693.7088462931679, -56.26679108965543, -1126.1805118230534, -661.2947590569578, -874.0568488182262, -236.12383926998714, -400.2712820289759, -1242.330359383924, -848.6367727521255, -803.3852847624382, -954.9085981965151, -839.8592671593773, -894.0986095983253, -693.136843639028, -1187.5860526074302, -395.34378841634106, -1100.0518347469845, -999.3579907181803, -795.1563097902693, -811.5253064824733, -868.9662221661816, -415.2256939382879, -116.63782728036574, -1135.4657575492777, -891.8454182047128, -1004.9336223359049, -1107.271514321162, -1110.3761736075453, -616.0285578240934, -1379.3924443787391, -1197.3649263435489, -3.214649466564473, -962.6213616665787, -1384.1966759922773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5582440158492009, "mean_inference_ms": 1.6880947634265582, "mean_action_processing_ms": 0.2786285519578103, "mean_env_wait_ms": 3.512403501440358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012103080749511719, "StateBufferConnector_ms": 0.01617288589477539, "ViewRequirementAgentConnector_ms": 0.19170022010803223}, "num_episodes": 30, "episode_return_max": -3.214649466564473, "episode_return_min": -1384.1966759922773, "episode_return_mean": -789.226903493603, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.46265093666636, "num_env_steps_trained_throughput_per_sec": 306.46265093666636, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12369.469, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12369.393, "sample_time_ms": 1185.146, "learn_time_ms": 11119.964, "learn_throughput": 359.713, "synch_weights_time_ms": 63.45}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00012", "date": "2024-08-04_06-37-41", "timestamp": 1722733661, "time_this_iter_s": 13.065465927124023, "time_total_s": 188.94583225250244, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.94583225250244, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.28421052631579, "ram_util_percent": 28.021052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.37118285397688, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.6885285794734957, "policy_loss": -0.01340942984437182, "vf_loss": 2.6976646275569993, "vf_explained_var": 0.9858264903848369, "kl": 0.022016135247758938, "entropy": 1.2985221359878778, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -3.214649466564473, "episode_reward_min": -1489.2658905370733, "episode_reward_mean": -804.4848901686522, "episode_len_mean": 136.85, "episode_media": {}, "episodes_timesteps_total": 13685, "policy_reward_min": {"policy_0": -1489.2658905370733}, "policy_reward_max": {"policy_0": -3.214649466564473}, "policy_reward_mean": {"policy_0": -804.4848901686522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.80612120024648, -485.3868958931981, -1139.278724769772, -622.7172582362914, -1034.055454408653, -416.3644179623148, -1178.7381662690648, -655.2491028332219, -262.1680150522501, -398.8893791881332, -209.31685789168606, -1149.0659021110985, -783.655207935661, -1050.0330567128399, -1120.9961338894436, -995.7264147080173, -915.3558194405974, -323.2766305112043, -882.5746437254929, -1011.5145701453375, -941.9172684491292, -1147.2647269180695, -1025.182491965109, -171.1731598627219, -629.3960615527008, -946.8871759351324, -959.7070238152978, -707.3940314399975, -877.5836136240953, -669.6594383529279, -609.4870268314015, -1267.4961839053217, -292.7417459672212, -1350.1438651184583, -885.8584987995583, -1064.5483452371695, -693.7088462931679, -56.26679108965543, -1126.1805118230534, -661.2947590569578, -874.0568488182262, -236.12383926998714, -400.2712820289759, -1242.330359383924, -848.6367727521255, -803.3852847624382, -954.9085981965151, -839.8592671593773, -894.0986095983253, -693.136843639028, -1187.5860526074302, -395.34378841634106, -1100.0518347469845, -999.3579907181803, -795.1563097902693, -811.5253064824733, -868.9662221661816, -415.2256939382879, -116.63782728036574, -1135.4657575492777, -891.8454182047128, -1004.9336223359049, -1107.271514321162, -1110.3761736075453, -616.0285578240934, -1379.3924443787391, -1197.3649263435489, -3.214649466564473, -962.6213616665787, -1384.1966759922773, -649.8727271778887, -550.1478814694767, -841.6649030215627, -591.9705328342071, -1207.7048422838634, -1273.8752824958003, -868.9823571176346, -483.4406965849573, -1096.2912183895523, -965.3880966643019, -351.46151735461007, -1022.992750800665, -1489.2658905370733, -656.5099615533273, -1012.6123095093963, -320.77533027268436, -518.2289588968191, -250.6965201601214, -73.55838286308224, -741.5663818831049, -840.811732569824, -1179.6137638295743, -1105.3925316673563, -555.4496967242121, -931.4601964857009, -1229.3351045559848, -424.82193350209604, -972.5364209759675, -1187.6055118959437, -887.0254104209113], "episode_lengths": [67, 139, 150, 150, 150, 101, 150, 150, 90, 93, 150, 150, 139, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 122, 124, 150, 84, 150, 150, 150, 127, 55, 150, 150, 150, 90, 126, 150, 150, 150, 150, 149, 150, 150, 150, 119, 150, 150, 150, 150, 150, 97, 52, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 122, 150, 150, 150, 150, 150, 146, 150, 150, 88, 150, 150, 150, 150, 125, 150, 92, 67, 150, 150, 150, 150, 131, 150, 150, 103, 150, 150, 150], "policy_policy_0_reward": [-179.80612120024648, -485.3868958931981, -1139.278724769772, -622.7172582362914, -1034.055454408653, -416.3644179623148, -1178.7381662690648, -655.2491028332219, -262.1680150522501, -398.8893791881332, -209.31685789168606, -1149.0659021110985, -783.655207935661, -1050.0330567128399, -1120.9961338894436, -995.7264147080173, -915.3558194405974, -323.2766305112043, -882.5746437254929, -1011.5145701453375, -941.9172684491292, -1147.2647269180695, -1025.182491965109, -171.1731598627219, -629.3960615527008, -946.8871759351324, -959.7070238152978, -707.3940314399975, -877.5836136240953, -669.6594383529279, -609.4870268314015, -1267.4961839053217, -292.7417459672212, -1350.1438651184583, -885.8584987995583, -1064.5483452371695, -693.7088462931679, -56.26679108965543, -1126.1805118230534, -661.2947590569578, -874.0568488182262, -236.12383926998714, -400.2712820289759, -1242.330359383924, -848.6367727521255, -803.3852847624382, -954.9085981965151, -839.8592671593773, -894.0986095983253, -693.136843639028, -1187.5860526074302, -395.34378841634106, -1100.0518347469845, -999.3579907181803, -795.1563097902693, -811.5253064824733, -868.9662221661816, -415.2256939382879, -116.63782728036574, -1135.4657575492777, -891.8454182047128, -1004.9336223359049, -1107.271514321162, -1110.3761736075453, -616.0285578240934, -1379.3924443787391, -1197.3649263435489, -3.214649466564473, -962.6213616665787, -1384.1966759922773, -649.8727271778887, -550.1478814694767, -841.6649030215627, -591.9705328342071, -1207.7048422838634, -1273.8752824958003, -868.9823571176346, -483.4406965849573, -1096.2912183895523, -965.3880966643019, -351.46151735461007, -1022.992750800665, -1489.2658905370733, -656.5099615533273, -1012.6123095093963, -320.77533027268436, -518.2289588968191, -250.6965201601214, -73.55838286308224, -741.5663818831049, -840.811732569824, -1179.6137638295743, -1105.3925316673563, -555.4496967242121, -931.4601964857009, -1229.3351045559848, -424.82193350209604, -972.5364209759675, -1187.6055118959437, -887.0254104209113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557425701721021, "mean_inference_ms": 1.6879369420878527, "mean_action_processing_ms": 0.2784553543886902, "mean_env_wait_ms": 3.5162740167796347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01284646987915039, "StateBufferConnector_ms": 0.016119718551635742, "ViewRequirementAgentConnector_ms": 0.1947479248046875}, "num_episodes": 30, "episode_return_max": -3.214649466564473, "episode_return_min": -1489.2658905370733, "episode_return_mean": -804.4848901686522, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.32565937309226, "num_env_steps_trained_throughput_per_sec": 305.32565937309226, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12424.179, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12424.103, "sample_time_ms": 1178.531, "learn_time_ms": 11180.63, "learn_throughput": 357.762, "synch_weights_time_ms": 64.109}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00012", "date": "2024-08-04_06-37-54", "timestamp": 1722733674, "time_this_iter_s": 13.114089012145996, "time_total_s": 202.05992126464844, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091fa30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 202.05992126464844, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.326315789473686, "ram_util_percent": 28.094736842105267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.837048175931, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6845170121639965, "policy_loss": -0.009678340373890629, "vf_loss": 2.690332308287422, "vf_explained_var": 0.9700176714609067, "kl": 0.013310060655173098, "entropy": 1.2996157908812165, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -3.214649466564473, "episode_reward_min": -1489.2658905370733, "episode_reward_mean": -755.3956343764122, "episode_len_mean": 133.93, "episode_media": {}, "episodes_timesteps_total": 13393, "policy_reward_min": {"policy_0": -1489.2658905370733}, "policy_reward_max": {"policy_0": -3.214649466564473}, "policy_reward_mean": {"policy_0": -755.3956343764122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-877.5836136240953, -669.6594383529279, -609.4870268314015, -1267.4961839053217, -292.7417459672212, -1350.1438651184583, -885.8584987995583, -1064.5483452371695, -693.7088462931679, -56.26679108965543, -1126.1805118230534, -661.2947590569578, -874.0568488182262, -236.12383926998714, -400.2712820289759, -1242.330359383924, -848.6367727521255, -803.3852847624382, -954.9085981965151, -839.8592671593773, -894.0986095983253, -693.136843639028, -1187.5860526074302, -395.34378841634106, -1100.0518347469845, -999.3579907181803, -795.1563097902693, -811.5253064824733, -868.9662221661816, -415.2256939382879, -116.63782728036574, -1135.4657575492777, -891.8454182047128, -1004.9336223359049, -1107.271514321162, -1110.3761736075453, -616.0285578240934, -1379.3924443787391, -1197.3649263435489, -3.214649466564473, -962.6213616665787, -1384.1966759922773, -649.8727271778887, -550.1478814694767, -841.6649030215627, -591.9705328342071, -1207.7048422838634, -1273.8752824958003, -868.9823571176346, -483.4406965849573, -1096.2912183895523, -965.3880966643019, -351.46151735461007, -1022.992750800665, -1489.2658905370733, -656.5099615533273, -1012.6123095093963, -320.77533027268436, -518.2289588968191, -250.6965201601214, -73.55838286308224, -741.5663818831049, -840.811732569824, -1179.6137638295743, -1105.3925316673563, -555.4496967242121, -931.4601964857009, -1229.3351045559848, -424.82193350209604, -972.5364209759675, -1187.6055118959437, -887.0254104209113, -812.7411366413226, -116.28997094793301, -377.28441554842584, -120.58884640948673, -305.0471869842814, -524.6642840173645, -643.3453073638534, -633.3876380354778, -474.1156918448174, -611.2435091466314, -166.4946176022243, -647.5743016413725, -320.69842436485493, -240.8699221344345, -1067.5082666260505, -356.57072854920347, -675.3212252403968, -960.6195928864558, -1178.3317562942877, -748.2915135371201, -880.1267407981283, -456.28277124735513, -447.2937013724073, -1095.7921433170188, -742.1586201959997, -81.30727472192602, -1011.3065098270324, -738.9090363028264], "episode_lengths": [150, 122, 124, 150, 84, 150, 150, 150, 127, 55, 150, 150, 150, 90, 126, 150, 150, 150, 150, 149, 150, 150, 150, 119, 150, 150, 150, 150, 150, 97, 52, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 122, 150, 150, 150, 150, 150, 146, 150, 150, 88, 150, 150, 150, 150, 125, 150, 92, 67, 150, 150, 150, 150, 131, 150, 150, 103, 150, 150, 150, 150, 70, 113, 59, 121, 150, 150, 150, 120, 135, 66, 150, 86, 134, 150, 88, 150, 150, 150, 150, 150, 114, 126, 150, 150, 57, 150, 150], "policy_policy_0_reward": [-877.5836136240953, -669.6594383529279, -609.4870268314015, -1267.4961839053217, -292.7417459672212, -1350.1438651184583, -885.8584987995583, -1064.5483452371695, -693.7088462931679, -56.26679108965543, -1126.1805118230534, -661.2947590569578, -874.0568488182262, -236.12383926998714, -400.2712820289759, -1242.330359383924, -848.6367727521255, -803.3852847624382, -954.9085981965151, -839.8592671593773, -894.0986095983253, -693.136843639028, -1187.5860526074302, -395.34378841634106, -1100.0518347469845, -999.3579907181803, -795.1563097902693, -811.5253064824733, -868.9662221661816, -415.2256939382879, -116.63782728036574, -1135.4657575492777, -891.8454182047128, -1004.9336223359049, -1107.271514321162, -1110.3761736075453, -616.0285578240934, -1379.3924443787391, -1197.3649263435489, -3.214649466564473, -962.6213616665787, -1384.1966759922773, -649.8727271778887, -550.1478814694767, -841.6649030215627, -591.9705328342071, -1207.7048422838634, -1273.8752824958003, -868.9823571176346, -483.4406965849573, -1096.2912183895523, -965.3880966643019, -351.46151735461007, -1022.992750800665, -1489.2658905370733, -656.5099615533273, -1012.6123095093963, -320.77533027268436, -518.2289588968191, -250.6965201601214, -73.55838286308224, -741.5663818831049, -840.811732569824, -1179.6137638295743, -1105.3925316673563, -555.4496967242121, -931.4601964857009, -1229.3351045559848, -424.82193350209604, -972.5364209759675, -1187.6055118959437, -887.0254104209113, -812.7411366413226, -116.28997094793301, -377.28441554842584, -120.58884640948673, -305.0471869842814, -524.6642840173645, -643.3453073638534, -633.3876380354778, -474.1156918448174, -611.2435091466314, -166.4946176022243, -647.5743016413725, -320.69842436485493, -240.8699221344345, -1067.5082666260505, -356.57072854920347, -675.3212252403968, -960.6195928864558, -1178.3317562942877, -748.2915135371201, -880.1267407981283, -456.28277124735513, -447.2937013724073, -1095.7921433170188, -742.1586201959997, -81.30727472192602, -1011.3065098270324, -738.9090363028264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573913146339584, "mean_inference_ms": 1.6876788691537232, "mean_action_processing_ms": 0.2784242680775664, "mean_env_wait_ms": 3.516380538654257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012984514236450195, "StateBufferConnector_ms": 0.008176088333129883, "ViewRequirementAgentConnector_ms": 0.1976766586303711}, "num_episodes": 28, "episode_return_max": -3.214649466564473, "episode_return_min": -1489.2658905370733, "episode_return_mean": -755.3956343764122, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.47994495097265, "num_env_steps_trained_throughput_per_sec": 331.47994495097265, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12371.327, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12371.25, "sample_time_ms": 1180.448, "learn_time_ms": 11125.96, "learn_throughput": 359.52, "synch_weights_time_ms": 64.002}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00012", "date": "2024-08-04_06-38-06", "timestamp": 1722733686, "time_this_iter_s": 12.079866409301758, "time_total_s": 214.1397876739502, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4b250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.1397876739502, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.941176470588236, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 176.51082976261776, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.009216021373868, "policy_loss": -0.008607163428678177, "vf_loss": 3.013664782171448, "vf_explained_var": 0.9408477386459708, "kl": 0.014314430534886924, "entropy": 1.359417009477814, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -3.214649466564473, "episode_reward_min": -1489.2658905370733, "episode_reward_mean": -707.5470085243786, "episode_len_mean": 130.46, "episode_media": {}, "episodes_timesteps_total": 13046, "policy_reward_min": {"policy_0": -1489.2658905370733}, "policy_reward_max": {"policy_0": -3.214649466564473}, "policy_reward_mean": {"policy_0": -707.5470085243786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-616.0285578240934, -1379.3924443787391, -1197.3649263435489, -3.214649466564473, -962.6213616665787, -1384.1966759922773, -649.8727271778887, -550.1478814694767, -841.6649030215627, -591.9705328342071, -1207.7048422838634, -1273.8752824958003, -868.9823571176346, -483.4406965849573, -1096.2912183895523, -965.3880966643019, -351.46151735461007, -1022.992750800665, -1489.2658905370733, -656.5099615533273, -1012.6123095093963, -320.77533027268436, -518.2289588968191, -250.6965201601214, -73.55838286308224, -741.5663818831049, -840.811732569824, -1179.6137638295743, -1105.3925316673563, -555.4496967242121, -931.4601964857009, -1229.3351045559848, -424.82193350209604, -972.5364209759675, -1187.6055118959437, -887.0254104209113, -812.7411366413226, -116.28997094793301, -377.28441554842584, -120.58884640948673, -305.0471869842814, -524.6642840173645, -643.3453073638534, -633.3876380354778, -474.1156918448174, -611.2435091466314, -166.4946176022243, -647.5743016413725, -320.69842436485493, -240.8699221344345, -1067.5082666260505, -356.57072854920347, -675.3212252403968, -960.6195928864558, -1178.3317562942877, -748.2915135371201, -880.1267407981283, -456.28277124735513, -447.2937013724073, -1095.7921433170188, -742.1586201959997, -81.30727472192602, -1011.3065098270324, -738.9090363028264, -501.2216852059863, -31.365380997052963, -45.8571750608311, -1239.2705142522927, -780.787738820393, -511.71606541441946, -384.41594854268686, -79.52462681928503, -516.5113329973879, -466.42019524661146, -761.4626373237618, -1191.1897098788595, -1120.4879612785078, -337.3821987334037, -367.82127483014915, -934.2131537640989, -188.51931427538176, -964.2948675988682, -612.2536507283107, -742.0529231526226, -613.791581971478, -968.9602633032579, -853.8202052845352, -791.5381802754998, -855.9374960472273, -1094.36142946446, -1148.9234461248682, -1350.427866437976, -951.6971688604729, -1013.7370361321969, -176.86549736190622, -825.1798900282096, -728.6549524659629, -383.35114379391615, -678.5080219637808, -284.13572423301093], "episode_lengths": [150, 150, 150, 35, 150, 150, 150, 122, 150, 150, 150, 150, 150, 146, 150, 150, 88, 150, 150, 150, 150, 125, 150, 92, 67, 150, 150, 150, 150, 131, 150, 150, 103, 150, 150, 150, 150, 70, 113, 59, 121, 150, 150, 150, 120, 135, 66, 150, 86, 134, 150, 88, 150, 150, 150, 150, 150, 114, 126, 150, 150, 57, 150, 150, 150, 49, 44, 150, 150, 118, 104, 71, 115, 100, 150, 150, 150, 112, 90, 150, 86, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 135, 125, 105, 150, 113], "policy_policy_0_reward": [-616.0285578240934, -1379.3924443787391, -1197.3649263435489, -3.214649466564473, -962.6213616665787, -1384.1966759922773, -649.8727271778887, -550.1478814694767, -841.6649030215627, -591.9705328342071, -1207.7048422838634, -1273.8752824958003, -868.9823571176346, -483.4406965849573, -1096.2912183895523, -965.3880966643019, -351.46151735461007, -1022.992750800665, -1489.2658905370733, -656.5099615533273, -1012.6123095093963, -320.77533027268436, -518.2289588968191, -250.6965201601214, -73.55838286308224, -741.5663818831049, -840.811732569824, -1179.6137638295743, -1105.3925316673563, -555.4496967242121, -931.4601964857009, -1229.3351045559848, -424.82193350209604, -972.5364209759675, -1187.6055118959437, -887.0254104209113, -812.7411366413226, -116.28997094793301, -377.28441554842584, -120.58884640948673, -305.0471869842814, -524.6642840173645, -643.3453073638534, -633.3876380354778, -474.1156918448174, -611.2435091466314, -166.4946176022243, -647.5743016413725, -320.69842436485493, -240.8699221344345, -1067.5082666260505, -356.57072854920347, -675.3212252403968, -960.6195928864558, -1178.3317562942877, -748.2915135371201, -880.1267407981283, -456.28277124735513, -447.2937013724073, -1095.7921433170188, -742.1586201959997, -81.30727472192602, -1011.3065098270324, -738.9090363028264, -501.2216852059863, -31.365380997052963, -45.8571750608311, -1239.2705142522927, -780.787738820393, -511.71606541441946, -384.41594854268686, -79.52462681928503, -516.5113329973879, -466.42019524661146, -761.4626373237618, -1191.1897098788595, -1120.4879612785078, -337.3821987334037, -367.82127483014915, -934.2131537640989, -188.51931427538176, -964.2948675988682, -612.2536507283107, -742.0529231526226, -613.791581971478, -968.9602633032579, -853.8202052845352, -791.5381802754998, -855.9374960472273, -1094.36142946446, -1148.9234461248682, -1350.427866437976, -951.6971688604729, -1013.7370361321969, -176.86549736190622, -825.1798900282096, -728.6549524659629, -383.35114379391615, -678.5080219637808, -284.13572423301093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576741669670187, "mean_inference_ms": 1.686093113672797, "mean_action_processing_ms": 0.27803056535408416, "mean_env_wait_ms": 3.5154902212020027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013235330581665039, "StateBufferConnector_ms": 0.008211374282836914, "ViewRequirementAgentConnector_ms": 0.20018267631530762}, "num_episodes": 36, "episode_return_max": -3.214649466564473, "episode_return_min": -1489.2658905370733, "episode_return_mean": -707.5470085243786, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.47145933524854, "num_env_steps_trained_throughput_per_sec": 303.47145933524854, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12359.53, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12359.453, "sample_time_ms": 1179.688, "learn_time_ms": 11115.227, "learn_throughput": 359.867, "synch_weights_time_ms": 63.702}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00012", "date": "2024-08-04_06-38-19", "timestamp": 1722733699, "time_this_iter_s": 13.194077491760254, "time_total_s": 227.33386516571045, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.33386516571045, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.13684210526316, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.76482855478923, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6058454044163226, "policy_loss": -0.004806703724898398, "vf_loss": 2.606252387786905, "vf_explained_var": 0.9784735475977262, "kl": 0.015123998380052716, "entropy": 1.3748059247930844, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -31.365380997052963, "episode_reward_min": -1350.427866437976, "episode_reward_mean": -660.9022741912934, "episode_len_mean": 126.15, "episode_media": {}, "episodes_timesteps_total": 12615, "policy_reward_min": {"policy_0": -1350.427866437976}, "policy_reward_max": {"policy_0": -31.365380997052963}, "policy_reward_mean": {"policy_0": -660.9022741912934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-424.82193350209604, -972.5364209759675, -1187.6055118959437, -887.0254104209113, -812.7411366413226, -116.28997094793301, -377.28441554842584, -120.58884640948673, -305.0471869842814, -524.6642840173645, -643.3453073638534, -633.3876380354778, -474.1156918448174, -611.2435091466314, -166.4946176022243, -647.5743016413725, -320.69842436485493, -240.8699221344345, -1067.5082666260505, -356.57072854920347, -675.3212252403968, -960.6195928864558, -1178.3317562942877, -748.2915135371201, -880.1267407981283, -456.28277124735513, -447.2937013724073, -1095.7921433170188, -742.1586201959997, -81.30727472192602, -1011.3065098270324, -738.9090363028264, -501.2216852059863, -31.365380997052963, -45.8571750608311, -1239.2705142522927, -780.787738820393, -511.71606541441946, -384.41594854268686, -79.52462681928503, -516.5113329973879, -466.42019524661146, -761.4626373237618, -1191.1897098788595, -1120.4879612785078, -337.3821987334037, -367.82127483014915, -934.2131537640989, -188.51931427538176, -964.2948675988682, -612.2536507283107, -742.0529231526226, -613.791581971478, -968.9602633032579, -853.8202052845352, -791.5381802754998, -855.9374960472273, -1094.36142946446, -1148.9234461248682, -1350.427866437976, -951.6971688604729, -1013.7370361321969, -176.86549736190622, -825.1798900282096, -728.6549524659629, -383.35114379391615, -678.5080219637808, -284.13572423301093, -940.0985413583397, -116.75405989453252, -882.8506204114561, -362.712996708987, -228.96708089318074, -329.94539658313386, -625.3037747039491, -204.87453783116183, -1132.0082402530065, -1058.0394427378978, -795.5601857314019, -886.0860983069422, -198.2245560129748, -1076.5734976113163, -132.23244417354684, -1278.887838745057, -54.565828827047405, -1273.2983225536123, -1234.3517428145742, -448.330334165253, -960.1910155125487, -346.1361845533283, -788.6024314834604, -790.0188549778915, -834.3587214821779, -430.15885262894517, -154.4026900749189, -86.00717607012558, -1060.3895406229199, -1155.760862827838, -1038.2036641771515, -783.5192153373802], "episode_lengths": [103, 150, 150, 150, 150, 70, 113, 59, 121, 150, 150, 150, 120, 135, 66, 150, 86, 134, 150, 88, 150, 150, 150, 150, 150, 114, 126, 150, 150, 57, 150, 150, 150, 49, 44, 150, 150, 118, 104, 71, 115, 100, 150, 150, 150, 112, 90, 150, 86, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 135, 125, 105, 150, 113, 150, 68, 150, 96, 118, 99, 146, 92, 150, 150, 150, 150, 65, 150, 78, 150, 59, 150, 150, 127, 150, 98, 150, 150, 150, 98, 80, 51, 150, 150, 150, 150], "policy_policy_0_reward": [-424.82193350209604, -972.5364209759675, -1187.6055118959437, -887.0254104209113, -812.7411366413226, -116.28997094793301, -377.28441554842584, -120.58884640948673, -305.0471869842814, -524.6642840173645, -643.3453073638534, -633.3876380354778, -474.1156918448174, -611.2435091466314, -166.4946176022243, -647.5743016413725, -320.69842436485493, -240.8699221344345, -1067.5082666260505, -356.57072854920347, -675.3212252403968, -960.6195928864558, -1178.3317562942877, -748.2915135371201, -880.1267407981283, -456.28277124735513, -447.2937013724073, -1095.7921433170188, -742.1586201959997, -81.30727472192602, -1011.3065098270324, -738.9090363028264, -501.2216852059863, -31.365380997052963, -45.8571750608311, -1239.2705142522927, -780.787738820393, -511.71606541441946, -384.41594854268686, -79.52462681928503, -516.5113329973879, -466.42019524661146, -761.4626373237618, -1191.1897098788595, -1120.4879612785078, -337.3821987334037, -367.82127483014915, -934.2131537640989, -188.51931427538176, -964.2948675988682, -612.2536507283107, -742.0529231526226, -613.791581971478, -968.9602633032579, -853.8202052845352, -791.5381802754998, -855.9374960472273, -1094.36142946446, -1148.9234461248682, -1350.427866437976, -951.6971688604729, -1013.7370361321969, -176.86549736190622, -825.1798900282096, -728.6549524659629, -383.35114379391615, -678.5080219637808, -284.13572423301093, -940.0985413583397, -116.75405989453252, -882.8506204114561, -362.712996708987, -228.96708089318074, -329.94539658313386, -625.3037747039491, -204.87453783116183, -1132.0082402530065, -1058.0394427378978, -795.5601857314019, -886.0860983069422, -198.2245560129748, -1076.5734976113163, -132.23244417354684, -1278.887838745057, -54.565828827047405, -1273.2983225536123, -1234.3517428145742, -448.330334165253, -960.1910155125487, -346.1361845533283, -788.6024314834604, -790.0188549778915, -834.3587214821779, -430.15885262894517, -154.4026900749189, -86.00717607012558, -1060.3895406229199, -1155.760862827838, -1038.2036641771515, -783.5192153373802]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5583823093823164, "mean_inference_ms": 1.6860519572471506, "mean_action_processing_ms": 0.2778802186223125, "mean_env_wait_ms": 3.5159897915702727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012883424758911133, "StateBufferConnector_ms": 0.008204221725463867, "ViewRequirementAgentConnector_ms": 0.19659781455993652}, "num_episodes": 32, "episode_return_max": -31.365380997052963, "episode_return_min": -1350.427866437976, "episode_return_mean": -660.9022741912934, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7489492480231, "num_env_steps_trained_throughput_per_sec": 302.7489492480231, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12397.209, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12397.134, "sample_time_ms": 1176.909, "learn_time_ms": 11156.89, "learn_throughput": 358.523, "synch_weights_time_ms": 62.504}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00012", "date": "2024-08-04_06-38-33", "timestamp": 1722733713, "time_this_iter_s": 13.224965572357178, "time_total_s": 240.55883073806763, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fbb400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.55883073806763, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.68888888888889, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.5178542594115, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2553908864657086, "policy_loss": -0.008032760146791891, "vf_loss": 2.2591429237276315, "vf_explained_var": 0.9713963058466712, "kl": 0.01476697313122107, "entropy": 1.4937283729513486, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -21.75261467021253, "episode_reward_min": -1350.427866437976, "episode_reward_mean": -691.0184450987705, "episode_len_mean": 127.05, "episode_media": {}, "episodes_timesteps_total": 12705, "policy_reward_min": {"policy_0": -1350.427866437976}, "policy_reward_max": {"policy_0": -21.75261467021253}, "policy_reward_mean": {"policy_0": -691.0184450987705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-742.1586201959997, -81.30727472192602, -1011.3065098270324, -738.9090363028264, -501.2216852059863, -31.365380997052963, -45.8571750608311, -1239.2705142522927, -780.787738820393, -511.71606541441946, -384.41594854268686, -79.52462681928503, -516.5113329973879, -466.42019524661146, -761.4626373237618, -1191.1897098788595, -1120.4879612785078, -337.3821987334037, -367.82127483014915, -934.2131537640989, -188.51931427538176, -964.2948675988682, -612.2536507283107, -742.0529231526226, -613.791581971478, -968.9602633032579, -853.8202052845352, -791.5381802754998, -855.9374960472273, -1094.36142946446, -1148.9234461248682, -1350.427866437976, -951.6971688604729, -1013.7370361321969, -176.86549736190622, -825.1798900282096, -728.6549524659629, -383.35114379391615, -678.5080219637808, -284.13572423301093, -940.0985413583397, -116.75405989453252, -882.8506204114561, -362.712996708987, -228.96708089318074, -329.94539658313386, -625.3037747039491, -204.87453783116183, -1132.0082402530065, -1058.0394427378978, -795.5601857314019, -886.0860983069422, -198.2245560129748, -1076.5734976113163, -132.23244417354684, -1278.887838745057, -54.565828827047405, -1273.2983225536123, -1234.3517428145742, -448.330334165253, -960.1910155125487, -346.1361845533283, -788.6024314834604, -790.0188549778915, -834.3587214821779, -430.15885262894517, -154.4026900749189, -86.00717607012558, -1060.3895406229199, -1155.760862827838, -1038.2036641771515, -783.5192153373802, -457.4263251758844, -761.9809424584859, -787.6360493804303, -1000.1008760977368, -657.5719746421864, -909.0217222072182, -21.75261467021253, -79.08074702854117, -240.63766933778305, -545.2806773328499, -859.4445158319934, -1185.0229833728245, -701.1743506196233, -909.3681436883671, -885.6474929123527, -933.8245040925144, -1264.5107061992123, -826.8195368497692, -873.3146722634904, -716.4489001934551, -478.48135056167024, -404.4913881875446, -869.7533123475488, -113.54252505711172, -1211.0252300414027, -1305.7654252645507, -1223.8777635656506, -121.08766071313866], "episode_lengths": [150, 57, 150, 150, 150, 49, 44, 150, 150, 118, 104, 71, 115, 100, 150, 150, 150, 112, 90, 150, 86, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 135, 125, 105, 150, 113, 150, 68, 150, 96, 118, 99, 146, 92, 150, 150, 150, 150, 65, 150, 78, 150, 59, 150, 150, 127, 150, 98, 150, 150, 150, 98, 80, 51, 150, 150, 150, 150, 129, 139, 150, 150, 150, 150, 34, 63, 101, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 110, 137, 143, 76, 150, 150, 150, 65], "policy_policy_0_reward": [-742.1586201959997, -81.30727472192602, -1011.3065098270324, -738.9090363028264, -501.2216852059863, -31.365380997052963, -45.8571750608311, -1239.2705142522927, -780.787738820393, -511.71606541441946, -384.41594854268686, -79.52462681928503, -516.5113329973879, -466.42019524661146, -761.4626373237618, -1191.1897098788595, -1120.4879612785078, -337.3821987334037, -367.82127483014915, -934.2131537640989, -188.51931427538176, -964.2948675988682, -612.2536507283107, -742.0529231526226, -613.791581971478, -968.9602633032579, -853.8202052845352, -791.5381802754998, -855.9374960472273, -1094.36142946446, -1148.9234461248682, -1350.427866437976, -951.6971688604729, -1013.7370361321969, -176.86549736190622, -825.1798900282096, -728.6549524659629, -383.35114379391615, -678.5080219637808, -284.13572423301093, -940.0985413583397, -116.75405989453252, -882.8506204114561, -362.712996708987, -228.96708089318074, -329.94539658313386, -625.3037747039491, -204.87453783116183, -1132.0082402530065, -1058.0394427378978, -795.5601857314019, -886.0860983069422, -198.2245560129748, -1076.5734976113163, -132.23244417354684, -1278.887838745057, -54.565828827047405, -1273.2983225536123, -1234.3517428145742, -448.330334165253, -960.1910155125487, -346.1361845533283, -788.6024314834604, -790.0188549778915, -834.3587214821779, -430.15885262894517, -154.4026900749189, -86.00717607012558, -1060.3895406229199, -1155.760862827838, -1038.2036641771515, -783.5192153373802, -457.4263251758844, -761.9809424584859, -787.6360493804303, -1000.1008760977368, -657.5719746421864, -909.0217222072182, -21.75261467021253, -79.08074702854117, -240.63766933778305, -545.2806773328499, -859.4445158319934, -1185.0229833728245, -701.1743506196233, -909.3681436883671, -885.6474929123527, -933.8245040925144, -1264.5107061992123, -826.8195368497692, -873.3146722634904, -716.4489001934551, -478.48135056167024, -404.4913881875446, -869.7533123475488, -113.54252505711172, -1211.0252300414027, -1305.7654252645507, -1223.8777635656506, -121.08766071313866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584738708963285, "mean_inference_ms": 1.684801492739663, "mean_action_processing_ms": 0.27731736130412815, "mean_env_wait_ms": 3.51394516244547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012826681137084961, "StateBufferConnector_ms": 0.0081939697265625, "ViewRequirementAgentConnector_ms": 0.19578790664672852}, "num_episodes": 28, "episode_return_max": -21.75261467021253, "episode_return_min": -1350.427866437976, "episode_return_mean": -691.0184450987705, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.26657555900067, "num_env_steps_trained_throughput_per_sec": 341.26657555900067, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12271.42, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12271.346, "sample_time_ms": 1181.854, "learn_time_ms": 11025.871, "learn_throughput": 362.783, "synch_weights_time_ms": 62.789}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00012", "date": "2024-08-04_06-38-44", "timestamp": 1722733724, "time_this_iter_s": 11.73314881324768, "time_total_s": 252.2919795513153, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fbbc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.2919795513153, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.176470588235293, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.0962765554587, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.31283489925166, "policy_loss": -0.007532100534687439, "vf_loss": 2.31654230573525, "vf_explained_var": 0.9761787697051962, "kl": 0.01325355117608827, "entropy": 1.513704431305329, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -21.75261467021253, "episode_reward_min": -1534.9132797663967, "episode_reward_mean": -747.716349707155, "episode_len_mean": 130.09, "episode_media": {}, "episodes_timesteps_total": 13009, "policy_reward_min": {"policy_0": -1534.9132797663967}, "policy_reward_max": {"policy_0": -21.75261467021253}, "policy_reward_mean": {"policy_0": -747.716349707155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350.427866437976, -951.6971688604729, -1013.7370361321969, -176.86549736190622, -825.1798900282096, -728.6549524659629, -383.35114379391615, -678.5080219637808, -284.13572423301093, -940.0985413583397, -116.75405989453252, -882.8506204114561, -362.712996708987, -228.96708089318074, -329.94539658313386, -625.3037747039491, -204.87453783116183, -1132.0082402530065, -1058.0394427378978, -795.5601857314019, -886.0860983069422, -198.2245560129748, -1076.5734976113163, -132.23244417354684, -1278.887838745057, -54.565828827047405, -1273.2983225536123, -1234.3517428145742, -448.330334165253, -960.1910155125487, -346.1361845533283, -788.6024314834604, -790.0188549778915, -834.3587214821779, -430.15885262894517, -154.4026900749189, -86.00717607012558, -1060.3895406229199, -1155.760862827838, -1038.2036641771515, -783.5192153373802, -457.4263251758844, -761.9809424584859, -787.6360493804303, -1000.1008760977368, -657.5719746421864, -909.0217222072182, -21.75261467021253, -79.08074702854117, -240.63766933778305, -545.2806773328499, -859.4445158319934, -1185.0229833728245, -701.1743506196233, -909.3681436883671, -885.6474929123527, -933.8245040925144, -1264.5107061992123, -826.8195368497692, -873.3146722634904, -716.4489001934551, -478.48135056167024, -404.4913881875446, -869.7533123475488, -113.54252505711172, -1211.0252300414027, -1305.7654252645507, -1223.8777635656506, -121.08766071313866, -257.9725422348983, -702.8640143650558, -889.2610571395104, -1247.5322201532454, -992.1475450823093, -1340.6378441467898, -289.66853970247644, -152.60934184893102, -277.97865044155594, -436.97917348058985, -1094.0676444880905, -1144.7571550650855, -1007.1682315051997, -781.6223902581096, -1136.1814824085523, -817.196784149415, -1050.5898052072214, -1094.807925192789, -834.5978264751991, -257.4790075107276, -856.1633774021277, -589.4047552220973, -1104.4237479354026, -1071.2767677554568, -818.579719729407, -1184.3594840108653, -687.6053516338465, -1273.1641363549356, -287.5908624601107, -1534.9132797663967, -1133.9721961520672], "episode_lengths": [150, 150, 150, 56, 135, 125, 105, 150, 113, 150, 68, 150, 96, 118, 99, 146, 92, 150, 150, 150, 150, 65, 150, 78, 150, 59, 150, 150, 127, 150, 98, 150, 150, 150, 98, 80, 51, 150, 150, 150, 150, 129, 139, 150, 150, 150, 150, 34, 63, 101, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 110, 137, 143, 76, 150, 150, 150, 65, 73, 150, 150, 150, 150, 150, 85, 84, 97, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150], "policy_policy_0_reward": [-1350.427866437976, -951.6971688604729, -1013.7370361321969, -176.86549736190622, -825.1798900282096, -728.6549524659629, -383.35114379391615, -678.5080219637808, -284.13572423301093, -940.0985413583397, -116.75405989453252, -882.8506204114561, -362.712996708987, -228.96708089318074, -329.94539658313386, -625.3037747039491, -204.87453783116183, -1132.0082402530065, -1058.0394427378978, -795.5601857314019, -886.0860983069422, -198.2245560129748, -1076.5734976113163, -132.23244417354684, -1278.887838745057, -54.565828827047405, -1273.2983225536123, -1234.3517428145742, -448.330334165253, -960.1910155125487, -346.1361845533283, -788.6024314834604, -790.0188549778915, -834.3587214821779, -430.15885262894517, -154.4026900749189, -86.00717607012558, -1060.3895406229199, -1155.760862827838, -1038.2036641771515, -783.5192153373802, -457.4263251758844, -761.9809424584859, -787.6360493804303, -1000.1008760977368, -657.5719746421864, -909.0217222072182, -21.75261467021253, -79.08074702854117, -240.63766933778305, -545.2806773328499, -859.4445158319934, -1185.0229833728245, -701.1743506196233, -909.3681436883671, -885.6474929123527, -933.8245040925144, -1264.5107061992123, -826.8195368497692, -873.3146722634904, -716.4489001934551, -478.48135056167024, -404.4913881875446, -869.7533123475488, -113.54252505711172, -1211.0252300414027, -1305.7654252645507, -1223.8777635656506, -121.08766071313866, -257.9725422348983, -702.8640143650558, -889.2610571395104, -1247.5322201532454, -992.1475450823093, -1340.6378441467898, -289.66853970247644, -152.60934184893102, -277.97865044155594, -436.97917348058985, -1094.0676444880905, -1144.7571550650855, -1007.1682315051997, -781.6223902581096, -1136.1814824085523, -817.196784149415, -1050.5898052072214, -1094.807925192789, -834.5978264751991, -257.4790075107276, -856.1633774021277, -589.4047552220973, -1104.4237479354026, -1071.2767677554568, -818.579719729407, -1184.3594840108653, -687.6053516338465, -1273.1641363549356, -287.5908624601107, -1534.9132797663967, -1133.9721961520672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5580423029772225, "mean_inference_ms": 1.6837200595811261, "mean_action_processing_ms": 0.2771874949222724, "mean_env_wait_ms": 3.5140578967921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012396097183227539, "StateBufferConnector_ms": 0.008153915405273438, "ViewRequirementAgentConnector_ms": 0.19407272338867188}, "num_episodes": 31, "episode_return_max": -21.75261467021253, "episode_return_min": -1534.9132797663967, "episode_return_mean": -747.716349707155, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.4693716066231, "num_env_steps_trained_throughput_per_sec": 370.4693716066231, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12046.142, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12046.068, "sample_time_ms": 1155.708, "learn_time_ms": 10826.901, "learn_throughput": 369.45, "synch_weights_time_ms": 62.632}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00012", "date": "2024-08-04_06-38-55", "timestamp": 1722733735, "time_this_iter_s": 10.809608459472656, "time_total_s": 263.10158801078796, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4bf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 263.10158801078796, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.58125, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.03483103315037, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.642492018143336, "policy_loss": -0.009422773953216772, "vf_loss": 3.6475817928711574, "vf_explained_var": 0.9568456791341304, "kl": 0.014848501207901184, "entropy": 1.2154388752455512, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -21.75261467021253, "episode_reward_min": -1534.9132797663967, "episode_reward_mean": -720.079180484651, "episode_len_mean": 128.56, "episode_media": {}, "episodes_timesteps_total": 12856, "policy_reward_min": {"policy_0": -1534.9132797663967}, "policy_reward_max": {"policy_0": -21.75261467021253}, "policy_reward_mean": {"policy_0": -720.079180484651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.15885262894517, -154.4026900749189, -86.00717607012558, -1060.3895406229199, -1155.760862827838, -1038.2036641771515, -783.5192153373802, -457.4263251758844, -761.9809424584859, -787.6360493804303, -1000.1008760977368, -657.5719746421864, -909.0217222072182, -21.75261467021253, -79.08074702854117, -240.63766933778305, -545.2806773328499, -859.4445158319934, -1185.0229833728245, -701.1743506196233, -909.3681436883671, -885.6474929123527, -933.8245040925144, -1264.5107061992123, -826.8195368497692, -873.3146722634904, -716.4489001934551, -478.48135056167024, -404.4913881875446, -869.7533123475488, -113.54252505711172, -1211.0252300414027, -1305.7654252645507, -1223.8777635656506, -121.08766071313866, -257.9725422348983, -702.8640143650558, -889.2610571395104, -1247.5322201532454, -992.1475450823093, -1340.6378441467898, -289.66853970247644, -152.60934184893102, -277.97865044155594, -436.97917348058985, -1094.0676444880905, -1144.7571550650855, -1007.1682315051997, -781.6223902581096, -1136.1814824085523, -817.196784149415, -1050.5898052072214, -1094.807925192789, -834.5978264751991, -257.4790075107276, -856.1633774021277, -589.4047552220973, -1104.4237479354026, -1071.2767677554568, -818.579719729407, -1184.3594840108653, -687.6053516338465, -1273.1641363549356, -287.5908624601107, -1534.9132797663967, -1133.9721961520672, -560.9854816395359, -632.8392788139504, -145.80824127303777, -854.2564687573179, -942.0205469173127, -240.93038557576682, -506.9722849623527, -392.67954219051165, -663.7045409204883, -441.48928944948415, -237.2132221995433, -897.3049013599838, -257.64677965207534, -137.24939928954106, -489.43894243596634, -843.395820400849, -1296.9720624463446, -958.1963170990904, -589.1840336617678, -835.5861181339519, -79.93148305154052, -1337.0446249829865, -573.3375453219284, -553.900286436331, -1050.8329589136877, -310.3295434364024, -900.6143536375663, -185.28739748029406, -1462.0082568723, -74.73159739984212, -168.86045623913802, -685.4942491407006, -997.644448717097, -303.92226854511813], "episode_lengths": [98, 80, 51, 150, 150, 150, 150, 129, 139, 150, 150, 150, 150, 34, 63, 101, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 110, 137, 143, 76, 150, 150, 150, 65, 73, 150, 150, 150, 150, 150, 85, 84, 97, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 129, 88, 150, 150, 86, 121, 120, 148, 123, 71, 150, 108, 67, 150, 150, 150, 150, 138, 150, 55, 150, 113, 150, 150, 89, 150, 72, 150, 61, 66, 132, 150, 90], "policy_policy_0_reward": [-430.15885262894517, -154.4026900749189, -86.00717607012558, -1060.3895406229199, -1155.760862827838, -1038.2036641771515, -783.5192153373802, -457.4263251758844, -761.9809424584859, -787.6360493804303, -1000.1008760977368, -657.5719746421864, -909.0217222072182, -21.75261467021253, -79.08074702854117, -240.63766933778305, -545.2806773328499, -859.4445158319934, -1185.0229833728245, -701.1743506196233, -909.3681436883671, -885.6474929123527, -933.8245040925144, -1264.5107061992123, -826.8195368497692, -873.3146722634904, -716.4489001934551, -478.48135056167024, -404.4913881875446, -869.7533123475488, -113.54252505711172, -1211.0252300414027, -1305.7654252645507, -1223.8777635656506, -121.08766071313866, -257.9725422348983, -702.8640143650558, -889.2610571395104, -1247.5322201532454, -992.1475450823093, -1340.6378441467898, -289.66853970247644, -152.60934184893102, -277.97865044155594, -436.97917348058985, -1094.0676444880905, -1144.7571550650855, -1007.1682315051997, -781.6223902581096, -1136.1814824085523, -817.196784149415, -1050.5898052072214, -1094.807925192789, -834.5978264751991, -257.4790075107276, -856.1633774021277, -589.4047552220973, -1104.4237479354026, -1071.2767677554568, -818.579719729407, -1184.3594840108653, -687.6053516338465, -1273.1641363549356, -287.5908624601107, -1534.9132797663967, -1133.9721961520672, -560.9854816395359, -632.8392788139504, -145.80824127303777, -854.2564687573179, -942.0205469173127, -240.93038557576682, -506.9722849623527, -392.67954219051165, -663.7045409204883, -441.48928944948415, -237.2132221995433, -897.3049013599838, -257.64677965207534, -137.24939928954106, -489.43894243596634, -843.395820400849, -1296.9720624463446, -958.1963170990904, -589.1840336617678, -835.5861181339519, -79.93148305154052, -1337.0446249829865, -573.3375453219284, -553.900286436331, -1050.8329589136877, -310.3295434364024, -900.6143536375663, -185.28739748029406, -1462.0082568723, -74.73159739984212, -168.86045623913802, -685.4942491407006, -997.644448717097, -303.92226854511813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577839583080287, "mean_inference_ms": 1.682278688104904, "mean_action_processing_ms": 0.27656052615965016, "mean_env_wait_ms": 3.512301710477592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011929988861083984, "StateBufferConnector_ms": 0.007985353469848633, "ViewRequirementAgentConnector_ms": 0.19306325912475586}, "num_episodes": 34, "episode_return_max": -21.75261467021253, "episode_return_min": -1534.9132797663967, "episode_return_mean": -720.079180484651, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.7544666420294, "num_env_steps_trained_throughput_per_sec": 310.7544666420294, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12006.899, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12006.824, "sample_time_ms": 1155.236, "learn_time_ms": 10787.385, "learn_throughput": 370.803, "synch_weights_time_ms": 63.411}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00012", "date": "2024-08-04_06-39-08", "timestamp": 1722733748, "time_this_iter_s": 12.886037349700928, "time_total_s": 275.9876253604889, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4b250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.9876253604889, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.56111111111111, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 208.76980026761692, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6352697163820267, "policy_loss": -0.010707973025273532, "vf_loss": 2.6411747651795547, "vf_explained_var": 0.9864421201869845, "kl": 0.016474329105585658, "entropy": 1.393723510702451, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -50.46388068122706, "episode_reward_min": -1534.9132797663967, "episode_reward_mean": -705.7978071605384, "episode_len_mean": 126.63, "episode_media": {}, "episodes_timesteps_total": 12663, "policy_reward_min": {"policy_0": -1534.9132797663967}, "policy_reward_max": {"policy_0": -50.46388068122706}, "policy_reward_mean": {"policy_0": -705.7978071605384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1305.7654252645507, -1223.8777635656506, -121.08766071313866, -257.9725422348983, -702.8640143650558, -889.2610571395104, -1247.5322201532454, -992.1475450823093, -1340.6378441467898, -289.66853970247644, -152.60934184893102, -277.97865044155594, -436.97917348058985, -1094.0676444880905, -1144.7571550650855, -1007.1682315051997, -781.6223902581096, -1136.1814824085523, -817.196784149415, -1050.5898052072214, -1094.807925192789, -834.5978264751991, -257.4790075107276, -856.1633774021277, -589.4047552220973, -1104.4237479354026, -1071.2767677554568, -818.579719729407, -1184.3594840108653, -687.6053516338465, -1273.1641363549356, -287.5908624601107, -1534.9132797663967, -1133.9721961520672, -560.9854816395359, -632.8392788139504, -145.80824127303777, -854.2564687573179, -942.0205469173127, -240.93038557576682, -506.9722849623527, -392.67954219051165, -663.7045409204883, -441.48928944948415, -237.2132221995433, -897.3049013599838, -257.64677965207534, -137.24939928954106, -489.43894243596634, -843.395820400849, -1296.9720624463446, -958.1963170990904, -589.1840336617678, -835.5861181339519, -79.93148305154052, -1337.0446249829865, -573.3375453219284, -553.900286436331, -1050.8329589136877, -310.3295434364024, -900.6143536375663, -185.28739748029406, -1462.0082568723, -74.73159739984212, -168.86045623913802, -685.4942491407006, -997.644448717097, -303.92226854511813, -1292.6772833042455, -1002.0519678761134, -473.4841436062882, -214.79710616229548, -953.4262054529942, -1347.171624131972, -351.35314530756546, -162.1061607808384, -1213.836417733394, -1050.2457327510886, -205.80759706882282, -1446.6496469658557, -1244.9781438439259, -75.77053170453722, -204.03738042137584, -212.51766494392407, -312.73036197163725, -855.1266439751904, -1324.3713638312395, -622.7253906763195, -806.5281731182588, -305.56716768861037, -89.39884626996266, -50.46388068122706, -780.1307985470124, -192.27135585493963, -828.9445176353064, -701.3701559878477, -863.6166360679525, -124.90861434717378, -950.0358666441881, -714.5633545261074], "episode_lengths": [150, 150, 65, 73, 150, 150, 150, 150, 150, 85, 84, 97, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 129, 88, 150, 150, 86, 121, 120, 148, 123, 71, 150, 108, 67, 150, 150, 150, 150, 138, 150, 55, 150, 113, 150, 150, 89, 150, 72, 150, 61, 66, 132, 150, 90, 150, 150, 148, 150, 150, 150, 104, 85, 150, 150, 96, 150, 150, 61, 63, 91, 82, 150, 150, 150, 150, 94, 61, 48, 150, 96, 150, 150, 150, 67, 150, 150], "policy_policy_0_reward": [-1305.7654252645507, -1223.8777635656506, -121.08766071313866, -257.9725422348983, -702.8640143650558, -889.2610571395104, -1247.5322201532454, -992.1475450823093, -1340.6378441467898, -289.66853970247644, -152.60934184893102, -277.97865044155594, -436.97917348058985, -1094.0676444880905, -1144.7571550650855, -1007.1682315051997, -781.6223902581096, -1136.1814824085523, -817.196784149415, -1050.5898052072214, -1094.807925192789, -834.5978264751991, -257.4790075107276, -856.1633774021277, -589.4047552220973, -1104.4237479354026, -1071.2767677554568, -818.579719729407, -1184.3594840108653, -687.6053516338465, -1273.1641363549356, -287.5908624601107, -1534.9132797663967, -1133.9721961520672, -560.9854816395359, -632.8392788139504, -145.80824127303777, -854.2564687573179, -942.0205469173127, -240.93038557576682, -506.9722849623527, -392.67954219051165, -663.7045409204883, -441.48928944948415, -237.2132221995433, -897.3049013599838, -257.64677965207534, -137.24939928954106, -489.43894243596634, -843.395820400849, -1296.9720624463446, -958.1963170990904, -589.1840336617678, -835.5861181339519, -79.93148305154052, -1337.0446249829865, -573.3375453219284, -553.900286436331, -1050.8329589136877, -310.3295434364024, -900.6143536375663, -185.28739748029406, -1462.0082568723, -74.73159739984212, -168.86045623913802, -685.4942491407006, -997.644448717097, -303.92226854511813, -1292.6772833042455, -1002.0519678761134, -473.4841436062882, -214.79710616229548, -953.4262054529942, -1347.171624131972, -351.35314530756546, -162.1061607808384, -1213.836417733394, -1050.2457327510886, -205.80759706882282, -1446.6496469658557, -1244.9781438439259, -75.77053170453722, -204.03738042137584, -212.51766494392407, -312.73036197163725, -855.1266439751904, -1324.3713638312395, -622.7253906763195, -806.5281731182588, -305.56716768861037, -89.39884626996266, -50.46388068122706, -780.1307985470124, -192.27135585493963, -828.9445176353064, -701.3701559878477, -863.6166360679525, -124.90861434717378, -950.0358666441881, -714.5633545261074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578208735078616, "mean_inference_ms": 1.6824342495072235, "mean_action_processing_ms": 0.27671662138713193, "mean_env_wait_ms": 3.5149509898089866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01178884506225586, "StateBufferConnector_ms": 0.008153438568115234, "ViewRequirementAgentConnector_ms": 0.1929457187652588}, "num_episodes": 32, "episode_return_max": -50.46388068122706, "episode_return_min": -1534.9132797663967, "episode_return_mean": -705.7978071605384, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.0000247874273, "num_env_steps_trained_throughput_per_sec": 458.0000247874273, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 11645.628, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11645.558, "sample_time_ms": 1156.894, "learn_time_ms": 10426.787, "learn_throughput": 383.627, "synch_weights_time_ms": 61.098}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00012", "date": "2024-08-04_06-39-17", "timestamp": 1722733757, "time_this_iter_s": 8.745413780212402, "time_total_s": 284.7330391407013, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370990f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 284.7330391407013, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 22.500000000000004, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.70299132466317, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.250668980057041, "policy_loss": -0.008921551093711363, "vf_loss": 2.2552633895228307, "vf_explained_var": 0.9871910730376839, "kl": 0.014916107909327079, "entropy": 1.4769097838550806, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -19.852649034769158, "episode_reward_min": -1534.9132797663967, "episode_reward_mean": -681.1192040088156, "episode_len_mean": 125.59, "episode_media": {}, "episodes_timesteps_total": 12559, "policy_reward_min": {"policy_0": -1534.9132797663967}, "policy_reward_max": {"policy_0": -19.852649034769158}, "policy_reward_mean": {"policy_0": -681.1192040088156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1273.1641363549356, -287.5908624601107, -1534.9132797663967, -1133.9721961520672, -560.9854816395359, -632.8392788139504, -145.80824127303777, -854.2564687573179, -942.0205469173127, -240.93038557576682, -506.9722849623527, -392.67954219051165, -663.7045409204883, -441.48928944948415, -237.2132221995433, -897.3049013599838, -257.64677965207534, -137.24939928954106, -489.43894243596634, -843.395820400849, -1296.9720624463446, -958.1963170990904, -589.1840336617678, -835.5861181339519, -79.93148305154052, -1337.0446249829865, -573.3375453219284, -553.900286436331, -1050.8329589136877, -310.3295434364024, -900.6143536375663, -185.28739748029406, -1462.0082568723, -74.73159739984212, -168.86045623913802, -685.4942491407006, -997.644448717097, -303.92226854511813, -1292.6772833042455, -1002.0519678761134, -473.4841436062882, -214.79710616229548, -953.4262054529942, -1347.171624131972, -351.35314530756546, -162.1061607808384, -1213.836417733394, -1050.2457327510886, -205.80759706882282, -1446.6496469658557, -1244.9781438439259, -75.77053170453722, -204.03738042137584, -212.51766494392407, -312.73036197163725, -855.1266439751904, -1324.3713638312395, -622.7253906763195, -806.5281731182588, -305.56716768861037, -89.39884626996266, -50.46388068122706, -780.1307985470124, -192.27135585493963, -828.9445176353064, -701.3701559878477, -863.6166360679525, -124.90861434717378, -950.0358666441881, -714.5633545261074, -559.070657774267, -881.6819220660939, -1125.1642899378658, -744.4156798381263, -1520.4817072632204, -19.852649034769158, -722.9931854728981, -1354.8794211052239, -703.2321282011513, -174.91062138724521, -20.51081629836843, -1017.7457931432712, -950.4792541846892, -74.29590854651029, -81.96585798234959, -771.8684982431001, -532.0918702536604, -969.8538280584304, -507.67306708284366, -733.6261669624141, -853.9705144319477, -976.1129461026894, -809.5655739238593, -78.41547038221739, -1182.6503137482598, -1182.9342899264198, -1257.2551053273207, -1089.3439825654432, -849.9867276966341, -553.7746719747217], "episode_lengths": [150, 110, 150, 150, 150, 129, 88, 150, 150, 86, 121, 120, 148, 123, 71, 150, 108, 67, 150, 150, 150, 150, 138, 150, 55, 150, 113, 150, 150, 89, 150, 72, 150, 61, 66, 132, 150, 90, 150, 150, 148, 150, 150, 150, 104, 85, 150, 150, 96, 150, 150, 61, 63, 91, 82, 150, 150, 150, 150, 94, 61, 48, 150, 96, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 92, 47, 150, 150, 64, 45, 146, 130, 150, 144, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1273.1641363549356, -287.5908624601107, -1534.9132797663967, -1133.9721961520672, -560.9854816395359, -632.8392788139504, -145.80824127303777, -854.2564687573179, -942.0205469173127, -240.93038557576682, -506.9722849623527, -392.67954219051165, -663.7045409204883, -441.48928944948415, -237.2132221995433, -897.3049013599838, -257.64677965207534, -137.24939928954106, -489.43894243596634, -843.395820400849, -1296.9720624463446, -958.1963170990904, -589.1840336617678, -835.5861181339519, -79.93148305154052, -1337.0446249829865, -573.3375453219284, -553.900286436331, -1050.8329589136877, -310.3295434364024, -900.6143536375663, -185.28739748029406, -1462.0082568723, -74.73159739984212, -168.86045623913802, -685.4942491407006, -997.644448717097, -303.92226854511813, -1292.6772833042455, -1002.0519678761134, -473.4841436062882, -214.79710616229548, -953.4262054529942, -1347.171624131972, -351.35314530756546, -162.1061607808384, -1213.836417733394, -1050.2457327510886, -205.80759706882282, -1446.6496469658557, -1244.9781438439259, -75.77053170453722, -204.03738042137584, -212.51766494392407, -312.73036197163725, -855.1266439751904, -1324.3713638312395, -622.7253906763195, -806.5281731182588, -305.56716768861037, -89.39884626996266, -50.46388068122706, -780.1307985470124, -192.27135585493963, -828.9445176353064, -701.3701559878477, -863.6166360679525, -124.90861434717378, -950.0358666441881, -714.5633545261074, -559.070657774267, -881.6819220660939, -1125.1642899378658, -744.4156798381263, -1520.4817072632204, -19.852649034769158, -722.9931854728981, -1354.8794211052239, -703.2321282011513, -174.91062138724521, -20.51081629836843, -1017.7457931432712, -950.4792541846892, -74.29590854651029, -81.96585798234959, -771.8684982431001, -532.0918702536604, -969.8538280584304, -507.67306708284366, -733.6261669624141, -853.9705144319477, -976.1129461026894, -809.5655739238593, -78.41547038221739, -1182.6503137482598, -1182.9342899264198, -1257.2551053273207, -1089.3439825654432, -849.9867276966341, -553.7746719747217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577347491496819, "mean_inference_ms": 1.682574456499792, "mean_action_processing_ms": 0.27690515649067426, "mean_env_wait_ms": 3.5155427841456075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011722087860107422, "StateBufferConnector_ms": 0.008118867874145508, "ViewRequirementAgentConnector_ms": 0.19114041328430176}, "num_episodes": 30, "episode_return_max": -19.852649034769158, "episode_return_min": -1534.9132797663967, "episode_return_mean": -681.1192040088156, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.4642680008122, "num_env_steps_trained_throughput_per_sec": 558.4642680008122, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11589.94, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11589.87, "sample_time_ms": 1146.217, "learn_time_ms": 10380.858, "learn_throughput": 385.325, "synch_weights_time_ms": 62.003}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00012", "date": "2024-08-04_06-39-24", "timestamp": 1722733764, "time_this_iter_s": 7.174509286880493, "time_total_s": 291.9075484275818, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370990ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 291.9075484275818, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.55454545454546, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.64485722581546, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.449033539555967, "policy_loss": -0.006847827765159309, "vf_loss": 2.452303583174944, "vf_explained_var": 0.9828583718587954, "kl": 0.012414421518640969, "entropy": 1.4653936160107455, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -7.360821266266545, "episode_reward_min": -1520.4817072632204, "episode_reward_mean": -677.2974276212149, "episode_len_mean": 122.61, "episode_media": {}, "episodes_timesteps_total": 12261, "policy_reward_min": {"policy_0": -1520.4817072632204}, "policy_reward_max": {"policy_0": -7.360821266266545}, "policy_reward_mean": {"policy_0": -677.2974276212149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.86045623913802, -685.4942491407006, -997.644448717097, -303.92226854511813, -1292.6772833042455, -1002.0519678761134, -473.4841436062882, -214.79710616229548, -953.4262054529942, -1347.171624131972, -351.35314530756546, -162.1061607808384, -1213.836417733394, -1050.2457327510886, -205.80759706882282, -1446.6496469658557, -1244.9781438439259, -75.77053170453722, -204.03738042137584, -212.51766494392407, -312.73036197163725, -855.1266439751904, -1324.3713638312395, -622.7253906763195, -806.5281731182588, -305.56716768861037, -89.39884626996266, -50.46388068122706, -780.1307985470124, -192.27135585493963, -828.9445176353064, -701.3701559878477, -863.6166360679525, -124.90861434717378, -950.0358666441881, -714.5633545261074, -559.070657774267, -881.6819220660939, -1125.1642899378658, -744.4156798381263, -1520.4817072632204, -19.852649034769158, -722.9931854728981, -1354.8794211052239, -703.2321282011513, -174.91062138724521, -20.51081629836843, -1017.7457931432712, -950.4792541846892, -74.29590854651029, -81.96585798234959, -771.8684982431001, -532.0918702536604, -969.8538280584304, -507.67306708284366, -733.6261669624141, -853.9705144319477, -976.1129461026894, -809.5655739238593, -78.41547038221739, -1182.6503137482598, -1182.9342899264198, -1257.2551053273207, -1089.3439825654432, -849.9867276966341, -553.7746719747217, -940.4970494994444, -29.2314675970352, -294.8890448325754, -1392.7415488574923, -1003.6293196477325, -255.4291177865037, -1371.7498342830663, -7.360821266266545, -110.19925161259518, -1149.871019541418, -406.42750885076805, -226.4596195608225, -749.3782974643632, -12.675636212856977, -958.7804270826293, -39.962343181060795, -488.88385665503813, -453.97164016238344, -29.259985819323273, -108.54751233123986, -252.98582057307482, -1363.7317016849447, -1151.3549394978668, -736.5419901620629, -1294.7744296395435, -222.62336916409552, -445.8578423375656, -905.6801693638921, -1200.9238006452802, -1038.732541868889, -795.3817494057956, -629.1206525618653, -1034.5200636571928, -1197.1801678785469], "episode_lengths": [66, 132, 150, 90, 150, 150, 148, 150, 150, 150, 104, 85, 150, 150, 96, 150, 150, 61, 63, 91, 82, 150, 150, 150, 150, 94, 61, 48, 150, 96, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 92, 47, 150, 150, 64, 45, 146, 130, 150, 144, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 42, 91, 150, 150, 142, 150, 31, 66, 150, 100, 82, 150, 34, 150, 52, 125, 103, 42, 63, 74, 150, 150, 148, 150, 91, 115, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-168.86045623913802, -685.4942491407006, -997.644448717097, -303.92226854511813, -1292.6772833042455, -1002.0519678761134, -473.4841436062882, -214.79710616229548, -953.4262054529942, -1347.171624131972, -351.35314530756546, -162.1061607808384, -1213.836417733394, -1050.2457327510886, -205.80759706882282, -1446.6496469658557, -1244.9781438439259, -75.77053170453722, -204.03738042137584, -212.51766494392407, -312.73036197163725, -855.1266439751904, -1324.3713638312395, -622.7253906763195, -806.5281731182588, -305.56716768861037, -89.39884626996266, -50.46388068122706, -780.1307985470124, -192.27135585493963, -828.9445176353064, -701.3701559878477, -863.6166360679525, -124.90861434717378, -950.0358666441881, -714.5633545261074, -559.070657774267, -881.6819220660939, -1125.1642899378658, -744.4156798381263, -1520.4817072632204, -19.852649034769158, -722.9931854728981, -1354.8794211052239, -703.2321282011513, -174.91062138724521, -20.51081629836843, -1017.7457931432712, -950.4792541846892, -74.29590854651029, -81.96585798234959, -771.8684982431001, -532.0918702536604, -969.8538280584304, -507.67306708284366, -733.6261669624141, -853.9705144319477, -976.1129461026894, -809.5655739238593, -78.41547038221739, -1182.6503137482598, -1182.9342899264198, -1257.2551053273207, -1089.3439825654432, -849.9867276966341, -553.7746719747217, -940.4970494994444, -29.2314675970352, -294.8890448325754, -1392.7415488574923, -1003.6293196477325, -255.4291177865037, -1371.7498342830663, -7.360821266266545, -110.19925161259518, -1149.871019541418, -406.42750885076805, -226.4596195608225, -749.3782974643632, -12.675636212856977, -958.7804270826293, -39.962343181060795, -488.88385665503813, -453.97164016238344, -29.259985819323273, -108.54751233123986, -252.98582057307482, -1363.7317016849447, -1151.3549394978668, -736.5419901620629, -1294.7744296395435, -222.62336916409552, -445.8578423375656, -905.6801693638921, -1200.9238006452802, -1038.732541868889, -795.3817494057956, -629.1206525618653, -1034.5200636571928, -1197.1801678785469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578907107135304, "mean_inference_ms": 1.6819508021529996, "mean_action_processing_ms": 0.2768879829602331, "mean_env_wait_ms": 3.514796488882234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011644363403320312, "StateBufferConnector_ms": 0.008024454116821289, "ViewRequirementAgentConnector_ms": 0.19067096710205078}, "num_episodes": 34, "episode_return_max": -7.360821266266545, "episode_return_min": -1520.4817072632204, "episode_return_mean": -677.2974276212149, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.15033215681314, "num_env_steps_trained_throughput_per_sec": 309.15033215681314, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 11578.593, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11578.522, "sample_time_ms": 1144.261, "learn_time_ms": 10371.382, "learn_throughput": 385.677, "synch_weights_time_ms": 62.085}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00012", "date": "2024-08-04_06-39-37", "timestamp": 1722733777, "time_this_iter_s": 12.951176881790161, "time_total_s": 304.85872530937195, "pid": 587373, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4b250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 304.85872530937195, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.405555555555555, "ram_util_percent": 28.100000000000005}}
