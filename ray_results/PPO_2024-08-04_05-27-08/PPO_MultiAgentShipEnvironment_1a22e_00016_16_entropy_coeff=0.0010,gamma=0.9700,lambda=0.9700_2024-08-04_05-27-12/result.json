{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.014480624254793, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.635269879301388, "policy_loss": -0.004730132762051653, "vf_loss": 9.639589355389278, "vf_explained_var": 0.015700395032763482, "kl": 0.009140498172488758, "entropy": 1.4174286833653846, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -37.633114548771594, "episode_reward_min": -1313.2388334511568, "episode_reward_mean": -641.7787272583472, "episode_len_mean": 116.96, "episode_media": {}, "episodes_timesteps_total": 2924, "policy_reward_min": {"policy_0": -1313.2388334511568}, "policy_reward_max": {"policy_0": -37.633114548771594}, "policy_reward_mean": {"policy_0": -641.7787272583472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.1825496033681, -1019.6831698425202, -936.4910489500612, -1313.2388334511568, -217.4429055441579, -1034.1206244698415, -225.53645093359214, -126.96725884370717, -694.210524134299, -464.1266212738821, -1209.1316131566803, -86.76265479880652, -1133.741137544668, -756.8948470929821, -1245.0048605514153, -902.5240368902295, -378.89898617711236, -57.815559793996414, -64.72766536450592, -430.9105667137851, -613.2777063457926, -67.69750909399637, -37.633114548771594, -1005.6810470320883, -1015.7668893072644], "episode_lengths": [150, 150, 150, 150, 84, 150, 79, 64, 150, 103, 150, 66, 150, 150, 150, 150, 125, 56, 39, 126, 143, 46, 43, 150, 150], "policy_policy_0_reward": [-1006.1825496033681, -1019.6831698425202, -936.4910489500612, -1313.2388334511568, -217.4429055441579, -1034.1206244698415, -225.53645093359214, -126.96725884370717, -694.210524134299, -464.1266212738821, -1209.1316131566803, -86.76265479880652, -1133.741137544668, -756.8948470929821, -1245.0048605514153, -902.5240368902295, -378.89898617711236, -57.815559793996414, -64.72766536450592, -430.9105667137851, -613.2777063457926, -67.69750909399637, -37.633114548771594, -1005.6810470320883, -1015.7668893072644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.566070175484092, "mean_inference_ms": 1.670416417615167, "mean_action_processing_ms": 0.27778163339899875, "mean_env_wait_ms": 3.3998293846894567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011661529541015625, "StateBufferConnector_ms": 0.008337974548339844, "ViewRequirementAgentConnector_ms": 0.18436336517333984}, "num_episodes": 25, "episode_return_max": -37.633114548771594, "episode_return_min": -1313.2388334511568, "episode_return_mean": -641.7787272583472, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.24907168189384, "num_env_steps_trained_throughput_per_sec": 312.24907168189384, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12810.297, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12810.229, "sample_time_ms": 1113.549, "learn_time_ms": 11626.834, "learn_throughput": 344.032, "synch_weights_time_ms": 69.023}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00016", "date": "2024-08-04_06-56-47", "timestamp": 1722734807, "time_this_iter_s": 12.82149362564087, "time_total_s": 12.82149362564087, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.82149362564087, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.68421052631579, "ram_util_percent": 27.989473684210523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0578233582278094, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.691712015867234, "policy_loss": -0.005062202970536115, "vf_loss": 9.696121463179589, "vf_explained_var": 0.027397499047219755, "kl": 0.010341387318718868, "entropy": 1.4155239943414926, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -37.633114548771594, "episode_reward_min": -1313.2388334511568, "episode_reward_mean": -719.1457475384615, "episode_len_mean": 121.50943396226415, "episode_media": {}, "episodes_timesteps_total": 6440, "policy_reward_min": {"policy_0": -1313.2388334511568}, "policy_reward_max": {"policy_0": -37.633114548771594}, "policy_reward_mean": {"policy_0": -719.1457475384615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.1825496033681, -1019.6831698425202, -936.4910489500612, -1313.2388334511568, -217.4429055441579, -1034.1206244698415, -225.53645093359214, -126.96725884370717, -694.210524134299, -464.1266212738821, -1209.1316131566803, -86.76265479880652, -1133.741137544668, -756.8948470929821, -1245.0048605514153, -902.5240368902295, -378.89898617711236, -57.815559793996414, -64.72766536450592, -430.9105667137851, -613.2777063457926, -67.69750909399637, -37.633114548771594, -1005.6810470320883, -1015.7668893072644, -1138.1074958682557, -61.449477997459525, -971.2695957692156, -1157.097991287139, -769.1516383737425, -1303.1519396950666, -526.8993787901823, -922.8231945618143, -868.5050051570346, -954.0055348669039, -1096.904431149749, -55.1994421603201, -1242.4340581160648, -1209.778420748421, -114.1771236908886, -857.0380594559856, -55.69553812311356, -924.7338255191193, -1234.274226529081, -207.96748011885626, -476.4773269517327, -984.2398928810782, -375.90574077703127, -133.96440470806166, -1055.623378556018, -870.836970145907, -1299.5495432863552, -1202.995322795186], "episode_lengths": [150, 150, 150, 150, 84, 150, 79, 64, 150, 103, 150, 66, 150, 150, 150, 150, 125, 56, 39, 126, 143, 46, 43, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 72, 150, 40, 150, 150, 73, 103, 150, 90, 52, 150, 150, 150, 150], "policy_policy_0_reward": [-1006.1825496033681, -1019.6831698425202, -936.4910489500612, -1313.2388334511568, -217.4429055441579, -1034.1206244698415, -225.53645093359214, -126.96725884370717, -694.210524134299, -464.1266212738821, -1209.1316131566803, -86.76265479880652, -1133.741137544668, -756.8948470929821, -1245.0048605514153, -902.5240368902295, -378.89898617711236, -57.815559793996414, -64.72766536450592, -430.9105667137851, -613.2777063457926, -67.69750909399637, -37.633114548771594, -1005.6810470320883, -1015.7668893072644, -1138.1074958682557, -61.449477997459525, -971.2695957692156, -1157.097991287139, -769.1516383737425, -1303.1519396950666, -526.8993787901823, -922.8231945618143, -868.5050051570346, -954.0055348669039, -1096.904431149749, -55.1994421603201, -1242.4340581160648, -1209.778420748421, -114.1771236908886, -857.0380594559856, -55.69553812311356, -924.7338255191193, -1234.274226529081, -207.96748011885626, -476.4773269517327, -984.2398928810782, -375.90574077703127, -133.96440470806166, -1055.623378556018, -870.836970145907, -1299.5495432863552, -1202.995322795186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634786752519846, "mean_inference_ms": 1.672316514669968, "mean_action_processing_ms": 0.27772355330019277, "mean_env_wait_ms": 3.4004442528340975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013494041730772774, "StateBufferConnector_ms": 0.008328005952655145, "ViewRequirementAgentConnector_ms": 0.18448514758415943}, "num_episodes": 28, "episode_return_max": -37.633114548771594, "episode_return_min": -1313.2388334511568, "episode_return_mean": -719.1457475384615, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9843921092907, "num_env_steps_trained_throughput_per_sec": 307.9843921092907, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12898.99, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12898.925, "sample_time_ms": 1126.467, "learn_time_ms": 11705.066, "learn_throughput": 341.732, "synch_weights_time_ms": 66.534}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00016", "date": "2024-08-04_06-57-00", "timestamp": 1722734820, "time_this_iter_s": 12.99840760231018, "time_total_s": 25.81990122795105, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e1120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.81990122795105, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.833333333333332, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3191594069202741, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.620250529050827, "policy_loss": -0.00791270948878567, "vf_loss": 9.626881484190623, "vf_explained_var": 0.06266289247820775, "kl": 0.013363897143669118, "entropy": 1.391038718322913, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -37.633114548771594, "episode_reward_min": -1334.8936673462817, "episode_reward_mean": -741.61796495073, "episode_len_mean": 124.17241379310344, "episode_media": {}, "episodes_timesteps_total": 10803, "policy_reward_min": {"policy_0": -1334.8936673462817}, "policy_reward_max": {"policy_0": -37.633114548771594}, "policy_reward_mean": {"policy_0": -741.61796495073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.1825496033681, -1019.6831698425202, -936.4910489500612, -1313.2388334511568, -217.4429055441579, -1034.1206244698415, -225.53645093359214, -126.96725884370717, -694.210524134299, -464.1266212738821, -1209.1316131566803, -86.76265479880652, -1133.741137544668, -756.8948470929821, -1245.0048605514153, -902.5240368902295, -378.89898617711236, -57.815559793996414, -64.72766536450592, -430.9105667137851, -613.2777063457926, -67.69750909399637, -37.633114548771594, -1005.6810470320883, -1015.7668893072644, -1138.1074958682557, -61.449477997459525, -971.2695957692156, -1157.097991287139, -769.1516383737425, -1303.1519396950666, -526.8993787901823, -922.8231945618143, -868.5050051570346, -954.0055348669039, -1096.904431149749, -55.1994421603201, -1242.4340581160648, -1209.778420748421, -114.1771236908886, -857.0380594559856, -55.69553812311356, -924.7338255191193, -1234.274226529081, -207.96748011885626, -476.4773269517327, -984.2398928810782, -375.90574077703127, -133.96440470806166, -1055.623378556018, -870.836970145907, -1299.5495432863552, -1202.995322795186, -169.21842388497876, -1128.2434365416043, -1067.5814281970634, -964.6587345022492, -135.13185165559602, -1016.3178385523032, -485.6495024067673, -923.2523529977221, -917.5962875812236, -47.6632268722772, -1142.4850769738719, -810.0402517979505, -689.3551127945163, -1226.0853887681328, -148.52667360543532, -1078.9492361531368, -1271.579499027423, -871.8906349935494, -571.0720197703127, -771.9964098050443, -974.1549567030431, -840.0277209964925, -1064.4219208250727, -1061.6274915628387, -96.06208736388581, -1013.3207323885665, -1001.4879568562862, -1061.0469660926954, -183.9376151347758, -77.69585805952008, -106.76075990973031, -1334.8936673462817, -1084.0304524002397, -1069.2767586544485], "episode_lengths": [150, 150, 150, 150, 84, 150, 79, 64, 150, 103, 150, 66, 150, 150, 150, 150, 125, 56, 39, 126, 143, 46, 43, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 72, 150, 40, 150, 150, 73, 103, 150, 90, 52, 150, 150, 150, 150, 58, 150, 150, 150, 68, 150, 112, 150, 150, 64, 150, 150, 150, 150, 53, 150, 150, 150, 149, 150, 150, 141, 150, 150, 65, 150, 150, 150, 73, 61, 69, 150, 150, 150], "policy_policy_0_reward": [-1006.1825496033681, -1019.6831698425202, -936.4910489500612, -1313.2388334511568, -217.4429055441579, -1034.1206244698415, -225.53645093359214, -126.96725884370717, -694.210524134299, -464.1266212738821, -1209.1316131566803, -86.76265479880652, -1133.741137544668, -756.8948470929821, -1245.0048605514153, -902.5240368902295, -378.89898617711236, -57.815559793996414, -64.72766536450592, -430.9105667137851, -613.2777063457926, -67.69750909399637, -37.633114548771594, -1005.6810470320883, -1015.7668893072644, -1138.1074958682557, -61.449477997459525, -971.2695957692156, -1157.097991287139, -769.1516383737425, -1303.1519396950666, -526.8993787901823, -922.8231945618143, -868.5050051570346, -954.0055348669039, -1096.904431149749, -55.1994421603201, -1242.4340581160648, -1209.778420748421, -114.1771236908886, -857.0380594559856, -55.69553812311356, -924.7338255191193, -1234.274226529081, -207.96748011885626, -476.4773269517327, -984.2398928810782, -375.90574077703127, -133.96440470806166, -1055.623378556018, -870.836970145907, -1299.5495432863552, -1202.995322795186, -169.21842388497876, -1128.2434365416043, -1067.5814281970634, -964.6587345022492, -135.13185165559602, -1016.3178385523032, -485.6495024067673, -923.2523529977221, -917.5962875812236, -47.6632268722772, -1142.4850769738719, -810.0402517979505, -689.3551127945163, -1226.0853887681328, -148.52667360543532, -1078.9492361531368, -1271.579499027423, -871.8906349935494, -571.0720197703127, -771.9964098050443, -974.1549567030431, -840.0277209964925, -1064.4219208250727, -1061.6274915628387, -96.06208736388581, -1013.3207323885665, -1001.4879568562862, -1061.0469660926954, -183.9376151347758, -77.69585805952008, -106.76075990973031, -1334.8936673462817, -1084.0304524002397, -1069.2767586544485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.562764092188916, "mean_inference_ms": 1.67469445101376, "mean_action_processing_ms": 0.2778812767876556, "mean_env_wait_ms": 3.4038971387004904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013293068984459186, "StateBufferConnector_ms": 0.008461393159011314, "ViewRequirementAgentConnector_ms": 0.18624683906292094}, "num_episodes": 34, "episode_return_max": -37.633114548771594, "episode_return_min": -1334.8936673462817, "episode_return_mean": -741.61796495073, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.03155075964816, "num_env_steps_trained_throughput_per_sec": 364.03155075964816, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12262.017, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12261.949, "sample_time_ms": 1118.583, "learn_time_ms": 11074.701, "learn_throughput": 361.184, "synch_weights_time_ms": 67.798}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00016", "date": "2024-08-04_06-57-11", "timestamp": 1722734831, "time_this_iter_s": 10.999606132507324, "time_total_s": 36.819507360458374, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.819507360458374, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.64375, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.521378697268665, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.764572528998057, "policy_loss": -0.005713437254356298, "vf_loss": 9.769128367304802, "vf_explained_var": 0.06391469569255909, "kl": 0.012500772429590752, "entropy": 1.342524978145957, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -37.633114548771594, "episode_reward_min": -1334.8936673462817, "episode_reward_mean": -726.4836351566188, "episode_len_mean": 124.29, "episode_media": {}, "episodes_timesteps_total": 12429, "policy_reward_min": {"policy_0": -1334.8936673462817}, "policy_reward_max": {"policy_0": -37.633114548771594}, "policy_reward_mean": {"policy_0": -726.4836351566188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-902.5240368902295, -378.89898617711236, -57.815559793996414, -64.72766536450592, -430.9105667137851, -613.2777063457926, -67.69750909399637, -37.633114548771594, -1005.6810470320883, -1015.7668893072644, -1138.1074958682557, -61.449477997459525, -971.2695957692156, -1157.097991287139, -769.1516383737425, -1303.1519396950666, -526.8993787901823, -922.8231945618143, -868.5050051570346, -954.0055348669039, -1096.904431149749, -55.1994421603201, -1242.4340581160648, -1209.778420748421, -114.1771236908886, -857.0380594559856, -55.69553812311356, -924.7338255191193, -1234.274226529081, -207.96748011885626, -476.4773269517327, -984.2398928810782, -375.90574077703127, -133.96440470806166, -1055.623378556018, -870.836970145907, -1299.5495432863552, -1202.995322795186, -169.21842388497876, -1128.2434365416043, -1067.5814281970634, -964.6587345022492, -135.13185165559602, -1016.3178385523032, -485.6495024067673, -923.2523529977221, -917.5962875812236, -47.6632268722772, -1142.4850769738719, -810.0402517979505, -689.3551127945163, -1226.0853887681328, -148.52667360543532, -1078.9492361531368, -1271.579499027423, -871.8906349935494, -571.0720197703127, -771.9964098050443, -974.1549567030431, -840.0277209964925, -1064.4219208250727, -1061.6274915628387, -96.06208736388581, -1013.3207323885665, -1001.4879568562862, -1061.0469660926954, -183.9376151347758, -77.69585805952008, -106.76075990973031, -1334.8936673462817, -1084.0304524002397, -1069.2767586544485, -968.9021135017185, -1195.545732481498, -224.82098489692288, -1013.5355833227204, -915.4896136426438, -995.1401935350937, -781.518127595049, -192.16751208488674, -1087.7624954836192, -1171.4167881027402, -405.53925151387864, -142.96847040823513, -886.5920553620516, -561.6249733580529, -269.65981350641835, -478.608475265299, -539.4917758163003, -579.3705646499931, -772.4352909100076, -62.92040160723487, -1189.5684188662447, -252.67489834821615, -396.7148514824781, -925.6257112868832, -684.2482876013439, -1059.7755516630798, -995.6003513224936, -847.4173775244132], "episode_lengths": [150, 125, 56, 39, 126, 143, 46, 43, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 72, 150, 40, 150, 150, 73, 103, 150, 90, 52, 150, 150, 150, 150, 58, 150, 150, 150, 68, 150, 112, 150, 150, 64, 150, 150, 150, 150, 53, 150, 150, 150, 149, 150, 150, 141, 150, 150, 65, 150, 150, 150, 73, 61, 69, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 72, 150, 150, 108, 60, 150, 141, 73, 106, 110, 150, 149, 61, 150, 76, 100, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-902.5240368902295, -378.89898617711236, -57.815559793996414, -64.72766536450592, -430.9105667137851, -613.2777063457926, -67.69750909399637, -37.633114548771594, -1005.6810470320883, -1015.7668893072644, -1138.1074958682557, -61.449477997459525, -971.2695957692156, -1157.097991287139, -769.1516383737425, -1303.1519396950666, -526.8993787901823, -922.8231945618143, -868.5050051570346, -954.0055348669039, -1096.904431149749, -55.1994421603201, -1242.4340581160648, -1209.778420748421, -114.1771236908886, -857.0380594559856, -55.69553812311356, -924.7338255191193, -1234.274226529081, -207.96748011885626, -476.4773269517327, -984.2398928810782, -375.90574077703127, -133.96440470806166, -1055.623378556018, -870.836970145907, -1299.5495432863552, -1202.995322795186, -169.21842388497876, -1128.2434365416043, -1067.5814281970634, -964.6587345022492, -135.13185165559602, -1016.3178385523032, -485.6495024067673, -923.2523529977221, -917.5962875812236, -47.6632268722772, -1142.4850769738719, -810.0402517979505, -689.3551127945163, -1226.0853887681328, -148.52667360543532, -1078.9492361531368, -1271.579499027423, -871.8906349935494, -571.0720197703127, -771.9964098050443, -974.1549567030431, -840.0277209964925, -1064.4219208250727, -1061.6274915628387, -96.06208736388581, -1013.3207323885665, -1001.4879568562862, -1061.0469660926954, -183.9376151347758, -77.69585805952008, -106.76075990973031, -1334.8936673462817, -1084.0304524002397, -1069.2767586544485, -968.9021135017185, -1195.545732481498, -224.82098489692288, -1013.5355833227204, -915.4896136426438, -995.1401935350937, -781.518127595049, -192.16751208488674, -1087.7624954836192, -1171.4167881027402, -405.53925151387864, -142.96847040823513, -886.5920553620516, -561.6249733580529, -269.65981350641835, -478.608475265299, -539.4917758163003, -579.3705646499931, -772.4352909100076, -62.92040160723487, -1189.5684188662447, -252.67489834821615, -396.7148514824781, -925.6257112868832, -684.2482876013439, -1059.7755516630798, -995.6003513224936, -847.4173775244132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5622106633493407, "mean_inference_ms": 1.7275318862356146, "mean_action_processing_ms": 0.27803738477171025, "mean_env_wait_ms": 3.573695326275687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013858556747436523, "StateBufferConnector_ms": 0.008604049682617188, "ViewRequirementAgentConnector_ms": 0.18815016746520996}, "num_episodes": 28, "episode_return_max": -37.633114548771594, "episode_return_min": -1334.8936673462817, "episode_return_mean": -726.4836351566188, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.06805905042745, "num_env_steps_trained_throughput_per_sec": 297.06805905042745, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12562.748, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12562.681, "sample_time_ms": 1259.582, "learn_time_ms": 11235.841, "learn_throughput": 356.004, "synch_weights_time_ms": 66.39}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00016", "date": "2024-08-04_06-57-24", "timestamp": 1722734844, "time_this_iter_s": 13.477002143859863, "time_total_s": 50.29650950431824, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1719cb80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.29650950431824, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.573684210526316, "ram_util_percent": 28.089473684210528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5592157463853558, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.65096719264984, "policy_loss": -0.01169415642458868, "vf_loss": 9.66126790245374, "vf_explained_var": 0.14194580869128307, "kl": 0.01358585127315261, "entropy": 1.3236971334864696, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -27.575518706629172, "episode_reward_min": -1334.8936673462817, "episode_reward_mean": -756.2958893460841, "episode_len_mean": 127.41, "episode_media": {}, "episodes_timesteps_total": 12741, "policy_reward_min": {"policy_0": -1334.8936673462817}, "policy_reward_max": {"policy_0": -27.575518706629172}, "policy_reward_mean": {"policy_0": -756.2958893460841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-375.90574077703127, -133.96440470806166, -1055.623378556018, -870.836970145907, -1299.5495432863552, -1202.995322795186, -169.21842388497876, -1128.2434365416043, -1067.5814281970634, -964.6587345022492, -135.13185165559602, -1016.3178385523032, -485.6495024067673, -923.2523529977221, -917.5962875812236, -47.6632268722772, -1142.4850769738719, -810.0402517979505, -689.3551127945163, -1226.0853887681328, -148.52667360543532, -1078.9492361531368, -1271.579499027423, -871.8906349935494, -571.0720197703127, -771.9964098050443, -974.1549567030431, -840.0277209964925, -1064.4219208250727, -1061.6274915628387, -96.06208736388581, -1013.3207323885665, -1001.4879568562862, -1061.0469660926954, -183.9376151347758, -77.69585805952008, -106.76075990973031, -1334.8936673462817, -1084.0304524002397, -1069.2767586544485, -968.9021135017185, -1195.545732481498, -224.82098489692288, -1013.5355833227204, -915.4896136426438, -995.1401935350937, -781.518127595049, -192.16751208488674, -1087.7624954836192, -1171.4167881027402, -405.53925151387864, -142.96847040823513, -886.5920553620516, -561.6249733580529, -269.65981350641835, -478.608475265299, -539.4917758163003, -579.3705646499931, -772.4352909100076, -62.92040160723487, -1189.5684188662447, -252.67489834821615, -396.7148514824781, -925.6257112868832, -684.2482876013439, -1059.7755516630798, -995.6003513224936, -847.4173775244132, -394.18530111815403, -1289.8161549288475, -1258.6950531411267, -1181.427998766706, -471.3325121228295, -939.9552950985185, -1147.1268708126993, -579.3240025139364, -1148.1342155802504, -391.45505939685796, -732.5330575774425, -1239.6868535270603, -113.8979401003804, -1128.8261671964588, -1302.47080663071, -266.2251212641121, -807.7497391907349, -547.1812971652957, -966.7163716789687, -1064.5889209360582, -740.1257486325061, -666.849986690779, -961.5788905621007, -1072.9574378487193, -1080.512209400589, -559.8851265531548, -271.9854599953797, -43.95879161789079, -990.7962629399277, -1203.783076668793, -96.20232966168648, -27.575518706629172], "episode_lengths": [90, 52, 150, 150, 150, 150, 58, 150, 150, 150, 68, 150, 112, 150, 150, 64, 150, 150, 150, 150, 53, 150, 150, 150, 149, 150, 150, 141, 150, 150, 65, 150, 150, 150, 73, 61, 69, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 72, 150, 150, 108, 60, 150, 141, 73, 106, 110, 150, 149, 61, 150, 76, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 119, 150, 150, 69, 150, 150, 73, 150, 108, 150, 150, 150, 129, 150, 150, 150, 150, 74, 37, 150, 150, 50, 42], "policy_policy_0_reward": [-375.90574077703127, -133.96440470806166, -1055.623378556018, -870.836970145907, -1299.5495432863552, -1202.995322795186, -169.21842388497876, -1128.2434365416043, -1067.5814281970634, -964.6587345022492, -135.13185165559602, -1016.3178385523032, -485.6495024067673, -923.2523529977221, -917.5962875812236, -47.6632268722772, -1142.4850769738719, -810.0402517979505, -689.3551127945163, -1226.0853887681328, -148.52667360543532, -1078.9492361531368, -1271.579499027423, -871.8906349935494, -571.0720197703127, -771.9964098050443, -974.1549567030431, -840.0277209964925, -1064.4219208250727, -1061.6274915628387, -96.06208736388581, -1013.3207323885665, -1001.4879568562862, -1061.0469660926954, -183.9376151347758, -77.69585805952008, -106.76075990973031, -1334.8936673462817, -1084.0304524002397, -1069.2767586544485, -968.9021135017185, -1195.545732481498, -224.82098489692288, -1013.5355833227204, -915.4896136426438, -995.1401935350937, -781.518127595049, -192.16751208488674, -1087.7624954836192, -1171.4167881027402, -405.53925151387864, -142.96847040823513, -886.5920553620516, -561.6249733580529, -269.65981350641835, -478.608475265299, -539.4917758163003, -579.3705646499931, -772.4352909100076, -62.92040160723487, -1189.5684188662447, -252.67489834821615, -396.7148514824781, -925.6257112868832, -684.2482876013439, -1059.7755516630798, -995.6003513224936, -847.4173775244132, -394.18530111815403, -1289.8161549288475, -1258.6950531411267, -1181.427998766706, -471.3325121228295, -939.9552950985185, -1147.1268708126993, -579.3240025139364, -1148.1342155802504, -391.45505939685796, -732.5330575774425, -1239.6868535270603, -113.8979401003804, -1128.8261671964588, -1302.47080663071, -266.2251212641121, -807.7497391907349, -547.1812971652957, -966.7163716789687, -1064.5889209360582, -740.1257486325061, -666.849986690779, -961.5788905621007, -1072.9574378487193, -1080.512209400589, -559.8851265531548, -271.9854599953797, -43.95879161789079, -990.7962629399277, -1203.783076668793, -96.20232966168648, -27.575518706629172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628062361275877, "mean_inference_ms": 1.7761526087709782, "mean_action_processing_ms": 0.27834460565045943, "mean_env_wait_ms": 3.7222581116186433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013697147369384766, "StateBufferConnector_ms": 0.008784055709838867, "ViewRequirementAgentConnector_ms": 0.19060587882995605}, "num_episodes": 32, "episode_return_max": -27.575518706629172, "episode_return_min": -1334.8936673462817, "episode_return_mean": -756.2958893460841, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.61435187570464, "num_env_steps_trained_throughput_per_sec": 307.61435187570464, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12650.86, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12650.785, "sample_time_ms": 1240.976, "learn_time_ms": 11343.026, "learn_throughput": 352.64, "synch_weights_time_ms": 65.92}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00016", "date": "2024-08-04_06-57-37", "timestamp": 1722734857, "time_this_iter_s": 13.015447854995728, "time_total_s": 63.311957359313965, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a6320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.311957359313965, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.48947368421053, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9602401362111173, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.46905593574047, "policy_loss": -0.014275324089006365, "vf_loss": 9.48109374642372, "vf_explained_var": 0.174518153257668, "kl": 0.01780185404522854, "entropy": 1.3228437881916761, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -27.575518706629172, "episode_reward_min": -1334.8936673462817, "episode_reward_mean": -745.1230438934783, "episode_len_mean": 128.47, "episode_media": {}, "episodes_timesteps_total": 12847, "policy_reward_min": {"policy_0": -1334.8936673462817}, "policy_reward_max": {"policy_0": -27.575518706629172}, "policy_reward_mean": {"policy_0": -745.1230438934783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.06208736388581, -1013.3207323885665, -1001.4879568562862, -1061.0469660926954, -183.9376151347758, -77.69585805952008, -106.76075990973031, -1334.8936673462817, -1084.0304524002397, -1069.2767586544485, -968.9021135017185, -1195.545732481498, -224.82098489692288, -1013.5355833227204, -915.4896136426438, -995.1401935350937, -781.518127595049, -192.16751208488674, -1087.7624954836192, -1171.4167881027402, -405.53925151387864, -142.96847040823513, -886.5920553620516, -561.6249733580529, -269.65981350641835, -478.608475265299, -539.4917758163003, -579.3705646499931, -772.4352909100076, -62.92040160723487, -1189.5684188662447, -252.67489834821615, -396.7148514824781, -925.6257112868832, -684.2482876013439, -1059.7755516630798, -995.6003513224936, -847.4173775244132, -394.18530111815403, -1289.8161549288475, -1258.6950531411267, -1181.427998766706, -471.3325121228295, -939.9552950985185, -1147.1268708126993, -579.3240025139364, -1148.1342155802504, -391.45505939685796, -732.5330575774425, -1239.6868535270603, -113.8979401003804, -1128.8261671964588, -1302.47080663071, -266.2251212641121, -807.7497391907349, -547.1812971652957, -966.7163716789687, -1064.5889209360582, -740.1257486325061, -666.849986690779, -961.5788905621007, -1072.9574378487193, -1080.512209400589, -559.8851265531548, -271.9854599953797, -43.95879161789079, -990.7962629399277, -1203.783076668793, -96.20232966168648, -27.575518706629172, -112.19549429296444, -192.89747331915922, -719.3720104413297, -712.4357949319835, -537.7009188813684, -969.7868054219382, -1135.5166480611426, -972.661737071722, -768.3474453341919, -832.3517958702082, -506.0691184402754, -358.2907179122139, -995.3429812314054, -878.850146888322, -278.337459263959, -1033.8292790873545, -1034.8577689535919, -815.5196965845162, -1180.1346511443485, -969.5499263970189, -305.04709838824596, -934.3009635512032, -1029.4280149538245, -313.2672917581378, -1250.0741926585633, -997.8188399637856, -983.0922788479403, -846.3258223786089, -347.8367374780889, -1187.8771824691628], "episode_lengths": [65, 150, 150, 150, 73, 61, 69, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 72, 150, 150, 108, 60, 150, 141, 73, 106, 110, 150, 149, 61, 150, 76, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 119, 150, 150, 69, 150, 150, 73, 150, 108, 150, 150, 150, 129, 150, 150, 150, 150, 74, 37, 150, 150, 50, 42, 55, 60, 150, 150, 150, 150, 150, 150, 141, 150, 150, 131, 150, 150, 78, 150, 150, 150, 150, 150, 80, 150, 150, 84, 150, 150, 150, 150, 114, 150], "policy_policy_0_reward": [-96.06208736388581, -1013.3207323885665, -1001.4879568562862, -1061.0469660926954, -183.9376151347758, -77.69585805952008, -106.76075990973031, -1334.8936673462817, -1084.0304524002397, -1069.2767586544485, -968.9021135017185, -1195.545732481498, -224.82098489692288, -1013.5355833227204, -915.4896136426438, -995.1401935350937, -781.518127595049, -192.16751208488674, -1087.7624954836192, -1171.4167881027402, -405.53925151387864, -142.96847040823513, -886.5920553620516, -561.6249733580529, -269.65981350641835, -478.608475265299, -539.4917758163003, -579.3705646499931, -772.4352909100076, -62.92040160723487, -1189.5684188662447, -252.67489834821615, -396.7148514824781, -925.6257112868832, -684.2482876013439, -1059.7755516630798, -995.6003513224936, -847.4173775244132, -394.18530111815403, -1289.8161549288475, -1258.6950531411267, -1181.427998766706, -471.3325121228295, -939.9552950985185, -1147.1268708126993, -579.3240025139364, -1148.1342155802504, -391.45505939685796, -732.5330575774425, -1239.6868535270603, -113.8979401003804, -1128.8261671964588, -1302.47080663071, -266.2251212641121, -807.7497391907349, -547.1812971652957, -966.7163716789687, -1064.5889209360582, -740.1257486325061, -666.849986690779, -961.5788905621007, -1072.9574378487193, -1080.512209400589, -559.8851265531548, -271.9854599953797, -43.95879161789079, -990.7962629399277, -1203.783076668793, -96.20232966168648, -27.575518706629172, -112.19549429296444, -192.89747331915922, -719.3720104413297, -712.4357949319835, -537.7009188813684, -969.7868054219382, -1135.5166480611426, -972.661737071722, -768.3474453341919, -832.3517958702082, -506.0691184402754, -358.2907179122139, -995.3429812314054, -878.850146888322, -278.337459263959, -1033.8292790873545, -1034.8577689535919, -815.5196965845162, -1180.1346511443485, -969.5499263970189, -305.04709838824596, -934.3009635512032, -1029.4280149538245, -313.2672917581378, -1250.0741926585633, -997.8188399637856, -983.0922788479403, -846.3258223786089, -347.8367374780889, -1187.8771824691628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5640742115425951, "mean_inference_ms": 1.819098625280617, "mean_action_processing_ms": 0.2794216495821528, "mean_env_wait_ms": 3.8405098282771393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013835430145263672, "StateBufferConnector_ms": 0.008731842041015625, "ViewRequirementAgentConnector_ms": 0.19025897979736328}, "num_episodes": 30, "episode_return_max": -27.575518706629172, "episode_return_min": -1334.8936673462817, "episode_return_mean": -745.1230438934783, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.5123053277642, "num_env_steps_trained_throughput_per_sec": 304.5123053277642, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12731.678, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12731.605, "sample_time_ms": 1219.736, "learn_time_ms": 11445.273, "learn_throughput": 349.489, "synch_weights_time_ms": 65.735}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00016", "date": "2024-08-04_06-57-50", "timestamp": 1722734870, "time_this_iter_s": 13.147748470306396, "time_total_s": 76.45970582962036, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.45970582962036, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.522222222222222, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1362614404410123, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.551093672712645, "policy_loss": -0.011769437756932651, "vf_loss": 9.560685665408771, "vf_explained_var": 0.19028344787657261, "kl": 0.017731788094746057, "entropy": 1.3689387024690707, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -26.655878914105585, "episode_reward_min": -1302.47080663071, "episode_reward_mean": -750.0034419604244, "episode_len_mean": 128.8, "episode_media": {}, "episodes_timesteps_total": 12880, "policy_reward_min": {"policy_0": -1302.47080663071}, "policy_reward_max": {"policy_0": -26.655878914105585}, "policy_reward_mean": {"policy_0": -750.0034419604244}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.92040160723487, -1189.5684188662447, -252.67489834821615, -396.7148514824781, -925.6257112868832, -684.2482876013439, -1059.7755516630798, -995.6003513224936, -847.4173775244132, -394.18530111815403, -1289.8161549288475, -1258.6950531411267, -1181.427998766706, -471.3325121228295, -939.9552950985185, -1147.1268708126993, -579.3240025139364, -1148.1342155802504, -391.45505939685796, -732.5330575774425, -1239.6868535270603, -113.8979401003804, -1128.8261671964588, -1302.47080663071, -266.2251212641121, -807.7497391907349, -547.1812971652957, -966.7163716789687, -1064.5889209360582, -740.1257486325061, -666.849986690779, -961.5788905621007, -1072.9574378487193, -1080.512209400589, -559.8851265531548, -271.9854599953797, -43.95879161789079, -990.7962629399277, -1203.783076668793, -96.20232966168648, -27.575518706629172, -112.19549429296444, -192.89747331915922, -719.3720104413297, -712.4357949319835, -537.7009188813684, -969.7868054219382, -1135.5166480611426, -972.661737071722, -768.3474453341919, -832.3517958702082, -506.0691184402754, -358.2907179122139, -995.3429812314054, -878.850146888322, -278.337459263959, -1033.8292790873545, -1034.8577689535919, -815.5196965845162, -1180.1346511443485, -969.5499263970189, -305.04709838824596, -934.3009635512032, -1029.4280149538245, -313.2672917581378, -1250.0741926585633, -997.8188399637856, -983.0922788479403, -846.3258223786089, -347.8367374780889, -1187.8771824691628, -959.9610546489271, -555.917840185676, -960.5951702988433, -517.824247079754, -580.0942167287955, -704.0358351785138, -238.1813455261031, -293.63767278548676, -66.38063033560638, -827.3371357348439, -1133.5452866761927, -1096.7377761836512, -390.2288692959973, -1173.8811683633544, -1019.3946244287547, -1040.3486198286041, -1120.03946516493, -86.05260931463077, -244.47393794753881, -1206.9822900052416, -1172.5264022346212, -1010.9263030674181, -74.36338107535764, -1088.7060745767249, -1292.4149014283137, -453.8166690238586, -138.60536089015667, -1225.4777094161757, -26.655878914105585], "episode_lengths": [61, 150, 76, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 119, 150, 150, 69, 150, 150, 73, 150, 108, 150, 150, 150, 129, 150, 150, 150, 150, 74, 37, 150, 150, 50, 42, 55, 60, 150, 150, 150, 150, 150, 150, 141, 150, 150, 131, 150, 150, 78, 150, 150, 150, 150, 150, 80, 150, 150, 84, 150, 150, 150, 150, 114, 150, 150, 116, 150, 150, 132, 150, 91, 97, 49, 150, 150, 150, 94, 150, 150, 150, 150, 68, 72, 150, 150, 150, 50, 150, 150, 150, 73, 150, 44], "policy_policy_0_reward": [-62.92040160723487, -1189.5684188662447, -252.67489834821615, -396.7148514824781, -925.6257112868832, -684.2482876013439, -1059.7755516630798, -995.6003513224936, -847.4173775244132, -394.18530111815403, -1289.8161549288475, -1258.6950531411267, -1181.427998766706, -471.3325121228295, -939.9552950985185, -1147.1268708126993, -579.3240025139364, -1148.1342155802504, -391.45505939685796, -732.5330575774425, -1239.6868535270603, -113.8979401003804, -1128.8261671964588, -1302.47080663071, -266.2251212641121, -807.7497391907349, -547.1812971652957, -966.7163716789687, -1064.5889209360582, -740.1257486325061, -666.849986690779, -961.5788905621007, -1072.9574378487193, -1080.512209400589, -559.8851265531548, -271.9854599953797, -43.95879161789079, -990.7962629399277, -1203.783076668793, -96.20232966168648, -27.575518706629172, -112.19549429296444, -192.89747331915922, -719.3720104413297, -712.4357949319835, -537.7009188813684, -969.7868054219382, -1135.5166480611426, -972.661737071722, -768.3474453341919, -832.3517958702082, -506.0691184402754, -358.2907179122139, -995.3429812314054, -878.850146888322, -278.337459263959, -1033.8292790873545, -1034.8577689535919, -815.5196965845162, -1180.1346511443485, -969.5499263970189, -305.04709838824596, -934.3009635512032, -1029.4280149538245, -313.2672917581378, -1250.0741926585633, -997.8188399637856, -983.0922788479403, -846.3258223786089, -347.8367374780889, -1187.8771824691628, -959.9610546489271, -555.917840185676, -960.5951702988433, -517.824247079754, -580.0942167287955, -704.0358351785138, -238.1813455261031, -293.63767278548676, -66.38063033560638, -827.3371357348439, -1133.5452866761927, -1096.7377761836512, -390.2288692959973, -1173.8811683633544, -1019.3946244287547, -1040.3486198286041, -1120.03946516493, -86.05260931463077, -244.47393794753881, -1206.9822900052416, -1172.5264022346212, -1010.9263030674181, -74.36338107535764, -1088.7060745767249, -1292.4149014283137, -453.8166690238586, -138.60536089015667, -1225.4777094161757, -26.655878914105585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5639593013241943, "mean_inference_ms": 1.816149380731984, "mean_action_processing_ms": 0.2793722764114827, "mean_env_wait_ms": 3.8237301618860227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013563394546508789, "StateBufferConnector_ms": 0.008576631546020508, "ViewRequirementAgentConnector_ms": 0.19014334678649902}, "num_episodes": 29, "episode_return_max": -26.655878914105585, "episode_return_min": -1302.47080663071, "episode_return_mean": -750.0034419604244, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.17329255780635, "num_env_steps_trained_throughput_per_sec": 332.17329255780635, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12633.141, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12633.07, "sample_time_ms": 1205.561, "learn_time_ms": 11361.424, "learn_throughput": 352.069, "synch_weights_time_ms": 65.218}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00016", "date": "2024-08-04_06-58-02", "timestamp": 1722734882, "time_this_iter_s": 12.053236246109009, "time_total_s": 88.51294207572937, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1739f010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.51294207572937, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.772222222222226, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.500878120958805, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.57412893474102, "policy_loss": -0.009065457105558986, "vf_loss": 9.581413507461548, "vf_explained_var": 0.22021665275096894, "kl": 0.015810820679932173, "entropy": 1.3812664815535147, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -26.655878914105585, "episode_reward_min": -1295.2125332003834, "episode_reward_mean": -754.524932769424, "episode_len_mean": 130.04, "episode_media": {}, "episodes_timesteps_total": 13004, "policy_reward_min": {"policy_0": -1295.2125332003834}, "policy_reward_max": {"policy_0": -26.655878914105585}, "policy_reward_mean": {"policy_0": -754.524932769424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-666.849986690779, -961.5788905621007, -1072.9574378487193, -1080.512209400589, -559.8851265531548, -271.9854599953797, -43.95879161789079, -990.7962629399277, -1203.783076668793, -96.20232966168648, -27.575518706629172, -112.19549429296444, -192.89747331915922, -719.3720104413297, -712.4357949319835, -537.7009188813684, -969.7868054219382, -1135.5166480611426, -972.661737071722, -768.3474453341919, -832.3517958702082, -506.0691184402754, -358.2907179122139, -995.3429812314054, -878.850146888322, -278.337459263959, -1033.8292790873545, -1034.8577689535919, -815.5196965845162, -1180.1346511443485, -969.5499263970189, -305.04709838824596, -934.3009635512032, -1029.4280149538245, -313.2672917581378, -1250.0741926585633, -997.8188399637856, -983.0922788479403, -846.3258223786089, -347.8367374780889, -1187.8771824691628, -959.9610546489271, -555.917840185676, -960.5951702988433, -517.824247079754, -580.0942167287955, -704.0358351785138, -238.1813455261031, -293.63767278548676, -66.38063033560638, -827.3371357348439, -1133.5452866761927, -1096.7377761836512, -390.2288692959973, -1173.8811683633544, -1019.3946244287547, -1040.3486198286041, -1120.03946516493, -86.05260931463077, -244.47393794753881, -1206.9822900052416, -1172.5264022346212, -1010.9263030674181, -74.36338107535764, -1088.7060745767249, -1292.4149014283137, -453.8166690238586, -138.60536089015667, -1225.4777094161757, -26.655878914105585, -538.2847797272262, -1099.4439799703628, -104.16165869659092, -1112.4126483044067, -1133.5723931258713, -703.2780878334942, -802.0961538624549, -1046.195146727805, -109.10196087911949, -896.8824612738875, -1011.3171353112637, -273.9324421271827, -974.9046305381755, -1054.8627333428121, -657.6417890729327, -762.5215113896271, -783.504952704474, -1200.7016716101411, -871.7113253050965, -1063.9007458641142, -174.92138736105107, -1059.1280381562838, -717.0592114328487, -1194.191041943589, -694.3775248934435, -468.20044866187084, -1295.2125332003834, -735.3493314054153, -1044.0137662715522, -995.2679269885242], "episode_lengths": [129, 150, 150, 150, 150, 74, 37, 150, 150, 50, 42, 55, 60, 150, 150, 150, 150, 150, 150, 141, 150, 150, 131, 150, 150, 78, 150, 150, 150, 150, 150, 80, 150, 150, 84, 150, 150, 150, 150, 114, 150, 150, 116, 150, 150, 132, 150, 91, 97, 49, 150, 150, 150, 94, 150, 150, 150, 150, 68, 72, 150, 150, 150, 50, 150, 150, 150, 73, 150, 44, 149, 150, 55, 150, 150, 150, 150, 150, 56, 150, 150, 89, 149, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 124, 150, 150, 150, 150], "policy_policy_0_reward": [-666.849986690779, -961.5788905621007, -1072.9574378487193, -1080.512209400589, -559.8851265531548, -271.9854599953797, -43.95879161789079, -990.7962629399277, -1203.783076668793, -96.20232966168648, -27.575518706629172, -112.19549429296444, -192.89747331915922, -719.3720104413297, -712.4357949319835, -537.7009188813684, -969.7868054219382, -1135.5166480611426, -972.661737071722, -768.3474453341919, -832.3517958702082, -506.0691184402754, -358.2907179122139, -995.3429812314054, -878.850146888322, -278.337459263959, -1033.8292790873545, -1034.8577689535919, -815.5196965845162, -1180.1346511443485, -969.5499263970189, -305.04709838824596, -934.3009635512032, -1029.4280149538245, -313.2672917581378, -1250.0741926585633, -997.8188399637856, -983.0922788479403, -846.3258223786089, -347.8367374780889, -1187.8771824691628, -959.9610546489271, -555.917840185676, -960.5951702988433, -517.824247079754, -580.0942167287955, -704.0358351785138, -238.1813455261031, -293.63767278548676, -66.38063033560638, -827.3371357348439, -1133.5452866761927, -1096.7377761836512, -390.2288692959973, -1173.8811683633544, -1019.3946244287547, -1040.3486198286041, -1120.03946516493, -86.05260931463077, -244.47393794753881, -1206.9822900052416, -1172.5264022346212, -1010.9263030674181, -74.36338107535764, -1088.7060745767249, -1292.4149014283137, -453.8166690238586, -138.60536089015667, -1225.4777094161757, -26.655878914105585, -538.2847797272262, -1099.4439799703628, -104.16165869659092, -1112.4126483044067, -1133.5723931258713, -703.2780878334942, -802.0961538624549, -1046.195146727805, -109.10196087911949, -896.8824612738875, -1011.3171353112637, -273.9324421271827, -974.9046305381755, -1054.8627333428121, -657.6417890729327, -762.5215113896271, -783.504952704474, -1200.7016716101411, -871.7113253050965, -1063.9007458641142, -174.92138736105107, -1059.1280381562838, -717.0592114328487, -1194.191041943589, -694.3775248934435, -468.20044866187084, -1295.2125332003834, -735.3493314054153, -1044.0137662715522, -995.2679269885242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620118667372014, "mean_inference_ms": 1.7910042826728678, "mean_action_processing_ms": 0.2792898183844517, "mean_env_wait_ms": 3.766902671401663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013120174407958984, "StateBufferConnector_ms": 0.008314371109008789, "ViewRequirementAgentConnector_ms": 0.190047025680542}, "num_episodes": 30, "episode_return_max": -26.655878914105585, "episode_return_min": -1295.2125332003834, "episode_return_mean": -754.524932769424, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.09557394224925, "num_env_steps_trained_throughput_per_sec": 311.09557394224925, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12661.223, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12661.153, "sample_time_ms": 1203.236, "learn_time_ms": 11390.931, "learn_throughput": 351.157, "synch_weights_time_ms": 66.117}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00016", "date": "2024-08-04_06-58-15", "timestamp": 1722734895, "time_this_iter_s": 12.86965560913086, "time_total_s": 101.38259768486023, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e1ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.38259768486023, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.772222222222226, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.487918239148955, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.372832758227984, "policy_loss": -0.012314693204825745, "vf_loss": 9.38243484099706, "vf_explained_var": 0.24843676816672086, "kl": 0.02032567302321316, "entropy": 1.352502202987671, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -26.655878914105585, "episode_reward_min": -1507.8833741166502, "episode_reward_mean": -791.0350268481448, "episode_len_mean": 134.42, "episode_media": {}, "episodes_timesteps_total": 13442, "policy_reward_min": {"policy_0": -1507.8833741166502}, "policy_reward_max": {"policy_0": -26.655878914105585}, "policy_reward_mean": {"policy_0": -791.0350268481448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-969.5499263970189, -305.04709838824596, -934.3009635512032, -1029.4280149538245, -313.2672917581378, -1250.0741926585633, -997.8188399637856, -983.0922788479403, -846.3258223786089, -347.8367374780889, -1187.8771824691628, -959.9610546489271, -555.917840185676, -960.5951702988433, -517.824247079754, -580.0942167287955, -704.0358351785138, -238.1813455261031, -293.63767278548676, -66.38063033560638, -827.3371357348439, -1133.5452866761927, -1096.7377761836512, -390.2288692959973, -1173.8811683633544, -1019.3946244287547, -1040.3486198286041, -1120.03946516493, -86.05260931463077, -244.47393794753881, -1206.9822900052416, -1172.5264022346212, -1010.9263030674181, -74.36338107535764, -1088.7060745767249, -1292.4149014283137, -453.8166690238586, -138.60536089015667, -1225.4777094161757, -26.655878914105585, -538.2847797272262, -1099.4439799703628, -104.16165869659092, -1112.4126483044067, -1133.5723931258713, -703.2780878334942, -802.0961538624549, -1046.195146727805, -109.10196087911949, -896.8824612738875, -1011.3171353112637, -273.9324421271827, -974.9046305381755, -1054.8627333428121, -657.6417890729327, -762.5215113896271, -783.504952704474, -1200.7016716101411, -871.7113253050965, -1063.9007458641142, -174.92138736105107, -1059.1280381562838, -717.0592114328487, -1194.191041943589, -694.3775248934435, -468.20044866187084, -1295.2125332003834, -735.3493314054153, -1044.0137662715522, -995.2679269885242, -965.8913496866724, -932.2009254511619, -1120.0084144682035, -775.8523125468271, -118.41558475776327, -431.17503795255845, -290.1151949741883, -973.4541380030138, -1047.6901810046913, -880.10901640337, -1437.0709481150925, -1042.6358756838385, -650.5466818598894, -590.5309035677656, -595.3878386040801, -217.8150980811126, -1383.9485180526328, -783.2976850798043, -995.6773743366699, -1189.9983665856353, -1085.296532192051, -652.3131520476079, -676.8512629947089, -652.9405513498165, -1507.8833741166502, -695.934351199741, -749.4348942407927, -518.789606546143, -546.9058892876636, -1153.421382459572], "episode_lengths": [150, 80, 150, 150, 84, 150, 150, 150, 150, 114, 150, 150, 116, 150, 150, 132, 150, 91, 97, 49, 150, 150, 150, 94, 150, 150, 150, 150, 68, 72, 150, 150, 150, 50, 150, 150, 150, 73, 150, 44, 149, 150, 55, 150, 150, 150, 150, 150, 56, 150, 150, 89, 149, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 144, 81, 93, 111, 150, 150, 150, 150, 150, 131, 150, 150, 92, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150], "policy_policy_0_reward": [-969.5499263970189, -305.04709838824596, -934.3009635512032, -1029.4280149538245, -313.2672917581378, -1250.0741926585633, -997.8188399637856, -983.0922788479403, -846.3258223786089, -347.8367374780889, -1187.8771824691628, -959.9610546489271, -555.917840185676, -960.5951702988433, -517.824247079754, -580.0942167287955, -704.0358351785138, -238.1813455261031, -293.63767278548676, -66.38063033560638, -827.3371357348439, -1133.5452866761927, -1096.7377761836512, -390.2288692959973, -1173.8811683633544, -1019.3946244287547, -1040.3486198286041, -1120.03946516493, -86.05260931463077, -244.47393794753881, -1206.9822900052416, -1172.5264022346212, -1010.9263030674181, -74.36338107535764, -1088.7060745767249, -1292.4149014283137, -453.8166690238586, -138.60536089015667, -1225.4777094161757, -26.655878914105585, -538.2847797272262, -1099.4439799703628, -104.16165869659092, -1112.4126483044067, -1133.5723931258713, -703.2780878334942, -802.0961538624549, -1046.195146727805, -109.10196087911949, -896.8824612738875, -1011.3171353112637, -273.9324421271827, -974.9046305381755, -1054.8627333428121, -657.6417890729327, -762.5215113896271, -783.504952704474, -1200.7016716101411, -871.7113253050965, -1063.9007458641142, -174.92138736105107, -1059.1280381562838, -717.0592114328487, -1194.191041943589, -694.3775248934435, -468.20044866187084, -1295.2125332003834, -735.3493314054153, -1044.0137662715522, -995.2679269885242, -965.8913496866724, -932.2009254511619, -1120.0084144682035, -775.8523125468271, -118.41558475776327, -431.17503795255845, -290.1151949741883, -973.4541380030138, -1047.6901810046913, -880.10901640337, -1437.0709481150925, -1042.6358756838385, -650.5466818598894, -590.5309035677656, -595.3878386040801, -217.8150980811126, -1383.9485180526328, -783.2976850798043, -995.6773743366699, -1189.9983665856353, -1085.296532192051, -652.3131520476079, -676.8512629947089, -652.9405513498165, -1507.8833741166502, -695.934351199741, -749.4348942407927, -518.789606546143, -546.9058892876636, -1153.421382459572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560541382560743, "mean_inference_ms": 1.7806024153438849, "mean_action_processing_ms": 0.27833303221664035, "mean_env_wait_ms": 3.718343727450041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012614250183105469, "StateBufferConnector_ms": 0.008097648620605469, "ViewRequirementAgentConnector_ms": 0.19148468971252441}, "num_episodes": 30, "episode_return_max": -26.655878914105585, "episode_return_min": -1507.8833741166502, "episode_return_mean": -791.0350268481448, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.6677037794599, "num_env_steps_trained_throughput_per_sec": 314.6677037794599, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12666.847, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12666.777, "sample_time_ms": 1193.699, "learn_time_ms": 11405.911, "learn_throughput": 350.695, "synch_weights_time_ms": 66.294}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00016", "date": "2024-08-04_06-58-28", "timestamp": 1722734908, "time_this_iter_s": 12.72583293914795, "time_total_s": 114.10843062400818, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.10843062400818, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.67222222222222, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.191078231856228, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.219174298644067, "policy_loss": -0.007637545015313663, "vf_loss": 9.223975037535032, "vf_explained_var": 0.3859659403562546, "kl": 0.013481218896170814, "entropy": 1.2075387397781014, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -26.655878914105585, "episode_reward_min": -1507.8833741166502, "episode_reward_mean": -722.1930821123054, "episode_len_mean": 131.12, "episode_media": {}, "episodes_timesteps_total": 13112, "policy_reward_min": {"policy_0": -1507.8833741166502}, "policy_reward_max": {"policy_0": -26.655878914105585}, "policy_reward_mean": {"policy_0": -722.1930821123054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1088.7060745767249, -1292.4149014283137, -453.8166690238586, -138.60536089015667, -1225.4777094161757, -26.655878914105585, -538.2847797272262, -1099.4439799703628, -104.16165869659092, -1112.4126483044067, -1133.5723931258713, -703.2780878334942, -802.0961538624549, -1046.195146727805, -109.10196087911949, -896.8824612738875, -1011.3171353112637, -273.9324421271827, -974.9046305381755, -1054.8627333428121, -657.6417890729327, -762.5215113896271, -783.504952704474, -1200.7016716101411, -871.7113253050965, -1063.9007458641142, -174.92138736105107, -1059.1280381562838, -717.0592114328487, -1194.191041943589, -694.3775248934435, -468.20044866187084, -1295.2125332003834, -735.3493314054153, -1044.0137662715522, -995.2679269885242, -965.8913496866724, -932.2009254511619, -1120.0084144682035, -775.8523125468271, -118.41558475776327, -431.17503795255845, -290.1151949741883, -973.4541380030138, -1047.6901810046913, -880.10901640337, -1437.0709481150925, -1042.6358756838385, -650.5466818598894, -590.5309035677656, -595.3878386040801, -217.8150980811126, -1383.9485180526328, -783.2976850798043, -995.6773743366699, -1189.9983665856353, -1085.296532192051, -652.3131520476079, -676.8512629947089, -652.9405513498165, -1507.8833741166502, -695.934351199741, -749.4348942407927, -518.789606546143, -546.9058892876636, -1153.421382459572, -730.7199472103084, -754.2625384954255, -1100.802886290643, -441.99463172678804, -594.3881983145686, -437.5611374067077, -1171.899894311903, -417.11937215537074, -904.5082722017554, -206.03181921301936, -140.39147051968757, -542.5121367045066, -160.57199085733959, -75.0682733631984, -507.08242352984905, -1169.5743467629045, -475.66083890345277, -433.48585874575696, -718.1886810949796, -643.7595797083645, -193.7360408062952, -743.656646695521, -958.4830009985325, -456.3030463783007, -143.2330495623396, -1161.8875961982885, -596.1939276238602, -1229.4060931833903, -560.7108271155579, -95.96834585503638, -31.316798475731307, -51.14374754558361, -793.5199811506031, -112.74635824391471], "episode_lengths": [150, 150, 150, 73, 150, 44, 149, 150, 55, 150, 150, 150, 150, 150, 56, 150, 150, 89, 149, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 144, 81, 93, 111, 150, 150, 150, 150, 150, 131, 150, 150, 92, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 102, 150, 73, 66, 122, 65, 64, 150, 150, 150, 114, 150, 150, 61, 150, 150, 150, 65, 150, 150, 150, 112, 65, 46, 57, 150, 47], "policy_policy_0_reward": [-1088.7060745767249, -1292.4149014283137, -453.8166690238586, -138.60536089015667, -1225.4777094161757, -26.655878914105585, -538.2847797272262, -1099.4439799703628, -104.16165869659092, -1112.4126483044067, -1133.5723931258713, -703.2780878334942, -802.0961538624549, -1046.195146727805, -109.10196087911949, -896.8824612738875, -1011.3171353112637, -273.9324421271827, -974.9046305381755, -1054.8627333428121, -657.6417890729327, -762.5215113896271, -783.504952704474, -1200.7016716101411, -871.7113253050965, -1063.9007458641142, -174.92138736105107, -1059.1280381562838, -717.0592114328487, -1194.191041943589, -694.3775248934435, -468.20044866187084, -1295.2125332003834, -735.3493314054153, -1044.0137662715522, -995.2679269885242, -965.8913496866724, -932.2009254511619, -1120.0084144682035, -775.8523125468271, -118.41558475776327, -431.17503795255845, -290.1151949741883, -973.4541380030138, -1047.6901810046913, -880.10901640337, -1437.0709481150925, -1042.6358756838385, -650.5466818598894, -590.5309035677656, -595.3878386040801, -217.8150980811126, -1383.9485180526328, -783.2976850798043, -995.6773743366699, -1189.9983665856353, -1085.296532192051, -652.3131520476079, -676.8512629947089, -652.9405513498165, -1507.8833741166502, -695.934351199741, -749.4348942407927, -518.789606546143, -546.9058892876636, -1153.421382459572, -730.7199472103084, -754.2625384954255, -1100.802886290643, -441.99463172678804, -594.3881983145686, -437.5611374067077, -1171.899894311903, -417.11937215537074, -904.5082722017554, -206.03181921301936, -140.39147051968757, -542.5121367045066, -160.57199085733959, -75.0682733631984, -507.08242352984905, -1169.5743467629045, -475.66083890345277, -433.48585874575696, -718.1886810949796, -643.7595797083645, -193.7360408062952, -743.656646695521, -958.4830009985325, -456.3030463783007, -143.2330495623396, -1161.8875961982885, -596.1939276238602, -1229.4060931833903, -560.7108271155579, -95.96834585503638, -31.316798475731307, -51.14374754558361, -793.5199811506031, -112.74635824391471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5592857706392654, "mean_inference_ms": 1.758608195546647, "mean_action_processing_ms": 0.27779061307659825, "mean_env_wait_ms": 3.6919484838145227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012346982955932617, "StateBufferConnector_ms": 0.007989168167114258, "ViewRequirementAgentConnector_ms": 0.20164799690246582}, "num_episodes": 34, "episode_return_max": -26.655878914105585, "episode_return_min": -1507.8833741166502, "episode_return_mean": -722.1930821123054, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.2090046388134, "num_env_steps_trained_throughput_per_sec": 302.2090046388134, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12723.751, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12723.681, "sample_time_ms": 1192.649, "learn_time_ms": 11463.923, "learn_throughput": 348.921, "synch_weights_time_ms": 66.235}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00016", "date": "2024-08-04_06-58-41", "timestamp": 1722734921, "time_this_iter_s": 13.248839855194092, "time_total_s": 127.35727047920227, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.35727047920227, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.378947368421052, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.826029004342853, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.30613775451978, "policy_loss": -0.014501707969854276, "vf_loss": 9.316811431447665, "vf_explained_var": 0.31358349695801735, "kl": 0.01733703729347932, "entropy": 1.3730586024622122, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -31.316798475731307, "episode_reward_min": -1510.0240901554705, "episode_reward_mean": -717.319435500853, "episode_len_mean": 130.68, "episode_media": {}, "episodes_timesteps_total": 13068, "policy_reward_min": {"policy_0": -1510.0240901554705}, "policy_reward_max": {"policy_0": -31.316798475731307}, "policy_reward_mean": {"policy_0": -717.319435500853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-468.20044866187084, -1295.2125332003834, -735.3493314054153, -1044.0137662715522, -995.2679269885242, -965.8913496866724, -932.2009254511619, -1120.0084144682035, -775.8523125468271, -118.41558475776327, -431.17503795255845, -290.1151949741883, -973.4541380030138, -1047.6901810046913, -880.10901640337, -1437.0709481150925, -1042.6358756838385, -650.5466818598894, -590.5309035677656, -595.3878386040801, -217.8150980811126, -1383.9485180526328, -783.2976850798043, -995.6773743366699, -1189.9983665856353, -1085.296532192051, -652.3131520476079, -676.8512629947089, -652.9405513498165, -1507.8833741166502, -695.934351199741, -749.4348942407927, -518.789606546143, -546.9058892876636, -1153.421382459572, -730.7199472103084, -754.2625384954255, -1100.802886290643, -441.99463172678804, -594.3881983145686, -437.5611374067077, -1171.899894311903, -417.11937215537074, -904.5082722017554, -206.03181921301936, -140.39147051968757, -542.5121367045066, -160.57199085733959, -75.0682733631984, -507.08242352984905, -1169.5743467629045, -475.66083890345277, -433.48585874575696, -718.1886810949796, -643.7595797083645, -193.7360408062952, -743.656646695521, -958.4830009985325, -456.3030463783007, -143.2330495623396, -1161.8875961982885, -596.1939276238602, -1229.4060931833903, -560.7108271155579, -95.96834585503638, -31.316798475731307, -51.14374754558361, -793.5199811506031, -112.74635824391471, -962.558803191197, -746.1820706654732, -1103.938496680122, -429.37365494771825, -537.9407052226729, -71.93044186004883, -657.5142905926078, -904.612615194516, -1510.0240901554705, -829.492621473871, -1299.1885712032538, -423.07725085954746, -833.2263327097982, -88.91828696054326, -1472.1866053366143, -1335.9234828890837, -1176.129074513732, -209.29005130971092, -342.7991190019685, -682.891236780889, -830.7439240461933, -559.4725750635628, -696.2865658775717, -671.814755124844, -147.023450281334, -1177.032515371389, -559.003900228162, -132.96414567416994, -1419.2568431550903, -912.0759447997253, -1055.5449233874842], "episode_lengths": [124, 150, 150, 150, 150, 150, 150, 150, 144, 81, 93, 111, 150, 150, 150, 150, 150, 131, 150, 150, 92, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 102, 150, 73, 66, 122, 65, 64, 150, 150, 150, 114, 150, 150, 61, 150, 150, 150, 65, 150, 150, 150, 112, 65, 46, 57, 150, 47, 150, 150, 150, 150, 150, 59, 125, 150, 150, 133, 150, 95, 150, 66, 150, 150, 150, 78, 104, 150, 144, 150, 150, 150, 72, 150, 150, 66, 150, 150, 150], "policy_policy_0_reward": [-468.20044866187084, -1295.2125332003834, -735.3493314054153, -1044.0137662715522, -995.2679269885242, -965.8913496866724, -932.2009254511619, -1120.0084144682035, -775.8523125468271, -118.41558475776327, -431.17503795255845, -290.1151949741883, -973.4541380030138, -1047.6901810046913, -880.10901640337, -1437.0709481150925, -1042.6358756838385, -650.5466818598894, -590.5309035677656, -595.3878386040801, -217.8150980811126, -1383.9485180526328, -783.2976850798043, -995.6773743366699, -1189.9983665856353, -1085.296532192051, -652.3131520476079, -676.8512629947089, -652.9405513498165, -1507.8833741166502, -695.934351199741, -749.4348942407927, -518.789606546143, -546.9058892876636, -1153.421382459572, -730.7199472103084, -754.2625384954255, -1100.802886290643, -441.99463172678804, -594.3881983145686, -437.5611374067077, -1171.899894311903, -417.11937215537074, -904.5082722017554, -206.03181921301936, -140.39147051968757, -542.5121367045066, -160.57199085733959, -75.0682733631984, -507.08242352984905, -1169.5743467629045, -475.66083890345277, -433.48585874575696, -718.1886810949796, -643.7595797083645, -193.7360408062952, -743.656646695521, -958.4830009985325, -456.3030463783007, -143.2330495623396, -1161.8875961982885, -596.1939276238602, -1229.4060931833903, -560.7108271155579, -95.96834585503638, -31.316798475731307, -51.14374754558361, -793.5199811506031, -112.74635824391471, -962.558803191197, -746.1820706654732, -1103.938496680122, -429.37365494771825, -537.9407052226729, -71.93044186004883, -657.5142905926078, -904.612615194516, -1510.0240901554705, -829.492621473871, -1299.1885712032538, -423.07725085954746, -833.2263327097982, -88.91828696054326, -1472.1866053366143, -1335.9234828890837, -1176.129074513732, -209.29005130971092, -342.7991190019685, -682.891236780889, -830.7439240461933, -559.4725750635628, -696.2865658775717, -671.814755124844, -147.023450281334, -1177.032515371389, -559.003900228162, -132.96414567416994, -1419.2568431550903, -912.0759447997253, -1055.5449233874842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590800523235326, "mean_inference_ms": 1.7585984574468663, "mean_action_processing_ms": 0.2778104289838538, "mean_env_wait_ms": 3.667731095446227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012308835983276367, "StateBufferConnector_ms": 0.007884740829467773, "ViewRequirementAgentConnector_ms": 0.1997525691986084}, "num_episodes": 31, "episode_return_max": -31.316798475731307, "episode_return_min": -1510.0240901554705, "episode_return_mean": -717.319435500853, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.5420675736206, "num_env_steps_trained_throughput_per_sec": 323.5420675736206, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12679.037, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12678.968, "sample_time_ms": 1200.479, "learn_time_ms": 11410.292, "learn_throughput": 350.561, "synch_weights_time_ms": 67.318}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00016", "date": "2024-08-04_06-58-54", "timestamp": 1722734934, "time_this_iter_s": 12.375542879104614, "time_total_s": 139.73281335830688, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1719caf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.73281335830688, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.061111111111114, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.980543903633952, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.415220981836319, "policy_loss": -0.009652619482464313, "vf_loss": 9.42163244287173, "vf_explained_var": 0.372865622676909, "kl": 0.015384212178044738, "entropy": 1.3741167522966862, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -31.316798475731307, "episode_reward_min": -1510.0240901554705, "episode_reward_mean": -682.1223956775127, "episode_len_mean": 127.38, "episode_media": {}, "episodes_timesteps_total": 12738, "policy_reward_min": {"policy_0": -1510.0240901554705}, "policy_reward_max": {"policy_0": -31.316798475731307}, "policy_reward_mean": {"policy_0": -682.1223956775127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-652.9405513498165, -1507.8833741166502, -695.934351199741, -749.4348942407927, -518.789606546143, -546.9058892876636, -1153.421382459572, -730.7199472103084, -754.2625384954255, -1100.802886290643, -441.99463172678804, -594.3881983145686, -437.5611374067077, -1171.899894311903, -417.11937215537074, -904.5082722017554, -206.03181921301936, -140.39147051968757, -542.5121367045066, -160.57199085733959, -75.0682733631984, -507.08242352984905, -1169.5743467629045, -475.66083890345277, -433.48585874575696, -718.1886810949796, -643.7595797083645, -193.7360408062952, -743.656646695521, -958.4830009985325, -456.3030463783007, -143.2330495623396, -1161.8875961982885, -596.1939276238602, -1229.4060931833903, -560.7108271155579, -95.96834585503638, -31.316798475731307, -51.14374754558361, -793.5199811506031, -112.74635824391471, -962.558803191197, -746.1820706654732, -1103.938496680122, -429.37365494771825, -537.9407052226729, -71.93044186004883, -657.5142905926078, -904.612615194516, -1510.0240901554705, -829.492621473871, -1299.1885712032538, -423.07725085954746, -833.2263327097982, -88.91828696054326, -1472.1866053366143, -1335.9234828890837, -1176.129074513732, -209.29005130971092, -342.7991190019685, -682.891236780889, -830.7439240461933, -559.4725750635628, -696.2865658775717, -671.814755124844, -147.023450281334, -1177.032515371389, -559.003900228162, -132.96414567416994, -1419.2568431550903, -912.0759447997253, -1055.5449233874842, -1099.9791777071343, -864.6160917171738, -1051.980975864137, -256.13306379682734, -306.4280191536258, -1081.1871678991079, -1145.8550312896307, -1110.955251851589, -510.9396263866011, -613.3404787820901, -87.23788426394579, -916.1540686373573, -1110.2905787941463, -773.1607861975651, -442.3907433682398, -746.8144684365819, -228.67850347867974, -1134.3996729973076, -134.03052504668875, -233.8615962403445, -937.24513417079, -791.2157253045287, -520.0667619771183, -945.6040579627071, -463.719685507019, -852.8302909548277, -830.6111083012008, -664.8959405560743], "episode_lengths": [150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 102, 150, 73, 66, 122, 65, 64, 150, 150, 150, 114, 150, 150, 61, 150, 150, 150, 65, 150, 150, 150, 112, 65, 46, 57, 150, 47, 150, 150, 150, 150, 150, 59, 125, 150, 150, 133, 150, 95, 150, 66, 150, 150, 150, 78, 104, 150, 144, 150, 150, 150, 72, 150, 150, 66, 150, 150, 150, 150, 150, 150, 80, 85, 150, 150, 150, 105, 150, 63, 150, 150, 150, 106, 150, 84, 150, 74, 77, 150, 150, 114, 150, 98, 150, 150, 150], "policy_policy_0_reward": [-652.9405513498165, -1507.8833741166502, -695.934351199741, -749.4348942407927, -518.789606546143, -546.9058892876636, -1153.421382459572, -730.7199472103084, -754.2625384954255, -1100.802886290643, -441.99463172678804, -594.3881983145686, -437.5611374067077, -1171.899894311903, -417.11937215537074, -904.5082722017554, -206.03181921301936, -140.39147051968757, -542.5121367045066, -160.57199085733959, -75.0682733631984, -507.08242352984905, -1169.5743467629045, -475.66083890345277, -433.48585874575696, -718.1886810949796, -643.7595797083645, -193.7360408062952, -743.656646695521, -958.4830009985325, -456.3030463783007, -143.2330495623396, -1161.8875961982885, -596.1939276238602, -1229.4060931833903, -560.7108271155579, -95.96834585503638, -31.316798475731307, -51.14374754558361, -793.5199811506031, -112.74635824391471, -962.558803191197, -746.1820706654732, -1103.938496680122, -429.37365494771825, -537.9407052226729, -71.93044186004883, -657.5142905926078, -904.612615194516, -1510.0240901554705, -829.492621473871, -1299.1885712032538, -423.07725085954746, -833.2263327097982, -88.91828696054326, -1472.1866053366143, -1335.9234828890837, -1176.129074513732, -209.29005130971092, -342.7991190019685, -682.891236780889, -830.7439240461933, -559.4725750635628, -696.2865658775717, -671.814755124844, -147.023450281334, -1177.032515371389, -559.003900228162, -132.96414567416994, -1419.2568431550903, -912.0759447997253, -1055.5449233874842, -1099.9791777071343, -864.6160917171738, -1051.980975864137, -256.13306379682734, -306.4280191536258, -1081.1871678991079, -1145.8550312896307, -1110.955251851589, -510.9396263866011, -613.3404787820901, -87.23788426394579, -916.1540686373573, -1110.2905787941463, -773.1607861975651, -442.3907433682398, -746.8144684365819, -228.67850347867974, -1134.3996729973076, -134.03052504668875, -233.8615962403445, -937.24513417079, -791.2157253045287, -520.0667619771183, -945.6040579627071, -463.719685507019, -852.8302909548277, -830.6111083012008, -664.8959405560743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594191260986809, "mean_inference_ms": 1.7518069654814652, "mean_action_processing_ms": 0.27806555768420926, "mean_env_wait_ms": 3.6578878523858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012071371078491211, "StateBufferConnector_ms": 0.007785797119140625, "ViewRequirementAgentConnector_ms": 0.19895124435424805}, "num_episodes": 28, "episode_return_max": -31.316798475731307, "episode_return_min": -1510.0240901554705, "episode_return_mean": -682.1223956775127, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.54832715598593, "num_env_steps_trained_throughput_per_sec": 331.54832715598593, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12586.731, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12586.66, "sample_time_ms": 1202.9, "learn_time_ms": 11315.39, "learn_throughput": 353.501, "synch_weights_time_ms": 67.488}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00016", "date": "2024-08-04_06-59-06", "timestamp": 1722734946, "time_this_iter_s": 12.076208353042603, "time_total_s": 151.8090217113495, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 151.8090217113495, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.2764705882353, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.12423389752706, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.802939556539059, "policy_loss": -0.014078636843866359, "vf_loss": 8.812645111481348, "vf_explained_var": 0.4674505954608321, "kl": 0.018789683807426627, "entropy": 1.2638441440959771, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -30.99141579334229, "episode_reward_min": -1510.0240901554705, "episode_reward_mean": -695.3492292514779, "episode_len_mean": 128.49, "episode_media": {}, "episodes_timesteps_total": 12849, "policy_reward_min": {"policy_0": -1510.0240901554705}, "policy_reward_max": {"policy_0": -30.99141579334229}, "policy_reward_mean": {"policy_0": -695.3492292514779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1161.8875961982885, -596.1939276238602, -1229.4060931833903, -560.7108271155579, -95.96834585503638, -31.316798475731307, -51.14374754558361, -793.5199811506031, -112.74635824391471, -962.558803191197, -746.1820706654732, -1103.938496680122, -429.37365494771825, -537.9407052226729, -71.93044186004883, -657.5142905926078, -904.612615194516, -1510.0240901554705, -829.492621473871, -1299.1885712032538, -423.07725085954746, -833.2263327097982, -88.91828696054326, -1472.1866053366143, -1335.9234828890837, -1176.129074513732, -209.29005130971092, -342.7991190019685, -682.891236780889, -830.7439240461933, -559.4725750635628, -696.2865658775717, -671.814755124844, -147.023450281334, -1177.032515371389, -559.003900228162, -132.96414567416994, -1419.2568431550903, -912.0759447997253, -1055.5449233874842, -1099.9791777071343, -864.6160917171738, -1051.980975864137, -256.13306379682734, -306.4280191536258, -1081.1871678991079, -1145.8550312896307, -1110.955251851589, -510.9396263866011, -613.3404787820901, -87.23788426394579, -916.1540686373573, -1110.2905787941463, -773.1607861975651, -442.3907433682398, -746.8144684365819, -228.67850347867974, -1134.3996729973076, -134.03052504668875, -233.8615962403445, -937.24513417079, -791.2157253045287, -520.0667619771183, -945.6040579627071, -463.719685507019, -852.8302909548277, -830.6111083012008, -664.8959405560743, -759.9295397787855, -72.57419213067931, -1181.6656345429328, -618.7074296666816, -1033.7290743238718, -1047.8007059545157, -82.64809816715152, -638.1398959726795, -1081.4290267246067, -960.5000612706018, -76.6056252647781, -285.09190410368257, -670.0187162527968, -442.40595232145165, -577.2702976145376, -445.76467736259065, -995.691805384245, -1233.9714206943243, -1394.7346871861073, -892.4407790721069, -531.1526020587274, -379.60698593611625, -551.2692988238653, -520.1564652474765, -82.63229752443401, -1019.1109436074054, -30.99141579334229, -495.14915187352995, -854.0163277765438, -882.3863072163958, -874.3373012446907, -557.0608676627771], "episode_lengths": [150, 150, 150, 112, 65, 46, 57, 150, 47, 150, 150, 150, 150, 150, 59, 125, 150, 150, 133, 150, 95, 150, 66, 150, 150, 150, 78, 104, 150, 144, 150, 150, 150, 72, 150, 150, 66, 150, 150, 150, 150, 150, 150, 80, 85, 150, 150, 150, 105, 150, 63, 150, 150, 150, 106, 150, 84, 150, 74, 77, 150, 150, 114, 150, 98, 150, 150, 150, 150, 64, 150, 134, 150, 150, 73, 150, 150, 150, 64, 96, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 46, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1161.8875961982885, -596.1939276238602, -1229.4060931833903, -560.7108271155579, -95.96834585503638, -31.316798475731307, -51.14374754558361, -793.5199811506031, -112.74635824391471, -962.558803191197, -746.1820706654732, -1103.938496680122, -429.37365494771825, -537.9407052226729, -71.93044186004883, -657.5142905926078, -904.612615194516, -1510.0240901554705, -829.492621473871, -1299.1885712032538, -423.07725085954746, -833.2263327097982, -88.91828696054326, -1472.1866053366143, -1335.9234828890837, -1176.129074513732, -209.29005130971092, -342.7991190019685, -682.891236780889, -830.7439240461933, -559.4725750635628, -696.2865658775717, -671.814755124844, -147.023450281334, -1177.032515371389, -559.003900228162, -132.96414567416994, -1419.2568431550903, -912.0759447997253, -1055.5449233874842, -1099.9791777071343, -864.6160917171738, -1051.980975864137, -256.13306379682734, -306.4280191536258, -1081.1871678991079, -1145.8550312896307, -1110.955251851589, -510.9396263866011, -613.3404787820901, -87.23788426394579, -916.1540686373573, -1110.2905787941463, -773.1607861975651, -442.3907433682398, -746.8144684365819, -228.67850347867974, -1134.3996729973076, -134.03052504668875, -233.8615962403445, -937.24513417079, -791.2157253045287, -520.0667619771183, -945.6040579627071, -463.719685507019, -852.8302909548277, -830.6111083012008, -664.8959405560743, -759.9295397787855, -72.57419213067931, -1181.6656345429328, -618.7074296666816, -1033.7290743238718, -1047.8007059545157, -82.64809816715152, -638.1398959726795, -1081.4290267246067, -960.5000612706018, -76.6056252647781, -285.09190410368257, -670.0187162527968, -442.40595232145165, -577.2702976145376, -445.76467736259065, -995.691805384245, -1233.9714206943243, -1394.7346871861073, -892.4407790721069, -531.1526020587274, -379.60698593611625, -551.2692988238653, -520.1564652474765, -82.63229752443401, -1019.1109436074054, -30.99141579334229, -495.14915187352995, -854.0163277765438, -882.3863072163958, -874.3373012446907, -557.0608676627771]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587610053373652, "mean_inference_ms": 1.7462651234132371, "mean_action_processing_ms": 0.27828189020911454, "mean_env_wait_ms": 3.6460553684503645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011938333511352539, "StateBufferConnector_ms": 0.007919073104858398, "ViewRequirementAgentConnector_ms": 0.18995213508605957}, "num_episodes": 32, "episode_return_max": -30.99141579334229, "episode_return_min": -1510.0240901554705, "episode_return_mean": -695.3492292514779, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.1764895945954, "num_env_steps_trained_throughput_per_sec": 306.1764895945954, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12794.361, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12794.291, "sample_time_ms": 1207.617, "learn_time_ms": 11516.787, "learn_throughput": 347.319, "synch_weights_time_ms": 69.0}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00016", "date": "2024-08-04_06-59-19", "timestamp": 1722734959, "time_this_iter_s": 13.075822114944458, "time_total_s": 164.88484382629395, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.88484382629395, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.744444444444447, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.258369682729244, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.91247498691082, "policy_loss": -0.010257015289971605, "vf_loss": 8.919380611181259, "vf_explained_var": 0.38904543202370406, "kl": 0.015284587495686234, "entropy": 1.2340062965949377, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -9.988210837960782, "episode_reward_min": -1464.542388331706, "episode_reward_mean": -679.1569631846119, "episode_len_mean": 129.06, "episode_media": {}, "episodes_timesteps_total": 12906, "policy_reward_min": {"policy_0": -1464.542388331706}, "policy_reward_max": {"policy_0": -9.988210837960782}, "policy_reward_mean": {"policy_0": -679.1569631846119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559.003900228162, -132.96414567416994, -1419.2568431550903, -912.0759447997253, -1055.5449233874842, -1099.9791777071343, -864.6160917171738, -1051.980975864137, -256.13306379682734, -306.4280191536258, -1081.1871678991079, -1145.8550312896307, -1110.955251851589, -510.9396263866011, -613.3404787820901, -87.23788426394579, -916.1540686373573, -1110.2905787941463, -773.1607861975651, -442.3907433682398, -746.8144684365819, -228.67850347867974, -1134.3996729973076, -134.03052504668875, -233.8615962403445, -937.24513417079, -791.2157253045287, -520.0667619771183, -945.6040579627071, -463.719685507019, -852.8302909548277, -830.6111083012008, -664.8959405560743, -759.9295397787855, -72.57419213067931, -1181.6656345429328, -618.7074296666816, -1033.7290743238718, -1047.8007059545157, -82.64809816715152, -638.1398959726795, -1081.4290267246067, -960.5000612706018, -76.6056252647781, -285.09190410368257, -670.0187162527968, -442.40595232145165, -577.2702976145376, -445.76467736259065, -995.691805384245, -1233.9714206943243, -1394.7346871861073, -892.4407790721069, -531.1526020587274, -379.60698593611625, -551.2692988238653, -520.1564652474765, -82.63229752443401, -1019.1109436074054, -30.99141579334229, -495.14915187352995, -854.0163277765438, -882.3863072163958, -874.3373012446907, -557.0608676627771, -444.10947991664835, -578.9993366866573, -887.7379837181785, -530.2322781091484, -1464.542388331706, -1093.7192696275768, -1185.5101669294909, -538.6739816506288, -136.62159511535302, -940.3516941612759, -82.27834740905051, -334.0905817617834, -859.7180107141188, -156.02499069030358, -453.7846996606863, -109.9127983940815, -485.74085718226917, -1056.941337257344, -689.6185837559855, -582.216622479215, -1400.0286246024573, -1181.8532721219033, -285.9392894377588, -845.7548749981578, -596.2763292196838, -723.4325278701307, -9.988210837960782, -761.4922680519112, -310.47541369864155, -866.13549122418, -623.5162365621042, -1307.7871344961693, -202.32258699589224, -637.3426144522709, -350.0687778983624], "episode_lengths": [150, 66, 150, 150, 150, 150, 150, 150, 80, 85, 150, 150, 150, 105, 150, 63, 150, 150, 150, 106, 150, 84, 150, 74, 77, 150, 150, 114, 150, 98, 150, 150, 150, 150, 64, 150, 134, 150, 150, 73, 150, 150, 150, 64, 96, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 62, 141, 47, 150, 150, 60, 150, 53, 102, 150, 150, 150, 150, 150, 91, 150, 150, 150, 38, 140, 94, 150, 150, 150, 77, 150, 94], "policy_policy_0_reward": [-559.003900228162, -132.96414567416994, -1419.2568431550903, -912.0759447997253, -1055.5449233874842, -1099.9791777071343, -864.6160917171738, -1051.980975864137, -256.13306379682734, -306.4280191536258, -1081.1871678991079, -1145.8550312896307, -1110.955251851589, -510.9396263866011, -613.3404787820901, -87.23788426394579, -916.1540686373573, -1110.2905787941463, -773.1607861975651, -442.3907433682398, -746.8144684365819, -228.67850347867974, -1134.3996729973076, -134.03052504668875, -233.8615962403445, -937.24513417079, -791.2157253045287, -520.0667619771183, -945.6040579627071, -463.719685507019, -852.8302909548277, -830.6111083012008, -664.8959405560743, -759.9295397787855, -72.57419213067931, -1181.6656345429328, -618.7074296666816, -1033.7290743238718, -1047.8007059545157, -82.64809816715152, -638.1398959726795, -1081.4290267246067, -960.5000612706018, -76.6056252647781, -285.09190410368257, -670.0187162527968, -442.40595232145165, -577.2702976145376, -445.76467736259065, -995.691805384245, -1233.9714206943243, -1394.7346871861073, -892.4407790721069, -531.1526020587274, -379.60698593611625, -551.2692988238653, -520.1564652474765, -82.63229752443401, -1019.1109436074054, -30.99141579334229, -495.14915187352995, -854.0163277765438, -882.3863072163958, -874.3373012446907, -557.0608676627771, -444.10947991664835, -578.9993366866573, -887.7379837181785, -530.2322781091484, -1464.542388331706, -1093.7192696275768, -1185.5101669294909, -538.6739816506288, -136.62159511535302, -940.3516941612759, -82.27834740905051, -334.0905817617834, -859.7180107141188, -156.02499069030358, -453.7846996606863, -109.9127983940815, -485.74085718226917, -1056.941337257344, -689.6185837559855, -582.216622479215, -1400.0286246024573, -1181.8532721219033, -285.9392894377588, -845.7548749981578, -596.2763292196838, -723.4325278701307, -9.988210837960782, -761.4922680519112, -310.47541369864155, -866.13549122418, -623.5162365621042, -1307.7871344961693, -202.32258699589224, -637.3426144522709, -350.0687778983624]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.558701935241252, "mean_inference_ms": 1.7422228026128885, "mean_action_processing_ms": 0.27842559524280064, "mean_env_wait_ms": 3.631397601025666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011991262435913086, "StateBufferConnector_ms": 0.008199214935302734, "ViewRequirementAgentConnector_ms": 0.19385242462158203}, "num_episodes": 35, "episode_return_max": -9.988210837960782, "episode_return_min": -1464.542388331706, "episode_return_mean": -679.1569631846119, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6288646152539, "num_env_steps_trained_throughput_per_sec": 308.6288646152539, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12743.924, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12743.853, "sample_time_ms": 1151.179, "learn_time_ms": 11523.465, "learn_throughput": 347.118, "synch_weights_time_ms": 68.321}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00016", "date": "2024-08-04_06-59-32", "timestamp": 1722734972, "time_this_iter_s": 12.972060918807983, "time_total_s": 177.85690474510193, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923707251b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.85690474510193, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.421052631578945, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.393982967485984, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.528550485273202, "policy_loss": -0.013048672446166166, "vf_loss": 8.537261322140694, "vf_explained_var": 0.4923812963689367, "kl": 0.018806008425569114, "entropy": 1.303992510214448, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -9.988210837960782, "episode_reward_min": -1464.542388331706, "episode_reward_mean": -616.6066151359355, "episode_len_mean": 122.83, "episode_media": {}, "episodes_timesteps_total": 12283, "policy_reward_min": {"policy_0": -1464.542388331706}, "policy_reward_max": {"policy_0": -9.988210837960782}, "policy_reward_mean": {"policy_0": -616.6066151359355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-759.9295397787855, -72.57419213067931, -1181.6656345429328, -618.7074296666816, -1033.7290743238718, -1047.8007059545157, -82.64809816715152, -638.1398959726795, -1081.4290267246067, -960.5000612706018, -76.6056252647781, -285.09190410368257, -670.0187162527968, -442.40595232145165, -577.2702976145376, -445.76467736259065, -995.691805384245, -1233.9714206943243, -1394.7346871861073, -892.4407790721069, -531.1526020587274, -379.60698593611625, -551.2692988238653, -520.1564652474765, -82.63229752443401, -1019.1109436074054, -30.99141579334229, -495.14915187352995, -854.0163277765438, -882.3863072163958, -874.3373012446907, -557.0608676627771, -444.10947991664835, -578.9993366866573, -887.7379837181785, -530.2322781091484, -1464.542388331706, -1093.7192696275768, -1185.5101669294909, -538.6739816506288, -136.62159511535302, -940.3516941612759, -82.27834740905051, -334.0905817617834, -859.7180107141188, -156.02499069030358, -453.7846996606863, -109.9127983940815, -485.74085718226917, -1056.941337257344, -689.6185837559855, -582.216622479215, -1400.0286246024573, -1181.8532721219033, -285.9392894377588, -845.7548749981578, -596.2763292196838, -723.4325278701307, -9.988210837960782, -761.4922680519112, -310.47541369864155, -866.13549122418, -623.5162365621042, -1307.7871344961693, -202.32258699589224, -637.3426144522709, -350.0687778983624, -563.7158132658226, -143.35674441585223, -1250.9015578534634, -728.3396515621473, -77.63827608001552, -29.085193321643686, -46.69162990700445, -58.945136049468076, -934.5928151696311, -707.9790338561169, -775.6447260044149, -27.5992648696645, -448.0756247894033, -639.787437604988, -326.8892888804979, -268.8718911906711, -72.59810511560951, -702.4454507717743, -796.9688160274528, -948.2751702460356, -515.5444486475421, -1214.5770334897197, -453.0251652101174, -1272.148100563821, -539.9593301012015, -28.411444921730716, -1439.8054044082983, -239.59361281333292, -668.2313340958419, -34.10291544563546, -570.7305986771266, -1124.9110998477738, -28.991253816216528], "episode_lengths": [150, 64, 150, 134, 150, 150, 73, 150, 150, 150, 64, 96, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 62, 141, 47, 150, 150, 60, 150, 53, 102, 150, 150, 150, 150, 150, 91, 150, 150, 150, 38, 140, 94, 150, 150, 150, 77, 150, 94, 150, 62, 150, 138, 61, 41, 55, 63, 150, 150, 150, 39, 101, 131, 83, 85, 61, 139, 150, 150, 143, 150, 150, 150, 150, 37, 150, 77, 150, 44, 122, 150, 47], "policy_policy_0_reward": [-759.9295397787855, -72.57419213067931, -1181.6656345429328, -618.7074296666816, -1033.7290743238718, -1047.8007059545157, -82.64809816715152, -638.1398959726795, -1081.4290267246067, -960.5000612706018, -76.6056252647781, -285.09190410368257, -670.0187162527968, -442.40595232145165, -577.2702976145376, -445.76467736259065, -995.691805384245, -1233.9714206943243, -1394.7346871861073, -892.4407790721069, -531.1526020587274, -379.60698593611625, -551.2692988238653, -520.1564652474765, -82.63229752443401, -1019.1109436074054, -30.99141579334229, -495.14915187352995, -854.0163277765438, -882.3863072163958, -874.3373012446907, -557.0608676627771, -444.10947991664835, -578.9993366866573, -887.7379837181785, -530.2322781091484, -1464.542388331706, -1093.7192696275768, -1185.5101669294909, -538.6739816506288, -136.62159511535302, -940.3516941612759, -82.27834740905051, -334.0905817617834, -859.7180107141188, -156.02499069030358, -453.7846996606863, -109.9127983940815, -485.74085718226917, -1056.941337257344, -689.6185837559855, -582.216622479215, -1400.0286246024573, -1181.8532721219033, -285.9392894377588, -845.7548749981578, -596.2763292196838, -723.4325278701307, -9.988210837960782, -761.4922680519112, -310.47541369864155, -866.13549122418, -623.5162365621042, -1307.7871344961693, -202.32258699589224, -637.3426144522709, -350.0687778983624, -563.7158132658226, -143.35674441585223, -1250.9015578534634, -728.3396515621473, -77.63827608001552, -29.085193321643686, -46.69162990700445, -58.945136049468076, -934.5928151696311, -707.9790338561169, -775.6447260044149, -27.5992648696645, -448.0756247894033, -639.787437604988, -326.8892888804979, -268.8718911906711, -72.59810511560951, -702.4454507717743, -796.9688160274528, -948.2751702460356, -515.5444486475421, -1214.5770334897197, -453.0251652101174, -1272.148100563821, -539.9593301012015, -28.411444921730716, -1439.8054044082983, -239.59361281333292, -668.2313340958419, -34.10291544563546, -570.7305986771266, -1124.9110998477738, -28.991253816216528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581097143866232, "mean_inference_ms": 1.7380430322155982, "mean_action_processing_ms": 0.2782048606597273, "mean_env_wait_ms": 3.6165561283092615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01195979118347168, "StateBufferConnector_ms": 0.008188247680664062, "ViewRequirementAgentConnector_ms": 0.19280219078063965}, "num_episodes": 33, "episode_return_max": -9.988210837960782, "episode_return_min": -1464.542388331706, "episode_return_mean": -616.6066151359355, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.6948875221904, "num_env_steps_trained_throughput_per_sec": 306.6948875221904, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12747.822, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12747.754, "sample_time_ms": 1150.845, "learn_time_ms": 11526.556, "learn_throughput": 347.025, "synch_weights_time_ms": 69.457}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00016", "date": "2024-08-04_06-59-45", "timestamp": 1722734985, "time_this_iter_s": 13.055715322494507, "time_total_s": 190.91262006759644, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 190.91262006759644, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.788888888888888, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.690113618845741, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.763694815834363, "policy_loss": -0.016487664784654042, "vf_loss": 8.775904673337937, "vf_explained_var": 0.5020989689355095, "kl": 0.018957046414288924, "entropy": 1.4092693862815697, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -9.988210837960782, "episode_reward_min": -1464.542388331706, "episode_reward_mean": -621.9283624899285, "episode_len_mean": 119.67, "episode_media": {}, "episodes_timesteps_total": 11967, "policy_reward_min": {"policy_0": -1464.542388331706}, "policy_reward_max": {"policy_0": -9.988210837960782}, "policy_reward_mean": {"policy_0": -621.9283624899285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-444.10947991664835, -578.9993366866573, -887.7379837181785, -530.2322781091484, -1464.542388331706, -1093.7192696275768, -1185.5101669294909, -538.6739816506288, -136.62159511535302, -940.3516941612759, -82.27834740905051, -334.0905817617834, -859.7180107141188, -156.02499069030358, -453.7846996606863, -109.9127983940815, -485.74085718226917, -1056.941337257344, -689.6185837559855, -582.216622479215, -1400.0286246024573, -1181.8532721219033, -285.9392894377588, -845.7548749981578, -596.2763292196838, -723.4325278701307, -9.988210837960782, -761.4922680519112, -310.47541369864155, -866.13549122418, -623.5162365621042, -1307.7871344961693, -202.32258699589224, -637.3426144522709, -350.0687778983624, -563.7158132658226, -143.35674441585223, -1250.9015578534634, -728.3396515621473, -77.63827608001552, -29.085193321643686, -46.69162990700445, -58.945136049468076, -934.5928151696311, -707.9790338561169, -775.6447260044149, -27.5992648696645, -448.0756247894033, -639.787437604988, -326.8892888804979, -268.8718911906711, -72.59810511560951, -702.4454507717743, -796.9688160274528, -948.2751702460356, -515.5444486475421, -1214.5770334897197, -453.0251652101174, -1272.148100563821, -539.9593301012015, -28.411444921730716, -1439.8054044082983, -239.59361281333292, -668.2313340958419, -34.10291544563546, -570.7305986771266, -1124.9110998477738, -28.991253816216528, -631.8422710091127, -1127.9792871201228, -960.5063317862362, -1108.823172736209, -69.26412004875452, -958.3341143341918, -351.5229370868385, -1148.5303558521452, -638.9709786699087, -801.6560287424508, -471.36188170529954, -382.81986505126747, -135.96666783725462, -840.5001955492088, -430.45398051592446, -1173.896977271038, -53.489592912525076, -892.0633410767331, -1009.8440769633971, -223.22374213631156, -833.6596463587221, -710.22296465117, -1252.7229113718995, -230.79967049283349, -946.9755120670089, -1248.8218191590604, -43.09843761948931, -838.4269527310395, -986.6656186781178, -1153.726601610992, -21.181991810959413, -123.81217899750668], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 111, 62, 141, 47, 150, 150, 60, 150, 53, 102, 150, 150, 150, 150, 150, 91, 150, 150, 150, 38, 140, 94, 150, 150, 150, 77, 150, 94, 150, 62, 150, 138, 61, 41, 55, 63, 150, 150, 150, 39, 101, 131, 83, 85, 61, 139, 150, 150, 143, 150, 150, 150, 150, 37, 150, 77, 150, 44, 122, 150, 47, 150, 150, 150, 150, 41, 150, 111, 150, 150, 150, 150, 89, 74, 150, 95, 150, 62, 150, 150, 83, 150, 150, 150, 69, 150, 150, 48, 150, 150, 150, 39, 67], "policy_policy_0_reward": [-444.10947991664835, -578.9993366866573, -887.7379837181785, -530.2322781091484, -1464.542388331706, -1093.7192696275768, -1185.5101669294909, -538.6739816506288, -136.62159511535302, -940.3516941612759, -82.27834740905051, -334.0905817617834, -859.7180107141188, -156.02499069030358, -453.7846996606863, -109.9127983940815, -485.74085718226917, -1056.941337257344, -689.6185837559855, -582.216622479215, -1400.0286246024573, -1181.8532721219033, -285.9392894377588, -845.7548749981578, -596.2763292196838, -723.4325278701307, -9.988210837960782, -761.4922680519112, -310.47541369864155, -866.13549122418, -623.5162365621042, -1307.7871344961693, -202.32258699589224, -637.3426144522709, -350.0687778983624, -563.7158132658226, -143.35674441585223, -1250.9015578534634, -728.3396515621473, -77.63827608001552, -29.085193321643686, -46.69162990700445, -58.945136049468076, -934.5928151696311, -707.9790338561169, -775.6447260044149, -27.5992648696645, -448.0756247894033, -639.787437604988, -326.8892888804979, -268.8718911906711, -72.59810511560951, -702.4454507717743, -796.9688160274528, -948.2751702460356, -515.5444486475421, -1214.5770334897197, -453.0251652101174, -1272.148100563821, -539.9593301012015, -28.411444921730716, -1439.8054044082983, -239.59361281333292, -668.2313340958419, -34.10291544563546, -570.7305986771266, -1124.9110998477738, -28.991253816216528, -631.8422710091127, -1127.9792871201228, -960.5063317862362, -1108.823172736209, -69.26412004875452, -958.3341143341918, -351.5229370868385, -1148.5303558521452, -638.9709786699087, -801.6560287424508, -471.36188170529954, -382.81986505126747, -135.96666783725462, -840.5001955492088, -430.45398051592446, -1173.896977271038, -53.489592912525076, -892.0633410767331, -1009.8440769633971, -223.22374213631156, -833.6596463587221, -710.22296465117, -1252.7229113718995, -230.79967049283349, -946.9755120670089, -1248.8218191590604, -43.09843761948931, -838.4269527310395, -986.6656186781178, -1153.726601610992, -21.181991810959413, -123.81217899750668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577532567402799, "mean_inference_ms": 1.7311075158097535, "mean_action_processing_ms": 0.27779389146506395, "mean_env_wait_ms": 3.607071259258829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012074470520019531, "StateBufferConnector_ms": 0.008035659790039062, "ViewRequirementAgentConnector_ms": 0.20023632049560547}, "num_episodes": 32, "episode_return_max": -9.988210837960782, "episode_return_min": -1464.542388331706, "episode_return_mean": -621.9283624899285, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.91644992137213, "num_env_steps_trained_throughput_per_sec": 315.91644992137213, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12700.403, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12700.335, "sample_time_ms": 1153.741, "learn_time_ms": 11475.951, "learn_throughput": 348.555, "synch_weights_time_ms": 69.749}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00016", "date": "2024-08-04_06-59-58", "timestamp": 1722734998, "time_this_iter_s": 12.673876762390137, "time_total_s": 203.58649682998657, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 203.58649682998657, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.400000000000002, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.428040040532746, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.337961328029632, "policy_loss": -0.01048506202059798, "vf_loss": 8.344739726185798, "vf_explained_var": 0.4617663915579518, "kl": 0.01661833279349594, "entropy": 1.2788495269914468, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -21.181991810959413, "episode_reward_min": -1440.3342486791494, "episode_reward_mean": -593.4549717126907, "episode_len_mean": 116.03, "episode_media": {}, "episodes_timesteps_total": 11603, "policy_reward_min": {"policy_0": -1440.3342486791494}, "policy_reward_max": {"policy_0": -21.181991810959413}, "policy_reward_mean": {"policy_0": -593.4549717126907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-728.3396515621473, -77.63827608001552, -29.085193321643686, -46.69162990700445, -58.945136049468076, -934.5928151696311, -707.9790338561169, -775.6447260044149, -27.5992648696645, -448.0756247894033, -639.787437604988, -326.8892888804979, -268.8718911906711, -72.59810511560951, -702.4454507717743, -796.9688160274528, -948.2751702460356, -515.5444486475421, -1214.5770334897197, -453.0251652101174, -1272.148100563821, -539.9593301012015, -28.411444921730716, -1439.8054044082983, -239.59361281333292, -668.2313340958419, -34.10291544563546, -570.7305986771266, -1124.9110998477738, -28.991253816216528, -631.8422710091127, -1127.9792871201228, -960.5063317862362, -1108.823172736209, -69.26412004875452, -958.3341143341918, -351.5229370868385, -1148.5303558521452, -638.9709786699087, -801.6560287424508, -471.36188170529954, -382.81986505126747, -135.96666783725462, -840.5001955492088, -430.45398051592446, -1173.896977271038, -53.489592912525076, -892.0633410767331, -1009.8440769633971, -223.22374213631156, -833.6596463587221, -710.22296465117, -1252.7229113718995, -230.79967049283349, -946.9755120670089, -1248.8218191590604, -43.09843761948931, -838.4269527310395, -986.6656186781178, -1153.726601610992, -21.181991810959413, -123.81217899750668, -489.3808621943179, -604.7900486157289, -846.8333153049666, -367.45939837365904, -554.6277017713587, -674.1246306836905, -558.5496144499889, -193.38711621794602, -232.2383721563419, -55.683616097825336, -1109.3516602645445, -117.02004821133215, -483.36408264652465, -171.19499164834463, -583.7282970259125, -241.70244824320932, -661.0652836604296, -67.23686621763066, -721.8494411445618, -133.61289590677603, -1072.0156292443553, -1147.349715699053, -301.7442632247688, -1440.3342486791494, -840.5573389285985, -220.37018910571925, -1051.1183744005218, -1017.483435879607, -1354.2614190294532, -564.3086647199746, -186.78022773374704, -244.89790129409758, -398.28635306284446, -430.3801336412484, -521.2964817135914, -156.09277216908723, -710.5294541652551, -1298.8664003042843], "episode_lengths": [138, 61, 41, 55, 63, 150, 150, 150, 39, 101, 131, 83, 85, 61, 139, 150, 150, 143, 150, 150, 150, 150, 37, 150, 77, 150, 44, 122, 150, 47, 150, 150, 150, 150, 41, 150, 111, 150, 150, 150, 150, 89, 74, 150, 95, 150, 62, 150, 150, 83, 150, 150, 150, 69, 150, 150, 48, 150, 150, 150, 39, 67, 123, 150, 147, 98, 150, 150, 131, 65, 67, 43, 150, 57, 150, 58, 120, 68, 150, 56, 140, 53, 150, 150, 81, 150, 150, 91, 150, 150, 150, 150, 62, 85, 150, 99, 150, 64, 150, 150], "policy_policy_0_reward": [-728.3396515621473, -77.63827608001552, -29.085193321643686, -46.69162990700445, -58.945136049468076, -934.5928151696311, -707.9790338561169, -775.6447260044149, -27.5992648696645, -448.0756247894033, -639.787437604988, -326.8892888804979, -268.8718911906711, -72.59810511560951, -702.4454507717743, -796.9688160274528, -948.2751702460356, -515.5444486475421, -1214.5770334897197, -453.0251652101174, -1272.148100563821, -539.9593301012015, -28.411444921730716, -1439.8054044082983, -239.59361281333292, -668.2313340958419, -34.10291544563546, -570.7305986771266, -1124.9110998477738, -28.991253816216528, -631.8422710091127, -1127.9792871201228, -960.5063317862362, -1108.823172736209, -69.26412004875452, -958.3341143341918, -351.5229370868385, -1148.5303558521452, -638.9709786699087, -801.6560287424508, -471.36188170529954, -382.81986505126747, -135.96666783725462, -840.5001955492088, -430.45398051592446, -1173.896977271038, -53.489592912525076, -892.0633410767331, -1009.8440769633971, -223.22374213631156, -833.6596463587221, -710.22296465117, -1252.7229113718995, -230.79967049283349, -946.9755120670089, -1248.8218191590604, -43.09843761948931, -838.4269527310395, -986.6656186781178, -1153.726601610992, -21.181991810959413, -123.81217899750668, -489.3808621943179, -604.7900486157289, -846.8333153049666, -367.45939837365904, -554.6277017713587, -674.1246306836905, -558.5496144499889, -193.38711621794602, -232.2383721563419, -55.683616097825336, -1109.3516602645445, -117.02004821133215, -483.36408264652465, -171.19499164834463, -583.7282970259125, -241.70244824320932, -661.0652836604296, -67.23686621763066, -721.8494411445618, -133.61289590677603, -1072.0156292443553, -1147.349715699053, -301.7442632247688, -1440.3342486791494, -840.5573389285985, -220.37018910571925, -1051.1183744005218, -1017.483435879607, -1354.2614190294532, -564.3086647199746, -186.78022773374704, -244.89790129409758, -398.28635306284446, -430.3801336412484, -521.2964817135914, -156.09277216908723, -710.5294541652551, -1298.8664003042843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567422762885086, "mean_inference_ms": 1.7311323275304884, "mean_action_processing_ms": 0.27739209557139, "mean_env_wait_ms": 3.5977699531763734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142740249633789, "StateBufferConnector_ms": 0.007748603820800781, "ViewRequirementAgentConnector_ms": 0.19628310203552246}, "num_episodes": 38, "episode_return_max": -21.181991810959413, "episode_return_min": -1440.3342486791494, "episode_return_mean": -593.4549717126907, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0360708230196, "num_env_steps_trained_throughput_per_sec": 304.0360708230196, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12811.847, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12811.775, "sample_time_ms": 1157.238, "learn_time_ms": 11583.066, "learn_throughput": 345.332, "synch_weights_time_ms": 70.584}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00016", "date": "2024-08-04_07-00-11", "timestamp": 1722735011, "time_this_iter_s": 13.169538974761963, "time_total_s": 216.75603580474854, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370727d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.75603580474854, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.038888888888888, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.75451598043243, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.308404317994912, "policy_loss": -0.007376750775438268, "vf_loss": 8.312543357908726, "vf_explained_var": 0.4883051983391245, "kl": 0.015469325661918772, "entropy": 1.4030433939148983, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -21.181991810959413, "episode_reward_min": -1442.3547608678243, "episode_reward_mean": -637.6364898467187, "episode_len_mean": 121.79, "episode_media": {}, "episodes_timesteps_total": 12179, "policy_reward_min": {"policy_0": -1442.3547608678243}, "policy_reward_max": {"policy_0": -21.181991810959413}, "policy_reward_mean": {"policy_0": -637.6364898467187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1127.9792871201228, -960.5063317862362, -1108.823172736209, -69.26412004875452, -958.3341143341918, -351.5229370868385, -1148.5303558521452, -638.9709786699087, -801.6560287424508, -471.36188170529954, -382.81986505126747, -135.96666783725462, -840.5001955492088, -430.45398051592446, -1173.896977271038, -53.489592912525076, -892.0633410767331, -1009.8440769633971, -223.22374213631156, -833.6596463587221, -710.22296465117, -1252.7229113718995, -230.79967049283349, -946.9755120670089, -1248.8218191590604, -43.09843761948931, -838.4269527310395, -986.6656186781178, -1153.726601610992, -21.181991810959413, -123.81217899750668, -489.3808621943179, -604.7900486157289, -846.8333153049666, -367.45939837365904, -554.6277017713587, -674.1246306836905, -558.5496144499889, -193.38711621794602, -232.2383721563419, -55.683616097825336, -1109.3516602645445, -117.02004821133215, -483.36408264652465, -171.19499164834463, -583.7282970259125, -241.70244824320932, -661.0652836604296, -67.23686621763066, -721.8494411445618, -133.61289590677603, -1072.0156292443553, -1147.349715699053, -301.7442632247688, -1440.3342486791494, -840.5573389285985, -220.37018910571925, -1051.1183744005218, -1017.483435879607, -1354.2614190294532, -564.3086647199746, -186.78022773374704, -244.89790129409758, -398.28635306284446, -430.3801336412484, -521.2964817135914, -156.09277216908723, -710.5294541652551, -1298.8664003042843, -206.67319362535088, -1142.3100332543977, -637.8328227712374, -695.864709776867, -188.5773362969088, -257.5397293602986, -747.9403618257869, -476.85919425181186, -1178.5529997663727, -717.9219339816034, -695.1292028854251, -591.9291178127603, -233.86013794205502, -561.8980115064332, -846.6184853038467, -433.3412698646488, -652.2117729198751, -667.2513892841378, -1105.1739934094198, -851.1120840645111, -439.65697019999607, -74.32300726722085, -551.6674985273398, -1116.034183997467, -833.7066200729006, -796.3577294509562, -1442.3547608678243, -828.8658010489291, -1094.3875313137485, -466.8451696206478, -237.6562856260411], "episode_lengths": [150, 150, 150, 41, 150, 111, 150, 150, 150, 150, 89, 74, 150, 95, 150, 62, 150, 150, 83, 150, 150, 150, 69, 150, 150, 48, 150, 150, 150, 39, 67, 123, 150, 147, 98, 150, 150, 131, 65, 67, 43, 150, 57, 150, 58, 120, 68, 150, 56, 140, 53, 150, 150, 81, 150, 150, 91, 150, 150, 150, 150, 62, 85, 150, 99, 150, 64, 150, 150, 70, 150, 150, 150, 61, 91, 150, 150, 150, 150, 150, 150, 73, 150, 142, 93, 150, 150, 150, 150, 101, 46, 150, 150, 150, 142, 150, 150, 150, 102, 72], "policy_policy_0_reward": [-1127.9792871201228, -960.5063317862362, -1108.823172736209, -69.26412004875452, -958.3341143341918, -351.5229370868385, -1148.5303558521452, -638.9709786699087, -801.6560287424508, -471.36188170529954, -382.81986505126747, -135.96666783725462, -840.5001955492088, -430.45398051592446, -1173.896977271038, -53.489592912525076, -892.0633410767331, -1009.8440769633971, -223.22374213631156, -833.6596463587221, -710.22296465117, -1252.7229113718995, -230.79967049283349, -946.9755120670089, -1248.8218191590604, -43.09843761948931, -838.4269527310395, -986.6656186781178, -1153.726601610992, -21.181991810959413, -123.81217899750668, -489.3808621943179, -604.7900486157289, -846.8333153049666, -367.45939837365904, -554.6277017713587, -674.1246306836905, -558.5496144499889, -193.38711621794602, -232.2383721563419, -55.683616097825336, -1109.3516602645445, -117.02004821133215, -483.36408264652465, -171.19499164834463, -583.7282970259125, -241.70244824320932, -661.0652836604296, -67.23686621763066, -721.8494411445618, -133.61289590677603, -1072.0156292443553, -1147.349715699053, -301.7442632247688, -1440.3342486791494, -840.5573389285985, -220.37018910571925, -1051.1183744005218, -1017.483435879607, -1354.2614190294532, -564.3086647199746, -186.78022773374704, -244.89790129409758, -398.28635306284446, -430.3801336412484, -521.2964817135914, -156.09277216908723, -710.5294541652551, -1298.8664003042843, -206.67319362535088, -1142.3100332543977, -637.8328227712374, -695.864709776867, -188.5773362969088, -257.5397293602986, -747.9403618257869, -476.85919425181186, -1178.5529997663727, -717.9219339816034, -695.1292028854251, -591.9291178127603, -233.86013794205502, -561.8980115064332, -846.6184853038467, -433.3412698646488, -652.2117729198751, -667.2513892841378, -1105.1739934094198, -851.1120840645111, -439.65697019999607, -74.32300726722085, -551.6674985273398, -1116.034183997467, -833.7066200729006, -796.3577294509562, -1442.3547608678243, -828.8658010489291, -1094.3875313137485, -466.8451696206478, -237.6562856260411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559896586943159, "mean_inference_ms": 1.7285815348869116, "mean_action_processing_ms": 0.27730908802427584, "mean_env_wait_ms": 3.59188187291564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011572837829589844, "StateBufferConnector_ms": 0.007781982421875, "ViewRequirementAgentConnector_ms": 0.19945383071899414}, "num_episodes": 31, "episode_return_max": -21.181991810959413, "episode_return_min": -1442.3547608678243, "episode_return_mean": -637.6364898467187, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.4439322888476, "num_env_steps_trained_throughput_per_sec": 305.4439322888476, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12835.638, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12835.565, "sample_time_ms": 1153.455, "learn_time_ms": 11610.684, "learn_throughput": 344.51, "synch_weights_time_ms": 70.543}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00016", "date": "2024-08-04_07-00-24", "timestamp": 1722735024, "time_this_iter_s": 13.109771490097046, "time_total_s": 229.86580729484558, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370727400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 229.86580729484558, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.442105263157895, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.10158403267463, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.751403037210306, "policy_loss": -0.009046047083878269, "vf_loss": 7.756466297308604, "vf_explained_var": 0.5780834086860219, "kl": 0.017624979227305958, "entropy": 1.3046892407660684, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -6.909016622114978, "episode_reward_min": -1442.3547608678243, "episode_reward_mean": -627.5293509878467, "episode_len_mean": 123.08, "episode_media": {}, "episodes_timesteps_total": 12308, "policy_reward_min": {"policy_0": -1442.3547608678243}, "policy_reward_max": {"policy_0": -6.909016622114978}, "policy_reward_mean": {"policy_0": -627.5293509878467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.181991810959413, -123.81217899750668, -489.3808621943179, -604.7900486157289, -846.8333153049666, -367.45939837365904, -554.6277017713587, -674.1246306836905, -558.5496144499889, -193.38711621794602, -232.2383721563419, -55.683616097825336, -1109.3516602645445, -117.02004821133215, -483.36408264652465, -171.19499164834463, -583.7282970259125, -241.70244824320932, -661.0652836604296, -67.23686621763066, -721.8494411445618, -133.61289590677603, -1072.0156292443553, -1147.349715699053, -301.7442632247688, -1440.3342486791494, -840.5573389285985, -220.37018910571925, -1051.1183744005218, -1017.483435879607, -1354.2614190294532, -564.3086647199746, -186.78022773374704, -244.89790129409758, -398.28635306284446, -430.3801336412484, -521.2964817135914, -156.09277216908723, -710.5294541652551, -1298.8664003042843, -206.67319362535088, -1142.3100332543977, -637.8328227712374, -695.864709776867, -188.5773362969088, -257.5397293602986, -747.9403618257869, -476.85919425181186, -1178.5529997663727, -717.9219339816034, -695.1292028854251, -591.9291178127603, -233.86013794205502, -561.8980115064332, -846.6184853038467, -433.3412698646488, -652.2117729198751, -667.2513892841378, -1105.1739934094198, -851.1120840645111, -439.65697019999607, -74.32300726722085, -551.6674985273398, -1116.034183997467, -833.7066200729006, -796.3577294509562, -1442.3547608678243, -828.8658010489291, -1094.3875313137485, -466.8451696206478, -237.6562856260411, -585.5909726850489, -562.4999505456237, -614.3829921739933, -465.32190929128853, -58.968473177001236, -693.489414959388, -883.2948902222885, -1306.8853955903792, -625.1851299229069, -1303.1937245664142, -623.6637110932573, -1224.7858281687122, -813.7720301958227, -887.3505565571359, -956.4660370393582, -875.5930945371784, -59.13889698431568, -555.401522357745, -874.6529712106408, -335.0363004529783, -719.2564171973468, -698.4232881727778, -6.909016622114978, -293.2846210105359, -183.49947954402947, -1213.9123333762534, -525.1200060483807, -1066.755045394391, -1001.7798871516233], "episode_lengths": [39, 67, 123, 150, 147, 98, 150, 150, 131, 65, 67, 43, 150, 57, 150, 58, 120, 68, 150, 56, 140, 53, 150, 150, 81, 150, 150, 91, 150, 150, 150, 150, 62, 85, 150, 99, 150, 64, 150, 150, 70, 150, 150, 150, 61, 91, 150, 150, 150, 150, 150, 150, 73, 150, 142, 93, 150, 150, 150, 150, 101, 46, 150, 150, 150, 142, 150, 150, 150, 102, 72, 150, 113, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 97, 150, 150, 33, 89, 70, 150, 150, 150, 150], "policy_policy_0_reward": [-21.181991810959413, -123.81217899750668, -489.3808621943179, -604.7900486157289, -846.8333153049666, -367.45939837365904, -554.6277017713587, -674.1246306836905, -558.5496144499889, -193.38711621794602, -232.2383721563419, -55.683616097825336, -1109.3516602645445, -117.02004821133215, -483.36408264652465, -171.19499164834463, -583.7282970259125, -241.70244824320932, -661.0652836604296, -67.23686621763066, -721.8494411445618, -133.61289590677603, -1072.0156292443553, -1147.349715699053, -301.7442632247688, -1440.3342486791494, -840.5573389285985, -220.37018910571925, -1051.1183744005218, -1017.483435879607, -1354.2614190294532, -564.3086647199746, -186.78022773374704, -244.89790129409758, -398.28635306284446, -430.3801336412484, -521.2964817135914, -156.09277216908723, -710.5294541652551, -1298.8664003042843, -206.67319362535088, -1142.3100332543977, -637.8328227712374, -695.864709776867, -188.5773362969088, -257.5397293602986, -747.9403618257869, -476.85919425181186, -1178.5529997663727, -717.9219339816034, -695.1292028854251, -591.9291178127603, -233.86013794205502, -561.8980115064332, -846.6184853038467, -433.3412698646488, -652.2117729198751, -667.2513892841378, -1105.1739934094198, -851.1120840645111, -439.65697019999607, -74.32300726722085, -551.6674985273398, -1116.034183997467, -833.7066200729006, -796.3577294509562, -1442.3547608678243, -828.8658010489291, -1094.3875313137485, -466.8451696206478, -237.6562856260411, -585.5909726850489, -562.4999505456237, -614.3829921739933, -465.32190929128853, -58.968473177001236, -693.489414959388, -883.2948902222885, -1306.8853955903792, -625.1851299229069, -1303.1937245664142, -623.6637110932573, -1224.7858281687122, -813.7720301958227, -887.3505565571359, -956.4660370393582, -875.5930945371784, -59.13889698431568, -555.401522357745, -874.6529712106408, -335.0363004529783, -719.2564171973468, -698.4232881727778, -6.909016622114978, -293.2846210105359, -183.49947954402947, -1213.9123333762534, -525.1200060483807, -1066.755045394391, -1001.7798871516233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561592153483681, "mean_inference_ms": 1.725654346885614, "mean_action_processing_ms": 0.27722977871143273, "mean_env_wait_ms": 3.586474548976824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011540651321411133, "StateBufferConnector_ms": 0.007826566696166992, "ViewRequirementAgentConnector_ms": 0.1896970272064209}, "num_episodes": 29, "episode_return_max": -6.909016622114978, "episode_return_min": -1442.3547608678243, "episode_return_mean": -627.5293509878467, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.0268453708828, "num_env_steps_trained_throughput_per_sec": 391.0268453708828, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12587.403, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12587.329, "sample_time_ms": 1155.448, "learn_time_ms": 11360.688, "learn_throughput": 352.091, "synch_weights_time_ms": 70.31}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00016", "date": "2024-08-04_07-00-35", "timestamp": 1722735035, "time_this_iter_s": 10.241698980331421, "time_total_s": 240.107506275177, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923707251b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.107506275177, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.286666666666672, "ram_util_percent": 28.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.11617098450661, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.81019543359677, "policy_loss": -0.015564968324906659, "vf_loss": 7.821111020445824, "vf_explained_var": 0.6191552892327309, "kl": 0.020534938319860883, "entropy": 1.5110820381591716, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -6.909016622114978, "episode_reward_min": -1442.3547608678243, "episode_reward_mean": -643.9311029802784, "episode_len_mean": 128.64, "episode_media": {}, "episodes_timesteps_total": 12864, "policy_reward_min": {"policy_0": -1442.3547608678243}, "policy_reward_max": {"policy_0": -6.909016622114978}, "policy_reward_mean": {"policy_0": -643.9311029802784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1017.483435879607, -1354.2614190294532, -564.3086647199746, -186.78022773374704, -244.89790129409758, -398.28635306284446, -430.3801336412484, -521.2964817135914, -156.09277216908723, -710.5294541652551, -1298.8664003042843, -206.67319362535088, -1142.3100332543977, -637.8328227712374, -695.864709776867, -188.5773362969088, -257.5397293602986, -747.9403618257869, -476.85919425181186, -1178.5529997663727, -717.9219339816034, -695.1292028854251, -591.9291178127603, -233.86013794205502, -561.8980115064332, -846.6184853038467, -433.3412698646488, -652.2117729198751, -667.2513892841378, -1105.1739934094198, -851.1120840645111, -439.65697019999607, -74.32300726722085, -551.6674985273398, -1116.034183997467, -833.7066200729006, -796.3577294509562, -1442.3547608678243, -828.8658010489291, -1094.3875313137485, -466.8451696206478, -237.6562856260411, -585.5909726850489, -562.4999505456237, -614.3829921739933, -465.32190929128853, -58.968473177001236, -693.489414959388, -883.2948902222885, -1306.8853955903792, -625.1851299229069, -1303.1937245664142, -623.6637110932573, -1224.7858281687122, -813.7720301958227, -887.3505565571359, -956.4660370393582, -875.5930945371784, -59.13889698431568, -555.401522357745, -874.6529712106408, -335.0363004529783, -719.2564171973468, -698.4232881727778, -6.909016622114978, -293.2846210105359, -183.49947954402947, -1213.9123333762534, -525.1200060483807, -1066.755045394391, -1001.7798871516233, -599.6086072553638, -1055.990644383298, -396.41695758190707, -293.5761583946495, -583.4279466954175, -897.0712118860745, -752.0878325320169, -405.05045528985494, -566.0511364287074, -1367.1387211410774, -645.0872852123282, -567.0383258013372, -288.70847519954583, -583.9216848633537, -805.0691087025015, -1249.1340371834426, -614.313644358573, -105.40507482695756, -146.48610676331162, -71.0999338958064, -532.6593811085729, -439.37790701849696, -507.3340285855663, -102.2858454990201, -816.2276652942738, -590.3882314746172, -366.68794656824224, -699.9835829223011, -678.2318833022895], "episode_lengths": [150, 150, 150, 62, 85, 150, 99, 150, 64, 150, 150, 70, 150, 150, 150, 61, 91, 150, 150, 150, 150, 150, 150, 73, 150, 142, 93, 150, 150, 150, 150, 101, 46, 150, 150, 150, 142, 150, 150, 150, 102, 72, 150, 113, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 97, 150, 150, 33, 89, 70, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 93, 150, 150, 150, 150, 93, 150, 146, 150, 150, 73, 74, 60, 150, 103, 150, 62, 150, 139, 92, 150, 150], "policy_policy_0_reward": [-1017.483435879607, -1354.2614190294532, -564.3086647199746, -186.78022773374704, -244.89790129409758, -398.28635306284446, -430.3801336412484, -521.2964817135914, -156.09277216908723, -710.5294541652551, -1298.8664003042843, -206.67319362535088, -1142.3100332543977, -637.8328227712374, -695.864709776867, -188.5773362969088, -257.5397293602986, -747.9403618257869, -476.85919425181186, -1178.5529997663727, -717.9219339816034, -695.1292028854251, -591.9291178127603, -233.86013794205502, -561.8980115064332, -846.6184853038467, -433.3412698646488, -652.2117729198751, -667.2513892841378, -1105.1739934094198, -851.1120840645111, -439.65697019999607, -74.32300726722085, -551.6674985273398, -1116.034183997467, -833.7066200729006, -796.3577294509562, -1442.3547608678243, -828.8658010489291, -1094.3875313137485, -466.8451696206478, -237.6562856260411, -585.5909726850489, -562.4999505456237, -614.3829921739933, -465.32190929128853, -58.968473177001236, -693.489414959388, -883.2948902222885, -1306.8853955903792, -625.1851299229069, -1303.1937245664142, -623.6637110932573, -1224.7858281687122, -813.7720301958227, -887.3505565571359, -956.4660370393582, -875.5930945371784, -59.13889698431568, -555.401522357745, -874.6529712106408, -335.0363004529783, -719.2564171973468, -698.4232881727778, -6.909016622114978, -293.2846210105359, -183.49947954402947, -1213.9123333762534, -525.1200060483807, -1066.755045394391, -1001.7798871516233, -599.6086072553638, -1055.990644383298, -396.41695758190707, -293.5761583946495, -583.4279466954175, -897.0712118860745, -752.0878325320169, -405.05045528985494, -566.0511364287074, -1367.1387211410774, -645.0872852123282, -567.0383258013372, -288.70847519954583, -583.9216848633537, -805.0691087025015, -1249.1340371834426, -614.313644358573, -105.40507482695756, -146.48610676331162, -71.0999338958064, -532.6593811085729, -439.37790701849696, -507.3340285855663, -102.2858454990201, -816.2276652942738, -590.3882314746172, -366.68794656824224, -699.9835829223011, -678.2318833022895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559225967363267, "mean_inference_ms": 1.7224159037855187, "mean_action_processing_ms": 0.27704103809020125, "mean_env_wait_ms": 3.582032729938798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011650323867797852, "StateBufferConnector_ms": 0.007882356643676758, "ViewRequirementAgentConnector_ms": 0.19030141830444336}, "num_episodes": 29, "episode_return_max": -6.909016622114978, "episode_return_min": -1442.3547608678243, "episode_return_mean": -643.9311029802784, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.5412180455498, "num_env_steps_trained_throughput_per_sec": 310.5412180455498, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12551.89, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12551.815, "sample_time_ms": 1151.722, "learn_time_ms": 11328.742, "learn_throughput": 353.084, "synch_weights_time_ms": 70.438}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00016", "date": "2024-08-04_07-00-48", "timestamp": 1722735048, "time_this_iter_s": 12.893001556396484, "time_total_s": 253.0005078315735, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.0005078315735, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.66111111111111, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.305003406355777, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.307079194982846, "policy_loss": -0.012193756883304256, "vf_loss": 8.313991770644982, "vf_explained_var": 0.5578595149020354, "kl": 0.01512157930186125, "entropy": 1.5235266832013925, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -6.909016622114978, "episode_reward_min": -1442.3547608678243, "episode_reward_mean": -673.199991188996, "episode_len_mean": 127.35, "episode_media": {}, "episodes_timesteps_total": 12735, "policy_reward_min": {"policy_0": -1442.3547608678243}, "policy_reward_max": {"policy_0": -6.909016622114978}, "policy_reward_mean": {"policy_0": -673.199991188996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1116.034183997467, -833.7066200729006, -796.3577294509562, -1442.3547608678243, -828.8658010489291, -1094.3875313137485, -466.8451696206478, -237.6562856260411, -585.5909726850489, -562.4999505456237, -614.3829921739933, -465.32190929128853, -58.968473177001236, -693.489414959388, -883.2948902222885, -1306.8853955903792, -625.1851299229069, -1303.1937245664142, -623.6637110932573, -1224.7858281687122, -813.7720301958227, -887.3505565571359, -956.4660370393582, -875.5930945371784, -59.13889698431568, -555.401522357745, -874.6529712106408, -335.0363004529783, -719.2564171973468, -698.4232881727778, -6.909016622114978, -293.2846210105359, -183.49947954402947, -1213.9123333762534, -525.1200060483807, -1066.755045394391, -1001.7798871516233, -599.6086072553638, -1055.990644383298, -396.41695758190707, -293.5761583946495, -583.4279466954175, -897.0712118860745, -752.0878325320169, -405.05045528985494, -566.0511364287074, -1367.1387211410774, -645.0872852123282, -567.0383258013372, -288.70847519954583, -583.9216848633537, -805.0691087025015, -1249.1340371834426, -614.313644358573, -105.40507482695756, -146.48610676331162, -71.0999338958064, -532.6593811085729, -439.37790701849696, -507.3340285855663, -102.2858454990201, -816.2276652942738, -590.3882314746172, -366.68794656824224, -699.9835829223011, -678.2318833022895, -533.0424878987104, -728.5701861632717, -595.0003110380117, -167.00230326753982, -1387.2489563342797, -688.7714174011477, -310.54767314502527, -99.51735938284861, -872.2134501265158, -1436.9049162687934, -308.392024099538, -1113.0604708607993, -115.27224306216095, -1241.212345278937, -175.3953982010923, -764.1843174984073, -953.8053255204418, -535.6733977312877, -594.8652427431111, -818.3055623048435, -115.78205216516864, -248.3594968851448, -253.028052077827, -1129.994053763049, -501.9115710985023, -992.8642181083808, -1119.3224771694802, -45.245890854422655, -1031.0848294417808, -1410.390314186424, -1269.1437319611653, -397.9903105784765, -1364.573875222547, -445.6410586441237], "episode_lengths": [150, 150, 142, 150, 150, 150, 102, 72, 150, 113, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 97, 150, 150, 33, 89, 70, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 93, 150, 150, 150, 150, 93, 150, 146, 150, 150, 73, 74, 60, 150, 103, 150, 62, 150, 139, 92, 150, 150, 119, 134, 150, 76, 150, 150, 96, 61, 150, 150, 82, 150, 65, 150, 59, 150, 150, 115, 118, 145, 63, 86, 81, 150, 109, 150, 150, 49, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1116.034183997467, -833.7066200729006, -796.3577294509562, -1442.3547608678243, -828.8658010489291, -1094.3875313137485, -466.8451696206478, -237.6562856260411, -585.5909726850489, -562.4999505456237, -614.3829921739933, -465.32190929128853, -58.968473177001236, -693.489414959388, -883.2948902222885, -1306.8853955903792, -625.1851299229069, -1303.1937245664142, -623.6637110932573, -1224.7858281687122, -813.7720301958227, -887.3505565571359, -956.4660370393582, -875.5930945371784, -59.13889698431568, -555.401522357745, -874.6529712106408, -335.0363004529783, -719.2564171973468, -698.4232881727778, -6.909016622114978, -293.2846210105359, -183.49947954402947, -1213.9123333762534, -525.1200060483807, -1066.755045394391, -1001.7798871516233, -599.6086072553638, -1055.990644383298, -396.41695758190707, -293.5761583946495, -583.4279466954175, -897.0712118860745, -752.0878325320169, -405.05045528985494, -566.0511364287074, -1367.1387211410774, -645.0872852123282, -567.0383258013372, -288.70847519954583, -583.9216848633537, -805.0691087025015, -1249.1340371834426, -614.313644358573, -105.40507482695756, -146.48610676331162, -71.0999338958064, -532.6593811085729, -439.37790701849696, -507.3340285855663, -102.2858454990201, -816.2276652942738, -590.3882314746172, -366.68794656824224, -699.9835829223011, -678.2318833022895, -533.0424878987104, -728.5701861632717, -595.0003110380117, -167.00230326753982, -1387.2489563342797, -688.7714174011477, -310.54767314502527, -99.51735938284861, -872.2134501265158, -1436.9049162687934, -308.392024099538, -1113.0604708607993, -115.27224306216095, -1241.212345278937, -175.3953982010923, -764.1843174984073, -953.8053255204418, -535.6733977312877, -594.8652427431111, -818.3055623048435, -115.78205216516864, -248.3594968851448, -253.028052077827, -1129.994053763049, -501.9115710985023, -992.8642181083808, -1119.3224771694802, -45.245890854422655, -1031.0848294417808, -1410.390314186424, -1269.1437319611653, -397.9903105784765, -1364.573875222547, -445.6410586441237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552790583662655, "mean_inference_ms": 1.7224244667334219, "mean_action_processing_ms": 0.27691900207806036, "mean_env_wait_ms": 3.5756453211432158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011839151382446289, "StateBufferConnector_ms": 0.007870912551879883, "ViewRequirementAgentConnector_ms": 0.18928885459899902}, "num_episodes": 34, "episode_return_max": -6.909016622114978, "episode_return_min": -1442.3547608678243, "episode_return_mean": -673.199991188996, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.16071727268843, "num_env_steps_trained_throughput_per_sec": 310.16071727268843, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12605.228, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12605.154, "sample_time_ms": 1148.864, "learn_time_ms": 11387.314, "learn_throughput": 351.268, "synch_weights_time_ms": 68.059}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00016", "date": "2024-08-04_07-01-01", "timestamp": 1722735061, "time_this_iter_s": 12.908840656280518, "time_total_s": 265.909348487854, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370724f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.909348487854, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.65, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.03440583050251, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.643297517796357, "policy_loss": -0.010890635620550407, "vf_loss": 7.646840190390746, "vf_explained_var": 0.674081934367617, "kl": 0.019103512036713254, "entropy": 1.2486067974319062, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -40.87546570477707, "episode_reward_min": -1436.9049162687934, "episode_reward_mean": -617.0578922628446, "episode_len_mean": 122.21, "episode_media": {}, "episodes_timesteps_total": 12221, "policy_reward_min": {"policy_0": -1436.9049162687934}, "policy_reward_max": {"policy_0": -40.87546570477707}, "policy_reward_mean": {"policy_0": -617.0578922628446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1001.7798871516233, -599.6086072553638, -1055.990644383298, -396.41695758190707, -293.5761583946495, -583.4279466954175, -897.0712118860745, -752.0878325320169, -405.05045528985494, -566.0511364287074, -1367.1387211410774, -645.0872852123282, -567.0383258013372, -288.70847519954583, -583.9216848633537, -805.0691087025015, -1249.1340371834426, -614.313644358573, -105.40507482695756, -146.48610676331162, -71.0999338958064, -532.6593811085729, -439.37790701849696, -507.3340285855663, -102.2858454990201, -816.2276652942738, -590.3882314746172, -366.68794656824224, -699.9835829223011, -678.2318833022895, -533.0424878987104, -728.5701861632717, -595.0003110380117, -167.00230326753982, -1387.2489563342797, -688.7714174011477, -310.54767314502527, -99.51735938284861, -872.2134501265158, -1436.9049162687934, -308.392024099538, -1113.0604708607993, -115.27224306216095, -1241.212345278937, -175.3953982010923, -764.1843174984073, -953.8053255204418, -535.6733977312877, -594.8652427431111, -818.3055623048435, -115.78205216516864, -248.3594968851448, -253.028052077827, -1129.994053763049, -501.9115710985023, -992.8642181083808, -1119.3224771694802, -45.245890854422655, -1031.0848294417808, -1410.390314186424, -1269.1437319611653, -397.9903105784765, -1364.573875222547, -445.6410586441237, -1068.6492434179338, -436.45024200625176, -838.2073389320403, -593.0245918217221, -954.0357415666371, -438.8646873419064, -52.88535985337508, -366.33058065541513, -40.87546570477707, -1184.7903129314195, -659.3127122550268, -991.652400224205, -290.00866353704953, -181.95394354757866, -1260.8970455219091, -810.7034904122543, -524.8500890607805, -1095.9819945645067, -1107.3714786761363, -325.24525247311885, -668.3422246316989, -73.7833863681324, -265.13634186899776, -661.3132233420787, -647.5253078295946, -780.9665068765458, -554.0367617002664, -913.52115509275, -586.4021029465237, -510.0652207817453, -341.33015130353414, -55.14665585746022, -484.47629237592514, -271.62457781125426, -118.56217973198034, -59.5094754581356], "episode_lengths": [150, 150, 150, 150, 75, 150, 150, 150, 93, 150, 150, 150, 150, 93, 150, 146, 150, 150, 73, 74, 60, 150, 103, 150, 62, 150, 139, 92, 150, 150, 119, 134, 150, 76, 150, 150, 96, 61, 150, 150, 82, 150, 65, 150, 59, 150, 150, 115, 118, 145, 63, 86, 81, 150, 109, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 99, 45, 97, 50, 150, 150, 150, 79, 58, 150, 150, 115, 150, 150, 101, 150, 54, 78, 150, 150, 148, 150, 150, 150, 150, 80, 55, 150, 86, 67, 47], "policy_policy_0_reward": [-1001.7798871516233, -599.6086072553638, -1055.990644383298, -396.41695758190707, -293.5761583946495, -583.4279466954175, -897.0712118860745, -752.0878325320169, -405.05045528985494, -566.0511364287074, -1367.1387211410774, -645.0872852123282, -567.0383258013372, -288.70847519954583, -583.9216848633537, -805.0691087025015, -1249.1340371834426, -614.313644358573, -105.40507482695756, -146.48610676331162, -71.0999338958064, -532.6593811085729, -439.37790701849696, -507.3340285855663, -102.2858454990201, -816.2276652942738, -590.3882314746172, -366.68794656824224, -699.9835829223011, -678.2318833022895, -533.0424878987104, -728.5701861632717, -595.0003110380117, -167.00230326753982, -1387.2489563342797, -688.7714174011477, -310.54767314502527, -99.51735938284861, -872.2134501265158, -1436.9049162687934, -308.392024099538, -1113.0604708607993, -115.27224306216095, -1241.212345278937, -175.3953982010923, -764.1843174984073, -953.8053255204418, -535.6733977312877, -594.8652427431111, -818.3055623048435, -115.78205216516864, -248.3594968851448, -253.028052077827, -1129.994053763049, -501.9115710985023, -992.8642181083808, -1119.3224771694802, -45.245890854422655, -1031.0848294417808, -1410.390314186424, -1269.1437319611653, -397.9903105784765, -1364.573875222547, -445.6410586441237, -1068.6492434179338, -436.45024200625176, -838.2073389320403, -593.0245918217221, -954.0357415666371, -438.8646873419064, -52.88535985337508, -366.33058065541513, -40.87546570477707, -1184.7903129314195, -659.3127122550268, -991.652400224205, -290.00866353704953, -181.95394354757866, -1260.8970455219091, -810.7034904122543, -524.8500890607805, -1095.9819945645067, -1107.3714786761363, -325.24525247311885, -668.3422246316989, -73.7833863681324, -265.13634186899776, -661.3132233420787, -647.5253078295946, -780.9665068765458, -554.0367617002664, -913.52115509275, -586.4021029465237, -510.0652207817453, -341.33015130353414, -55.14665585746022, -484.47629237592514, -271.62457781125426, -118.56217973198034, -59.5094754581356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547704676721257, "mean_inference_ms": 1.722629980526027, "mean_action_processing_ms": 0.2767751265527692, "mean_env_wait_ms": 3.5714386806439586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011496782302856445, "StateBufferConnector_ms": 0.007815837860107422, "ViewRequirementAgentConnector_ms": 0.1890573501586914}, "num_episodes": 36, "episode_return_max": -40.87546570477707, "episode_return_min": -1436.9049162687934, "episode_return_mean": -617.0578922628446, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.36481683803515, "num_env_steps_trained_throughput_per_sec": 304.36481683803515, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12712.98, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12712.907, "sample_time_ms": 1146.245, "learn_time_ms": 11497.913, "learn_throughput": 347.889, "synch_weights_time_ms": 67.841}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00016", "date": "2024-08-04_07-01-14", "timestamp": 1722735074, "time_this_iter_s": 13.153895139694214, "time_total_s": 279.0632436275482, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e2320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.0632436275482, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.25263157894737, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.97146334350109, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.2964855094750725, "policy_loss": -0.007695995816902723, "vf_loss": 7.298966631293297, "vf_explained_var": 0.7170038176079591, "kl": 0.014322168419190954, "entropy": 1.2300690812369188, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -20.466772942386026, "episode_reward_min": -1436.9049162687934, "episode_reward_mean": -615.2023455756239, "episode_len_mean": 121.43, "episode_media": {}, "episodes_timesteps_total": 12143, "policy_reward_min": {"policy_0": -1436.9049162687934}, "policy_reward_max": {"policy_0": -20.466772942386026}, "policy_reward_mean": {"policy_0": -615.2023455756239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.00230326753982, -1387.2489563342797, -688.7714174011477, -310.54767314502527, -99.51735938284861, -872.2134501265158, -1436.9049162687934, -308.392024099538, -1113.0604708607993, -115.27224306216095, -1241.212345278937, -175.3953982010923, -764.1843174984073, -953.8053255204418, -535.6733977312877, -594.8652427431111, -818.3055623048435, -115.78205216516864, -248.3594968851448, -253.028052077827, -1129.994053763049, -501.9115710985023, -992.8642181083808, -1119.3224771694802, -45.245890854422655, -1031.0848294417808, -1410.390314186424, -1269.1437319611653, -397.9903105784765, -1364.573875222547, -445.6410586441237, -1068.6492434179338, -436.45024200625176, -838.2073389320403, -593.0245918217221, -954.0357415666371, -438.8646873419064, -52.88535985337508, -366.33058065541513, -40.87546570477707, -1184.7903129314195, -659.3127122550268, -991.652400224205, -290.00866353704953, -181.95394354757866, -1260.8970455219091, -810.7034904122543, -524.8500890607805, -1095.9819945645067, -1107.3714786761363, -325.24525247311885, -668.3422246316989, -73.7833863681324, -265.13634186899776, -661.3132233420787, -647.5253078295946, -780.9665068765458, -554.0367617002664, -913.52115509275, -586.4021029465237, -510.0652207817453, -341.33015130353414, -55.14665585746022, -484.47629237592514, -271.62457781125426, -118.56217973198034, -59.5094754581356, -496.28357101552893, -666.57064590491, -765.9523205856598, -539.3396884120132, -20.466772942386026, -29.91492748313423, -432.8366414366816, -341.93645163312226, -429.1052915080785, -850.9492637369948, -760.1402392798097, -387.052648101862, -986.4838683851334, -610.2728550636369, -459.4872759477875, -616.2683440278524, -629.9326301305739, -39.735514477640805, -508.9540617672777, -651.8500399999483, -650.9097549235114, -907.3485454705103, -588.8297808650915, -1113.1948634519936, -293.3494279664352, -808.5633131726172, -582.7374569978113, -628.3617513045749, -357.2412774316976, -1254.7746989257412, -916.1407992731309, -535.245586579944, -538.4677154953715], "episode_lengths": [76, 150, 150, 96, 61, 150, 150, 82, 150, 65, 150, 59, 150, 150, 115, 118, 145, 63, 86, 81, 150, 109, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 99, 45, 97, 50, 150, 150, 150, 79, 58, 150, 150, 115, 150, 150, 101, 150, 54, 78, 150, 150, 148, 150, 150, 150, 150, 80, 55, 150, 86, 67, 47, 150, 150, 150, 116, 50, 46, 100, 84, 97, 150, 150, 91, 150, 150, 103, 121, 150, 53, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 91, 150, 150, 150, 118], "policy_policy_0_reward": [-167.00230326753982, -1387.2489563342797, -688.7714174011477, -310.54767314502527, -99.51735938284861, -872.2134501265158, -1436.9049162687934, -308.392024099538, -1113.0604708607993, -115.27224306216095, -1241.212345278937, -175.3953982010923, -764.1843174984073, -953.8053255204418, -535.6733977312877, -594.8652427431111, -818.3055623048435, -115.78205216516864, -248.3594968851448, -253.028052077827, -1129.994053763049, -501.9115710985023, -992.8642181083808, -1119.3224771694802, -45.245890854422655, -1031.0848294417808, -1410.390314186424, -1269.1437319611653, -397.9903105784765, -1364.573875222547, -445.6410586441237, -1068.6492434179338, -436.45024200625176, -838.2073389320403, -593.0245918217221, -954.0357415666371, -438.8646873419064, -52.88535985337508, -366.33058065541513, -40.87546570477707, -1184.7903129314195, -659.3127122550268, -991.652400224205, -290.00866353704953, -181.95394354757866, -1260.8970455219091, -810.7034904122543, -524.8500890607805, -1095.9819945645067, -1107.3714786761363, -325.24525247311885, -668.3422246316989, -73.7833863681324, -265.13634186899776, -661.3132233420787, -647.5253078295946, -780.9665068765458, -554.0367617002664, -913.52115509275, -586.4021029465237, -510.0652207817453, -341.33015130353414, -55.14665585746022, -484.47629237592514, -271.62457781125426, -118.56217973198034, -59.5094754581356, -496.28357101552893, -666.57064590491, -765.9523205856598, -539.3396884120132, -20.466772942386026, -29.91492748313423, -432.8366414366816, -341.93645163312226, -429.1052915080785, -850.9492637369948, -760.1402392798097, -387.052648101862, -986.4838683851334, -610.2728550636369, -459.4872759477875, -616.2683440278524, -629.9326301305739, -39.735514477640805, -508.9540617672777, -651.8500399999483, -650.9097549235114, -907.3485454705103, -588.8297808650915, -1113.1948634519936, -293.3494279664352, -808.5633131726172, -582.7374569978113, -628.3617513045749, -357.2412774316976, -1254.7746989257412, -916.1407992731309, -535.245586579944, -538.4677154953715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548309405233541, "mean_inference_ms": 1.7189058790744332, "mean_action_processing_ms": 0.276544731023187, "mean_env_wait_ms": 3.567810686374732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011527061462402344, "StateBufferConnector_ms": 0.007801532745361328, "ViewRequirementAgentConnector_ms": 0.18799853324890137}, "num_episodes": 33, "episode_return_max": -20.466772942386026, "episode_return_min": -1436.9049162687934, "episode_return_mean": -615.2023455756239, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.714825658876, "num_env_steps_trained_throughput_per_sec": 305.714825658876, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12714.953, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12714.881, "sample_time_ms": 1145.504, "learn_time_ms": 11501.407, "learn_throughput": 347.784, "synch_weights_time_ms": 67.041}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00016", "date": "2024-08-04_07-01-27", "timestamp": 1722735087, "time_this_iter_s": 13.096235990524292, "time_total_s": 292.1594796180725, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e1bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.1594796180725, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.426315789473687, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.7470923324426, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.982450266679128, "policy_loss": -0.01821549059144066, "vf_loss": 7.993002865215143, "vf_explained_var": 0.6732187885170181, "kl": 0.020432832762329205, "entropy": 1.5318802741666635, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -15.13701047016591, "episode_reward_min": -1621.9598619325598, "episode_reward_mean": -556.3789388277818, "episode_len_mean": 118.45, "episode_media": {}, "episodes_timesteps_total": 11845, "policy_reward_min": {"policy_0": -1621.9598619325598}, "policy_reward_max": {"policy_0": -15.13701047016591}, "policy_reward_mean": {"policy_0": -556.3789388277818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-838.2073389320403, -593.0245918217221, -954.0357415666371, -438.8646873419064, -52.88535985337508, -366.33058065541513, -40.87546570477707, -1184.7903129314195, -659.3127122550268, -991.652400224205, -290.00866353704953, -181.95394354757866, -1260.8970455219091, -810.7034904122543, -524.8500890607805, -1095.9819945645067, -1107.3714786761363, -325.24525247311885, -668.3422246316989, -73.7833863681324, -265.13634186899776, -661.3132233420787, -647.5253078295946, -780.9665068765458, -554.0367617002664, -913.52115509275, -586.4021029465237, -510.0652207817453, -341.33015130353414, -55.14665585746022, -484.47629237592514, -271.62457781125426, -118.56217973198034, -59.5094754581356, -496.28357101552893, -666.57064590491, -765.9523205856598, -539.3396884120132, -20.466772942386026, -29.91492748313423, -432.8366414366816, -341.93645163312226, -429.1052915080785, -850.9492637369948, -760.1402392798097, -387.052648101862, -986.4838683851334, -610.2728550636369, -459.4872759477875, -616.2683440278524, -629.9326301305739, -39.735514477640805, -508.9540617672777, -651.8500399999483, -650.9097549235114, -907.3485454705103, -588.8297808650915, -1113.1948634519936, -293.3494279664352, -808.5633131726172, -582.7374569978113, -628.3617513045749, -357.2412774316976, -1254.7746989257412, -916.1407992731309, -535.245586579944, -538.4677154953715, -499.5773094116237, -86.6744991410215, -1211.6950519506966, -781.0958198330258, -337.0117827270199, -159.0846334283484, -386.7525326061438, -551.7135994354211, -244.4067626744834, -686.7914070347417, -781.5810649446258, -823.5109598184767, -805.0945619607671, -52.52429926149223, -230.29093459017452, -73.6103932006028, -1286.7934182938275, -618.7828980032264, -15.13701047016591, -1621.9598619325598, -98.60995420977666, -750.4784530394019, -833.9826187822404, -163.5491944701343, -554.4610800400063, -580.8300327525584, -513.3584252153839, -511.1797949993712, -36.603372580363235, -657.3911987960973, -242.92918296945282, -1055.9575835823211, -277.0434538676848], "episode_lengths": [150, 150, 150, 99, 45, 97, 50, 150, 150, 150, 79, 58, 150, 150, 115, 150, 150, 101, 150, 54, 78, 150, 150, 148, 150, 150, 150, 150, 80, 55, 150, 86, 67, 47, 150, 150, 150, 116, 50, 46, 100, 84, 97, 150, 150, 91, 150, 150, 103, 121, 150, 53, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 91, 150, 150, 150, 118, 150, 42, 150, 150, 105, 63, 110, 114, 79, 150, 150, 150, 147, 44, 69, 69, 150, 150, 38, 150, 51, 150, 150, 65, 150, 111, 123, 150, 52, 150, 80, 150, 89], "policy_policy_0_reward": [-838.2073389320403, -593.0245918217221, -954.0357415666371, -438.8646873419064, -52.88535985337508, -366.33058065541513, -40.87546570477707, -1184.7903129314195, -659.3127122550268, -991.652400224205, -290.00866353704953, -181.95394354757866, -1260.8970455219091, -810.7034904122543, -524.8500890607805, -1095.9819945645067, -1107.3714786761363, -325.24525247311885, -668.3422246316989, -73.7833863681324, -265.13634186899776, -661.3132233420787, -647.5253078295946, -780.9665068765458, -554.0367617002664, -913.52115509275, -586.4021029465237, -510.0652207817453, -341.33015130353414, -55.14665585746022, -484.47629237592514, -271.62457781125426, -118.56217973198034, -59.5094754581356, -496.28357101552893, -666.57064590491, -765.9523205856598, -539.3396884120132, -20.466772942386026, -29.91492748313423, -432.8366414366816, -341.93645163312226, -429.1052915080785, -850.9492637369948, -760.1402392798097, -387.052648101862, -986.4838683851334, -610.2728550636369, -459.4872759477875, -616.2683440278524, -629.9326301305739, -39.735514477640805, -508.9540617672777, -651.8500399999483, -650.9097549235114, -907.3485454705103, -588.8297808650915, -1113.1948634519936, -293.3494279664352, -808.5633131726172, -582.7374569978113, -628.3617513045749, -357.2412774316976, -1254.7746989257412, -916.1407992731309, -535.245586579944, -538.4677154953715, -499.5773094116237, -86.6744991410215, -1211.6950519506966, -781.0958198330258, -337.0117827270199, -159.0846334283484, -386.7525326061438, -551.7135994354211, -244.4067626744834, -686.7914070347417, -781.5810649446258, -823.5109598184767, -805.0945619607671, -52.52429926149223, -230.29093459017452, -73.6103932006028, -1286.7934182938275, -618.7828980032264, -15.13701047016591, -1621.9598619325598, -98.60995420977666, -750.4784530394019, -833.9826187822404, -163.5491944701343, -554.4610800400063, -580.8300327525584, -513.3584252153839, -511.1797949993712, -36.603372580363235, -657.3911987960973, -242.92918296945282, -1055.9575835823211, -277.0434538676848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545172646483271, "mean_inference_ms": 1.7153876850689296, "mean_action_processing_ms": 0.27639211121461843, "mean_env_wait_ms": 3.5641596096964627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011666297912597656, "StateBufferConnector_ms": 0.007810831069946289, "ViewRequirementAgentConnector_ms": 0.1890554428100586}, "num_episodes": 33, "episode_return_max": -15.13701047016591, "episode_return_min": -1621.9598619325598, "episode_return_mean": -556.3789388277818, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.4694743165529, "num_env_steps_trained_throughput_per_sec": 292.4694743165529, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12786.561, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12786.488, "sample_time_ms": 1155.4, "learn_time_ms": 11561.081, "learn_throughput": 345.988, "synch_weights_time_ms": 69.084}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00016", "date": "2024-08-04_07-01-41", "timestamp": 1722735101, "time_this_iter_s": 13.690038204193115, "time_total_s": 305.8495178222656, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923707241f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.8495178222656, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.65263157894737, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.568147240082425, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 8.160765038430691, "policy_loss": -0.008102983886298412, "vf_loss": 8.16177175194025, "vf_explained_var": 0.6463725890964269, "kl": 0.013169549278609338, "entropy": 1.7931876928855977, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -6.159986314359592, "episode_reward_min": -1621.9598619325598, "episode_reward_mean": -621.8652692057644, "episode_len_mean": 119.74, "episode_media": {}, "episodes_timesteps_total": 11974, "policy_reward_min": {"policy_0": -1621.9598619325598}, "policy_reward_max": {"policy_0": -6.159986314359592}, "policy_reward_mean": {"policy_0": -621.8652692057644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.5094754581356, -496.28357101552893, -666.57064590491, -765.9523205856598, -539.3396884120132, -20.466772942386026, -29.91492748313423, -432.8366414366816, -341.93645163312226, -429.1052915080785, -850.9492637369948, -760.1402392798097, -387.052648101862, -986.4838683851334, -610.2728550636369, -459.4872759477875, -616.2683440278524, -629.9326301305739, -39.735514477640805, -508.9540617672777, -651.8500399999483, -650.9097549235114, -907.3485454705103, -588.8297808650915, -1113.1948634519936, -293.3494279664352, -808.5633131726172, -582.7374569978113, -628.3617513045749, -357.2412774316976, -1254.7746989257412, -916.1407992731309, -535.245586579944, -538.4677154953715, -499.5773094116237, -86.6744991410215, -1211.6950519506966, -781.0958198330258, -337.0117827270199, -159.0846334283484, -386.7525326061438, -551.7135994354211, -244.4067626744834, -686.7914070347417, -781.5810649446258, -823.5109598184767, -805.0945619607671, -52.52429926149223, -230.29093459017452, -73.6103932006028, -1286.7934182938275, -618.7828980032264, -15.13701047016591, -1621.9598619325598, -98.60995420977666, -750.4784530394019, -833.9826187822404, -163.5491944701343, -554.4610800400063, -580.8300327525584, -513.3584252153839, -511.1797949993712, -36.603372580363235, -657.3911987960973, -242.92918296945282, -1055.9575835823211, -277.0434538676848, -630.0712309928346, -7.053531471740745, -1041.4206697696009, -667.4351122468047, -664.7484426691055, -58.742707631825056, -1126.6869796288545, -64.11371187693975, -1300.668981558573, -63.601099721301324, -1438.97039015966, -1007.2742429003079, -1491.045000801807, -646.282625440795, -177.7656624211793, -1457.5644868216414, -632.0778632822419, -450.73314096943955, -875.6218391537863, -1557.188129462382, -128.5100050715425, -1492.94786306283, -1248.692208478398, -755.7000030875055, -596.0529877762672, -1105.921124790627, -421.51878279818334, -510.2225879730825, -54.13693170725855, -1378.9087542042964, -6.159986314359592, -1063.638026177562, -1076.3811649738814], "episode_lengths": [47, 150, 150, 150, 116, 50, 46, 100, 84, 97, 150, 150, 91, 150, 150, 103, 121, 150, 53, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 91, 150, 150, 150, 118, 150, 42, 150, 150, 105, 63, 110, 114, 79, 150, 150, 150, 147, 44, 69, 69, 150, 150, 38, 150, 51, 150, 150, 65, 150, 111, 123, 150, 52, 150, 80, 150, 89, 150, 34, 150, 137, 150, 50, 150, 55, 150, 60, 150, 150, 150, 150, 60, 150, 150, 114, 150, 150, 55, 150, 150, 150, 150, 150, 96, 150, 43, 150, 37, 150, 150], "policy_policy_0_reward": [-59.5094754581356, -496.28357101552893, -666.57064590491, -765.9523205856598, -539.3396884120132, -20.466772942386026, -29.91492748313423, -432.8366414366816, -341.93645163312226, -429.1052915080785, -850.9492637369948, -760.1402392798097, -387.052648101862, -986.4838683851334, -610.2728550636369, -459.4872759477875, -616.2683440278524, -629.9326301305739, -39.735514477640805, -508.9540617672777, -651.8500399999483, -650.9097549235114, -907.3485454705103, -588.8297808650915, -1113.1948634519936, -293.3494279664352, -808.5633131726172, -582.7374569978113, -628.3617513045749, -357.2412774316976, -1254.7746989257412, -916.1407992731309, -535.245586579944, -538.4677154953715, -499.5773094116237, -86.6744991410215, -1211.6950519506966, -781.0958198330258, -337.0117827270199, -159.0846334283484, -386.7525326061438, -551.7135994354211, -244.4067626744834, -686.7914070347417, -781.5810649446258, -823.5109598184767, -805.0945619607671, -52.52429926149223, -230.29093459017452, -73.6103932006028, -1286.7934182938275, -618.7828980032264, -15.13701047016591, -1621.9598619325598, -98.60995420977666, -750.4784530394019, -833.9826187822404, -163.5491944701343, -554.4610800400063, -580.8300327525584, -513.3584252153839, -511.1797949993712, -36.603372580363235, -657.3911987960973, -242.92918296945282, -1055.9575835823211, -277.0434538676848, -630.0712309928346, -7.053531471740745, -1041.4206697696009, -667.4351122468047, -664.7484426691055, -58.742707631825056, -1126.6869796288545, -64.11371187693975, -1300.668981558573, -63.601099721301324, -1438.97039015966, -1007.2742429003079, -1491.045000801807, -646.282625440795, -177.7656624211793, -1457.5644868216414, -632.0778632822419, -450.73314096943955, -875.6218391537863, -1557.188129462382, -128.5100050715425, -1492.94786306283, -1248.692208478398, -755.7000030875055, -596.0529877762672, -1105.921124790627, -421.51878279818334, -510.2225879730825, -54.13693170725855, -1378.9087542042964, -6.159986314359592, -1063.638026177562, -1076.3811649738814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549981155936551, "mean_inference_ms": 1.7122993987859625, "mean_action_processing_ms": 0.27656855125671786, "mean_env_wait_ms": 3.5632463138635417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0116729736328125, "StateBufferConnector_ms": 0.007843971252441406, "ViewRequirementAgentConnector_ms": 0.18809151649475098}, "num_episodes": 33, "episode_return_max": -6.159986314359592, "episode_return_min": -1621.9598619325598, "episode_return_mean": -621.8652692057644, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.17253048943917, "num_env_steps_trained_throughput_per_sec": 305.17253048943917, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12793.068, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12792.993, "sample_time_ms": 1154.955, "learn_time_ms": 11569.285, "learn_throughput": 345.743, "synch_weights_time_ms": 67.837}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00016", "date": "2024-08-04_07-01-54", "timestamp": 1722735114, "time_this_iter_s": 13.121380090713501, "time_total_s": 318.9708979129791, "pid": 593821, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e36d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.9708979129791, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.384210526315787, "ram_util_percent": 28.110526315789475}}
