{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0943672148821255, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.557436754306158, "policy_loss": -0.004931630692832793, "vf_loss": 9.575122042496998, "vf_explained_var": 0.03685093590368827, "kl": 0.007033914309613465, "entropy": 1.4160443253815174, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -53.28700477798321, "episode_reward_min": -1282.7132221051538, "episode_reward_mean": -744.1861814722619, "episode_len_mean": 127.26086956521739, "episode_media": {}, "episodes_timesteps_total": 2927, "policy_reward_min": {"policy_0": -1282.7132221051538}, "policy_reward_max": {"policy_0": -53.28700477798321}, "policy_reward_mean": {"policy_0": -744.1861814722619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.25298991132203, -1087.3341633704401, -243.68660850097731, -1063.0342024546374, -990.8061890080679, -520.2578898730953, -1146.485477930269, -712.6967421424864, -1282.7132221051538, -340.6394192558152, -1277.356733979341, -53.28700477798321, -1088.9520602213172, -956.5204443643349, -1110.6304371371066, -303.5438441689417, -774.7428981534564, -1145.194001481842, -1047.7551163512164, -454.1341446075135, -693.5013658362712, -248.47701214883674, -389.2802060815986], "episode_lengths": [66, 150, 86, 150, 150, 119, 150, 139, 150, 108, 150, 55, 150, 150, 150, 78, 150, 150, 150, 142, 150, 84, 100], "policy_policy_0_reward": [-185.25298991132203, -1087.3341633704401, -243.68660850097731, -1063.0342024546374, -990.8061890080679, -520.2578898730953, -1146.485477930269, -712.6967421424864, -1282.7132221051538, -340.6394192558152, -1277.356733979341, -53.28700477798321, -1088.9520602213172, -956.5204443643349, -1110.6304371371066, -303.5438441689417, -774.7428981534564, -1145.194001481842, -1047.7551163512164, -454.1341446075135, -693.5013658362712, -248.47701214883674, -389.2802060815986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5614720846538226, "mean_inference_ms": 1.663003221112723, "mean_action_processing_ms": 0.2756127792345326, "mean_env_wait_ms": 3.3806249478682555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012440266816512398, "StateBufferConnector_ms": 0.008113487907077955, "ViewRequirementAgentConnector_ms": 0.18040408258852753}, "num_episodes": 23, "episode_return_max": -53.28700477798321, "episode_return_min": -1282.7132221051538, "episode_return_mean": -744.1861814722619, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.99704687220236, "num_env_steps_trained_throughput_per_sec": 402.99704687220236, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9925.641, "restore_workers_time_ms": 0.024, "training_step_time_ms": 9925.577, "sample_time_ms": 1110.149, "learn_time_ms": 8740.467, "learn_throughput": 457.641, "synch_weights_time_ms": 74.088}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00014", "date": "2024-08-04_06-45-42", "timestamp": 1722734142, "time_this_iter_s": 9.93757152557373, "time_total_s": 9.93757152557373, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370992050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9.93757152557373, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 19.09333333333333, "ram_util_percent": 27.986666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7631589716300369, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.386074569821357, "policy_loss": -0.007120571878234235, "vf_loss": 9.404734282692273, "vf_explained_var": 0.1027768819903334, "kl": 0.011747209477819827, "entropy": 1.3888612958292166, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -53.28700477798321, "episode_reward_min": -1399.2851621586121, "episode_reward_mean": -681.777814808025, "episode_len_mean": 119.50943396226415, "episode_media": {}, "episodes_timesteps_total": 6334, "policy_reward_min": {"policy_0": -1399.2851621586121}, "policy_reward_max": {"policy_0": -53.28700477798321}, "policy_reward_mean": {"policy_0": -681.777814808025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.25298991132203, -1087.3341633704401, -243.68660850097731, -1063.0342024546374, -990.8061890080679, -520.2578898730953, -1146.485477930269, -712.6967421424864, -1282.7132221051538, -340.6394192558152, -1277.356733979341, -53.28700477798321, -1088.9520602213172, -956.5204443643349, -1110.6304371371066, -303.5438441689417, -774.7428981534564, -1145.194001481842, -1047.7551163512164, -454.1341446075135, -693.5013658362712, -248.47701214883674, -389.2802060815986, -1251.6518849008457, -1227.5090595500417, -1399.2851621586121, -253.0772608484286, -157.6013678130158, -940.2887118865248, -905.4073345386504, -226.80413788335525, -426.97036538958554, -284.160010905374, -322.33537385514245, -937.2390782197898, -1165.3082438894235, -836.1938337712498, -188.09477462406377, -72.20738563050755, -416.8773978360643, -1203.6966519560115, -1052.77966138357, -127.14825996417177, -107.43981133128922, -89.19703556026548, -227.16706062181643, -1133.5860441319414, -817.0108586409306, -758.284490042488, -1065.0394455759974, -79.9025512495808, -195.13974898314518, -1150.5390078214286], "episode_lengths": [66, 150, 86, 150, 150, 119, 150, 139, 150, 108, 150, 55, 150, 150, 150, 78, 150, 150, 150, 142, 150, 84, 100, 150, 150, 150, 72, 64, 150, 150, 75, 115, 103, 97, 150, 150, 150, 87, 60, 107, 150, 150, 67, 60, 57, 72, 150, 150, 150, 150, 42, 79, 150], "policy_policy_0_reward": [-185.25298991132203, -1087.3341633704401, -243.68660850097731, -1063.0342024546374, -990.8061890080679, -520.2578898730953, -1146.485477930269, -712.6967421424864, -1282.7132221051538, -340.6394192558152, -1277.356733979341, -53.28700477798321, -1088.9520602213172, -956.5204443643349, -1110.6304371371066, -303.5438441689417, -774.7428981534564, -1145.194001481842, -1047.7551163512164, -454.1341446075135, -693.5013658362712, -248.47701214883674, -389.2802060815986, -1251.6518849008457, -1227.5090595500417, -1399.2851621586121, -253.0772608484286, -157.6013678130158, -940.2887118865248, -905.4073345386504, -226.80413788335525, -426.97036538958554, -284.160010905374, -322.33537385514245, -937.2390782197898, -1165.3082438894235, -836.1938337712498, -188.09477462406377, -72.20738563050755, -416.8773978360643, -1203.6966519560115, -1052.77966138357, -127.14825996417177, -107.43981133128922, -89.19703556026548, -227.16706062181643, -1133.5860441319414, -817.0108586409306, -758.284490042488, -1065.0394455759974, -79.9025512495808, -195.13974898314518, -1150.5390078214286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632432816922787, "mean_inference_ms": 1.6729761180867742, "mean_action_processing_ms": 0.27693705326803897, "mean_env_wait_ms": 3.3940362000215223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01340947061214807, "StateBufferConnector_ms": 0.008372540743845814, "ViewRequirementAgentConnector_ms": 0.19330753470366857}, "num_episodes": 30, "episode_return_max": -53.28700477798321, "episode_return_min": -1399.2851621586121, "episode_return_mean": -681.777814808025, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.2325797048327, "num_env_steps_trained_throughput_per_sec": 307.2325797048327, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11472.553, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11472.484, "sample_time_ms": 1132.47, "learn_time_ms": 10265.346, "learn_throughput": 389.661, "synch_weights_time_ms": 73.846}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00014", "date": "2024-08-04_06-45-55", "timestamp": 1722734155, "time_this_iter_s": 13.031709432601929, "time_total_s": 22.96928095817566, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22.96928095817566, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.438888888888894, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.561921982591351, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.339376706878344, "policy_loss": -0.010689923683821689, "vf_loss": 9.360906252264977, "vf_explained_var": 0.1650827456265688, "kl": 0.01639845691674206, "entropy": 1.411932040999333, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -25.98763522576654, "episode_reward_min": -1399.2851621586121, "episode_reward_mean": -707.4308525180154, "episode_len_mean": 122.72619047619048, "episode_media": {}, "episodes_timesteps_total": 10309, "policy_reward_min": {"policy_0": -1399.2851621586121}, "policy_reward_max": {"policy_0": -25.98763522576654}, "policy_reward_mean": {"policy_0": -707.4308525180154}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.25298991132203, -1087.3341633704401, -243.68660850097731, -1063.0342024546374, -990.8061890080679, -520.2578898730953, -1146.485477930269, -712.6967421424864, -1282.7132221051538, -340.6394192558152, -1277.356733979341, -53.28700477798321, -1088.9520602213172, -956.5204443643349, -1110.6304371371066, -303.5438441689417, -774.7428981534564, -1145.194001481842, -1047.7551163512164, -454.1341446075135, -693.5013658362712, -248.47701214883674, -389.2802060815986, -1251.6518849008457, -1227.5090595500417, -1399.2851621586121, -253.0772608484286, -157.6013678130158, -940.2887118865248, -905.4073345386504, -226.80413788335525, -426.97036538958554, -284.160010905374, -322.33537385514245, -937.2390782197898, -1165.3082438894235, -836.1938337712498, -188.09477462406377, -72.20738563050755, -416.8773978360643, -1203.6966519560115, -1052.77966138357, -127.14825996417177, -107.43981133128922, -89.19703556026548, -227.16706062181643, -1133.5860441319414, -817.0108586409306, -758.284490042488, -1065.0394455759974, -79.9025512495808, -195.13974898314518, -1150.5390078214286, -991.6082484558929, -142.34968195047068, -86.18755451584494, -870.954312105403, -1170.70333960228, -202.87552929221613, -186.76198991217012, -679.1230568974772, -25.98763522576654, -1261.2259016793191, -106.3875241014578, -806.8057117218785, -1186.2337908027519, -429.3721526690697, -495.20518061781996, -1076.2133977358146, -1220.8237926745278, -667.5367327638214, -915.0936388229654, -827.9390798801805, -638.713229988186, -1128.154883394951, -245.74116617195656, -980.2206179943598, -1040.8182805364684, -1167.3517704384942, -999.7103544210012, -1261.7460230414106, -1105.930645701892, -1054.753121941911, -317.43908163020603], "episode_lengths": [66, 150, 86, 150, 150, 119, 150, 139, 150, 108, 150, 55, 150, 150, 150, 78, 150, 150, 150, 142, 150, 84, 100, 150, 150, 150, 72, 64, 150, 150, 75, 115, 103, 97, 150, 150, 150, 87, 60, 107, 150, 150, 67, 60, 57, 72, 150, 150, 150, 150, 42, 79, 150, 150, 69, 62, 150, 150, 83, 87, 150, 50, 150, 48, 150, 150, 141, 106, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 103], "policy_policy_0_reward": [-185.25298991132203, -1087.3341633704401, -243.68660850097731, -1063.0342024546374, -990.8061890080679, -520.2578898730953, -1146.485477930269, -712.6967421424864, -1282.7132221051538, -340.6394192558152, -1277.356733979341, -53.28700477798321, -1088.9520602213172, -956.5204443643349, -1110.6304371371066, -303.5438441689417, -774.7428981534564, -1145.194001481842, -1047.7551163512164, -454.1341446075135, -693.5013658362712, -248.47701214883674, -389.2802060815986, -1251.6518849008457, -1227.5090595500417, -1399.2851621586121, -253.0772608484286, -157.6013678130158, -940.2887118865248, -905.4073345386504, -226.80413788335525, -426.97036538958554, -284.160010905374, -322.33537385514245, -937.2390782197898, -1165.3082438894235, -836.1938337712498, -188.09477462406377, -72.20738563050755, -416.8773978360643, -1203.6966519560115, -1052.77966138357, -127.14825996417177, -107.43981133128922, -89.19703556026548, -227.16706062181643, -1133.5860441319414, -817.0108586409306, -758.284490042488, -1065.0394455759974, -79.9025512495808, -195.13974898314518, -1150.5390078214286, -991.6082484558929, -142.34968195047068, -86.18755451584494, -870.954312105403, -1170.70333960228, -202.87552929221613, -186.76198991217012, -679.1230568974772, -25.98763522576654, -1261.2259016793191, -106.3875241014578, -806.8057117218785, -1186.2337908027519, -429.3721526690697, -495.20518061781996, -1076.2133977358146, -1220.8237926745278, -667.5367327638214, -915.0936388229654, -827.9390798801805, -638.713229988186, -1128.154883394951, -245.74116617195656, -980.2206179943598, -1040.8182805364684, -1167.3517704384942, -999.7103544210012, -1261.7460230414106, -1105.930645701892, -1054.753121941911, -317.43908163020603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5626866323775344, "mean_inference_ms": 1.6784975762230563, "mean_action_processing_ms": 0.2782390218192171, "mean_env_wait_ms": 3.4042953192886127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013468095234462194, "StateBufferConnector_ms": 0.0084425721849714, "ViewRequirementAgentConnector_ms": 0.19260957127525694}, "num_episodes": 31, "episode_return_max": -25.98763522576654, "episode_return_min": -1399.2851621586121, "episode_return_mean": -707.4308525180154, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4543948671885, "num_env_steps_trained_throughput_per_sec": 307.4543948671885, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11985.059, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11984.992, "sample_time_ms": 1128.864, "learn_time_ms": 10787.046, "learn_throughput": 370.815, "synch_weights_time_ms": 68.28}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00014", "date": "2024-08-04_06-46-08", "timestamp": 1722734168, "time_this_iter_s": 13.023079872131348, "time_total_s": 35.99236083030701, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 35.99236083030701, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.3, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.301916323726376, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.730064044396082, "policy_loss": -0.01357298713895337, "vf_loss": 8.75386376529932, "vf_explained_var": 0.2931022341052691, "kl": 0.017391059614540915, "entropy": 1.37049065704147, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -25.98763522576654, "episode_reward_min": -1410.0651625742544, "episode_reward_mean": -739.2145422805512, "episode_len_mean": 126.79, "episode_media": {}, "episodes_timesteps_total": 12679, "policy_reward_min": {"policy_0": -1410.0651625742544}, "policy_reward_max": {"policy_0": -25.98763522576654}, "policy_reward_mean": {"policy_0": -739.2145422805512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1088.9520602213172, -956.5204443643349, -1110.6304371371066, -303.5438441689417, -774.7428981534564, -1145.194001481842, -1047.7551163512164, -454.1341446075135, -693.5013658362712, -248.47701214883674, -389.2802060815986, -1251.6518849008457, -1227.5090595500417, -1399.2851621586121, -253.0772608484286, -157.6013678130158, -940.2887118865248, -905.4073345386504, -226.80413788335525, -426.97036538958554, -284.160010905374, -322.33537385514245, -937.2390782197898, -1165.3082438894235, -836.1938337712498, -188.09477462406377, -72.20738563050755, -416.8773978360643, -1203.6966519560115, -1052.77966138357, -127.14825996417177, -107.43981133128922, -89.19703556026548, -227.16706062181643, -1133.5860441319414, -817.0108586409306, -758.284490042488, -1065.0394455759974, -79.9025512495808, -195.13974898314518, -1150.5390078214286, -991.6082484558929, -142.34968195047068, -86.18755451584494, -870.954312105403, -1170.70333960228, -202.87552929221613, -186.76198991217012, -679.1230568974772, -25.98763522576654, -1261.2259016793191, -106.3875241014578, -806.8057117218785, -1186.2337908027519, -429.3721526690697, -495.20518061781996, -1076.2133977358146, -1220.8237926745278, -667.5367327638214, -915.0936388229654, -827.9390798801805, -638.713229988186, -1128.154883394951, -245.74116617195656, -980.2206179943598, -1040.8182805364684, -1167.3517704384942, -999.7103544210012, -1261.7460230414106, -1105.930645701892, -1054.753121941911, -317.43908163020603, -1088.3209858939351, -925.8335442567151, -910.2467836449113, -355.75618950597874, -1410.0651625742544, -1079.5248654072798, -1321.9081577921427, -456.07873757572037, -751.9784397541849, -1094.428586065684, -1056.998540445827, -1033.1173652388695, -228.3585112684364, -364.64184289688427, -97.52707319992183, -683.0267812713587, -1097.831722188697, -1226.1038971663158, -916.7402786575233, -721.9849780583528, -835.9861215326831, -943.5519601911227, -188.6403713210734, -1116.3270588921928, -919.4419679847776, -987.8155517409768, -464.1504444554248, -1124.4273408701592], "episode_lengths": [150, 150, 150, 78, 150, 150, 150, 142, 150, 84, 100, 150, 150, 150, 72, 64, 150, 150, 75, 115, 103, 97, 150, 150, 150, 87, 60, 107, 150, 150, 67, 60, 57, 72, 150, 150, 150, 150, 42, 79, 150, 150, 69, 62, 150, 150, 83, 87, 150, 50, 150, 48, 150, 150, 141, 106, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 96, 150, 150, 150, 139, 150, 150, 150, 150, 71, 124, 78, 150, 150, 150, 150, 150, 143, 150, 75, 150, 150, 150, 117, 150], "policy_policy_0_reward": [-1088.9520602213172, -956.5204443643349, -1110.6304371371066, -303.5438441689417, -774.7428981534564, -1145.194001481842, -1047.7551163512164, -454.1341446075135, -693.5013658362712, -248.47701214883674, -389.2802060815986, -1251.6518849008457, -1227.5090595500417, -1399.2851621586121, -253.0772608484286, -157.6013678130158, -940.2887118865248, -905.4073345386504, -226.80413788335525, -426.97036538958554, -284.160010905374, -322.33537385514245, -937.2390782197898, -1165.3082438894235, -836.1938337712498, -188.09477462406377, -72.20738563050755, -416.8773978360643, -1203.6966519560115, -1052.77966138357, -127.14825996417177, -107.43981133128922, -89.19703556026548, -227.16706062181643, -1133.5860441319414, -817.0108586409306, -758.284490042488, -1065.0394455759974, -79.9025512495808, -195.13974898314518, -1150.5390078214286, -991.6082484558929, -142.34968195047068, -86.18755451584494, -870.954312105403, -1170.70333960228, -202.87552929221613, -186.76198991217012, -679.1230568974772, -25.98763522576654, -1261.2259016793191, -106.3875241014578, -806.8057117218785, -1186.2337908027519, -429.3721526690697, -495.20518061781996, -1076.2133977358146, -1220.8237926745278, -667.5367327638214, -915.0936388229654, -827.9390798801805, -638.713229988186, -1128.154883394951, -245.74116617195656, -980.2206179943598, -1040.8182805364684, -1167.3517704384942, -999.7103544210012, -1261.7460230414106, -1105.930645701892, -1054.753121941911, -317.43908163020603, -1088.3209858939351, -925.8335442567151, -910.2467836449113, -355.75618950597874, -1410.0651625742544, -1079.5248654072798, -1321.9081577921427, -456.07873757572037, -751.9784397541849, -1094.428586065684, -1056.998540445827, -1033.1173652388695, -228.3585112684364, -364.64184289688427, -97.52707319992183, -683.0267812713587, -1097.831722188697, -1226.1038971663158, -916.7402786575233, -721.9849780583528, -835.9861215326831, -943.5519601911227, -188.6403713210734, -1116.3270588921928, -919.4419679847776, -987.8155517409768, -464.1504444554248, -1124.4273408701592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624813535145803, "mean_inference_ms": 1.6827501567888958, "mean_action_processing_ms": 0.2797597741710302, "mean_env_wait_ms": 3.4136746729122063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013736486434936523, "StateBufferConnector_ms": 0.008575439453125, "ViewRequirementAgentConnector_ms": 0.19508647918701172}, "num_episodes": 28, "episode_return_max": -25.98763522576654, "episode_return_min": -1410.0651625742544, "episode_return_mean": -739.2145422805512, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.01860770168264, "num_env_steps_trained_throughput_per_sec": 309.01860770168264, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12224.848, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12224.781, "sample_time_ms": 1129.947, "learn_time_ms": 11028.27, "learn_throughput": 362.704, "synch_weights_time_ms": 65.766}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00014", "date": "2024-08-04_06-46-21", "timestamp": 1722734181, "time_this_iter_s": 12.955768346786499, "time_total_s": 48.948129177093506, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 48.948129177093506, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.62222222222222, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.472431300083795, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.532393123209476, "policy_loss": -0.007111774127891598, "vf_loss": 7.551258551577727, "vf_explained_var": 0.5588455138728022, "kl": 0.011332337847428183, "entropy": 1.4020092920710643, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -25.98763522576654, "episode_reward_min": -1410.0651625742544, "episode_reward_mean": -759.9629992907234, "episode_len_mean": 131.67, "episode_media": {}, "episodes_timesteps_total": 13167, "policy_reward_min": {"policy_0": -1410.0651625742544}, "policy_reward_max": {"policy_0": -25.98763522576654}, "policy_reward_mean": {"policy_0": -759.9629992907234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.16706062181643, -1133.5860441319414, -817.0108586409306, -758.284490042488, -1065.0394455759974, -79.9025512495808, -195.13974898314518, -1150.5390078214286, -991.6082484558929, -142.34968195047068, -86.18755451584494, -870.954312105403, -1170.70333960228, -202.87552929221613, -186.76198991217012, -679.1230568974772, -25.98763522576654, -1261.2259016793191, -106.3875241014578, -806.8057117218785, -1186.2337908027519, -429.3721526690697, -495.20518061781996, -1076.2133977358146, -1220.8237926745278, -667.5367327638214, -915.0936388229654, -827.9390798801805, -638.713229988186, -1128.154883394951, -245.74116617195656, -980.2206179943598, -1040.8182805364684, -1167.3517704384942, -999.7103544210012, -1261.7460230414106, -1105.930645701892, -1054.753121941911, -317.43908163020603, -1088.3209858939351, -925.8335442567151, -910.2467836449113, -355.75618950597874, -1410.0651625742544, -1079.5248654072798, -1321.9081577921427, -456.07873757572037, -751.9784397541849, -1094.428586065684, -1056.998540445827, -1033.1173652388695, -228.3585112684364, -364.64184289688427, -97.52707319992183, -683.0267812713587, -1097.831722188697, -1226.1038971663158, -916.7402786575233, -721.9849780583528, -835.9861215326831, -943.5519601911227, -188.6403713210734, -1116.3270588921928, -919.4419679847776, -987.8155517409768, -464.1504444554248, -1124.4273408701592, -1241.190794904971, -902.3302054707827, -1159.8624110467579, -692.6972636879404, -159.04922219142605, -557.9429766286423, -1253.3673799165788, -1175.9936407117864, -816.6306915678076, -837.3588479139296, -511.97076449163586, -508.68701863218877, -314.1810828392976, -1158.265331482714, -524.1176910093055, -1132.466795577004, -514.1914253530192, -1136.1016439783045, -788.422656740672, -86.16081025126061, -170.8024777639301, -136.78089043406104, -858.2460300750454, -1004.0332409065651, -879.2070144748495, -544.045699602248, -263.88931190674657, -788.9844244359983, -1106.6601464738378, -973.8898831179775, -913.3558943957391, -447.43007913761716, -320.53628834500614], "episode_lengths": [72, 150, 150, 150, 150, 42, 79, 150, 150, 69, 62, 150, 150, 83, 87, 150, 50, 150, 48, 150, 150, 141, 106, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 96, 150, 150, 150, 139, 150, 150, 150, 150, 71, 124, 78, 150, 150, 150, 150, 150, 143, 150, 75, 150, 150, 150, 117, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 148, 116, 150, 150, 150, 114, 150, 141, 150, 150, 56, 60, 68, 150, 150, 150, 150, 106, 150, 150, 150, 150, 141, 90], "policy_policy_0_reward": [-227.16706062181643, -1133.5860441319414, -817.0108586409306, -758.284490042488, -1065.0394455759974, -79.9025512495808, -195.13974898314518, -1150.5390078214286, -991.6082484558929, -142.34968195047068, -86.18755451584494, -870.954312105403, -1170.70333960228, -202.87552929221613, -186.76198991217012, -679.1230568974772, -25.98763522576654, -1261.2259016793191, -106.3875241014578, -806.8057117218785, -1186.2337908027519, -429.3721526690697, -495.20518061781996, -1076.2133977358146, -1220.8237926745278, -667.5367327638214, -915.0936388229654, -827.9390798801805, -638.713229988186, -1128.154883394951, -245.74116617195656, -980.2206179943598, -1040.8182805364684, -1167.3517704384942, -999.7103544210012, -1261.7460230414106, -1105.930645701892, -1054.753121941911, -317.43908163020603, -1088.3209858939351, -925.8335442567151, -910.2467836449113, -355.75618950597874, -1410.0651625742544, -1079.5248654072798, -1321.9081577921427, -456.07873757572037, -751.9784397541849, -1094.428586065684, -1056.998540445827, -1033.1173652388695, -228.3585112684364, -364.64184289688427, -97.52707319992183, -683.0267812713587, -1097.831722188697, -1226.1038971663158, -916.7402786575233, -721.9849780583528, -835.9861215326831, -943.5519601911227, -188.6403713210734, -1116.3270588921928, -919.4419679847776, -987.8155517409768, -464.1504444554248, -1124.4273408701592, -1241.190794904971, -902.3302054707827, -1159.8624110467579, -692.6972636879404, -159.04922219142605, -557.9429766286423, -1253.3673799165788, -1175.9936407117864, -816.6306915678076, -837.3588479139296, -511.97076449163586, -508.68701863218877, -314.1810828392976, -1158.265331482714, -524.1176910093055, -1132.466795577004, -514.1914253530192, -1136.1016439783045, -788.422656740672, -86.16081025126061, -170.8024777639301, -136.78089043406104, -858.2460300750454, -1004.0332409065651, -879.2070144748495, -544.045699602248, -263.88931190674657, -788.9844244359983, -1106.6601464738378, -973.8898831179775, -913.3558943957391, -447.43007913761716, -320.53628834500614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5605144089148442, "mean_inference_ms": 1.6810127864448772, "mean_action_processing_ms": 0.28049704792432684, "mean_env_wait_ms": 3.418606147051146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01357722282409668, "StateBufferConnector_ms": 0.008591413497924805, "ViewRequirementAgentConnector_ms": 0.19487643241882324}, "num_episodes": 33, "episode_return_max": -25.98763522576654, "episode_return_min": -1410.0651625742544, "episode_return_mean": -759.9629992907234, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.27122357244133, "num_env_steps_trained_throughput_per_sec": 301.27122357244133, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12435.295, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12435.228, "sample_time_ms": 1129.322, "learn_time_ms": 11234.954, "learn_throughput": 356.032, "synch_weights_time_ms": 70.161}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00014", "date": "2024-08-04_06-46-35", "timestamp": 1722734195, "time_this_iter_s": 13.289201974868774, "time_total_s": 62.23733115196228, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.23733115196228, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.152631578947368, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.36150362988313, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.610126176973184, "policy_loss": -0.01105365017914058, "vf_loss": 6.631848602493604, "vf_explained_var": 0.6980706534658869, "kl": 0.01682169335981598, "entropy": 1.4033120761315028, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -34.02889534116117, "episode_reward_min": -1410.0651625742544, "episode_reward_mean": -729.6053119691865, "episode_len_mean": 130.46, "episode_media": {}, "episodes_timesteps_total": 13046, "policy_reward_min": {"policy_0": -1410.0651625742544}, "policy_reward_max": {"policy_0": -34.02889534116117}, "policy_reward_mean": {"policy_0": -729.6053119691865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1167.3517704384942, -999.7103544210012, -1261.7460230414106, -1105.930645701892, -1054.753121941911, -317.43908163020603, -1088.3209858939351, -925.8335442567151, -910.2467836449113, -355.75618950597874, -1410.0651625742544, -1079.5248654072798, -1321.9081577921427, -456.07873757572037, -751.9784397541849, -1094.428586065684, -1056.998540445827, -1033.1173652388695, -228.3585112684364, -364.64184289688427, -97.52707319992183, -683.0267812713587, -1097.831722188697, -1226.1038971663158, -916.7402786575233, -721.9849780583528, -835.9861215326831, -943.5519601911227, -188.6403713210734, -1116.3270588921928, -919.4419679847776, -987.8155517409768, -464.1504444554248, -1124.4273408701592, -1241.190794904971, -902.3302054707827, -1159.8624110467579, -692.6972636879404, -159.04922219142605, -557.9429766286423, -1253.3673799165788, -1175.9936407117864, -816.6306915678076, -837.3588479139296, -511.97076449163586, -508.68701863218877, -314.1810828392976, -1158.265331482714, -524.1176910093055, -1132.466795577004, -514.1914253530192, -1136.1016439783045, -788.422656740672, -86.16081025126061, -170.8024777639301, -136.78089043406104, -858.2460300750454, -1004.0332409065651, -879.2070144748495, -544.045699602248, -263.88931190674657, -788.9844244359983, -1106.6601464738378, -973.8898831179775, -913.3558943957391, -447.43007913761716, -320.53628834500614, -317.75402534829783, -278.2043651607356, -34.02889534116117, -664.428227019862, -308.7761024759958, -1272.4509738378142, -333.1732625853882, -111.98013687976251, -1226.6461982087428, -352.44575218115517, -1153.504111174444, -938.2457373301886, -65.92784795762253, -422.9874644263812, -385.95046931495904, -93.89004603368333, -250.53126672325467, -425.16537253142707, -553.7744674673053, -832.5460911201202, -1173.8474355027104, -850.1713055891353, -554.5777662460899, -604.806909750459, -1199.5190513480197, -168.4763428293564, -1013.1246494218805, -312.4554555172576, -908.4561492912214, -1041.1697366367694, -94.83655513159948, -512.3599183192849, -1317.7248157245942], "episode_lengths": [150, 150, 150, 150, 150, 103, 150, 150, 150, 96, 150, 150, 150, 139, 150, 150, 150, 150, 71, 124, 78, 150, 150, 150, 150, 150, 143, 150, 75, 150, 150, 150, 117, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 148, 116, 150, 150, 150, 114, 150, 141, 150, 150, 56, 60, 68, 150, 150, 150, 150, 106, 150, 150, 150, 150, 141, 90, 77, 90, 48, 150, 114, 150, 141, 68, 150, 124, 150, 150, 41, 102, 145, 79, 80, 138, 150, 150, 150, 150, 114, 150, 150, 63, 150, 104, 150, 150, 61, 105, 150], "policy_policy_0_reward": [-1167.3517704384942, -999.7103544210012, -1261.7460230414106, -1105.930645701892, -1054.753121941911, -317.43908163020603, -1088.3209858939351, -925.8335442567151, -910.2467836449113, -355.75618950597874, -1410.0651625742544, -1079.5248654072798, -1321.9081577921427, -456.07873757572037, -751.9784397541849, -1094.428586065684, -1056.998540445827, -1033.1173652388695, -228.3585112684364, -364.64184289688427, -97.52707319992183, -683.0267812713587, -1097.831722188697, -1226.1038971663158, -916.7402786575233, -721.9849780583528, -835.9861215326831, -943.5519601911227, -188.6403713210734, -1116.3270588921928, -919.4419679847776, -987.8155517409768, -464.1504444554248, -1124.4273408701592, -1241.190794904971, -902.3302054707827, -1159.8624110467579, -692.6972636879404, -159.04922219142605, -557.9429766286423, -1253.3673799165788, -1175.9936407117864, -816.6306915678076, -837.3588479139296, -511.97076449163586, -508.68701863218877, -314.1810828392976, -1158.265331482714, -524.1176910093055, -1132.466795577004, -514.1914253530192, -1136.1016439783045, -788.422656740672, -86.16081025126061, -170.8024777639301, -136.78089043406104, -858.2460300750454, -1004.0332409065651, -879.2070144748495, -544.045699602248, -263.88931190674657, -788.9844244359983, -1106.6601464738378, -973.8898831179775, -913.3558943957391, -447.43007913761716, -320.53628834500614, -317.75402534829783, -278.2043651607356, -34.02889534116117, -664.428227019862, -308.7761024759958, -1272.4509738378142, -333.1732625853882, -111.98013687976251, -1226.6461982087428, -352.44575218115517, -1153.504111174444, -938.2457373301886, -65.92784795762253, -422.9874644263812, -385.95046931495904, -93.89004603368333, -250.53126672325467, -425.16537253142707, -553.7744674673053, -832.5460911201202, -1173.8474355027104, -850.1713055891353, -554.5777662460899, -604.806909750459, -1199.5190513480197, -168.4763428293564, -1013.1246494218805, -312.4554555172576, -908.4561492912214, -1041.1697366367694, -94.83655513159948, -512.3599183192849, -1317.7248157245942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589890957891741, "mean_inference_ms": 1.6838602468992105, "mean_action_processing_ms": 0.28168988707991405, "mean_env_wait_ms": 3.4318728405587557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013638496398925781, "StateBufferConnector_ms": 0.008649587631225586, "ViewRequirementAgentConnector_ms": 0.19203996658325195}, "num_episodes": 33, "episode_return_max": -34.02889534116117, "episode_return_min": -1410.0651625742544, "episode_return_mean": -729.6053119691865, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.82934888807375, "num_env_steps_trained_throughput_per_sec": 296.82934888807375, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12608.707, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12608.64, "sample_time_ms": 1149.674, "learn_time_ms": 11389.304, "learn_throughput": 351.207, "synch_weights_time_ms": 68.874}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00014", "date": "2024-08-04_06-46-48", "timestamp": 1722734208, "time_this_iter_s": 13.489267587661743, "time_total_s": 75.72659873962402, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708791b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.72659873962402, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.38421052631579, "ram_util_percent": 28.07368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 61.12676519254843, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.037888446450234, "policy_loss": -0.01205268083140254, "vf_loss": 6.060882670183976, "vf_explained_var": 0.7938818301384648, "kl": 0.01696200674417318, "entropy": 1.4333955862869818, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -21.301473476799668, "episode_reward_min": -1370.1596892360108, "episode_reward_mean": -695.2646939402933, "episode_len_mean": 127.48, "episode_media": {}, "episodes_timesteps_total": 12748, "policy_reward_min": {"policy_0": -1370.1596892360108}, "policy_reward_max": {"policy_0": -21.301473476799668}, "policy_reward_mean": {"policy_0": -695.2646939402933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-919.4419679847776, -987.8155517409768, -464.1504444554248, -1124.4273408701592, -1241.190794904971, -902.3302054707827, -1159.8624110467579, -692.6972636879404, -159.04922219142605, -557.9429766286423, -1253.3673799165788, -1175.9936407117864, -816.6306915678076, -837.3588479139296, -511.97076449163586, -508.68701863218877, -314.1810828392976, -1158.265331482714, -524.1176910093055, -1132.466795577004, -514.1914253530192, -1136.1016439783045, -788.422656740672, -86.16081025126061, -170.8024777639301, -136.78089043406104, -858.2460300750454, -1004.0332409065651, -879.2070144748495, -544.045699602248, -263.88931190674657, -788.9844244359983, -1106.6601464738378, -973.8898831179775, -913.3558943957391, -447.43007913761716, -320.53628834500614, -317.75402534829783, -278.2043651607356, -34.02889534116117, -664.428227019862, -308.7761024759958, -1272.4509738378142, -333.1732625853882, -111.98013687976251, -1226.6461982087428, -352.44575218115517, -1153.504111174444, -938.2457373301886, -65.92784795762253, -422.9874644263812, -385.95046931495904, -93.89004603368333, -250.53126672325467, -425.16537253142707, -553.7744674673053, -832.5460911201202, -1173.8474355027104, -850.1713055891353, -554.5777662460899, -604.806909750459, -1199.5190513480197, -168.4763428293564, -1013.1246494218805, -312.4554555172576, -908.4561492912214, -1041.1697366367694, -94.83655513159948, -512.3599183192849, -1317.7248157245942, -1187.6098652049268, -1017.6064632815871, -919.0442105761078, -1024.0337054210147, -1137.576169814047, -707.6516229540225, -1069.4708101879298, -820.3478443671513, -1105.1518412593368, -806.1207268845984, -996.0493700655857, -1370.1596892360108, -1136.8141950859017, -810.347686045941, -864.003420709884, -203.2899778193485, -301.741559179255, -251.20993861213157, -394.7754907333531, -356.7416155652879, -1105.9200600050665, -1156.353958420893, -21.301473476799668, -1331.0917477175497, -465.1570916986257, -77.38772039685563, -1103.1984861334522, -257.3704991494822, -227.54820646593498, -152.77170261759838], "episode_lengths": [150, 150, 117, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 148, 116, 150, 150, 150, 114, 150, 141, 150, 150, 56, 60, 68, 150, 150, 150, 150, 106, 150, 150, 150, 150, 141, 90, 77, 90, 48, 150, 114, 150, 141, 68, 150, 124, 150, 150, 41, 102, 145, 79, 80, 138, 150, 150, 150, 150, 114, 150, 150, 63, 150, 104, 150, 150, 61, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 110, 98, 127, 150, 150, 150, 41, 150, 98, 66, 150, 71, 91, 56], "policy_policy_0_reward": [-919.4419679847776, -987.8155517409768, -464.1504444554248, -1124.4273408701592, -1241.190794904971, -902.3302054707827, -1159.8624110467579, -692.6972636879404, -159.04922219142605, -557.9429766286423, -1253.3673799165788, -1175.9936407117864, -816.6306915678076, -837.3588479139296, -511.97076449163586, -508.68701863218877, -314.1810828392976, -1158.265331482714, -524.1176910093055, -1132.466795577004, -514.1914253530192, -1136.1016439783045, -788.422656740672, -86.16081025126061, -170.8024777639301, -136.78089043406104, -858.2460300750454, -1004.0332409065651, -879.2070144748495, -544.045699602248, -263.88931190674657, -788.9844244359983, -1106.6601464738378, -973.8898831179775, -913.3558943957391, -447.43007913761716, -320.53628834500614, -317.75402534829783, -278.2043651607356, -34.02889534116117, -664.428227019862, -308.7761024759958, -1272.4509738378142, -333.1732625853882, -111.98013687976251, -1226.6461982087428, -352.44575218115517, -1153.504111174444, -938.2457373301886, -65.92784795762253, -422.9874644263812, -385.95046931495904, -93.89004603368333, -250.53126672325467, -425.16537253142707, -553.7744674673053, -832.5460911201202, -1173.8474355027104, -850.1713055891353, -554.5777662460899, -604.806909750459, -1199.5190513480197, -168.4763428293564, -1013.1246494218805, -312.4554555172576, -908.4561492912214, -1041.1697366367694, -94.83655513159948, -512.3599183192849, -1317.7248157245942, -1187.6098652049268, -1017.6064632815871, -919.0442105761078, -1024.0337054210147, -1137.576169814047, -707.6516229540225, -1069.4708101879298, -820.3478443671513, -1105.1518412593368, -806.1207268845984, -996.0493700655857, -1370.1596892360108, -1136.8141950859017, -810.347686045941, -864.003420709884, -203.2899778193485, -301.741559179255, -251.20993861213157, -394.7754907333531, -356.7416155652879, -1105.9200600050665, -1156.353958420893, -21.301473476799668, -1331.0917477175497, -465.1570916986257, -77.38772039685563, -1103.1984861334522, -257.3704991494822, -227.54820646593498, -152.77170261759838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584600259685775, "mean_inference_ms": 1.6818481763684867, "mean_action_processing_ms": 0.28100058604857814, "mean_env_wait_ms": 3.4349070461841738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01335287094116211, "StateBufferConnector_ms": 0.008504867553710938, "ViewRequirementAgentConnector_ms": 0.19082236289978027}, "num_episodes": 30, "episode_return_max": -21.301473476799668, "episode_return_min": -1370.1596892360108, "episode_return_mean": -695.2646939402933, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.45899708656754, "num_env_steps_trained_throughput_per_sec": 310.45899708656754, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12648.058, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12647.991, "sample_time_ms": 1145.203, "learn_time_ms": 11432.686, "learn_throughput": 349.874, "synch_weights_time_ms": 69.31}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00014", "date": "2024-08-04_06-47-01", "timestamp": 1722734221, "time_this_iter_s": 12.898582935333252, "time_total_s": 88.62518167495728, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.62518167495728, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.147368421052636, "ram_util_percent": 28.094736842105267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.02714569667975, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.1312594349185625, "policy_loss": -0.01433906588354148, "vf_loss": 6.155998792250951, "vf_explained_var": 0.8404771381989121, "kl": 0.021075343778412994, "entropy": 1.4615359851469596, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -14.275342661345062, "episode_reward_min": -1416.842540592913, "episode_reward_mean": -654.7545547727176, "episode_len_mean": 121.61, "episode_media": {}, "episodes_timesteps_total": 12161, "policy_reward_min": {"policy_0": -1416.842540592913}, "policy_reward_max": {"policy_0": -14.275342661345062}, "policy_reward_mean": {"policy_0": -654.7545547727176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317.75402534829783, -278.2043651607356, -34.02889534116117, -664.428227019862, -308.7761024759958, -1272.4509738378142, -333.1732625853882, -111.98013687976251, -1226.6461982087428, -352.44575218115517, -1153.504111174444, -938.2457373301886, -65.92784795762253, -422.9874644263812, -385.95046931495904, -93.89004603368333, -250.53126672325467, -425.16537253142707, -553.7744674673053, -832.5460911201202, -1173.8474355027104, -850.1713055891353, -554.5777662460899, -604.806909750459, -1199.5190513480197, -168.4763428293564, -1013.1246494218805, -312.4554555172576, -908.4561492912214, -1041.1697366367694, -94.83655513159948, -512.3599183192849, -1317.7248157245942, -1187.6098652049268, -1017.6064632815871, -919.0442105761078, -1024.0337054210147, -1137.576169814047, -707.6516229540225, -1069.4708101879298, -820.3478443671513, -1105.1518412593368, -806.1207268845984, -996.0493700655857, -1370.1596892360108, -1136.8141950859017, -810.347686045941, -864.003420709884, -203.2899778193485, -301.741559179255, -251.20993861213157, -394.7754907333531, -356.7416155652879, -1105.9200600050665, -1156.353958420893, -21.301473476799668, -1331.0917477175497, -465.1570916986257, -77.38772039685563, -1103.1984861334522, -257.3704991494822, -227.54820646593498, -152.77170261759838, -140.00239163264422, -1319.7696689870877, -360.79360739307316, -90.34620747270407, -965.5669022467923, -894.9709238553795, -172.53813000840628, -1054.322289354168, -1353.5355505193945, -1299.89476637184, -35.05330195340966, -231.50176763655915, -676.5619933055949, -903.7629745758269, -946.2521129394044, -519.5389833707366, -161.01793709246746, -316.82416760371035, -1416.842540592913, -551.3665715647995, -951.8192265408502, -1316.6813756206948, -642.991070905178, -909.1343887009615, -587.3289051817392, -134.55092030908438, -1088.0592655177957, -115.18893898018725, -1076.4270771139993, -21.5121147739079, -188.72385609050673, -568.704347656033, -564.6006758947094, -520.9962049936098, -1125.4933427634435, -14.275342661345062, -86.72158157844748], "episode_lengths": [77, 90, 48, 150, 114, 150, 141, 68, 150, 124, 150, 150, 41, 102, 145, 79, 80, 138, 150, 150, 150, 150, 114, 150, 150, 63, 150, 104, 150, 150, 61, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 110, 98, 127, 150, 150, 150, 41, 150, 98, 66, 150, 71, 91, 56, 71, 150, 150, 45, 150, 150, 63, 150, 150, 150, 38, 79, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 117, 76, 150, 69, 150, 37, 80, 150, 150, 117, 150, 42, 43], "policy_policy_0_reward": [-317.75402534829783, -278.2043651607356, -34.02889534116117, -664.428227019862, -308.7761024759958, -1272.4509738378142, -333.1732625853882, -111.98013687976251, -1226.6461982087428, -352.44575218115517, -1153.504111174444, -938.2457373301886, -65.92784795762253, -422.9874644263812, -385.95046931495904, -93.89004603368333, -250.53126672325467, -425.16537253142707, -553.7744674673053, -832.5460911201202, -1173.8474355027104, -850.1713055891353, -554.5777662460899, -604.806909750459, -1199.5190513480197, -168.4763428293564, -1013.1246494218805, -312.4554555172576, -908.4561492912214, -1041.1697366367694, -94.83655513159948, -512.3599183192849, -1317.7248157245942, -1187.6098652049268, -1017.6064632815871, -919.0442105761078, -1024.0337054210147, -1137.576169814047, -707.6516229540225, -1069.4708101879298, -820.3478443671513, -1105.1518412593368, -806.1207268845984, -996.0493700655857, -1370.1596892360108, -1136.8141950859017, -810.347686045941, -864.003420709884, -203.2899778193485, -301.741559179255, -251.20993861213157, -394.7754907333531, -356.7416155652879, -1105.9200600050665, -1156.353958420893, -21.301473476799668, -1331.0917477175497, -465.1570916986257, -77.38772039685563, -1103.1984861334522, -257.3704991494822, -227.54820646593498, -152.77170261759838, -140.00239163264422, -1319.7696689870877, -360.79360739307316, -90.34620747270407, -965.5669022467923, -894.9709238553795, -172.53813000840628, -1054.322289354168, -1353.5355505193945, -1299.89476637184, -35.05330195340966, -231.50176763655915, -676.5619933055949, -903.7629745758269, -946.2521129394044, -519.5389833707366, -161.01793709246746, -316.82416760371035, -1416.842540592913, -551.3665715647995, -951.8192265408502, -1316.6813756206948, -642.991070905178, -909.1343887009615, -587.3289051817392, -134.55092030908438, -1088.0592655177957, -115.18893898018725, -1076.4270771139993, -21.5121147739079, -188.72385609050673, -568.704347656033, -564.6006758947094, -520.9962049936098, -1125.4933427634435, -14.275342661345062, -86.72158157844748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574538122409618, "mean_inference_ms": 1.6851656946485432, "mean_action_processing_ms": 0.28098646031167623, "mean_env_wait_ms": 3.4478642409065454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01280832290649414, "StateBufferConnector_ms": 0.008282661437988281, "ViewRequirementAgentConnector_ms": 0.1921858787536621}, "num_episodes": 37, "episode_return_max": -14.275342661345062, "episode_return_min": -1416.842540592913, "episode_return_mean": -654.7545547727176, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.1082999165561, "num_env_steps_trained_throughput_per_sec": 311.1082999165561, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12674.21, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12674.142, "sample_time_ms": 1142.668, "learn_time_ms": 11461.894, "learn_throughput": 348.982, "synch_weights_time_ms": 68.774}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00014", "date": "2024-08-04_06-47-14", "timestamp": 1722734234, "time_this_iter_s": 12.871931552886963, "time_total_s": 101.49711322784424, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080beb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.49711322784424, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.38888888888889, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.00099668900172, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.20754035115242, "policy_loss": -0.008217700132809114, "vf_loss": 5.225353909035523, "vf_explained_var": 0.8790578711157043, "kl": 0.01590598902603233, "entropy": 1.4367653830597797, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -5.974482381450892, "episode_reward_min": -1416.842540592913, "episode_reward_mean": -686.6937181084573, "episode_len_mean": 122.98, "episode_media": {}, "episodes_timesteps_total": 12298, "policy_reward_min": {"policy_0": -1416.842540592913}, "policy_reward_max": {"policy_0": -5.974482381450892}, "policy_reward_mean": {"policy_0": -686.6937181084573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.6098652049268, -1017.6064632815871, -919.0442105761078, -1024.0337054210147, -1137.576169814047, -707.6516229540225, -1069.4708101879298, -820.3478443671513, -1105.1518412593368, -806.1207268845984, -996.0493700655857, -1370.1596892360108, -1136.8141950859017, -810.347686045941, -864.003420709884, -203.2899778193485, -301.741559179255, -251.20993861213157, -394.7754907333531, -356.7416155652879, -1105.9200600050665, -1156.353958420893, -21.301473476799668, -1331.0917477175497, -465.1570916986257, -77.38772039685563, -1103.1984861334522, -257.3704991494822, -227.54820646593498, -152.77170261759838, -140.00239163264422, -1319.7696689870877, -360.79360739307316, -90.34620747270407, -965.5669022467923, -894.9709238553795, -172.53813000840628, -1054.322289354168, -1353.5355505193945, -1299.89476637184, -35.05330195340966, -231.50176763655915, -676.5619933055949, -903.7629745758269, -946.2521129394044, -519.5389833707366, -161.01793709246746, -316.82416760371035, -1416.842540592913, -551.3665715647995, -951.8192265408502, -1316.6813756206948, -642.991070905178, -909.1343887009615, -587.3289051817392, -134.55092030908438, -1088.0592655177957, -115.18893898018725, -1076.4270771139993, -21.5121147739079, -188.72385609050673, -568.704347656033, -564.6006758947094, -520.9962049936098, -1125.4933427634435, -14.275342661345062, -86.72158157844748, -321.0727061810877, -178.24262325582217, -817.0838785273406, -920.79807528545, -1079.17765341927, -909.0417060328688, -280.31795937412664, -1198.3093375730355, -929.2113942100773, -1032.2824463831985, -1176.2603713651367, -215.1860882902349, -825.5299446295494, -1254.4589854272012, -5.974482381450892, -100.66782769865726, -1066.48685072826, -791.2549429457237, -1081.3555214251876, -1082.202019266769, -468.3127115030172, -1233.8990918474663, -453.4370530256853, -674.5499295948317, -118.3705132865579, -752.1632456319732, -736.4705099074106, -1292.35125614661, -285.128052681893, -556.2168248501051, -964.726501448604, -98.87183547095867, -68.44089820509646], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 110, 98, 127, 150, 150, 150, 41, 150, 98, 66, 150, 71, 91, 56, 71, 150, 150, 45, 150, 150, 63, 150, 150, 150, 38, 79, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 117, 76, 150, 69, 150, 37, 80, 150, 150, 117, 150, 42, 43, 94, 67, 150, 150, 150, 150, 88, 150, 150, 150, 150, 70, 150, 150, 33, 73, 150, 150, 150, 150, 142, 150, 150, 132, 72, 150, 150, 150, 92, 108, 150, 51, 59], "policy_policy_0_reward": [-1187.6098652049268, -1017.6064632815871, -919.0442105761078, -1024.0337054210147, -1137.576169814047, -707.6516229540225, -1069.4708101879298, -820.3478443671513, -1105.1518412593368, -806.1207268845984, -996.0493700655857, -1370.1596892360108, -1136.8141950859017, -810.347686045941, -864.003420709884, -203.2899778193485, -301.741559179255, -251.20993861213157, -394.7754907333531, -356.7416155652879, -1105.9200600050665, -1156.353958420893, -21.301473476799668, -1331.0917477175497, -465.1570916986257, -77.38772039685563, -1103.1984861334522, -257.3704991494822, -227.54820646593498, -152.77170261759838, -140.00239163264422, -1319.7696689870877, -360.79360739307316, -90.34620747270407, -965.5669022467923, -894.9709238553795, -172.53813000840628, -1054.322289354168, -1353.5355505193945, -1299.89476637184, -35.05330195340966, -231.50176763655915, -676.5619933055949, -903.7629745758269, -946.2521129394044, -519.5389833707366, -161.01793709246746, -316.82416760371035, -1416.842540592913, -551.3665715647995, -951.8192265408502, -1316.6813756206948, -642.991070905178, -909.1343887009615, -587.3289051817392, -134.55092030908438, -1088.0592655177957, -115.18893898018725, -1076.4270771139993, -21.5121147739079, -188.72385609050673, -568.704347656033, -564.6006758947094, -520.9962049936098, -1125.4933427634435, -14.275342661345062, -86.72158157844748, -321.0727061810877, -178.24262325582217, -817.0838785273406, -920.79807528545, -1079.17765341927, -909.0417060328688, -280.31795937412664, -1198.3093375730355, -929.2113942100773, -1032.2824463831985, -1176.2603713651367, -215.1860882902349, -825.5299446295494, -1254.4589854272012, -5.974482381450892, -100.66782769865726, -1066.48685072826, -791.2549429457237, -1081.3555214251876, -1082.202019266769, -468.3127115030172, -1233.8990918474663, -453.4370530256853, -674.5499295948317, -118.3705132865579, -752.1632456319732, -736.4705099074106, -1292.35125614661, -285.128052681893, -556.2168248501051, -964.726501448604, -98.87183547095867, -68.44089820509646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556469221911044, "mean_inference_ms": 1.6812062888184727, "mean_action_processing_ms": 0.27939934888416074, "mean_env_wait_ms": 3.4473242779860174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012068748474121094, "StateBufferConnector_ms": 0.007937431335449219, "ViewRequirementAgentConnector_ms": 0.18966937065124512}, "num_episodes": 33, "episode_return_max": -5.974482381450892, "episode_return_min": -1416.842540592913, "episode_return_mean": -686.6937181084573, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.9576166983038, "num_env_steps_trained_throughput_per_sec": 319.9576166983038, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12655.038, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12654.97, "sample_time_ms": 1142.525, "learn_time_ms": 11444.507, "learn_throughput": 349.513, "synch_weights_time_ms": 67.138}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00014", "date": "2024-08-04_06-47-27", "timestamp": 1722734247, "time_this_iter_s": 12.512964487075806, "time_total_s": 114.01007771492004, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080ba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.01007771492004, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.694444444444443, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.76759292185307, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.614273182302713, "policy_loss": -0.016982868517031117, "vf_loss": 4.640511335680882, "vf_explained_var": 0.8887344111998876, "kl": 0.01867936183625717, "entropy": 1.4859099201858044, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -5.974482381450892, "episode_reward_min": -1416.842540592913, "episode_reward_mean": -681.0744327845055, "episode_len_mean": 123.56, "episode_media": {}, "episodes_timesteps_total": 12356, "policy_reward_min": {"policy_0": -1416.842540592913}, "policy_reward_max": {"policy_0": -5.974482381450892}, "policy_reward_mean": {"policy_0": -681.0744327845055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152.77170261759838, -140.00239163264422, -1319.7696689870877, -360.79360739307316, -90.34620747270407, -965.5669022467923, -894.9709238553795, -172.53813000840628, -1054.322289354168, -1353.5355505193945, -1299.89476637184, -35.05330195340966, -231.50176763655915, -676.5619933055949, -903.7629745758269, -946.2521129394044, -519.5389833707366, -161.01793709246746, -316.82416760371035, -1416.842540592913, -551.3665715647995, -951.8192265408502, -1316.6813756206948, -642.991070905178, -909.1343887009615, -587.3289051817392, -134.55092030908438, -1088.0592655177957, -115.18893898018725, -1076.4270771139993, -21.5121147739079, -188.72385609050673, -568.704347656033, -564.6006758947094, -520.9962049936098, -1125.4933427634435, -14.275342661345062, -86.72158157844748, -321.0727061810877, -178.24262325582217, -817.0838785273406, -920.79807528545, -1079.17765341927, -909.0417060328688, -280.31795937412664, -1198.3093375730355, -929.2113942100773, -1032.2824463831985, -1176.2603713651367, -215.1860882902349, -825.5299446295494, -1254.4589854272012, -5.974482381450892, -100.66782769865726, -1066.48685072826, -791.2549429457237, -1081.3555214251876, -1082.202019266769, -468.3127115030172, -1233.8990918474663, -453.4370530256853, -674.5499295948317, -118.3705132865579, -752.1632456319732, -736.4705099074106, -1292.35125614661, -285.128052681893, -556.2168248501051, -964.726501448604, -98.87183547095867, -68.44089820509646, -326.5156196273944, -978.6938392366158, -113.17748043888065, -814.2407067037931, -612.06538554249, -1228.0627306828803, -897.4175001666861, -235.93997258644563, -1295.5208074186894, -897.8959718967712, -1058.4479731278745, -1218.1212476161625, -970.3223411495954, -485.80135252045653, -936.3541852090959, -726.951730576183, -40.69205790367036, -973.2351557099439, -362.05755669921723, -416.67106510605277, -1300.9182028674286, -1124.7322853228352, -51.91136974490023, -71.21189672736833, -902.7152104062648, -579.9140186310162, -1415.3051469031095, -779.3693509301775, -848.8847526208857], "episode_lengths": [56, 71, 150, 150, 45, 150, 150, 63, 150, 150, 150, 38, 79, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 117, 76, 150, 69, 150, 37, 80, 150, 150, 117, 150, 42, 43, 94, 67, 150, 150, 150, 150, 88, 150, 150, 150, 150, 70, 150, 150, 33, 73, 150, 150, 150, 150, 142, 150, 150, 132, 72, 150, 150, 150, 92, 108, 150, 51, 59, 86, 150, 60, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 57, 41, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-152.77170261759838, -140.00239163264422, -1319.7696689870877, -360.79360739307316, -90.34620747270407, -965.5669022467923, -894.9709238553795, -172.53813000840628, -1054.322289354168, -1353.5355505193945, -1299.89476637184, -35.05330195340966, -231.50176763655915, -676.5619933055949, -903.7629745758269, -946.2521129394044, -519.5389833707366, -161.01793709246746, -316.82416760371035, -1416.842540592913, -551.3665715647995, -951.8192265408502, -1316.6813756206948, -642.991070905178, -909.1343887009615, -587.3289051817392, -134.55092030908438, -1088.0592655177957, -115.18893898018725, -1076.4270771139993, -21.5121147739079, -188.72385609050673, -568.704347656033, -564.6006758947094, -520.9962049936098, -1125.4933427634435, -14.275342661345062, -86.72158157844748, -321.0727061810877, -178.24262325582217, -817.0838785273406, -920.79807528545, -1079.17765341927, -909.0417060328688, -280.31795937412664, -1198.3093375730355, -929.2113942100773, -1032.2824463831985, -1176.2603713651367, -215.1860882902349, -825.5299446295494, -1254.4589854272012, -5.974482381450892, -100.66782769865726, -1066.48685072826, -791.2549429457237, -1081.3555214251876, -1082.202019266769, -468.3127115030172, -1233.8990918474663, -453.4370530256853, -674.5499295948317, -118.3705132865579, -752.1632456319732, -736.4705099074106, -1292.35125614661, -285.128052681893, -556.2168248501051, -964.726501448604, -98.87183547095867, -68.44089820509646, -326.5156196273944, -978.6938392366158, -113.17748043888065, -814.2407067037931, -612.06538554249, -1228.0627306828803, -897.4175001666861, -235.93997258644563, -1295.5208074186894, -897.8959718967712, -1058.4479731278745, -1218.1212476161625, -970.3223411495954, -485.80135252045653, -936.3541852090959, -726.951730576183, -40.69205790367036, -973.2351557099439, -362.05755669921723, -416.67106510605277, -1300.9182028674286, -1124.7322853228352, -51.91136974490023, -71.21189672736833, -902.7152104062648, -579.9140186310162, -1415.3051469031095, -779.3693509301775, -848.8847526208857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553628398904249, "mean_inference_ms": 1.680542339124452, "mean_action_processing_ms": 0.2789390633463402, "mean_env_wait_ms": 3.4495414803436084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011887550354003906, "StateBufferConnector_ms": 0.0077817440032958984, "ViewRequirementAgentConnector_ms": 0.18733668327331543}, "num_episodes": 29, "episode_return_max": -5.974482381450892, "episode_return_min": -1416.842540592913, "episode_return_mean": -681.0744327845055, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.6225809479075, "num_env_steps_trained_throughput_per_sec": 316.6225809479075, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12652.869, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12652.802, "sample_time_ms": 1143.442, "learn_time_ms": 11442.333, "learn_throughput": 349.579, "synch_weights_time_ms": 66.23}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00014", "date": "2024-08-04_06-47-39", "timestamp": 1722734259, "time_this_iter_s": 12.647205352783203, "time_total_s": 126.65728306770325, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.65728306770325, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.516666666666666, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.65414941410224, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.564080552260081, "policy_loss": 0.0009140631203384449, "vf_loss": 4.572596913079421, "vf_explained_var": 0.9279307768990596, "kl": 0.01524895766294018, "entropy": 1.4005120571702718, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -5.974482381450892, "episode_reward_min": -1415.3051469031095, "episode_reward_mean": -676.6084308373142, "episode_len_mean": 124.58, "episode_media": {}, "episodes_timesteps_total": 12458, "policy_reward_min": {"policy_0": -1415.3051469031095}, "policy_reward_max": {"policy_0": -5.974482381450892}, "policy_reward_mean": {"policy_0": -676.6084308373142}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115.18893898018725, -1076.4270771139993, -21.5121147739079, -188.72385609050673, -568.704347656033, -564.6006758947094, -520.9962049936098, -1125.4933427634435, -14.275342661345062, -86.72158157844748, -321.0727061810877, -178.24262325582217, -817.0838785273406, -920.79807528545, -1079.17765341927, -909.0417060328688, -280.31795937412664, -1198.3093375730355, -929.2113942100773, -1032.2824463831985, -1176.2603713651367, -215.1860882902349, -825.5299446295494, -1254.4589854272012, -5.974482381450892, -100.66782769865726, -1066.48685072826, -791.2549429457237, -1081.3555214251876, -1082.202019266769, -468.3127115030172, -1233.8990918474663, -453.4370530256853, -674.5499295948317, -118.3705132865579, -752.1632456319732, -736.4705099074106, -1292.35125614661, -285.128052681893, -556.2168248501051, -964.726501448604, -98.87183547095867, -68.44089820509646, -326.5156196273944, -978.6938392366158, -113.17748043888065, -814.2407067037931, -612.06538554249, -1228.0627306828803, -897.4175001666861, -235.93997258644563, -1295.5208074186894, -897.8959718967712, -1058.4479731278745, -1218.1212476161625, -970.3223411495954, -485.80135252045653, -936.3541852090959, -726.951730576183, -40.69205790367036, -973.2351557099439, -362.05755669921723, -416.67106510605277, -1300.9182028674286, -1124.7322853228352, -51.91136974490023, -71.21189672736833, -902.7152104062648, -579.9140186310162, -1415.3051469031095, -779.3693509301775, -848.8847526208857, -1136.4673790089014, -1215.863929557449, -605.00666915135, -362.0126574526202, -906.295099954163, -1256.914310230903, -58.93224356389348, -256.2255804257156, -893.1881653854927, -1206.3894029537662, -671.1130724818685, -505.03871819543843, -146.93612058148585, -668.75453425662, -939.0818503696205, -635.5729825424023, -42.45369526868327, -439.27991011667024, -1114.3350769613157, -300.0694213574663, -369.60761576821164, -577.5825818140397, -291.7840149564215, -234.4610072217277, -337.6630737093351, -1388.8484686188644, -1362.5726712675678, -824.749195979704], "episode_lengths": [69, 150, 37, 80, 150, 150, 117, 150, 42, 43, 94, 67, 150, 150, 150, 150, 88, 150, 150, 150, 150, 70, 150, 150, 33, 73, 150, 150, 150, 150, 142, 150, 150, 132, 72, 150, 150, 150, 92, 108, 150, 51, 59, 86, 150, 60, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 57, 41, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 64, 71, 150, 150, 150, 150, 74, 126, 150, 150, 51, 150, 150, 76, 150, 150, 79, 88, 118, 150, 150, 150], "policy_policy_0_reward": [-115.18893898018725, -1076.4270771139993, -21.5121147739079, -188.72385609050673, -568.704347656033, -564.6006758947094, -520.9962049936098, -1125.4933427634435, -14.275342661345062, -86.72158157844748, -321.0727061810877, -178.24262325582217, -817.0838785273406, -920.79807528545, -1079.17765341927, -909.0417060328688, -280.31795937412664, -1198.3093375730355, -929.2113942100773, -1032.2824463831985, -1176.2603713651367, -215.1860882902349, -825.5299446295494, -1254.4589854272012, -5.974482381450892, -100.66782769865726, -1066.48685072826, -791.2549429457237, -1081.3555214251876, -1082.202019266769, -468.3127115030172, -1233.8990918474663, -453.4370530256853, -674.5499295948317, -118.3705132865579, -752.1632456319732, -736.4705099074106, -1292.35125614661, -285.128052681893, -556.2168248501051, -964.726501448604, -98.87183547095867, -68.44089820509646, -326.5156196273944, -978.6938392366158, -113.17748043888065, -814.2407067037931, -612.06538554249, -1228.0627306828803, -897.4175001666861, -235.93997258644563, -1295.5208074186894, -897.8959718967712, -1058.4479731278745, -1218.1212476161625, -970.3223411495954, -485.80135252045653, -936.3541852090959, -726.951730576183, -40.69205790367036, -973.2351557099439, -362.05755669921723, -416.67106510605277, -1300.9182028674286, -1124.7322853228352, -51.91136974490023, -71.21189672736833, -902.7152104062648, -579.9140186310162, -1415.3051469031095, -779.3693509301775, -848.8847526208857, -1136.4673790089014, -1215.863929557449, -605.00666915135, -362.0126574526202, -906.295099954163, -1256.914310230903, -58.93224356389348, -256.2255804257156, -893.1881653854927, -1206.3894029537662, -671.1130724818685, -505.03871819543843, -146.93612058148585, -668.75453425662, -939.0818503696205, -635.5729825424023, -42.45369526868327, -439.27991011667024, -1114.3350769613157, -300.0694213574663, -369.60761576821164, -577.5825818140397, -291.7840149564215, -234.4610072217277, -337.6630737093351, -1388.8484686188644, -1362.5726712675678, -824.749195979704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549549466591529, "mean_inference_ms": 1.6789656682910405, "mean_action_processing_ms": 0.27856558662335895, "mean_env_wait_ms": 3.447526049767464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01251530647277832, "StateBufferConnector_ms": 0.007883310317993164, "ViewRequirementAgentConnector_ms": 0.18697786331176758}, "num_episodes": 28, "episode_return_max": -5.974482381450892, "episode_return_min": -1415.3051469031095, "episode_return_mean": -676.6084308373142, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.605619389452, "num_env_steps_trained_throughput_per_sec": 315.605619389452, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12927.711, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12927.643, "sample_time_ms": 1145.864, "learn_time_ms": 11715.117, "learn_throughput": 341.439, "synch_weights_time_ms": 65.87}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00014", "date": "2024-08-04_06-47-52", "timestamp": 1722734272, "time_this_iter_s": 12.687038898468018, "time_total_s": 139.34432196617126, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370878550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.34432196617126, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.438888888888886, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.74676630099614, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.38610643769304, "policy_loss": -0.009629900228173938, "vf_loss": 4.404910455395778, "vf_explained_var": 0.9581154918298125, "kl": 0.0172413492568012, "entropy": 1.434652779996395, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -28.76702121635789, "episode_reward_min": -1415.3051469031095, "episode_reward_mean": -693.7486416003569, "episode_len_mean": 129.92, "episode_media": {}, "episodes_timesteps_total": 12992, "policy_reward_min": {"policy_0": -1415.3051469031095}, "policy_reward_max": {"policy_0": -28.76702121635789}, "policy_reward_mean": {"policy_0": -693.7486416003569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-468.3127115030172, -1233.8990918474663, -453.4370530256853, -674.5499295948317, -118.3705132865579, -752.1632456319732, -736.4705099074106, -1292.35125614661, -285.128052681893, -556.2168248501051, -964.726501448604, -98.87183547095867, -68.44089820509646, -326.5156196273944, -978.6938392366158, -113.17748043888065, -814.2407067037931, -612.06538554249, -1228.0627306828803, -897.4175001666861, -235.93997258644563, -1295.5208074186894, -897.8959718967712, -1058.4479731278745, -1218.1212476161625, -970.3223411495954, -485.80135252045653, -936.3541852090959, -726.951730576183, -40.69205790367036, -973.2351557099439, -362.05755669921723, -416.67106510605277, -1300.9182028674286, -1124.7322853228352, -51.91136974490023, -71.21189672736833, -902.7152104062648, -579.9140186310162, -1415.3051469031095, -779.3693509301775, -848.8847526208857, -1136.4673790089014, -1215.863929557449, -605.00666915135, -362.0126574526202, -906.295099954163, -1256.914310230903, -58.93224356389348, -256.2255804257156, -893.1881653854927, -1206.3894029537662, -671.1130724818685, -505.03871819543843, -146.93612058148585, -668.75453425662, -939.0818503696205, -635.5729825424023, -42.45369526868327, -439.27991011667024, -1114.3350769613157, -300.0694213574663, -369.60761576821164, -577.5825818140397, -291.7840149564215, -234.4610072217277, -337.6630737093351, -1388.8484686188644, -1362.5726712675678, -824.749195979704, -962.5771135119614, -80.66096531247686, -457.6161643646748, -143.5395724380612, -908.9960899413938, -65.50800486990744, -1186.688415211951, -818.6363815778753, -556.5868102075386, -967.8654718363484, -716.627508798368, -262.2261728175285, -946.2951011586496, -809.1594207860458, -857.6471315303148, -905.264899325909, -741.4565206420008, -412.17453443955054, -666.1480577817359, -372.67459603143965, -535.2246840776362, -1084.2140610489103, -607.3944645837828, -28.76702121635789, -1087.2481524873065, -1115.5308327264086, -1211.4774306138304, -1007.5352634513383, -1144.7834786995616, -601.0550517220342], "episode_lengths": [142, 150, 150, 132, 72, 150, 150, 150, 92, 108, 150, 51, 59, 86, 150, 60, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 57, 41, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 64, 71, 150, 150, 150, 150, 74, 126, 150, 150, 51, 150, 150, 76, 150, 150, 79, 88, 118, 150, 150, 150, 150, 67, 150, 62, 150, 40, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 122, 50, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-468.3127115030172, -1233.8990918474663, -453.4370530256853, -674.5499295948317, -118.3705132865579, -752.1632456319732, -736.4705099074106, -1292.35125614661, -285.128052681893, -556.2168248501051, -964.726501448604, -98.87183547095867, -68.44089820509646, -326.5156196273944, -978.6938392366158, -113.17748043888065, -814.2407067037931, -612.06538554249, -1228.0627306828803, -897.4175001666861, -235.93997258644563, -1295.5208074186894, -897.8959718967712, -1058.4479731278745, -1218.1212476161625, -970.3223411495954, -485.80135252045653, -936.3541852090959, -726.951730576183, -40.69205790367036, -973.2351557099439, -362.05755669921723, -416.67106510605277, -1300.9182028674286, -1124.7322853228352, -51.91136974490023, -71.21189672736833, -902.7152104062648, -579.9140186310162, -1415.3051469031095, -779.3693509301775, -848.8847526208857, -1136.4673790089014, -1215.863929557449, -605.00666915135, -362.0126574526202, -906.295099954163, -1256.914310230903, -58.93224356389348, -256.2255804257156, -893.1881653854927, -1206.3894029537662, -671.1130724818685, -505.03871819543843, -146.93612058148585, -668.75453425662, -939.0818503696205, -635.5729825424023, -42.45369526868327, -439.27991011667024, -1114.3350769613157, -300.0694213574663, -369.60761576821164, -577.5825818140397, -291.7840149564215, -234.4610072217277, -337.6630737093351, -1388.8484686188644, -1362.5726712675678, -824.749195979704, -962.5771135119614, -80.66096531247686, -457.6161643646748, -143.5395724380612, -908.9960899413938, -65.50800486990744, -1186.688415211951, -818.6363815778753, -556.5868102075386, -967.8654718363484, -716.627508798368, -262.2261728175285, -946.2951011586496, -809.1594207860458, -857.6471315303148, -905.264899325909, -741.4565206420008, -412.17453443955054, -666.1480577817359, -372.67459603143965, -535.2246840776362, -1084.2140610489103, -607.3944645837828, -28.76702121635789, -1087.2481524873065, -1115.5308327264086, -1211.4774306138304, -1007.5352634513383, -1144.7834786995616, -601.0550517220342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546429268476851, "mean_inference_ms": 1.6823490238386867, "mean_action_processing_ms": 0.27959715627025217, "mean_env_wait_ms": 3.454946079763591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012854576110839844, "StateBufferConnector_ms": 0.007937192916870117, "ViewRequirementAgentConnector_ms": 0.21045422554016113}, "num_episodes": 30, "episode_return_max": -28.76702121635789, "episode_return_min": -1415.3051469031095, "episode_return_mean": -693.7486416003569, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.88906527444925, "num_env_steps_trained_throughput_per_sec": 307.88906527444925, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12924.935, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12924.865, "sample_time_ms": 1157.626, "learn_time_ms": 11701.41, "learn_throughput": 341.839, "synch_weights_time_ms": 65.035}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00014", "date": "2024-08-04_06-48-05", "timestamp": 1722734285, "time_this_iter_s": 13.00410509109497, "time_total_s": 152.34842705726624, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087a4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.34842705726624, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.342105263157894, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.03559292852879, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.1894991882145405, "policy_loss": -0.013356781913898885, "vf_loss": 4.21059852540493, "vf_explained_var": 0.9749097712337971, "kl": 0.02172461802680726, "entropy": 1.4259948786348104, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -28.76702121635789, "episode_reward_min": -1415.3051469031095, "episode_reward_mean": -702.0316621380053, "episode_len_mean": 134.21, "episode_media": {}, "episodes_timesteps_total": 13421, "policy_reward_min": {"policy_0": -1415.3051469031095}, "policy_reward_max": {"policy_0": -28.76702121635789}, "policy_reward_mean": {"policy_0": -702.0316621380053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-973.2351557099439, -362.05755669921723, -416.67106510605277, -1300.9182028674286, -1124.7322853228352, -51.91136974490023, -71.21189672736833, -902.7152104062648, -579.9140186310162, -1415.3051469031095, -779.3693509301775, -848.8847526208857, -1136.4673790089014, -1215.863929557449, -605.00666915135, -362.0126574526202, -906.295099954163, -1256.914310230903, -58.93224356389348, -256.2255804257156, -893.1881653854927, -1206.3894029537662, -671.1130724818685, -505.03871819543843, -146.93612058148585, -668.75453425662, -939.0818503696205, -635.5729825424023, -42.45369526868327, -439.27991011667024, -1114.3350769613157, -300.0694213574663, -369.60761576821164, -577.5825818140397, -291.7840149564215, -234.4610072217277, -337.6630737093351, -1388.8484686188644, -1362.5726712675678, -824.749195979704, -962.5771135119614, -80.66096531247686, -457.6161643646748, -143.5395724380612, -908.9960899413938, -65.50800486990744, -1186.688415211951, -818.6363815778753, -556.5868102075386, -967.8654718363484, -716.627508798368, -262.2261728175285, -946.2951011586496, -809.1594207860458, -857.6471315303148, -905.264899325909, -741.4565206420008, -412.17453443955054, -666.1480577817359, -372.67459603143965, -535.2246840776362, -1084.2140610489103, -607.3944645837828, -28.76702121635789, -1087.2481524873065, -1115.5308327264086, -1211.4774306138304, -1007.5352634513383, -1144.7834786995616, -601.0550517220342, -866.9982023249042, -504.3508410152537, -539.1968766772485, -775.6833735621317, -268.4620627289276, -1093.4943904342185, -671.87832791775, -263.089361135119, -1098.5062452100374, -616.9228082017804, -564.0717502257194, -977.020761148782, -1247.4957385589162, -1181.2517189074672, -1282.2175524849615, -762.8888387398345, -1243.417264110943, -836.2696274689772, -467.8758038667279, -262.64718192698814, -540.2762008245302, -413.6761661822536, -261.31978192666924, -123.67838475094268, -483.6956040948021, -965.3838706361238, -1196.2640955012723, -461.16574948942815, -276.63425513732847, -1121.628544578697], "episode_lengths": [150, 150, 150, 150, 150, 57, 41, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 64, 71, 150, 150, 150, 150, 74, 126, 150, 150, 51, 150, 150, 76, 150, 150, 79, 88, 118, 150, 150, 150, 150, 67, 150, 62, 150, 40, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 122, 50, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 80, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 50, 150, 150, 150, 150, 86, 150], "policy_policy_0_reward": [-973.2351557099439, -362.05755669921723, -416.67106510605277, -1300.9182028674286, -1124.7322853228352, -51.91136974490023, -71.21189672736833, -902.7152104062648, -579.9140186310162, -1415.3051469031095, -779.3693509301775, -848.8847526208857, -1136.4673790089014, -1215.863929557449, -605.00666915135, -362.0126574526202, -906.295099954163, -1256.914310230903, -58.93224356389348, -256.2255804257156, -893.1881653854927, -1206.3894029537662, -671.1130724818685, -505.03871819543843, -146.93612058148585, -668.75453425662, -939.0818503696205, -635.5729825424023, -42.45369526868327, -439.27991011667024, -1114.3350769613157, -300.0694213574663, -369.60761576821164, -577.5825818140397, -291.7840149564215, -234.4610072217277, -337.6630737093351, -1388.8484686188644, -1362.5726712675678, -824.749195979704, -962.5771135119614, -80.66096531247686, -457.6161643646748, -143.5395724380612, -908.9960899413938, -65.50800486990744, -1186.688415211951, -818.6363815778753, -556.5868102075386, -967.8654718363484, -716.627508798368, -262.2261728175285, -946.2951011586496, -809.1594207860458, -857.6471315303148, -905.264899325909, -741.4565206420008, -412.17453443955054, -666.1480577817359, -372.67459603143965, -535.2246840776362, -1084.2140610489103, -607.3944645837828, -28.76702121635789, -1087.2481524873065, -1115.5308327264086, -1211.4774306138304, -1007.5352634513383, -1144.7834786995616, -601.0550517220342, -866.9982023249042, -504.3508410152537, -539.1968766772485, -775.6833735621317, -268.4620627289276, -1093.4943904342185, -671.87832791775, -263.089361135119, -1098.5062452100374, -616.9228082017804, -564.0717502257194, -977.020761148782, -1247.4957385589162, -1181.2517189074672, -1282.2175524849615, -762.8888387398345, -1243.417264110943, -836.2696274689772, -467.8758038667279, -262.64718192698814, -540.2762008245302, -413.6761661822536, -261.31978192666924, -123.67838475094268, -483.6956040948021, -965.3838706361238, -1196.2640955012723, -461.16574948942815, -276.63425513732847, -1121.628544578697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538623455552617, "mean_inference_ms": 1.6800941013736346, "mean_action_processing_ms": 0.2799940743046117, "mean_env_wait_ms": 3.4539015017804955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012638568878173828, "StateBufferConnector_ms": 0.007852792739868164, "ViewRequirementAgentConnector_ms": 0.20958375930786133}, "num_episodes": 30, "episode_return_max": -28.76702121635789, "episode_return_min": -1415.3051469031095, "episode_return_mean": -702.0316621380053, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.07799643843225, "num_env_steps_trained_throughput_per_sec": 358.07799643843225, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12741.005, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12740.932, "sample_time_ms": 1156.995, "learn_time_ms": 11518.651, "learn_throughput": 347.263, "synch_weights_time_ms": 64.498}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00014", "date": "2024-08-04_06-48-16", "timestamp": 1722734296, "time_this_iter_s": 11.183515071868896, "time_total_s": 163.53194212913513, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 163.53194212913513, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.4375, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.82603544592857, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.460683383544286, "policy_loss": -0.012516564925317653, "vf_loss": 3.4837763900558154, "vf_explained_var": 0.9647641809036335, "kl": 0.010210672250195785, "entropy": 1.5171236501385768, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -28.76702121635789, "episode_reward_min": -1490.8719852492852, "episode_reward_mean": -722.1450133284409, "episode_len_mean": 138.1, "episode_media": {}, "episodes_timesteps_total": 13810, "policy_reward_min": {"policy_0": -1490.8719852492852}, "policy_reward_max": {"policy_0": -28.76702121635789}, "policy_reward_mean": {"policy_0": -722.1450133284409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-635.5729825424023, -42.45369526868327, -439.27991011667024, -1114.3350769613157, -300.0694213574663, -369.60761576821164, -577.5825818140397, -291.7840149564215, -234.4610072217277, -337.6630737093351, -1388.8484686188644, -1362.5726712675678, -824.749195979704, -962.5771135119614, -80.66096531247686, -457.6161643646748, -143.5395724380612, -908.9960899413938, -65.50800486990744, -1186.688415211951, -818.6363815778753, -556.5868102075386, -967.8654718363484, -716.627508798368, -262.2261728175285, -946.2951011586496, -809.1594207860458, -857.6471315303148, -905.264899325909, -741.4565206420008, -412.17453443955054, -666.1480577817359, -372.67459603143965, -535.2246840776362, -1084.2140610489103, -607.3944645837828, -28.76702121635789, -1087.2481524873065, -1115.5308327264086, -1211.4774306138304, -1007.5352634513383, -1144.7834786995616, -601.0550517220342, -866.9982023249042, -504.3508410152537, -539.1968766772485, -775.6833735621317, -268.4620627289276, -1093.4943904342185, -671.87832791775, -263.089361135119, -1098.5062452100374, -616.9228082017804, -564.0717502257194, -977.020761148782, -1247.4957385589162, -1181.2517189074672, -1282.2175524849615, -762.8888387398345, -1243.417264110943, -836.2696274689772, -467.8758038667279, -262.64718192698814, -540.2762008245302, -413.6761661822536, -261.31978192666924, -123.67838475094268, -483.6956040948021, -965.3838706361238, -1196.2640955012723, -461.16574948942815, -276.63425513732847, -1121.628544578697, -1122.9111707107663, -625.221448007056, -791.4714602506155, -1027.9954233278104, -1265.4204144139917, -856.5899401763982, -453.71298528167307, -960.636504583529, -666.147214125645, -250.67457416072017, -1127.8364299245732, -886.9250235185025, -203.9387790319125, -479.8122481308746, -1306.6726673563528, -316.6499084535419, -352.26967244852125, -1129.2672663386873, -646.9502000686018, -983.7993143908874, -965.0996921396734, -859.5728434144283, -1490.8719852492852, -698.0630844618896, -230.55696618909974, -914.7393814958257, -1052.6742666311754], "episode_lengths": [150, 51, 150, 150, 76, 150, 150, 79, 88, 118, 150, 150, 150, 150, 67, 150, 62, 150, 40, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 122, 50, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 80, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 50, 150, 150, 150, 150, 86, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150], "policy_policy_0_reward": [-635.5729825424023, -42.45369526868327, -439.27991011667024, -1114.3350769613157, -300.0694213574663, -369.60761576821164, -577.5825818140397, -291.7840149564215, -234.4610072217277, -337.6630737093351, -1388.8484686188644, -1362.5726712675678, -824.749195979704, -962.5771135119614, -80.66096531247686, -457.6161643646748, -143.5395724380612, -908.9960899413938, -65.50800486990744, -1186.688415211951, -818.6363815778753, -556.5868102075386, -967.8654718363484, -716.627508798368, -262.2261728175285, -946.2951011586496, -809.1594207860458, -857.6471315303148, -905.264899325909, -741.4565206420008, -412.17453443955054, -666.1480577817359, -372.67459603143965, -535.2246840776362, -1084.2140610489103, -607.3944645837828, -28.76702121635789, -1087.2481524873065, -1115.5308327264086, -1211.4774306138304, -1007.5352634513383, -1144.7834786995616, -601.0550517220342, -866.9982023249042, -504.3508410152537, -539.1968766772485, -775.6833735621317, -268.4620627289276, -1093.4943904342185, -671.87832791775, -263.089361135119, -1098.5062452100374, -616.9228082017804, -564.0717502257194, -977.020761148782, -1247.4957385589162, -1181.2517189074672, -1282.2175524849615, -762.8888387398345, -1243.417264110943, -836.2696274689772, -467.8758038667279, -262.64718192698814, -540.2762008245302, -413.6761661822536, -261.31978192666924, -123.67838475094268, -483.6956040948021, -965.3838706361238, -1196.2640955012723, -461.16574948942815, -276.63425513732847, -1121.628544578697, -1122.9111707107663, -625.221448007056, -791.4714602506155, -1027.9954233278104, -1265.4204144139917, -856.5899401763982, -453.71298528167307, -960.636504583529, -666.147214125645, -250.67457416072017, -1127.8364299245732, -886.9250235185025, -203.9387790319125, -479.8122481308746, -1306.6726673563528, -316.6499084535419, -352.26967244852125, -1129.2672663386873, -646.9502000686018, -983.7993143908874, -965.0996921396734, -859.5728434144283, -1490.8719852492852, -698.0630844618896, -230.55696618909974, -914.7393814958257, -1052.6742666311754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536837045982353, "mean_inference_ms": 1.6799253933087, "mean_action_processing_ms": 0.28003826935542847, "mean_env_wait_ms": 3.45704695108459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013068437576293945, "StateBufferConnector_ms": 0.007858514785766602, "ViewRequirementAgentConnector_ms": 0.21305322647094727}, "num_episodes": 27, "episode_return_max": -28.76702121635789, "episode_return_min": -1490.8719852492852, "episode_return_mean": -722.1450133284409, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.43884493027923, "num_env_steps_trained_throughput_per_sec": 307.43884493027923, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12747.656, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12747.583, "sample_time_ms": 1154.456, "learn_time_ms": 11527.72, "learn_throughput": 346.99, "synch_weights_time_ms": 64.621}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00014", "date": "2024-08-04_06-48-29", "timestamp": 1722734309, "time_this_iter_s": 13.024731397628784, "time_total_s": 176.55667352676392, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080a170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.55667352676392, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.416666666666668, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.8084774196148, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.254621147861083, "policy_loss": -0.013669474641695463, "vf_loss": 3.2760620868454375, "vf_explained_var": 0.9797406513864796, "kl": 0.013195749267667149, "entropy": 1.3709554366767407, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -28.76702121635789, "episode_reward_min": -1490.8719852492852, "episode_reward_mean": -725.2705237287336, "episode_len_mean": 140.13, "episode_media": {}, "episodes_timesteps_total": 14013, "policy_reward_min": {"policy_0": -1490.8719852492852}, "policy_reward_max": {"policy_0": -28.76702121635789}, "policy_reward_mean": {"policy_0": -725.2705237287336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-905.264899325909, -741.4565206420008, -412.17453443955054, -666.1480577817359, -372.67459603143965, -535.2246840776362, -1084.2140610489103, -607.3944645837828, -28.76702121635789, -1087.2481524873065, -1115.5308327264086, -1211.4774306138304, -1007.5352634513383, -1144.7834786995616, -601.0550517220342, -866.9982023249042, -504.3508410152537, -539.1968766772485, -775.6833735621317, -268.4620627289276, -1093.4943904342185, -671.87832791775, -263.089361135119, -1098.5062452100374, -616.9228082017804, -564.0717502257194, -977.020761148782, -1247.4957385589162, -1181.2517189074672, -1282.2175524849615, -762.8888387398345, -1243.417264110943, -836.2696274689772, -467.8758038667279, -262.64718192698814, -540.2762008245302, -413.6761661822536, -261.31978192666924, -123.67838475094268, -483.6956040948021, -965.3838706361238, -1196.2640955012723, -461.16574948942815, -276.63425513732847, -1121.628544578697, -1122.9111707107663, -625.221448007056, -791.4714602506155, -1027.9954233278104, -1265.4204144139917, -856.5899401763982, -453.71298528167307, -960.636504583529, -666.147214125645, -250.67457416072017, -1127.8364299245732, -886.9250235185025, -203.9387790319125, -479.8122481308746, -1306.6726673563528, -316.6499084535419, -352.26967244852125, -1129.2672663386873, -646.9502000686018, -983.7993143908874, -965.0996921396734, -859.5728434144283, -1490.8719852492852, -698.0630844618896, -230.55696618909974, -914.7393814958257, -1052.6742666311754, -896.2602802887506, -143.11032857640328, -477.453911150619, -784.7303071454397, -1273.0929318473, -636.9316868227032, -473.75110748170226, -222.94500830067707, -689.5295542643511, -364.78046415459136, -605.7148053522383, -228.7661009838014, -1183.302855359788, -1044.2970075504468, -141.6855203603375, -896.6223660582131, -504.14661486951445, -597.0950533045074, -638.7398516064844, -738.5865444974601, -1264.7146979821962, -492.231403963719, -809.366093462577, -680.938332168672, -540.3794559617432, -312.4844449295009, -1191.2840882231185, -139.2202633079196], "episode_lengths": [150, 150, 150, 150, 130, 150, 150, 122, 50, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 80, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 50, 150, 150, 150, 150, 86, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 143, 69, 150, 150, 150, 150, 150, 82, 150, 88, 150, 71, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78], "policy_policy_0_reward": [-905.264899325909, -741.4565206420008, -412.17453443955054, -666.1480577817359, -372.67459603143965, -535.2246840776362, -1084.2140610489103, -607.3944645837828, -28.76702121635789, -1087.2481524873065, -1115.5308327264086, -1211.4774306138304, -1007.5352634513383, -1144.7834786995616, -601.0550517220342, -866.9982023249042, -504.3508410152537, -539.1968766772485, -775.6833735621317, -268.4620627289276, -1093.4943904342185, -671.87832791775, -263.089361135119, -1098.5062452100374, -616.9228082017804, -564.0717502257194, -977.020761148782, -1247.4957385589162, -1181.2517189074672, -1282.2175524849615, -762.8888387398345, -1243.417264110943, -836.2696274689772, -467.8758038667279, -262.64718192698814, -540.2762008245302, -413.6761661822536, -261.31978192666924, -123.67838475094268, -483.6956040948021, -965.3838706361238, -1196.2640955012723, -461.16574948942815, -276.63425513732847, -1121.628544578697, -1122.9111707107663, -625.221448007056, -791.4714602506155, -1027.9954233278104, -1265.4204144139917, -856.5899401763982, -453.71298528167307, -960.636504583529, -666.147214125645, -250.67457416072017, -1127.8364299245732, -886.9250235185025, -203.9387790319125, -479.8122481308746, -1306.6726673563528, -316.6499084535419, -352.26967244852125, -1129.2672663386873, -646.9502000686018, -983.7993143908874, -965.0996921396734, -859.5728434144283, -1490.8719852492852, -698.0630844618896, -230.55696618909974, -914.7393814958257, -1052.6742666311754, -896.2602802887506, -143.11032857640328, -477.453911150619, -784.7303071454397, -1273.0929318473, -636.9316868227032, -473.75110748170226, -222.94500830067707, -689.5295542643511, -364.78046415459136, -605.7148053522383, -228.7661009838014, -1183.302855359788, -1044.2970075504468, -141.6855203603375, -896.6223660582131, -504.14661486951445, -597.0950533045074, -638.7398516064844, -738.5865444974601, -1264.7146979821962, -492.231403963719, -809.366093462577, -680.938332168672, -540.3794559617432, -312.4844449295009, -1191.2840882231185, -139.2202633079196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552760969779887, "mean_inference_ms": 1.6767209757995705, "mean_action_processing_ms": 0.2795643686247772, "mean_env_wait_ms": 3.452888591514863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012787103652954102, "StateBufferConnector_ms": 0.007972002029418945, "ViewRequirementAgentConnector_ms": 0.21501851081848145}, "num_episodes": 28, "episode_return_max": -28.76702121635789, "episode_return_min": -1490.8719852492852, "episode_return_mean": -725.2705237287336, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.8170501889034, "num_env_steps_trained_throughput_per_sec": 309.8170501889034, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12711.034, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12710.959, "sample_time_ms": 1149.928, "learn_time_ms": 11497.284, "learn_throughput": 347.908, "synch_weights_time_ms": 62.96}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00014", "date": "2024-08-04_06-48-42", "timestamp": 1722734322, "time_this_iter_s": 12.92363953590393, "time_total_s": 189.48031306266785, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 189.48031306266785, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.266666666666666, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 174.68183555404346, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.674002053961158, "policy_loss": -0.014159808472322765, "vf_loss": 2.6963940128684043, "vf_explained_var": 0.9853000493099292, "kl": 0.014111514653965667, "entropy": 1.4582328278571368, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -104.34413800717185, "episode_reward_min": -1490.8719852492852, "episode_reward_mean": -729.2649109697144, "episode_len_mean": 141.01, "episode_media": {}, "episodes_timesteps_total": 14101, "policy_reward_min": {"policy_0": -1490.8719852492852}, "policy_reward_max": {"policy_0": -104.34413800717185}, "policy_reward_mean": {"policy_0": -729.2649109697144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-564.0717502257194, -977.020761148782, -1247.4957385589162, -1181.2517189074672, -1282.2175524849615, -762.8888387398345, -1243.417264110943, -836.2696274689772, -467.8758038667279, -262.64718192698814, -540.2762008245302, -413.6761661822536, -261.31978192666924, -123.67838475094268, -483.6956040948021, -965.3838706361238, -1196.2640955012723, -461.16574948942815, -276.63425513732847, -1121.628544578697, -1122.9111707107663, -625.221448007056, -791.4714602506155, -1027.9954233278104, -1265.4204144139917, -856.5899401763982, -453.71298528167307, -960.636504583529, -666.147214125645, -250.67457416072017, -1127.8364299245732, -886.9250235185025, -203.9387790319125, -479.8122481308746, -1306.6726673563528, -316.6499084535419, -352.26967244852125, -1129.2672663386873, -646.9502000686018, -983.7993143908874, -965.0996921396734, -859.5728434144283, -1490.8719852492852, -698.0630844618896, -230.55696618909974, -914.7393814958257, -1052.6742666311754, -896.2602802887506, -143.11032857640328, -477.453911150619, -784.7303071454397, -1273.0929318473, -636.9316868227032, -473.75110748170226, -222.94500830067707, -689.5295542643511, -364.78046415459136, -605.7148053522383, -228.7661009838014, -1183.302855359788, -1044.2970075504468, -141.6855203603375, -896.6223660582131, -504.14661486951445, -597.0950533045074, -638.7398516064844, -738.5865444974601, -1264.7146979821962, -492.231403963719, -809.366093462577, -680.938332168672, -540.3794559617432, -312.4844449295009, -1191.2840882231185, -139.2202633079196, -840.1578671237594, -826.2815341808814, -967.0639174668473, -1116.8873944181082, -790.4798642725168, -903.267267183512, -1437.142211734454, -1257.1553771270671, -237.00917049228846, -686.3299957500511, -254.52142612375363, -1014.2742736871431, -104.34413800717185, -1068.7387802824226, -639.8653160387648, -415.3223450628107, -910.6448608836264, -839.0180366211899, -993.332816916274, -327.2146850742041, -367.24264094402736, -692.2142024220346, -721.0530074798123, -634.0395356633142, -575.3695971972334], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 50, 150, 150, 150, 150, 86, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 143, 69, 150, 150, 150, 150, 150, 82, 150, 88, 150, 71, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-564.0717502257194, -977.020761148782, -1247.4957385589162, -1181.2517189074672, -1282.2175524849615, -762.8888387398345, -1243.417264110943, -836.2696274689772, -467.8758038667279, -262.64718192698814, -540.2762008245302, -413.6761661822536, -261.31978192666924, -123.67838475094268, -483.6956040948021, -965.3838706361238, -1196.2640955012723, -461.16574948942815, -276.63425513732847, -1121.628544578697, -1122.9111707107663, -625.221448007056, -791.4714602506155, -1027.9954233278104, -1265.4204144139917, -856.5899401763982, -453.71298528167307, -960.636504583529, -666.147214125645, -250.67457416072017, -1127.8364299245732, -886.9250235185025, -203.9387790319125, -479.8122481308746, -1306.6726673563528, -316.6499084535419, -352.26967244852125, -1129.2672663386873, -646.9502000686018, -983.7993143908874, -965.0996921396734, -859.5728434144283, -1490.8719852492852, -698.0630844618896, -230.55696618909974, -914.7393814958257, -1052.6742666311754, -896.2602802887506, -143.11032857640328, -477.453911150619, -784.7303071454397, -1273.0929318473, -636.9316868227032, -473.75110748170226, -222.94500830067707, -689.5295542643511, -364.78046415459136, -605.7148053522383, -228.7661009838014, -1183.302855359788, -1044.2970075504468, -141.6855203603375, -896.6223660582131, -504.14661486951445, -597.0950533045074, -638.7398516064844, -738.5865444974601, -1264.7146979821962, -492.231403963719, -809.366093462577, -680.938332168672, -540.3794559617432, -312.4844449295009, -1191.2840882231185, -139.2202633079196, -840.1578671237594, -826.2815341808814, -967.0639174668473, -1116.8873944181082, -790.4798642725168, -903.267267183512, -1437.142211734454, -1257.1553771270671, -237.00917049228846, -686.3299957500511, -254.52142612375363, -1014.2742736871431, -104.34413800717185, -1068.7387802824226, -639.8653160387648, -415.3223450628107, -910.6448608836264, -839.0180366211899, -993.332816916274, -327.2146850742041, -367.24264094402736, -692.2142024220346, -721.0530074798123, -634.0395356633142, -575.3695971972334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524699749990968, "mean_inference_ms": 1.6751443950300138, "mean_action_processing_ms": 0.27919413910999896, "mean_env_wait_ms": 3.452108641440125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012923479080200195, "StateBufferConnector_ms": 0.007911205291748047, "ViewRequirementAgentConnector_ms": 0.19530606269836426}, "num_episodes": 25, "episode_return_max": -104.34413800717185, "episode_return_min": -1490.8719852492852, "episode_return_mean": -729.2649109697144, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.4142544178142, "num_env_steps_trained_throughput_per_sec": 323.4142544178142, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12600.262, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12600.188, "sample_time_ms": 1136.634, "learn_time_ms": 11398.881, "learn_throughput": 350.912, "synch_weights_time_ms": 63.885}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00014", "date": "2024-08-04_06-48-55", "timestamp": 1722734335, "time_this_iter_s": 12.380640268325806, "time_total_s": 201.86095333099365, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f48ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 201.86095333099365, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.527777777777775, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.50813762744266, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.9299209794650474, "policy_loss": -0.006326189250103198, "vf_loss": 2.947518383463224, "vf_explained_var": 0.9772270407527686, "kl": 0.01258110434094611, "entropy": 1.6932718178878228, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -61.68475611733897, "episode_reward_min": -1490.8719852492852, "episode_reward_mean": -738.5988728022048, "episode_len_mean": 141.56, "episode_media": {}, "episodes_timesteps_total": 14156, "policy_reward_min": {"policy_0": -1490.8719852492852}, "policy_reward_max": {"policy_0": -61.68475611733897}, "policy_reward_mean": {"policy_0": -738.5988728022048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-886.9250235185025, -203.9387790319125, -479.8122481308746, -1306.6726673563528, -316.6499084535419, -352.26967244852125, -1129.2672663386873, -646.9502000686018, -983.7993143908874, -965.0996921396734, -859.5728434144283, -1490.8719852492852, -698.0630844618896, -230.55696618909974, -914.7393814958257, -1052.6742666311754, -896.2602802887506, -143.11032857640328, -477.453911150619, -784.7303071454397, -1273.0929318473, -636.9316868227032, -473.75110748170226, -222.94500830067707, -689.5295542643511, -364.78046415459136, -605.7148053522383, -228.7661009838014, -1183.302855359788, -1044.2970075504468, -141.6855203603375, -896.6223660582131, -504.14661486951445, -597.0950533045074, -638.7398516064844, -738.5865444974601, -1264.7146979821962, -492.231403963719, -809.366093462577, -680.938332168672, -540.3794559617432, -312.4844449295009, -1191.2840882231185, -139.2202633079196, -840.1578671237594, -826.2815341808814, -967.0639174668473, -1116.8873944181082, -790.4798642725168, -903.267267183512, -1437.142211734454, -1257.1553771270671, -237.00917049228846, -686.3299957500511, -254.52142612375363, -1014.2742736871431, -104.34413800717185, -1068.7387802824226, -639.8653160387648, -415.3223450628107, -910.6448608836264, -839.0180366211899, -993.332816916274, -327.2146850742041, -367.24264094402736, -692.2142024220346, -721.0530074798123, -634.0395356633142, -575.3695971972334, -670.8135610498571, -772.7314559231161, -600.3865087565738, -647.1894906254358, -61.68475611733897, -506.6443053245793, -1058.7340132782567, -1031.1210148966852, -1470.1192145078114, -703.867470900908, -1086.0961852600976, -1108.099066435333, -781.978924717503, -524.3912087724514, -732.8614130902147, -325.221607764, -484.39185204282603, -489.58190276585486, -1413.073064994632, -912.4599396137326, -956.2322956305809, -1117.38118574754, -1057.6579095707386, -545.8554791723146, -629.9180334513911, -1110.1005695765873, -761.4616387589206, -546.0812643873211, -801.5707497408117, -969.6096798736568, -873.5768760261191], "episode_lengths": [150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 143, 69, 150, 150, 150, 150, 150, 82, 150, 88, 150, 71, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-886.9250235185025, -203.9387790319125, -479.8122481308746, -1306.6726673563528, -316.6499084535419, -352.26967244852125, -1129.2672663386873, -646.9502000686018, -983.7993143908874, -965.0996921396734, -859.5728434144283, -1490.8719852492852, -698.0630844618896, -230.55696618909974, -914.7393814958257, -1052.6742666311754, -896.2602802887506, -143.11032857640328, -477.453911150619, -784.7303071454397, -1273.0929318473, -636.9316868227032, -473.75110748170226, -222.94500830067707, -689.5295542643511, -364.78046415459136, -605.7148053522383, -228.7661009838014, -1183.302855359788, -1044.2970075504468, -141.6855203603375, -896.6223660582131, -504.14661486951445, -597.0950533045074, -638.7398516064844, -738.5865444974601, -1264.7146979821962, -492.231403963719, -809.366093462577, -680.938332168672, -540.3794559617432, -312.4844449295009, -1191.2840882231185, -139.2202633079196, -840.1578671237594, -826.2815341808814, -967.0639174668473, -1116.8873944181082, -790.4798642725168, -903.267267183512, -1437.142211734454, -1257.1553771270671, -237.00917049228846, -686.3299957500511, -254.52142612375363, -1014.2742736871431, -104.34413800717185, -1068.7387802824226, -639.8653160387648, -415.3223450628107, -910.6448608836264, -839.0180366211899, -993.332816916274, -327.2146850742041, -367.24264094402736, -692.2142024220346, -721.0530074798123, -634.0395356633142, -575.3695971972334, -670.8135610498571, -772.7314559231161, -600.3865087565738, -647.1894906254358, -61.68475611733897, -506.6443053245793, -1058.7340132782567, -1031.1210148966852, -1470.1192145078114, -703.867470900908, -1086.0961852600976, -1108.099066435333, -781.978924717503, -524.3912087724514, -732.8614130902147, -325.221607764, -484.39185204282603, -489.58190276585486, -1413.073064994632, -912.4599396137326, -956.2322956305809, -1117.38118574754, -1057.6579095707386, -545.8554791723146, -629.9180334513911, -1110.1005695765873, -761.4616387589206, -546.0812643873211, -801.5707497408117, -969.6096798736568, -873.5768760261191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523257037264979, "mean_inference_ms": 1.6748451562488842, "mean_action_processing_ms": 0.2787350503187084, "mean_env_wait_ms": 3.451349927741025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012594461441040039, "StateBufferConnector_ms": 0.007993936538696289, "ViewRequirementAgentConnector_ms": 0.197615385055542}, "num_episodes": 31, "episode_return_max": -61.68475611733897, "episode_return_min": -1490.8719852492852, "episode_return_mean": -738.5988728022048, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.59736305770633, "num_env_steps_trained_throughput_per_sec": 317.59736305770633, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12571.304, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12571.227, "sample_time_ms": 1135.961, "learn_time_ms": 11370.583, "learn_throughput": 351.785, "synch_weights_time_ms": 63.899}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00014", "date": "2024-08-04_06-49-08", "timestamp": 1722734348, "time_this_iter_s": 12.608801364898682, "time_total_s": 214.46975469589233, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.46975469589233, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.599999999999998, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.63927040696143, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.857629305186371, "policy_loss": -0.007357662406866439, "vf_loss": 2.8722391062726578, "vf_explained_var": 0.9883098036671678, "kl": 0.01587531030521253, "entropy": 1.439602605998516, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -24.543732415963586, "episode_reward_min": -1470.1192145078114, "episode_reward_mean": -759.4060161005021, "episode_len_mean": 143.15, "episode_media": {}, "episodes_timesteps_total": 14315, "policy_reward_min": {"policy_0": -1470.1192145078114}, "policy_reward_max": {"policy_0": -24.543732415963586}, "policy_reward_mean": {"policy_0": -759.4060161005021}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-228.7661009838014, -1183.302855359788, -1044.2970075504468, -141.6855203603375, -896.6223660582131, -504.14661486951445, -597.0950533045074, -638.7398516064844, -738.5865444974601, -1264.7146979821962, -492.231403963719, -809.366093462577, -680.938332168672, -540.3794559617432, -312.4844449295009, -1191.2840882231185, -139.2202633079196, -840.1578671237594, -826.2815341808814, -967.0639174668473, -1116.8873944181082, -790.4798642725168, -903.267267183512, -1437.142211734454, -1257.1553771270671, -237.00917049228846, -686.3299957500511, -254.52142612375363, -1014.2742736871431, -104.34413800717185, -1068.7387802824226, -639.8653160387648, -415.3223450628107, -910.6448608836264, -839.0180366211899, -993.332816916274, -327.2146850742041, -367.24264094402736, -692.2142024220346, -721.0530074798123, -634.0395356633142, -575.3695971972334, -670.8135610498571, -772.7314559231161, -600.3865087565738, -647.1894906254358, -61.68475611733897, -506.6443053245793, -1058.7340132782567, -1031.1210148966852, -1470.1192145078114, -703.867470900908, -1086.0961852600976, -1108.099066435333, -781.978924717503, -524.3912087724514, -732.8614130902147, -325.221607764, -484.39185204282603, -489.58190276585486, -1413.073064994632, -912.4599396137326, -956.2322956305809, -1117.38118574754, -1057.6579095707386, -545.8554791723146, -629.9180334513911, -1110.1005695765873, -761.4616387589206, -546.0812643873211, -801.5707497408117, -969.6096798736568, -873.5768760261191, -24.543732415963586, -500.6720978202764, -1377.7413858882312, -961.6496383877673, -358.09785955231354, -1220.1618860599879, -682.7534115389551, -1106.7397355357352, -562.2664266414635, -769.8977066399754, -655.5713581031079, -674.3937804484863, -908.6154471401854, -240.01768493943788, -400.18923416765034, -1079.133885923153, -420.30544919579626, -539.0246449395028, -1083.3974293207584, -721.9157622116793, -1240.4392679614966, -1156.9500678667312, -1014.1604126429768, -672.0619769216919, -843.437860041239, -604.369267525463, -1348.3706047037479], "episode_lengths": [71, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-228.7661009838014, -1183.302855359788, -1044.2970075504468, -141.6855203603375, -896.6223660582131, -504.14661486951445, -597.0950533045074, -638.7398516064844, -738.5865444974601, -1264.7146979821962, -492.231403963719, -809.366093462577, -680.938332168672, -540.3794559617432, -312.4844449295009, -1191.2840882231185, -139.2202633079196, -840.1578671237594, -826.2815341808814, -967.0639174668473, -1116.8873944181082, -790.4798642725168, -903.267267183512, -1437.142211734454, -1257.1553771270671, -237.00917049228846, -686.3299957500511, -254.52142612375363, -1014.2742736871431, -104.34413800717185, -1068.7387802824226, -639.8653160387648, -415.3223450628107, -910.6448608836264, -839.0180366211899, -993.332816916274, -327.2146850742041, -367.24264094402736, -692.2142024220346, -721.0530074798123, -634.0395356633142, -575.3695971972334, -670.8135610498571, -772.7314559231161, -600.3865087565738, -647.1894906254358, -61.68475611733897, -506.6443053245793, -1058.7340132782567, -1031.1210148966852, -1470.1192145078114, -703.867470900908, -1086.0961852600976, -1108.099066435333, -781.978924717503, -524.3912087724514, -732.8614130902147, -325.221607764, -484.39185204282603, -489.58190276585486, -1413.073064994632, -912.4599396137326, -956.2322956305809, -1117.38118574754, -1057.6579095707386, -545.8554791723146, -629.9180334513911, -1110.1005695765873, -761.4616387589206, -546.0812643873211, -801.5707497408117, -969.6096798736568, -873.5768760261191, -24.543732415963586, -500.6720978202764, -1377.7413858882312, -961.6496383877673, -358.09785955231354, -1220.1618860599879, -682.7534115389551, -1106.7397355357352, -562.2664266414635, -769.8977066399754, -655.5713581031079, -674.3937804484863, -908.6154471401854, -240.01768493943788, -400.18923416765034, -1079.133885923153, -420.30544919579626, -539.0246449395028, -1083.3974293207584, -721.9157622116793, -1240.4392679614966, -1156.9500678667312, -1014.1604126429768, -672.0619769216919, -843.437860041239, -604.369267525463, -1348.3706047037479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522119728511119, "mean_inference_ms": 1.6736667032330603, "mean_action_processing_ms": 0.2783119256934432, "mean_env_wait_ms": 3.4500210208571986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012542247772216797, "StateBufferConnector_ms": 0.007947683334350586, "ViewRequirementAgentConnector_ms": 0.19455170631408691}, "num_episodes": 27, "episode_return_max": -24.543732415963586, "episode_return_min": -1470.1192145078114, "episode_return_mean": -759.4060161005021, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.530186717091, "num_env_steps_trained_throughput_per_sec": 313.530186717091, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12561.372, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12561.295, "sample_time_ms": 1133.025, "learn_time_ms": 11363.634, "learn_throughput": 352.0, "synch_weights_time_ms": 63.866}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00014", "date": "2024-08-04_06-49-20", "timestamp": 1722734360, "time_this_iter_s": 12.770448207855225, "time_total_s": 227.24020290374756, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.24020290374756, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.450000000000003, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.60072782039643, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.4021622584511837, "policy_loss": -0.010840028290112968, "vf_loss": 3.420827026416858, "vf_explained_var": 0.9793209068477153, "kl": 0.012383303345874707, "entropy": 1.339722984408339, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -24.543732415963586, "episode_reward_min": -1470.1192145078114, "episode_reward_mean": -728.2674056446891, "episode_len_mean": 143.54, "episode_media": {}, "episodes_timesteps_total": 14354, "policy_reward_min": {"policy_0": -1470.1192145078114}, "policy_reward_max": {"policy_0": -24.543732415963586}, "policy_reward_mean": {"policy_0": -728.2674056446891}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-910.6448608836264, -839.0180366211899, -993.332816916274, -327.2146850742041, -367.24264094402736, -692.2142024220346, -721.0530074798123, -634.0395356633142, -575.3695971972334, -670.8135610498571, -772.7314559231161, -600.3865087565738, -647.1894906254358, -61.68475611733897, -506.6443053245793, -1058.7340132782567, -1031.1210148966852, -1470.1192145078114, -703.867470900908, -1086.0961852600976, -1108.099066435333, -781.978924717503, -524.3912087724514, -732.8614130902147, -325.221607764, -484.39185204282603, -489.58190276585486, -1413.073064994632, -912.4599396137326, -956.2322956305809, -1117.38118574754, -1057.6579095707386, -545.8554791723146, -629.9180334513911, -1110.1005695765873, -761.4616387589206, -546.0812643873211, -801.5707497408117, -969.6096798736568, -873.5768760261191, -24.543732415963586, -500.6720978202764, -1377.7413858882312, -961.6496383877673, -358.09785955231354, -1220.1618860599879, -682.7534115389551, -1106.7397355357352, -562.2664266414635, -769.8977066399754, -655.5713581031079, -674.3937804484863, -908.6154471401854, -240.01768493943788, -400.18923416765034, -1079.133885923153, -420.30544919579626, -539.0246449395028, -1083.3974293207584, -721.9157622116793, -1240.4392679614966, -1156.9500678667312, -1014.1604126429768, -672.0619769216919, -843.437860041239, -604.369267525463, -1348.3706047037479, -1293.5633425992348, -730.7516801979656, -113.3213064170597, -416.93177664652205, -721.6168976380492, -751.2427557121931, -326.79761796574525, -566.2557337224515, -582.9937911874941, -726.1556628432221, -475.74388440620737, -466.375404696019, -865.5296792411347, -828.8259343338368, -724.7755670904787, -366.84915688835946, -110.76198962688557, -170.7161735234695, -490.04792575578756, -930.9613095964538, -1074.9744593807095, -341.77498821560897, -723.0720385488146, -922.8603124234327, -396.0599640428516, -695.1542710728163, -1269.1733547905292, -778.7993760097141, -512.7015696044498, -610.2575061185524, -892.7815091166858, -555.6689886988374, -415.34459984867925], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 56, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 126], "policy_policy_0_reward": [-910.6448608836264, -839.0180366211899, -993.332816916274, -327.2146850742041, -367.24264094402736, -692.2142024220346, -721.0530074798123, -634.0395356633142, -575.3695971972334, -670.8135610498571, -772.7314559231161, -600.3865087565738, -647.1894906254358, -61.68475611733897, -506.6443053245793, -1058.7340132782567, -1031.1210148966852, -1470.1192145078114, -703.867470900908, -1086.0961852600976, -1108.099066435333, -781.978924717503, -524.3912087724514, -732.8614130902147, -325.221607764, -484.39185204282603, -489.58190276585486, -1413.073064994632, -912.4599396137326, -956.2322956305809, -1117.38118574754, -1057.6579095707386, -545.8554791723146, -629.9180334513911, -1110.1005695765873, -761.4616387589206, -546.0812643873211, -801.5707497408117, -969.6096798736568, -873.5768760261191, -24.543732415963586, -500.6720978202764, -1377.7413858882312, -961.6496383877673, -358.09785955231354, -1220.1618860599879, -682.7534115389551, -1106.7397355357352, -562.2664266414635, -769.8977066399754, -655.5713581031079, -674.3937804484863, -908.6154471401854, -240.01768493943788, -400.18923416765034, -1079.133885923153, -420.30544919579626, -539.0246449395028, -1083.3974293207584, -721.9157622116793, -1240.4392679614966, -1156.9500678667312, -1014.1604126429768, -672.0619769216919, -843.437860041239, -604.369267525463, -1348.3706047037479, -1293.5633425992348, -730.7516801979656, -113.3213064170597, -416.93177664652205, -721.6168976380492, -751.2427557121931, -326.79761796574525, -566.2557337224515, -582.9937911874941, -726.1556628432221, -475.74388440620737, -466.375404696019, -865.5296792411347, -828.8259343338368, -724.7755670904787, -366.84915688835946, -110.76198962688557, -170.7161735234695, -490.04792575578756, -930.9613095964538, -1074.9744593807095, -341.77498821560897, -723.0720385488146, -922.8603124234327, -396.0599640428516, -695.1542710728163, -1269.1733547905292, -778.7993760097141, -512.7015696044498, -610.2575061185524, -892.7815091166858, -555.6689886988374, -415.34459984867925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519802911799099, "mean_inference_ms": 1.6731963439031494, "mean_action_processing_ms": 0.277871666592223, "mean_env_wait_ms": 3.4490246919853376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012411117553710938, "StateBufferConnector_ms": 0.007988929748535156, "ViewRequirementAgentConnector_ms": 0.20224213600158691}, "num_episodes": 33, "episode_return_max": -24.543732415963586, "episode_return_min": -1470.1192145078114, "episode_return_mean": -728.2674056446891, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 461.98495446972055, "num_env_steps_trained_throughput_per_sec": 461.98495446972055, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12177.036, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12176.959, "sample_time_ms": 1148.016, "learn_time_ms": 10963.961, "learn_throughput": 364.832, "synch_weights_time_ms": 64.203}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00014", "date": "2024-08-04_06-49-29", "timestamp": 1722734369, "time_this_iter_s": 8.67020297050476, "time_total_s": 235.91040587425232, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.91040587425232, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.761538461538464, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.47565650542577, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.72087856605649, "policy_loss": -0.012580415045764919, "vf_loss": 2.7412805572152137, "vf_explained_var": 0.9886774654810627, "kl": 0.015891008988607305, "entropy": 1.4972529210150243, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -24.543732415963586, "episode_reward_min": -1377.7413858882312, "episode_reward_mean": -724.6362817192977, "episode_len_mean": 142.62, "episode_media": {}, "episodes_timesteps_total": 14262, "policy_reward_min": {"policy_0": -1377.7413858882312}, "policy_reward_max": {"policy_0": -24.543732415963586}, "policy_reward_mean": {"policy_0": -724.6362817192977}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-912.4599396137326, -956.2322956305809, -1117.38118574754, -1057.6579095707386, -545.8554791723146, -629.9180334513911, -1110.1005695765873, -761.4616387589206, -546.0812643873211, -801.5707497408117, -969.6096798736568, -873.5768760261191, -24.543732415963586, -500.6720978202764, -1377.7413858882312, -961.6496383877673, -358.09785955231354, -1220.1618860599879, -682.7534115389551, -1106.7397355357352, -562.2664266414635, -769.8977066399754, -655.5713581031079, -674.3937804484863, -908.6154471401854, -240.01768493943788, -400.18923416765034, -1079.133885923153, -420.30544919579626, -539.0246449395028, -1083.3974293207584, -721.9157622116793, -1240.4392679614966, -1156.9500678667312, -1014.1604126429768, -672.0619769216919, -843.437860041239, -604.369267525463, -1348.3706047037479, -1293.5633425992348, -730.7516801979656, -113.3213064170597, -416.93177664652205, -721.6168976380492, -751.2427557121931, -326.79761796574525, -566.2557337224515, -582.9937911874941, -726.1556628432221, -475.74388440620737, -466.375404696019, -865.5296792411347, -828.8259343338368, -724.7755670904787, -366.84915688835946, -110.76198962688557, -170.7161735234695, -490.04792575578756, -930.9613095964538, -1074.9744593807095, -341.77498821560897, -723.0720385488146, -922.8603124234327, -396.0599640428516, -695.1542710728163, -1269.1733547905292, -778.7993760097141, -512.7015696044498, -610.2575061185524, -892.7815091166858, -555.6689886988374, -415.34459984867925, -1109.261062588371, -1051.50254876439, -348.75493031033005, -1002.3592253143316, -443.02170462924306, -295.8653224544775, -746.0189049695534, -1079.7091712853935, -455.7766793532235, -932.3010076298267, -975.3987352943598, -965.9661381084912, -363.3041873500796, -322.8346081597254, -834.4668676411708, -1188.0900017089689, -730.5880899366487, -950.4322349330315, -420.720388060194, -676.6019482219838, -1036.3366701802986, -613.8400098312173, -209.93646515115938, -497.21919113451236, -1295.3323359591325, -387.19447314390857, -980.3108105506793, -252.86029522133123], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 56, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 126, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 122, 150, 150, 150, 64, 150, 150, 150, 150, 87], "policy_policy_0_reward": [-912.4599396137326, -956.2322956305809, -1117.38118574754, -1057.6579095707386, -545.8554791723146, -629.9180334513911, -1110.1005695765873, -761.4616387589206, -546.0812643873211, -801.5707497408117, -969.6096798736568, -873.5768760261191, -24.543732415963586, -500.6720978202764, -1377.7413858882312, -961.6496383877673, -358.09785955231354, -1220.1618860599879, -682.7534115389551, -1106.7397355357352, -562.2664266414635, -769.8977066399754, -655.5713581031079, -674.3937804484863, -908.6154471401854, -240.01768493943788, -400.18923416765034, -1079.133885923153, -420.30544919579626, -539.0246449395028, -1083.3974293207584, -721.9157622116793, -1240.4392679614966, -1156.9500678667312, -1014.1604126429768, -672.0619769216919, -843.437860041239, -604.369267525463, -1348.3706047037479, -1293.5633425992348, -730.7516801979656, -113.3213064170597, -416.93177664652205, -721.6168976380492, -751.2427557121931, -326.79761796574525, -566.2557337224515, -582.9937911874941, -726.1556628432221, -475.74388440620737, -466.375404696019, -865.5296792411347, -828.8259343338368, -724.7755670904787, -366.84915688835946, -110.76198962688557, -170.7161735234695, -490.04792575578756, -930.9613095964538, -1074.9744593807095, -341.77498821560897, -723.0720385488146, -922.8603124234327, -396.0599640428516, -695.1542710728163, -1269.1733547905292, -778.7993760097141, -512.7015696044498, -610.2575061185524, -892.7815091166858, -555.6689886988374, -415.34459984867925, -1109.261062588371, -1051.50254876439, -348.75493031033005, -1002.3592253143316, -443.02170462924306, -295.8653224544775, -746.0189049695534, -1079.7091712853935, -455.7766793532235, -932.3010076298267, -975.3987352943598, -965.9661381084912, -363.3041873500796, -322.8346081597254, -834.4668676411708, -1188.0900017089689, -730.5880899366487, -950.4322349330315, -420.720388060194, -676.6019482219838, -1036.3366701802986, -613.8400098312173, -209.93646515115938, -497.21919113451236, -1295.3323359591325, -387.19447314390857, -980.3108105506793, -252.86029522133123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515902143332113, "mean_inference_ms": 1.6719023186849788, "mean_action_processing_ms": 0.27737182711332575, "mean_env_wait_ms": 3.44696400301613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012344121932983398, "StateBufferConnector_ms": 0.007919073104858398, "ViewRequirementAgentConnector_ms": 0.20027899742126465}, "num_episodes": 28, "episode_return_max": -24.543732415963586, "episode_return_min": -1377.7413858882312, "episode_return_mean": -724.6362817192977, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3866271984727, "num_env_steps_trained_throughput_per_sec": 310.3866271984727, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12202.419, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12202.338, "sample_time_ms": 1143.401, "learn_time_ms": 10992.969, "learn_throughput": 363.869, "synch_weights_time_ms": 65.18}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00014", "date": "2024-08-04_06-49-42", "timestamp": 1722734382, "time_this_iter_s": 12.900978565216064, "time_total_s": 248.81138443946838, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 248.81138443946838, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.616666666666667, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.08717833757402, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.925707594305277, "policy_loss": -0.011164586934319232, "vf_loss": 2.944816795736551, "vf_explained_var": 0.9866343004629016, "kl": 0.015634695589991074, "entropy": 1.4980239098270733, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -12.362796683573976, "episode_reward_min": -1348.3706047037479, "episode_reward_mean": -699.6821969680988, "episode_len_mean": 139.99, "episode_media": {}, "episodes_timesteps_total": 13999, "policy_reward_min": {"policy_0": -1348.3706047037479}, "policy_reward_max": {"policy_0": -12.362796683573976}, "policy_reward_mean": {"policy_0": -699.6821969680988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-420.30544919579626, -539.0246449395028, -1083.3974293207584, -721.9157622116793, -1240.4392679614966, -1156.9500678667312, -1014.1604126429768, -672.0619769216919, -843.437860041239, -604.369267525463, -1348.3706047037479, -1293.5633425992348, -730.7516801979656, -113.3213064170597, -416.93177664652205, -721.6168976380492, -751.2427557121931, -326.79761796574525, -566.2557337224515, -582.9937911874941, -726.1556628432221, -475.74388440620737, -466.375404696019, -865.5296792411347, -828.8259343338368, -724.7755670904787, -366.84915688835946, -110.76198962688557, -170.7161735234695, -490.04792575578756, -930.9613095964538, -1074.9744593807095, -341.77498821560897, -723.0720385488146, -922.8603124234327, -396.0599640428516, -695.1542710728163, -1269.1733547905292, -778.7993760097141, -512.7015696044498, -610.2575061185524, -892.7815091166858, -555.6689886988374, -415.34459984867925, -1109.261062588371, -1051.50254876439, -348.75493031033005, -1002.3592253143316, -443.02170462924306, -295.8653224544775, -746.0189049695534, -1079.7091712853935, -455.7766793532235, -932.3010076298267, -975.3987352943598, -965.9661381084912, -363.3041873500796, -322.8346081597254, -834.4668676411708, -1188.0900017089689, -730.5880899366487, -950.4322349330315, -420.720388060194, -676.6019482219838, -1036.3366701802986, -613.8400098312173, -209.93646515115938, -497.21919113451236, -1295.3323359591325, -387.19447314390857, -980.3108105506793, -252.86029522133123, -1275.7933356458136, -529.3664756001334, -619.2142643014299, -1160.2813958877025, -1066.6239180787977, -35.374798059562636, -1187.3366249361625, -458.6653061517963, -192.71422948654202, -1124.8054591557107, -356.0682627601146, -1235.2523083114975, -484.7877648930173, -326.51859160931934, -858.436927833699, -727.6048994856404, -517.0734726221889, -158.23857840888041, -1058.1652493199126, -511.2728008735845, -486.6404174109999, -981.106919023238, -391.89832615323667, -1163.3965146237044, -12.362796683573976, -1117.8507010869214, -476.73161942476025, -795.3604598045689], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 56, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 126, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 122, 150, 150, 150, 64, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 88, 150, 114, 102, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150], "policy_policy_0_reward": [-420.30544919579626, -539.0246449395028, -1083.3974293207584, -721.9157622116793, -1240.4392679614966, -1156.9500678667312, -1014.1604126429768, -672.0619769216919, -843.437860041239, -604.369267525463, -1348.3706047037479, -1293.5633425992348, -730.7516801979656, -113.3213064170597, -416.93177664652205, -721.6168976380492, -751.2427557121931, -326.79761796574525, -566.2557337224515, -582.9937911874941, -726.1556628432221, -475.74388440620737, -466.375404696019, -865.5296792411347, -828.8259343338368, -724.7755670904787, -366.84915688835946, -110.76198962688557, -170.7161735234695, -490.04792575578756, -930.9613095964538, -1074.9744593807095, -341.77498821560897, -723.0720385488146, -922.8603124234327, -396.0599640428516, -695.1542710728163, -1269.1733547905292, -778.7993760097141, -512.7015696044498, -610.2575061185524, -892.7815091166858, -555.6689886988374, -415.34459984867925, -1109.261062588371, -1051.50254876439, -348.75493031033005, -1002.3592253143316, -443.02170462924306, -295.8653224544775, -746.0189049695534, -1079.7091712853935, -455.7766793532235, -932.3010076298267, -975.3987352943598, -965.9661381084912, -363.3041873500796, -322.8346081597254, -834.4668676411708, -1188.0900017089689, -730.5880899366487, -950.4322349330315, -420.720388060194, -676.6019482219838, -1036.3366701802986, -613.8400098312173, -209.93646515115938, -497.21919113451236, -1295.3323359591325, -387.19447314390857, -980.3108105506793, -252.86029522133123, -1275.7933356458136, -529.3664756001334, -619.2142643014299, -1160.2813958877025, -1066.6239180787977, -35.374798059562636, -1187.3366249361625, -458.6653061517963, -192.71422948654202, -1124.8054591557107, -356.0682627601146, -1235.2523083114975, -484.7877648930173, -326.51859160931934, -858.436927833699, -727.6048994856404, -517.0734726221889, -158.23857840888041, -1058.1652493199126, -511.2728008735845, -486.6404174109999, -981.106919023238, -391.89832615323667, -1163.3965146237044, -12.362796683573976, -1117.8507010869214, -476.73161942476025, -795.3604598045689]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516642221670532, "mean_inference_ms": 1.6733148445445027, "mean_action_processing_ms": 0.2773588964124521, "mean_env_wait_ms": 3.446863578065292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012179136276245117, "StateBufferConnector_ms": 0.007852554321289062, "ViewRequirementAgentConnector_ms": 0.20046210289001465}, "num_episodes": 28, "episode_return_max": -12.362796683573976, "episode_return_min": -1348.3706047037479, "episode_return_mean": -699.6821969680988, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.4707403033592, "num_env_steps_trained_throughput_per_sec": 306.4707403033592, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12240.196, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12240.116, "sample_time_ms": 1146.283, "learn_time_ms": 11028.335, "learn_throughput": 362.702, "synch_weights_time_ms": 64.716}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00014", "date": "2024-08-04_06-49-55", "timestamp": 1722734395, "time_this_iter_s": 13.065923690795898, "time_total_s": 261.8773081302643, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370990c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 261.8773081302643, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.36315789473684, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.17592562834423, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.319147553667426, "policy_loss": -0.009340147777402307, "vf_loss": 2.3369411138196785, "vf_explained_var": 0.9851203696802259, "kl": 0.013379321147597996, "entropy": 1.4474109074721733, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -12.362796683573976, "episode_reward_min": -1295.3323359591325, "episode_reward_mean": -668.6190911035833, "episode_len_mean": 137.5, "episode_media": {}, "episodes_timesteps_total": 13750, "policy_reward_min": {"policy_0": -1295.3323359591325}, "policy_reward_max": {"policy_0": -12.362796683573976}, "policy_reward_mean": {"policy_0": -668.6190911035833}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.76198962688557, -170.7161735234695, -490.04792575578756, -930.9613095964538, -1074.9744593807095, -341.77498821560897, -723.0720385488146, -922.8603124234327, -396.0599640428516, -695.1542710728163, -1269.1733547905292, -778.7993760097141, -512.7015696044498, -610.2575061185524, -892.7815091166858, -555.6689886988374, -415.34459984867925, -1109.261062588371, -1051.50254876439, -348.75493031033005, -1002.3592253143316, -443.02170462924306, -295.8653224544775, -746.0189049695534, -1079.7091712853935, -455.7766793532235, -932.3010076298267, -975.3987352943598, -965.9661381084912, -363.3041873500796, -322.8346081597254, -834.4668676411708, -1188.0900017089689, -730.5880899366487, -950.4322349330315, -420.720388060194, -676.6019482219838, -1036.3366701802986, -613.8400098312173, -209.93646515115938, -497.21919113451236, -1295.3323359591325, -387.19447314390857, -980.3108105506793, -252.86029522133123, -1275.7933356458136, -529.3664756001334, -619.2142643014299, -1160.2813958877025, -1066.6239180787977, -35.374798059562636, -1187.3366249361625, -458.6653061517963, -192.71422948654202, -1124.8054591557107, -356.0682627601146, -1235.2523083114975, -484.7877648930173, -326.51859160931934, -858.436927833699, -727.6048994856404, -517.0734726221889, -158.23857840888041, -1058.1652493199126, -511.2728008735845, -486.6404174109999, -981.106919023238, -391.89832615323667, -1163.3965146237044, -12.362796683573976, -1117.8507010869214, -476.73161942476025, -795.3604598045689, -640.2785517613013, -874.6939532044149, -611.5465998632817, -847.3091236601101, -128.02878579390918, -749.7257196342406, -782.1622781774323, -836.1730316603229, -462.22527008724563, -267.6203342028194, -366.47545550731365, -545.3927406687476, -943.8995598112335, -401.8760456034131, -377.814953274452, -619.6026222599778, -597.1113244107473, -215.32660654906135, -117.83306198056866, -973.8254922720636, -451.12715473949123, -568.7687699468302, -922.0507645883282, -489.3402211958315, -989.0885198215991, -832.724094576056, -883.8313132147334], "episode_lengths": [56, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 126, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 122, 150, 150, 150, 64, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 88, 150, 114, 102, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 97, 150, 148, 150, 101, 94, 150, 150, 94, 67, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-110.76198962688557, -170.7161735234695, -490.04792575578756, -930.9613095964538, -1074.9744593807095, -341.77498821560897, -723.0720385488146, -922.8603124234327, -396.0599640428516, -695.1542710728163, -1269.1733547905292, -778.7993760097141, -512.7015696044498, -610.2575061185524, -892.7815091166858, -555.6689886988374, -415.34459984867925, -1109.261062588371, -1051.50254876439, -348.75493031033005, -1002.3592253143316, -443.02170462924306, -295.8653224544775, -746.0189049695534, -1079.7091712853935, -455.7766793532235, -932.3010076298267, -975.3987352943598, -965.9661381084912, -363.3041873500796, -322.8346081597254, -834.4668676411708, -1188.0900017089689, -730.5880899366487, -950.4322349330315, -420.720388060194, -676.6019482219838, -1036.3366701802986, -613.8400098312173, -209.93646515115938, -497.21919113451236, -1295.3323359591325, -387.19447314390857, -980.3108105506793, -252.86029522133123, -1275.7933356458136, -529.3664756001334, -619.2142643014299, -1160.2813958877025, -1066.6239180787977, -35.374798059562636, -1187.3366249361625, -458.6653061517963, -192.71422948654202, -1124.8054591557107, -356.0682627601146, -1235.2523083114975, -484.7877648930173, -326.51859160931934, -858.436927833699, -727.6048994856404, -517.0734726221889, -158.23857840888041, -1058.1652493199126, -511.2728008735845, -486.6404174109999, -981.106919023238, -391.89832615323667, -1163.3965146237044, -12.362796683573976, -1117.8507010869214, -476.73161942476025, -795.3604598045689, -640.2785517613013, -874.6939532044149, -611.5465998632817, -847.3091236601101, -128.02878579390918, -749.7257196342406, -782.1622781774323, -836.1730316603229, -462.22527008724563, -267.6203342028194, -366.47545550731365, -545.3927406687476, -943.8995598112335, -401.8760456034131, -377.814953274452, -619.6026222599778, -597.1113244107473, -215.32660654906135, -117.83306198056866, -973.8254922720636, -451.12715473949123, -568.7687699468302, -922.0507645883282, -489.3402211958315, -989.0885198215991, -832.724094576056, -883.8313132147334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515836194627339, "mean_inference_ms": 1.6733595663353042, "mean_action_processing_ms": 0.2771357596428755, "mean_env_wait_ms": 3.4467964924365027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181520462036133, "StateBufferConnector_ms": 0.007899761199951172, "ViewRequirementAgentConnector_ms": 0.19554853439331055}, "num_episodes": 27, "episode_return_max": -12.362796683573976, "episode_return_min": -1295.3323359591325, "episode_return_mean": -668.6190911035833, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.39145364427065, "num_env_steps_trained_throughput_per_sec": 311.39145364427065, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12225.583, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12225.504, "sample_time_ms": 1130.567, "learn_time_ms": 11030.228, "learn_throughput": 362.64, "synch_weights_time_ms": 63.911}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00014", "date": "2024-08-04_06-50-08", "timestamp": 1722734408, "time_this_iter_s": 12.857484817504883, "time_total_s": 274.73479294776917, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080a680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 274.73479294776917, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.6, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.5110967318217, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.847367948293686, "policy_loss": -0.01352224354535186, "vf_loss": 2.868105105186502, "vf_explained_var": 0.9838742108394702, "kl": 0.01462607531351147, "entropy": 1.3796647886435192, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -12.362796683573976, "episode_reward_min": -1295.3323359591325, "episode_reward_mean": -639.1133477352629, "episode_len_mean": 137.09, "episode_media": {}, "episodes_timesteps_total": 13709, "policy_reward_min": {"policy_0": -1295.3323359591325}, "policy_reward_max": {"policy_0": -12.362796683573976}, "policy_reward_mean": {"policy_0": -639.1133477352629}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-965.9661381084912, -363.3041873500796, -322.8346081597254, -834.4668676411708, -1188.0900017089689, -730.5880899366487, -950.4322349330315, -420.720388060194, -676.6019482219838, -1036.3366701802986, -613.8400098312173, -209.93646515115938, -497.21919113451236, -1295.3323359591325, -387.19447314390857, -980.3108105506793, -252.86029522133123, -1275.7933356458136, -529.3664756001334, -619.2142643014299, -1160.2813958877025, -1066.6239180787977, -35.374798059562636, -1187.3366249361625, -458.6653061517963, -192.71422948654202, -1124.8054591557107, -356.0682627601146, -1235.2523083114975, -484.7877648930173, -326.51859160931934, -858.436927833699, -727.6048994856404, -517.0734726221889, -158.23857840888041, -1058.1652493199126, -511.2728008735845, -486.6404174109999, -981.106919023238, -391.89832615323667, -1163.3965146237044, -12.362796683573976, -1117.8507010869214, -476.73161942476025, -795.3604598045689, -640.2785517613013, -874.6939532044149, -611.5465998632817, -847.3091236601101, -128.02878579390918, -749.7257196342406, -782.1622781774323, -836.1730316603229, -462.22527008724563, -267.6203342028194, -366.47545550731365, -545.3927406687476, -943.8995598112335, -401.8760456034131, -377.814953274452, -619.6026222599778, -597.1113244107473, -215.32660654906135, -117.83306198056866, -973.8254922720636, -451.12715473949123, -568.7687699468302, -922.0507645883282, -489.3402211958315, -989.0885198215991, -832.724094576056, -883.8313132147334, -210.76365769771067, -1206.5498288889721, -593.7933946269941, -1056.9613426581907, -410.03089171089005, -354.3698705074815, -714.4346708174328, -414.72570825021893, -374.09343056180546, -349.40532927087787, -996.7227530907579, -763.2288896342056, -276.8497645479639, -276.63210728545266, -204.97589206900386, -893.266131551348, -965.079898813537, -324.11293407775366, -572.4859015391146, -1124.0221270658917, -159.91930652516874, -655.7448803917014, -775.2483658518562, -676.6836493129584, -601.4357434588035, -458.6901694325106, -671.2050093551604, -299.0736431419615], "episode_lengths": [150, 112, 150, 150, 150, 150, 150, 122, 150, 150, 150, 64, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 88, 150, 114, 102, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 97, 150, 148, 150, 101, 94, 150, 150, 94, 67, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 137, 64, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 98, 150, 150], "policy_policy_0_reward": [-965.9661381084912, -363.3041873500796, -322.8346081597254, -834.4668676411708, -1188.0900017089689, -730.5880899366487, -950.4322349330315, -420.720388060194, -676.6019482219838, -1036.3366701802986, -613.8400098312173, -209.93646515115938, -497.21919113451236, -1295.3323359591325, -387.19447314390857, -980.3108105506793, -252.86029522133123, -1275.7933356458136, -529.3664756001334, -619.2142643014299, -1160.2813958877025, -1066.6239180787977, -35.374798059562636, -1187.3366249361625, -458.6653061517963, -192.71422948654202, -1124.8054591557107, -356.0682627601146, -1235.2523083114975, -484.7877648930173, -326.51859160931934, -858.436927833699, -727.6048994856404, -517.0734726221889, -158.23857840888041, -1058.1652493199126, -511.2728008735845, -486.6404174109999, -981.106919023238, -391.89832615323667, -1163.3965146237044, -12.362796683573976, -1117.8507010869214, -476.73161942476025, -795.3604598045689, -640.2785517613013, -874.6939532044149, -611.5465998632817, -847.3091236601101, -128.02878579390918, -749.7257196342406, -782.1622781774323, -836.1730316603229, -462.22527008724563, -267.6203342028194, -366.47545550731365, -545.3927406687476, -943.8995598112335, -401.8760456034131, -377.814953274452, -619.6026222599778, -597.1113244107473, -215.32660654906135, -117.83306198056866, -973.8254922720636, -451.12715473949123, -568.7687699468302, -922.0507645883282, -489.3402211958315, -989.0885198215991, -832.724094576056, -883.8313132147334, -210.76365769771067, -1206.5498288889721, -593.7933946269941, -1056.9613426581907, -410.03089171089005, -354.3698705074815, -714.4346708174328, -414.72570825021893, -374.09343056180546, -349.40532927087787, -996.7227530907579, -763.2288896342056, -276.8497645479639, -276.63210728545266, -204.97589206900386, -893.266131551348, -965.079898813537, -324.11293407775366, -572.4859015391146, -1124.0221270658917, -159.91930652516874, -655.7448803917014, -775.2483658518562, -676.6836493129584, -601.4357434588035, -458.6901694325106, -671.2050093551604, -299.0736431419615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527003689110412, "mean_inference_ms": 1.6743568068479413, "mean_action_processing_ms": 0.2775841833871701, "mean_env_wait_ms": 3.452224004106558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012174606323242188, "StateBufferConnector_ms": 0.007847070693969727, "ViewRequirementAgentConnector_ms": 0.1938765048980713}, "num_episodes": 28, "episode_return_max": -12.362796683573976, "episode_return_min": -1295.3323359591325, "episode_return_mean": -639.1133477352629, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.22855032932404, "num_env_steps_trained_throughput_per_sec": 305.22855032932404, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12419.001, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12418.922, "sample_time_ms": 1133.356, "learn_time_ms": 11219.84, "learn_throughput": 356.511, "synch_weights_time_ms": 64.923}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00014", "date": "2024-08-04_06-50-21", "timestamp": 1722734421, "time_this_iter_s": 13.116906881332397, "time_total_s": 287.85169982910156, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.85169982910156, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.02631578947368, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.20971439282098, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.994286723807454, "policy_loss": -0.020066681615814257, "vf_loss": 3.021151979640126, "vf_explained_var": 0.9884791012232502, "kl": 0.015445496176607777, "entropy": 1.3749049942940474, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -12.362796683573976, "episode_reward_min": -1255.1038227482038, "episode_reward_mean": -622.3556777898144, "episode_len_mean": 138.32, "episode_media": {}, "episodes_timesteps_total": 13832, "policy_reward_min": {"policy_0": -1255.1038227482038}, "policy_reward_max": {"policy_0": -12.362796683573976}, "policy_reward_mean": {"policy_0": -622.3556777898144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-727.6048994856404, -517.0734726221889, -158.23857840888041, -1058.1652493199126, -511.2728008735845, -486.6404174109999, -981.106919023238, -391.89832615323667, -1163.3965146237044, -12.362796683573976, -1117.8507010869214, -476.73161942476025, -795.3604598045689, -640.2785517613013, -874.6939532044149, -611.5465998632817, -847.3091236601101, -128.02878579390918, -749.7257196342406, -782.1622781774323, -836.1730316603229, -462.22527008724563, -267.6203342028194, -366.47545550731365, -545.3927406687476, -943.8995598112335, -401.8760456034131, -377.814953274452, -619.6026222599778, -597.1113244107473, -215.32660654906135, -117.83306198056866, -973.8254922720636, -451.12715473949123, -568.7687699468302, -922.0507645883282, -489.3402211958315, -989.0885198215991, -832.724094576056, -883.8313132147334, -210.76365769771067, -1206.5498288889721, -593.7933946269941, -1056.9613426581907, -410.03089171089005, -354.3698705074815, -714.4346708174328, -414.72570825021893, -374.09343056180546, -349.40532927087787, -996.7227530907579, -763.2288896342056, -276.8497645479639, -276.63210728545266, -204.97589206900386, -893.266131551348, -965.079898813537, -324.11293407775366, -572.4859015391146, -1124.0221270658917, -159.91930652516874, -655.7448803917014, -775.2483658518562, -676.6836493129584, -601.4357434588035, -458.6901694325106, -671.2050093551604, -299.0736431419615, -609.1803235157992, -476.0055325647315, -505.2538458612886, -1255.1038227482038, -449.59505297251684, -911.4751474699165, -842.6866082439915, -776.7427535673439, -687.9674262360742, -806.315888473191, -489.30823286315575, -125.91620968404816, -620.2424256907061, -887.3048592080769, -1027.0003142605515, -475.2003514034876, -628.7496195759909, -1004.9051092611709, -649.8133206961809, -600.5129507932407, -284.8085400413302, -107.88792710144664, -244.92835005488686, -69.88486487245855, -328.0801400638871, -460.13804116803254, -758.4234332432974, -494.1267417306446, -1128.791230674934, -1021.0175557799154, -1231.060626449254, -1003.0801371892271], "episode_lengths": [150, 150, 80, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 97, 150, 148, 150, 101, 94, 150, 150, 94, 67, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 137, 64, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 98, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 143, 58, 102, 63, 141, 125, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-727.6048994856404, -517.0734726221889, -158.23857840888041, -1058.1652493199126, -511.2728008735845, -486.6404174109999, -981.106919023238, -391.89832615323667, -1163.3965146237044, -12.362796683573976, -1117.8507010869214, -476.73161942476025, -795.3604598045689, -640.2785517613013, -874.6939532044149, -611.5465998632817, -847.3091236601101, -128.02878579390918, -749.7257196342406, -782.1622781774323, -836.1730316603229, -462.22527008724563, -267.6203342028194, -366.47545550731365, -545.3927406687476, -943.8995598112335, -401.8760456034131, -377.814953274452, -619.6026222599778, -597.1113244107473, -215.32660654906135, -117.83306198056866, -973.8254922720636, -451.12715473949123, -568.7687699468302, -922.0507645883282, -489.3402211958315, -989.0885198215991, -832.724094576056, -883.8313132147334, -210.76365769771067, -1206.5498288889721, -593.7933946269941, -1056.9613426581907, -410.03089171089005, -354.3698705074815, -714.4346708174328, -414.72570825021893, -374.09343056180546, -349.40532927087787, -996.7227530907579, -763.2288896342056, -276.8497645479639, -276.63210728545266, -204.97589206900386, -893.266131551348, -965.079898813537, -324.11293407775366, -572.4859015391146, -1124.0221270658917, -159.91930652516874, -655.7448803917014, -775.2483658518562, -676.6836493129584, -601.4357434588035, -458.6901694325106, -671.2050093551604, -299.0736431419615, -609.1803235157992, -476.0055325647315, -505.2538458612886, -1255.1038227482038, -449.59505297251684, -911.4751474699165, -842.6866082439915, -776.7427535673439, -687.9674262360742, -806.315888473191, -489.30823286315575, -125.91620968404816, -620.2424256907061, -887.3048592080769, -1027.0003142605515, -475.2003514034876, -628.7496195759909, -1004.9051092611709, -649.8133206961809, -600.5129507932407, -284.8085400413302, -107.88792710144664, -244.92835005488686, -69.88486487245855, -328.0801400638871, -460.13804116803254, -758.4234332432974, -494.1267417306446, -1128.791230674934, -1021.0175557799154, -1231.060626449254, -1003.0801371892271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532149960381005, "mean_inference_ms": 1.6759155602416302, "mean_action_processing_ms": 0.27730183544938014, "mean_env_wait_ms": 3.4551264256632153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012293338775634766, "StateBufferConnector_ms": 0.008043050765991211, "ViewRequirementAgentConnector_ms": 0.20637989044189453}, "num_episodes": 32, "episode_return_max": -12.362796683573976, "episode_return_min": -1255.1038227482038, "episode_return_mean": -622.3556777898144, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.0028816389415, "num_env_steps_trained_throughput_per_sec": 339.0028816389415, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12297.86, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12297.783, "sample_time_ms": 1155.325, "learn_time_ms": 11075.257, "learn_throughput": 361.165, "synch_weights_time_ms": 66.395}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00014", "date": "2024-08-04_06-50-33", "timestamp": 1722734433, "time_this_iter_s": 11.810612440109253, "time_total_s": 299.6623122692108, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370990c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 299.6623122692108, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.98235294117647, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.19301189879576, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.8622839966168008, "policy_loss": -0.013712281678939084, "vf_loss": 2.8842204961925746, "vf_explained_var": 0.9862740793575843, "kl": 0.0144513264853155, "entropy": 1.4727318573743104, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -20.090663058404036, "episode_reward_min": -1301.7761306168786, "episode_reward_mean": -613.4342021405292, "episode_len_mean": 138.02, "episode_media": {}, "episodes_timesteps_total": 13802, "policy_reward_min": {"policy_0": -1301.7761306168786}, "policy_reward_max": {"policy_0": -20.090663058404036}, "policy_reward_mean": {"policy_0": -613.4342021405292}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-401.8760456034131, -377.814953274452, -619.6026222599778, -597.1113244107473, -215.32660654906135, -117.83306198056866, -973.8254922720636, -451.12715473949123, -568.7687699468302, -922.0507645883282, -489.3402211958315, -989.0885198215991, -832.724094576056, -883.8313132147334, -210.76365769771067, -1206.5498288889721, -593.7933946269941, -1056.9613426581907, -410.03089171089005, -354.3698705074815, -714.4346708174328, -414.72570825021893, -374.09343056180546, -349.40532927087787, -996.7227530907579, -763.2288896342056, -276.8497645479639, -276.63210728545266, -204.97589206900386, -893.266131551348, -965.079898813537, -324.11293407775366, -572.4859015391146, -1124.0221270658917, -159.91930652516874, -655.7448803917014, -775.2483658518562, -676.6836493129584, -601.4357434588035, -458.6901694325106, -671.2050093551604, -299.0736431419615, -609.1803235157992, -476.0055325647315, -505.2538458612886, -1255.1038227482038, -449.59505297251684, -911.4751474699165, -842.6866082439915, -776.7427535673439, -687.9674262360742, -806.315888473191, -489.30823286315575, -125.91620968404816, -620.2424256907061, -887.3048592080769, -1027.0003142605515, -475.2003514034876, -628.7496195759909, -1004.9051092611709, -649.8133206961809, -600.5129507932407, -284.8085400413302, -107.88792710144664, -244.92835005488686, -69.88486487245855, -328.0801400638871, -460.13804116803254, -758.4234332432974, -494.1267417306446, -1128.791230674934, -1021.0175557799154, -1231.060626449254, -1003.0801371892271, -1051.4102477239917, -141.04845207779394, -671.8138745291931, -934.5450245944922, -460.94571954267917, -867.7154134283409, -751.0659259590246, -486.5078591251503, -591.0154724113827, -304.7911432735337, -941.455535903444, -1144.6001591712707, -486.15608536865886, -289.805830377087, -271.6364344154038, -124.43500802039514, -698.7560810174737, -1301.7761306168786, -280.2444269682967, -20.090663058404036, -594.6868689330241, -372.4927390920015, -698.4257354628705, -942.0438645992967, -382.51406627958096, -751.1078320753926], "episode_lengths": [101, 94, 150, 150, 94, 67, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 137, 64, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 98, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 143, 58, 102, 63, 141, 125, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 60, 150, 150, 100, 37, 150, 131, 150, 150, 150, 150], "policy_policy_0_reward": [-401.8760456034131, -377.814953274452, -619.6026222599778, -597.1113244107473, -215.32660654906135, -117.83306198056866, -973.8254922720636, -451.12715473949123, -568.7687699468302, -922.0507645883282, -489.3402211958315, -989.0885198215991, -832.724094576056, -883.8313132147334, -210.76365769771067, -1206.5498288889721, -593.7933946269941, -1056.9613426581907, -410.03089171089005, -354.3698705074815, -714.4346708174328, -414.72570825021893, -374.09343056180546, -349.40532927087787, -996.7227530907579, -763.2288896342056, -276.8497645479639, -276.63210728545266, -204.97589206900386, -893.266131551348, -965.079898813537, -324.11293407775366, -572.4859015391146, -1124.0221270658917, -159.91930652516874, -655.7448803917014, -775.2483658518562, -676.6836493129584, -601.4357434588035, -458.6901694325106, -671.2050093551604, -299.0736431419615, -609.1803235157992, -476.0055325647315, -505.2538458612886, -1255.1038227482038, -449.59505297251684, -911.4751474699165, -842.6866082439915, -776.7427535673439, -687.9674262360742, -806.315888473191, -489.30823286315575, -125.91620968404816, -620.2424256907061, -887.3048592080769, -1027.0003142605515, -475.2003514034876, -628.7496195759909, -1004.9051092611709, -649.8133206961809, -600.5129507932407, -284.8085400413302, -107.88792710144664, -244.92835005488686, -69.88486487245855, -328.0801400638871, -460.13804116803254, -758.4234332432974, -494.1267417306446, -1128.791230674934, -1021.0175557799154, -1231.060626449254, -1003.0801371892271, -1051.4102477239917, -141.04845207779394, -671.8138745291931, -934.5450245944922, -460.94571954267917, -867.7154134283409, -751.0659259590246, -486.5078591251503, -591.0154724113827, -304.7911432735337, -941.455535903444, -1144.6001591712707, -486.15608536865886, -289.805830377087, -271.6364344154038, -124.43500802039514, -698.7560810174737, -1301.7761306168786, -280.2444269682967, -20.090663058404036, -594.6868689330241, -372.4927390920015, -698.4257354628705, -942.0438645992967, -382.51406627958096, -751.1078320753926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532676886271125, "mean_inference_ms": 1.675520897262633, "mean_action_processing_ms": 0.27719411176970177, "mean_env_wait_ms": 3.4555859537675757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011788368225097656, "StateBufferConnector_ms": 0.007935523986816406, "ViewRequirementAgentConnector_ms": 0.20321226119995117}, "num_episodes": 26, "episode_return_max": -20.090663058404036, "episode_return_min": -1301.7761306168786, "episode_return_mean": -613.4342021405292, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.7347136128049, "num_env_steps_trained_throughput_per_sec": 315.7347136128049, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12273.662, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12273.585, "sample_time_ms": 1156.767, "learn_time_ms": 11049.024, "learn_throughput": 362.023, "synch_weights_time_ms": 66.988}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00014", "date": "2024-08-04_06-50-46", "timestamp": 1722734446, "time_this_iter_s": 12.681393384933472, "time_total_s": 312.3437056541443, "pid": 590609, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087ae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.3437056541443, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.222222222222225, "ram_util_percent": 28.100000000000005}}
