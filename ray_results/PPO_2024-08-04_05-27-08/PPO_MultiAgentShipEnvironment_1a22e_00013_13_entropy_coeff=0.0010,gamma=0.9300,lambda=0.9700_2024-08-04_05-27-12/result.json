{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8630741108519335, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.749946144223212, "policy_loss": -0.01073873115965398, "vf_loss": 9.759580741326014, "vf_explained_var": 0.0012231030811866125, "kl": 0.012698763328664124, "entropy": 1.4356255461772283, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -37.528780052867276, "episode_reward_min": -1402.7985507801077, "episode_reward_mean": -833.5598370657282, "episode_len_mean": 137.2173913043478, "episode_media": {}, "episodes_timesteps_total": 3156, "policy_reward_min": {"policy_0": -1402.7985507801077}, "policy_reward_max": {"policy_0": -37.528780052867276}, "policy_reward_mean": {"policy_0": -833.5598370657282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1116.959224411509, -886.9472890108165, -1133.745546422107, -1350.5025855945255, -1025.5567485238053, -1054.5746476145166, -736.754280209396, -943.0353717810789, -581.0720324572275, -317.89209826314476, -927.5106631155238, -362.2621012543062, -247.00026015598834, -1329.1549772268088, -1185.6065369613266, -37.528780052867276, -779.9804852088223, -1402.7985507801077, -638.1726341628854, -760.1379491591204, -593.6597224676424, -635.4944971547754, -1125.529270523449], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 86, 86, 150, 150, 49, 150, 150, 150, 150, 118, 150, 150], "policy_policy_0_reward": [-1116.959224411509, -886.9472890108165, -1133.745546422107, -1350.5025855945255, -1025.5567485238053, -1054.5746476145166, -736.754280209396, -943.0353717810789, -581.0720324572275, -317.89209826314476, -927.5106631155238, -362.2621012543062, -247.00026015598834, -1329.1549772268088, -1185.6065369613266, -37.528780052867276, -779.9804852088223, -1402.7985507801077, -638.1726341628854, -760.1379491591204, -593.6597224676424, -635.4944971547754, -1125.529270523449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5810174167883883, "mean_inference_ms": 1.6701092627775818, "mean_action_processing_ms": 0.2766503649077256, "mean_env_wait_ms": 3.422138711544366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011327992314877718, "StateBufferConnector_ms": 0.008045072140900986, "ViewRequirementAgentConnector_ms": 0.17903680386750595}, "num_episodes": 23, "episode_return_max": -37.528780052867276, "episode_return_min": -1402.7985507801077, "episode_return_mean": -833.5598370657282, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.05542952156173, "num_env_steps_trained_throughput_per_sec": 320.05542952156173, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12497.848, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12497.763, "sample_time_ms": 1169.794, "learn_time_ms": 11240.177, "learn_throughput": 355.866, "synch_weights_time_ms": 87.057}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00013", "date": "2024-08-04_06-40-07", "timestamp": 1722733807, "time_this_iter_s": 12.509825229644775, "time_total_s": 12.509825229644775, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f48820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.509825229644775, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.333333333333332, "ram_util_percent": 27.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6849292164358, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.319107072552045, "policy_loss": -0.006138528544882623, "vf_loss": 9.324138194322586, "vf_explained_var": 0.1025711767996351, "kl": 0.012844368620972092, "entropy": 1.4614566122492154, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -37.528780052867276, "episode_reward_min": -1402.7985507801077, "episode_reward_mean": -715.9455276536843, "episode_len_mean": 125.35849056603773, "episode_media": {}, "episodes_timesteps_total": 6644, "policy_reward_min": {"policy_0": -1402.7985507801077}, "policy_reward_max": {"policy_0": -37.528780052867276}, "policy_reward_mean": {"policy_0": -715.9455276536843}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1116.959224411509, -886.9472890108165, -1133.745546422107, -1350.5025855945255, -1025.5567485238053, -1054.5746476145166, -736.754280209396, -943.0353717810789, -581.0720324572275, -317.89209826314476, -927.5106631155238, -362.2621012543062, -247.00026015598834, -1329.1549772268088, -1185.6065369613266, -37.528780052867276, -779.9804852088223, -1402.7985507801077, -638.1726341628854, -760.1379491591204, -593.6597224676424, -635.4944971547754, -1125.529270523449, -863.4381139572683, -405.4289139656809, -97.46176322809278, -42.74832933262958, -101.90351860622403, -475.79902227827375, -1126.3162978093615, -954.6831219272623, -537.7351581027494, -824.1305463029713, -1036.6080824638432, -1123.2021749297633, -130.95362428188207, -132.19393614979992, -121.92931080010668, -1004.4397911507986, -739.2257182127115, -39.359309996545946, -550.7901888679418, -933.2832230552227, -1154.5333241803548, -1140.4621236445198, -794.2014692864504, -52.23450587035829, -426.06661356638045, -1165.3651371384035, -1212.37113514698, -108.37895090331007, -1055.7249981206203, -422.2683098570122], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 86, 86, 150, 150, 49, 150, 150, 150, 150, 118, 150, 150, 150, 96, 74, 49, 61, 115, 150, 150, 129, 150, 150, 150, 73, 49, 71, 150, 150, 46, 150, 150, 150, 150, 150, 57, 97, 150, 150, 56, 150, 115], "policy_policy_0_reward": [-1116.959224411509, -886.9472890108165, -1133.745546422107, -1350.5025855945255, -1025.5567485238053, -1054.5746476145166, -736.754280209396, -943.0353717810789, -581.0720324572275, -317.89209826314476, -927.5106631155238, -362.2621012543062, -247.00026015598834, -1329.1549772268088, -1185.6065369613266, -37.528780052867276, -779.9804852088223, -1402.7985507801077, -638.1726341628854, -760.1379491591204, -593.6597224676424, -635.4944971547754, -1125.529270523449, -863.4381139572683, -405.4289139656809, -97.46176322809278, -42.74832933262958, -101.90351860622403, -475.79902227827375, -1126.3162978093615, -954.6831219272623, -537.7351581027494, -824.1305463029713, -1036.6080824638432, -1123.2021749297633, -130.95362428188207, -132.19393614979992, -121.92931080010668, -1004.4397911507986, -739.2257182127115, -39.359309996545946, -550.7901888679418, -933.2832230552227, -1154.5333241803548, -1140.4621236445198, -794.2014692864504, -52.23450587035829, -426.06661356638045, -1165.3651371384035, -1212.37113514698, -108.37895090331007, -1055.7249981206203, -422.2683098570122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5766222940727905, "mean_inference_ms": 1.6755529612374673, "mean_action_processing_ms": 0.27791324003228624, "mean_env_wait_ms": 3.435138973671125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01406849555249484, "StateBufferConnector_ms": 0.008427422001676739, "ViewRequirementAgentConnector_ms": 0.18451393775220187}, "num_episodes": 30, "episode_return_max": -37.528780052867276, "episode_return_min": -1402.7985507801077, "episode_return_mean": -715.9455276536843, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.94352401228025, "num_env_steps_trained_throughput_per_sec": 304.94352401228025, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12807.522, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12807.446, "sample_time_ms": 1153.11, "learn_time_ms": 11581.558, "learn_throughput": 345.377, "synch_weights_time_ms": 72.04}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00013", "date": "2024-08-04_06-40-20", "timestamp": 1722733820, "time_this_iter_s": 13.128036260604858, "time_total_s": 25.637861490249634, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb9900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.637861490249634, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.19473684210526, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.403120289556682, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.319043568770091, "policy_loss": -0.008432269106560853, "vf_loss": 9.326201686263085, "vf_explained_var": 0.030251487096150716, "kl": 0.013854361084048606, "entropy": 1.4967116327335437, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -37.528780052867276, "episode_reward_min": -1402.7985507801077, "episode_reward_mean": -719.4218330495155, "episode_len_mean": 124.75903614457832, "episode_media": {}, "episodes_timesteps_total": 10355, "policy_reward_min": {"policy_0": -1402.7985507801077}, "policy_reward_max": {"policy_0": -37.528780052867276}, "policy_reward_mean": {"policy_0": -719.4218330495155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1116.959224411509, -886.9472890108165, -1133.745546422107, -1350.5025855945255, -1025.5567485238053, -1054.5746476145166, -736.754280209396, -943.0353717810789, -581.0720324572275, -317.89209826314476, -927.5106631155238, -362.2621012543062, -247.00026015598834, -1329.1549772268088, -1185.6065369613266, -37.528780052867276, -779.9804852088223, -1402.7985507801077, -638.1726341628854, -760.1379491591204, -593.6597224676424, -635.4944971547754, -1125.529270523449, -863.4381139572683, -405.4289139656809, -97.46176322809278, -42.74832933262958, -101.90351860622403, -475.79902227827375, -1126.3162978093615, -954.6831219272623, -537.7351581027494, -824.1305463029713, -1036.6080824638432, -1123.2021749297633, -130.95362428188207, -132.19393614979992, -121.92931080010668, -1004.4397911507986, -739.2257182127115, -39.359309996545946, -550.7901888679418, -933.2832230552227, -1154.5333241803548, -1140.4621236445198, -794.2014692864504, -52.23450587035829, -426.06661356638045, -1165.3651371384035, -1212.37113514698, -108.37895090331007, -1055.7249981206203, -422.2683098570122, -708.1810252266972, -738.2843792998759, -1021.8279548987094, -357.19511860843124, -1044.6923718497478, -134.67407745707564, -174.74104381220752, -52.613764397126616, -1097.176410909547, -1232.864184033558, -946.2924099245498, -1076.4552534127924, -874.5763970211174, -596.7467771960393, -290.15007051673655, -756.4575304588003, -723.9889022193939, -1017.329274991747, -489.1352480758529, -1181.6461693217461, -1130.4873782513496, -210.4984004648421, -1170.2788755648862, -248.07037647961286, -1021.3185608887094, -511.6470787664032, -176.83978902146765, -578.0454868463235, -863.9258963306224, -1340.7589712185586], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 86, 86, 150, 150, 49, 150, 150, 150, 150, 118, 150, 150, 150, 96, 74, 49, 61, 115, 150, 150, 129, 150, 150, 150, 73, 49, 71, 150, 150, 46, 150, 150, 150, 150, 150, 57, 97, 150, 150, 56, 150, 115, 150, 150, 150, 95, 150, 54, 71, 48, 150, 150, 150, 150, 150, 117, 79, 146, 150, 150, 101, 150, 150, 64, 150, 95, 150, 108, 57, 131, 145, 150], "policy_policy_0_reward": [-1116.959224411509, -886.9472890108165, -1133.745546422107, -1350.5025855945255, -1025.5567485238053, -1054.5746476145166, -736.754280209396, -943.0353717810789, -581.0720324572275, -317.89209826314476, -927.5106631155238, -362.2621012543062, -247.00026015598834, -1329.1549772268088, -1185.6065369613266, -37.528780052867276, -779.9804852088223, -1402.7985507801077, -638.1726341628854, -760.1379491591204, -593.6597224676424, -635.4944971547754, -1125.529270523449, -863.4381139572683, -405.4289139656809, -97.46176322809278, -42.74832933262958, -101.90351860622403, -475.79902227827375, -1126.3162978093615, -954.6831219272623, -537.7351581027494, -824.1305463029713, -1036.6080824638432, -1123.2021749297633, -130.95362428188207, -132.19393614979992, -121.92931080010668, -1004.4397911507986, -739.2257182127115, -39.359309996545946, -550.7901888679418, -933.2832230552227, -1154.5333241803548, -1140.4621236445198, -794.2014692864504, -52.23450587035829, -426.06661356638045, -1165.3651371384035, -1212.37113514698, -108.37895090331007, -1055.7249981206203, -422.2683098570122, -708.1810252266972, -738.2843792998759, -1021.8279548987094, -357.19511860843124, -1044.6923718497478, -134.67407745707564, -174.74104381220752, -52.613764397126616, -1097.176410909547, -1232.864184033558, -946.2924099245498, -1076.4552534127924, -874.5763970211174, -596.7467771960393, -290.15007051673655, -756.4575304588003, -723.9889022193939, -1017.329274991747, -489.1352480758529, -1181.6461693217461, -1130.4873782513496, -210.4984004648421, -1170.2788755648862, -248.07037647961286, -1021.3185608887094, -511.6470787664032, -176.83978902146765, -578.0454868463235, -863.9258963306224, -1340.7589712185586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5744858879595348, "mean_inference_ms": 1.6793755838752435, "mean_action_processing_ms": 0.2789468853100927, "mean_env_wait_ms": 3.4483095375352235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013617722384900931, "StateBufferConnector_ms": 0.008494020944618317, "ViewRequirementAgentConnector_ms": 0.1853221870330443}, "num_episodes": 30, "episode_return_max": -37.528780052867276, "episode_return_min": -1402.7985507801077, "episode_return_mean": -719.4218330495155, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.42028371990307, "num_env_steps_trained_throughput_per_sec": 305.42028371990307, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12903.921, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12903.846, "sample_time_ms": 1175.981, "learn_time_ms": 11656.143, "learn_throughput": 343.167, "synch_weights_time_ms": 70.938}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00013", "date": "2024-08-04_06-40-33", "timestamp": 1722733833, "time_this_iter_s": 13.108090162277222, "time_total_s": 38.745951652526855, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237091f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.745951652526855, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.526315789473685, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.029940054938197, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.97120262036721, "policy_loss": -0.019070325419306755, "vf_loss": 8.98741642733415, "vf_explained_var": 0.2776161706075072, "kl": 0.021601222088065697, "entropy": 1.4637048774709305, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -38.81548855780549, "episode_reward_min": -1402.7985507801077, "episode_reward_mean": -701.538567829991, "episode_len_mean": 123.14, "episode_media": {}, "episodes_timesteps_total": 12314, "policy_reward_min": {"policy_0": -1402.7985507801077}, "policy_reward_max": {"policy_0": -38.81548855780549}, "policy_reward_mean": {"policy_0": -701.538567829991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1402.7985507801077, -638.1726341628854, -760.1379491591204, -593.6597224676424, -635.4944971547754, -1125.529270523449, -863.4381139572683, -405.4289139656809, -97.46176322809278, -42.74832933262958, -101.90351860622403, -475.79902227827375, -1126.3162978093615, -954.6831219272623, -537.7351581027494, -824.1305463029713, -1036.6080824638432, -1123.2021749297633, -130.95362428188207, -132.19393614979992, -121.92931080010668, -1004.4397911507986, -739.2257182127115, -39.359309996545946, -550.7901888679418, -933.2832230552227, -1154.5333241803548, -1140.4621236445198, -794.2014692864504, -52.23450587035829, -426.06661356638045, -1165.3651371384035, -1212.37113514698, -108.37895090331007, -1055.7249981206203, -422.2683098570122, -708.1810252266972, -738.2843792998759, -1021.8279548987094, -357.19511860843124, -1044.6923718497478, -134.67407745707564, -174.74104381220752, -52.613764397126616, -1097.176410909547, -1232.864184033558, -946.2924099245498, -1076.4552534127924, -874.5763970211174, -596.7467771960393, -290.15007051673655, -756.4575304588003, -723.9889022193939, -1017.329274991747, -489.1352480758529, -1181.6461693217461, -1130.4873782513496, -210.4984004648421, -1170.2788755648862, -248.07037647961286, -1021.3185608887094, -511.6470787664032, -176.83978902146765, -578.0454868463235, -863.9258963306224, -1340.7589712185586, -374.17446164292096, -891.8619389997618, -257.02713306894935, -889.587255583142, -1066.9669079246182, -1158.051356386271, -1077.8658672194836, -879.5927050502105, -48.41771499657705, -567.634014159158, -425.24396785815185, -896.3336906560376, -768.2825952330883, -126.5801998490011, -195.00643735647472, -38.81548855780549, -1248.0576492106977, -994.7456933423804, -712.6796507203918, -709.2146487131556, -1025.8510757296103, -1142.975841891946, -1025.1565556201822, -99.90048081225696, -849.1656858939823, -834.3805239919237, -1117.2479929203964, -349.2302924918697, -1224.593477104612, -960.0112990068493, -1222.9046927548554, -57.85729525486235, -451.8977549118305, -770.6159232396215], "episode_lengths": [150, 150, 150, 118, 150, 150, 150, 96, 74, 49, 61, 115, 150, 150, 129, 150, 150, 150, 73, 49, 71, 150, 150, 46, 150, 150, 150, 150, 150, 57, 97, 150, 150, 56, 150, 115, 150, 150, 150, 95, 150, 54, 71, 48, 150, 150, 150, 150, 150, 117, 79, 146, 150, 150, 101, 150, 150, 64, 150, 95, 150, 108, 57, 131, 145, 150, 92, 150, 71, 150, 150, 150, 150, 150, 59, 150, 95, 150, 150, 65, 61, 64, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 85, 150, 150, 150, 54, 105, 150], "policy_policy_0_reward": [-1402.7985507801077, -638.1726341628854, -760.1379491591204, -593.6597224676424, -635.4944971547754, -1125.529270523449, -863.4381139572683, -405.4289139656809, -97.46176322809278, -42.74832933262958, -101.90351860622403, -475.79902227827375, -1126.3162978093615, -954.6831219272623, -537.7351581027494, -824.1305463029713, -1036.6080824638432, -1123.2021749297633, -130.95362428188207, -132.19393614979992, -121.92931080010668, -1004.4397911507986, -739.2257182127115, -39.359309996545946, -550.7901888679418, -933.2832230552227, -1154.5333241803548, -1140.4621236445198, -794.2014692864504, -52.23450587035829, -426.06661356638045, -1165.3651371384035, -1212.37113514698, -108.37895090331007, -1055.7249981206203, -422.2683098570122, -708.1810252266972, -738.2843792998759, -1021.8279548987094, -357.19511860843124, -1044.6923718497478, -134.67407745707564, -174.74104381220752, -52.613764397126616, -1097.176410909547, -1232.864184033558, -946.2924099245498, -1076.4552534127924, -874.5763970211174, -596.7467771960393, -290.15007051673655, -756.4575304588003, -723.9889022193939, -1017.329274991747, -489.1352480758529, -1181.6461693217461, -1130.4873782513496, -210.4984004648421, -1170.2788755648862, -248.07037647961286, -1021.3185608887094, -511.6470787664032, -176.83978902146765, -578.0454868463235, -863.9258963306224, -1340.7589712185586, -374.17446164292096, -891.8619389997618, -257.02713306894935, -889.587255583142, -1066.9669079246182, -1158.051356386271, -1077.8658672194836, -879.5927050502105, -48.41771499657705, -567.634014159158, -425.24396785815185, -896.3336906560376, -768.2825952330883, -126.5801998490011, -195.00643735647472, -38.81548855780549, -1248.0576492106977, -994.7456933423804, -712.6796507203918, -709.2146487131556, -1025.8510757296103, -1142.975841891946, -1025.1565556201822, -99.90048081225696, -849.1656858939823, -834.3805239919237, -1117.2479929203964, -349.2302924918697, -1224.593477104612, -960.0112990068493, -1222.9046927548554, -57.85729525486235, -451.8977549118305, -770.6159232396215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5716583779508368, "mean_inference_ms": 1.6887939317662286, "mean_action_processing_ms": 0.28079831587051496, "mean_env_wait_ms": 3.4644959022398805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014289140701293945, "StateBufferConnector_ms": 0.00862741470336914, "ViewRequirementAgentConnector_ms": 0.18766093254089355}, "num_episodes": 34, "episode_return_max": -38.81548855780549, "episode_return_min": -1402.7985507801077, "episode_return_mean": -701.538567829991, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.71329928297973, "num_env_steps_trained_throughput_per_sec": 305.71329928297973, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12948.982, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12948.91, "sample_time_ms": 1167.094, "learn_time_ms": 11713.062, "learn_throughput": 341.499, "synch_weights_time_ms": 67.959}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00013", "date": "2024-08-04_06-40-46", "timestamp": 1722733846, "time_this_iter_s": 13.095764398574829, "time_total_s": 51.841716051101685, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.841716051101685, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.711111111111116, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.507681320048869, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.277107514441013, "policy_loss": -0.01421571207853655, "vf_loss": 9.288182278474173, "vf_explained_var": 0.31923414797832567, "kl": 0.015275607938898856, "entropy": 1.4417510765294235, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -38.81548855780549, "episode_reward_min": -1340.7589712185586, "episode_reward_mean": -726.6279519331605, "episode_len_mean": 126.95, "episode_media": {}, "episodes_timesteps_total": 12695, "policy_reward_min": {"policy_0": -1340.7589712185586}, "policy_reward_max": {"policy_0": -38.81548855780549}, "policy_reward_mean": {"policy_0": -726.6279519331605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.23450587035829, -426.06661356638045, -1165.3651371384035, -1212.37113514698, -108.37895090331007, -1055.7249981206203, -422.2683098570122, -708.1810252266972, -738.2843792998759, -1021.8279548987094, -357.19511860843124, -1044.6923718497478, -134.67407745707564, -174.74104381220752, -52.613764397126616, -1097.176410909547, -1232.864184033558, -946.2924099245498, -1076.4552534127924, -874.5763970211174, -596.7467771960393, -290.15007051673655, -756.4575304588003, -723.9889022193939, -1017.329274991747, -489.1352480758529, -1181.6461693217461, -1130.4873782513496, -210.4984004648421, -1170.2788755648862, -248.07037647961286, -1021.3185608887094, -511.6470787664032, -176.83978902146765, -578.0454868463235, -863.9258963306224, -1340.7589712185586, -374.17446164292096, -891.8619389997618, -257.02713306894935, -889.587255583142, -1066.9669079246182, -1158.051356386271, -1077.8658672194836, -879.5927050502105, -48.41771499657705, -567.634014159158, -425.24396785815185, -896.3336906560376, -768.2825952330883, -126.5801998490011, -195.00643735647472, -38.81548855780549, -1248.0576492106977, -994.7456933423804, -712.6796507203918, -709.2146487131556, -1025.8510757296103, -1142.975841891946, -1025.1565556201822, -99.90048081225696, -849.1656858939823, -834.3805239919237, -1117.2479929203964, -349.2302924918697, -1224.593477104612, -960.0112990068493, -1222.9046927548554, -57.85729525486235, -451.8977549118305, -770.6159232396215, -921.365756784742, -1183.612828437465, -986.9955562221071, -1035.9703198637376, -816.3738366070477, -1240.0409612032379, -911.0404881212834, -1133.369034843048, -608.0356300623944, -269.96156301367364, -237.5695534375964, -688.7085806616935, -996.0400287995734, -1193.5790352658084, -359.15661792002703, -918.2782294659343, -91.46856763587681, -764.4506701169134, -938.9941852862705, -41.3959444430632, -822.0852828699007, -995.5569089207049, -879.357663636849, -1252.8730695575946, -662.0116237832859, -541.0348802239693, -499.93068321543996, -889.0196463957216, -117.28095030040795], "episode_lengths": [57, 97, 150, 150, 56, 150, 115, 150, 150, 150, 95, 150, 54, 71, 48, 150, 150, 150, 150, 150, 117, 79, 146, 150, 150, 101, 150, 150, 64, 150, 95, 150, 108, 57, 131, 145, 150, 92, 150, 71, 150, 150, 150, 150, 150, 59, 150, 95, 150, 150, 65, 61, 64, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 85, 150, 150, 150, 54, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 105, 150, 150, 150, 150, 150, 64, 150, 150, 48, 150, 150, 150, 150, 150, 150, 135, 150, 76], "policy_policy_0_reward": [-52.23450587035829, -426.06661356638045, -1165.3651371384035, -1212.37113514698, -108.37895090331007, -1055.7249981206203, -422.2683098570122, -708.1810252266972, -738.2843792998759, -1021.8279548987094, -357.19511860843124, -1044.6923718497478, -134.67407745707564, -174.74104381220752, -52.613764397126616, -1097.176410909547, -1232.864184033558, -946.2924099245498, -1076.4552534127924, -874.5763970211174, -596.7467771960393, -290.15007051673655, -756.4575304588003, -723.9889022193939, -1017.329274991747, -489.1352480758529, -1181.6461693217461, -1130.4873782513496, -210.4984004648421, -1170.2788755648862, -248.07037647961286, -1021.3185608887094, -511.6470787664032, -176.83978902146765, -578.0454868463235, -863.9258963306224, -1340.7589712185586, -374.17446164292096, -891.8619389997618, -257.02713306894935, -889.587255583142, -1066.9669079246182, -1158.051356386271, -1077.8658672194836, -879.5927050502105, -48.41771499657705, -567.634014159158, -425.24396785815185, -896.3336906560376, -768.2825952330883, -126.5801998490011, -195.00643735647472, -38.81548855780549, -1248.0576492106977, -994.7456933423804, -712.6796507203918, -709.2146487131556, -1025.8510757296103, -1142.975841891946, -1025.1565556201822, -99.90048081225696, -849.1656858939823, -834.3805239919237, -1117.2479929203964, -349.2302924918697, -1224.593477104612, -960.0112990068493, -1222.9046927548554, -57.85729525486235, -451.8977549118305, -770.6159232396215, -921.365756784742, -1183.612828437465, -986.9955562221071, -1035.9703198637376, -816.3738366070477, -1240.0409612032379, -911.0404881212834, -1133.369034843048, -608.0356300623944, -269.96156301367364, -237.5695534375964, -688.7085806616935, -996.0400287995734, -1193.5790352658084, -359.15661792002703, -918.2782294659343, -91.46856763587681, -764.4506701169134, -938.9941852862705, -41.3959444430632, -822.0852828699007, -995.5569089207049, -879.357663636849, -1252.8730695575946, -662.0116237832859, -541.0348802239693, -499.93068321543996, -889.0196463957216, -117.28095030040795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5692902670503066, "mean_inference_ms": 1.692559737382392, "mean_action_processing_ms": 0.28142332119137886, "mean_env_wait_ms": 3.4753990693546406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01359248161315918, "StateBufferConnector_ms": 0.008624553680419922, "ViewRequirementAgentConnector_ms": 0.18816232681274414}, "num_episodes": 29, "episode_return_max": -38.81548855780549, "episode_return_min": -1340.7589712185586, "episode_return_mean": -726.6279519331605, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.7806621999797, "num_env_steps_trained_throughput_per_sec": 298.7806621999797, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13036.738, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13036.666, "sample_time_ms": 1162.527, "learn_time_ms": 11803.115, "learn_throughput": 338.894, "synch_weights_time_ms": 70.239}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00013", "date": "2024-08-04_06-41-00", "timestamp": 1722733860, "time_this_iter_s": 13.399878978729248, "time_total_s": 65.24159502983093, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370990c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.24159502983093, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.394736842105264, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.959387581795454, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.180731712281704, "policy_loss": -0.01693912568249895, "vf_loss": 8.193593759834766, "vf_explained_var": 0.37634745985269547, "kl": 0.018453188309952875, "entropy": 1.4588454565654199, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -38.81548855780549, "episode_reward_min": -1342.5397183909154, "episode_reward_mean": -755.5939100264972, "episode_len_mean": 129.36, "episode_media": {}, "episodes_timesteps_total": 12936, "policy_reward_min": {"policy_0": -1342.5397183909154}, "policy_reward_max": {"policy_0": -38.81548855780549}, "policy_reward_mean": {"policy_0": -755.5939100264972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1170.2788755648862, -248.07037647961286, -1021.3185608887094, -511.6470787664032, -176.83978902146765, -578.0454868463235, -863.9258963306224, -1340.7589712185586, -374.17446164292096, -891.8619389997618, -257.02713306894935, -889.587255583142, -1066.9669079246182, -1158.051356386271, -1077.8658672194836, -879.5927050502105, -48.41771499657705, -567.634014159158, -425.24396785815185, -896.3336906560376, -768.2825952330883, -126.5801998490011, -195.00643735647472, -38.81548855780549, -1248.0576492106977, -994.7456933423804, -712.6796507203918, -709.2146487131556, -1025.8510757296103, -1142.975841891946, -1025.1565556201822, -99.90048081225696, -849.1656858939823, -834.3805239919237, -1117.2479929203964, -349.2302924918697, -1224.593477104612, -960.0112990068493, -1222.9046927548554, -57.85729525486235, -451.8977549118305, -770.6159232396215, -921.365756784742, -1183.612828437465, -986.9955562221071, -1035.9703198637376, -816.3738366070477, -1240.0409612032379, -911.0404881212834, -1133.369034843048, -608.0356300623944, -269.96156301367364, -237.5695534375964, -688.7085806616935, -996.0400287995734, -1193.5790352658084, -359.15661792002703, -918.2782294659343, -91.46856763587681, -764.4506701169134, -938.9941852862705, -41.3959444430632, -822.0852828699007, -995.5569089207049, -879.357663636849, -1252.8730695575946, -662.0116237832859, -541.0348802239693, -499.93068321543996, -889.0196463957216, -117.28095030040795, -258.34861507306067, -435.08105653465725, -67.40133745468371, -524.3618225018189, -454.8272401312882, -951.1969929612147, -1128.9991158370133, -1191.2898843667524, -1048.5616861410087, -1342.5397183909154, -854.3917324616575, -1245.4654993264007, -43.54886005141058, -214.1019634762496, -1282.2206822977155, -682.8303791671789, -1187.476890669443, -1000.9531384358497, -1076.8526686721964, -1291.6386804780545, -373.8032916850008, -97.45206766024396, -1050.442527356863, -706.3350704849796, -1167.7766986534655, -1099.5388721785782, -598.5873573576761, -671.513809784387, -1147.4819426949273], "episode_lengths": [150, 95, 150, 108, 57, 131, 145, 150, 92, 150, 71, 150, 150, 150, 150, 150, 59, 150, 95, 150, 150, 65, 61, 64, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 85, 150, 150, 150, 54, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 105, 150, 150, 150, 150, 150, 64, 150, 150, 48, 150, 150, 150, 150, 150, 150, 135, 150, 76, 75, 95, 60, 102, 101, 150, 150, 150, 150, 150, 150, 150, 42, 80, 150, 150, 150, 150, 150, 150, 150, 69, 150, 131, 150, 150, 150, 136, 150], "policy_policy_0_reward": [-1170.2788755648862, -248.07037647961286, -1021.3185608887094, -511.6470787664032, -176.83978902146765, -578.0454868463235, -863.9258963306224, -1340.7589712185586, -374.17446164292096, -891.8619389997618, -257.02713306894935, -889.587255583142, -1066.9669079246182, -1158.051356386271, -1077.8658672194836, -879.5927050502105, -48.41771499657705, -567.634014159158, -425.24396785815185, -896.3336906560376, -768.2825952330883, -126.5801998490011, -195.00643735647472, -38.81548855780549, -1248.0576492106977, -994.7456933423804, -712.6796507203918, -709.2146487131556, -1025.8510757296103, -1142.975841891946, -1025.1565556201822, -99.90048081225696, -849.1656858939823, -834.3805239919237, -1117.2479929203964, -349.2302924918697, -1224.593477104612, -960.0112990068493, -1222.9046927548554, -57.85729525486235, -451.8977549118305, -770.6159232396215, -921.365756784742, -1183.612828437465, -986.9955562221071, -1035.9703198637376, -816.3738366070477, -1240.0409612032379, -911.0404881212834, -1133.369034843048, -608.0356300623944, -269.96156301367364, -237.5695534375964, -688.7085806616935, -996.0400287995734, -1193.5790352658084, -359.15661792002703, -918.2782294659343, -91.46856763587681, -764.4506701169134, -938.9941852862705, -41.3959444430632, -822.0852828699007, -995.5569089207049, -879.357663636849, -1252.8730695575946, -662.0116237832859, -541.0348802239693, -499.93068321543996, -889.0196463957216, -117.28095030040795, -258.34861507306067, -435.08105653465725, -67.40133745468371, -524.3618225018189, -454.8272401312882, -951.1969929612147, -1128.9991158370133, -1191.2898843667524, -1048.5616861410087, -1342.5397183909154, -854.3917324616575, -1245.4654993264007, -43.54886005141058, -214.1019634762496, -1282.2206822977155, -682.8303791671789, -1187.476890669443, -1000.9531384358497, -1076.8526686721964, -1291.6386804780545, -373.8032916850008, -97.45206766024396, -1050.442527356863, -706.3350704849796, -1167.7766986534655, -1099.5388721785782, -598.5873573576761, -671.513809784387, -1147.4819426949273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5661619966460926, "mean_inference_ms": 1.6950000052420195, "mean_action_processing_ms": 0.28143816749181827, "mean_env_wait_ms": 3.4810340154173396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01340341567993164, "StateBufferConnector_ms": 0.008499622344970703, "ViewRequirementAgentConnector_ms": 0.1869204044342041}, "num_episodes": 29, "episode_return_max": -38.81548855780549, "episode_return_min": -1342.5397183909154, "episode_return_mean": -755.5939100264972, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.65090056822737, "num_env_steps_trained_throughput_per_sec": 299.65090056822737, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13088.761, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13088.69, "sample_time_ms": 1158.878, "learn_time_ms": 11859.898, "learn_throughput": 337.271, "synch_weights_time_ms": 69.127}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00013", "date": "2024-08-04_06-41-13", "timestamp": 1722733873, "time_this_iter_s": 13.360374927520752, "time_total_s": 78.60196995735168, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370993eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.60196995735168, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.189999999999998, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.366226135194303, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.671357719103495, "policy_loss": -0.010744217249642437, "vf_loss": 6.678804040451845, "vf_explained_var": 0.4872801007082065, "kl": 0.015426991455872978, "entropy": 1.330211834857861, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -41.3959444430632, "episode_reward_min": -1365.2305971318963, "episode_reward_mean": -760.6669962069275, "episode_len_mean": 130.78, "episode_media": {}, "episodes_timesteps_total": 13078, "policy_reward_min": {"policy_0": -1365.2305971318963}, "policy_reward_max": {"policy_0": -41.3959444430632}, "policy_reward_mean": {"policy_0": -760.6669962069275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-834.3805239919237, -1117.2479929203964, -349.2302924918697, -1224.593477104612, -960.0112990068493, -1222.9046927548554, -57.85729525486235, -451.8977549118305, -770.6159232396215, -921.365756784742, -1183.612828437465, -986.9955562221071, -1035.9703198637376, -816.3738366070477, -1240.0409612032379, -911.0404881212834, -1133.369034843048, -608.0356300623944, -269.96156301367364, -237.5695534375964, -688.7085806616935, -996.0400287995734, -1193.5790352658084, -359.15661792002703, -918.2782294659343, -91.46856763587681, -764.4506701169134, -938.9941852862705, -41.3959444430632, -822.0852828699007, -995.5569089207049, -879.357663636849, -1252.8730695575946, -662.0116237832859, -541.0348802239693, -499.93068321543996, -889.0196463957216, -117.28095030040795, -258.34861507306067, -435.08105653465725, -67.40133745468371, -524.3618225018189, -454.8272401312882, -951.1969929612147, -1128.9991158370133, -1191.2898843667524, -1048.5616861410087, -1342.5397183909154, -854.3917324616575, -1245.4654993264007, -43.54886005141058, -214.1019634762496, -1282.2206822977155, -682.8303791671789, -1187.476890669443, -1000.9531384358497, -1076.8526686721964, -1291.6386804780545, -373.8032916850008, -97.45206766024396, -1050.442527356863, -706.3350704849796, -1167.7766986534655, -1099.5388721785782, -598.5873573576761, -671.513809784387, -1147.4819426949273, -575.9485462178764, -278.74582415799733, -889.3599843308972, -1365.2305971318963, -763.8547550144889, -1128.1748627253016, -629.8694261630428, -791.2021856885991, -387.0834810249055, -217.8339636095032, -450.2592366395034, -991.6818999886351, -981.0229167886272, -1274.5114584330174, -61.52758035269457, -1116.0330762393905, -51.52952650849609, -1186.8423598879363, -815.780056478361, -301.90956321962494, -923.5647754151502, -1305.365661380881, -775.6799603539558, -188.92805357064822, -1327.5236475864438, -327.6758122205898, -1185.9501158324115, -761.4828533217657, -1096.023347977574, -50.399580399438385, -192.22593259636048, -849.5474790561343, -644.6141493237342], "episode_lengths": [150, 150, 85, 150, 150, 150, 54, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 105, 150, 150, 150, 150, 150, 64, 150, 150, 48, 150, 150, 150, 150, 150, 150, 135, 150, 76, 75, 95, 60, 102, 101, 150, 150, 150, 150, 150, 150, 150, 42, 80, 150, 150, 150, 150, 150, 150, 150, 69, 150, 131, 150, 150, 150, 136, 150, 149, 110, 150, 150, 150, 150, 150, 150, 96, 71, 117, 150, 150, 150, 44, 150, 40, 150, 144, 114, 150, 150, 150, 80, 150, 127, 150, 150, 150, 52, 87, 150, 150], "policy_policy_0_reward": [-834.3805239919237, -1117.2479929203964, -349.2302924918697, -1224.593477104612, -960.0112990068493, -1222.9046927548554, -57.85729525486235, -451.8977549118305, -770.6159232396215, -921.365756784742, -1183.612828437465, -986.9955562221071, -1035.9703198637376, -816.3738366070477, -1240.0409612032379, -911.0404881212834, -1133.369034843048, -608.0356300623944, -269.96156301367364, -237.5695534375964, -688.7085806616935, -996.0400287995734, -1193.5790352658084, -359.15661792002703, -918.2782294659343, -91.46856763587681, -764.4506701169134, -938.9941852862705, -41.3959444430632, -822.0852828699007, -995.5569089207049, -879.357663636849, -1252.8730695575946, -662.0116237832859, -541.0348802239693, -499.93068321543996, -889.0196463957216, -117.28095030040795, -258.34861507306067, -435.08105653465725, -67.40133745468371, -524.3618225018189, -454.8272401312882, -951.1969929612147, -1128.9991158370133, -1191.2898843667524, -1048.5616861410087, -1342.5397183909154, -854.3917324616575, -1245.4654993264007, -43.54886005141058, -214.1019634762496, -1282.2206822977155, -682.8303791671789, -1187.476890669443, -1000.9531384358497, -1076.8526686721964, -1291.6386804780545, -373.8032916850008, -97.45206766024396, -1050.442527356863, -706.3350704849796, -1167.7766986534655, -1099.5388721785782, -598.5873573576761, -671.513809784387, -1147.4819426949273, -575.9485462178764, -278.74582415799733, -889.3599843308972, -1365.2305971318963, -763.8547550144889, -1128.1748627253016, -629.8694261630428, -791.2021856885991, -387.0834810249055, -217.8339636095032, -450.2592366395034, -991.6818999886351, -981.0229167886272, -1274.5114584330174, -61.52758035269457, -1116.0330762393905, -51.52952650849609, -1186.8423598879363, -815.780056478361, -301.90956321962494, -923.5647754151502, -1305.365661380881, -775.6799603539558, -188.92805357064822, -1327.5236475864438, -327.6758122205898, -1185.9501158324115, -761.4828533217657, -1096.023347977574, -50.399580399438385, -192.22593259636048, -849.5474790561343, -644.6141493237342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634051153342793, "mean_inference_ms": 1.6960800060790904, "mean_action_processing_ms": 0.28064919046238407, "mean_env_wait_ms": 3.4852205369804046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012766361236572266, "StateBufferConnector_ms": 0.00833749771118164, "ViewRequirementAgentConnector_ms": 0.1861271858215332}, "num_episodes": 33, "episode_return_max": -41.3959444430632, "episode_return_min": -1365.2305971318963, "episode_return_mean": -760.6669962069275, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.8672994629501, "num_env_steps_trained_throughput_per_sec": 349.8672994629501, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12852.213, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12852.142, "sample_time_ms": 1152.786, "learn_time_ms": 11629.541, "learn_throughput": 343.952, "synch_weights_time_ms": 69.027}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00013", "date": "2024-08-04_06-41-25", "timestamp": 1722733885, "time_this_iter_s": 11.445368528366089, "time_total_s": 90.04733848571777, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923709904c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.04733848571777, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.61875, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.74994259874026, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.09068815484643, "policy_loss": -0.012367426328516255, "vf_loss": 6.099645739793777, "vf_explained_var": 0.7080301569774747, "kl": 0.01580330453677259, "entropy": 1.3311739801118772, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -18.548770585769013, "episode_reward_min": -1418.8545529558216, "episode_reward_mean": -693.9915131999627, "episode_len_mean": 121.97, "episode_media": {}, "episodes_timesteps_total": 12197, "policy_reward_min": {"policy_0": -1418.8545529558216}, "policy_reward_max": {"policy_0": -18.548770585769013}, "policy_reward_mean": {"policy_0": -693.9915131999627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-541.0348802239693, -499.93068321543996, -889.0196463957216, -117.28095030040795, -258.34861507306067, -435.08105653465725, -67.40133745468371, -524.3618225018189, -454.8272401312882, -951.1969929612147, -1128.9991158370133, -1191.2898843667524, -1048.5616861410087, -1342.5397183909154, -854.3917324616575, -1245.4654993264007, -43.54886005141058, -214.1019634762496, -1282.2206822977155, -682.8303791671789, -1187.476890669443, -1000.9531384358497, -1076.8526686721964, -1291.6386804780545, -373.8032916850008, -97.45206766024396, -1050.442527356863, -706.3350704849796, -1167.7766986534655, -1099.5388721785782, -598.5873573576761, -671.513809784387, -1147.4819426949273, -575.9485462178764, -278.74582415799733, -889.3599843308972, -1365.2305971318963, -763.8547550144889, -1128.1748627253016, -629.8694261630428, -791.2021856885991, -387.0834810249055, -217.8339636095032, -450.2592366395034, -991.6818999886351, -981.0229167886272, -1274.5114584330174, -61.52758035269457, -1116.0330762393905, -51.52952650849609, -1186.8423598879363, -815.780056478361, -301.90956321962494, -923.5647754151502, -1305.365661380881, -775.6799603539558, -188.92805357064822, -1327.5236475864438, -327.6758122205898, -1185.9501158324115, -761.4828533217657, -1096.023347977574, -50.399580399438385, -192.22593259636048, -849.5474790561343, -644.6141493237342, -43.509898469948496, -1312.549299042468, -259.59115524864444, -359.2963237520559, -85.52696759963933, -240.3207543406952, -177.66402491928386, -921.8440300164576, -1019.7113606869133, -257.85819370359553, -513.2689171312607, -144.52719725257083, -536.5462167065215, -462.6243079218135, -870.679246149719, -61.94956896259409, -87.76868854187867, -18.548770585769013, -1327.2867376535069, -1027.9186113711469, -744.4191615138606, -1180.195539801804, -1222.9786309314138, -927.1513765606973, -962.3356153118458, -825.1403653900263, -118.85072881127523, -1131.051833373423, -1418.8545529558216, -152.50627274829412, -289.3317301373893, -1137.805971409421, -29.635612715470497, -400.2352262229204], "episode_lengths": [150, 135, 150, 76, 75, 95, 60, 102, 101, 150, 150, 150, 150, 150, 150, 150, 42, 80, 150, 150, 150, 150, 150, 150, 150, 69, 150, 131, 150, 150, 150, 136, 150, 149, 110, 150, 150, 150, 150, 150, 150, 96, 71, 117, 150, 150, 150, 44, 150, 40, 150, 144, 114, 150, 150, 150, 80, 150, 127, 150, 150, 150, 52, 87, 150, 150, 53, 150, 78, 88, 56, 88, 75, 150, 150, 79, 119, 56, 135, 150, 150, 46, 51, 41, 150, 150, 138, 150, 150, 150, 150, 150, 62, 150, 150, 58, 95, 150, 49, 97], "policy_policy_0_reward": [-541.0348802239693, -499.93068321543996, -889.0196463957216, -117.28095030040795, -258.34861507306067, -435.08105653465725, -67.40133745468371, -524.3618225018189, -454.8272401312882, -951.1969929612147, -1128.9991158370133, -1191.2898843667524, -1048.5616861410087, -1342.5397183909154, -854.3917324616575, -1245.4654993264007, -43.54886005141058, -214.1019634762496, -1282.2206822977155, -682.8303791671789, -1187.476890669443, -1000.9531384358497, -1076.8526686721964, -1291.6386804780545, -373.8032916850008, -97.45206766024396, -1050.442527356863, -706.3350704849796, -1167.7766986534655, -1099.5388721785782, -598.5873573576761, -671.513809784387, -1147.4819426949273, -575.9485462178764, -278.74582415799733, -889.3599843308972, -1365.2305971318963, -763.8547550144889, -1128.1748627253016, -629.8694261630428, -791.2021856885991, -387.0834810249055, -217.8339636095032, -450.2592366395034, -991.6818999886351, -981.0229167886272, -1274.5114584330174, -61.52758035269457, -1116.0330762393905, -51.52952650849609, -1186.8423598879363, -815.780056478361, -301.90956321962494, -923.5647754151502, -1305.365661380881, -775.6799603539558, -188.92805357064822, -1327.5236475864438, -327.6758122205898, -1185.9501158324115, -761.4828533217657, -1096.023347977574, -50.399580399438385, -192.22593259636048, -849.5474790561343, -644.6141493237342, -43.509898469948496, -1312.549299042468, -259.59115524864444, -359.2963237520559, -85.52696759963933, -240.3207543406952, -177.66402491928386, -921.8440300164576, -1019.7113606869133, -257.85819370359553, -513.2689171312607, -144.52719725257083, -536.5462167065215, -462.6243079218135, -870.679246149719, -61.94956896259409, -87.76868854187867, -18.548770585769013, -1327.2867376535069, -1027.9186113711469, -744.4191615138606, -1180.195539801804, -1222.9786309314138, -927.1513765606973, -962.3356153118458, -825.1403653900263, -118.85072881127523, -1131.051833373423, -1418.8545529558216, -152.50627274829412, -289.3317301373893, -1137.805971409421, -29.635612715470497, -400.2352262229204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627577473254128, "mean_inference_ms": 1.6940072557667418, "mean_action_processing_ms": 0.2798105179047918, "mean_env_wait_ms": 3.484703722090536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012802362442016602, "StateBufferConnector_ms": 0.00820612907409668, "ViewRequirementAgentConnector_ms": 0.18835115432739258}, "num_episodes": 34, "episode_return_max": -18.548770585769013, "episode_return_min": -1418.8545529558216, "episode_return_mean": -693.9915131999627, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.3002373034034, "num_env_steps_trained_throughput_per_sec": 300.3002373034034, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12910.688, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12910.618, "sample_time_ms": 1157.532, "learn_time_ms": 11682.667, "learn_throughput": 342.388, "synch_weights_time_ms": 69.638}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00013", "date": "2024-08-04_06-41-38", "timestamp": 1722733898, "time_this_iter_s": 13.331414222717285, "time_total_s": 103.37875270843506, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370993400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.37875270843506, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.11052631578947, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.13173812975486, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.839121627310912, "policy_loss": -0.014258075070392806, "vf_loss": 5.849359687666098, "vf_explained_var": 0.7624999556690455, "kl": 0.018076849650484898, "entropy": 1.4030475004265706, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -18.548770585769013, "episode_reward_min": -1418.8545529558216, "episode_reward_mean": -695.8071597163128, "episode_len_mean": 124.19, "episode_media": {}, "episodes_timesteps_total": 12419, "policy_reward_min": {"policy_0": -1418.8545529558216}, "policy_reward_max": {"policy_0": -18.548770585769013}, "policy_reward_mean": {"policy_0": -695.8071597163128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-575.9485462178764, -278.74582415799733, -889.3599843308972, -1365.2305971318963, -763.8547550144889, -1128.1748627253016, -629.8694261630428, -791.2021856885991, -387.0834810249055, -217.8339636095032, -450.2592366395034, -991.6818999886351, -981.0229167886272, -1274.5114584330174, -61.52758035269457, -1116.0330762393905, -51.52952650849609, -1186.8423598879363, -815.780056478361, -301.90956321962494, -923.5647754151502, -1305.365661380881, -775.6799603539558, -188.92805357064822, -1327.5236475864438, -327.6758122205898, -1185.9501158324115, -761.4828533217657, -1096.023347977574, -50.399580399438385, -192.22593259636048, -849.5474790561343, -644.6141493237342, -43.509898469948496, -1312.549299042468, -259.59115524864444, -359.2963237520559, -85.52696759963933, -240.3207543406952, -177.66402491928386, -921.8440300164576, -1019.7113606869133, -257.85819370359553, -513.2689171312607, -144.52719725257083, -536.5462167065215, -462.6243079218135, -870.679246149719, -61.94956896259409, -87.76868854187867, -18.548770585769013, -1327.2867376535069, -1027.9186113711469, -744.4191615138606, -1180.195539801804, -1222.9786309314138, -927.1513765606973, -962.3356153118458, -825.1403653900263, -118.85072881127523, -1131.051833373423, -1418.8545529558216, -152.50627274829412, -289.3317301373893, -1137.805971409421, -29.635612715470497, -400.2352262229204, -1077.8194257292382, -663.3566469582794, -1404.2231874100646, -719.9190819355488, -1173.1514131361748, -1305.4172757157844, -672.4547568159007, -547.4543345871546, -731.0770734462433, -514.314456914118, -1061.2063573228927, -1068.0695151297866, -1252.0475931092371, -45.811634646400805, -781.7374497222646, -75.98596571529227, -1297.2971504056159, -1056.3802846013418, -861.583960664997, -325.85970514003094, -559.5749308613941, -466.7361327677156, -930.9324869246891, -113.29754330859133, -277.6313643416025, -762.2934485138351, -597.1745948106031, -676.6050445789532, -745.1353153889065, -609.768515139052, -986.9357180883521, -1006.307237152518, -1056.2908130726757], "episode_lengths": [149, 110, 150, 150, 150, 150, 150, 150, 96, 71, 117, 150, 150, 150, 44, 150, 40, 150, 144, 114, 150, 150, 150, 80, 150, 127, 150, 150, 150, 52, 87, 150, 150, 53, 150, 78, 88, 56, 88, 75, 150, 150, 79, 119, 56, 135, 150, 150, 46, 51, 41, 150, 150, 138, 150, 150, 150, 150, 150, 62, 150, 150, 58, 95, 150, 49, 97, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 43, 150, 55, 150, 150, 150, 100, 150, 114, 150, 57, 82, 150, 150, 149, 150, 127, 150, 150, 150], "policy_policy_0_reward": [-575.9485462178764, -278.74582415799733, -889.3599843308972, -1365.2305971318963, -763.8547550144889, -1128.1748627253016, -629.8694261630428, -791.2021856885991, -387.0834810249055, -217.8339636095032, -450.2592366395034, -991.6818999886351, -981.0229167886272, -1274.5114584330174, -61.52758035269457, -1116.0330762393905, -51.52952650849609, -1186.8423598879363, -815.780056478361, -301.90956321962494, -923.5647754151502, -1305.365661380881, -775.6799603539558, -188.92805357064822, -1327.5236475864438, -327.6758122205898, -1185.9501158324115, -761.4828533217657, -1096.023347977574, -50.399580399438385, -192.22593259636048, -849.5474790561343, -644.6141493237342, -43.509898469948496, -1312.549299042468, -259.59115524864444, -359.2963237520559, -85.52696759963933, -240.3207543406952, -177.66402491928386, -921.8440300164576, -1019.7113606869133, -257.85819370359553, -513.2689171312607, -144.52719725257083, -536.5462167065215, -462.6243079218135, -870.679246149719, -61.94956896259409, -87.76868854187867, -18.548770585769013, -1327.2867376535069, -1027.9186113711469, -744.4191615138606, -1180.195539801804, -1222.9786309314138, -927.1513765606973, -962.3356153118458, -825.1403653900263, -118.85072881127523, -1131.051833373423, -1418.8545529558216, -152.50627274829412, -289.3317301373893, -1137.805971409421, -29.635612715470497, -400.2352262229204, -1077.8194257292382, -663.3566469582794, -1404.2231874100646, -719.9190819355488, -1173.1514131361748, -1305.4172757157844, -672.4547568159007, -547.4543345871546, -731.0770734462433, -514.314456914118, -1061.2063573228927, -1068.0695151297866, -1252.0475931092371, -45.811634646400805, -781.7374497222646, -75.98596571529227, -1297.2971504056159, -1056.3802846013418, -861.583960664997, -325.85970514003094, -559.5749308613941, -466.7361327677156, -930.9324869246891, -113.29754330859133, -277.6313643416025, -762.2934485138351, -597.1745948106031, -676.6050445789532, -745.1353153889065, -609.768515139052, -986.9357180883521, -1006.307237152518, -1056.2908130726757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5605064005072026, "mean_inference_ms": 1.6913028172955245, "mean_action_processing_ms": 0.27920402396254257, "mean_env_wait_ms": 3.483019764198344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012388229370117188, "StateBufferConnector_ms": 0.0079498291015625, "ViewRequirementAgentConnector_ms": 0.1869373321533203}, "num_episodes": 33, "episode_return_max": -18.548770585769013, "episode_return_min": -1418.8545529558216, "episode_return_mean": -695.8071597163128, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.9435250288408, "num_env_steps_trained_throughput_per_sec": 295.9435250288408, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12977.956, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12977.886, "sample_time_ms": 1170.916, "learn_time_ms": 11737.142, "learn_throughput": 340.798, "synch_weights_time_ms": 69.046}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00013", "date": "2024-08-04_06-41-52", "timestamp": 1722733912, "time_this_iter_s": 13.528183221817017, "time_total_s": 116.90693593025208, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb9900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.90693593025208, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.28947368421053, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.964404833316806, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.44767848153909, "policy_loss": -0.0060491609222178035, "vf_loss": 5.450577893356482, "vf_explained_var": 0.8344652077804009, "kl": 0.014562948881211924, "entropy": 1.219146208278835, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -18.548770585769013, "episode_reward_min": -1425.234385787228, "episode_reward_mean": -661.2510705585122, "episode_len_mean": 122.05, "episode_media": {}, "episodes_timesteps_total": 12205, "policy_reward_min": {"policy_0": -1425.234385787228}, "policy_reward_max": {"policy_0": -18.548770585769013}, "policy_reward_mean": {"policy_0": -661.2510705585122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.22593259636048, -849.5474790561343, -644.6141493237342, -43.509898469948496, -1312.549299042468, -259.59115524864444, -359.2963237520559, -85.52696759963933, -240.3207543406952, -177.66402491928386, -921.8440300164576, -1019.7113606869133, -257.85819370359553, -513.2689171312607, -144.52719725257083, -536.5462167065215, -462.6243079218135, -870.679246149719, -61.94956896259409, -87.76868854187867, -18.548770585769013, -1327.2867376535069, -1027.9186113711469, -744.4191615138606, -1180.195539801804, -1222.9786309314138, -927.1513765606973, -962.3356153118458, -825.1403653900263, -118.85072881127523, -1131.051833373423, -1418.8545529558216, -152.50627274829412, -289.3317301373893, -1137.805971409421, -29.635612715470497, -400.2352262229204, -1077.8194257292382, -663.3566469582794, -1404.2231874100646, -719.9190819355488, -1173.1514131361748, -1305.4172757157844, -672.4547568159007, -547.4543345871546, -731.0770734462433, -514.314456914118, -1061.2063573228927, -1068.0695151297866, -1252.0475931092371, -45.811634646400805, -781.7374497222646, -75.98596571529227, -1297.2971504056159, -1056.3802846013418, -861.583960664997, -325.85970514003094, -559.5749308613941, -466.7361327677156, -930.9324869246891, -113.29754330859133, -277.6313643416025, -762.2934485138351, -597.1745948106031, -676.6050445789532, -745.1353153889065, -609.768515139052, -986.9357180883521, -1006.307237152518, -1056.2908130726757, -430.47603357905916, -1425.234385787228, -1165.696357025056, -167.30002161944074, -1064.7004469410342, -996.9048278165511, -988.91007979825, -218.64817481332517, -1108.0556374133853, -301.84031408162724, -700.8732950789966, -564.3173061608917, -223.3235210365371, -356.0319075910297, -1285.9250282330222, -161.72629913097765, -167.08370002533962, -778.1391792719589, -830.1606755075031, -273.65752893873173, -118.28234886703413, -60.33113119657016, -298.0501339355116, -523.54809096399, -689.4585244737802, -1415.3495683947358, -945.2147535232286, -487.7569238536139, -646.9204343061733, -351.46956351499813], "episode_lengths": [87, 150, 150, 53, 150, 78, 88, 56, 88, 75, 150, 150, 79, 119, 56, 135, 150, 150, 46, 51, 41, 150, 150, 138, 150, 150, 150, 150, 150, 62, 150, 150, 58, 95, 150, 49, 97, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 43, 150, 55, 150, 150, 150, 100, 150, 114, 150, 57, 82, 150, 150, 149, 150, 127, 150, 150, 150, 94, 150, 150, 83, 150, 150, 150, 90, 150, 78, 150, 150, 100, 85, 150, 66, 85, 150, 150, 81, 81, 66, 90, 143, 147, 150, 150, 150, 146, 95], "policy_policy_0_reward": [-192.22593259636048, -849.5474790561343, -644.6141493237342, -43.509898469948496, -1312.549299042468, -259.59115524864444, -359.2963237520559, -85.52696759963933, -240.3207543406952, -177.66402491928386, -921.8440300164576, -1019.7113606869133, -257.85819370359553, -513.2689171312607, -144.52719725257083, -536.5462167065215, -462.6243079218135, -870.679246149719, -61.94956896259409, -87.76868854187867, -18.548770585769013, -1327.2867376535069, -1027.9186113711469, -744.4191615138606, -1180.195539801804, -1222.9786309314138, -927.1513765606973, -962.3356153118458, -825.1403653900263, -118.85072881127523, -1131.051833373423, -1418.8545529558216, -152.50627274829412, -289.3317301373893, -1137.805971409421, -29.635612715470497, -400.2352262229204, -1077.8194257292382, -663.3566469582794, -1404.2231874100646, -719.9190819355488, -1173.1514131361748, -1305.4172757157844, -672.4547568159007, -547.4543345871546, -731.0770734462433, -514.314456914118, -1061.2063573228927, -1068.0695151297866, -1252.0475931092371, -45.811634646400805, -781.7374497222646, -75.98596571529227, -1297.2971504056159, -1056.3802846013418, -861.583960664997, -325.85970514003094, -559.5749308613941, -466.7361327677156, -930.9324869246891, -113.29754330859133, -277.6313643416025, -762.2934485138351, -597.1745948106031, -676.6050445789532, -745.1353153889065, -609.768515139052, -986.9357180883521, -1006.307237152518, -1056.2908130726757, -430.47603357905916, -1425.234385787228, -1165.696357025056, -167.30002161944074, -1064.7004469410342, -996.9048278165511, -988.91007979825, -218.64817481332517, -1108.0556374133853, -301.84031408162724, -700.8732950789966, -564.3173061608917, -223.3235210365371, -356.0319075910297, -1285.9250282330222, -161.72629913097765, -167.08370002533962, -778.1391792719589, -830.1606755075031, -273.65752893873173, -118.28234886703413, -60.33113119657016, -298.0501339355116, -523.54809096399, -689.4585244737802, -1415.3495683947358, -945.2147535232286, -487.7569238536139, -646.9204343061733, -351.46956351499813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589938653702038, "mean_inference_ms": 1.6912743674078887, "mean_action_processing_ms": 0.2784500594825705, "mean_env_wait_ms": 3.480528707952358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01215052604675293, "StateBufferConnector_ms": 0.007787227630615234, "ViewRequirementAgentConnector_ms": 0.18509411811828613}, "num_episodes": 30, "episode_return_max": -18.548770585769013, "episode_return_min": -1425.234385787228, "episode_return_mean": -661.2510705585122, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.89236364346596, "num_env_steps_trained_throughput_per_sec": 297.89236364346596, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13022.929, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13022.859, "sample_time_ms": 1169.951, "learn_time_ms": 11783.765, "learn_throughput": 339.45, "synch_weights_time_ms": 68.358}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00013", "date": "2024-08-04_06-42-05", "timestamp": 1722733925, "time_this_iter_s": 13.439942359924316, "time_total_s": 130.3468782901764, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370808820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.3468782901764, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.305263157894736, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.08939258952935, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.366697658350071, "policy_loss": -0.01052454829235406, "vf_loss": 5.373448027173678, "vf_explained_var": 0.8606048805639148, "kl": 0.017322789124561193, "entropy": 1.4226444561034441, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -27.371874354416054, "episode_reward_min": -1425.234385787228, "episode_reward_mean": -708.0388248912478, "episode_len_mean": 127.48, "episode_media": {}, "episodes_timesteps_total": 12748, "policy_reward_min": {"policy_0": -1425.234385787228}, "policy_reward_max": {"policy_0": -27.371874354416054}, "policy_reward_mean": {"policy_0": -708.0388248912478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1418.8545529558216, -152.50627274829412, -289.3317301373893, -1137.805971409421, -29.635612715470497, -400.2352262229204, -1077.8194257292382, -663.3566469582794, -1404.2231874100646, -719.9190819355488, -1173.1514131361748, -1305.4172757157844, -672.4547568159007, -547.4543345871546, -731.0770734462433, -514.314456914118, -1061.2063573228927, -1068.0695151297866, -1252.0475931092371, -45.811634646400805, -781.7374497222646, -75.98596571529227, -1297.2971504056159, -1056.3802846013418, -861.583960664997, -325.85970514003094, -559.5749308613941, -466.7361327677156, -930.9324869246891, -113.29754330859133, -277.6313643416025, -762.2934485138351, -597.1745948106031, -676.6050445789532, -745.1353153889065, -609.768515139052, -986.9357180883521, -1006.307237152518, -1056.2908130726757, -430.47603357905916, -1425.234385787228, -1165.696357025056, -167.30002161944074, -1064.7004469410342, -996.9048278165511, -988.91007979825, -218.64817481332517, -1108.0556374133853, -301.84031408162724, -700.8732950789966, -564.3173061608917, -223.3235210365371, -356.0319075910297, -1285.9250282330222, -161.72629913097765, -167.08370002533962, -778.1391792719589, -830.1606755075031, -273.65752893873173, -118.28234886703413, -60.33113119657016, -298.0501339355116, -523.54809096399, -689.4585244737802, -1415.3495683947358, -945.2147535232286, -487.7569238536139, -646.9204343061733, -351.46956351499813, -1142.1510268459856, -249.80268741749867, -212.7462772753739, -769.4191790444819, -690.1964787720227, -1306.1007188953588, -274.9253236136046, -1196.1871599029594, -879.3522808800077, -268.1646338185991, -655.614804942251, -942.9980875433662, -1026.905867988754, -136.83772155244242, -1014.4182712368216, -472.3186834273346, -956.9466047850538, -527.0322914683669, -27.371874354416054, -1361.0820434687512, -497.91642691728447, -999.2225466273243, -647.692614024712, -1210.3804535092647, -180.58768302057945, -821.9619176571927, -1063.6454169547706, -1151.599079496158, -515.5326053999207, -779.1983001663325, -1227.9674549936394], "episode_lengths": [150, 58, 95, 150, 49, 97, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 43, 150, 55, 150, 150, 150, 100, 150, 114, 150, 57, 82, 150, 150, 149, 150, 127, 150, 150, 150, 94, 150, 150, 83, 150, 150, 150, 90, 150, 78, 150, 150, 100, 85, 150, 66, 85, 150, 150, 81, 81, 66, 90, 143, 147, 150, 150, 150, 146, 95, 150, 73, 97, 150, 150, 150, 82, 150, 150, 75, 150, 150, 150, 72, 150, 111, 150, 150, 47, 150, 119, 150, 150, 150, 90, 150, 150, 150, 129, 150, 150], "policy_policy_0_reward": [-1418.8545529558216, -152.50627274829412, -289.3317301373893, -1137.805971409421, -29.635612715470497, -400.2352262229204, -1077.8194257292382, -663.3566469582794, -1404.2231874100646, -719.9190819355488, -1173.1514131361748, -1305.4172757157844, -672.4547568159007, -547.4543345871546, -731.0770734462433, -514.314456914118, -1061.2063573228927, -1068.0695151297866, -1252.0475931092371, -45.811634646400805, -781.7374497222646, -75.98596571529227, -1297.2971504056159, -1056.3802846013418, -861.583960664997, -325.85970514003094, -559.5749308613941, -466.7361327677156, -930.9324869246891, -113.29754330859133, -277.6313643416025, -762.2934485138351, -597.1745948106031, -676.6050445789532, -745.1353153889065, -609.768515139052, -986.9357180883521, -1006.307237152518, -1056.2908130726757, -430.47603357905916, -1425.234385787228, -1165.696357025056, -167.30002161944074, -1064.7004469410342, -996.9048278165511, -988.91007979825, -218.64817481332517, -1108.0556374133853, -301.84031408162724, -700.8732950789966, -564.3173061608917, -223.3235210365371, -356.0319075910297, -1285.9250282330222, -161.72629913097765, -167.08370002533962, -778.1391792719589, -830.1606755075031, -273.65752893873173, -118.28234886703413, -60.33113119657016, -298.0501339355116, -523.54809096399, -689.4585244737802, -1415.3495683947358, -945.2147535232286, -487.7569238536139, -646.9204343061733, -351.46956351499813, -1142.1510268459856, -249.80268741749867, -212.7462772753739, -769.4191790444819, -690.1964787720227, -1306.1007188953588, -274.9253236136046, -1196.1871599029594, -879.3522808800077, -268.1646338185991, -655.614804942251, -942.9980875433662, -1026.905867988754, -136.83772155244242, -1014.4182712368216, -472.3186834273346, -956.9466047850538, -527.0322914683669, -27.371874354416054, -1361.0820434687512, -497.91642691728447, -999.2225466273243, -647.692614024712, -1210.3804535092647, -180.58768302057945, -821.9619176571927, -1063.6454169547706, -1151.599079496158, -515.5326053999207, -779.1983001663325, -1227.9674549936394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569047694174372, "mean_inference_ms": 1.6912660744862498, "mean_action_processing_ms": 0.27793222063472467, "mean_env_wait_ms": 3.481431585603582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012162446975708008, "StateBufferConnector_ms": 0.008033037185668945, "ViewRequirementAgentConnector_ms": 0.18965673446655273}, "num_episodes": 31, "episode_return_max": -27.371874354416054, "episode_return_min": -1425.234385787228, "episode_return_mean": -708.0388248912478, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.8069780606667, "num_env_steps_trained_throughput_per_sec": 308.8069780606667, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13068.453, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13068.382, "sample_time_ms": 1170.168, "learn_time_ms": 11832.295, "learn_throughput": 338.058, "synch_weights_time_ms": 65.132}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00013", "date": "2024-08-04_06-42-18", "timestamp": 1722733938, "time_this_iter_s": 12.965513944625854, "time_total_s": 143.31239223480225, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370993400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.31239223480225, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.46315789473684, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.10774542689323, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.857924134284258, "policy_loss": -0.0032708671526052056, "vf_loss": 3.85913416047891, "vf_explained_var": 0.8874399937068422, "kl": 0.010908789467187792, "entropy": 1.211783770037194, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -20.823361215665514, "episode_reward_min": -1462.9909512555457, "episode_reward_mean": -691.2207343429322, "episode_len_mean": 128.95, "episode_media": {}, "episodes_timesteps_total": 12895, "policy_reward_min": {"policy_0": -1462.9909512555457}, "policy_reward_max": {"policy_0": -20.823361215665514}, "policy_reward_mean": {"policy_0": -691.2207343429322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-762.2934485138351, -597.1745948106031, -676.6050445789532, -745.1353153889065, -609.768515139052, -986.9357180883521, -1006.307237152518, -1056.2908130726757, -430.47603357905916, -1425.234385787228, -1165.696357025056, -167.30002161944074, -1064.7004469410342, -996.9048278165511, -988.91007979825, -218.64817481332517, -1108.0556374133853, -301.84031408162724, -700.8732950789966, -564.3173061608917, -223.3235210365371, -356.0319075910297, -1285.9250282330222, -161.72629913097765, -167.08370002533962, -778.1391792719589, -830.1606755075031, -273.65752893873173, -118.28234886703413, -60.33113119657016, -298.0501339355116, -523.54809096399, -689.4585244737802, -1415.3495683947358, -945.2147535232286, -487.7569238536139, -646.9204343061733, -351.46956351499813, -1142.1510268459856, -249.80268741749867, -212.7462772753739, -769.4191790444819, -690.1964787720227, -1306.1007188953588, -274.9253236136046, -1196.1871599029594, -879.3522808800077, -268.1646338185991, -655.614804942251, -942.9980875433662, -1026.905867988754, -136.83772155244242, -1014.4182712368216, -472.3186834273346, -956.9466047850538, -527.0322914683669, -27.371874354416054, -1361.0820434687512, -497.91642691728447, -999.2225466273243, -647.692614024712, -1210.3804535092647, -180.58768302057945, -821.9619176571927, -1063.6454169547706, -1151.599079496158, -515.5326053999207, -779.1983001663325, -1227.9674549936394, -1104.0270843651113, -397.77564718178854, -777.282966861532, -1325.9232438181884, -289.5402139648615, -118.614595456996, -173.67363609305875, -940.8744105058864, -1462.9909512555457, -293.7059607575686, -1212.424289596784, -610.8356932480336, -1060.4730512904916, -913.9240207504633, -391.9842740306993, -20.823361215665514, -780.1692327503578, -934.0130544771189, -319.50680284497867, -497.0885309562021, -1166.560346422615, -804.3980527322442, -706.4835872162616, -745.539886112722, -949.0487912825394, -528.9059456515618, -685.4649231945621, -511.71558610768, -113.74907145228751, -519.9791926923087, -372.40363438200876], "episode_lengths": [150, 150, 149, 150, 127, 150, 150, 150, 94, 150, 150, 83, 150, 150, 150, 90, 150, 78, 150, 150, 100, 85, 150, 66, 85, 150, 150, 81, 81, 66, 90, 143, 147, 150, 150, 150, 146, 95, 150, 73, 97, 150, 150, 150, 82, 150, 150, 75, 150, 150, 150, 72, 150, 111, 150, 150, 47, 150, 119, 150, 150, 150, 90, 150, 150, 150, 129, 150, 150, 150, 126, 150, 150, 150, 55, 60, 150, 150, 135, 150, 126, 150, 150, 131, 36, 150, 150, 79, 150, 150, 150, 150, 150, 150, 108, 150, 150, 57, 150, 131], "policy_policy_0_reward": [-762.2934485138351, -597.1745948106031, -676.6050445789532, -745.1353153889065, -609.768515139052, -986.9357180883521, -1006.307237152518, -1056.2908130726757, -430.47603357905916, -1425.234385787228, -1165.696357025056, -167.30002161944074, -1064.7004469410342, -996.9048278165511, -988.91007979825, -218.64817481332517, -1108.0556374133853, -301.84031408162724, -700.8732950789966, -564.3173061608917, -223.3235210365371, -356.0319075910297, -1285.9250282330222, -161.72629913097765, -167.08370002533962, -778.1391792719589, -830.1606755075031, -273.65752893873173, -118.28234886703413, -60.33113119657016, -298.0501339355116, -523.54809096399, -689.4585244737802, -1415.3495683947358, -945.2147535232286, -487.7569238536139, -646.9204343061733, -351.46956351499813, -1142.1510268459856, -249.80268741749867, -212.7462772753739, -769.4191790444819, -690.1964787720227, -1306.1007188953588, -274.9253236136046, -1196.1871599029594, -879.3522808800077, -268.1646338185991, -655.614804942251, -942.9980875433662, -1026.905867988754, -136.83772155244242, -1014.4182712368216, -472.3186834273346, -956.9466047850538, -527.0322914683669, -27.371874354416054, -1361.0820434687512, -497.91642691728447, -999.2225466273243, -647.692614024712, -1210.3804535092647, -180.58768302057945, -821.9619176571927, -1063.6454169547706, -1151.599079496158, -515.5326053999207, -779.1983001663325, -1227.9674549936394, -1104.0270843651113, -397.77564718178854, -777.282966861532, -1325.9232438181884, -289.5402139648615, -118.614595456996, -173.67363609305875, -940.8744105058864, -1462.9909512555457, -293.7059607575686, -1212.424289596784, -610.8356932480336, -1060.4730512904916, -913.9240207504633, -391.9842740306993, -20.823361215665514, -780.1692327503578, -934.0130544771189, -319.50680284497867, -497.0885309562021, -1166.560346422615, -804.3980527322442, -706.4835872162616, -745.539886112722, -949.0487912825394, -528.9059456515618, -685.4649231945621, -511.71558610768, -113.74907145228751, -519.9791926923087, -372.40363438200876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569010922861382, "mean_inference_ms": 1.694465662301068, "mean_action_processing_ms": 0.2783144389772292, "mean_env_wait_ms": 3.4860981980916717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012281179428100586, "StateBufferConnector_ms": 0.008468151092529297, "ViewRequirementAgentConnector_ms": 0.19613027572631836}, "num_episodes": 31, "episode_return_max": -20.823361215665514, "episode_return_min": -1462.9909512555457, "episode_return_mean": -691.2207343429322, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.61525875360184, "num_env_steps_trained_throughput_per_sec": 310.61525875360184, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13044.502, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13044.431, "sample_time_ms": 1167.976, "learn_time_ms": 11810.773, "learn_throughput": 338.674, "synch_weights_time_ms": 64.896}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00013", "date": "2024-08-04_06-42-31", "timestamp": 1722733951, "time_this_iter_s": 12.890553951263428, "time_total_s": 156.20294618606567, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370809120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.20294618606567, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.694444444444443, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 82.70531001289686, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.074995133156578, "policy_loss": -0.011671180925623048, "vf_loss": 4.082599167029063, "vf_explained_var": 0.9367518049354354, "kl": 0.01784978012183275, "entropy": 1.2877877842634917, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -20.823361215665514, "episode_reward_min": -1505.6249613835637, "episode_reward_mean": -683.1636214602328, "episode_len_mean": 130.13, "episode_media": {}, "episodes_timesteps_total": 13013, "policy_reward_min": {"policy_0": -1505.6249613835637}, "policy_reward_max": {"policy_0": -20.823361215665514}, "policy_reward_mean": {"policy_0": -683.1636214602328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.33113119657016, -298.0501339355116, -523.54809096399, -689.4585244737802, -1415.3495683947358, -945.2147535232286, -487.7569238536139, -646.9204343061733, -351.46956351499813, -1142.1510268459856, -249.80268741749867, -212.7462772753739, -769.4191790444819, -690.1964787720227, -1306.1007188953588, -274.9253236136046, -1196.1871599029594, -879.3522808800077, -268.1646338185991, -655.614804942251, -942.9980875433662, -1026.905867988754, -136.83772155244242, -1014.4182712368216, -472.3186834273346, -956.9466047850538, -527.0322914683669, -27.371874354416054, -1361.0820434687512, -497.91642691728447, -999.2225466273243, -647.692614024712, -1210.3804535092647, -180.58768302057945, -821.9619176571927, -1063.6454169547706, -1151.599079496158, -515.5326053999207, -779.1983001663325, -1227.9674549936394, -1104.0270843651113, -397.77564718178854, -777.282966861532, -1325.9232438181884, -289.5402139648615, -118.614595456996, -173.67363609305875, -940.8744105058864, -1462.9909512555457, -293.7059607575686, -1212.424289596784, -610.8356932480336, -1060.4730512904916, -913.9240207504633, -391.9842740306993, -20.823361215665514, -780.1692327503578, -934.0130544771189, -319.50680284497867, -497.0885309562021, -1166.560346422615, -804.3980527322442, -706.4835872162616, -745.539886112722, -949.0487912825394, -528.9059456515618, -685.4649231945621, -511.71558610768, -113.74907145228751, -519.9791926923087, -372.40363438200876, -1208.5787749992144, -523.7653480171866, -893.9181444070119, -221.10242880531402, -774.9396990418645, -893.2358204274857, -312.8647404172107, -633.0459139368812, -574.1982715566206, -161.94666968507087, -444.5539525867679, -207.98079869866078, -696.2148633835967, -607.6664653769426, -106.95397646472614, -190.21313398537268, -59.426202779397, -638.0669145586486, -898.5873877490571, -1193.4221079895312, -1029.5470677802757, -795.6000973912896, -283.5685729258991, -1505.6249613835637, -627.9203706761914, -670.1508406854045, -606.5081377635322, -1209.709563500565, -992.7752402186458], "episode_lengths": [66, 90, 143, 147, 150, 150, 150, 146, 95, 150, 73, 97, 150, 150, 150, 82, 150, 150, 75, 150, 150, 150, 72, 150, 111, 150, 150, 47, 150, 119, 150, 150, 150, 90, 150, 150, 150, 129, 150, 150, 150, 126, 150, 150, 150, 55, 60, 150, 150, 135, 150, 126, 150, 150, 131, 36, 150, 150, 79, 150, 150, 150, 150, 150, 150, 108, 150, 150, 57, 150, 131, 150, 140, 149, 98, 150, 150, 83, 150, 150, 83, 150, 89, 150, 150, 68, 81, 59, 127, 150, 150, 150, 140, 120, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-60.33113119657016, -298.0501339355116, -523.54809096399, -689.4585244737802, -1415.3495683947358, -945.2147535232286, -487.7569238536139, -646.9204343061733, -351.46956351499813, -1142.1510268459856, -249.80268741749867, -212.7462772753739, -769.4191790444819, -690.1964787720227, -1306.1007188953588, -274.9253236136046, -1196.1871599029594, -879.3522808800077, -268.1646338185991, -655.614804942251, -942.9980875433662, -1026.905867988754, -136.83772155244242, -1014.4182712368216, -472.3186834273346, -956.9466047850538, -527.0322914683669, -27.371874354416054, -1361.0820434687512, -497.91642691728447, -999.2225466273243, -647.692614024712, -1210.3804535092647, -180.58768302057945, -821.9619176571927, -1063.6454169547706, -1151.599079496158, -515.5326053999207, -779.1983001663325, -1227.9674549936394, -1104.0270843651113, -397.77564718178854, -777.282966861532, -1325.9232438181884, -289.5402139648615, -118.614595456996, -173.67363609305875, -940.8744105058864, -1462.9909512555457, -293.7059607575686, -1212.424289596784, -610.8356932480336, -1060.4730512904916, -913.9240207504633, -391.9842740306993, -20.823361215665514, -780.1692327503578, -934.0130544771189, -319.50680284497867, -497.0885309562021, -1166.560346422615, -804.3980527322442, -706.4835872162616, -745.539886112722, -949.0487912825394, -528.9059456515618, -685.4649231945621, -511.71558610768, -113.74907145228751, -519.9791926923087, -372.40363438200876, -1208.5787749992144, -523.7653480171866, -893.9181444070119, -221.10242880531402, -774.9396990418645, -893.2358204274857, -312.8647404172107, -633.0459139368812, -574.1982715566206, -161.94666968507087, -444.5539525867679, -207.98079869866078, -696.2148633835967, -607.6664653769426, -106.95397646472614, -190.21313398537268, -59.426202779397, -638.0669145586486, -898.5873877490571, -1193.4221079895312, -1029.5470677802757, -795.6000973912896, -283.5685729258991, -1505.6249613835637, -627.9203706761914, -670.1508406854045, -606.5081377635322, -1209.709563500565, -992.7752402186458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568624986232004, "mean_inference_ms": 1.6935159642554436, "mean_action_processing_ms": 0.27814301554192566, "mean_env_wait_ms": 3.4860722758578366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012113809585571289, "StateBufferConnector_ms": 0.00852823257446289, "ViewRequirementAgentConnector_ms": 0.19948601722717285}, "num_episodes": 29, "episode_return_max": -20.823361215665514, "episode_return_min": -1505.6249613835637, "episode_return_mean": -683.1636214602328, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.01237264636956, "num_env_steps_trained_throughput_per_sec": 300.01237264636956, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13068.109, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13068.039, "sample_time_ms": 1158.487, "learn_time_ms": 11843.928, "learn_throughput": 337.726, "synch_weights_time_ms": 64.851}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00013", "date": "2024-08-04_06-42-45", "timestamp": 1722733965, "time_this_iter_s": 13.345770359039307, "time_total_s": 169.54871654510498, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f48820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.54871654510498, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.61578947368421, "ram_util_percent": 28.042105263157897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.17141767342885, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.174087207764387, "policy_loss": -0.011246730131824733, "vf_loss": 4.1820330237348875, "vf_explained_var": 0.8988148654500644, "kl": 0.015156562706063898, "entropy": 1.2460658005749186, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -20.823361215665514, "episode_reward_min": -1505.6249613835637, "episode_reward_mean": -661.9482004409625, "episode_len_mean": 127.66, "episode_media": {}, "episodes_timesteps_total": 12766, "policy_reward_min": {"policy_0": -1505.6249613835637}, "policy_reward_max": {"policy_0": -20.823361215665514}, "policy_reward_mean": {"policy_0": -661.9482004409625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1063.6454169547706, -1151.599079496158, -515.5326053999207, -779.1983001663325, -1227.9674549936394, -1104.0270843651113, -397.77564718178854, -777.282966861532, -1325.9232438181884, -289.5402139648615, -118.614595456996, -173.67363609305875, -940.8744105058864, -1462.9909512555457, -293.7059607575686, -1212.424289596784, -610.8356932480336, -1060.4730512904916, -913.9240207504633, -391.9842740306993, -20.823361215665514, -780.1692327503578, -934.0130544771189, -319.50680284497867, -497.0885309562021, -1166.560346422615, -804.3980527322442, -706.4835872162616, -745.539886112722, -949.0487912825394, -528.9059456515618, -685.4649231945621, -511.71558610768, -113.74907145228751, -519.9791926923087, -372.40363438200876, -1208.5787749992144, -523.7653480171866, -893.9181444070119, -221.10242880531402, -774.9396990418645, -893.2358204274857, -312.8647404172107, -633.0459139368812, -574.1982715566206, -161.94666968507087, -444.5539525867679, -207.98079869866078, -696.2148633835967, -607.6664653769426, -106.95397646472614, -190.21313398537268, -59.426202779397, -638.0669145586486, -898.5873877490571, -1193.4221079895312, -1029.5470677802757, -795.6000973912896, -283.5685729258991, -1505.6249613835637, -627.9203706761914, -670.1508406854045, -606.5081377635322, -1209.709563500565, -992.7752402186458, -988.4660306928134, -143.06220032221185, -1056.49910803611, -995.6887998522848, -773.8529100697223, -127.81882897064686, -1109.2405167889785, -361.00364641456264, -1307.467220357829, -1054.6703129322773, -499.88953562683423, -143.29542715966036, -422.63712322173046, -1224.503832550098, -935.1854006180617, -718.1989992663333, -77.64945307944585, -405.84143705993245, -319.9991186062287, -933.5279789109062, -1277.0497494493893, -449.8309532212031, -799.5721964423112, -223.89015289914457, -442.74586350124883, -212.87576172148445, -202.9494698089484, -875.7310984196248, -210.9965878895579, -439.1359487421647, -163.6360038370385, -920.1495720996749, -1176.576549474515, -187.3475450914065, -583.9053480909914], "episode_lengths": [150, 150, 129, 150, 150, 150, 126, 150, 150, 150, 55, 60, 150, 150, 135, 150, 126, 150, 150, 131, 36, 150, 150, 79, 150, 150, 150, 150, 150, 150, 108, 150, 150, 57, 150, 131, 150, 140, 149, 98, 150, 150, 83, 150, 150, 83, 150, 89, 150, 150, 68, 81, 59, 127, 150, 150, 150, 140, 120, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 56, 150, 92, 150, 150, 149, 76, 96, 150, 150, 150, 56, 100, 92, 150, 150, 150, 150, 68, 150, 98, 64, 150, 67, 140, 59, 150, 150, 85, 131], "policy_policy_0_reward": [-1063.6454169547706, -1151.599079496158, -515.5326053999207, -779.1983001663325, -1227.9674549936394, -1104.0270843651113, -397.77564718178854, -777.282966861532, -1325.9232438181884, -289.5402139648615, -118.614595456996, -173.67363609305875, -940.8744105058864, -1462.9909512555457, -293.7059607575686, -1212.424289596784, -610.8356932480336, -1060.4730512904916, -913.9240207504633, -391.9842740306993, -20.823361215665514, -780.1692327503578, -934.0130544771189, -319.50680284497867, -497.0885309562021, -1166.560346422615, -804.3980527322442, -706.4835872162616, -745.539886112722, -949.0487912825394, -528.9059456515618, -685.4649231945621, -511.71558610768, -113.74907145228751, -519.9791926923087, -372.40363438200876, -1208.5787749992144, -523.7653480171866, -893.9181444070119, -221.10242880531402, -774.9396990418645, -893.2358204274857, -312.8647404172107, -633.0459139368812, -574.1982715566206, -161.94666968507087, -444.5539525867679, -207.98079869866078, -696.2148633835967, -607.6664653769426, -106.95397646472614, -190.21313398537268, -59.426202779397, -638.0669145586486, -898.5873877490571, -1193.4221079895312, -1029.5470677802757, -795.6000973912896, -283.5685729258991, -1505.6249613835637, -627.9203706761914, -670.1508406854045, -606.5081377635322, -1209.709563500565, -992.7752402186458, -988.4660306928134, -143.06220032221185, -1056.49910803611, -995.6887998522848, -773.8529100697223, -127.81882897064686, -1109.2405167889785, -361.00364641456264, -1307.467220357829, -1054.6703129322773, -499.88953562683423, -143.29542715966036, -422.63712322173046, -1224.503832550098, -935.1854006180617, -718.1989992663333, -77.64945307944585, -405.84143705993245, -319.9991186062287, -933.5279789109062, -1277.0497494493893, -449.8309532212031, -799.5721964423112, -223.89015289914457, -442.74586350124883, -212.87576172148445, -202.9494698089484, -875.7310984196248, -210.9965878895579, -439.1359487421647, -163.6360038370385, -920.1495720996749, -1176.576549474515, -187.3475450914065, -583.9053480909914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557063675959418, "mean_inference_ms": 1.6912401534658656, "mean_action_processing_ms": 0.27789083548715793, "mean_env_wait_ms": 3.484194737801917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012232780456542969, "StateBufferConnector_ms": 0.00830388069152832, "ViewRequirementAgentConnector_ms": 0.20531511306762695}, "num_episodes": 35, "episode_return_max": -20.823361215665514, "episode_return_min": -1505.6249613835637, "episode_return_mean": -661.9482004409625, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.9065201030893, "num_env_steps_trained_throughput_per_sec": 304.9065201030893, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13071.571, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13071.501, "sample_time_ms": 1165.166, "learn_time_ms": 11839.694, "learn_throughput": 337.847, "synch_weights_time_ms": 65.843}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00013", "date": "2024-08-04_06-42-58", "timestamp": 1722733978, "time_this_iter_s": 13.131916284561157, "time_total_s": 182.68063282966614, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.68063282966614, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.368421052631582, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.04959502220154, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.962019375214974, "policy_loss": -0.004393516292717929, "vf_loss": 3.9640593295296034, "vf_explained_var": 0.9304153591394424, "kl": 0.011944685009681658, "entropy": 1.2298424357548357, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -59.426202779397, "episode_reward_min": -1505.6249613835637, "episode_reward_mean": -630.2963043221315, "episode_len_mean": 124.35, "episode_media": {}, "episodes_timesteps_total": 12435, "policy_reward_min": {"policy_0": -1505.6249613835637}, "policy_reward_max": {"policy_0": -59.426202779397}, "policy_reward_mean": {"policy_0": -630.2963043221315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-372.40363438200876, -1208.5787749992144, -523.7653480171866, -893.9181444070119, -221.10242880531402, -774.9396990418645, -893.2358204274857, -312.8647404172107, -633.0459139368812, -574.1982715566206, -161.94666968507087, -444.5539525867679, -207.98079869866078, -696.2148633835967, -607.6664653769426, -106.95397646472614, -190.21313398537268, -59.426202779397, -638.0669145586486, -898.5873877490571, -1193.4221079895312, -1029.5470677802757, -795.6000973912896, -283.5685729258991, -1505.6249613835637, -627.9203706761914, -670.1508406854045, -606.5081377635322, -1209.709563500565, -992.7752402186458, -988.4660306928134, -143.06220032221185, -1056.49910803611, -995.6887998522848, -773.8529100697223, -127.81882897064686, -1109.2405167889785, -361.00364641456264, -1307.467220357829, -1054.6703129322773, -499.88953562683423, -143.29542715966036, -422.63712322173046, -1224.503832550098, -935.1854006180617, -718.1989992663333, -77.64945307944585, -405.84143705993245, -319.9991186062287, -933.5279789109062, -1277.0497494493893, -449.8309532212031, -799.5721964423112, -223.89015289914457, -442.74586350124883, -212.87576172148445, -202.9494698089484, -875.7310984196248, -210.9965878895579, -439.1359487421647, -163.6360038370385, -920.1495720996749, -1176.576549474515, -187.3475450914065, -583.9053480909914, -878.2561365031041, -1259.355581846783, -997.5667028955577, -120.7398715463251, -210.83879347577502, -124.83250988140958, -255.9203493483667, -118.57878147510726, -134.53846803510075, -735.4119134014121, -802.3669522598897, -615.947879826391, -817.8141586833609, -1322.2444735904976, -821.6339206887152, -1231.7407807284133, -200.32370599348494, -798.134816806621, -354.41677525203727, -786.2985496717025, -1266.9339294561055, -883.9656916700073, -729.4910124434454, -76.50299018583627, -609.9960976600022, -475.5081800765713, -798.41090999532, -223.12998385416358, -202.85664884267595, -815.6238323145511, -536.5896400576522, -656.8128424794887, -353.8243029828136, -1192.7840654625375, -520.8584000226138], "episode_lengths": [131, 150, 140, 149, 98, 150, 150, 83, 150, 150, 83, 150, 89, 150, 150, 68, 81, 59, 127, 150, 150, 150, 140, 120, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 56, 150, 92, 150, 150, 149, 76, 96, 150, 150, 150, 56, 100, 92, 150, 150, 150, 150, 68, 150, 98, 64, 150, 67, 140, 59, 150, 150, 85, 131, 150, 150, 150, 60, 69, 72, 86, 65, 52, 145, 150, 150, 150, 150, 150, 150, 104, 150, 98, 150, 150, 150, 150, 61, 150, 112, 150, 70, 91, 140, 150, 147, 89, 150, 150], "policy_policy_0_reward": [-372.40363438200876, -1208.5787749992144, -523.7653480171866, -893.9181444070119, -221.10242880531402, -774.9396990418645, -893.2358204274857, -312.8647404172107, -633.0459139368812, -574.1982715566206, -161.94666968507087, -444.5539525867679, -207.98079869866078, -696.2148633835967, -607.6664653769426, -106.95397646472614, -190.21313398537268, -59.426202779397, -638.0669145586486, -898.5873877490571, -1193.4221079895312, -1029.5470677802757, -795.6000973912896, -283.5685729258991, -1505.6249613835637, -627.9203706761914, -670.1508406854045, -606.5081377635322, -1209.709563500565, -992.7752402186458, -988.4660306928134, -143.06220032221185, -1056.49910803611, -995.6887998522848, -773.8529100697223, -127.81882897064686, -1109.2405167889785, -361.00364641456264, -1307.467220357829, -1054.6703129322773, -499.88953562683423, -143.29542715966036, -422.63712322173046, -1224.503832550098, -935.1854006180617, -718.1989992663333, -77.64945307944585, -405.84143705993245, -319.9991186062287, -933.5279789109062, -1277.0497494493893, -449.8309532212031, -799.5721964423112, -223.89015289914457, -442.74586350124883, -212.87576172148445, -202.9494698089484, -875.7310984196248, -210.9965878895579, -439.1359487421647, -163.6360038370385, -920.1495720996749, -1176.576549474515, -187.3475450914065, -583.9053480909914, -878.2561365031041, -1259.355581846783, -997.5667028955577, -120.7398715463251, -210.83879347577502, -124.83250988140958, -255.9203493483667, -118.57878147510726, -134.53846803510075, -735.4119134014121, -802.3669522598897, -615.947879826391, -817.8141586833609, -1322.2444735904976, -821.6339206887152, -1231.7407807284133, -200.32370599348494, -798.134816806621, -354.41677525203727, -786.2985496717025, -1266.9339294561055, -883.9656916700073, -729.4910124434454, -76.50299018583627, -609.9960976600022, -475.5081800765713, -798.41090999532, -223.12998385416358, -202.85664884267595, -815.6238323145511, -536.5896400576522, -656.8128424794887, -353.8243029828136, -1192.7840654625375, -520.8584000226138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578374159425002, "mean_inference_ms": 1.6910532750613618, "mean_action_processing_ms": 0.2776151047891475, "mean_env_wait_ms": 3.4811057399699803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011896133422851562, "StateBufferConnector_ms": 0.008235692977905273, "ViewRequirementAgentConnector_ms": 0.2013077735900879}, "num_episodes": 35, "episode_return_max": -59.426202779397, "episode_return_min": -1505.6249613835637, "episode_return_mean": -630.2963043221315, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.49070860374223, "num_env_steps_trained_throughput_per_sec": 300.49070860374223, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13063.953, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13063.88, "sample_time_ms": 1161.476, "learn_time_ms": 11835.917, "learn_throughput": 337.954, "synch_weights_time_ms": 65.686}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00013", "date": "2024-08-04_06-43-11", "timestamp": 1722733991, "time_this_iter_s": 13.324460506439209, "time_total_s": 196.00509333610535, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923709931c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.00509333610535, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.163157894736845, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.51807662049929, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.2741928012420733, "policy_loss": -0.006658250255471406, "vf_loss": 3.2777560426543157, "vf_explained_var": 0.9601124177997311, "kl": 0.014454010213254776, "entropy": 1.2411887255186835, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -43.18920429662219, "episode_reward_min": -1322.2444735904976, "episode_reward_mean": -611.4424368970418, "episode_len_mean": 121.01, "episode_media": {}, "episodes_timesteps_total": 12101, "policy_reward_min": {"policy_0": -1322.2444735904976}, "policy_reward_max": {"policy_0": -43.18920429662219}, "policy_reward_mean": {"policy_0": -611.4424368970418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.06220032221185, -1056.49910803611, -995.6887998522848, -773.8529100697223, -127.81882897064686, -1109.2405167889785, -361.00364641456264, -1307.467220357829, -1054.6703129322773, -499.88953562683423, -143.29542715966036, -422.63712322173046, -1224.503832550098, -935.1854006180617, -718.1989992663333, -77.64945307944585, -405.84143705993245, -319.9991186062287, -933.5279789109062, -1277.0497494493893, -449.8309532212031, -799.5721964423112, -223.89015289914457, -442.74586350124883, -212.87576172148445, -202.9494698089484, -875.7310984196248, -210.9965878895579, -439.1359487421647, -163.6360038370385, -920.1495720996749, -1176.576549474515, -187.3475450914065, -583.9053480909914, -878.2561365031041, -1259.355581846783, -997.5667028955577, -120.7398715463251, -210.83879347577502, -124.83250988140958, -255.9203493483667, -118.57878147510726, -134.53846803510075, -735.4119134014121, -802.3669522598897, -615.947879826391, -817.8141586833609, -1322.2444735904976, -821.6339206887152, -1231.7407807284133, -200.32370599348494, -798.134816806621, -354.41677525203727, -786.2985496717025, -1266.9339294561055, -883.9656916700073, -729.4910124434454, -76.50299018583627, -609.9960976600022, -475.5081800765713, -798.41090999532, -223.12998385416358, -202.85664884267595, -815.6238323145511, -536.5896400576522, -656.8128424794887, -353.8243029828136, -1192.7840654625375, -520.8584000226138, -601.3927508762737, -108.38454553223613, -236.37816100863986, -887.3923866287962, -891.309182412772, -1315.1246587264584, -906.2455356180776, -43.18920429662219, -928.239319124272, -97.38495160162252, -1117.7667888948665, -1010.6475733698954, -97.60477087165121, -276.88098904015817, -666.1425734101736, -732.728735236061, -1025.8060950078445, -551.5010173258198, -917.0734402115218, -819.8304814604155, -586.0577571107775, -309.83263171403865, -411.4063632433699, -843.5555963716849, -666.7588736109411, -824.2552170576103, -142.48340431446988, -124.99251174832462, -61.03961088303587, -1024.69363839863, -211.4706246507252], "episode_lengths": [77, 150, 150, 150, 56, 150, 92, 150, 150, 149, 76, 96, 150, 150, 150, 56, 100, 92, 150, 150, 150, 150, 68, 150, 98, 64, 150, 67, 140, 59, 150, 150, 85, 131, 150, 150, 150, 60, 69, 72, 86, 65, 52, 145, 150, 150, 150, 150, 150, 150, 104, 150, 98, 150, 150, 150, 150, 61, 150, 112, 150, 70, 91, 140, 150, 147, 89, 150, 150, 150, 71, 97, 150, 150, 150, 150, 39, 150, 56, 150, 150, 71, 74, 150, 150, 150, 150, 150, 150, 150, 92, 98, 150, 150, 150, 80, 74, 56, 150, 76], "policy_policy_0_reward": [-143.06220032221185, -1056.49910803611, -995.6887998522848, -773.8529100697223, -127.81882897064686, -1109.2405167889785, -361.00364641456264, -1307.467220357829, -1054.6703129322773, -499.88953562683423, -143.29542715966036, -422.63712322173046, -1224.503832550098, -935.1854006180617, -718.1989992663333, -77.64945307944585, -405.84143705993245, -319.9991186062287, -933.5279789109062, -1277.0497494493893, -449.8309532212031, -799.5721964423112, -223.89015289914457, -442.74586350124883, -212.87576172148445, -202.9494698089484, -875.7310984196248, -210.9965878895579, -439.1359487421647, -163.6360038370385, -920.1495720996749, -1176.576549474515, -187.3475450914065, -583.9053480909914, -878.2561365031041, -1259.355581846783, -997.5667028955577, -120.7398715463251, -210.83879347577502, -124.83250988140958, -255.9203493483667, -118.57878147510726, -134.53846803510075, -735.4119134014121, -802.3669522598897, -615.947879826391, -817.8141586833609, -1322.2444735904976, -821.6339206887152, -1231.7407807284133, -200.32370599348494, -798.134816806621, -354.41677525203727, -786.2985496717025, -1266.9339294561055, -883.9656916700073, -729.4910124434454, -76.50299018583627, -609.9960976600022, -475.5081800765713, -798.41090999532, -223.12998385416358, -202.85664884267595, -815.6238323145511, -536.5896400576522, -656.8128424794887, -353.8243029828136, -1192.7840654625375, -520.8584000226138, -601.3927508762737, -108.38454553223613, -236.37816100863986, -887.3923866287962, -891.309182412772, -1315.1246587264584, -906.2455356180776, -43.18920429662219, -928.239319124272, -97.38495160162252, -1117.7667888948665, -1010.6475733698954, -97.60477087165121, -276.88098904015817, -666.1425734101736, -732.728735236061, -1025.8060950078445, -551.5010173258198, -917.0734402115218, -819.8304814604155, -586.0577571107775, -309.83263171403865, -411.4063632433699, -843.5555963716849, -666.7588736109411, -824.2552170576103, -142.48340431446988, -124.99251174832462, -61.03961088303587, -1024.69363839863, -211.4706246507252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588483037538551, "mean_inference_ms": 1.6918719896512033, "mean_action_processing_ms": 0.2775547814661255, "mean_env_wait_ms": 3.478402650803101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011884689331054688, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.2008976936340332}, "num_episodes": 31, "episode_return_max": -43.18920429662219, "episode_return_min": -1322.2444735904976, "episode_return_mean": -611.4424368970418, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.3027346907899, "num_env_steps_trained_throughput_per_sec": 305.3027346907899, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13039.241, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13039.169, "sample_time_ms": 1164.962, "learn_time_ms": 11807.347, "learn_throughput": 338.772, "synch_weights_time_ms": 66.065}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00013", "date": "2024-08-04_06-43-24", "timestamp": 1722734004, "time_this_iter_s": 13.112655639648438, "time_total_s": 209.11774897575378, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370808550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.11774897575378, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.42105263157895, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.07738640904427, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.406954306115707, "policy_loss": -0.010743096038155878, "vf_loss": 3.4140289931247634, "vf_explained_var": 0.9527783539767066, "kl": 0.016832148199803987, "entropy": 1.3812355938057104, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -17.722978152910517, "episode_reward_min": -1347.620008220895, "episode_reward_mean": -605.7142043501341, "episode_len_mean": 121.84, "episode_media": {}, "episodes_timesteps_total": 12184, "policy_reward_min": {"policy_0": -1347.620008220895}, "policy_reward_max": {"policy_0": -17.722978152910517}, "policy_reward_mean": {"policy_0": -605.7142043501341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1176.576549474515, -187.3475450914065, -583.9053480909914, -878.2561365031041, -1259.355581846783, -997.5667028955577, -120.7398715463251, -210.83879347577502, -124.83250988140958, -255.9203493483667, -118.57878147510726, -134.53846803510075, -735.4119134014121, -802.3669522598897, -615.947879826391, -817.8141586833609, -1322.2444735904976, -821.6339206887152, -1231.7407807284133, -200.32370599348494, -798.134816806621, -354.41677525203727, -786.2985496717025, -1266.9339294561055, -883.9656916700073, -729.4910124434454, -76.50299018583627, -609.9960976600022, -475.5081800765713, -798.41090999532, -223.12998385416358, -202.85664884267595, -815.6238323145511, -536.5896400576522, -656.8128424794887, -353.8243029828136, -1192.7840654625375, -520.8584000226138, -601.3927508762737, -108.38454553223613, -236.37816100863986, -887.3923866287962, -891.309182412772, -1315.1246587264584, -906.2455356180776, -43.18920429662219, -928.239319124272, -97.38495160162252, -1117.7667888948665, -1010.6475733698954, -97.60477087165121, -276.88098904015817, -666.1425734101736, -732.728735236061, -1025.8060950078445, -551.5010173258198, -917.0734402115218, -819.8304814604155, -586.0577571107775, -309.83263171403865, -411.4063632433699, -843.5555963716849, -666.7588736109411, -824.2552170576103, -142.48340431446988, -124.99251174832462, -61.03961088303587, -1024.69363839863, -211.4706246507252, -1001.0510379143574, -17.722978152910517, -802.355095418179, -54.320240121061474, -94.84718250448846, -1022.0968539833855, -1015.3298608534733, -110.16137569445743, -387.5700377332479, -902.0959480824044, -541.3481298453947, -56.22819017121291, -857.079653627592, -164.56401404073003, -1057.8866666005547, -637.0024720304357, -702.9612071004162, -421.3257548047531, -549.3949818237796, -803.1285798684343, -146.88259939944962, -404.0043389114507, -1201.9490059180862, -660.3175202096111, -631.191440491753, -531.5151695221156, -111.74322763857539, -855.9962712454764, -1347.620008220895, -819.9521157477926, -346.1299955083996], "episode_lengths": [150, 85, 131, 150, 150, 150, 60, 69, 72, 86, 65, 52, 145, 150, 150, 150, 150, 150, 150, 104, 150, 98, 150, 150, 150, 150, 61, 150, 112, 150, 70, 91, 140, 150, 147, 89, 150, 150, 150, 71, 97, 150, 150, 150, 150, 39, 150, 56, 150, 150, 71, 74, 150, 150, 150, 150, 150, 150, 150, 92, 98, 150, 150, 150, 80, 74, 56, 150, 76, 150, 41, 150, 57, 76, 150, 150, 67, 150, 150, 150, 56, 150, 81, 150, 150, 150, 93, 138, 145, 55, 130, 150, 150, 138, 111, 58, 150, 150, 150, 127], "policy_policy_0_reward": [-1176.576549474515, -187.3475450914065, -583.9053480909914, -878.2561365031041, -1259.355581846783, -997.5667028955577, -120.7398715463251, -210.83879347577502, -124.83250988140958, -255.9203493483667, -118.57878147510726, -134.53846803510075, -735.4119134014121, -802.3669522598897, -615.947879826391, -817.8141586833609, -1322.2444735904976, -821.6339206887152, -1231.7407807284133, -200.32370599348494, -798.134816806621, -354.41677525203727, -786.2985496717025, -1266.9339294561055, -883.9656916700073, -729.4910124434454, -76.50299018583627, -609.9960976600022, -475.5081800765713, -798.41090999532, -223.12998385416358, -202.85664884267595, -815.6238323145511, -536.5896400576522, -656.8128424794887, -353.8243029828136, -1192.7840654625375, -520.8584000226138, -601.3927508762737, -108.38454553223613, -236.37816100863986, -887.3923866287962, -891.309182412772, -1315.1246587264584, -906.2455356180776, -43.18920429662219, -928.239319124272, -97.38495160162252, -1117.7667888948665, -1010.6475733698954, -97.60477087165121, -276.88098904015817, -666.1425734101736, -732.728735236061, -1025.8060950078445, -551.5010173258198, -917.0734402115218, -819.8304814604155, -586.0577571107775, -309.83263171403865, -411.4063632433699, -843.5555963716849, -666.7588736109411, -824.2552170576103, -142.48340431446988, -124.99251174832462, -61.03961088303587, -1024.69363839863, -211.4706246507252, -1001.0510379143574, -17.722978152910517, -802.355095418179, -54.320240121061474, -94.84718250448846, -1022.0968539833855, -1015.3298608534733, -110.16137569445743, -387.5700377332479, -902.0959480824044, -541.3481298453947, -56.22819017121291, -857.079653627592, -164.56401404073003, -1057.8866666005547, -637.0024720304357, -702.9612071004162, -421.3257548047531, -549.3949818237796, -803.1285798684343, -146.88259939944962, -404.0043389114507, -1201.9490059180862, -660.3175202096111, -631.191440491753, -531.5151695221156, -111.74322763857539, -855.9962712454764, -1347.620008220895, -819.9521157477926, -346.1299955083996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5582858042947246, "mean_inference_ms": 1.6899486592848092, "mean_action_processing_ms": 0.27724581376636487, "mean_env_wait_ms": 3.475787066448374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011600017547607422, "StateBufferConnector_ms": 0.007940292358398438, "ViewRequirementAgentConnector_ms": 0.19246172904968262}, "num_episodes": 31, "episode_return_max": -17.722978152910517, "episode_return_min": -1347.620008220895, "episode_return_mean": -605.7142043501341, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.1744348254125, "num_env_steps_trained_throughput_per_sec": 297.1744348254125, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13241.962, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13241.887, "sample_time_ms": 1165.088, "learn_time_ms": 12009.707, "learn_throughput": 333.064, "synch_weights_time_ms": 66.293}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00013", "date": "2024-08-04_06-43-38", "timestamp": 1722734018, "time_this_iter_s": 13.47177004814148, "time_total_s": 222.58951902389526, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080a4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.58951902389526, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.09473684210526, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.7515532553196, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.412347153077523, "policy_loss": -0.007053385200075961, "vf_loss": 3.416443835571408, "vf_explained_var": 0.9532858291019995, "kl": 0.015257676826210324, "entropy": 1.6205972322573265, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -17.722978152910517, "episode_reward_min": -1494.3542000470177, "episode_reward_mean": -666.0482919781917, "episode_len_mean": 126.18, "episode_media": {}, "episodes_timesteps_total": 12618, "policy_reward_min": {"policy_0": -1494.3542000470177}, "policy_reward_max": {"policy_0": -17.722978152910517}, "policy_reward_mean": {"policy_0": -666.0482919781917}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-475.5081800765713, -798.41090999532, -223.12998385416358, -202.85664884267595, -815.6238323145511, -536.5896400576522, -656.8128424794887, -353.8243029828136, -1192.7840654625375, -520.8584000226138, -601.3927508762737, -108.38454553223613, -236.37816100863986, -887.3923866287962, -891.309182412772, -1315.1246587264584, -906.2455356180776, -43.18920429662219, -928.239319124272, -97.38495160162252, -1117.7667888948665, -1010.6475733698954, -97.60477087165121, -276.88098904015817, -666.1425734101736, -732.728735236061, -1025.8060950078445, -551.5010173258198, -917.0734402115218, -819.8304814604155, -586.0577571107775, -309.83263171403865, -411.4063632433699, -843.5555963716849, -666.7588736109411, -824.2552170576103, -142.48340431446988, -124.99251174832462, -61.03961088303587, -1024.69363839863, -211.4706246507252, -1001.0510379143574, -17.722978152910517, -802.355095418179, -54.320240121061474, -94.84718250448846, -1022.0968539833855, -1015.3298608534733, -110.16137569445743, -387.5700377332479, -902.0959480824044, -541.3481298453947, -56.22819017121291, -857.079653627592, -164.56401404073003, -1057.8866666005547, -637.0024720304357, -702.9612071004162, -421.3257548047531, -549.3949818237796, -803.1285798684343, -146.88259939944962, -404.0043389114507, -1201.9490059180862, -660.3175202096111, -631.191440491753, -531.5151695221156, -111.74322763857539, -855.9962712454764, -1347.620008220895, -819.9521157477926, -346.1299955083996, -1157.0547877116082, -948.4170960560493, -726.8027940100895, -1129.6716289983276, -168.20442330138386, -318.66926804184146, -763.0859454101943, -1148.6311201537933, -875.230940623272, -439.81742499181985, -920.018699897954, -1026.9322685264594, -1248.1297881615596, -724.9559757268405, -42.87635329131944, -1045.403889818321, -1142.3790632858054, -873.3311293472754, -167.2742308401512, -1026.257972042138, -736.0904838747498, -1036.545299225181, -583.274453334496, -1437.7320706721282, -1494.3542000470177, -1326.3138799591006, -830.4429639203715, -797.190897518868], "episode_lengths": [112, 150, 70, 91, 140, 150, 147, 89, 150, 150, 150, 71, 97, 150, 150, 150, 150, 39, 150, 56, 150, 150, 71, 74, 150, 150, 150, 150, 150, 150, 150, 92, 98, 150, 150, 150, 80, 74, 56, 150, 76, 150, 41, 150, 57, 76, 150, 150, 67, 150, 150, 150, 56, 150, 81, 150, 150, 150, 93, 138, 145, 55, 130, 150, 150, 138, 111, 58, 150, 150, 150, 127, 150, 145, 150, 150, 89, 103, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 64, 150, 150, 150, 111, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-475.5081800765713, -798.41090999532, -223.12998385416358, -202.85664884267595, -815.6238323145511, -536.5896400576522, -656.8128424794887, -353.8243029828136, -1192.7840654625375, -520.8584000226138, -601.3927508762737, -108.38454553223613, -236.37816100863986, -887.3923866287962, -891.309182412772, -1315.1246587264584, -906.2455356180776, -43.18920429662219, -928.239319124272, -97.38495160162252, -1117.7667888948665, -1010.6475733698954, -97.60477087165121, -276.88098904015817, -666.1425734101736, -732.728735236061, -1025.8060950078445, -551.5010173258198, -917.0734402115218, -819.8304814604155, -586.0577571107775, -309.83263171403865, -411.4063632433699, -843.5555963716849, -666.7588736109411, -824.2552170576103, -142.48340431446988, -124.99251174832462, -61.03961088303587, -1024.69363839863, -211.4706246507252, -1001.0510379143574, -17.722978152910517, -802.355095418179, -54.320240121061474, -94.84718250448846, -1022.0968539833855, -1015.3298608534733, -110.16137569445743, -387.5700377332479, -902.0959480824044, -541.3481298453947, -56.22819017121291, -857.079653627592, -164.56401404073003, -1057.8866666005547, -637.0024720304357, -702.9612071004162, -421.3257548047531, -549.3949818237796, -803.1285798684343, -146.88259939944962, -404.0043389114507, -1201.9490059180862, -660.3175202096111, -631.191440491753, -531.5151695221156, -111.74322763857539, -855.9962712454764, -1347.620008220895, -819.9521157477926, -346.1299955083996, -1157.0547877116082, -948.4170960560493, -726.8027940100895, -1129.6716289983276, -168.20442330138386, -318.66926804184146, -763.0859454101943, -1148.6311201537933, -875.230940623272, -439.81742499181985, -920.018699897954, -1026.9322685264594, -1248.1297881615596, -724.9559757268405, -42.87635329131944, -1045.403889818321, -1142.3790632858054, -873.3311293472754, -167.2742308401512, -1026.257972042138, -736.0904838747498, -1036.545299225181, -583.274453334496, -1437.7320706721282, -1494.3542000470177, -1326.3138799591006, -830.4429639203715, -797.190897518868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581887052027731, "mean_inference_ms": 1.6918011234306718, "mean_action_processing_ms": 0.2772653773651756, "mean_env_wait_ms": 3.478036336184402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011710166931152344, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.1951582431793213}, "num_episodes": 28, "episode_return_max": -17.722978152910517, "episode_return_min": -1494.3542000470177, "episode_return_mean": -666.0482919781917, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.38529282778165, "num_env_steps_trained_throughput_per_sec": 301.38529282778165, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13237.167, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13237.089, "sample_time_ms": 1161.646, "learn_time_ms": 12009.667, "learn_throughput": 333.065, "synch_weights_time_ms": 64.976}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00013", "date": "2024-08-04_06-43-51", "timestamp": 1722734031, "time_this_iter_s": 13.283918142318726, "time_total_s": 235.873437166214, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923709931c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.873437166214, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.557894736842105, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.49684484004973, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.3910508902122576, "policy_loss": -0.004841139097212969, "vf_loss": 3.392812793701887, "vf_explained_var": 0.9509311998263001, "kl": 0.015002054167356038, "entropy": 1.4213830430060626, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -17.722978152910517, "episode_reward_min": -1494.3542000470177, "episode_reward_mean": -702.5410435842208, "episode_len_mean": 127.6, "episode_media": {}, "episodes_timesteps_total": 12760, "policy_reward_min": {"policy_0": -1494.3542000470177}, "policy_reward_max": {"policy_0": -17.722978152910517}, "policy_reward_mean": {"policy_0": -702.5410435842208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.5555963716849, -666.7588736109411, -824.2552170576103, -142.48340431446988, -124.99251174832462, -61.03961088303587, -1024.69363839863, -211.4706246507252, -1001.0510379143574, -17.722978152910517, -802.355095418179, -54.320240121061474, -94.84718250448846, -1022.0968539833855, -1015.3298608534733, -110.16137569445743, -387.5700377332479, -902.0959480824044, -541.3481298453947, -56.22819017121291, -857.079653627592, -164.56401404073003, -1057.8866666005547, -637.0024720304357, -702.9612071004162, -421.3257548047531, -549.3949818237796, -803.1285798684343, -146.88259939944962, -404.0043389114507, -1201.9490059180862, -660.3175202096111, -631.191440491753, -531.5151695221156, -111.74322763857539, -855.9962712454764, -1347.620008220895, -819.9521157477926, -346.1299955083996, -1157.0547877116082, -948.4170960560493, -726.8027940100895, -1129.6716289983276, -168.20442330138386, -318.66926804184146, -763.0859454101943, -1148.6311201537933, -875.230940623272, -439.81742499181985, -920.018699897954, -1026.9322685264594, -1248.1297881615596, -724.9559757268405, -42.87635329131944, -1045.403889818321, -1142.3790632858054, -873.3311293472754, -167.2742308401512, -1026.257972042138, -736.0904838747498, -1036.545299225181, -583.274453334496, -1437.7320706721282, -1494.3542000470177, -1326.3138799591006, -830.4429639203715, -797.190897518868, -1143.4062026304791, -678.0805141128183, -328.06626247988453, -917.0663802238896, -80.26013948177524, -1208.3320617601942, -650.1287955788051, -851.3127658070492, -898.6547334574626, -178.3842403833173, -1037.8046785580068, -169.4977035003796, -780.4417006977673, -897.9862430481625, -262.7379971955945, -292.74692594566005, -1228.741749250962, -910.5698170362721, -1202.178199923368, -686.9375124981067, -983.5000548339418, -933.7694455474817, -1024.9180515215241, -1228.3817469018225, -657.2533897838451, -687.7690906524757, -1320.7835784785652, -648.8299979330809, -943.32671144716, -177.2804711043131, -601.2284863676044, -129.62030226864644, -223.99792900325374], "episode_lengths": [150, 150, 150, 80, 74, 56, 150, 76, 150, 41, 150, 57, 76, 150, 150, 67, 150, 150, 150, 56, 150, 81, 150, 150, 150, 93, 138, 145, 55, 130, 150, 150, 138, 111, 58, 150, 150, 150, 127, 150, 145, 150, 150, 89, 103, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 64, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 83, 150, 54, 150, 127, 150, 150, 63, 150, 77, 150, 150, 92, 96, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 73, 65], "policy_policy_0_reward": [-843.5555963716849, -666.7588736109411, -824.2552170576103, -142.48340431446988, -124.99251174832462, -61.03961088303587, -1024.69363839863, -211.4706246507252, -1001.0510379143574, -17.722978152910517, -802.355095418179, -54.320240121061474, -94.84718250448846, -1022.0968539833855, -1015.3298608534733, -110.16137569445743, -387.5700377332479, -902.0959480824044, -541.3481298453947, -56.22819017121291, -857.079653627592, -164.56401404073003, -1057.8866666005547, -637.0024720304357, -702.9612071004162, -421.3257548047531, -549.3949818237796, -803.1285798684343, -146.88259939944962, -404.0043389114507, -1201.9490059180862, -660.3175202096111, -631.191440491753, -531.5151695221156, -111.74322763857539, -855.9962712454764, -1347.620008220895, -819.9521157477926, -346.1299955083996, -1157.0547877116082, -948.4170960560493, -726.8027940100895, -1129.6716289983276, -168.20442330138386, -318.66926804184146, -763.0859454101943, -1148.6311201537933, -875.230940623272, -439.81742499181985, -920.018699897954, -1026.9322685264594, -1248.1297881615596, -724.9559757268405, -42.87635329131944, -1045.403889818321, -1142.3790632858054, -873.3311293472754, -167.2742308401512, -1026.257972042138, -736.0904838747498, -1036.545299225181, -583.274453334496, -1437.7320706721282, -1494.3542000470177, -1326.3138799591006, -830.4429639203715, -797.190897518868, -1143.4062026304791, -678.0805141128183, -328.06626247988453, -917.0663802238896, -80.26013948177524, -1208.3320617601942, -650.1287955788051, -851.3127658070492, -898.6547334574626, -178.3842403833173, -1037.8046785580068, -169.4977035003796, -780.4417006977673, -897.9862430481625, -262.7379971955945, -292.74692594566005, -1228.741749250962, -910.5698170362721, -1202.178199923368, -686.9375124981067, -983.5000548339418, -933.7694455474817, -1024.9180515215241, -1228.3817469018225, -657.2533897838451, -687.7690906524757, -1320.7835784785652, -648.8299979330809, -943.32671144716, -177.2804711043131, -601.2284863676044, -129.62030226864644, -223.99792900325374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5580652176732894, "mean_inference_ms": 1.690328249020918, "mean_action_processing_ms": 0.2767526309553569, "mean_env_wait_ms": 3.478636245768551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012007713317871094, "StateBufferConnector_ms": 0.00790095329284668, "ViewRequirementAgentConnector_ms": 0.19238710403442383}, "num_episodes": 33, "episode_return_max": -17.722978152910517, "episode_return_min": -1494.3542000470177, "episode_return_mean": -702.5410435842208, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.4979579007636, "num_env_steps_trained_throughput_per_sec": 304.4979579007636, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13199.195, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13199.118, "sample_time_ms": 1157.094, "learn_time_ms": 11975.745, "learn_throughput": 334.008, "synch_weights_time_ms": 65.48}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00013", "date": "2024-08-04_06-44-04", "timestamp": 1722734044, "time_this_iter_s": 13.149880647659302, "time_total_s": 249.0233178138733, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370993400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.0233178138733, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.54444444444444, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.57705759803454, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.3181185790648065, "policy_loss": -0.009033478849354045, "vf_loss": 3.3237787117560704, "vf_explained_var": 0.9538871560866634, "kl": 0.015992119101732292, "entropy": 1.4242736296107372, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -42.87635329131944, "episode_reward_min": -1494.3542000470177, "episode_reward_mean": -748.5121477911841, "episode_len_mean": 132.1, "episode_media": {}, "episodes_timesteps_total": 13210, "policy_reward_min": {"policy_0": -1494.3542000470177}, "policy_reward_max": {"policy_0": -42.87635329131944}, "policy_reward_mean": {"policy_0": -748.5121477911841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-531.5151695221156, -111.74322763857539, -855.9962712454764, -1347.620008220895, -819.9521157477926, -346.1299955083996, -1157.0547877116082, -948.4170960560493, -726.8027940100895, -1129.6716289983276, -168.20442330138386, -318.66926804184146, -763.0859454101943, -1148.6311201537933, -875.230940623272, -439.81742499181985, -920.018699897954, -1026.9322685264594, -1248.1297881615596, -724.9559757268405, -42.87635329131944, -1045.403889818321, -1142.3790632858054, -873.3311293472754, -167.2742308401512, -1026.257972042138, -736.0904838747498, -1036.545299225181, -583.274453334496, -1437.7320706721282, -1494.3542000470177, -1326.3138799591006, -830.4429639203715, -797.190897518868, -1143.4062026304791, -678.0805141128183, -328.06626247988453, -917.0663802238896, -80.26013948177524, -1208.3320617601942, -650.1287955788051, -851.3127658070492, -898.6547334574626, -178.3842403833173, -1037.8046785580068, -169.4977035003796, -780.4417006977673, -897.9862430481625, -262.7379971955945, -292.74692594566005, -1228.741749250962, -910.5698170362721, -1202.178199923368, -686.9375124981067, -983.5000548339418, -933.7694455474817, -1024.9180515215241, -1228.3817469018225, -657.2533897838451, -687.7690906524757, -1320.7835784785652, -648.8299979330809, -943.32671144716, -177.2804711043131, -601.2284863676044, -129.62030226864644, -223.99792900325374, -567.2081993374666, -238.97898344886679, -838.677310967608, -1352.732500823055, -130.81239694195335, -86.59434832000899, -1132.8330005999373, -1019.8739040224284, -724.158127028267, -677.2515252895083, -1063.019896526595, -715.4085608039601, -622.8818843671509, -992.533525097726, -701.5346620192018, -445.6485032338299, -362.17675575683785, -813.667450576797, -491.32946905647543, -1008.7728695411805, -277.8000531636881, -1198.0769025834766, -715.6852583980731, -597.0172304816278, -755.5917146598092, -128.20347372638057, -1035.9425135571314, -1222.2558875247062, -1231.2391813381896, -148.57189850586693, -786.9895490661055, -337.9771799188291, -317.7303463506447], "episode_lengths": [111, 58, 150, 150, 150, 127, 150, 145, 150, 150, 89, 103, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 64, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 83, 150, 54, 150, 127, 150, 150, 63, 150, 77, 150, 150, 92, 96, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 73, 65, 150, 78, 150, 150, 74, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 110, 150, 140, 150, 136, 147, 150, 83, 150, 150, 150, 72, 150, 132, 83], "policy_policy_0_reward": [-531.5151695221156, -111.74322763857539, -855.9962712454764, -1347.620008220895, -819.9521157477926, -346.1299955083996, -1157.0547877116082, -948.4170960560493, -726.8027940100895, -1129.6716289983276, -168.20442330138386, -318.66926804184146, -763.0859454101943, -1148.6311201537933, -875.230940623272, -439.81742499181985, -920.018699897954, -1026.9322685264594, -1248.1297881615596, -724.9559757268405, -42.87635329131944, -1045.403889818321, -1142.3790632858054, -873.3311293472754, -167.2742308401512, -1026.257972042138, -736.0904838747498, -1036.545299225181, -583.274453334496, -1437.7320706721282, -1494.3542000470177, -1326.3138799591006, -830.4429639203715, -797.190897518868, -1143.4062026304791, -678.0805141128183, -328.06626247988453, -917.0663802238896, -80.26013948177524, -1208.3320617601942, -650.1287955788051, -851.3127658070492, -898.6547334574626, -178.3842403833173, -1037.8046785580068, -169.4977035003796, -780.4417006977673, -897.9862430481625, -262.7379971955945, -292.74692594566005, -1228.741749250962, -910.5698170362721, -1202.178199923368, -686.9375124981067, -983.5000548339418, -933.7694455474817, -1024.9180515215241, -1228.3817469018225, -657.2533897838451, -687.7690906524757, -1320.7835784785652, -648.8299979330809, -943.32671144716, -177.2804711043131, -601.2284863676044, -129.62030226864644, -223.99792900325374, -567.2081993374666, -238.97898344886679, -838.677310967608, -1352.732500823055, -130.81239694195335, -86.59434832000899, -1132.8330005999373, -1019.8739040224284, -724.158127028267, -677.2515252895083, -1063.019896526595, -715.4085608039601, -622.8818843671509, -992.533525097726, -701.5346620192018, -445.6485032338299, -362.17675575683785, -813.667450576797, -491.32946905647543, -1008.7728695411805, -277.8000531636881, -1198.0769025834766, -715.6852583980731, -597.0172304816278, -755.5917146598092, -128.20347372638057, -1035.9425135571314, -1222.2558875247062, -1231.2391813381896, -148.57189850586693, -786.9895490661055, -337.9771799188291, -317.7303463506447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577137445426915, "mean_inference_ms": 1.6888270387201656, "mean_action_processing_ms": 0.27666989344373877, "mean_env_wait_ms": 3.47862133786272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012229442596435547, "StateBufferConnector_ms": 0.007897138595581055, "ViewRequirementAgentConnector_ms": 0.1934349536895752}, "num_episodes": 33, "episode_return_max": -42.87635329131944, "episode_return_min": -1494.3542000470177, "episode_return_mean": -748.5121477911841, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.6758693650773, "num_env_steps_trained_throughput_per_sec": 403.6758693650773, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12847.322, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12847.245, "sample_time_ms": 1154.768, "learn_time_ms": 11624.516, "learn_throughput": 344.1, "synch_weights_time_ms": 67.148}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00013", "date": "2024-08-04_06-44-14", "timestamp": 1722734054, "time_this_iter_s": 9.921226739883423, "time_total_s": 258.9445445537567, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.9445445537567, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.279999999999994, "ram_util_percent": 28.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.49640923142434, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.2349285018940765, "policy_loss": -0.007256091011610503, "vf_loss": 3.2371589858084917, "vf_explained_var": 0.9750247964635491, "kl": 0.02114504163885916, "entropy": 1.3179056776687503, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -6.861137216075122, "episode_reward_min": -1352.732500823055, "episode_reward_mean": -654.5944554288454, "episode_len_mean": 124.07, "episode_media": {}, "episodes_timesteps_total": 12407, "policy_reward_min": {"policy_0": -1352.732500823055}, "policy_reward_max": {"policy_0": -6.861137216075122}, "policy_reward_mean": {"policy_0": -654.5944554288454}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-328.06626247988453, -917.0663802238896, -80.26013948177524, -1208.3320617601942, -650.1287955788051, -851.3127658070492, -898.6547334574626, -178.3842403833173, -1037.8046785580068, -169.4977035003796, -780.4417006977673, -897.9862430481625, -262.7379971955945, -292.74692594566005, -1228.741749250962, -910.5698170362721, -1202.178199923368, -686.9375124981067, -983.5000548339418, -933.7694455474817, -1024.9180515215241, -1228.3817469018225, -657.2533897838451, -687.7690906524757, -1320.7835784785652, -648.8299979330809, -943.32671144716, -177.2804711043131, -601.2284863676044, -129.62030226864644, -223.99792900325374, -567.2081993374666, -238.97898344886679, -838.677310967608, -1352.732500823055, -130.81239694195335, -86.59434832000899, -1132.8330005999373, -1019.8739040224284, -724.158127028267, -677.2515252895083, -1063.019896526595, -715.4085608039601, -622.8818843671509, -992.533525097726, -701.5346620192018, -445.6485032338299, -362.17675575683785, -813.667450576797, -491.32946905647543, -1008.7728695411805, -277.8000531636881, -1198.0769025834766, -715.6852583980731, -597.0172304816278, -755.5917146598092, -128.20347372638057, -1035.9425135571314, -1222.2558875247062, -1231.2391813381896, -148.57189850586693, -786.9895490661055, -337.9771799188291, -317.7303463506447, -373.1465341340235, -834.8361950629208, -62.40782857329835, -41.05845112140939, -649.3674582257407, -702.078003895989, -863.4200619632252, -276.77480007093163, -208.04700052855412, -1284.2639149446263, -870.4855089428376, -173.57575257052534, -88.13383111404941, -115.73744105135, -914.5794220363312, -408.1765489134511, -518.3784611031667, -124.15775169434693, -964.9406317792811, -933.4740319107369, -6.861137216075122, -68.10396266972828, -31.841760346942436, -78.28230393697748, -1115.0588847640588, -448.80078897505894, -464.68114921497636, -937.20357731481, -764.918411794504, -968.8512238342668, -1212.6468429848605, -1072.7925303903378, -1133.909359403611, -277.7154840390064, -1054.1576935438297, -534.8985771149422], "episode_lengths": [83, 150, 54, 150, 127, 150, 150, 63, 150, 77, 150, 150, 92, 96, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 73, 65, 150, 78, 150, 150, 74, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 110, 150, 140, 150, 136, 147, 150, 83, 150, 150, 150, 72, 150, 132, 83, 105, 150, 56, 50, 133, 150, 150, 103, 93, 150, 150, 64, 65, 54, 150, 97, 118, 63, 150, 150, 35, 56, 44, 66, 150, 122, 150, 150, 150, 150, 150, 150, 150, 89, 150, 142], "policy_policy_0_reward": [-328.06626247988453, -917.0663802238896, -80.26013948177524, -1208.3320617601942, -650.1287955788051, -851.3127658070492, -898.6547334574626, -178.3842403833173, -1037.8046785580068, -169.4977035003796, -780.4417006977673, -897.9862430481625, -262.7379971955945, -292.74692594566005, -1228.741749250962, -910.5698170362721, -1202.178199923368, -686.9375124981067, -983.5000548339418, -933.7694455474817, -1024.9180515215241, -1228.3817469018225, -657.2533897838451, -687.7690906524757, -1320.7835784785652, -648.8299979330809, -943.32671144716, -177.2804711043131, -601.2284863676044, -129.62030226864644, -223.99792900325374, -567.2081993374666, -238.97898344886679, -838.677310967608, -1352.732500823055, -130.81239694195335, -86.59434832000899, -1132.8330005999373, -1019.8739040224284, -724.158127028267, -677.2515252895083, -1063.019896526595, -715.4085608039601, -622.8818843671509, -992.533525097726, -701.5346620192018, -445.6485032338299, -362.17675575683785, -813.667450576797, -491.32946905647543, -1008.7728695411805, -277.8000531636881, -1198.0769025834766, -715.6852583980731, -597.0172304816278, -755.5917146598092, -128.20347372638057, -1035.9425135571314, -1222.2558875247062, -1231.2391813381896, -148.57189850586693, -786.9895490661055, -337.9771799188291, -317.7303463506447, -373.1465341340235, -834.8361950629208, -62.40782857329835, -41.05845112140939, -649.3674582257407, -702.078003895989, -863.4200619632252, -276.77480007093163, -208.04700052855412, -1284.2639149446263, -870.4855089428376, -173.57575257052534, -88.13383111404941, -115.73744105135, -914.5794220363312, -408.1765489134511, -518.3784611031667, -124.15775169434693, -964.9406317792811, -933.4740319107369, -6.861137216075122, -68.10396266972828, -31.841760346942436, -78.28230393697748, -1115.0588847640588, -448.80078897505894, -464.68114921497636, -937.20357731481, -764.918411794504, -968.8512238342668, -1212.6468429848605, -1072.7925303903378, -1133.909359403611, -277.7154840390064, -1054.1576935438297, -534.8985771149422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574284616680667, "mean_inference_ms": 1.6857759634875347, "mean_action_processing_ms": 0.27637040038802546, "mean_env_wait_ms": 3.4784662172019254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0121917724609375, "StateBufferConnector_ms": 0.007856130599975586, "ViewRequirementAgentConnector_ms": 0.19119620323181152}, "num_episodes": 36, "episode_return_max": -6.861137216075122, "episode_return_min": -1352.732500823055, "episode_return_mean": -654.5944554288454, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.42416560556956, "num_env_steps_trained_throughput_per_sec": 482.42416560556956, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12381.16, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12381.086, "sample_time_ms": 1151.19, "learn_time_ms": 11162.0, "learn_throughput": 358.359, "synch_weights_time_ms": 67.084}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00013", "date": "2024-08-04_06-44-23", "timestamp": 1722734063, "time_this_iter_s": 8.305084943771362, "time_total_s": 267.2496294975281, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923709931c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.2496294975281, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.054545454545455, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.68521745204924, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.029916649808486, "policy_loss": -0.006036007383954711, "vf_loss": 3.0324323820571104, "vf_explained_var": 0.9706702763214707, "kl": 0.01122526744705586, "entropy": 1.5310863050321737, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -6.861137216075122, "episode_reward_min": -1352.732500823055, "episode_reward_mean": -643.7930797672991, "episode_len_mean": 123.13, "episode_media": {}, "episodes_timesteps_total": 12313, "policy_reward_min": {"policy_0": -1352.732500823055}, "policy_reward_max": {"policy_0": -6.861137216075122}, "policy_reward_mean": {"policy_0": -643.7930797672991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-223.99792900325374, -567.2081993374666, -238.97898344886679, -838.677310967608, -1352.732500823055, -130.81239694195335, -86.59434832000899, -1132.8330005999373, -1019.8739040224284, -724.158127028267, -677.2515252895083, -1063.019896526595, -715.4085608039601, -622.8818843671509, -992.533525097726, -701.5346620192018, -445.6485032338299, -362.17675575683785, -813.667450576797, -491.32946905647543, -1008.7728695411805, -277.8000531636881, -1198.0769025834766, -715.6852583980731, -597.0172304816278, -755.5917146598092, -128.20347372638057, -1035.9425135571314, -1222.2558875247062, -1231.2391813381896, -148.57189850586693, -786.9895490661055, -337.9771799188291, -317.7303463506447, -373.1465341340235, -834.8361950629208, -62.40782857329835, -41.05845112140939, -649.3674582257407, -702.078003895989, -863.4200619632252, -276.77480007093163, -208.04700052855412, -1284.2639149446263, -870.4855089428376, -173.57575257052534, -88.13383111404941, -115.73744105135, -914.5794220363312, -408.1765489134511, -518.3784611031667, -124.15775169434693, -964.9406317792811, -933.4740319107369, -6.861137216075122, -68.10396266972828, -31.841760346942436, -78.28230393697748, -1115.0588847640588, -448.80078897505894, -464.68114921497636, -937.20357731481, -764.918411794504, -968.8512238342668, -1212.6468429848605, -1072.7925303903378, -1133.909359403611, -277.7154840390064, -1054.1576935438297, -534.8985771149422, -493.61831423692354, -227.07640494400627, -339.30716054931, -157.6889089800424, -525.4080976544911, -1157.6450904560313, -667.7244707656747, -192.6966907008828, -583.6363295571175, -71.8303328646834, -1237.626670261713, -1289.6088202872954, -847.6211340626621, -985.2757270306538, -825.3864695961767, -925.3739144784993, -1044.2896256012853, -17.841549846870247, -908.5406186769364, -680.2431656182747, -1174.6761343557177, -686.3561657875757, -1320.8789928718732, -134.49068331088506, -255.98646797068048, -1308.3415431886629, -657.4659055239395, -349.67838096168725, -784.6037386968169, -987.4541586751258], "episode_lengths": [65, 150, 78, 150, 150, 74, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 110, 150, 140, 150, 136, 147, 150, 83, 150, 150, 150, 72, 150, 132, 83, 105, 150, 56, 50, 133, 150, 150, 103, 93, 150, 150, 64, 65, 54, 150, 97, 118, 63, 150, 150, 35, 56, 44, 66, 150, 122, 150, 150, 150, 150, 150, 150, 150, 89, 150, 142, 150, 75, 90, 90, 150, 150, 150, 85, 143, 46, 150, 150, 150, 150, 150, 150, 150, 32, 150, 126, 150, 150, 150, 78, 90, 150, 135, 90, 150, 150], "policy_policy_0_reward": [-223.99792900325374, -567.2081993374666, -238.97898344886679, -838.677310967608, -1352.732500823055, -130.81239694195335, -86.59434832000899, -1132.8330005999373, -1019.8739040224284, -724.158127028267, -677.2515252895083, -1063.019896526595, -715.4085608039601, -622.8818843671509, -992.533525097726, -701.5346620192018, -445.6485032338299, -362.17675575683785, -813.667450576797, -491.32946905647543, -1008.7728695411805, -277.8000531636881, -1198.0769025834766, -715.6852583980731, -597.0172304816278, -755.5917146598092, -128.20347372638057, -1035.9425135571314, -1222.2558875247062, -1231.2391813381896, -148.57189850586693, -786.9895490661055, -337.9771799188291, -317.7303463506447, -373.1465341340235, -834.8361950629208, -62.40782857329835, -41.05845112140939, -649.3674582257407, -702.078003895989, -863.4200619632252, -276.77480007093163, -208.04700052855412, -1284.2639149446263, -870.4855089428376, -173.57575257052534, -88.13383111404941, -115.73744105135, -914.5794220363312, -408.1765489134511, -518.3784611031667, -124.15775169434693, -964.9406317792811, -933.4740319107369, -6.861137216075122, -68.10396266972828, -31.841760346942436, -78.28230393697748, -1115.0588847640588, -448.80078897505894, -464.68114921497636, -937.20357731481, -764.918411794504, -968.8512238342668, -1212.6468429848605, -1072.7925303903378, -1133.909359403611, -277.7154840390064, -1054.1576935438297, -534.8985771149422, -493.61831423692354, -227.07640494400627, -339.30716054931, -157.6889089800424, -525.4080976544911, -1157.6450904560313, -667.7244707656747, -192.6966907008828, -583.6363295571175, -71.8303328646834, -1237.626670261713, -1289.6088202872954, -847.6211340626621, -985.2757270306538, -825.3864695961767, -925.3739144784993, -1044.2896256012853, -17.841549846870247, -908.5406186769364, -680.2431656182747, -1174.6761343557177, -686.3561657875757, -1320.8789928718732, -134.49068331088506, -255.98646797068048, -1308.3415431886629, -657.4659055239395, -349.67838096168725, -784.6037386968169, -987.4541586751258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573638819239108, "mean_inference_ms": 1.6845482006673924, "mean_action_processing_ms": 0.27635313411824225, "mean_env_wait_ms": 3.477497671009912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012352705001831055, "StateBufferConnector_ms": 0.007987499237060547, "ViewRequirementAgentConnector_ms": 0.19300484657287598}, "num_episodes": 30, "episode_return_max": -6.861137216075122, "episode_return_min": -1352.732500823055, "episode_return_mean": -643.7930797672991, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.971389031773, "num_env_steps_trained_throughput_per_sec": 309.971389031773, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12383.835, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12383.76, "sample_time_ms": 1155.68, "learn_time_ms": 11158.938, "learn_throughput": 358.457, "synch_weights_time_ms": 68.328}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00013", "date": "2024-08-04_06-44-36", "timestamp": 1722734076, "time_this_iter_s": 12.916687488555908, "time_total_s": 280.166316986084, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080a200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 280.166316986084, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.52105263157895, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.7594335079193, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.3526068155964217, "policy_loss": -0.008285519949276931, "vf_loss": 3.3569932358960313, "vf_explained_var": 0.975402945963045, "kl": 0.011521079667932099, "entropy": 1.2853792985280355, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -6.861137216075122, "episode_reward_min": -1428.3969819309752, "episode_reward_mean": -590.5159582877203, "episode_len_mean": 113.98, "episode_media": {}, "episodes_timesteps_total": 11398, "policy_reward_min": {"policy_0": -1428.3969819309752}, "policy_reward_max": {"policy_0": -6.861137216075122}, "policy_reward_mean": {"policy_0": -590.5159582877203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.05845112140939, -649.3674582257407, -702.078003895989, -863.4200619632252, -276.77480007093163, -208.04700052855412, -1284.2639149446263, -870.4855089428376, -173.57575257052534, -88.13383111404941, -115.73744105135, -914.5794220363312, -408.1765489134511, -518.3784611031667, -124.15775169434693, -964.9406317792811, -933.4740319107369, -6.861137216075122, -68.10396266972828, -31.841760346942436, -78.28230393697748, -1115.0588847640588, -448.80078897505894, -464.68114921497636, -937.20357731481, -764.918411794504, -968.8512238342668, -1212.6468429848605, -1072.7925303903378, -1133.909359403611, -277.7154840390064, -1054.1576935438297, -534.8985771149422, -493.61831423692354, -227.07640494400627, -339.30716054931, -157.6889089800424, -525.4080976544911, -1157.6450904560313, -667.7244707656747, -192.6966907008828, -583.6363295571175, -71.8303328646834, -1237.626670261713, -1289.6088202872954, -847.6211340626621, -985.2757270306538, -825.3864695961767, -925.3739144784993, -1044.2896256012853, -17.841549846870247, -908.5406186769364, -680.2431656182747, -1174.6761343557177, -686.3561657875757, -1320.8789928718732, -134.49068331088506, -255.98646797068048, -1308.3415431886629, -657.4659055239395, -349.67838096168725, -784.6037386968169, -987.4541586751258, -682.1629896772965, -347.681452955358, -50.29143851319309, -115.78152684599247, -79.80482368139211, -640.6467650772487, -1071.4418608814376, -896.8681753984589, -256.75374455278586, -189.2604005546439, -48.46839170806451, -192.44919207734242, -134.05406389276976, -242.27318098164295, -1428.3969819309752, -1106.501189794422, -1291.8655888609549, -208.43648174882162, -114.24006069481078, -105.76844156315445, -243.68995978767856, -1104.8264834333868, -188.23780821474344, -684.1915847727352, -609.3721626601617, -30.139040346194765, -262.9956306296493, -200.57746223111334, -1163.3282430158076, -255.61455955354683, -1242.0471041674957, -1305.0678403390016, -385.7913712945132, -578.0765960780845, -57.53860418660277, -235.74037156136438, -1155.4698281861515], "episode_lengths": [50, 133, 150, 150, 103, 93, 150, 150, 64, 65, 54, 150, 97, 118, 63, 150, 150, 35, 56, 44, 66, 150, 122, 150, 150, 150, 150, 150, 150, 150, 89, 150, 142, 150, 75, 90, 90, 150, 150, 150, 85, 143, 46, 150, 150, 150, 150, 150, 150, 150, 32, 150, 126, 150, 150, 150, 78, 90, 150, 135, 90, 150, 150, 150, 91, 47, 52, 61, 150, 150, 150, 79, 79, 50, 76, 74, 90, 150, 150, 150, 68, 65, 65, 84, 150, 77, 133, 150, 46, 79, 66, 150, 71, 150, 150, 129, 143, 62, 87, 150], "policy_policy_0_reward": [-41.05845112140939, -649.3674582257407, -702.078003895989, -863.4200619632252, -276.77480007093163, -208.04700052855412, -1284.2639149446263, -870.4855089428376, -173.57575257052534, -88.13383111404941, -115.73744105135, -914.5794220363312, -408.1765489134511, -518.3784611031667, -124.15775169434693, -964.9406317792811, -933.4740319107369, -6.861137216075122, -68.10396266972828, -31.841760346942436, -78.28230393697748, -1115.0588847640588, -448.80078897505894, -464.68114921497636, -937.20357731481, -764.918411794504, -968.8512238342668, -1212.6468429848605, -1072.7925303903378, -1133.909359403611, -277.7154840390064, -1054.1576935438297, -534.8985771149422, -493.61831423692354, -227.07640494400627, -339.30716054931, -157.6889089800424, -525.4080976544911, -1157.6450904560313, -667.7244707656747, -192.6966907008828, -583.6363295571175, -71.8303328646834, -1237.626670261713, -1289.6088202872954, -847.6211340626621, -985.2757270306538, -825.3864695961767, -925.3739144784993, -1044.2896256012853, -17.841549846870247, -908.5406186769364, -680.2431656182747, -1174.6761343557177, -686.3561657875757, -1320.8789928718732, -134.49068331088506, -255.98646797068048, -1308.3415431886629, -657.4659055239395, -349.67838096168725, -784.6037386968169, -987.4541586751258, -682.1629896772965, -347.681452955358, -50.29143851319309, -115.78152684599247, -79.80482368139211, -640.6467650772487, -1071.4418608814376, -896.8681753984589, -256.75374455278586, -189.2604005546439, -48.46839170806451, -192.44919207734242, -134.05406389276976, -242.27318098164295, -1428.3969819309752, -1106.501189794422, -1291.8655888609549, -208.43648174882162, -114.24006069481078, -105.76844156315445, -243.68995978767856, -1104.8264834333868, -188.23780821474344, -684.1915847727352, -609.3721626601617, -30.139040346194765, -262.9956306296493, -200.57746223111334, -1163.3282430158076, -255.61455955354683, -1242.0471041674957, -1305.0678403390016, -385.7913712945132, -578.0765960780845, -57.53860418660277, -235.74037156136438, -1155.4698281861515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557486385636536, "mean_inference_ms": 1.6827529557093106, "mean_action_processing_ms": 0.2759149878480478, "mean_env_wait_ms": 3.4784478572689554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012409210205078125, "StateBufferConnector_ms": 0.008085489273071289, "ViewRequirementAgentConnector_ms": 0.19423985481262207}, "num_episodes": 37, "episode_return_max": -6.861137216075122, "episode_return_min": -1428.3969819309752, "episode_return_mean": -590.5159582877203, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.6229847526573, "num_env_steps_trained_throughput_per_sec": 301.6229847526573, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12376.716, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12376.641, "sample_time_ms": 1156.359, "learn_time_ms": 11151.186, "learn_throughput": 358.706, "synch_weights_time_ms": 68.28}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00013", "date": "2024-08-04_06-44-49", "timestamp": 1722734089, "time_this_iter_s": 13.273486375808716, "time_total_s": 293.4398033618927, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fba4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 293.4398033618927, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.247368421052634, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.9670078635216, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.0767082424213488, "policy_loss": -0.00923946421292688, "vf_loss": 3.0819907924781242, "vf_explained_var": 0.9732755511378248, "kl": 0.011438853186715885, "entropy": 1.1905674230928223, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -17.841549846870247, "episode_reward_min": -1428.3969819309752, "episode_reward_mean": -586.1824630407033, "episode_len_mean": 115.95, "episode_media": {}, "episodes_timesteps_total": 11595, "policy_reward_min": {"policy_0": -1428.3969819309752}, "policy_reward_max": {"policy_0": -17.841549846870247}, "policy_reward_mean": {"policy_0": -586.1824630407033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-493.61831423692354, -227.07640494400627, -339.30716054931, -157.6889089800424, -525.4080976544911, -1157.6450904560313, -667.7244707656747, -192.6966907008828, -583.6363295571175, -71.8303328646834, -1237.626670261713, -1289.6088202872954, -847.6211340626621, -985.2757270306538, -825.3864695961767, -925.3739144784993, -1044.2896256012853, -17.841549846870247, -908.5406186769364, -680.2431656182747, -1174.6761343557177, -686.3561657875757, -1320.8789928718732, -134.49068331088506, -255.98646797068048, -1308.3415431886629, -657.4659055239395, -349.67838096168725, -784.6037386968169, -987.4541586751258, -682.1629896772965, -347.681452955358, -50.29143851319309, -115.78152684599247, -79.80482368139211, -640.6467650772487, -1071.4418608814376, -896.8681753984589, -256.75374455278586, -189.2604005546439, -48.46839170806451, -192.44919207734242, -134.05406389276976, -242.27318098164295, -1428.3969819309752, -1106.501189794422, -1291.8655888609549, -208.43648174882162, -114.24006069481078, -105.76844156315445, -243.68995978767856, -1104.8264834333868, -188.23780821474344, -684.1915847727352, -609.3721626601617, -30.139040346194765, -262.9956306296493, -200.57746223111334, -1163.3282430158076, -255.61455955354683, -1242.0471041674957, -1305.0678403390016, -385.7913712945132, -578.0765960780845, -57.53860418660277, -235.74037156136438, -1155.4698281861515, -231.86538524770012, -549.7082197570668, -443.5666906682202, -651.1026239243678, -968.4147065413802, -870.4287480874186, -916.8887936318979, -692.9024545356076, -890.5167617560371, -802.9208383891372, -299.1088632211595, -520.2213029538246, -253.98688186655633, -948.7593574040222, -1136.0792957782103, -519.4594699499557, -1007.589677873247, -439.27294969176273, -420.5424206552279, -127.35565595566855, -684.0159029836236, -689.0219621023758, -884.3040689918092, -548.2189317937017, -70.14865497016456, -299.07427106121787, -705.2665919510215, -1034.1673261005656, -22.97088232956268, -633.0038949448084, -130.76328144858277, -458.65156679328584, -23.724801349652775], "episode_lengths": [150, 75, 90, 90, 150, 150, 150, 85, 143, 46, 150, 150, 150, 150, 150, 150, 150, 32, 150, 126, 150, 150, 150, 78, 90, 150, 135, 90, 150, 150, 150, 91, 47, 52, 61, 150, 150, 150, 79, 79, 50, 76, 74, 90, 150, 150, 150, 68, 65, 65, 84, 150, 77, 133, 150, 46, 79, 66, 150, 71, 150, 150, 129, 143, 62, 87, 150, 92, 150, 103, 124, 150, 150, 150, 150, 150, 150, 83, 104, 76, 150, 150, 128, 150, 126, 120, 73, 150, 150, 150, 111, 59, 96, 150, 150, 44, 143, 64, 150, 45], "policy_policy_0_reward": [-493.61831423692354, -227.07640494400627, -339.30716054931, -157.6889089800424, -525.4080976544911, -1157.6450904560313, -667.7244707656747, -192.6966907008828, -583.6363295571175, -71.8303328646834, -1237.626670261713, -1289.6088202872954, -847.6211340626621, -985.2757270306538, -825.3864695961767, -925.3739144784993, -1044.2896256012853, -17.841549846870247, -908.5406186769364, -680.2431656182747, -1174.6761343557177, -686.3561657875757, -1320.8789928718732, -134.49068331088506, -255.98646797068048, -1308.3415431886629, -657.4659055239395, -349.67838096168725, -784.6037386968169, -987.4541586751258, -682.1629896772965, -347.681452955358, -50.29143851319309, -115.78152684599247, -79.80482368139211, -640.6467650772487, -1071.4418608814376, -896.8681753984589, -256.75374455278586, -189.2604005546439, -48.46839170806451, -192.44919207734242, -134.05406389276976, -242.27318098164295, -1428.3969819309752, -1106.501189794422, -1291.8655888609549, -208.43648174882162, -114.24006069481078, -105.76844156315445, -243.68995978767856, -1104.8264834333868, -188.23780821474344, -684.1915847727352, -609.3721626601617, -30.139040346194765, -262.9956306296493, -200.57746223111334, -1163.3282430158076, -255.61455955354683, -1242.0471041674957, -1305.0678403390016, -385.7913712945132, -578.0765960780845, -57.53860418660277, -235.74037156136438, -1155.4698281861515, -231.86538524770012, -549.7082197570668, -443.5666906682202, -651.1026239243678, -968.4147065413802, -870.4287480874186, -916.8887936318979, -692.9024545356076, -890.5167617560371, -802.9208383891372, -299.1088632211595, -520.2213029538246, -253.98688186655633, -948.7593574040222, -1136.0792957782103, -519.4594699499557, -1007.589677873247, -439.27294969176273, -420.5424206552279, -127.35565595566855, -684.0159029836236, -689.0219621023758, -884.3040689918092, -548.2189317937017, -70.14865497016456, -299.07427106121787, -705.2665919510215, -1034.1673261005656, -22.97088232956268, -633.0038949448084, -130.76328144858277, -458.65156679328584, -23.724801349652775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578222332736561, "mean_inference_ms": 1.683301922724321, "mean_action_processing_ms": 0.27614204086595656, "mean_env_wait_ms": 3.4754750600837445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012813329696655273, "StateBufferConnector_ms": 0.00808095932006836, "ViewRequirementAgentConnector_ms": 0.19414806365966797}, "num_episodes": 33, "episode_return_max": -17.841549846870247, "episode_return_min": -1428.3969819309752, "episode_return_mean": -586.1824630407033, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.8274366260945, "num_env_steps_trained_throughput_per_sec": 301.8274366260945, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12390.099, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12390.024, "sample_time_ms": 1150.647, "learn_time_ms": 11170.797, "learn_throughput": 358.077, "synch_weights_time_ms": 67.792}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00013", "date": "2024-08-04_06-45-02", "timestamp": 1722734102, "time_this_iter_s": 13.265470504760742, "time_total_s": 306.70527386665344, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370809630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.70527386665344, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.99473684210526, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.4640346308549, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.029609974846244, "policy_loss": -0.015125782772277793, "vf_loss": 3.039368698000908, "vf_explained_var": 0.988189179264009, "kl": 0.014497043985344764, "entropy": 1.1565970317150156, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -22.97088232956268, "episode_reward_min": -1428.3969819309752, "episode_reward_mean": -524.5550869457029, "episode_len_mean": 112.26, "episode_media": {}, "episodes_timesteps_total": 11226, "policy_reward_min": {"policy_0": -1428.3969819309752}, "policy_reward_max": {"policy_0": -22.97088232956268}, "policy_reward_mean": {"policy_0": -524.5550869457029}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.75374455278586, -189.2604005546439, -48.46839170806451, -192.44919207734242, -134.05406389276976, -242.27318098164295, -1428.3969819309752, -1106.501189794422, -1291.8655888609549, -208.43648174882162, -114.24006069481078, -105.76844156315445, -243.68995978767856, -1104.8264834333868, -188.23780821474344, -684.1915847727352, -609.3721626601617, -30.139040346194765, -262.9956306296493, -200.57746223111334, -1163.3282430158076, -255.61455955354683, -1242.0471041674957, -1305.0678403390016, -385.7913712945132, -578.0765960780845, -57.53860418660277, -235.74037156136438, -1155.4698281861515, -231.86538524770012, -549.7082197570668, -443.5666906682202, -651.1026239243678, -968.4147065413802, -870.4287480874186, -916.8887936318979, -692.9024545356076, -890.5167617560371, -802.9208383891372, -299.1088632211595, -520.2213029538246, -253.98688186655633, -948.7593574040222, -1136.0792957782103, -519.4594699499557, -1007.589677873247, -439.27294969176273, -420.5424206552279, -127.35565595566855, -684.0159029836236, -689.0219621023758, -884.3040689918092, -548.2189317937017, -70.14865497016456, -299.07427106121787, -705.2665919510215, -1034.1673261005656, -22.97088232956268, -633.0038949448084, -130.76328144858277, -458.65156679328584, -23.724801349652775, -528.6283588062219, -119.23460655760263, -811.8315718757974, -114.62146220926333, -508.181106230973, -654.6484779199932, -1072.1140927663232, -104.51129677429711, -119.33136858464958, -64.70972545161405, -777.4780256122833, -344.32901322657335, -180.29471350848692, -88.88362445905065, -938.421380991085, -671.4729262276122, -113.32606046459102, -197.64889031555765, -887.4718292166904, -788.3420543007618, -234.79143555858528, -206.64903169284506, -827.1344112227683, -234.48033296149674, -895.7234630744636, -1025.0005846501872, -807.5100376450863, -301.06847948505754, -887.8419572974749, -47.338370408607695, -1090.133029416221, -147.1516229309471, -128.41316998017714, -661.9401738595787, -251.3376374244588, -131.22666832329904, -634.5559377042756, -962.5361619078775], "episode_lengths": [79, 79, 50, 76, 74, 90, 150, 150, 150, 68, 65, 65, 84, 150, 77, 133, 150, 46, 79, 66, 150, 71, 150, 150, 129, 143, 62, 87, 150, 92, 150, 103, 124, 150, 150, 150, 150, 150, 150, 83, 104, 76, 150, 150, 128, 150, 126, 120, 73, 150, 150, 150, 111, 59, 96, 150, 150, 44, 143, 64, 150, 45, 150, 70, 150, 66, 150, 150, 150, 76, 68, 51, 150, 84, 61, 68, 150, 150, 73, 91, 150, 150, 69, 90, 150, 102, 150, 150, 150, 119, 150, 62, 150, 72, 58, 150, 76, 56, 150, 150], "policy_policy_0_reward": [-256.75374455278586, -189.2604005546439, -48.46839170806451, -192.44919207734242, -134.05406389276976, -242.27318098164295, -1428.3969819309752, -1106.501189794422, -1291.8655888609549, -208.43648174882162, -114.24006069481078, -105.76844156315445, -243.68995978767856, -1104.8264834333868, -188.23780821474344, -684.1915847727352, -609.3721626601617, -30.139040346194765, -262.9956306296493, -200.57746223111334, -1163.3282430158076, -255.61455955354683, -1242.0471041674957, -1305.0678403390016, -385.7913712945132, -578.0765960780845, -57.53860418660277, -235.74037156136438, -1155.4698281861515, -231.86538524770012, -549.7082197570668, -443.5666906682202, -651.1026239243678, -968.4147065413802, -870.4287480874186, -916.8887936318979, -692.9024545356076, -890.5167617560371, -802.9208383891372, -299.1088632211595, -520.2213029538246, -253.98688186655633, -948.7593574040222, -1136.0792957782103, -519.4594699499557, -1007.589677873247, -439.27294969176273, -420.5424206552279, -127.35565595566855, -684.0159029836236, -689.0219621023758, -884.3040689918092, -548.2189317937017, -70.14865497016456, -299.07427106121787, -705.2665919510215, -1034.1673261005656, -22.97088232956268, -633.0038949448084, -130.76328144858277, -458.65156679328584, -23.724801349652775, -528.6283588062219, -119.23460655760263, -811.8315718757974, -114.62146220926333, -508.181106230973, -654.6484779199932, -1072.1140927663232, -104.51129677429711, -119.33136858464958, -64.70972545161405, -777.4780256122833, -344.32901322657335, -180.29471350848692, -88.88362445905065, -938.421380991085, -671.4729262276122, -113.32606046459102, -197.64889031555765, -887.4718292166904, -788.3420543007618, -234.79143555858528, -206.64903169284506, -827.1344112227683, -234.48033296149674, -895.7234630744636, -1025.0005846501872, -807.5100376450863, -301.06847948505754, -887.8419572974749, -47.338370408607695, -1090.133029416221, -147.1516229309471, -128.41316998017714, -661.9401738595787, -251.3376374244588, -131.22666832329904, -634.5559377042756, -962.5361619078775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557054289082582, "mean_inference_ms": 1.6820437316753627, "mean_action_processing_ms": 0.2761850618834962, "mean_env_wait_ms": 3.4753455145993772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01259922981262207, "StateBufferConnector_ms": 0.008059263229370117, "ViewRequirementAgentConnector_ms": 0.19613218307495117}, "num_episodes": 38, "episode_return_max": -22.97088232956268, "episode_return_min": -1428.3969819309752, "episode_return_mean": -524.5550869457029, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.70237785472597, "num_env_steps_trained_throughput_per_sec": 313.70237785472597, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12334.037, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12333.962, "sample_time_ms": 1158.931, "learn_time_ms": 11107.74, "learn_throughput": 360.109, "synch_weights_time_ms": 66.503}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00013", "date": "2024-08-04_06-45-15", "timestamp": 1722734115, "time_this_iter_s": 12.762601852416992, "time_total_s": 319.46787571907043, "pid": 588981, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080bc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.46787571907043, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.672222222222224, "ram_util_percent": 28.100000000000005}}
