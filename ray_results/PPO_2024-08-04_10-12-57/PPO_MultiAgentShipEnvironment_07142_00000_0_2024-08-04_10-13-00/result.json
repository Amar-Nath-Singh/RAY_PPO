{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9801935736089945, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.650477761030197, "policy_loss": -0.003503227178104377, "vf_loss": 9.666437782843907, "vf_explained_var": -0.01686319870253404, "kl": 0.008949825213865855, "entropy": 1.424674271295468, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -64.05659569288123, "episode_reward_min": -1405.4930247420093, "episode_reward_mean": -885.3874829507266, "episode_len_mean": 135.20833333333334, "episode_media": {}, "episodes_timesteps_total": 3245, "policy_reward_min": {"policy_0": -1405.4930247420093}, "policy_reward_max": {"policy_0": -64.05659569288123}, "policy_reward_mean": {"policy_0": -885.3874829507266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1107.719093122868, -1078.9415184782758, -826.0732685371671, -1059.9709133169044, -1079.1862573874473, -1317.6474863808953, -932.5289037573452, -1074.329645210241, -1272.8253779811196, -625.6775259934858, -265.2031258196348, -75.2157617559651, -928.7131787125259, -1110.0909187898992, -746.5485428666427, -144.4947235201855, -1082.9661917738888, -884.9008592182231, -64.05659569288123, -1181.9772772158187, -1139.5856374482457, -1405.4930247420093, -881.6257540996666, -963.5280089961025], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 45, 150, 150, 150, 69, 150, 150, 50, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1107.719093122868, -1078.9415184782758, -826.0732685371671, -1059.9709133169044, -1079.1862573874473, -1317.6474863808953, -932.5289037573452, -1074.329645210241, -1272.8253779811196, -625.6775259934858, -265.2031258196348, -75.2157617559651, -928.7131787125259, -1110.0909187898992, -746.5485428666427, -144.4947235201855, -1082.9661917738888, -884.9008592182231, -64.05659569288123, -1181.9772772158187, -1139.5856374482457, -1405.4930247420093, -881.6257540996666, -963.5280089961025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5741097092563231, "mean_inference_ms": 1.6597083819388823, "mean_action_processing_ms": 0.2758410274493088, "mean_env_wait_ms": 3.3572212642963035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011195739110310873, "StateBufferConnector_ms": 0.008150935173034668, "ViewRequirementAgentConnector_ms": 0.17815033594767252}, "num_episodes": 24, "episode_return_max": -64.05659569288123, "episode_return_min": -1405.4930247420093, "episode_return_mean": -885.3874829507266, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.7825227646703, "num_env_steps_trained_throughput_per_sec": 312.7825227646703, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12788.449, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12788.38, "sample_time_ms": 1103.805, "learn_time_ms": 11619.313, "learn_throughput": 344.254, "synch_weights_time_ms": 64.095}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "07142_00000", "date": "2024-08-04_10-13-29", "timestamp": 1722746609, "time_this_iter_s": 12.799605131149292, "time_total_s": 12.799605131149292, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f86814bf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.799605131149292, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.768421052631577, "ram_util_percent": 28.089473684210528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1503747159615159, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.588492470979691, "policy_loss": -0.01103879518583805, "vf_loss": 9.610862013697623, "vf_explained_var": 0.005677579032878081, "kl": 0.015748400392521945, "entropy": 1.448044709737102, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -29.377191305278373, "episode_reward_min": -1405.4930247420093, "episode_reward_mean": -752.5587366828871, "episode_len_mean": 123.53703703703704, "episode_media": {}, "episodes_timesteps_total": 6671, "policy_reward_min": {"policy_0": -1405.4930247420093}, "policy_reward_max": {"policy_0": -29.377191305278373}, "policy_reward_mean": {"policy_0": -752.5587366828871}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1107.719093122868, -1078.9415184782758, -826.0732685371671, -1059.9709133169044, -1079.1862573874473, -1317.6474863808953, -932.5289037573452, -1074.329645210241, -1272.8253779811196, -625.6775259934858, -265.2031258196348, -75.2157617559651, -928.7131787125259, -1110.0909187898992, -746.5485428666427, -144.4947235201855, -1082.9661917738888, -884.9008592182231, -64.05659569288123, -1181.9772772158187, -1139.5856374482457, -1405.4930247420093, -881.6257540996666, -963.5280089961025, -1100.1944350076396, -352.5952770910859, -227.61964506305588, -327.66702486750364, -1327.2863869297557, -1186.0131830167563, -601.1344298403575, -197.6565262113312, -137.73760471925712, -29.377191305278373, -882.3345433871397, -1167.2319334504125, -1167.818692792466, -38.68656180349658, -1189.5816509002766, -978.2689978021258, -60.90963762262781, -306.46119510926144, -938.1226175402256, -909.2673165080392, -504.0962178473305, -82.2990930103642, -266.4757922210231, -997.2494416428084, -1145.7602800612012, -895.9734892960589, -992.1011911437683, -120.40794455455476, -428.97896914900554, -829.5649201642487], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 45, 150, 150, 150, 69, 150, 150, 50, 150, 150, 150, 150, 150, 150, 104, 89, 78, 150, 150, 150, 83, 63, 41, 150, 150, 150, 47, 150, 150, 41, 77, 150, 150, 107, 52, 79, 150, 150, 150, 150, 71, 106, 138], "policy_policy_0_reward": [-1107.719093122868, -1078.9415184782758, -826.0732685371671, -1059.9709133169044, -1079.1862573874473, -1317.6474863808953, -932.5289037573452, -1074.329645210241, -1272.8253779811196, -625.6775259934858, -265.2031258196348, -75.2157617559651, -928.7131787125259, -1110.0909187898992, -746.5485428666427, -144.4947235201855, -1082.9661917738888, -884.9008592182231, -64.05659569288123, -1181.9772772158187, -1139.5856374482457, -1405.4930247420093, -881.6257540996666, -963.5280089961025, -1100.1944350076396, -352.5952770910859, -227.61964506305588, -327.66702486750364, -1327.2863869297557, -1186.0131830167563, -601.1344298403575, -197.6565262113312, -137.73760471925712, -29.377191305278373, -882.3345433871397, -1167.2319334504125, -1167.818692792466, -38.68656180349658, -1189.5816509002766, -978.2689978021258, -60.90963762262781, -306.46119510926144, -938.1226175402256, -909.2673165080392, -504.0962178473305, -82.2990930103642, -266.4757922210231, -997.2494416428084, -1145.7602800612012, -895.9734892960589, -992.1011911437683, -120.40794455455476, -428.97896914900554, -829.5649201642487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5713905524746363, "mean_inference_ms": 1.661926284886326, "mean_action_processing_ms": 0.2768345092563323, "mean_env_wait_ms": 3.3719436913271363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013444600281891999, "StateBufferConnector_ms": 0.008481520193594473, "ViewRequirementAgentConnector_ms": 0.18262156733760126}, "num_episodes": 30, "episode_return_max": -29.377191305278373, "episode_return_min": -1405.4930247420093, "episode_return_mean": -752.5587366828871, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.83107123918523, "num_env_steps_trained_throughput_per_sec": 320.83107123918523, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12628.041, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12627.976, "sample_time_ms": 1103.996, "learn_time_ms": 11449.285, "learn_throughput": 349.367, "synch_weights_time_ms": 73.743}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "07142_00000", "date": "2024-08-04_10-13-41", "timestamp": 1722746621, "time_this_iter_s": 12.480594396591187, "time_total_s": 25.28019952774048, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f868148820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.28019952774048, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.644444444444442, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4871565368336936, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.335656030476093, "policy_loss": -0.010328236064136338, "vf_loss": 9.357405145963034, "vf_explained_var": 0.18216827139258385, "kl": 0.015623742915484705, "entropy": 1.4545612424612044, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -29.377191305278373, "episode_reward_min": -1412.998009560282, "episode_reward_mean": -773.9304176194522, "episode_len_mean": 125.19047619047619, "episode_media": {}, "episodes_timesteps_total": 10516, "policy_reward_min": {"policy_0": -1412.998009560282}, "policy_reward_max": {"policy_0": -29.377191305278373}, "policy_reward_mean": {"policy_0": -773.9304176194522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1107.719093122868, -1078.9415184782758, -826.0732685371671, -1059.9709133169044, -1079.1862573874473, -1317.6474863808953, -932.5289037573452, -1074.329645210241, -1272.8253779811196, -625.6775259934858, -265.2031258196348, -75.2157617559651, -928.7131787125259, -1110.0909187898992, -746.5485428666427, -144.4947235201855, -1082.9661917738888, -884.9008592182231, -64.05659569288123, -1181.9772772158187, -1139.5856374482457, -1405.4930247420093, -881.6257540996666, -963.5280089961025, -1100.1944350076396, -352.5952770910859, -227.61964506305588, -327.66702486750364, -1327.2863869297557, -1186.0131830167563, -601.1344298403575, -197.6565262113312, -137.73760471925712, -29.377191305278373, -882.3345433871397, -1167.2319334504125, -1167.818692792466, -38.68656180349658, -1189.5816509002766, -978.2689978021258, -60.90963762262781, -306.46119510926144, -938.1226175402256, -909.2673165080392, -504.0962178473305, -82.2990930103642, -266.4757922210231, -997.2494416428084, -1145.7602800612012, -895.9734892960589, -992.1011911437683, -120.40794455455476, -428.97896914900554, -829.5649201642487, -900.2122683163753, -1216.5432112668946, -1051.7072653055793, -138.2659445983245, -982.5857076728511, -438.17575211220526, -1173.3660583066633, -1168.8742154703475, -1393.5566840001493, -210.08205224232358, -163.35565138032533, -353.8424681019631, -1309.407312608065, -1291.9906103331602, -1412.998009560282, -169.45983853481815, -1256.4643115049466, -1176.8558191940656, -703.5799025939968, -89.68148074471937, -1092.5973528680083, -1241.5144653359368, -991.2605601736539, -34.99512355786697, -1092.625407024638, -81.38018795529744, -782.9375949970927, -934.3518958510671, -786.1510011147855, -733.1651464316876], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 45, 150, 150, 150, 69, 150, 150, 50, 150, 150, 150, 150, 150, 150, 104, 89, 78, 150, 150, 150, 83, 63, 41, 150, 150, 150, 47, 150, 150, 41, 77, 150, 150, 107, 52, 79, 150, 150, 150, 150, 71, 106, 138, 150, 150, 150, 80, 150, 150, 150, 150, 150, 75, 94, 87, 150, 150, 150, 56, 150, 150, 150, 49, 150, 150, 150, 36, 150, 68, 150, 150, 150, 150], "policy_policy_0_reward": [-1107.719093122868, -1078.9415184782758, -826.0732685371671, -1059.9709133169044, -1079.1862573874473, -1317.6474863808953, -932.5289037573452, -1074.329645210241, -1272.8253779811196, -625.6775259934858, -265.2031258196348, -75.2157617559651, -928.7131787125259, -1110.0909187898992, -746.5485428666427, -144.4947235201855, -1082.9661917738888, -884.9008592182231, -64.05659569288123, -1181.9772772158187, -1139.5856374482457, -1405.4930247420093, -881.6257540996666, -963.5280089961025, -1100.1944350076396, -352.5952770910859, -227.61964506305588, -327.66702486750364, -1327.2863869297557, -1186.0131830167563, -601.1344298403575, -197.6565262113312, -137.73760471925712, -29.377191305278373, -882.3345433871397, -1167.2319334504125, -1167.818692792466, -38.68656180349658, -1189.5816509002766, -978.2689978021258, -60.90963762262781, -306.46119510926144, -938.1226175402256, -909.2673165080392, -504.0962178473305, -82.2990930103642, -266.4757922210231, -997.2494416428084, -1145.7602800612012, -895.9734892960589, -992.1011911437683, -120.40794455455476, -428.97896914900554, -829.5649201642487, -900.2122683163753, -1216.5432112668946, -1051.7072653055793, -138.2659445983245, -982.5857076728511, -438.17575211220526, -1173.3660583066633, -1168.8742154703475, -1393.5566840001493, -210.08205224232358, -163.35565138032533, -353.8424681019631, -1309.407312608065, -1291.9906103331602, -1412.998009560282, -169.45983853481815, -1256.4643115049466, -1176.8558191940656, -703.5799025939968, -89.68148074471937, -1092.5973528680083, -1241.5144653359368, -991.2605601736539, -34.99512355786697, -1092.625407024638, -81.38018795529744, -782.9375949970927, -934.3518958510671, -786.1510011147855, -733.1651464316876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5685588429655872, "mean_inference_ms": 1.6606344972364788, "mean_action_processing_ms": 0.2766062613419245, "mean_env_wait_ms": 3.37547753596068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013475758688790458, "StateBufferConnector_ms": 0.008671056656610398, "ViewRequirementAgentConnector_ms": 0.18789966901143393}, "num_episodes": 30, "episode_return_max": -29.377191305278373, "episode_return_min": -1412.998009560282, "episode_return_mean": -773.9304176194522, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8754502673709, "num_env_steps_trained_throughput_per_sec": 323.8754502673709, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12535.508, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12535.437, "sample_time_ms": 1097.785, "learn_time_ms": 11363.629, "learn_throughput": 352.0, "synch_weights_time_ms": 73.022}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "07142_00000", "date": "2024-08-04_10-13-54", "timestamp": 1722746634, "time_this_iter_s": 12.36208987236023, "time_total_s": 37.64228940010071, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244140d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.64228940010071, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.076470588235292, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9387021653664607, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.35989203453064, "policy_loss": -0.013574482427793555, "vf_loss": 9.385127692421277, "vf_explained_var": 0.2742627910027901, "kl": 0.01642164604733504, "entropy": 1.4945472327371438, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -29.377191305278373, "episode_reward_min": -1412.998009560282, "episode_reward_mean": -757.2095083540783, "episode_len_mean": 124.54, "episode_media": {}, "episodes_timesteps_total": 12454, "policy_reward_min": {"policy_0": -1412.998009560282}, "policy_reward_max": {"policy_0": -29.377191305278373}, "policy_reward_mean": {"policy_0": -757.2095083540783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.2157617559651, -928.7131787125259, -1110.0909187898992, -746.5485428666427, -144.4947235201855, -1082.9661917738888, -884.9008592182231, -64.05659569288123, -1181.9772772158187, -1139.5856374482457, -1405.4930247420093, -881.6257540996666, -963.5280089961025, -1100.1944350076396, -352.5952770910859, -227.61964506305588, -327.66702486750364, -1327.2863869297557, -1186.0131830167563, -601.1344298403575, -197.6565262113312, -137.73760471925712, -29.377191305278373, -882.3345433871397, -1167.2319334504125, -1167.818692792466, -38.68656180349658, -1189.5816509002766, -978.2689978021258, -60.90963762262781, -306.46119510926144, -938.1226175402256, -909.2673165080392, -504.0962178473305, -82.2990930103642, -266.4757922210231, -997.2494416428084, -1145.7602800612012, -895.9734892960589, -992.1011911437683, -120.40794455455476, -428.97896914900554, -829.5649201642487, -900.2122683163753, -1216.5432112668946, -1051.7072653055793, -138.2659445983245, -982.5857076728511, -438.17575211220526, -1173.3660583066633, -1168.8742154703475, -1393.5566840001493, -210.08205224232358, -163.35565138032533, -353.8424681019631, -1309.407312608065, -1291.9906103331602, -1412.998009560282, -169.45983853481815, -1256.4643115049466, -1176.8558191940656, -703.5799025939968, -89.68148074471937, -1092.5973528680083, -1241.5144653359368, -991.2605601736539, -34.99512355786697, -1092.625407024638, -81.38018795529744, -782.9375949970927, -934.3518958510671, -786.1510011147855, -733.1651464316876, -325.23952617127117, -1150.8874129689857, -49.07789812844599, -325.6119585762939, -1098.4294318674868, -995.5478676756591, -1173.8927782836474, -1099.5283522255795, -50.114902695378575, -571.788835227924, -381.62845550443507, -1363.3761636882796, -1137.8351907492965, -833.1644010212569, -1224.470620653859, -873.1829269667652, -1007.2232820565346, -63.10601450570455, -1258.6823595066026, -1152.7171355622036, -1131.5993362668605, -1366.7265950742349, -909.0536030786906, -194.90089507934212, -748.0492162314423, -377.25591801323407, -487.8077935798055], "episode_lengths": [45, 150, 150, 150, 69, 150, 150, 50, 150, 150, 150, 150, 150, 150, 104, 89, 78, 150, 150, 150, 83, 63, 41, 150, 150, 150, 47, 150, 150, 41, 77, 150, 150, 107, 52, 79, 150, 150, 150, 150, 71, 106, 138, 150, 150, 150, 80, 150, 150, 150, 150, 150, 75, 94, 87, 150, 150, 150, 56, 150, 150, 150, 49, 150, 150, 150, 36, 150, 68, 150, 150, 150, 150, 87, 150, 60, 105, 150, 150, 150, 150, 54, 109, 123, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 101, 150, 117, 150], "policy_policy_0_reward": [-75.2157617559651, -928.7131787125259, -1110.0909187898992, -746.5485428666427, -144.4947235201855, -1082.9661917738888, -884.9008592182231, -64.05659569288123, -1181.9772772158187, -1139.5856374482457, -1405.4930247420093, -881.6257540996666, -963.5280089961025, -1100.1944350076396, -352.5952770910859, -227.61964506305588, -327.66702486750364, -1327.2863869297557, -1186.0131830167563, -601.1344298403575, -197.6565262113312, -137.73760471925712, -29.377191305278373, -882.3345433871397, -1167.2319334504125, -1167.818692792466, -38.68656180349658, -1189.5816509002766, -978.2689978021258, -60.90963762262781, -306.46119510926144, -938.1226175402256, -909.2673165080392, -504.0962178473305, -82.2990930103642, -266.4757922210231, -997.2494416428084, -1145.7602800612012, -895.9734892960589, -992.1011911437683, -120.40794455455476, -428.97896914900554, -829.5649201642487, -900.2122683163753, -1216.5432112668946, -1051.7072653055793, -138.2659445983245, -982.5857076728511, -438.17575211220526, -1173.3660583066633, -1168.8742154703475, -1393.5566840001493, -210.08205224232358, -163.35565138032533, -353.8424681019631, -1309.407312608065, -1291.9906103331602, -1412.998009560282, -169.45983853481815, -1256.4643115049466, -1176.8558191940656, -703.5799025939968, -89.68148074471937, -1092.5973528680083, -1241.5144653359368, -991.2605601736539, -34.99512355786697, -1092.625407024638, -81.38018795529744, -782.9375949970927, -934.3518958510671, -786.1510011147855, -733.1651464316876, -325.23952617127117, -1150.8874129689857, -49.07789812844599, -325.6119585762939, -1098.4294318674868, -995.5478676756591, -1173.8927782836474, -1099.5283522255795, -50.114902695378575, -571.788835227924, -381.62845550443507, -1363.3761636882796, -1137.8351907492965, -833.1644010212569, -1224.470620653859, -873.1829269667652, -1007.2232820565346, -63.10601450570455, -1258.6823595066026, -1152.7171355622036, -1131.5993362668605, -1366.7265950742349, -909.0536030786906, -194.90089507934212, -748.0492162314423, -377.25591801323407, -487.8077935798055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5671054649748843, "mean_inference_ms": 1.664154052457016, "mean_action_processing_ms": 0.27772373731637295, "mean_env_wait_ms": 3.394396384450971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013815164566040039, "StateBufferConnector_ms": 0.008813142776489258, "ViewRequirementAgentConnector_ms": 0.19028091430664062}, "num_episodes": 27, "episode_return_max": -29.377191305278373, "episode_return_min": -1412.998009560282, "episode_return_mean": -757.2095083540783, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.02859131946167, "num_env_steps_trained_throughput_per_sec": 307.02859131946167, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12658.66, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12658.588, "sample_time_ms": 1121.868, "learn_time_ms": 11461.62, "learn_throughput": 348.991, "synch_weights_time_ms": 74.153}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "07142_00000", "date": "2024-08-04_10-14-07", "timestamp": 1722746647, "time_this_iter_s": 13.04119873046875, "time_total_s": 50.68348813056946, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724415000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.68348813056946, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.678947368421053, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.007457035779953, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.20187916904688, "policy_loss": -0.01011785540516333, "vf_loss": 9.223179894685746, "vf_explained_var": 0.29878760694215695, "kl": 0.016226802880616256, "entropy": 1.442823922013243, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -34.99512355786697, "episode_reward_min": -1412.998009560282, "episode_reward_mean": -794.2306527576852, "episode_len_mean": 128.79, "episode_media": {}, "episodes_timesteps_total": 12879, "policy_reward_min": {"policy_0": -1412.998009560282}, "policy_reward_max": {"policy_0": -34.99512355786697}, "policy_reward_mean": {"policy_0": -794.2306527576852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266.4757922210231, -997.2494416428084, -1145.7602800612012, -895.9734892960589, -992.1011911437683, -120.40794455455476, -428.97896914900554, -829.5649201642487, -900.2122683163753, -1216.5432112668946, -1051.7072653055793, -138.2659445983245, -982.5857076728511, -438.17575211220526, -1173.3660583066633, -1168.8742154703475, -1393.5566840001493, -210.08205224232358, -163.35565138032533, -353.8424681019631, -1309.407312608065, -1291.9906103331602, -1412.998009560282, -169.45983853481815, -1256.4643115049466, -1176.8558191940656, -703.5799025939968, -89.68148074471937, -1092.5973528680083, -1241.5144653359368, -991.2605601736539, -34.99512355786697, -1092.625407024638, -81.38018795529744, -782.9375949970927, -934.3518958510671, -786.1510011147855, -733.1651464316876, -325.23952617127117, -1150.8874129689857, -49.07789812844599, -325.6119585762939, -1098.4294318674868, -995.5478676756591, -1173.8927782836474, -1099.5283522255795, -50.114902695378575, -571.788835227924, -381.62845550443507, -1363.3761636882796, -1137.8351907492965, -833.1644010212569, -1224.470620653859, -873.1829269667652, -1007.2232820565346, -63.10601450570455, -1258.6823595066026, -1152.7171355622036, -1131.5993362668605, -1366.7265950742349, -909.0536030786906, -194.90089507934212, -748.0492162314423, -377.25591801323407, -487.8077935798055, -658.8365082638608, -1160.7994966577476, -440.5378641523096, -1014.9441091962154, -970.3856571314546, -1181.7854432731785, -237.0899760804366, -1130.0666482954787, -1161.2801190182624, -38.09888769989654, -902.258471962643, -1055.5995420368513, -963.2974138929308, -952.5850682868179, -219.35538379629656, -347.36365616923075, -1180.808334016249, -1185.2162919435943, -1151.5145376249554, -96.89098532313243, -461.69391910030475, -132.2520384653883, -290.05938045108417, -315.0738167130427, -710.1779217448044, -1054.0980056093936, -1067.3152291607425, -1074.1711439625371, -1232.0576969332956, -1058.7442229615585, -862.1126098290378, -1260.7395358214253, -1074.392589880785, -1077.8617772647478, -304.2067942988496], "episode_lengths": [79, 150, 150, 150, 150, 71, 106, 138, 150, 150, 150, 80, 150, 150, 150, 150, 150, 75, 94, 87, 150, 150, 150, 56, 150, 150, 150, 49, 150, 150, 150, 36, 150, 68, 150, 150, 150, 150, 87, 150, 60, 105, 150, 150, 150, 150, 54, 109, 123, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 101, 150, 117, 150, 150, 150, 100, 150, 150, 150, 67, 150, 150, 54, 150, 150, 150, 150, 77, 126, 150, 150, 150, 58, 129, 81, 74, 90, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82], "policy_policy_0_reward": [-266.4757922210231, -997.2494416428084, -1145.7602800612012, -895.9734892960589, -992.1011911437683, -120.40794455455476, -428.97896914900554, -829.5649201642487, -900.2122683163753, -1216.5432112668946, -1051.7072653055793, -138.2659445983245, -982.5857076728511, -438.17575211220526, -1173.3660583066633, -1168.8742154703475, -1393.5566840001493, -210.08205224232358, -163.35565138032533, -353.8424681019631, -1309.407312608065, -1291.9906103331602, -1412.998009560282, -169.45983853481815, -1256.4643115049466, -1176.8558191940656, -703.5799025939968, -89.68148074471937, -1092.5973528680083, -1241.5144653359368, -991.2605601736539, -34.99512355786697, -1092.625407024638, -81.38018795529744, -782.9375949970927, -934.3518958510671, -786.1510011147855, -733.1651464316876, -325.23952617127117, -1150.8874129689857, -49.07789812844599, -325.6119585762939, -1098.4294318674868, -995.5478676756591, -1173.8927782836474, -1099.5283522255795, -50.114902695378575, -571.788835227924, -381.62845550443507, -1363.3761636882796, -1137.8351907492965, -833.1644010212569, -1224.470620653859, -873.1829269667652, -1007.2232820565346, -63.10601450570455, -1258.6823595066026, -1152.7171355622036, -1131.5993362668605, -1366.7265950742349, -909.0536030786906, -194.90089507934212, -748.0492162314423, -377.25591801323407, -487.8077935798055, -658.8365082638608, -1160.7994966577476, -440.5378641523096, -1014.9441091962154, -970.3856571314546, -1181.7854432731785, -237.0899760804366, -1130.0666482954787, -1161.2801190182624, -38.09888769989654, -902.258471962643, -1055.5995420368513, -963.2974138929308, -952.5850682868179, -219.35538379629656, -347.36365616923075, -1180.808334016249, -1185.2162919435943, -1151.5145376249554, -96.89098532313243, -461.69391910030475, -132.2520384653883, -290.05938045108417, -315.0738167130427, -710.1779217448044, -1054.0980056093936, -1067.3152291607425, -1074.1711439625371, -1232.0576969332956, -1058.7442229615585, -862.1126098290378, -1260.7395358214253, -1074.392589880785, -1077.8617772647478, -304.2067942988496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5641054177456529, "mean_inference_ms": 1.6693521677506795, "mean_action_processing_ms": 0.2789885103798795, "mean_env_wait_ms": 3.4164743161594373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013668060302734375, "StateBufferConnector_ms": 0.008881807327270508, "ViewRequirementAgentConnector_ms": 0.1934340000152588}, "num_episodes": 35, "episode_return_max": -34.99512355786697, "episode_return_min": -1412.998009560282, "episode_return_mean": -794.2306527576852, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.05385169876524, "num_env_steps_trained_throughput_per_sec": 318.05385169876524, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12642.228, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12642.156, "sample_time_ms": 1115.509, "learn_time_ms": 11454.583, "learn_throughput": 349.205, "synch_weights_time_ms": 71.155}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "07142_00000", "date": "2024-08-04_10-14-20", "timestamp": 1722746660, "time_this_iter_s": 12.58849811553955, "time_total_s": 63.27198624610901, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724414f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.27198624610901, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.533333333333335, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.847483902672927, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.852803352971872, "policy_loss": -0.013701251610958328, "vf_loss": 8.877631700535614, "vf_explained_var": 0.48912762297938267, "kl": 0.019584027724219293, "entropy": 1.5043894634892543, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 0.4738047109370114, "episode_reward_min": -1376.2391896282606, "episode_reward_mean": -734.7802955024835, "episode_len_mean": 126.5, "episode_media": {}, "episodes_timesteps_total": 12650, "policy_reward_min": {"policy_0": -1376.2391896282606}, "policy_reward_max": {"policy_0": 0.4738047109370114}, "policy_reward_mean": {"policy_0": -734.7802955024835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-81.38018795529744, -782.9375949970927, -934.3518958510671, -786.1510011147855, -733.1651464316876, -325.23952617127117, -1150.8874129689857, -49.07789812844599, -325.6119585762939, -1098.4294318674868, -995.5478676756591, -1173.8927782836474, -1099.5283522255795, -50.114902695378575, -571.788835227924, -381.62845550443507, -1363.3761636882796, -1137.8351907492965, -833.1644010212569, -1224.470620653859, -873.1829269667652, -1007.2232820565346, -63.10601450570455, -1258.6823595066026, -1152.7171355622036, -1131.5993362668605, -1366.7265950742349, -909.0536030786906, -194.90089507934212, -748.0492162314423, -377.25591801323407, -487.8077935798055, -658.8365082638608, -1160.7994966577476, -440.5378641523096, -1014.9441091962154, -970.3856571314546, -1181.7854432731785, -237.0899760804366, -1130.0666482954787, -1161.2801190182624, -38.09888769989654, -902.258471962643, -1055.5995420368513, -963.2974138929308, -952.5850682868179, -219.35538379629656, -347.36365616923075, -1180.808334016249, -1185.2162919435943, -1151.5145376249554, -96.89098532313243, -461.69391910030475, -132.2520384653883, -290.05938045108417, -315.0738167130427, -710.1779217448044, -1054.0980056093936, -1067.3152291607425, -1074.1711439625371, -1232.0576969332956, -1058.7442229615585, -862.1126098290378, -1260.7395358214253, -1074.392589880785, -1077.8617772647478, -304.2067942988496, -1106.4248089068817, -511.63651451025777, 0.4738047109370114, -919.4351476784135, -1239.8731473464684, -1099.853742245466, -162.0738102355773, -348.40123689461274, -1094.1677550495683, -237.61679435484547, -338.87196260830996, -24.9050229635634, -941.2058019113487, -1248.1512866694186, -884.3339116384938, -184.98445463747575, -411.8288574446496, -1376.2391896282606, -1048.6887403203154, -1304.0980561221306, -1041.3295350909698, -171.20965240728378, -168.06409775929293, -524.9174907024808, -1214.383872836354, -223.2157542669564, -309.9953969013889, -854.4411706191258, -616.0740237101313, -619.4912344003988, -21.656448413825572, -185.33178191130193, -353.04688004604196], "episode_lengths": [68, 150, 150, 150, 150, 87, 150, 60, 105, 150, 150, 150, 150, 54, 109, 123, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 101, 150, 117, 150, 150, 150, 100, 150, 150, 150, 67, 150, 150, 54, 150, 150, 150, 150, 77, 126, 150, 150, 150, 58, 129, 81, 74, 90, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 38, 150, 150, 150, 81, 138, 150, 97, 150, 39, 150, 150, 150, 83, 106, 150, 150, 150, 150, 85, 76, 147, 150, 69, 78, 150, 150, 150, 38, 78, 89], "policy_policy_0_reward": [-81.38018795529744, -782.9375949970927, -934.3518958510671, -786.1510011147855, -733.1651464316876, -325.23952617127117, -1150.8874129689857, -49.07789812844599, -325.6119585762939, -1098.4294318674868, -995.5478676756591, -1173.8927782836474, -1099.5283522255795, -50.114902695378575, -571.788835227924, -381.62845550443507, -1363.3761636882796, -1137.8351907492965, -833.1644010212569, -1224.470620653859, -873.1829269667652, -1007.2232820565346, -63.10601450570455, -1258.6823595066026, -1152.7171355622036, -1131.5993362668605, -1366.7265950742349, -909.0536030786906, -194.90089507934212, -748.0492162314423, -377.25591801323407, -487.8077935798055, -658.8365082638608, -1160.7994966577476, -440.5378641523096, -1014.9441091962154, -970.3856571314546, -1181.7854432731785, -237.0899760804366, -1130.0666482954787, -1161.2801190182624, -38.09888769989654, -902.258471962643, -1055.5995420368513, -963.2974138929308, -952.5850682868179, -219.35538379629656, -347.36365616923075, -1180.808334016249, -1185.2162919435943, -1151.5145376249554, -96.89098532313243, -461.69391910030475, -132.2520384653883, -290.05938045108417, -315.0738167130427, -710.1779217448044, -1054.0980056093936, -1067.3152291607425, -1074.1711439625371, -1232.0576969332956, -1058.7442229615585, -862.1126098290378, -1260.7395358214253, -1074.392589880785, -1077.8617772647478, -304.2067942988496, -1106.4248089068817, -511.63651451025777, 0.4738047109370114, -919.4351476784135, -1239.8731473464684, -1099.853742245466, -162.0738102355773, -348.40123689461274, -1094.1677550495683, -237.61679435484547, -338.87196260830996, -24.9050229635634, -941.2058019113487, -1248.1512866694186, -884.3339116384938, -184.98445463747575, -411.8288574446496, -1376.2391896282606, -1048.6887403203154, -1304.0980561221306, -1041.3295350909698, -171.20965240728378, -168.06409775929293, -524.9174907024808, -1214.383872836354, -223.2157542669564, -309.9953969013889, -854.4411706191258, -616.0740237101313, -619.4912344003988, -21.656448413825572, -185.33178191130193, -353.04688004604196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.565063648177849, "mean_inference_ms": 1.6773596106915556, "mean_action_processing_ms": 0.2809068247682602, "mean_env_wait_ms": 3.434252976449094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013738632202148438, "StateBufferConnector_ms": 0.008809328079223633, "ViewRequirementAgentConnector_ms": 0.19178986549377441}, "num_episodes": 33, "episode_return_max": 0.4738047109370114, "episode_return_min": -1376.2391896282606, "episode_return_mean": -734.7802955024835, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.81113298944666, "num_env_steps_trained_throughput_per_sec": 302.81113298944666, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12736.784, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12736.714, "sample_time_ms": 1111.505, "learn_time_ms": 11552.794, "learn_throughput": 346.237, "synch_weights_time_ms": 71.533}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "07142_00000", "date": "2024-08-04_10-14-33", "timestamp": 1722746673, "time_this_iter_s": 13.223182201385498, "time_total_s": 76.4951684474945, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724416170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.4951684474945, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.944444444444443, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.54289227500558, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.036853097379208, "policy_loss": -0.016859513161762152, "vf_loss": 9.065898239115874, "vf_explained_var": 0.5495448307444651, "kl": 0.02117638085674117, "entropy": 1.642087627450625, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": 0.4738047109370114, "episode_reward_min": -1376.2391896282606, "episode_reward_mean": -728.4574018533698, "episode_len_mean": 123.32, "episode_media": {}, "episodes_timesteps_total": 12332, "policy_reward_min": {"policy_0": -1376.2391896282606}, "policy_reward_max": {"policy_0": 0.4738047109370114}, "policy_reward_mean": {"policy_0": -728.4574018533698}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-487.8077935798055, -658.8365082638608, -1160.7994966577476, -440.5378641523096, -1014.9441091962154, -970.3856571314546, -1181.7854432731785, -237.0899760804366, -1130.0666482954787, -1161.2801190182624, -38.09888769989654, -902.258471962643, -1055.5995420368513, -963.2974138929308, -952.5850682868179, -219.35538379629656, -347.36365616923075, -1180.808334016249, -1185.2162919435943, -1151.5145376249554, -96.89098532313243, -461.69391910030475, -132.2520384653883, -290.05938045108417, -315.0738167130427, -710.1779217448044, -1054.0980056093936, -1067.3152291607425, -1074.1711439625371, -1232.0576969332956, -1058.7442229615585, -862.1126098290378, -1260.7395358214253, -1074.392589880785, -1077.8617772647478, -304.2067942988496, -1106.4248089068817, -511.63651451025777, 0.4738047109370114, -919.4351476784135, -1239.8731473464684, -1099.853742245466, -162.0738102355773, -348.40123689461274, -1094.1677550495683, -237.61679435484547, -338.87196260830996, -24.9050229635634, -941.2058019113487, -1248.1512866694186, -884.3339116384938, -184.98445463747575, -411.8288574446496, -1376.2391896282606, -1048.6887403203154, -1304.0980561221306, -1041.3295350909698, -171.20965240728378, -168.06409775929293, -524.9174907024808, -1214.383872836354, -223.2157542669564, -309.9953969013889, -854.4411706191258, -616.0740237101313, -619.4912344003988, -21.656448413825572, -185.33178191130193, -353.04688004604196, -1121.0098586726083, -66.7953661014074, -104.60351944676228, -62.05808651295808, -101.70536561055374, -915.4779728877163, -1185.4796902725855, -1070.230302852956, -885.4269985336018, -1261.544137297496, -1345.277941429521, -1248.47777815197, -1273.262785243024, -957.2763096281278, -1147.1089626695305, -1054.7910991200026, -893.996094557864, -131.06225968879468, -1124.9250666667203, -146.39659924080914, -1075.520798385654, -35.10318452531168, -1070.1524994913682, -36.04489122386492, -968.4862087784928, -728.0334360735043, -1025.4878071159994, -38.853648969270296, -1070.4115277132332, -106.3696767806489, -1297.4176655756135], "episode_lengths": [150, 150, 150, 100, 150, 150, 150, 67, 150, 150, 54, 150, 150, 150, 150, 77, 126, 150, 150, 150, 58, 129, 81, 74, 90, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 38, 150, 150, 150, 81, 138, 150, 97, 150, 39, 150, 150, 150, 83, 106, 150, 150, 150, 150, 85, 76, 147, 150, 69, 78, 150, 150, 150, 38, 78, 89, 150, 56, 60, 60, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 92, 150, 42, 150, 36, 150, 145, 150, 42, 150, 51, 150], "policy_policy_0_reward": [-487.8077935798055, -658.8365082638608, -1160.7994966577476, -440.5378641523096, -1014.9441091962154, -970.3856571314546, -1181.7854432731785, -237.0899760804366, -1130.0666482954787, -1161.2801190182624, -38.09888769989654, -902.258471962643, -1055.5995420368513, -963.2974138929308, -952.5850682868179, -219.35538379629656, -347.36365616923075, -1180.808334016249, -1185.2162919435943, -1151.5145376249554, -96.89098532313243, -461.69391910030475, -132.2520384653883, -290.05938045108417, -315.0738167130427, -710.1779217448044, -1054.0980056093936, -1067.3152291607425, -1074.1711439625371, -1232.0576969332956, -1058.7442229615585, -862.1126098290378, -1260.7395358214253, -1074.392589880785, -1077.8617772647478, -304.2067942988496, -1106.4248089068817, -511.63651451025777, 0.4738047109370114, -919.4351476784135, -1239.8731473464684, -1099.853742245466, -162.0738102355773, -348.40123689461274, -1094.1677550495683, -237.61679435484547, -338.87196260830996, -24.9050229635634, -941.2058019113487, -1248.1512866694186, -884.3339116384938, -184.98445463747575, -411.8288574446496, -1376.2391896282606, -1048.6887403203154, -1304.0980561221306, -1041.3295350909698, -171.20965240728378, -168.06409775929293, -524.9174907024808, -1214.383872836354, -223.2157542669564, -309.9953969013889, -854.4411706191258, -616.0740237101313, -619.4912344003988, -21.656448413825572, -185.33178191130193, -353.04688004604196, -1121.0098586726083, -66.7953661014074, -104.60351944676228, -62.05808651295808, -101.70536561055374, -915.4779728877163, -1185.4796902725855, -1070.230302852956, -885.4269985336018, -1261.544137297496, -1345.277941429521, -1248.47777815197, -1273.262785243024, -957.2763096281278, -1147.1089626695305, -1054.7910991200026, -893.996094557864, -131.06225968879468, -1124.9250666667203, -146.39659924080914, -1075.520798385654, -35.10318452531168, -1070.1524994913682, -36.04489122386492, -968.4862087784928, -728.0334360735043, -1025.4878071159994, -38.853648969270296, -1070.4115277132332, -106.3696767806489, -1297.4176655756135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5642512863737174, "mean_inference_ms": 1.6752618075951906, "mean_action_processing_ms": 0.2805350930461645, "mean_env_wait_ms": 3.434504991143803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013363838195800781, "StateBufferConnector_ms": 0.008570671081542969, "ViewRequirementAgentConnector_ms": 0.1930861473083496}, "num_episodes": 31, "episode_return_max": 0.4738047109370114, "episode_return_min": -1376.2391896282606, "episode_return_mean": -728.4574018533698, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.6272380606171, "num_env_steps_trained_throughput_per_sec": 310.6272380606171, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12756.842, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12756.77, "sample_time_ms": 1110.546, "learn_time_ms": 11575.477, "learn_throughput": 345.558, "synch_weights_time_ms": 69.879}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "07142_00000", "date": "2024-08-04_10-14-46", "timestamp": 1722746686, "time_this_iter_s": 12.890146255493164, "time_total_s": 89.38531470298767, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244170a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.38531470298767, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.189473684210526, "ram_util_percent": 28.189473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.321849404399593, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.617483042677243, "policy_loss": -0.013214440856245346, "vf_loss": 8.642377464473247, "vf_explained_var": 0.5482142988592387, "kl": 0.013530366590187744, "entropy": 1.5739120497057835, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 0.4738047109370114, "episode_reward_min": -1468.4973273407422, "episode_reward_mean": -744.8197130741517, "episode_len_mean": 125.54, "episode_media": {}, "episodes_timesteps_total": 12554, "policy_reward_min": {"policy_0": -1468.4973273407422}, "policy_reward_max": {"policy_0": 0.4738047109370114}, "policy_reward_mean": {"policy_0": -744.8197130741517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-862.1126098290378, -1260.7395358214253, -1074.392589880785, -1077.8617772647478, -304.2067942988496, -1106.4248089068817, -511.63651451025777, 0.4738047109370114, -919.4351476784135, -1239.8731473464684, -1099.853742245466, -162.0738102355773, -348.40123689461274, -1094.1677550495683, -237.61679435484547, -338.87196260830996, -24.9050229635634, -941.2058019113487, -1248.1512866694186, -884.3339116384938, -184.98445463747575, -411.8288574446496, -1376.2391896282606, -1048.6887403203154, -1304.0980561221306, -1041.3295350909698, -171.20965240728378, -168.06409775929293, -524.9174907024808, -1214.383872836354, -223.2157542669564, -309.9953969013889, -854.4411706191258, -616.0740237101313, -619.4912344003988, -21.656448413825572, -185.33178191130193, -353.04688004604196, -1121.0098586726083, -66.7953661014074, -104.60351944676228, -62.05808651295808, -101.70536561055374, -915.4779728877163, -1185.4796902725855, -1070.230302852956, -885.4269985336018, -1261.544137297496, -1345.277941429521, -1248.47777815197, -1273.262785243024, -957.2763096281278, -1147.1089626695305, -1054.7910991200026, -893.996094557864, -131.06225968879468, -1124.9250666667203, -146.39659924080914, -1075.520798385654, -35.10318452531168, -1070.1524994913682, -36.04489122386492, -968.4862087784928, -728.0334360735043, -1025.4878071159994, -38.853648969270296, -1070.4115277132332, -106.3696767806489, -1297.4176655756135, -1204.106490744933, -800.976040110089, -1268.5887056898628, -25.860956333153798, -1430.2404966289703, -976.0053686736642, -1032.703080071904, -700.6789143830438, -862.9551076306171, -762.1908868497684, -580.4320230088249, -135.84966854059655, -827.3082025231657, -204.6910681217101, -1145.7149657101445, -935.9247560582864, -704.1905072408006, -1023.6073457300851, -868.2811236370034, -257.81339131317236, -376.57644031896865, -627.423913354289, -1380.7044025939833, -916.1742234687571, -1082.7684037580623, -1128.762842211896, -1468.4973273407422, -560.1913399929176, -384.5616449405915, -645.3932623477345, -1249.2237862539305], "episode_lengths": [150, 150, 150, 150, 82, 150, 150, 38, 150, 150, 150, 81, 138, 150, 97, 150, 39, 150, 150, 150, 83, 106, 150, 150, 150, 150, 85, 76, 147, 150, 69, 78, 150, 150, 150, 38, 78, 89, 150, 56, 60, 60, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 92, 150, 42, 150, 36, 150, 145, 150, 42, 150, 51, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 124, 52, 150, 101, 150, 150, 128, 150, 150, 107, 123, 135, 150, 150, 150, 150, 150, 150, 96, 150, 150], "policy_policy_0_reward": [-862.1126098290378, -1260.7395358214253, -1074.392589880785, -1077.8617772647478, -304.2067942988496, -1106.4248089068817, -511.63651451025777, 0.4738047109370114, -919.4351476784135, -1239.8731473464684, -1099.853742245466, -162.0738102355773, -348.40123689461274, -1094.1677550495683, -237.61679435484547, -338.87196260830996, -24.9050229635634, -941.2058019113487, -1248.1512866694186, -884.3339116384938, -184.98445463747575, -411.8288574446496, -1376.2391896282606, -1048.6887403203154, -1304.0980561221306, -1041.3295350909698, -171.20965240728378, -168.06409775929293, -524.9174907024808, -1214.383872836354, -223.2157542669564, -309.9953969013889, -854.4411706191258, -616.0740237101313, -619.4912344003988, -21.656448413825572, -185.33178191130193, -353.04688004604196, -1121.0098586726083, -66.7953661014074, -104.60351944676228, -62.05808651295808, -101.70536561055374, -915.4779728877163, -1185.4796902725855, -1070.230302852956, -885.4269985336018, -1261.544137297496, -1345.277941429521, -1248.47777815197, -1273.262785243024, -957.2763096281278, -1147.1089626695305, -1054.7910991200026, -893.996094557864, -131.06225968879468, -1124.9250666667203, -146.39659924080914, -1075.520798385654, -35.10318452531168, -1070.1524994913682, -36.04489122386492, -968.4862087784928, -728.0334360735043, -1025.4878071159994, -38.853648969270296, -1070.4115277132332, -106.3696767806489, -1297.4176655756135, -1204.106490744933, -800.976040110089, -1268.5887056898628, -25.860956333153798, -1430.2404966289703, -976.0053686736642, -1032.703080071904, -700.6789143830438, -862.9551076306171, -762.1908868497684, -580.4320230088249, -135.84966854059655, -827.3082025231657, -204.6910681217101, -1145.7149657101445, -935.9247560582864, -704.1905072408006, -1023.6073457300851, -868.2811236370034, -257.81339131317236, -376.57644031896865, -627.423913354289, -1380.7044025939833, -916.1742234687571, -1082.7684037580623, -1128.762842211896, -1468.4973273407422, -560.1913399929176, -384.5616449405915, -645.3932623477345, -1249.2237862539305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627234729791802, "mean_inference_ms": 1.6722087751731025, "mean_action_processing_ms": 0.27992512648230977, "mean_env_wait_ms": 3.4389953496844554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013210296630859375, "StateBufferConnector_ms": 0.008322954177856445, "ViewRequirementAgentConnector_ms": 0.19295740127563477}, "num_episodes": 31, "episode_return_max": 0.4738047109370114, "episode_return_min": -1468.4973273407422, "episode_return_mean": -744.8197130741517, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.471616011991, "num_env_steps_trained_throughput_per_sec": 334.471616011991, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12657.133, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12657.063, "sample_time_ms": 1111.888, "learn_time_ms": 11474.857, "learn_throughput": 348.588, "synch_weights_time_ms": 69.463}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "07142_00000", "date": "2024-08-04_10-14-58", "timestamp": 1722746698, "time_this_iter_s": 11.971588611602783, "time_total_s": 101.35690331459045, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724417eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.35690331459045, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.288235294117644, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.811821597069503, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.02263927658399, "policy_loss": -0.014208486792631448, "vf_loss": 8.046735976139704, "vf_explained_var": 0.5776162398979068, "kl": 0.016217462016023407, "entropy": 1.4753439043958982, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -21.656448413825572, "episode_reward_min": -1468.4973273407422, "episode_reward_mean": -768.0842952317033, "episode_len_mean": 127.83, "episode_media": {}, "episodes_timesteps_total": 12783, "policy_reward_min": {"policy_0": -1468.4973273407422}, "policy_reward_max": {"policy_0": -21.656448413825572}, "policy_reward_mean": {"policy_0": -768.0842952317033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-854.4411706191258, -616.0740237101313, -619.4912344003988, -21.656448413825572, -185.33178191130193, -353.04688004604196, -1121.0098586726083, -66.7953661014074, -104.60351944676228, -62.05808651295808, -101.70536561055374, -915.4779728877163, -1185.4796902725855, -1070.230302852956, -885.4269985336018, -1261.544137297496, -1345.277941429521, -1248.47777815197, -1273.262785243024, -957.2763096281278, -1147.1089626695305, -1054.7910991200026, -893.996094557864, -131.06225968879468, -1124.9250666667203, -146.39659924080914, -1075.520798385654, -35.10318452531168, -1070.1524994913682, -36.04489122386492, -968.4862087784928, -728.0334360735043, -1025.4878071159994, -38.853648969270296, -1070.4115277132332, -106.3696767806489, -1297.4176655756135, -1204.106490744933, -800.976040110089, -1268.5887056898628, -25.860956333153798, -1430.2404966289703, -976.0053686736642, -1032.703080071904, -700.6789143830438, -862.9551076306171, -762.1908868497684, -580.4320230088249, -135.84966854059655, -827.3082025231657, -204.6910681217101, -1145.7149657101445, -935.9247560582864, -704.1905072408006, -1023.6073457300851, -868.2811236370034, -257.81339131317236, -376.57644031896865, -627.423913354289, -1380.7044025939833, -916.1742234687571, -1082.7684037580623, -1128.762842211896, -1468.4973273407422, -560.1913399929176, -384.5616449405915, -645.3932623477345, -1249.2237862539305, -875.7298080534835, -1333.2958046354438, -277.74627066546594, -739.5418962977218, -288.70372967400976, -1241.7076190314804, -309.76254083305827, -989.7612626810221, -707.4064354112892, -213.6342995119889, -1181.1539976563183, -1085.9062236267239, -308.5210913203991, -1102.9913667450448, -970.9589808982992, -917.487492709466, -1368.6320038225497, -79.03635663932431, -1062.8588228568328, -773.231490259661, -1062.5320948763924, -792.8057222680185, -866.0249795731899, -600.0849058485313, -1211.3067102492223, -67.79508602837659, -48.939369985785206, -1218.8473394784664, -1197.574887299729, -582.0256901907743, -1035.6829517943763, -529.5165283474244], "episode_lengths": [150, 150, 150, 38, 78, 89, 150, 56, 60, 60, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 92, 150, 42, 150, 36, 150, 145, 150, 42, 150, 51, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 124, 52, 150, 101, 150, 150, 128, 150, 150, 107, 123, 135, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 102, 150, 128, 150, 121, 150, 150, 82, 150, 150, 78, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 53, 37, 150, 150, 150, 150, 102], "policy_policy_0_reward": [-854.4411706191258, -616.0740237101313, -619.4912344003988, -21.656448413825572, -185.33178191130193, -353.04688004604196, -1121.0098586726083, -66.7953661014074, -104.60351944676228, -62.05808651295808, -101.70536561055374, -915.4779728877163, -1185.4796902725855, -1070.230302852956, -885.4269985336018, -1261.544137297496, -1345.277941429521, -1248.47777815197, -1273.262785243024, -957.2763096281278, -1147.1089626695305, -1054.7910991200026, -893.996094557864, -131.06225968879468, -1124.9250666667203, -146.39659924080914, -1075.520798385654, -35.10318452531168, -1070.1524994913682, -36.04489122386492, -968.4862087784928, -728.0334360735043, -1025.4878071159994, -38.853648969270296, -1070.4115277132332, -106.3696767806489, -1297.4176655756135, -1204.106490744933, -800.976040110089, -1268.5887056898628, -25.860956333153798, -1430.2404966289703, -976.0053686736642, -1032.703080071904, -700.6789143830438, -862.9551076306171, -762.1908868497684, -580.4320230088249, -135.84966854059655, -827.3082025231657, -204.6910681217101, -1145.7149657101445, -935.9247560582864, -704.1905072408006, -1023.6073457300851, -868.2811236370034, -257.81339131317236, -376.57644031896865, -627.423913354289, -1380.7044025939833, -916.1742234687571, -1082.7684037580623, -1128.762842211896, -1468.4973273407422, -560.1913399929176, -384.5616449405915, -645.3932623477345, -1249.2237862539305, -875.7298080534835, -1333.2958046354438, -277.74627066546594, -739.5418962977218, -288.70372967400976, -1241.7076190314804, -309.76254083305827, -989.7612626810221, -707.4064354112892, -213.6342995119889, -1181.1539976563183, -1085.9062236267239, -308.5210913203991, -1102.9913667450448, -970.9589808982992, -917.487492709466, -1368.6320038225497, -79.03635663932431, -1062.8588228568328, -773.231490259661, -1062.5320948763924, -792.8057222680185, -866.0249795731899, -600.0849058485313, -1211.3067102492223, -67.79508602837659, -48.939369985785206, -1218.8473394784664, -1197.574887299729, -582.0256901907743, -1035.6829517943763, -529.5165283474244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5605972009013456, "mean_inference_ms": 1.6701740380496342, "mean_action_processing_ms": 0.27899763689196055, "mean_env_wait_ms": 3.448904758341824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012689590454101562, "StateBufferConnector_ms": 0.00805354118347168, "ViewRequirementAgentConnector_ms": 0.1928248405456543}, "num_episodes": 32, "episode_return_max": -21.656448413825572, "episode_return_min": -1468.4973273407422, "episode_return_mean": -768.0842952317033, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 528.8379565160022, "num_env_steps_trained_throughput_per_sec": 528.8379565160022, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12091.204, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12091.133, "sample_time_ms": 1113.245, "learn_time_ms": 10910.264, "learn_throughput": 366.627, "synch_weights_time_ms": 66.781}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "07142_00000", "date": "2024-08-04_10-15-05", "timestamp": 1722746705, "time_this_iter_s": 7.576616048812866, "time_total_s": 108.93351936340332, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724417e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 108.93351936340332, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.57272727272727, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.650904849668343, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.5622305398186045, "policy_loss": -0.015143177689121027, "vf_loss": 7.585882408420245, "vf_explained_var": 0.7004054705922802, "kl": 0.01675039145681391, "entropy": 1.3533806861688693, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -25.860956333153798, "episode_reward_min": -1468.4973273407422, "episode_reward_mean": -779.6938394419029, "episode_len_mean": 132.63, "episode_media": {}, "episodes_timesteps_total": 13263, "policy_reward_min": {"policy_0": -1468.4973273407422}, "policy_reward_max": {"policy_0": -25.860956333153798}, "policy_reward_mean": {"policy_0": -779.6938394419029}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.10318452531168, -1070.1524994913682, -36.04489122386492, -968.4862087784928, -728.0334360735043, -1025.4878071159994, -38.853648969270296, -1070.4115277132332, -106.3696767806489, -1297.4176655756135, -1204.106490744933, -800.976040110089, -1268.5887056898628, -25.860956333153798, -1430.2404966289703, -976.0053686736642, -1032.703080071904, -700.6789143830438, -862.9551076306171, -762.1908868497684, -580.4320230088249, -135.84966854059655, -827.3082025231657, -204.6910681217101, -1145.7149657101445, -935.9247560582864, -704.1905072408006, -1023.6073457300851, -868.2811236370034, -257.81339131317236, -376.57644031896865, -627.423913354289, -1380.7044025939833, -916.1742234687571, -1082.7684037580623, -1128.762842211896, -1468.4973273407422, -560.1913399929176, -384.5616449405915, -645.3932623477345, -1249.2237862539305, -875.7298080534835, -1333.2958046354438, -277.74627066546594, -739.5418962977218, -288.70372967400976, -1241.7076190314804, -309.76254083305827, -989.7612626810221, -707.4064354112892, -213.6342995119889, -1181.1539976563183, -1085.9062236267239, -308.5210913203991, -1102.9913667450448, -970.9589808982992, -917.487492709466, -1368.6320038225497, -79.03635663932431, -1062.8588228568328, -773.231490259661, -1062.5320948763924, -792.8057222680185, -866.0249795731899, -600.0849058485313, -1211.3067102492223, -67.79508602837659, -48.939369985785206, -1218.8473394784664, -1197.574887299729, -582.0256901907743, -1035.6829517943763, -529.5165283474244, -922.2513526268369, -336.9108624687286, -1097.4242151733124, -567.9770654185444, -856.8441337889647, -620.4180001683133, -1001.5681682756627, -964.9435579773515, -831.2087864629486, -797.4521459043921, -1153.8937414711027, -966.0960591524553, -898.9740357785713, -1110.3071611104963, -695.9734804139131, -868.5968811990886, -403.2645082351487, -29.157792088777054, -981.0081173010311, -914.1389448909031, -355.4489509071869, -950.9443017438163, -869.7344638241643, -1003.9823488593553, -827.2686256359583, -733.8222383115508, -223.8130139028777], "episode_lengths": [42, 150, 36, 150, 145, 150, 42, 150, 51, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 124, 52, 150, 101, 150, 150, 128, 150, 150, 107, 123, 135, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 102, 150, 128, 150, 121, 150, 150, 82, 150, 150, 78, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 53, 37, 150, 150, 150, 150, 102, 150, 107, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 51, 150, 150, 115, 150, 150, 150, 150, 150, 106], "policy_policy_0_reward": [-35.10318452531168, -1070.1524994913682, -36.04489122386492, -968.4862087784928, -728.0334360735043, -1025.4878071159994, -38.853648969270296, -1070.4115277132332, -106.3696767806489, -1297.4176655756135, -1204.106490744933, -800.976040110089, -1268.5887056898628, -25.860956333153798, -1430.2404966289703, -976.0053686736642, -1032.703080071904, -700.6789143830438, -862.9551076306171, -762.1908868497684, -580.4320230088249, -135.84966854059655, -827.3082025231657, -204.6910681217101, -1145.7149657101445, -935.9247560582864, -704.1905072408006, -1023.6073457300851, -868.2811236370034, -257.81339131317236, -376.57644031896865, -627.423913354289, -1380.7044025939833, -916.1742234687571, -1082.7684037580623, -1128.762842211896, -1468.4973273407422, -560.1913399929176, -384.5616449405915, -645.3932623477345, -1249.2237862539305, -875.7298080534835, -1333.2958046354438, -277.74627066546594, -739.5418962977218, -288.70372967400976, -1241.7076190314804, -309.76254083305827, -989.7612626810221, -707.4064354112892, -213.6342995119889, -1181.1539976563183, -1085.9062236267239, -308.5210913203991, -1102.9913667450448, -970.9589808982992, -917.487492709466, -1368.6320038225497, -79.03635663932431, -1062.8588228568328, -773.231490259661, -1062.5320948763924, -792.8057222680185, -866.0249795731899, -600.0849058485313, -1211.3067102492223, -67.79508602837659, -48.939369985785206, -1218.8473394784664, -1197.574887299729, -582.0256901907743, -1035.6829517943763, -529.5165283474244, -922.2513526268369, -336.9108624687286, -1097.4242151733124, -567.9770654185444, -856.8441337889647, -620.4180001683133, -1001.5681682756627, -964.9435579773515, -831.2087864629486, -797.4521459043921, -1153.8937414711027, -966.0960591524553, -898.9740357785713, -1110.3071611104963, -695.9734804139131, -868.5968811990886, -403.2645082351487, -29.157792088777054, -981.0081173010311, -914.1389448909031, -355.4489509071869, -950.9443017438163, -869.7344638241643, -1003.9823488593553, -827.2686256359583, -733.8222383115508, -223.8130139028777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5586374364994662, "mean_inference_ms": 1.6676528367346137, "mean_action_processing_ms": 0.27814560631669344, "mean_env_wait_ms": 3.4479719461835363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012428045272827148, "StateBufferConnector_ms": 0.007918119430541992, "ViewRequirementAgentConnector_ms": 0.18943452835083008}, "num_episodes": 27, "episode_return_max": -25.860956333153798, "episode_return_min": -1468.4973273407422, "episode_return_mean": -779.6938394419029, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.9114182218374, "num_env_steps_trained_throughput_per_sec": 306.9114182218374, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12185.392, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12185.321, "sample_time_ms": 1112.507, "learn_time_ms": 11004.535, "learn_throughput": 363.486, "synch_weights_time_ms": 67.432}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "07142_00000", "date": "2024-08-04_10-15-19", "timestamp": 1722746719, "time_this_iter_s": 13.045063257217407, "time_total_s": 121.97858262062073, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724416dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 121.97858262062073, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.772222222222222, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.24539942095677, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.343195830782254, "policy_loss": -0.008058811576726535, "vf_loss": 7.362320283552011, "vf_explained_var": 0.7198917192096511, "kl": 0.015037412180572574, "entropy": 1.5576850858827431, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -14.16240574205189, "episode_reward_min": -1468.4973273407422, "episode_reward_mean": -799.0627380754287, "episode_len_mean": 136.31, "episode_media": {}, "episodes_timesteps_total": 13631, "policy_reward_min": {"policy_0": -1468.4973273407422}, "policy_reward_max": {"policy_0": -14.16240574205189}, "policy_reward_mean": {"policy_0": -799.0627380754287}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-627.423913354289, -1380.7044025939833, -916.1742234687571, -1082.7684037580623, -1128.762842211896, -1468.4973273407422, -560.1913399929176, -384.5616449405915, -645.3932623477345, -1249.2237862539305, -875.7298080534835, -1333.2958046354438, -277.74627066546594, -739.5418962977218, -288.70372967400976, -1241.7076190314804, -309.76254083305827, -989.7612626810221, -707.4064354112892, -213.6342995119889, -1181.1539976563183, -1085.9062236267239, -308.5210913203991, -1102.9913667450448, -970.9589808982992, -917.487492709466, -1368.6320038225497, -79.03635663932431, -1062.8588228568328, -773.231490259661, -1062.5320948763924, -792.8057222680185, -866.0249795731899, -600.0849058485313, -1211.3067102492223, -67.79508602837659, -48.939369985785206, -1218.8473394784664, -1197.574887299729, -582.0256901907743, -1035.6829517943763, -529.5165283474244, -922.2513526268369, -336.9108624687286, -1097.4242151733124, -567.9770654185444, -856.8441337889647, -620.4180001683133, -1001.5681682756627, -964.9435579773515, -831.2087864629486, -797.4521459043921, -1153.8937414711027, -966.0960591524553, -898.9740357785713, -1110.3071611104963, -695.9734804139131, -868.5968811990886, -403.2645082351487, -29.157792088777054, -981.0081173010311, -914.1389448909031, -355.4489509071869, -950.9443017438163, -869.7344638241643, -1003.9823488593553, -827.2686256359583, -733.8222383115508, -223.8130139028777, -646.0551712858659, -1058.2508412393092, -1121.2986112506303, -987.7292069016868, -633.5677802400131, -1050.6068768164964, -490.3226443186251, -1253.5376333450313, -377.60895443916775, -22.477849034807253, -880.5361873322579, -1330.0111365629991, -640.500701349137, -1008.3218229518587, -1036.7249935664868, -912.562176715097, -680.239689257256, -577.95349935099, -947.1194289200577, -672.7582025439816, -602.3322874086211, -1213.3234473078594, -703.3278540453746, -294.6399808451918, -1261.8959707363297, -1178.938713541608, -14.16240574205189, -70.2445397484268, -1055.5655053918317, -784.6699246020985, -930.661912127489], "episode_lengths": [135, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 102, 150, 128, 150, 121, 150, 150, 82, 150, 150, 78, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 53, 37, 150, 150, 150, 150, 102, 150, 107, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 51, 150, 150, 115, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 90, 43, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 97, 150, 150, 37, 66, 150, 150, 150], "policy_policy_0_reward": [-627.423913354289, -1380.7044025939833, -916.1742234687571, -1082.7684037580623, -1128.762842211896, -1468.4973273407422, -560.1913399929176, -384.5616449405915, -645.3932623477345, -1249.2237862539305, -875.7298080534835, -1333.2958046354438, -277.74627066546594, -739.5418962977218, -288.70372967400976, -1241.7076190314804, -309.76254083305827, -989.7612626810221, -707.4064354112892, -213.6342995119889, -1181.1539976563183, -1085.9062236267239, -308.5210913203991, -1102.9913667450448, -970.9589808982992, -917.487492709466, -1368.6320038225497, -79.03635663932431, -1062.8588228568328, -773.231490259661, -1062.5320948763924, -792.8057222680185, -866.0249795731899, -600.0849058485313, -1211.3067102492223, -67.79508602837659, -48.939369985785206, -1218.8473394784664, -1197.574887299729, -582.0256901907743, -1035.6829517943763, -529.5165283474244, -922.2513526268369, -336.9108624687286, -1097.4242151733124, -567.9770654185444, -856.8441337889647, -620.4180001683133, -1001.5681682756627, -964.9435579773515, -831.2087864629486, -797.4521459043921, -1153.8937414711027, -966.0960591524553, -898.9740357785713, -1110.3071611104963, -695.9734804139131, -868.5968811990886, -403.2645082351487, -29.157792088777054, -981.0081173010311, -914.1389448909031, -355.4489509071869, -950.9443017438163, -869.7344638241643, -1003.9823488593553, -827.2686256359583, -733.8222383115508, -223.8130139028777, -646.0551712858659, -1058.2508412393092, -1121.2986112506303, -987.7292069016868, -633.5677802400131, -1050.6068768164964, -490.3226443186251, -1253.5376333450313, -377.60895443916775, -22.477849034807253, -880.5361873322579, -1330.0111365629991, -640.500701349137, -1008.3218229518587, -1036.7249935664868, -912.562176715097, -680.239689257256, -577.95349935099, -947.1194289200577, -672.7582025439816, -602.3322874086211, -1213.3234473078594, -703.3278540453746, -294.6399808451918, -1261.8959707363297, -1178.938713541608, -14.16240574205189, -70.2445397484268, -1055.5655053918317, -784.6699246020985, -930.661912127489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557107777301092, "mean_inference_ms": 1.6680907902160922, "mean_action_processing_ms": 0.2775795527640146, "mean_env_wait_ms": 3.453317585580889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0122528076171875, "StateBufferConnector_ms": 0.007900476455688477, "ViewRequirementAgentConnector_ms": 0.19282007217407227}, "num_episodes": 31, "episode_return_max": -14.16240574205189, "episode_return_min": -1468.4973273407422, "episode_return_mean": -799.0627380754287, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.44682252751164, "num_env_steps_trained_throughput_per_sec": 307.44682252751164, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12207.587, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12207.513, "sample_time_ms": 1113.724, "learn_time_ms": 11023.653, "learn_throughput": 362.856, "synch_weights_time_ms": 69.293}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "07142_00000", "date": "2024-08-04_10-15-32", "timestamp": 1722746732, "time_this_iter_s": 13.023987293243408, "time_total_s": 135.00256991386414, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244140d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.00256991386414, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.34736842105263, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.74912324349086, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.458005785942078, "policy_loss": -0.009990755034959876, "vf_loss": 6.477970909078916, "vf_explained_var": 0.7493109701822201, "kl": 0.016718861899547254, "entropy": 1.499004015699029, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -14.16240574205189, "episode_reward_min": -1485.9339679467637, "episode_reward_mean": -785.4277232193804, "episode_len_mean": 133.69, "episode_media": {}, "episodes_timesteps_total": 13369, "policy_reward_min": {"policy_0": -1485.9339679467637}, "policy_reward_max": {"policy_0": -14.16240574205189}, "policy_reward_mean": {"policy_0": -785.4277232193804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-773.231490259661, -1062.5320948763924, -792.8057222680185, -866.0249795731899, -600.0849058485313, -1211.3067102492223, -67.79508602837659, -48.939369985785206, -1218.8473394784664, -1197.574887299729, -582.0256901907743, -1035.6829517943763, -529.5165283474244, -922.2513526268369, -336.9108624687286, -1097.4242151733124, -567.9770654185444, -856.8441337889647, -620.4180001683133, -1001.5681682756627, -964.9435579773515, -831.2087864629486, -797.4521459043921, -1153.8937414711027, -966.0960591524553, -898.9740357785713, -1110.3071611104963, -695.9734804139131, -868.5968811990886, -403.2645082351487, -29.157792088777054, -981.0081173010311, -914.1389448909031, -355.4489509071869, -950.9443017438163, -869.7344638241643, -1003.9823488593553, -827.2686256359583, -733.8222383115508, -223.8130139028777, -646.0551712858659, -1058.2508412393092, -1121.2986112506303, -987.7292069016868, -633.5677802400131, -1050.6068768164964, -490.3226443186251, -1253.5376333450313, -377.60895443916775, -22.477849034807253, -880.5361873322579, -1330.0111365629991, -640.500701349137, -1008.3218229518587, -1036.7249935664868, -912.562176715097, -680.239689257256, -577.95349935099, -947.1194289200577, -672.7582025439816, -602.3322874086211, -1213.3234473078594, -703.3278540453746, -294.6399808451918, -1261.8959707363297, -1178.938713541608, -14.16240574205189, -70.2445397484268, -1055.5655053918317, -784.6699246020985, -930.661912127489, -1053.828674826675, -1480.3129420069943, -31.308654119916522, -964.0252453883553, -972.1058216312529, -181.28552331237532, -1103.7986874075964, -350.01231603326016, -523.3293029650055, -130.66600899693387, -282.3379347494003, -636.9425730919138, -885.4895971734422, -1428.8765082751033, -461.8633888367382, -1352.3924140994052, -687.4089881841302, -1315.062416020321, -49.46571335606167, -383.89254457488516, -776.8926045227433, -993.4662762032181, -901.7917016679392, -809.6389238194652, -1195.279755050199, -946.0956963905006, -333.9760380399194, -1485.9339679467637, -1417.555445037482], "episode_lengths": [150, 150, 150, 150, 150, 150, 53, 37, 150, 150, 150, 150, 102, 150, 107, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 51, 150, 150, 115, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 90, 43, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 97, 150, 150, 37, 66, 150, 150, 150, 150, 150, 43, 150, 150, 69, 150, 92, 116, 80, 80, 119, 150, 150, 150, 150, 150, 150, 55, 88, 150, 150, 150, 150, 150, 150, 83, 150, 150], "policy_policy_0_reward": [-773.231490259661, -1062.5320948763924, -792.8057222680185, -866.0249795731899, -600.0849058485313, -1211.3067102492223, -67.79508602837659, -48.939369985785206, -1218.8473394784664, -1197.574887299729, -582.0256901907743, -1035.6829517943763, -529.5165283474244, -922.2513526268369, -336.9108624687286, -1097.4242151733124, -567.9770654185444, -856.8441337889647, -620.4180001683133, -1001.5681682756627, -964.9435579773515, -831.2087864629486, -797.4521459043921, -1153.8937414711027, -966.0960591524553, -898.9740357785713, -1110.3071611104963, -695.9734804139131, -868.5968811990886, -403.2645082351487, -29.157792088777054, -981.0081173010311, -914.1389448909031, -355.4489509071869, -950.9443017438163, -869.7344638241643, -1003.9823488593553, -827.2686256359583, -733.8222383115508, -223.8130139028777, -646.0551712858659, -1058.2508412393092, -1121.2986112506303, -987.7292069016868, -633.5677802400131, -1050.6068768164964, -490.3226443186251, -1253.5376333450313, -377.60895443916775, -22.477849034807253, -880.5361873322579, -1330.0111365629991, -640.500701349137, -1008.3218229518587, -1036.7249935664868, -912.562176715097, -680.239689257256, -577.95349935099, -947.1194289200577, -672.7582025439816, -602.3322874086211, -1213.3234473078594, -703.3278540453746, -294.6399808451918, -1261.8959707363297, -1178.938713541608, -14.16240574205189, -70.2445397484268, -1055.5655053918317, -784.6699246020985, -930.661912127489, -1053.828674826675, -1480.3129420069943, -31.308654119916522, -964.0252453883553, -972.1058216312529, -181.28552331237532, -1103.7986874075964, -350.01231603326016, -523.3293029650055, -130.66600899693387, -282.3379347494003, -636.9425730919138, -885.4895971734422, -1428.8765082751033, -461.8633888367382, -1352.3924140994052, -687.4089881841302, -1315.062416020321, -49.46571335606167, -383.89254457488516, -776.8926045227433, -993.4662762032181, -901.7917016679392, -809.6389238194652, -1195.279755050199, -946.0956963905006, -333.9760380399194, -1485.9339679467637, -1417.555445037482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559505642434555, "mean_inference_ms": 1.6668047547929867, "mean_action_processing_ms": 0.27690719660269414, "mean_env_wait_ms": 3.4495951655504014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012354612350463867, "StateBufferConnector_ms": 0.00794219970703125, "ViewRequirementAgentConnector_ms": 0.1929469108581543}, "num_episodes": 29, "episode_return_max": -14.16240574205189, "episode_return_min": -1485.9339679467637, "episode_return_mean": -785.4277232193804, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.43261263084577, "num_env_steps_trained_throughput_per_sec": 310.43261263084577, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12249.35, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12249.271, "sample_time_ms": 1113.872, "learn_time_ms": 11066.162, "learn_throughput": 361.462, "synch_weights_time_ms": 68.385}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "07142_00000", "date": "2024-08-04_10-15-45", "timestamp": 1722746745, "time_this_iter_s": 12.897684097290039, "time_total_s": 147.90025401115417, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244157e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 147.90025401115417, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.861111111111114, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.36487499872844, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.219244761765003, "policy_loss": -0.012745414627715945, "vf_loss": 6.2423883880178135, "vf_explained_var": 0.8282058877870441, "kl": 0.01797216185004801, "entropy": 1.578986281901598, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -1.9050020515913928, "episode_reward_min": -1485.9339679467637, "episode_reward_mean": -779.6377576884079, "episode_len_mean": 132.95, "episode_media": {}, "episodes_timesteps_total": 13295, "policy_reward_min": {"policy_0": -1485.9339679467637}, "policy_reward_max": {"policy_0": -1.9050020515913928}, "policy_reward_mean": {"policy_0": -779.6377576884079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.157792088777054, -981.0081173010311, -914.1389448909031, -355.4489509071869, -950.9443017438163, -869.7344638241643, -1003.9823488593553, -827.2686256359583, -733.8222383115508, -223.8130139028777, -646.0551712858659, -1058.2508412393092, -1121.2986112506303, -987.7292069016868, -633.5677802400131, -1050.6068768164964, -490.3226443186251, -1253.5376333450313, -377.60895443916775, -22.477849034807253, -880.5361873322579, -1330.0111365629991, -640.500701349137, -1008.3218229518587, -1036.7249935664868, -912.562176715097, -680.239689257256, -577.95349935099, -947.1194289200577, -672.7582025439816, -602.3322874086211, -1213.3234473078594, -703.3278540453746, -294.6399808451918, -1261.8959707363297, -1178.938713541608, -14.16240574205189, -70.2445397484268, -1055.5655053918317, -784.6699246020985, -930.661912127489, -1053.828674826675, -1480.3129420069943, -31.308654119916522, -964.0252453883553, -972.1058216312529, -181.28552331237532, -1103.7986874075964, -350.01231603326016, -523.3293029650055, -130.66600899693387, -282.3379347494003, -636.9425730919138, -885.4895971734422, -1428.8765082751033, -461.8633888367382, -1352.3924140994052, -687.4089881841302, -1315.062416020321, -49.46571335606167, -383.89254457488516, -776.8926045227433, -993.4662762032181, -901.7917016679392, -809.6389238194652, -1195.279755050199, -946.0956963905006, -333.9760380399194, -1485.9339679467637, -1417.555445037482, -474.0449202375401, -162.21734105928775, -832.3240655140337, -874.06179127283, -987.906588848219, -779.0184310081931, -765.0086337337121, -1.9050020515913928, -1180.8782997548894, -1064.277143765872, -879.5499887000132, -440.8479772347793, -1012.136430037283, -407.86808128183725, -519.9957959632818, -812.3575690880879, -585.7731925591377, -969.4772506633368, -949.7614905361878, -178.88452085572635, -957.5466823904735, -906.590925194045, -1015.6832828876427, -715.9106371345543, -1134.0002692808253, -1315.571050285812, -1255.1037357647454, -292.47938061943637, -925.7200673223176, -1104.574813682855], "episode_lengths": [51, 150, 150, 115, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 90, 43, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 97, 150, 150, 37, 66, 150, 150, 150, 150, 150, 43, 150, 150, 69, 150, 92, 116, 80, 80, 119, 150, 150, 150, 150, 150, 150, 55, 88, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 70, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 110, 112, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150], "policy_policy_0_reward": [-29.157792088777054, -981.0081173010311, -914.1389448909031, -355.4489509071869, -950.9443017438163, -869.7344638241643, -1003.9823488593553, -827.2686256359583, -733.8222383115508, -223.8130139028777, -646.0551712858659, -1058.2508412393092, -1121.2986112506303, -987.7292069016868, -633.5677802400131, -1050.6068768164964, -490.3226443186251, -1253.5376333450313, -377.60895443916775, -22.477849034807253, -880.5361873322579, -1330.0111365629991, -640.500701349137, -1008.3218229518587, -1036.7249935664868, -912.562176715097, -680.239689257256, -577.95349935099, -947.1194289200577, -672.7582025439816, -602.3322874086211, -1213.3234473078594, -703.3278540453746, -294.6399808451918, -1261.8959707363297, -1178.938713541608, -14.16240574205189, -70.2445397484268, -1055.5655053918317, -784.6699246020985, -930.661912127489, -1053.828674826675, -1480.3129420069943, -31.308654119916522, -964.0252453883553, -972.1058216312529, -181.28552331237532, -1103.7986874075964, -350.01231603326016, -523.3293029650055, -130.66600899693387, -282.3379347494003, -636.9425730919138, -885.4895971734422, -1428.8765082751033, -461.8633888367382, -1352.3924140994052, -687.4089881841302, -1315.062416020321, -49.46571335606167, -383.89254457488516, -776.8926045227433, -993.4662762032181, -901.7917016679392, -809.6389238194652, -1195.279755050199, -946.0956963905006, -333.9760380399194, -1485.9339679467637, -1417.555445037482, -474.0449202375401, -162.21734105928775, -832.3240655140337, -874.06179127283, -987.906588848219, -779.0184310081931, -765.0086337337121, -1.9050020515913928, -1180.8782997548894, -1064.277143765872, -879.5499887000132, -440.8479772347793, -1012.136430037283, -407.86808128183725, -519.9957959632818, -812.3575690880879, -585.7731925591377, -969.4772506633368, -949.7614905361878, -178.88452085572635, -957.5466823904735, -906.590925194045, -1015.6832828876427, -715.9106371345543, -1134.0002692808253, -1315.571050285812, -1255.1037357647454, -292.47938061943637, -925.7200673223176, -1104.574813682855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549347429974997, "mean_inference_ms": 1.6672116062193896, "mean_action_processing_ms": 0.27650883701106976, "mean_env_wait_ms": 3.453521099791027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012226581573486328, "StateBufferConnector_ms": 0.008007526397705078, "ViewRequirementAgentConnector_ms": 0.19591212272644043}, "num_episodes": 30, "episode_return_max": -1.9050020515913928, "episode_return_min": -1485.9339679467637, "episode_return_mean": -779.6377576884079, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.6843992439043, "num_env_steps_trained_throughput_per_sec": 311.6843992439043, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12297.657, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12297.577, "sample_time_ms": 1117.386, "learn_time_ms": 11110.441, "learn_throughput": 360.022, "synch_weights_time_ms": 68.889}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "07142_00000", "date": "2024-08-04_10-15-57", "timestamp": 1722746757, "time_this_iter_s": 12.846039533615112, "time_total_s": 160.7462935447693, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f86814ba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 160.7462935447693, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.55263157894737, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.46553652882577, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.872424564262231, "policy_loss": -0.013028656573927341, "vf_loss": 5.894182819128036, "vf_explained_var": 0.8949799132843812, "kl": 0.016097264581761327, "entropy": 1.3558756814648707, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -1.9050020515913928, "episode_reward_min": -1568.966094641877, "episode_reward_mean": -736.0515799995455, "episode_len_mean": 126.48, "episode_media": {}, "episodes_timesteps_total": 12648, "policy_reward_min": {"policy_0": -1568.966094641877}, "policy_reward_max": {"policy_0": -1.9050020515913928}, "policy_reward_mean": {"policy_0": -736.0515799995455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-294.6399808451918, -1261.8959707363297, -1178.938713541608, -14.16240574205189, -70.2445397484268, -1055.5655053918317, -784.6699246020985, -930.661912127489, -1053.828674826675, -1480.3129420069943, -31.308654119916522, -964.0252453883553, -972.1058216312529, -181.28552331237532, -1103.7986874075964, -350.01231603326016, -523.3293029650055, -130.66600899693387, -282.3379347494003, -636.9425730919138, -885.4895971734422, -1428.8765082751033, -461.8633888367382, -1352.3924140994052, -687.4089881841302, -1315.062416020321, -49.46571335606167, -383.89254457488516, -776.8926045227433, -993.4662762032181, -901.7917016679392, -809.6389238194652, -1195.279755050199, -946.0956963905006, -333.9760380399194, -1485.9339679467637, -1417.555445037482, -474.0449202375401, -162.21734105928775, -832.3240655140337, -874.06179127283, -987.906588848219, -779.0184310081931, -765.0086337337121, -1.9050020515913928, -1180.8782997548894, -1064.277143765872, -879.5499887000132, -440.8479772347793, -1012.136430037283, -407.86808128183725, -519.9957959632818, -812.3575690880879, -585.7731925591377, -969.4772506633368, -949.7614905361878, -178.88452085572635, -957.5466823904735, -906.590925194045, -1015.6832828876427, -715.9106371345543, -1134.0002692808253, -1315.571050285812, -1255.1037357647454, -292.47938061943637, -925.7200673223176, -1104.574813682855, -786.5311400177472, -122.84631540463268, -910.368331909491, -1430.1721452629981, -808.6875306647901, -1200.1697733063513, -53.64579696485025, -375.70637953034304, -750.3916825294743, -633.0982046017065, -1028.3499409455308, -763.725766967622, -27.185565276276378, -161.5861600438285, -750.1029097977693, -1055.0243737542341, -315.88691032934383, -947.1241466189066, -1114.6457254848779, -47.70060974362543, -1568.966094641877, -149.87807063896466, -184.88003783759618, -115.04717755452006, -53.89280855641635, -1180.703715107159, -786.2868311793001, -245.29922735086353, -974.4674006954547, -729.0126651635032, -159.76052189036506, -1174.0547898856496, -772.6692751069126], "episode_lengths": [97, 150, 150, 37, 66, 150, 150, 150, 150, 150, 43, 150, 150, 69, 150, 92, 116, 80, 80, 119, 150, 150, 150, 150, 150, 150, 55, 88, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 70, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 110, 112, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 84, 150, 150, 150, 150, 51, 90, 150, 150, 150, 150, 44, 73, 150, 150, 96, 150, 150, 53, 150, 76, 91, 65, 54, 150, 150, 70, 150, 147, 95, 150, 150], "policy_policy_0_reward": [-294.6399808451918, -1261.8959707363297, -1178.938713541608, -14.16240574205189, -70.2445397484268, -1055.5655053918317, -784.6699246020985, -930.661912127489, -1053.828674826675, -1480.3129420069943, -31.308654119916522, -964.0252453883553, -972.1058216312529, -181.28552331237532, -1103.7986874075964, -350.01231603326016, -523.3293029650055, -130.66600899693387, -282.3379347494003, -636.9425730919138, -885.4895971734422, -1428.8765082751033, -461.8633888367382, -1352.3924140994052, -687.4089881841302, -1315.062416020321, -49.46571335606167, -383.89254457488516, -776.8926045227433, -993.4662762032181, -901.7917016679392, -809.6389238194652, -1195.279755050199, -946.0956963905006, -333.9760380399194, -1485.9339679467637, -1417.555445037482, -474.0449202375401, -162.21734105928775, -832.3240655140337, -874.06179127283, -987.906588848219, -779.0184310081931, -765.0086337337121, -1.9050020515913928, -1180.8782997548894, -1064.277143765872, -879.5499887000132, -440.8479772347793, -1012.136430037283, -407.86808128183725, -519.9957959632818, -812.3575690880879, -585.7731925591377, -969.4772506633368, -949.7614905361878, -178.88452085572635, -957.5466823904735, -906.590925194045, -1015.6832828876427, -715.9106371345543, -1134.0002692808253, -1315.571050285812, -1255.1037357647454, -292.47938061943637, -925.7200673223176, -1104.574813682855, -786.5311400177472, -122.84631540463268, -910.368331909491, -1430.1721452629981, -808.6875306647901, -1200.1697733063513, -53.64579696485025, -375.70637953034304, -750.3916825294743, -633.0982046017065, -1028.3499409455308, -763.725766967622, -27.185565276276378, -161.5861600438285, -750.1029097977693, -1055.0243737542341, -315.88691032934383, -947.1241466189066, -1114.6457254848779, -47.70060974362543, -1568.966094641877, -149.87807063896466, -184.88003783759618, -115.04717755452006, -53.89280855641635, -1180.703715107159, -786.2868311793001, -245.29922735086353, -974.4674006954547, -729.0126651635032, -159.76052189036506, -1174.0547898856496, -772.6692751069126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545138332825753, "mean_inference_ms": 1.6660705406833105, "mean_action_processing_ms": 0.2762736580691552, "mean_env_wait_ms": 3.457672257091312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012363672256469727, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.19181609153747559}, "num_episodes": 33, "episode_return_max": -1.9050020515913928, "episode_return_min": -1568.966094641877, "episode_return_mean": -736.0515799995455, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.14853311356336, "num_env_steps_trained_throughput_per_sec": 310.14853311356336, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12284.551, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12284.472, "sample_time_ms": 1107.564, "learn_time_ms": 11109.007, "learn_throughput": 360.068, "synch_weights_time_ms": 67.044}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "07142_00000", "date": "2024-08-04_10-16-10", "timestamp": 1722746770, "time_this_iter_s": 12.910151720046997, "time_total_s": 173.65644526481628, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724498a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.65644526481628, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.62222222222222, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.46623301903406, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.506204955031475, "policy_loss": -0.009651085853208011, "vf_loss": 5.525218995908896, "vf_explained_var": 0.8958014734710257, "kl": 0.014979230729598702, "entropy": 1.385672382886211, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -1.9050020515913928, "episode_reward_min": -1568.966094641877, "episode_reward_mean": -700.9452102681112, "episode_len_mean": 125.45, "episode_media": {}, "episodes_timesteps_total": 12545, "policy_reward_min": {"policy_0": -1568.966094641877}, "policy_reward_max": {"policy_0": -1.9050020515913928}, "policy_reward_mean": {"policy_0": -700.9452102681112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333.9760380399194, -1485.9339679467637, -1417.555445037482, -474.0449202375401, -162.21734105928775, -832.3240655140337, -874.06179127283, -987.906588848219, -779.0184310081931, -765.0086337337121, -1.9050020515913928, -1180.8782997548894, -1064.277143765872, -879.5499887000132, -440.8479772347793, -1012.136430037283, -407.86808128183725, -519.9957959632818, -812.3575690880879, -585.7731925591377, -969.4772506633368, -949.7614905361878, -178.88452085572635, -957.5466823904735, -906.590925194045, -1015.6832828876427, -715.9106371345543, -1134.0002692808253, -1315.571050285812, -1255.1037357647454, -292.47938061943637, -925.7200673223176, -1104.574813682855, -786.5311400177472, -122.84631540463268, -910.368331909491, -1430.1721452629981, -808.6875306647901, -1200.1697733063513, -53.64579696485025, -375.70637953034304, -750.3916825294743, -633.0982046017065, -1028.3499409455308, -763.725766967622, -27.185565276276378, -161.5861600438285, -750.1029097977693, -1055.0243737542341, -315.88691032934383, -947.1241466189066, -1114.6457254848779, -47.70060974362543, -1568.966094641877, -149.87807063896466, -184.88003783759618, -115.04717755452006, -53.89280855641635, -1180.703715107159, -786.2868311793001, -245.29922735086353, -974.4674006954547, -729.0126651635032, -159.76052189036506, -1174.0547898856496, -772.6692751069126, -709.5412286708384, -239.8449396070205, -126.79083840275955, -48.4987917554723, -533.6700146467695, -135.66010898655946, -184.1770289654246, -731.2796729206378, -1182.4151033382607, -103.30649168662602, -795.5728854357396, -1322.029189939851, -890.9437690041719, -1024.249412312615, -1288.0381564661052, -912.1872526666469, -339.46418061431785, -468.50124180091433, -893.2460333309634, -1304.8144629132948, -119.20845088243608, -437.2263279662636, -1077.6688022407993, -879.6466346697233, -47.44360812667481, -96.2648766400026, -839.4353619062505, -797.8128535843933, -1074.9925252225155, -670.0506422524259, -491.4346304937892, -1205.0852382696744, -474.20528544919506, -533.0061511262785], "episode_lengths": [83, 150, 150, 150, 70, 150, 150, 150, 150, 150, 37, 150, 150, 150, 150, 150, 110, 112, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 84, 150, 150, 150, 150, 51, 90, 150, 150, 150, 150, 44, 73, 150, 150, 96, 150, 150, 53, 150, 76, 91, 65, 54, 150, 150, 70, 150, 147, 95, 150, 150, 150, 74, 53, 54, 109, 96, 78, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 58, 101, 150, 150, 50, 70, 150, 150, 150, 150, 124, 150, 150, 126], "policy_policy_0_reward": [-333.9760380399194, -1485.9339679467637, -1417.555445037482, -474.0449202375401, -162.21734105928775, -832.3240655140337, -874.06179127283, -987.906588848219, -779.0184310081931, -765.0086337337121, -1.9050020515913928, -1180.8782997548894, -1064.277143765872, -879.5499887000132, -440.8479772347793, -1012.136430037283, -407.86808128183725, -519.9957959632818, -812.3575690880879, -585.7731925591377, -969.4772506633368, -949.7614905361878, -178.88452085572635, -957.5466823904735, -906.590925194045, -1015.6832828876427, -715.9106371345543, -1134.0002692808253, -1315.571050285812, -1255.1037357647454, -292.47938061943637, -925.7200673223176, -1104.574813682855, -786.5311400177472, -122.84631540463268, -910.368331909491, -1430.1721452629981, -808.6875306647901, -1200.1697733063513, -53.64579696485025, -375.70637953034304, -750.3916825294743, -633.0982046017065, -1028.3499409455308, -763.725766967622, -27.185565276276378, -161.5861600438285, -750.1029097977693, -1055.0243737542341, -315.88691032934383, -947.1241466189066, -1114.6457254848779, -47.70060974362543, -1568.966094641877, -149.87807063896466, -184.88003783759618, -115.04717755452006, -53.89280855641635, -1180.703715107159, -786.2868311793001, -245.29922735086353, -974.4674006954547, -729.0126651635032, -159.76052189036506, -1174.0547898856496, -772.6692751069126, -709.5412286708384, -239.8449396070205, -126.79083840275955, -48.4987917554723, -533.6700146467695, -135.66010898655946, -184.1770289654246, -731.2796729206378, -1182.4151033382607, -103.30649168662602, -795.5728854357396, -1322.029189939851, -890.9437690041719, -1024.249412312615, -1288.0381564661052, -912.1872526666469, -339.46418061431785, -468.50124180091433, -893.2460333309634, -1304.8144629132948, -119.20845088243608, -437.2263279662636, -1077.6688022407993, -879.6466346697233, -47.44360812667481, -96.2648766400026, -839.4353619062505, -797.8128535843933, -1074.9925252225155, -670.0506422524259, -491.4346304937892, -1205.0852382696744, -474.20528544919506, -533.0061511262785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547535199533588, "mean_inference_ms": 1.6655067508715045, "mean_action_processing_ms": 0.2759252189370462, "mean_env_wait_ms": 3.4549631178055846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012249469757080078, "StateBufferConnector_ms": 0.008240938186645508, "ViewRequirementAgentConnector_ms": 0.19511175155639648}, "num_episodes": 34, "episode_return_max": -1.9050020515913928, "episode_return_min": -1568.966094641877, "episode_return_mean": -700.9452102681112, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8075422756575, "num_env_steps_trained_throughput_per_sec": 307.8075422756575, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12326.416, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12326.333, "sample_time_ms": 1115.406, "learn_time_ms": 11141.508, "learn_throughput": 359.018, "synch_weights_time_ms": 68.56}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "07142_00000", "date": "2024-08-04_10-16-23", "timestamp": 1722746783, "time_this_iter_s": 13.00758147239685, "time_total_s": 186.66402673721313, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724499e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.66402673721313, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.373684210526317, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.90565945307414, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.612430014461279, "policy_loss": -0.00916085441664715, "vf_loss": 5.63340829735001, "vf_explained_var": 0.913919441588223, "kl": 0.012264807879516108, "entropy": 1.5496884214381377, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -7.071413239488331, "episode_reward_min": -1568.966094641877, "episode_reward_mean": -694.9495123794825, "episode_len_mean": 124.82, "episode_media": {}, "episodes_timesteps_total": 12482, "policy_reward_min": {"policy_0": -1568.966094641877}, "policy_reward_max": {"policy_0": -7.071413239488331}, "policy_reward_mean": {"policy_0": -694.9495123794825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1315.571050285812, -1255.1037357647454, -292.47938061943637, -925.7200673223176, -1104.574813682855, -786.5311400177472, -122.84631540463268, -910.368331909491, -1430.1721452629981, -808.6875306647901, -1200.1697733063513, -53.64579696485025, -375.70637953034304, -750.3916825294743, -633.0982046017065, -1028.3499409455308, -763.725766967622, -27.185565276276378, -161.5861600438285, -750.1029097977693, -1055.0243737542341, -315.88691032934383, -947.1241466189066, -1114.6457254848779, -47.70060974362543, -1568.966094641877, -149.87807063896466, -184.88003783759618, -115.04717755452006, -53.89280855641635, -1180.703715107159, -786.2868311793001, -245.29922735086353, -974.4674006954547, -729.0126651635032, -159.76052189036506, -1174.0547898856496, -772.6692751069126, -709.5412286708384, -239.8449396070205, -126.79083840275955, -48.4987917554723, -533.6700146467695, -135.66010898655946, -184.1770289654246, -731.2796729206378, -1182.4151033382607, -103.30649168662602, -795.5728854357396, -1322.029189939851, -890.9437690041719, -1024.249412312615, -1288.0381564661052, -912.1872526666469, -339.46418061431785, -468.50124180091433, -893.2460333309634, -1304.8144629132948, -119.20845088243608, -437.2263279662636, -1077.6688022407993, -879.6466346697233, -47.44360812667481, -96.2648766400026, -839.4353619062505, -797.8128535843933, -1074.9925252225155, -670.0506422524259, -491.4346304937892, -1205.0852382696744, -474.20528544919506, -533.0061511262785, -1167.4159129946365, -905.9624815381175, -182.96990045863913, -1191.7518162871943, -1499.8702577568429, -463.2861609211304, -946.5603053598203, -554.1056888836229, -525.7003614437791, -7.071413239488331, -749.357686035516, -135.95119517703668, -1067.7184200567137, -830.1526504967956, -882.6701658224539, -1211.0409042774434, -962.206623602185, -1039.983828611934, -829.0087024588101, -673.5342453789486, -183.2366792471394, -702.3572899060418, -1100.5083892916873, -1226.3220516886356, -926.2242164262979, -528.9319201547468, -476.1667547505271, -275.85595094849964], "episode_lengths": [150, 150, 75, 150, 150, 150, 84, 150, 150, 150, 150, 51, 90, 150, 150, 150, 150, 44, 73, 150, 150, 96, 150, 150, 53, 150, 76, 91, 65, 54, 150, 150, 70, 150, 147, 95, 150, 150, 150, 74, 53, 54, 109, 96, 78, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 58, 101, 150, 150, 50, 70, 150, 150, 150, 150, 124, 150, 150, 126, 150, 150, 65, 150, 150, 108, 147, 132, 150, 32, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 112], "policy_policy_0_reward": [-1315.571050285812, -1255.1037357647454, -292.47938061943637, -925.7200673223176, -1104.574813682855, -786.5311400177472, -122.84631540463268, -910.368331909491, -1430.1721452629981, -808.6875306647901, -1200.1697733063513, -53.64579696485025, -375.70637953034304, -750.3916825294743, -633.0982046017065, -1028.3499409455308, -763.725766967622, -27.185565276276378, -161.5861600438285, -750.1029097977693, -1055.0243737542341, -315.88691032934383, -947.1241466189066, -1114.6457254848779, -47.70060974362543, -1568.966094641877, -149.87807063896466, -184.88003783759618, -115.04717755452006, -53.89280855641635, -1180.703715107159, -786.2868311793001, -245.29922735086353, -974.4674006954547, -729.0126651635032, -159.76052189036506, -1174.0547898856496, -772.6692751069126, -709.5412286708384, -239.8449396070205, -126.79083840275955, -48.4987917554723, -533.6700146467695, -135.66010898655946, -184.1770289654246, -731.2796729206378, -1182.4151033382607, -103.30649168662602, -795.5728854357396, -1322.029189939851, -890.9437690041719, -1024.249412312615, -1288.0381564661052, -912.1872526666469, -339.46418061431785, -468.50124180091433, -893.2460333309634, -1304.8144629132948, -119.20845088243608, -437.2263279662636, -1077.6688022407993, -879.6466346697233, -47.44360812667481, -96.2648766400026, -839.4353619062505, -797.8128535843933, -1074.9925252225155, -670.0506422524259, -491.4346304937892, -1205.0852382696744, -474.20528544919506, -533.0061511262785, -1167.4159129946365, -905.9624815381175, -182.96990045863913, -1191.7518162871943, -1499.8702577568429, -463.2861609211304, -946.5603053598203, -554.1056888836229, -525.7003614437791, -7.071413239488331, -749.357686035516, -135.95119517703668, -1067.7184200567137, -830.1526504967956, -882.6701658224539, -1211.0409042774434, -962.206623602185, -1039.983828611934, -829.0087024588101, -673.5342453789486, -183.2366792471394, -702.3572899060418, -1100.5083892916873, -1226.3220516886356, -926.2242164262979, -528.9319201547468, -476.1667547505271, -275.85595094849964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549082318373537, "mean_inference_ms": 1.6646794168465655, "mean_action_processing_ms": 0.2756568581339106, "mean_env_wait_ms": 3.4562779969355546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012344837188720703, "StateBufferConnector_ms": 0.008270740509033203, "ViewRequirementAgentConnector_ms": 0.19632911682128906}, "num_episodes": 28, "episode_return_max": -7.071413239488331, "episode_return_min": -1568.966094641877, "episode_return_mean": -694.9495123794825, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.68324768311834, "num_env_steps_trained_throughput_per_sec": 310.68324768311834, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12292.946, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12292.862, "sample_time_ms": 1117.357, "learn_time_ms": 11106.805, "learn_throughput": 360.14, "synch_weights_time_ms": 67.833}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "07142_00000", "date": "2024-08-04_10-16-36", "timestamp": 1722746796, "time_this_iter_s": 12.887280225753784, "time_total_s": 199.55130696296692, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724417e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.55130696296692, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.67222222222222, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.44344295660656, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.506937487175067, "policy_loss": -0.012693078288672647, "vf_loss": 5.530302224556605, "vf_explained_var": 0.9185897789895534, "kl": 0.01611822893758775, "entropy": 1.5507128632316987, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -7.071413239488331, "episode_reward_min": -1499.8702577568429, "episode_reward_mean": -698.4105096340692, "episode_len_mean": 131.04, "episode_media": {}, "episodes_timesteps_total": 13104, "policy_reward_min": {"policy_0": -1499.8702577568429}, "policy_reward_max": {"policy_0": -7.071413239488331}, "policy_reward_mean": {"policy_0": -698.4105096340692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.2868311793001, -245.29922735086353, -974.4674006954547, -729.0126651635032, -159.76052189036506, -1174.0547898856496, -772.6692751069126, -709.5412286708384, -239.8449396070205, -126.79083840275955, -48.4987917554723, -533.6700146467695, -135.66010898655946, -184.1770289654246, -731.2796729206378, -1182.4151033382607, -103.30649168662602, -795.5728854357396, -1322.029189939851, -890.9437690041719, -1024.249412312615, -1288.0381564661052, -912.1872526666469, -339.46418061431785, -468.50124180091433, -893.2460333309634, -1304.8144629132948, -119.20845088243608, -437.2263279662636, -1077.6688022407993, -879.6466346697233, -47.44360812667481, -96.2648766400026, -839.4353619062505, -797.8128535843933, -1074.9925252225155, -670.0506422524259, -491.4346304937892, -1205.0852382696744, -474.20528544919506, -533.0061511262785, -1167.4159129946365, -905.9624815381175, -182.96990045863913, -1191.7518162871943, -1499.8702577568429, -463.2861609211304, -946.5603053598203, -554.1056888836229, -525.7003614437791, -7.071413239488331, -749.357686035516, -135.95119517703668, -1067.7184200567137, -830.1526504967956, -882.6701658224539, -1211.0409042774434, -962.206623602185, -1039.983828611934, -829.0087024588101, -673.5342453789486, -183.2366792471394, -702.3572899060418, -1100.5083892916873, -1226.3220516886356, -926.2242164262979, -528.9319201547468, -476.1667547505271, -275.85595094849964, -464.3410346755968, -835.2341358714758, -795.6676236662024, -772.1462411034404, -1256.8758987801966, -550.747941646289, -542.8912076984201, -348.3543061722123, -595.0161910706837, -1135.3938913340264, -1197.5684416574686, -699.658550253806, -884.1869706081454, -929.438928665151, -765.645579981955, -61.88942321641361, -915.0429481561181, -213.4292076118187, -591.8494564311823, -885.0607901143268, -14.340194686976254, -573.2033456392998, -609.194098478177, -1149.5726183663005, -441.8677551242589, -1072.885974538012, -1110.5936253799182, -425.16889442920706, -728.8756727639309, -426.59732168024044, -783.1278168235237], "episode_lengths": [150, 70, 150, 147, 95, 150, 150, 150, 74, 53, 54, 109, 96, 78, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 58, 101, 150, 150, 50, 70, 150, 150, 150, 150, 124, 150, 150, 126, 150, 150, 65, 150, 150, 108, 147, 132, 150, 32, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 102, 150, 150, 36, 150, 150, 150, 111, 150, 150, 135, 150, 150, 137], "policy_policy_0_reward": [-786.2868311793001, -245.29922735086353, -974.4674006954547, -729.0126651635032, -159.76052189036506, -1174.0547898856496, -772.6692751069126, -709.5412286708384, -239.8449396070205, -126.79083840275955, -48.4987917554723, -533.6700146467695, -135.66010898655946, -184.1770289654246, -731.2796729206378, -1182.4151033382607, -103.30649168662602, -795.5728854357396, -1322.029189939851, -890.9437690041719, -1024.249412312615, -1288.0381564661052, -912.1872526666469, -339.46418061431785, -468.50124180091433, -893.2460333309634, -1304.8144629132948, -119.20845088243608, -437.2263279662636, -1077.6688022407993, -879.6466346697233, -47.44360812667481, -96.2648766400026, -839.4353619062505, -797.8128535843933, -1074.9925252225155, -670.0506422524259, -491.4346304937892, -1205.0852382696744, -474.20528544919506, -533.0061511262785, -1167.4159129946365, -905.9624815381175, -182.96990045863913, -1191.7518162871943, -1499.8702577568429, -463.2861609211304, -946.5603053598203, -554.1056888836229, -525.7003614437791, -7.071413239488331, -749.357686035516, -135.95119517703668, -1067.7184200567137, -830.1526504967956, -882.6701658224539, -1211.0409042774434, -962.206623602185, -1039.983828611934, -829.0087024588101, -673.5342453789486, -183.2366792471394, -702.3572899060418, -1100.5083892916873, -1226.3220516886356, -926.2242164262979, -528.9319201547468, -476.1667547505271, -275.85595094849964, -464.3410346755968, -835.2341358714758, -795.6676236662024, -772.1462411034404, -1256.8758987801966, -550.747941646289, -542.8912076984201, -348.3543061722123, -595.0161910706837, -1135.3938913340264, -1197.5684416574686, -699.658550253806, -884.1869706081454, -929.438928665151, -765.645579981955, -61.88942321641361, -915.0429481561181, -213.4292076118187, -591.8494564311823, -885.0607901143268, -14.340194686976254, -573.2033456392998, -609.194098478177, -1149.5726183663005, -441.8677551242589, -1072.885974538012, -1110.5936253799182, -425.16889442920706, -728.8756727639309, -426.59732168024044, -783.1278168235237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542080733146039, "mean_inference_ms": 1.6646357692154399, "mean_action_processing_ms": 0.27546698633951644, "mean_env_wait_ms": 3.457307072392011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012106657028198242, "StateBufferConnector_ms": 0.008230447769165039, "ViewRequirementAgentConnector_ms": 0.1962430477142334}, "num_episodes": 31, "episode_return_max": -7.071413239488331, "episode_return_min": -1499.8702577568429, "episode_return_mean": -698.4105096340692, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.05278291477066, "num_env_steps_trained_throughput_per_sec": 315.05278291477066, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12274.857, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12274.774, "sample_time_ms": 1118.584, "learn_time_ms": 11085.812, "learn_throughput": 360.822, "synch_weights_time_ms": 69.516}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "07142_00000", "date": "2024-08-04_10-16-49", "timestamp": 1722746809, "time_this_iter_s": 12.708331823348999, "time_total_s": 212.25963878631592, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244172e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.25963878631592, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.799999999999997, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.88696154753367, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.8110814191401, "policy_loss": -0.011233608277204135, "vf_loss": 4.831373141209284, "vf_explained_var": 0.8957164749503136, "kl": 0.017077389635778692, "entropy": 1.4181313561896483, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -4.477244134091605, "episode_reward_min": -1499.8702577568429, "episode_reward_mean": -726.0442078340348, "episode_len_mean": 134.17, "episode_media": {}, "episodes_timesteps_total": 13417, "policy_reward_min": {"policy_0": -1499.8702577568429}, "policy_reward_max": {"policy_0": -4.477244134091605}, "policy_reward_mean": {"policy_0": -726.0442078340348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1077.6688022407993, -879.6466346697233, -47.44360812667481, -96.2648766400026, -839.4353619062505, -797.8128535843933, -1074.9925252225155, -670.0506422524259, -491.4346304937892, -1205.0852382696744, -474.20528544919506, -533.0061511262785, -1167.4159129946365, -905.9624815381175, -182.96990045863913, -1191.7518162871943, -1499.8702577568429, -463.2861609211304, -946.5603053598203, -554.1056888836229, -525.7003614437791, -7.071413239488331, -749.357686035516, -135.95119517703668, -1067.7184200567137, -830.1526504967956, -882.6701658224539, -1211.0409042774434, -962.206623602185, -1039.983828611934, -829.0087024588101, -673.5342453789486, -183.2366792471394, -702.3572899060418, -1100.5083892916873, -1226.3220516886356, -926.2242164262979, -528.9319201547468, -476.1667547505271, -275.85595094849964, -464.3410346755968, -835.2341358714758, -795.6676236662024, -772.1462411034404, -1256.8758987801966, -550.747941646289, -542.8912076984201, -348.3543061722123, -595.0161910706837, -1135.3938913340264, -1197.5684416574686, -699.658550253806, -884.1869706081454, -929.438928665151, -765.645579981955, -61.88942321641361, -915.0429481561181, -213.4292076118187, -591.8494564311823, -885.0607901143268, -14.340194686976254, -573.2033456392998, -609.194098478177, -1149.5726183663005, -441.8677551242589, -1072.885974538012, -1110.5936253799182, -425.16889442920706, -728.8756727639309, -426.59732168024044, -783.1278168235237, -1399.2291791937025, -1362.7867457462785, -817.6868682617736, -615.4227258469354, -857.3207422985456, -4.477244134091605, -630.9686997963208, -1149.2214858030625, -86.52854077415586, -619.2494366054165, -1287.56203145753, -770.341472038499, -753.6129722779461, -1358.485921152138, -601.4582911303828, -544.756443100372, -925.2460117108303, -779.6549137025711, -21.306087106145476, -636.450763392483, -25.976801101514713, -621.8109126164361, -1205.5979907886651, -732.8887025962247, -750.4509878793087, -527.6096620696453, -165.85020960696184, -1024.21561140625, -1119.4186599881043], "episode_lengths": [150, 150, 50, 70, 150, 150, 150, 150, 124, 150, 150, 126, 150, 150, 65, 150, 150, 108, 147, 132, 150, 32, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 102, 150, 150, 36, 150, 150, 150, 111, 150, 150, 135, 150, 150, 137, 150, 150, 150, 137, 150, 34, 128, 150, 59, 124, 150, 150, 150, 150, 150, 150, 150, 150, 51, 137, 50, 132, 150, 150, 150, 150, 92, 150, 150], "policy_policy_0_reward": [-1077.6688022407993, -879.6466346697233, -47.44360812667481, -96.2648766400026, -839.4353619062505, -797.8128535843933, -1074.9925252225155, -670.0506422524259, -491.4346304937892, -1205.0852382696744, -474.20528544919506, -533.0061511262785, -1167.4159129946365, -905.9624815381175, -182.96990045863913, -1191.7518162871943, -1499.8702577568429, -463.2861609211304, -946.5603053598203, -554.1056888836229, -525.7003614437791, -7.071413239488331, -749.357686035516, -135.95119517703668, -1067.7184200567137, -830.1526504967956, -882.6701658224539, -1211.0409042774434, -962.206623602185, -1039.983828611934, -829.0087024588101, -673.5342453789486, -183.2366792471394, -702.3572899060418, -1100.5083892916873, -1226.3220516886356, -926.2242164262979, -528.9319201547468, -476.1667547505271, -275.85595094849964, -464.3410346755968, -835.2341358714758, -795.6676236662024, -772.1462411034404, -1256.8758987801966, -550.747941646289, -542.8912076984201, -348.3543061722123, -595.0161910706837, -1135.3938913340264, -1197.5684416574686, -699.658550253806, -884.1869706081454, -929.438928665151, -765.645579981955, -61.88942321641361, -915.0429481561181, -213.4292076118187, -591.8494564311823, -885.0607901143268, -14.340194686976254, -573.2033456392998, -609.194098478177, -1149.5726183663005, -441.8677551242589, -1072.885974538012, -1110.5936253799182, -425.16889442920706, -728.8756727639309, -426.59732168024044, -783.1278168235237, -1399.2291791937025, -1362.7867457462785, -817.6868682617736, -615.4227258469354, -857.3207422985456, -4.477244134091605, -630.9686997963208, -1149.2214858030625, -86.52854077415586, -619.2494366054165, -1287.56203145753, -770.341472038499, -753.6129722779461, -1358.485921152138, -601.4582911303828, -544.756443100372, -925.2460117108303, -779.6549137025711, -21.306087106145476, -636.450763392483, -25.976801101514713, -621.8109126164361, -1205.5979907886651, -732.8887025962247, -750.4509878793087, -527.6096620696453, -165.85020960696184, -1024.21561140625, -1119.4186599881043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537560863686093, "mean_inference_ms": 1.6651970617890235, "mean_action_processing_ms": 0.2752722802076474, "mean_env_wait_ms": 3.455777033882537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012092828750610352, "StateBufferConnector_ms": 0.008227109909057617, "ViewRequirementAgentConnector_ms": 0.19516658782958984}, "num_episodes": 29, "episode_return_max": -4.477244134091605, "episode_return_min": -1499.8702577568429, "episode_return_mean": -726.0442078340348, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.74781852157844, "num_env_steps_trained_throughput_per_sec": 319.74781852157844, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12329.927, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12329.844, "sample_time_ms": 1126.157, "learn_time_ms": 11133.825, "learn_throughput": 359.266, "synch_weights_time_ms": 69.0}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "07142_00000", "date": "2024-08-04_10-17-02", "timestamp": 1722746822, "time_this_iter_s": 12.523180723190308, "time_total_s": 224.78281950950623, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244153f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.78281950950623, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.855555555555558, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.48636037508646, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.187192123631636, "policy_loss": -0.008433269624462506, "vf_loss": 5.206267948448658, "vf_explained_var": 0.9237343418722351, "kl": 0.016443502684493676, "entropy": 1.5575601580242315, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -4.477244134091605, "episode_reward_min": -1399.2291791937025, "episode_reward_mean": -691.8647309745493, "episode_len_mean": 134.56, "episode_media": {}, "episodes_timesteps_total": 13456, "policy_reward_min": {"policy_0": -1399.2291791937025}, "policy_reward_max": {"policy_0": -4.477244134091605}, "policy_reward_mean": {"policy_0": -691.8647309745493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-673.5342453789486, -183.2366792471394, -702.3572899060418, -1100.5083892916873, -1226.3220516886356, -926.2242164262979, -528.9319201547468, -476.1667547505271, -275.85595094849964, -464.3410346755968, -835.2341358714758, -795.6676236662024, -772.1462411034404, -1256.8758987801966, -550.747941646289, -542.8912076984201, -348.3543061722123, -595.0161910706837, -1135.3938913340264, -1197.5684416574686, -699.658550253806, -884.1869706081454, -929.438928665151, -765.645579981955, -61.88942321641361, -915.0429481561181, -213.4292076118187, -591.8494564311823, -885.0607901143268, -14.340194686976254, -573.2033456392998, -609.194098478177, -1149.5726183663005, -441.8677551242589, -1072.885974538012, -1110.5936253799182, -425.16889442920706, -728.8756727639309, -426.59732168024044, -783.1278168235237, -1399.2291791937025, -1362.7867457462785, -817.6868682617736, -615.4227258469354, -857.3207422985456, -4.477244134091605, -630.9686997963208, -1149.2214858030625, -86.52854077415586, -619.2494366054165, -1287.56203145753, -770.341472038499, -753.6129722779461, -1358.485921152138, -601.4582911303828, -544.756443100372, -925.2460117108303, -779.6549137025711, -21.306087106145476, -636.450763392483, -25.976801101514713, -621.8109126164361, -1205.5979907886651, -732.8887025962247, -750.4509878793087, -527.6096620696453, -165.85020960696184, -1024.21561140625, -1119.4186599881043, -654.280120842499, -246.53405132066774, -558.6515446941098, -606.6543301762578, -411.8825804554824, -636.9869952999636, -744.9049775217258, -257.9177833169598, -1243.0120031673982, -678.7673157272516, -1147.2696676384626, -100.7433445582582, -385.13026706141085, -963.4118466227001, -647.6972862015767, -684.5926724392621, -617.7611452152187, -434.606052990553, -660.7397594208098, -159.85043503078106, -1129.1996693390304, -808.535946347268, -770.4711900708259, -23.640531019350767, -933.6521917356473, -1044.920607560621, -460.74356466977923, -876.0119040393603, -220.83823134325192, -560.2281105556858, -1252.247273073175], "episode_lengths": [150, 58, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 102, 150, 150, 36, 150, 150, 150, 111, 150, 150, 135, 150, 150, 137, 150, 150, 150, 137, 150, 34, 128, 150, 59, 124, 150, 150, 150, 150, 150, 150, 150, 150, 51, 137, 50, 132, 150, 150, 150, 150, 92, 150, 150, 150, 107, 150, 125, 104, 150, 150, 97, 150, 150, 150, 74, 117, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 32, 150, 150, 150, 150, 87, 150, 150], "policy_policy_0_reward": [-673.5342453789486, -183.2366792471394, -702.3572899060418, -1100.5083892916873, -1226.3220516886356, -926.2242164262979, -528.9319201547468, -476.1667547505271, -275.85595094849964, -464.3410346755968, -835.2341358714758, -795.6676236662024, -772.1462411034404, -1256.8758987801966, -550.747941646289, -542.8912076984201, -348.3543061722123, -595.0161910706837, -1135.3938913340264, -1197.5684416574686, -699.658550253806, -884.1869706081454, -929.438928665151, -765.645579981955, -61.88942321641361, -915.0429481561181, -213.4292076118187, -591.8494564311823, -885.0607901143268, -14.340194686976254, -573.2033456392998, -609.194098478177, -1149.5726183663005, -441.8677551242589, -1072.885974538012, -1110.5936253799182, -425.16889442920706, -728.8756727639309, -426.59732168024044, -783.1278168235237, -1399.2291791937025, -1362.7867457462785, -817.6868682617736, -615.4227258469354, -857.3207422985456, -4.477244134091605, -630.9686997963208, -1149.2214858030625, -86.52854077415586, -619.2494366054165, -1287.56203145753, -770.341472038499, -753.6129722779461, -1358.485921152138, -601.4582911303828, -544.756443100372, -925.2460117108303, -779.6549137025711, -21.306087106145476, -636.450763392483, -25.976801101514713, -621.8109126164361, -1205.5979907886651, -732.8887025962247, -750.4509878793087, -527.6096620696453, -165.85020960696184, -1024.21561140625, -1119.4186599881043, -654.280120842499, -246.53405132066774, -558.6515446941098, -606.6543301762578, -411.8825804554824, -636.9869952999636, -744.9049775217258, -257.9177833169598, -1243.0120031673982, -678.7673157272516, -1147.2696676384626, -100.7433445582582, -385.13026706141085, -963.4118466227001, -647.6972862015767, -684.5926724392621, -617.7611452152187, -434.606052990553, -660.7397594208098, -159.85043503078106, -1129.1996693390304, -808.535946347268, -770.4711900708259, -23.640531019350767, -933.6521917356473, -1044.920607560621, -460.74356466977923, -876.0119040393603, -220.83823134325192, -560.2281105556858, -1252.247273073175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534972020312011, "mean_inference_ms": 1.666268195568243, "mean_action_processing_ms": 0.2751911968754292, "mean_env_wait_ms": 3.4601214375891294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01190638542175293, "StateBufferConnector_ms": 0.0080413818359375, "ViewRequirementAgentConnector_ms": 0.19450807571411133}, "num_episodes": 31, "episode_return_max": -4.477244134091605, "episode_return_min": -1399.2291791937025, "episode_return_mean": -691.8647309745493, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.3213408687263, "num_env_steps_trained_throughput_per_sec": 535.3213408687263, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12320.766, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12320.684, "sample_time_ms": 1124.004, "learn_time_ms": 11126.874, "learn_throughput": 359.49, "synch_weights_time_ms": 68.949}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "07142_00000", "date": "2024-08-04_10-17-09", "timestamp": 1722746829, "time_this_iter_s": 7.484627962112427, "time_total_s": 232.26744747161865, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244996c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.26744747161865, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.518181818181816, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.3587872425715, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.61347574343284, "policy_loss": -0.006818295740231406, "vf_loss": 4.633411610623201, "vf_explained_var": 0.9325720932955543, "kl": 0.014977504228348475, "entropy": 1.7610829599201678, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -4.477244134091605, "episode_reward_min": -1419.473137609359, "episode_reward_mean": -707.1586072877177, "episode_len_mean": 131.95, "episode_media": {}, "episodes_timesteps_total": 13195, "policy_reward_min": {"policy_0": -1419.473137609359}, "policy_reward_max": {"policy_0": -4.477244134091605}, "policy_reward_mean": {"policy_0": -707.1586072877177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.340194686976254, -573.2033456392998, -609.194098478177, -1149.5726183663005, -441.8677551242589, -1072.885974538012, -1110.5936253799182, -425.16889442920706, -728.8756727639309, -426.59732168024044, -783.1278168235237, -1399.2291791937025, -1362.7867457462785, -817.6868682617736, -615.4227258469354, -857.3207422985456, -4.477244134091605, -630.9686997963208, -1149.2214858030625, -86.52854077415586, -619.2494366054165, -1287.56203145753, -770.341472038499, -753.6129722779461, -1358.485921152138, -601.4582911303828, -544.756443100372, -925.2460117108303, -779.6549137025711, -21.306087106145476, -636.450763392483, -25.976801101514713, -621.8109126164361, -1205.5979907886651, -732.8887025962247, -750.4509878793087, -527.6096620696453, -165.85020960696184, -1024.21561140625, -1119.4186599881043, -654.280120842499, -246.53405132066774, -558.6515446941098, -606.6543301762578, -411.8825804554824, -636.9869952999636, -744.9049775217258, -257.9177833169598, -1243.0120031673982, -678.7673157272516, -1147.2696676384626, -100.7433445582582, -385.13026706141085, -963.4118466227001, -647.6972862015767, -684.5926724392621, -617.7611452152187, -434.606052990553, -660.7397594208098, -159.85043503078106, -1129.1996693390304, -808.535946347268, -770.4711900708259, -23.640531019350767, -933.6521917356473, -1044.920607560621, -460.74356466977923, -876.0119040393603, -220.83823134325192, -560.2281105556858, -1252.247273073175, -1084.0095342083196, -1111.766945852646, -167.38804096350978, -1058.6613625097036, -862.3248715483496, -1413.3418251066691, -854.5755239296269, -815.3507395846862, -205.15261474630643, -930.6941667750172, -795.1283034251863, -785.7945140256484, -113.46229960867247, -687.6995384725518, -1135.5491980559373, -1049.1438105802006, -1186.3639795946112, -644.783176924093, -330.03326831418144, -107.4942583962509, -397.498400655793, -927.4422563200186, -819.9922610932052, -830.1227111878602, -1249.6433155789214, -1419.473137609359, -584.3117749730116, -63.40340369614973, -432.35866408781055], "episode_lengths": [36, 150, 150, 150, 111, 150, 150, 135, 150, 150, 137, 150, 150, 150, 137, 150, 34, 128, 150, 59, 124, 150, 150, 150, 150, 150, 150, 150, 150, 51, 137, 50, 132, 150, 150, 150, 150, 92, 150, 150, 150, 107, 150, 125, 104, 150, 150, 97, 150, 150, 150, 74, 117, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 32, 150, 150, 150, 150, 87, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 67, 150, 150, 150, 73, 150, 150, 150, 150, 150, 85, 61, 124, 150, 150, 150, 150, 150, 120, 62, 133], "policy_policy_0_reward": [-14.340194686976254, -573.2033456392998, -609.194098478177, -1149.5726183663005, -441.8677551242589, -1072.885974538012, -1110.5936253799182, -425.16889442920706, -728.8756727639309, -426.59732168024044, -783.1278168235237, -1399.2291791937025, -1362.7867457462785, -817.6868682617736, -615.4227258469354, -857.3207422985456, -4.477244134091605, -630.9686997963208, -1149.2214858030625, -86.52854077415586, -619.2494366054165, -1287.56203145753, -770.341472038499, -753.6129722779461, -1358.485921152138, -601.4582911303828, -544.756443100372, -925.2460117108303, -779.6549137025711, -21.306087106145476, -636.450763392483, -25.976801101514713, -621.8109126164361, -1205.5979907886651, -732.8887025962247, -750.4509878793087, -527.6096620696453, -165.85020960696184, -1024.21561140625, -1119.4186599881043, -654.280120842499, -246.53405132066774, -558.6515446941098, -606.6543301762578, -411.8825804554824, -636.9869952999636, -744.9049775217258, -257.9177833169598, -1243.0120031673982, -678.7673157272516, -1147.2696676384626, -100.7433445582582, -385.13026706141085, -963.4118466227001, -647.6972862015767, -684.5926724392621, -617.7611452152187, -434.606052990553, -660.7397594208098, -159.85043503078106, -1129.1996693390304, -808.535946347268, -770.4711900708259, -23.640531019350767, -933.6521917356473, -1044.920607560621, -460.74356466977923, -876.0119040393603, -220.83823134325192, -560.2281105556858, -1252.247273073175, -1084.0095342083196, -1111.766945852646, -167.38804096350978, -1058.6613625097036, -862.3248715483496, -1413.3418251066691, -854.5755239296269, -815.3507395846862, -205.15261474630643, -930.6941667750172, -795.1283034251863, -785.7945140256484, -113.46229960867247, -687.6995384725518, -1135.5491980559373, -1049.1438105802006, -1186.3639795946112, -644.783176924093, -330.03326831418144, -107.4942583962509, -397.498400655793, -927.4422563200186, -819.9922610932052, -830.1227111878602, -1249.6433155789214, -1419.473137609359, -584.3117749730116, -63.40340369614973, -432.35866408781055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553237755145191, "mean_inference_ms": 1.6667459559764655, "mean_action_processing_ms": 0.2751632980338567, "mean_env_wait_ms": 3.4606316782442796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012063980102539062, "StateBufferConnector_ms": 0.008028745651245117, "ViewRequirementAgentConnector_ms": 0.1995093822479248}, "num_episodes": 29, "episode_return_max": -4.477244134091605, "episode_return_min": -1419.473137609359, "episode_return_mean": -707.1586072877177, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.3241295638338, "num_env_steps_trained_throughput_per_sec": 354.3241295638338, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12146.369, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12146.286, "sample_time_ms": 1126.841, "learn_time_ms": 10949.956, "learn_throughput": 365.298, "synch_weights_time_ms": 68.634}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "07142_00000", "date": "2024-08-04_10-17-21", "timestamp": 1722746841, "time_this_iter_s": 11.30122709274292, "time_total_s": 243.56867456436157, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724499630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 243.56867456436157, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.668750000000003, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.2195244550705, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.08674035097162, "policy_loss": -0.008526010960243488, "vf_loss": 5.108336363236109, "vf_explained_var": 0.9501475635295112, "kl": 0.014920881081085729, "entropy": 1.754626310740908, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -21.306087106145476, "episode_reward_min": -1474.1077651682115, "episode_reward_mean": -735.847473728659, "episode_len_mean": 134.02, "episode_media": {}, "episodes_timesteps_total": 13402, "policy_reward_min": {"policy_0": -1474.1077651682115}, "policy_reward_max": {"policy_0": -21.306087106145476}, "policy_reward_mean": {"policy_0": -735.847473728659}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-779.6549137025711, -21.306087106145476, -636.450763392483, -25.976801101514713, -621.8109126164361, -1205.5979907886651, -732.8887025962247, -750.4509878793087, -527.6096620696453, -165.85020960696184, -1024.21561140625, -1119.4186599881043, -654.280120842499, -246.53405132066774, -558.6515446941098, -606.6543301762578, -411.8825804554824, -636.9869952999636, -744.9049775217258, -257.9177833169598, -1243.0120031673982, -678.7673157272516, -1147.2696676384626, -100.7433445582582, -385.13026706141085, -963.4118466227001, -647.6972862015767, -684.5926724392621, -617.7611452152187, -434.606052990553, -660.7397594208098, -159.85043503078106, -1129.1996693390304, -808.535946347268, -770.4711900708259, -23.640531019350767, -933.6521917356473, -1044.920607560621, -460.74356466977923, -876.0119040393603, -220.83823134325192, -560.2281105556858, -1252.247273073175, -1084.0095342083196, -1111.766945852646, -167.38804096350978, -1058.6613625097036, -862.3248715483496, -1413.3418251066691, -854.5755239296269, -815.3507395846862, -205.15261474630643, -930.6941667750172, -795.1283034251863, -785.7945140256484, -113.46229960867247, -687.6995384725518, -1135.5491980559373, -1049.1438105802006, -1186.3639795946112, -644.783176924093, -330.03326831418144, -107.4942583962509, -397.498400655793, -927.4422563200186, -819.9922610932052, -830.1227111878602, -1249.6433155789214, -1419.473137609359, -584.3117749730116, -63.40340369614973, -432.35866408781055, -500.3730371708962, -895.3188741114316, -1343.3030652480984, -1200.081370891349, -924.9013224168577, -1035.6885531348344, -466.34146346417776, -745.212111352545, -211.08486079310157, -1323.3484651874094, -1099.4342693030173, -257.2815466356302, -857.4347538397567, -61.16729603309326, -221.5290103114165, -552.5278200470361, -1076.51293820698, -939.6542040876363, -712.639035021826, -858.8167336390602, -1024.5542180979503, -731.4801272904664, -1282.0969956426125, -1223.1956326800296, -1261.4595960100978, -1186.9487760362847, -522.1749315101519, -1474.1077651682115], "episode_lengths": [150, 51, 137, 50, 132, 150, 150, 150, 150, 92, 150, 150, 150, 107, 150, 125, 104, 150, 150, 97, 150, 150, 150, 74, 117, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 32, 150, 150, 150, 150, 87, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 67, 150, 150, 150, 73, 150, 150, 150, 150, 150, 85, 61, 124, 150, 150, 150, 150, 150, 120, 62, 133, 150, 150, 150, 150, 150, 150, 146, 150, 133, 150, 150, 70, 150, 62, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-779.6549137025711, -21.306087106145476, -636.450763392483, -25.976801101514713, -621.8109126164361, -1205.5979907886651, -732.8887025962247, -750.4509878793087, -527.6096620696453, -165.85020960696184, -1024.21561140625, -1119.4186599881043, -654.280120842499, -246.53405132066774, -558.6515446941098, -606.6543301762578, -411.8825804554824, -636.9869952999636, -744.9049775217258, -257.9177833169598, -1243.0120031673982, -678.7673157272516, -1147.2696676384626, -100.7433445582582, -385.13026706141085, -963.4118466227001, -647.6972862015767, -684.5926724392621, -617.7611452152187, -434.606052990553, -660.7397594208098, -159.85043503078106, -1129.1996693390304, -808.535946347268, -770.4711900708259, -23.640531019350767, -933.6521917356473, -1044.920607560621, -460.74356466977923, -876.0119040393603, -220.83823134325192, -560.2281105556858, -1252.247273073175, -1084.0095342083196, -1111.766945852646, -167.38804096350978, -1058.6613625097036, -862.3248715483496, -1413.3418251066691, -854.5755239296269, -815.3507395846862, -205.15261474630643, -930.6941667750172, -795.1283034251863, -785.7945140256484, -113.46229960867247, -687.6995384725518, -1135.5491980559373, -1049.1438105802006, -1186.3639795946112, -644.783176924093, -330.03326831418144, -107.4942583962509, -397.498400655793, -927.4422563200186, -819.9922610932052, -830.1227111878602, -1249.6433155789214, -1419.473137609359, -584.3117749730116, -63.40340369614973, -432.35866408781055, -500.3730371708962, -895.3188741114316, -1343.3030652480984, -1200.081370891349, -924.9013224168577, -1035.6885531348344, -466.34146346417776, -745.212111352545, -211.08486079310157, -1323.3484651874094, -1099.4342693030173, -257.2815466356302, -857.4347538397567, -61.16729603309326, -221.5290103114165, -552.5278200470361, -1076.51293820698, -939.6542040876363, -712.639035021826, -858.8167336390602, -1024.5542180979503, -731.4801272904664, -1282.0969956426125, -1223.1956326800296, -1261.4595960100978, -1186.9487760362847, -522.1749315101519, -1474.1077651682115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531324456319505, "mean_inference_ms": 1.6671521512960696, "mean_action_processing_ms": 0.27503407648834716, "mean_env_wait_ms": 3.4634029552759067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011929988861083984, "StateBufferConnector_ms": 0.008078813552856445, "ViewRequirementAgentConnector_ms": 0.20115447044372559}, "num_episodes": 28, "episode_return_max": -21.306087106145476, "episode_return_min": -1474.1077651682115, "episode_return_mean": -735.847473728659, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.77207025253716, "num_env_steps_trained_throughput_per_sec": 340.77207025253716, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12019.136, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12019.055, "sample_time_ms": 1129.079, "learn_time_ms": 10822.721, "learn_throughput": 369.593, "synch_weights_time_ms": 66.434}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "07142_00000", "date": "2024-08-04_10-17-32", "timestamp": 1722746852, "time_this_iter_s": 11.751030921936035, "time_total_s": 255.3197054862976, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449ac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 255.3197054862976, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.612500000000004, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.17191551526386, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.142033456265926, "policy_loss": -0.008191509389628966, "vf_loss": 4.16118626917402, "vf_explained_var": 0.9725701127201318, "kl": 0.017915031237316754, "entropy": 1.6335818062225977, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -18.3651530980415, "episode_reward_min": -1474.1077651682115, "episode_reward_mean": -758.5645572606982, "episode_len_mean": 132.41, "episode_media": {}, "episodes_timesteps_total": 13241, "policy_reward_min": {"policy_0": -1474.1077651682115}, "policy_reward_max": {"policy_0": -18.3651530980415}, "policy_reward_mean": {"policy_0": -758.5645572606982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1129.1996693390304, -808.535946347268, -770.4711900708259, -23.640531019350767, -933.6521917356473, -1044.920607560621, -460.74356466977923, -876.0119040393603, -220.83823134325192, -560.2281105556858, -1252.247273073175, -1084.0095342083196, -1111.766945852646, -167.38804096350978, -1058.6613625097036, -862.3248715483496, -1413.3418251066691, -854.5755239296269, -815.3507395846862, -205.15261474630643, -930.6941667750172, -795.1283034251863, -785.7945140256484, -113.46229960867247, -687.6995384725518, -1135.5491980559373, -1049.1438105802006, -1186.3639795946112, -644.783176924093, -330.03326831418144, -107.4942583962509, -397.498400655793, -927.4422563200186, -819.9922610932052, -830.1227111878602, -1249.6433155789214, -1419.473137609359, -584.3117749730116, -63.40340369614973, -432.35866408781055, -500.3730371708962, -895.3188741114316, -1343.3030652480984, -1200.081370891349, -924.9013224168577, -1035.6885531348344, -466.34146346417776, -745.212111352545, -211.08486079310157, -1323.3484651874094, -1099.4342693030173, -257.2815466356302, -857.4347538397567, -61.16729603309326, -221.5290103114165, -552.5278200470361, -1076.51293820698, -939.6542040876363, -712.639035021826, -858.8167336390602, -1024.5542180979503, -731.4801272904664, -1282.0969956426125, -1223.1956326800296, -1261.4595960100978, -1186.9487760362847, -522.1749315101519, -1474.1077651682115, -962.6328133489827, -535.4544231913175, -1395.2943063011705, -855.3596135262153, -407.08275060109776, -82.78453566286692, -25.63963564311094, -705.8562918996801, -159.0239233279824, -1101.9141698602039, -1426.431877950719, -18.3651530980415, -640.0304844556551, -760.2156038935404, -1404.8483550870299, -777.0898337638182, -968.4598194079348, -465.5085606364172, -970.0227490342166, -58.24087148495508, -1050.251452114075, -473.9912951198059, -1090.10319852615, -916.044336512642, -1174.8735376879833, -71.75259310102003, -672.0300727319418, -134.79851200395777, -75.78973713692345, -979.8735273546004, -245.4699619677771, -1119.0998387277536], "episode_lengths": [150, 150, 150, 32, 150, 150, 150, 150, 87, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 67, 150, 150, 150, 73, 150, 150, 150, 150, 150, 85, 61, 124, 150, 150, 150, 150, 150, 120, 62, 133, 150, 150, 150, 150, 150, 150, 146, 150, 133, 150, 150, 70, 150, 62, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 45, 150, 72, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 63, 150, 101, 150, 150, 150, 56, 150, 66, 66, 150, 150, 150], "policy_policy_0_reward": [-1129.1996693390304, -808.535946347268, -770.4711900708259, -23.640531019350767, -933.6521917356473, -1044.920607560621, -460.74356466977923, -876.0119040393603, -220.83823134325192, -560.2281105556858, -1252.247273073175, -1084.0095342083196, -1111.766945852646, -167.38804096350978, -1058.6613625097036, -862.3248715483496, -1413.3418251066691, -854.5755239296269, -815.3507395846862, -205.15261474630643, -930.6941667750172, -795.1283034251863, -785.7945140256484, -113.46229960867247, -687.6995384725518, -1135.5491980559373, -1049.1438105802006, -1186.3639795946112, -644.783176924093, -330.03326831418144, -107.4942583962509, -397.498400655793, -927.4422563200186, -819.9922610932052, -830.1227111878602, -1249.6433155789214, -1419.473137609359, -584.3117749730116, -63.40340369614973, -432.35866408781055, -500.3730371708962, -895.3188741114316, -1343.3030652480984, -1200.081370891349, -924.9013224168577, -1035.6885531348344, -466.34146346417776, -745.212111352545, -211.08486079310157, -1323.3484651874094, -1099.4342693030173, -257.2815466356302, -857.4347538397567, -61.16729603309326, -221.5290103114165, -552.5278200470361, -1076.51293820698, -939.6542040876363, -712.639035021826, -858.8167336390602, -1024.5542180979503, -731.4801272904664, -1282.0969956426125, -1223.1956326800296, -1261.4595960100978, -1186.9487760362847, -522.1749315101519, -1474.1077651682115, -962.6328133489827, -535.4544231913175, -1395.2943063011705, -855.3596135262153, -407.08275060109776, -82.78453566286692, -25.63963564311094, -705.8562918996801, -159.0239233279824, -1101.9141698602039, -1426.431877950719, -18.3651530980415, -640.0304844556551, -760.2156038935404, -1404.8483550870299, -777.0898337638182, -968.4598194079348, -465.5085606364172, -970.0227490342166, -58.24087148495508, -1050.251452114075, -473.9912951198059, -1090.10319852615, -916.044336512642, -1174.8735376879833, -71.75259310102003, -672.0300727319418, -134.79851200395777, -75.78973713692345, -979.8735273546004, -245.4699619677771, -1119.0998387277536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526907109538438, "mean_inference_ms": 1.666229750256324, "mean_action_processing_ms": 0.2748617483598526, "mean_env_wait_ms": 3.4685256939055877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012079477310180664, "StateBufferConnector_ms": 0.008029699325561523, "ViewRequirementAgentConnector_ms": 0.20026803016662598}, "num_episodes": 32, "episode_return_max": -18.3651530980415, "episode_return_min": -1474.1077651682115, "episode_return_mean": -758.5645572606982, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.27549728881957, "num_env_steps_trained_throughput_per_sec": 409.27549728881957, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 11707.948, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11707.871, "sample_time_ms": 1129.944, "learn_time_ms": 10511.691, "learn_throughput": 380.529, "synch_weights_time_ms": 65.415}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "07142_00000", "date": "2024-08-04_10-17-42", "timestamp": 1722746862, "time_this_iter_s": 9.785163402557373, "time_total_s": 265.104868888855, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724415ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.104868888855, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.035714285714285, "ram_util_percent": 28.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.93957438667616, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.263039421786865, "policy_loss": -0.013186171704728623, "vf_loss": 4.285375112046798, "vf_explained_var": 0.9746057216698925, "kl": 0.019364888835358855, "entropy": 1.4958996967722973, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -6.7300916103003265, "episode_reward_min": -1474.1077651682115, "episode_reward_mean": -731.2698504779815, "episode_len_mean": 131.55, "episode_media": {}, "episodes_timesteps_total": 13155, "policy_reward_min": {"policy_0": -1474.1077651682115}, "policy_reward_max": {"policy_0": -6.7300916103003265}, "policy_reward_mean": {"policy_0": -731.2698504779815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-397.498400655793, -927.4422563200186, -819.9922610932052, -830.1227111878602, -1249.6433155789214, -1419.473137609359, -584.3117749730116, -63.40340369614973, -432.35866408781055, -500.3730371708962, -895.3188741114316, -1343.3030652480984, -1200.081370891349, -924.9013224168577, -1035.6885531348344, -466.34146346417776, -745.212111352545, -211.08486079310157, -1323.3484651874094, -1099.4342693030173, -257.2815466356302, -857.4347538397567, -61.16729603309326, -221.5290103114165, -552.5278200470361, -1076.51293820698, -939.6542040876363, -712.639035021826, -858.8167336390602, -1024.5542180979503, -731.4801272904664, -1282.0969956426125, -1223.1956326800296, -1261.4595960100978, -1186.9487760362847, -522.1749315101519, -1474.1077651682115, -962.6328133489827, -535.4544231913175, -1395.2943063011705, -855.3596135262153, -407.08275060109776, -82.78453566286692, -25.63963564311094, -705.8562918996801, -159.0239233279824, -1101.9141698602039, -1426.431877950719, -18.3651530980415, -640.0304844556551, -760.2156038935404, -1404.8483550870299, -777.0898337638182, -968.4598194079348, -465.5085606364172, -970.0227490342166, -58.24087148495508, -1050.251452114075, -473.9912951198059, -1090.10319852615, -916.044336512642, -1174.8735376879833, -71.75259310102003, -672.0300727319418, -134.79851200395777, -75.78973713692345, -979.8735273546004, -245.4699619677771, -1119.0998387277536, -849.3522753460419, -1244.3030931543612, -35.72387182227068, -48.57354234713624, -57.301687516416955, -429.9237742293272, -468.9333520981056, -1251.329147623565, -1100.9656154127508, -1010.9418248038372, -6.7300916103003265, -729.0102823215983, -1226.0626483296028, -552.22344014081, -824.2023479290849, -389.161757135537, -1137.004928915235, -812.1218118364768, -511.2952568766377, -1132.8800958058882, -247.82418943943964, -547.4305744750922, -1411.1062100463537, -667.6580579783786, -1025.8313576180547, -693.3471512170469, -128.50159388221425, -639.4364036499461, -832.17739677891, -509.04073754333837, -169.34199622072757], "episode_lengths": [124, 150, 150, 150, 150, 150, 120, 62, 133, 150, 150, 150, 150, 150, 150, 146, 150, 133, 150, 150, 70, 150, 62, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 45, 150, 72, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 63, 150, 101, 150, 150, 150, 56, 150, 66, 66, 150, 150, 150, 150, 150, 47, 54, 56, 142, 123, 150, 150, 150, 43, 150, 150, 124, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 79, 150, 150, 150, 94], "policy_policy_0_reward": [-397.498400655793, -927.4422563200186, -819.9922610932052, -830.1227111878602, -1249.6433155789214, -1419.473137609359, -584.3117749730116, -63.40340369614973, -432.35866408781055, -500.3730371708962, -895.3188741114316, -1343.3030652480984, -1200.081370891349, -924.9013224168577, -1035.6885531348344, -466.34146346417776, -745.212111352545, -211.08486079310157, -1323.3484651874094, -1099.4342693030173, -257.2815466356302, -857.4347538397567, -61.16729603309326, -221.5290103114165, -552.5278200470361, -1076.51293820698, -939.6542040876363, -712.639035021826, -858.8167336390602, -1024.5542180979503, -731.4801272904664, -1282.0969956426125, -1223.1956326800296, -1261.4595960100978, -1186.9487760362847, -522.1749315101519, -1474.1077651682115, -962.6328133489827, -535.4544231913175, -1395.2943063011705, -855.3596135262153, -407.08275060109776, -82.78453566286692, -25.63963564311094, -705.8562918996801, -159.0239233279824, -1101.9141698602039, -1426.431877950719, -18.3651530980415, -640.0304844556551, -760.2156038935404, -1404.8483550870299, -777.0898337638182, -968.4598194079348, -465.5085606364172, -970.0227490342166, -58.24087148495508, -1050.251452114075, -473.9912951198059, -1090.10319852615, -916.044336512642, -1174.8735376879833, -71.75259310102003, -672.0300727319418, -134.79851200395777, -75.78973713692345, -979.8735273546004, -245.4699619677771, -1119.0998387277536, -849.3522753460419, -1244.3030931543612, -35.72387182227068, -48.57354234713624, -57.301687516416955, -429.9237742293272, -468.9333520981056, -1251.329147623565, -1100.9656154127508, -1010.9418248038372, -6.7300916103003265, -729.0102823215983, -1226.0626483296028, -552.22344014081, -824.2023479290849, -389.161757135537, -1137.004928915235, -812.1218118364768, -511.2952568766377, -1132.8800958058882, -247.82418943943964, -547.4305744750922, -1411.1062100463537, -667.6580579783786, -1025.8313576180547, -693.3471512170469, -128.50159388221425, -639.4364036499461, -832.17739677891, -509.04073754333837, -169.34199622072757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552279229205023, "mean_inference_ms": 1.6655053222279326, "mean_action_processing_ms": 0.2747944414327546, "mean_env_wait_ms": 3.4700211490335806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012017250061035156, "StateBufferConnector_ms": 0.008039712905883789, "ViewRequirementAgentConnector_ms": 0.19545197486877441}, "num_episodes": 31, "episode_return_max": -6.7300916103003265, "episode_return_min": -1474.1077651682115, "episode_return_mean": -731.2698504779815, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.23085135294264, "num_env_steps_trained_throughput_per_sec": 343.23085135294264, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 11589.995, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11589.919, "sample_time_ms": 1129.074, "learn_time_ms": 10393.899, "learn_throughput": 384.841, "synch_weights_time_ms": 66.144}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "07142_00000", "date": "2024-08-04_10-17-54", "timestamp": 1722746874, "time_this_iter_s": 11.668013572692871, "time_total_s": 276.77288246154785, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724415f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.77288246154785, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.223529411764705, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.00521083275478, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.062832680592934, "policy_loss": -0.010030318402277772, "vf_loss": 5.081660307447115, "vf_explained_var": 0.9672091700757544, "kl": 0.024680578099044732, "entropy": 1.6201477783421676, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -6.7300916103003265, "episode_reward_min": -1474.1077651682115, "episode_reward_mean": -714.3511669894689, "episode_len_mean": 127.61, "episode_media": {}, "episodes_timesteps_total": 12761, "policy_reward_min": {"policy_0": -1474.1077651682115}, "policy_reward_max": {"policy_0": -6.7300916103003265}, "policy_reward_mean": {"policy_0": -714.3511669894689}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1261.4595960100978, -1186.9487760362847, -522.1749315101519, -1474.1077651682115, -962.6328133489827, -535.4544231913175, -1395.2943063011705, -855.3596135262153, -407.08275060109776, -82.78453566286692, -25.63963564311094, -705.8562918996801, -159.0239233279824, -1101.9141698602039, -1426.431877950719, -18.3651530980415, -640.0304844556551, -760.2156038935404, -1404.8483550870299, -777.0898337638182, -968.4598194079348, -465.5085606364172, -970.0227490342166, -58.24087148495508, -1050.251452114075, -473.9912951198059, -1090.10319852615, -916.044336512642, -1174.8735376879833, -71.75259310102003, -672.0300727319418, -134.79851200395777, -75.78973713692345, -979.8735273546004, -245.4699619677771, -1119.0998387277536, -849.3522753460419, -1244.3030931543612, -35.72387182227068, -48.57354234713624, -57.301687516416955, -429.9237742293272, -468.9333520981056, -1251.329147623565, -1100.9656154127508, -1010.9418248038372, -6.7300916103003265, -729.0102823215983, -1226.0626483296028, -552.22344014081, -824.2023479290849, -389.161757135537, -1137.004928915235, -812.1218118364768, -511.2952568766377, -1132.8800958058882, -247.82418943943964, -547.4305744750922, -1411.1062100463537, -667.6580579783786, -1025.8313576180547, -693.3471512170469, -128.50159388221425, -639.4364036499461, -832.17739677891, -509.04073754333837, -169.34199622072757, -965.1575533725668, -101.6203645875411, -917.4445740841625, -1134.1727944855156, -1001.543842682177, -383.43135527846636, -1387.8616637050345, -286.4018141193531, -1311.7697586238685, -30.150723114817964, -168.51203695925358, -21.76535291752122, -810.0893149440113, -789.5366303391389, -137.66007583852877, -264.15471737408564, -1318.8232019854681, -588.3440213990986, -1325.2854300271813, -644.2967178952879, -661.5450391007313, -1045.9701845540244, -29.04142649377086, -913.8389105735791, -800.6365883744406, -1084.4514647551912, -508.700975634415, -950.0459676150434, -1012.4532231089318, -1152.06125717206, -203.85307211879942, -1277.5144233458248, -1348.2208043781864], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 45, 150, 72, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 63, 150, 101, 150, 150, 150, 56, 150, 66, 66, 150, 150, 150, 150, 150, 47, 54, 56, 142, 123, 150, 150, 150, 43, 150, 150, 124, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 79, 150, 150, 150, 94, 150, 65, 150, 150, 150, 150, 150, 86, 150, 37, 69, 37, 150, 145, 65, 70, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150], "policy_policy_0_reward": [-1261.4595960100978, -1186.9487760362847, -522.1749315101519, -1474.1077651682115, -962.6328133489827, -535.4544231913175, -1395.2943063011705, -855.3596135262153, -407.08275060109776, -82.78453566286692, -25.63963564311094, -705.8562918996801, -159.0239233279824, -1101.9141698602039, -1426.431877950719, -18.3651530980415, -640.0304844556551, -760.2156038935404, -1404.8483550870299, -777.0898337638182, -968.4598194079348, -465.5085606364172, -970.0227490342166, -58.24087148495508, -1050.251452114075, -473.9912951198059, -1090.10319852615, -916.044336512642, -1174.8735376879833, -71.75259310102003, -672.0300727319418, -134.79851200395777, -75.78973713692345, -979.8735273546004, -245.4699619677771, -1119.0998387277536, -849.3522753460419, -1244.3030931543612, -35.72387182227068, -48.57354234713624, -57.301687516416955, -429.9237742293272, -468.9333520981056, -1251.329147623565, -1100.9656154127508, -1010.9418248038372, -6.7300916103003265, -729.0102823215983, -1226.0626483296028, -552.22344014081, -824.2023479290849, -389.161757135537, -1137.004928915235, -812.1218118364768, -511.2952568766377, -1132.8800958058882, -247.82418943943964, -547.4305744750922, -1411.1062100463537, -667.6580579783786, -1025.8313576180547, -693.3471512170469, -128.50159388221425, -639.4364036499461, -832.17739677891, -509.04073754333837, -169.34199622072757, -965.1575533725668, -101.6203645875411, -917.4445740841625, -1134.1727944855156, -1001.543842682177, -383.43135527846636, -1387.8616637050345, -286.4018141193531, -1311.7697586238685, -30.150723114817964, -168.51203695925358, -21.76535291752122, -810.0893149440113, -789.5366303391389, -137.66007583852877, -264.15471737408564, -1318.8232019854681, -588.3440213990986, -1325.2854300271813, -644.2967178952879, -661.5450391007313, -1045.9701845540244, -29.04142649377086, -913.8389105735791, -800.6365883744406, -1084.4514647551912, -508.700975634415, -950.0459676150434, -1012.4532231089318, -1152.06125717206, -203.85307211879942, -1277.5144233458248, -1348.2208043781864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525739113586474, "mean_inference_ms": 1.664538585088044, "mean_action_processing_ms": 0.274805705133636, "mean_env_wait_ms": 3.4716914942426733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012083768844604492, "StateBufferConnector_ms": 0.007924556732177734, "ViewRequirementAgentConnector_ms": 0.19359230995178223}, "num_episodes": 33, "episode_return_max": -6.7300916103003265, "episode_return_min": -1474.1077651682115, "episode_return_mean": -714.3511669894689, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.794694881358, "num_env_steps_trained_throughput_per_sec": 331.794694881358, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11505.855, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11505.779, "sample_time_ms": 1129.668, "learn_time_ms": 10309.462, "learn_throughput": 387.993, "synch_weights_time_ms": 65.846}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "07142_00000", "date": "2024-08-04_10-18-06", "timestamp": 1722746886, "time_this_iter_s": 12.06733751296997, "time_total_s": 288.8402199745178, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f868148700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.8402199745178, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.352941176470587, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.2401559114456, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.561544722567002, "policy_loss": -0.00797189876708823, "vf_loss": 4.577312132219474, "vf_explained_var": 0.9738452928761642, "kl": 0.014626387742919179, "entropy": 1.4377389951298634, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": 0.5887906313058502, "episode_reward_min": -1437.83008165941, "episode_reward_mean": -665.543940256252, "episode_len_mean": 122.38, "episode_media": {}, "episodes_timesteps_total": 12238, "policy_reward_min": {"policy_0": -1437.83008165941}, "policy_reward_max": {"policy_0": 0.5887906313058502}, "policy_reward_mean": {"policy_0": -665.543940256252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-849.3522753460419, -1244.3030931543612, -35.72387182227068, -48.57354234713624, -57.301687516416955, -429.9237742293272, -468.9333520981056, -1251.329147623565, -1100.9656154127508, -1010.9418248038372, -6.7300916103003265, -729.0102823215983, -1226.0626483296028, -552.22344014081, -824.2023479290849, -389.161757135537, -1137.004928915235, -812.1218118364768, -511.2952568766377, -1132.8800958058882, -247.82418943943964, -547.4305744750922, -1411.1062100463537, -667.6580579783786, -1025.8313576180547, -693.3471512170469, -128.50159388221425, -639.4364036499461, -832.17739677891, -509.04073754333837, -169.34199622072757, -965.1575533725668, -101.6203645875411, -917.4445740841625, -1134.1727944855156, -1001.543842682177, -383.43135527846636, -1387.8616637050345, -286.4018141193531, -1311.7697586238685, -30.150723114817964, -168.51203695925358, -21.76535291752122, -810.0893149440113, -789.5366303391389, -137.66007583852877, -264.15471737408564, -1318.8232019854681, -588.3440213990986, -1325.2854300271813, -644.2967178952879, -661.5450391007313, -1045.9701845540244, -29.04142649377086, -913.8389105735791, -800.6365883744406, -1084.4514647551912, -508.700975634415, -950.0459676150434, -1012.4532231089318, -1152.06125717206, -203.85307211879942, -1277.5144233458248, -1348.2208043781864, -468.1087630861785, -1056.0412227822248, -1297.9642803906156, -61.32105893442179, -27.063122436322825, -1095.3465406374844, -93.89015328625966, 0.5887906313058502, -150.17651207070995, -546.598160433664, -696.7768400598039, -235.888582147303, -1138.0534749344126, -560.1432149371036, -1408.78403837505, -633.1192958463465, -95.11268177293853, -1185.079420513176, -1091.4590651853975, -717.9630680343006, -1017.6873506023815, -239.36918525254006, -55.185196976305456, -1245.3926599176018, -15.179587337694455, -787.1588309424305, -250.27775049777267, -225.2746926795055, -592.9565879023229, -1068.82723202627, -48.498918988918845, -83.3087674938523, -218.00916534769593, -1054.7594756896692, -1437.83008165941, -390.28604201584784], "episode_lengths": [150, 150, 47, 54, 56, 142, 123, 150, 150, 150, 43, 150, 150, 124, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 79, 150, 150, 150, 94, 150, 65, 150, 150, 150, 150, 150, 86, 150, 37, 69, 37, 150, 145, 65, 70, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 57, 48, 150, 49, 31, 81, 150, 150, 80, 150, 138, 150, 148, 68, 150, 150, 150, 150, 94, 64, 150, 45, 150, 80, 98, 148, 150, 56, 62, 62, 150, 150, 118], "policy_policy_0_reward": [-849.3522753460419, -1244.3030931543612, -35.72387182227068, -48.57354234713624, -57.301687516416955, -429.9237742293272, -468.9333520981056, -1251.329147623565, -1100.9656154127508, -1010.9418248038372, -6.7300916103003265, -729.0102823215983, -1226.0626483296028, -552.22344014081, -824.2023479290849, -389.161757135537, -1137.004928915235, -812.1218118364768, -511.2952568766377, -1132.8800958058882, -247.82418943943964, -547.4305744750922, -1411.1062100463537, -667.6580579783786, -1025.8313576180547, -693.3471512170469, -128.50159388221425, -639.4364036499461, -832.17739677891, -509.04073754333837, -169.34199622072757, -965.1575533725668, -101.6203645875411, -917.4445740841625, -1134.1727944855156, -1001.543842682177, -383.43135527846636, -1387.8616637050345, -286.4018141193531, -1311.7697586238685, -30.150723114817964, -168.51203695925358, -21.76535291752122, -810.0893149440113, -789.5366303391389, -137.66007583852877, -264.15471737408564, -1318.8232019854681, -588.3440213990986, -1325.2854300271813, -644.2967178952879, -661.5450391007313, -1045.9701845540244, -29.04142649377086, -913.8389105735791, -800.6365883744406, -1084.4514647551912, -508.700975634415, -950.0459676150434, -1012.4532231089318, -1152.06125717206, -203.85307211879942, -1277.5144233458248, -1348.2208043781864, -468.1087630861785, -1056.0412227822248, -1297.9642803906156, -61.32105893442179, -27.063122436322825, -1095.3465406374844, -93.89015328625966, 0.5887906313058502, -150.17651207070995, -546.598160433664, -696.7768400598039, -235.888582147303, -1138.0534749344126, -560.1432149371036, -1408.78403837505, -633.1192958463465, -95.11268177293853, -1185.079420513176, -1091.4590651853975, -717.9630680343006, -1017.6873506023815, -239.36918525254006, -55.185196976305456, -1245.3926599176018, -15.179587337694455, -787.1588309424305, -250.27775049777267, -225.2746926795055, -592.9565879023229, -1068.82723202627, -48.498918988918845, -83.3087674938523, -218.00916534769593, -1054.7594756896692, -1437.83008165941, -390.28604201584784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530977038325346, "mean_inference_ms": 1.6651429866331109, "mean_action_processing_ms": 0.2746145489137893, "mean_env_wait_ms": 3.4701294979060067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01221013069152832, "StateBufferConnector_ms": 0.007888555526733398, "ViewRequirementAgentConnector_ms": 0.19414544105529785}, "num_episodes": 36, "episode_return_max": 0.5887906313058502, "episode_return_min": -1437.83008165941, "episode_return_mean": -665.543940256252, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.14617810419406, "num_env_steps_trained_throughput_per_sec": 318.14617810419406, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 11463.624, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11463.553, "sample_time_ms": 1135.037, "learn_time_ms": 10262.904, "learn_throughput": 389.753, "synch_weights_time_ms": 64.809}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "07142_00000", "date": "2024-08-04_10-18-19", "timestamp": 1722746899, "time_this_iter_s": 12.586026906967163, "time_total_s": 301.426246881485, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724499ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 301.426246881485, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.1, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 269.5926822980245, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.087541200220585, "policy_loss": -0.007497548282359882, "vf_loss": 4.106354229152203, "vf_explained_var": 0.9622712421541413, "kl": 0.01377487806288021, "entropy": 1.7514183760931095, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 1.5561156462273102, "episode_reward_min": -1597.0033520813006, "episode_reward_mean": -684.7620299181751, "episode_len_mean": 120.38, "episode_media": {}, "episodes_timesteps_total": 12038, "policy_reward_min": {"policy_0": -1597.0033520813006}, "policy_reward_max": {"policy_0": 1.5561156462273102}, "policy_reward_mean": {"policy_0": -684.7620299181751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1134.1727944855156, -1001.543842682177, -383.43135527846636, -1387.8616637050345, -286.4018141193531, -1311.7697586238685, -30.150723114817964, -168.51203695925358, -21.76535291752122, -810.0893149440113, -789.5366303391389, -137.66007583852877, -264.15471737408564, -1318.8232019854681, -588.3440213990986, -1325.2854300271813, -644.2967178952879, -661.5450391007313, -1045.9701845540244, -29.04142649377086, -913.8389105735791, -800.6365883744406, -1084.4514647551912, -508.700975634415, -950.0459676150434, -1012.4532231089318, -1152.06125717206, -203.85307211879942, -1277.5144233458248, -1348.2208043781864, -468.1087630861785, -1056.0412227822248, -1297.9642803906156, -61.32105893442179, -27.063122436322825, -1095.3465406374844, -93.89015328625966, 0.5887906313058502, -150.17651207070995, -546.598160433664, -696.7768400598039, -235.888582147303, -1138.0534749344126, -560.1432149371036, -1408.78403837505, -633.1192958463465, -95.11268177293853, -1185.079420513176, -1091.4590651853975, -717.9630680343006, -1017.6873506023815, -239.36918525254006, -55.185196976305456, -1245.3926599176018, -15.179587337694455, -787.1588309424305, -250.27775049777267, -225.2746926795055, -592.9565879023229, -1068.82723202627, -48.498918988918845, -83.3087674938523, -218.00916534769593, -1054.7594756896692, -1437.83008165941, -390.28604201584784, -1308.7642868666842, -1319.1202367206643, -750.6550745526217, -166.43629196283632, -1130.8150358496337, -1323.8464585730535, -298.8425380503679, -585.1920766840301, -835.4998329664819, -1080.8877804800288, -1034.7297107807449, -875.9648364856572, -227.27100896064005, 1.5561156462273102, -992.9884444436926, -297.19835020033366, -932.8360894963195, -298.39207617329987, -50.33623613699356, -867.5565280736017, -1223.2704245022712, -69.00062205599865, -865.2388275955473, -884.1107713653842, -486.89641512974777, -1597.0033520813006, -1394.7839109980875, -128.56859842052398, -821.8340905794304, -979.1974129075505, -930.6806135851485, -707.7532895393027, -73.70356233573945, -57.94930343357008], "episode_lengths": [150, 150, 150, 150, 86, 150, 37, 69, 37, 150, 145, 65, 70, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 57, 48, 150, 49, 31, 81, 150, 150, 80, 150, 138, 150, 148, 68, 150, 150, 150, 150, 94, 64, 150, 45, 150, 80, 98, 148, 150, 56, 62, 62, 150, 150, 118, 150, 150, 150, 69, 150, 150, 105, 116, 150, 150, 150, 150, 125, 35, 150, 110, 150, 88, 57, 150, 150, 54, 150, 150, 108, 150, 150, 55, 150, 150, 150, 150, 63, 38], "policy_policy_0_reward": [-1134.1727944855156, -1001.543842682177, -383.43135527846636, -1387.8616637050345, -286.4018141193531, -1311.7697586238685, -30.150723114817964, -168.51203695925358, -21.76535291752122, -810.0893149440113, -789.5366303391389, -137.66007583852877, -264.15471737408564, -1318.8232019854681, -588.3440213990986, -1325.2854300271813, -644.2967178952879, -661.5450391007313, -1045.9701845540244, -29.04142649377086, -913.8389105735791, -800.6365883744406, -1084.4514647551912, -508.700975634415, -950.0459676150434, -1012.4532231089318, -1152.06125717206, -203.85307211879942, -1277.5144233458248, -1348.2208043781864, -468.1087630861785, -1056.0412227822248, -1297.9642803906156, -61.32105893442179, -27.063122436322825, -1095.3465406374844, -93.89015328625966, 0.5887906313058502, -150.17651207070995, -546.598160433664, -696.7768400598039, -235.888582147303, -1138.0534749344126, -560.1432149371036, -1408.78403837505, -633.1192958463465, -95.11268177293853, -1185.079420513176, -1091.4590651853975, -717.9630680343006, -1017.6873506023815, -239.36918525254006, -55.185196976305456, -1245.3926599176018, -15.179587337694455, -787.1588309424305, -250.27775049777267, -225.2746926795055, -592.9565879023229, -1068.82723202627, -48.498918988918845, -83.3087674938523, -218.00916534769593, -1054.7594756896692, -1437.83008165941, -390.28604201584784, -1308.7642868666842, -1319.1202367206643, -750.6550745526217, -166.43629196283632, -1130.8150358496337, -1323.8464585730535, -298.8425380503679, -585.1920766840301, -835.4998329664819, -1080.8877804800288, -1034.7297107807449, -875.9648364856572, -227.27100896064005, 1.5561156462273102, -992.9884444436926, -297.19835020033366, -932.8360894963195, -298.39207617329987, -50.33623613699356, -867.5565280736017, -1223.2704245022712, -69.00062205599865, -865.2388275955473, -884.1107713653842, -486.89641512974777, -1597.0033520813006, -1394.7839109980875, -128.56859842052398, -821.8340905794304, -979.1974129075505, -930.6806135851485, -707.7532895393027, -73.70356233573945, -57.94930343357008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532780801811961, "mean_inference_ms": 1.6651839426406059, "mean_action_processing_ms": 0.27415576480984116, "mean_env_wait_ms": 3.4716017135960597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012591838836669922, "StateBufferConnector_ms": 0.007797956466674805, "ViewRequirementAgentConnector_ms": 0.1913294792175293}, "num_episodes": 34, "episode_return_max": 1.5561156462273102, "episode_return_min": -1597.0033520813006, "episode_return_mean": -684.7620299181751, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.3604857402486, "num_env_steps_trained_throughput_per_sec": 315.3604857402486, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 11444.529, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11444.456, "sample_time_ms": 1137.921, "learn_time_ms": 10239.628, "learn_throughput": 390.639, "synch_weights_time_ms": 66.112}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "07142_00000", "date": "2024-08-04_10-18-31", "timestamp": 1722746911, "time_this_iter_s": 12.697608470916748, "time_total_s": 314.12385535240173, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724415f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 314.12385535240173, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.78333333333333, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 250.44985477725666, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.702677920584877, "policy_loss": -0.008562954946925553, "vf_loss": 3.721584565689166, "vf_explained_var": 0.9896745989099145, "kl": 0.016534972349199994, "entropy": 1.7784425284713508, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 1.5561156462273102, "episode_reward_min": -1597.0033520813006, "episode_reward_mean": -658.186294939925, "episode_len_mean": 116.17, "episode_media": {}, "episodes_timesteps_total": 11617, "policy_reward_min": {"policy_0": -1597.0033520813006}, "policy_reward_max": {"policy_0": 1.5561156462273102}, "policy_reward_mean": {"policy_0": -658.186294939925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.32105893442179, -27.063122436322825, -1095.3465406374844, -93.89015328625966, 0.5887906313058502, -150.17651207070995, -546.598160433664, -696.7768400598039, -235.888582147303, -1138.0534749344126, -560.1432149371036, -1408.78403837505, -633.1192958463465, -95.11268177293853, -1185.079420513176, -1091.4590651853975, -717.9630680343006, -1017.6873506023815, -239.36918525254006, -55.185196976305456, -1245.3926599176018, -15.179587337694455, -787.1588309424305, -250.27775049777267, -225.2746926795055, -592.9565879023229, -1068.82723202627, -48.498918988918845, -83.3087674938523, -218.00916534769593, -1054.7594756896692, -1437.83008165941, -390.28604201584784, -1308.7642868666842, -1319.1202367206643, -750.6550745526217, -166.43629196283632, -1130.8150358496337, -1323.8464585730535, -298.8425380503679, -585.1920766840301, -835.4998329664819, -1080.8877804800288, -1034.7297107807449, -875.9648364856572, -227.27100896064005, 1.5561156462273102, -992.9884444436926, -297.19835020033366, -932.8360894963195, -298.39207617329987, -50.33623613699356, -867.5565280736017, -1223.2704245022712, -69.00062205599865, -865.2388275955473, -884.1107713653842, -486.89641512974777, -1597.0033520813006, -1394.7839109980875, -128.56859842052398, -821.8340905794304, -979.1974129075505, -930.6806135851485, -707.7532895393027, -73.70356233573945, -57.94930343357008, -1069.2789446152299, -1189.523912403373, -922.4775662385833, -73.04487533720027, -79.69204747293296, -129.35369758670444, -1247.7130315419233, -1224.4208446167195, -930.5359075737622, -923.1025896151169, -1096.6197797321583, -58.01259433230159, -388.48458117503014, -1122.031548486802, -936.1185888787588, -1103.8607624690624, -1212.1671268354492, -1144.2625844847626, -27.360418377891833, -140.8966585256745, -229.51751241864434, -63.64339090149171, -375.60103554010567, -1291.3075826901263, -1235.601505629381, -1120.317788216691, -103.83116839647583, -1011.2631680681583, -9.875260826019163, -328.82316467637673, -115.5076891639555, -1044.6699715595644, -807.756258961405], "episode_lengths": [57, 48, 150, 49, 31, 81, 150, 150, 80, 150, 138, 150, 148, 68, 150, 150, 150, 150, 94, 64, 150, 45, 150, 80, 98, 148, 150, 56, 62, 62, 150, 150, 118, 150, 150, 150, 69, 150, 150, 105, 116, 150, 150, 150, 150, 125, 35, 150, 110, 150, 88, 57, 150, 150, 54, 150, 150, 108, 150, 150, 55, 150, 150, 150, 150, 63, 38, 150, 150, 150, 62, 70, 62, 150, 150, 150, 150, 150, 60, 104, 150, 150, 150, 150, 150, 34, 75, 80, 61, 123, 150, 150, 150, 64, 150, 34, 87, 51, 150, 150], "policy_policy_0_reward": [-61.32105893442179, -27.063122436322825, -1095.3465406374844, -93.89015328625966, 0.5887906313058502, -150.17651207070995, -546.598160433664, -696.7768400598039, -235.888582147303, -1138.0534749344126, -560.1432149371036, -1408.78403837505, -633.1192958463465, -95.11268177293853, -1185.079420513176, -1091.4590651853975, -717.9630680343006, -1017.6873506023815, -239.36918525254006, -55.185196976305456, -1245.3926599176018, -15.179587337694455, -787.1588309424305, -250.27775049777267, -225.2746926795055, -592.9565879023229, -1068.82723202627, -48.498918988918845, -83.3087674938523, -218.00916534769593, -1054.7594756896692, -1437.83008165941, -390.28604201584784, -1308.7642868666842, -1319.1202367206643, -750.6550745526217, -166.43629196283632, -1130.8150358496337, -1323.8464585730535, -298.8425380503679, -585.1920766840301, -835.4998329664819, -1080.8877804800288, -1034.7297107807449, -875.9648364856572, -227.27100896064005, 1.5561156462273102, -992.9884444436926, -297.19835020033366, -932.8360894963195, -298.39207617329987, -50.33623613699356, -867.5565280736017, -1223.2704245022712, -69.00062205599865, -865.2388275955473, -884.1107713653842, -486.89641512974777, -1597.0033520813006, -1394.7839109980875, -128.56859842052398, -821.8340905794304, -979.1974129075505, -930.6806135851485, -707.7532895393027, -73.70356233573945, -57.94930343357008, -1069.2789446152299, -1189.523912403373, -922.4775662385833, -73.04487533720027, -79.69204747293296, -129.35369758670444, -1247.7130315419233, -1224.4208446167195, -930.5359075737622, -923.1025896151169, -1096.6197797321583, -58.01259433230159, -388.48458117503014, -1122.031548486802, -936.1185888787588, -1103.8607624690624, -1212.1671268354492, -1144.2625844847626, -27.360418377891833, -140.8966585256745, -229.51751241864434, -63.64339090149171, -375.60103554010567, -1291.3075826901263, -1235.601505629381, -1120.317788216691, -103.83116839647583, -1011.2631680681583, -9.875260826019163, -328.82316467637673, -115.5076891639555, -1044.6699715595644, -807.756258961405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553077837735065, "mean_inference_ms": 1.6658627225171074, "mean_action_processing_ms": 0.2742308704438937, "mean_env_wait_ms": 3.4744325000372642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013315677642822266, "StateBufferConnector_ms": 0.007835149765014648, "ViewRequirementAgentConnector_ms": 0.19194722175598145}, "num_episodes": 33, "episode_return_max": 1.5561156462273102, "episode_return_min": -1597.0033520813006, "episode_return_mean": -658.186294939925, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.151498091159, "num_env_steps_trained_throughput_per_sec": 342.151498091159, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 11343.973, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11343.898, "sample_time_ms": 1138.39, "learn_time_ms": 10139.404, "learn_throughput": 394.501, "synch_weights_time_ms": 65.311}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "07142_00000", "date": "2024-08-04_10-18-43", "timestamp": 1722746923, "time_this_iter_s": 11.70275068283081, "time_total_s": 325.82660603523254, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449b9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.82660603523254, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.28235294117647, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.8611764808496, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.8103460110723972, "policy_loss": -0.00828117830484795, "vf_loss": 3.825202642629544, "vf_explained_var": 0.9845260616391898, "kl": 0.01621494803751681, "entropy": 1.3872169877092044, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 1.5561156462273102, "episode_reward_min": -1597.0033520813006, "episode_reward_mean": -652.688843793412, "episode_len_mean": 116.54, "episode_media": {}, "episodes_timesteps_total": 11654, "policy_reward_min": {"policy_0": -1597.0033520813006}, "policy_reward_max": {"policy_0": 1.5561156462273102}, "policy_reward_mean": {"policy_0": -652.688843793412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1323.8464585730535, -298.8425380503679, -585.1920766840301, -835.4998329664819, -1080.8877804800288, -1034.7297107807449, -875.9648364856572, -227.27100896064005, 1.5561156462273102, -992.9884444436926, -297.19835020033366, -932.8360894963195, -298.39207617329987, -50.33623613699356, -867.5565280736017, -1223.2704245022712, -69.00062205599865, -865.2388275955473, -884.1107713653842, -486.89641512974777, -1597.0033520813006, -1394.7839109980875, -128.56859842052398, -821.8340905794304, -979.1974129075505, -930.6806135851485, -707.7532895393027, -73.70356233573945, -57.94930343357008, -1069.2789446152299, -1189.523912403373, -922.4775662385833, -73.04487533720027, -79.69204747293296, -129.35369758670444, -1247.7130315419233, -1224.4208446167195, -930.5359075737622, -923.1025896151169, -1096.6197797321583, -58.01259433230159, -388.48458117503014, -1122.031548486802, -936.1185888787588, -1103.8607624690624, -1212.1671268354492, -1144.2625844847626, -27.360418377891833, -140.8966585256745, -229.51751241864434, -63.64339090149171, -375.60103554010567, -1291.3075826901263, -1235.601505629381, -1120.317788216691, -103.83116839647583, -1011.2631680681583, -9.875260826019163, -328.82316467637673, -115.5076891639555, -1044.6699715595644, -807.756258961405, -1075.1639588179119, -304.5713398434546, -237.01851876384532, -399.3567237487067, -56.663515528875266, -1080.3751224676269, -61.26124010366645, -1114.1500096427324, -791.6884695414778, -1486.1680921866216, -58.60579022668715, -1370.4379002342268, -1207.454830414352, -951.6374836087122, -557.2658316010663, -1238.7941937135952, -1119.217242468882, -986.6834688223253, -1031.7775128570945, -28.974491573296678, -261.5275631101331, -130.80409500590844, -86.52701667030298, -85.06057003214467, -142.08908329049706, -140.97724363454284, -148.59139946784092, -1206.6014763970834, -157.10655237112573, -737.6804631774909, -11.505379859871445, -429.7445856100661, -359.9979611607404, -928.1182683386834, -798.2985082501231, -97.97254587414207, -658.8172779127574, -1053.5480492761333], "episode_lengths": [150, 105, 116, 150, 150, 150, 150, 125, 35, 150, 110, 150, 88, 57, 150, 150, 54, 150, 150, 108, 150, 150, 55, 150, 150, 150, 150, 63, 38, 150, 150, 150, 62, 70, 62, 150, 150, 150, 150, 150, 60, 104, 150, 150, 150, 150, 150, 34, 75, 80, 61, 123, 150, 150, 150, 64, 150, 34, 87, 51, 150, 150, 150, 84, 92, 120, 49, 150, 57, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 50, 105, 80, 58, 55, 79, 79, 78, 150, 82, 150, 34, 150, 124, 150, 150, 61, 138, 150], "policy_policy_0_reward": [-1323.8464585730535, -298.8425380503679, -585.1920766840301, -835.4998329664819, -1080.8877804800288, -1034.7297107807449, -875.9648364856572, -227.27100896064005, 1.5561156462273102, -992.9884444436926, -297.19835020033366, -932.8360894963195, -298.39207617329987, -50.33623613699356, -867.5565280736017, -1223.2704245022712, -69.00062205599865, -865.2388275955473, -884.1107713653842, -486.89641512974777, -1597.0033520813006, -1394.7839109980875, -128.56859842052398, -821.8340905794304, -979.1974129075505, -930.6806135851485, -707.7532895393027, -73.70356233573945, -57.94930343357008, -1069.2789446152299, -1189.523912403373, -922.4775662385833, -73.04487533720027, -79.69204747293296, -129.35369758670444, -1247.7130315419233, -1224.4208446167195, -930.5359075737622, -923.1025896151169, -1096.6197797321583, -58.01259433230159, -388.48458117503014, -1122.031548486802, -936.1185888787588, -1103.8607624690624, -1212.1671268354492, -1144.2625844847626, -27.360418377891833, -140.8966585256745, -229.51751241864434, -63.64339090149171, -375.60103554010567, -1291.3075826901263, -1235.601505629381, -1120.317788216691, -103.83116839647583, -1011.2631680681583, -9.875260826019163, -328.82316467637673, -115.5076891639555, -1044.6699715595644, -807.756258961405, -1075.1639588179119, -304.5713398434546, -237.01851876384532, -399.3567237487067, -56.663515528875266, -1080.3751224676269, -61.26124010366645, -1114.1500096427324, -791.6884695414778, -1486.1680921866216, -58.60579022668715, -1370.4379002342268, -1207.454830414352, -951.6374836087122, -557.2658316010663, -1238.7941937135952, -1119.217242468882, -986.6834688223253, -1031.7775128570945, -28.974491573296678, -261.5275631101331, -130.80409500590844, -86.52701667030298, -85.06057003214467, -142.08908329049706, -140.97724363454284, -148.59139946784092, -1206.6014763970834, -157.10655237112573, -737.6804631774909, -11.505379859871445, -429.7445856100661, -359.9979611607404, -928.1182683386834, -798.2985082501231, -97.97254587414207, -658.8172779127574, -1053.5480492761333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534877324368223, "mean_inference_ms": 1.6658089873254929, "mean_action_processing_ms": 0.27422759712557004, "mean_env_wait_ms": 3.474452564351949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013257741928100586, "StateBufferConnector_ms": 0.007877349853515625, "ViewRequirementAgentConnector_ms": 0.19168329238891602}, "num_episodes": 38, "episode_return_max": 1.5561156462273102, "episode_return_min": -1597.0033520813006, "episode_return_mean": -652.688843793412, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6843060650092, "num_env_steps_trained_throughput_per_sec": 307.6843060650092, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 11393.021, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11392.946, "sample_time_ms": 1150.07, "learn_time_ms": 10176.335, "learn_throughput": 393.069, "synch_weights_time_ms": 65.748}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "07142_00000", "date": "2024-08-04_10-18-56", "timestamp": 1722746936, "time_this_iter_s": 13.012467622756958, "time_total_s": 338.8390736579895, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724415000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 338.8390736579895, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.636842105263156, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.07132179538408, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.171370720118285, "policy_loss": -0.008823786970848839, "vf_loss": 4.187016115834315, "vf_explained_var": 0.9841470668713251, "kl": 0.01756810692689522, "entropy": 1.472726096274952, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -9.875260826019163, "episode_reward_min": -1486.1680921866216, "episode_reward_mean": -630.57007470578, "episode_len_mean": 114.14, "episode_media": {}, "episodes_timesteps_total": 11414, "policy_reward_min": {"policy_0": -1486.1680921866216}, "policy_reward_max": {"policy_0": -9.875260826019163}, "policy_reward_mean": {"policy_0": -630.57007470578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.69204747293296, -129.35369758670444, -1247.7130315419233, -1224.4208446167195, -930.5359075737622, -923.1025896151169, -1096.6197797321583, -58.01259433230159, -388.48458117503014, -1122.031548486802, -936.1185888787588, -1103.8607624690624, -1212.1671268354492, -1144.2625844847626, -27.360418377891833, -140.8966585256745, -229.51751241864434, -63.64339090149171, -375.60103554010567, -1291.3075826901263, -1235.601505629381, -1120.317788216691, -103.83116839647583, -1011.2631680681583, -9.875260826019163, -328.82316467637673, -115.5076891639555, -1044.6699715595644, -807.756258961405, -1075.1639588179119, -304.5713398434546, -237.01851876384532, -399.3567237487067, -56.663515528875266, -1080.3751224676269, -61.26124010366645, -1114.1500096427324, -791.6884695414778, -1486.1680921866216, -58.60579022668715, -1370.4379002342268, -1207.454830414352, -951.6374836087122, -557.2658316010663, -1238.7941937135952, -1119.217242468882, -986.6834688223253, -1031.7775128570945, -28.974491573296678, -261.5275631101331, -130.80409500590844, -86.52701667030298, -85.06057003214467, -142.08908329049706, -140.97724363454284, -148.59139946784092, -1206.6014763970834, -157.10655237112573, -737.6804631774909, -11.505379859871445, -429.7445856100661, -359.9979611607404, -928.1182683386834, -798.2985082501231, -97.97254587414207, -658.8172779127574, -1053.5480492761333, -1172.1643715784655, -112.74202750458221, -496.4152139632627, -18.721112606281732, -1005.8298412319028, -339.83520026555584, -1069.002796700673, -1183.1947745095492, -1039.5630292550939, -380.4417456142537, -62.71465824863752, -172.9700214456025, -47.14751902899526, -91.37313868646565, -343.88815253553344, -938.4977287454934, -1192.991005744159, -816.6872013932291, -188.37927347167312, -1394.4249383485762, -116.6216818953922, -999.7823993261096, -76.85157822730642, -989.1231353073277, -804.4799037569886, -1261.0813558861935, -42.390451053766434, -1305.640985297035, -1395.562746427465, -103.4534727251771, -38.433058659124846, -818.1786786575311, -943.8422381224113], "episode_lengths": [70, 62, 150, 150, 150, 150, 150, 60, 104, 150, 150, 150, 150, 150, 34, 75, 80, 61, 123, 150, 150, 150, 64, 150, 34, 87, 51, 150, 150, 150, 84, 92, 120, 49, 150, 57, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 50, 105, 80, 58, 55, 79, 79, 78, 150, 82, 150, 34, 150, 124, 150, 150, 61, 138, 150, 150, 75, 129, 42, 150, 150, 150, 150, 150, 137, 63, 58, 50, 45, 113, 150, 150, 140, 76, 150, 60, 150, 66, 150, 150, 150, 59, 150, 150, 66, 47, 150, 150], "policy_policy_0_reward": [-79.69204747293296, -129.35369758670444, -1247.7130315419233, -1224.4208446167195, -930.5359075737622, -923.1025896151169, -1096.6197797321583, -58.01259433230159, -388.48458117503014, -1122.031548486802, -936.1185888787588, -1103.8607624690624, -1212.1671268354492, -1144.2625844847626, -27.360418377891833, -140.8966585256745, -229.51751241864434, -63.64339090149171, -375.60103554010567, -1291.3075826901263, -1235.601505629381, -1120.317788216691, -103.83116839647583, -1011.2631680681583, -9.875260826019163, -328.82316467637673, -115.5076891639555, -1044.6699715595644, -807.756258961405, -1075.1639588179119, -304.5713398434546, -237.01851876384532, -399.3567237487067, -56.663515528875266, -1080.3751224676269, -61.26124010366645, -1114.1500096427324, -791.6884695414778, -1486.1680921866216, -58.60579022668715, -1370.4379002342268, -1207.454830414352, -951.6374836087122, -557.2658316010663, -1238.7941937135952, -1119.217242468882, -986.6834688223253, -1031.7775128570945, -28.974491573296678, -261.5275631101331, -130.80409500590844, -86.52701667030298, -85.06057003214467, -142.08908329049706, -140.97724363454284, -148.59139946784092, -1206.6014763970834, -157.10655237112573, -737.6804631774909, -11.505379859871445, -429.7445856100661, -359.9979611607404, -928.1182683386834, -798.2985082501231, -97.97254587414207, -658.8172779127574, -1053.5480492761333, -1172.1643715784655, -112.74202750458221, -496.4152139632627, -18.721112606281732, -1005.8298412319028, -339.83520026555584, -1069.002796700673, -1183.1947745095492, -1039.5630292550939, -380.4417456142537, -62.71465824863752, -172.9700214456025, -47.14751902899526, -91.37313868646565, -343.88815253553344, -938.4977287454934, -1192.991005744159, -816.6872013932291, -188.37927347167312, -1394.4249383485762, -116.6216818953922, -999.7823993261096, -76.85157822730642, -989.1231353073277, -804.4799037569886, -1261.0813558861935, -42.390451053766434, -1305.640985297035, -1395.562746427465, -103.4534727251771, -38.433058659124846, -818.1786786575311, -943.8422381224113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531372853380215, "mean_inference_ms": 1.6664599785965026, "mean_action_processing_ms": 0.27430774417157516, "mean_env_wait_ms": 3.4767298352965894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012741327285766602, "StateBufferConnector_ms": 0.007942438125610352, "ViewRequirementAgentConnector_ms": 0.19447588920593262}, "num_episodes": 33, "episode_return_max": -9.875260826019163, "episode_return_min": -1486.1680921866216, "episode_return_mean": -630.57007470578, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.33669328521177, "num_env_steps_trained_throughput_per_sec": 315.33669328521177, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 11914.292, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11914.216, "sample_time_ms": 1159.421, "learn_time_ms": 10686.12, "learn_throughput": 374.317, "synch_weights_time_ms": 67.876}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "07142_00000", "date": "2024-08-04_10-19-09", "timestamp": 1722746949, "time_this_iter_s": 12.697977542877197, "time_total_s": 351.5370512008667, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724414dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 351.5370512008667, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.75, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 216.1463484108448, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.754065653681755, "policy_loss": -0.009790752927559272, "vf_loss": 3.769819383819898, "vf_explained_var": 0.9836611590658625, "kl": 0.01801510160779196, "entropy": 1.4069789349411925, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -11.505379859871445, "episode_reward_min": -1486.1680921866216, "episode_reward_mean": -588.0469448401084, "episode_len_mean": 114.44, "episode_media": {}, "episodes_timesteps_total": 11444, "policy_reward_min": {"policy_0": -1486.1680921866216}, "policy_reward_max": {"policy_0": -11.505379859871445}, "policy_reward_mean": {"policy_0": -588.0469448401084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-399.3567237487067, -56.663515528875266, -1080.3751224676269, -61.26124010366645, -1114.1500096427324, -791.6884695414778, -1486.1680921866216, -58.60579022668715, -1370.4379002342268, -1207.454830414352, -951.6374836087122, -557.2658316010663, -1238.7941937135952, -1119.217242468882, -986.6834688223253, -1031.7775128570945, -28.974491573296678, -261.5275631101331, -130.80409500590844, -86.52701667030298, -85.06057003214467, -142.08908329049706, -140.97724363454284, -148.59139946784092, -1206.6014763970834, -157.10655237112573, -737.6804631774909, -11.505379859871445, -429.7445856100661, -359.9979611607404, -928.1182683386834, -798.2985082501231, -97.97254587414207, -658.8172779127574, -1053.5480492761333, -1172.1643715784655, -112.74202750458221, -496.4152139632627, -18.721112606281732, -1005.8298412319028, -339.83520026555584, -1069.002796700673, -1183.1947745095492, -1039.5630292550939, -380.4417456142537, -62.71465824863752, -172.9700214456025, -47.14751902899526, -91.37313868646565, -343.88815253553344, -938.4977287454934, -1192.991005744159, -816.6872013932291, -188.37927347167312, -1394.4249383485762, -116.6216818953922, -999.7823993261096, -76.85157822730642, -989.1231353073277, -804.4799037569886, -1261.0813558861935, -42.390451053766434, -1305.640985297035, -1395.562746427465, -103.4534727251771, -38.433058659124846, -818.1786786575311, -943.8422381224113, -29.857052626229788, -705.1184560015023, -399.31444343427364, -584.5769040097912, -21.657573099980088, -574.5162727778853, -215.96768211754278, -251.9849494175292, -263.5375221258452, -64.96216797466987, -24.242434138054577, -1109.1622237434922, -253.4523698264497, -892.9442732282193, -423.3865768011388, -102.27904069900713, -47.78322947904415, -676.063320720844, -141.3365079133423, -350.6535792188795, -783.5805096775325, -1271.8884713395435, -868.0854710558423, -921.4115654384929, -323.05387239647104, -802.9020845402816, -124.67165703172131, -143.12878337666484, -1236.5477807522452, -877.724939438132, -1345.324838212843, -1035.6725369979972], "episode_lengths": [120, 49, 150, 57, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 50, 105, 80, 58, 55, 79, 79, 78, 150, 82, 150, 34, 150, 124, 150, 150, 61, 138, 150, 150, 75, 129, 42, 150, 150, 150, 150, 150, 137, 63, 58, 50, 45, 113, 150, 150, 140, 76, 150, 60, 150, 66, 150, 150, 150, 59, 150, 150, 66, 47, 150, 150, 39, 150, 139, 150, 39, 150, 71, 85, 85, 64, 48, 150, 146, 150, 110, 73, 50, 150, 70, 122, 150, 150, 150, 150, 123, 150, 71, 76, 150, 150, 150, 150], "policy_policy_0_reward": [-399.3567237487067, -56.663515528875266, -1080.3751224676269, -61.26124010366645, -1114.1500096427324, -791.6884695414778, -1486.1680921866216, -58.60579022668715, -1370.4379002342268, -1207.454830414352, -951.6374836087122, -557.2658316010663, -1238.7941937135952, -1119.217242468882, -986.6834688223253, -1031.7775128570945, -28.974491573296678, -261.5275631101331, -130.80409500590844, -86.52701667030298, -85.06057003214467, -142.08908329049706, -140.97724363454284, -148.59139946784092, -1206.6014763970834, -157.10655237112573, -737.6804631774909, -11.505379859871445, -429.7445856100661, -359.9979611607404, -928.1182683386834, -798.2985082501231, -97.97254587414207, -658.8172779127574, -1053.5480492761333, -1172.1643715784655, -112.74202750458221, -496.4152139632627, -18.721112606281732, -1005.8298412319028, -339.83520026555584, -1069.002796700673, -1183.1947745095492, -1039.5630292550939, -380.4417456142537, -62.71465824863752, -172.9700214456025, -47.14751902899526, -91.37313868646565, -343.88815253553344, -938.4977287454934, -1192.991005744159, -816.6872013932291, -188.37927347167312, -1394.4249383485762, -116.6216818953922, -999.7823993261096, -76.85157822730642, -989.1231353073277, -804.4799037569886, -1261.0813558861935, -42.390451053766434, -1305.640985297035, -1395.562746427465, -103.4534727251771, -38.433058659124846, -818.1786786575311, -943.8422381224113, -29.857052626229788, -705.1184560015023, -399.31444343427364, -584.5769040097912, -21.657573099980088, -574.5162727778853, -215.96768211754278, -251.9849494175292, -263.5375221258452, -64.96216797466987, -24.242434138054577, -1109.1622237434922, -253.4523698264497, -892.9442732282193, -423.3865768011388, -102.27904069900713, -47.78322947904415, -676.063320720844, -141.3365079133423, -350.6535792188795, -783.5805096775325, -1271.8884713395435, -868.0854710558423, -921.4115654384929, -323.05387239647104, -802.9020845402816, -124.67165703172131, -143.12878337666484, -1236.5477807522452, -877.724939438132, -1345.324838212843, -1035.6725369979972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534069525281573, "mean_inference_ms": 1.6675293042194455, "mean_action_processing_ms": 0.27419894160343466, "mean_env_wait_ms": 3.4764295087787236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013302803039550781, "StateBufferConnector_ms": 0.007912158966064453, "ViewRequirementAgentConnector_ms": 0.1948988437652588}, "num_episodes": 32, "episode_return_max": -11.505379859871445, "episode_return_min": -1486.1680921866216, "episode_return_mean": -588.0469448401084, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.291158875288, "num_env_steps_trained_throughput_per_sec": 311.291158875288, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12070.353, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12070.278, "sample_time_ms": 1156.108, "learn_time_ms": 10846.466, "learn_throughput": 368.784, "synch_weights_time_ms": 66.916}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "07142_00000", "date": "2024-08-04_10-19-22", "timestamp": 1722746962, "time_this_iter_s": 12.861953973770142, "time_total_s": 364.39900517463684, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724417010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 364.39900517463684, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.62222222222222, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 323.88865355650586, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.524311792974671, "policy_loss": -0.008210673940872463, "vf_loss": 3.5388207996884984, "vf_explained_var": 0.9882015216474732, "kl": 0.01693107586525002, "entropy": 1.391732541223367, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -16.197767026387467, "episode_reward_min": -1395.562746427465, "episode_reward_mean": -612.4989552047239, "episode_len_mean": 116.94, "episode_media": {}, "episodes_timesteps_total": 11694, "policy_reward_min": {"policy_0": -1395.562746427465}, "policy_reward_max": {"policy_0": -16.197767026387467}, "policy_reward_mean": {"policy_0": -612.4989552047239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.1643715784655, -112.74202750458221, -496.4152139632627, -18.721112606281732, -1005.8298412319028, -339.83520026555584, -1069.002796700673, -1183.1947745095492, -1039.5630292550939, -380.4417456142537, -62.71465824863752, -172.9700214456025, -47.14751902899526, -91.37313868646565, -343.88815253553344, -938.4977287454934, -1192.991005744159, -816.6872013932291, -188.37927347167312, -1394.4249383485762, -116.6216818953922, -999.7823993261096, -76.85157822730642, -989.1231353073277, -804.4799037569886, -1261.0813558861935, -42.390451053766434, -1305.640985297035, -1395.562746427465, -103.4534727251771, -38.433058659124846, -818.1786786575311, -943.8422381224113, -29.857052626229788, -705.1184560015023, -399.31444343427364, -584.5769040097912, -21.657573099980088, -574.5162727778853, -215.96768211754278, -251.9849494175292, -263.5375221258452, -64.96216797466987, -24.242434138054577, -1109.1622237434922, -253.4523698264497, -892.9442732282193, -423.3865768011388, -102.27904069900713, -47.78322947904415, -676.063320720844, -141.3365079133423, -350.6535792188795, -783.5805096775325, -1271.8884713395435, -868.0854710558423, -921.4115654384929, -323.05387239647104, -802.9020845402816, -124.67165703172131, -143.12878337666484, -1236.5477807522452, -877.724939438132, -1345.324838212843, -1035.6725369979972, -1342.7567090545697, -157.51581125279935, -76.74840960210494, -956.2489349407981, -139.28853368948805, -1218.7491798892754, -862.7232392762667, -799.4311335713911, -96.26798555162136, -766.4345873900313, -50.3670573572619, -943.1702970131271, -241.92410648681533, -93.37713678681766, -761.7482962727005, -1195.6843021932862, -49.434188058678515, -1329.2523696545695, -213.13451046124885, -1360.2662963500527, -1264.5958756201535, -967.3824368676211, -1026.3245994827655, -685.4177544860473, -889.8982998415049, -463.9811933202772, -1208.593030966514, -472.2306562116905, -402.2983838342772, -593.4294244733179, -1109.3684496499995, -47.11949352188311, -834.6741903832622, -784.6463541024767, -16.197767026387467], "episode_lengths": [150, 75, 129, 42, 150, 150, 150, 150, 150, 137, 63, 58, 50, 45, 113, 150, 150, 140, 76, 150, 60, 150, 66, 150, 150, 150, 59, 150, 150, 66, 47, 150, 150, 39, 150, 139, 150, 39, 150, 71, 85, 85, 64, 48, 150, 146, 150, 110, 73, 50, 150, 70, 122, 150, 150, 150, 150, 123, 150, 71, 76, 150, 150, 150, 150, 150, 55, 63, 150, 58, 150, 150, 150, 67, 150, 54, 150, 82, 70, 150, 150, 52, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 51, 150, 150, 40], "policy_policy_0_reward": [-1172.1643715784655, -112.74202750458221, -496.4152139632627, -18.721112606281732, -1005.8298412319028, -339.83520026555584, -1069.002796700673, -1183.1947745095492, -1039.5630292550939, -380.4417456142537, -62.71465824863752, -172.9700214456025, -47.14751902899526, -91.37313868646565, -343.88815253553344, -938.4977287454934, -1192.991005744159, -816.6872013932291, -188.37927347167312, -1394.4249383485762, -116.6216818953922, -999.7823993261096, -76.85157822730642, -989.1231353073277, -804.4799037569886, -1261.0813558861935, -42.390451053766434, -1305.640985297035, -1395.562746427465, -103.4534727251771, -38.433058659124846, -818.1786786575311, -943.8422381224113, -29.857052626229788, -705.1184560015023, -399.31444343427364, -584.5769040097912, -21.657573099980088, -574.5162727778853, -215.96768211754278, -251.9849494175292, -263.5375221258452, -64.96216797466987, -24.242434138054577, -1109.1622237434922, -253.4523698264497, -892.9442732282193, -423.3865768011388, -102.27904069900713, -47.78322947904415, -676.063320720844, -141.3365079133423, -350.6535792188795, -783.5805096775325, -1271.8884713395435, -868.0854710558423, -921.4115654384929, -323.05387239647104, -802.9020845402816, -124.67165703172131, -143.12878337666484, -1236.5477807522452, -877.724939438132, -1345.324838212843, -1035.6725369979972, -1342.7567090545697, -157.51581125279935, -76.74840960210494, -956.2489349407981, -139.28853368948805, -1218.7491798892754, -862.7232392762667, -799.4311335713911, -96.26798555162136, -766.4345873900313, -50.3670573572619, -943.1702970131271, -241.92410648681533, -93.37713678681766, -761.7482962727005, -1195.6843021932862, -49.434188058678515, -1329.2523696545695, -213.13451046124885, -1360.2662963500527, -1264.5958756201535, -967.3824368676211, -1026.3245994827655, -685.4177544860473, -889.8982998415049, -463.9811933202772, -1208.593030966514, -472.2306562116905, -402.2983838342772, -593.4294244733179, -1109.3684496499995, -47.11949352188311, -834.6741903832622, -784.6463541024767, -16.197767026387467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523216277112015, "mean_inference_ms": 1.6850381560092913, "mean_action_processing_ms": 0.2742366602067601, "mean_env_wait_ms": 3.4762768567570324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013157844543457031, "StateBufferConnector_ms": 0.007987737655639648, "ViewRequirementAgentConnector_ms": 0.19460272789001465}, "num_episodes": 35, "episode_return_max": -16.197767026387467, "episode_return_min": -1395.562746427465, "episode_return_mean": -612.4989552047239, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1877212354612, "num_env_steps_trained_throughput_per_sec": 302.1877212354612, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12220.228, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12220.154, "sample_time_ms": 1188.506, "learn_time_ms": 10963.57, "learn_throughput": 364.845, "synch_weights_time_ms": 67.295}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "07142_00000", "date": "2024-08-04_10-19-35", "timestamp": 1722746975, "time_this_iter_s": 13.250318050384521, "time_total_s": 377.64932322502136, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244980d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 377.64932322502136, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.652631578947368, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 248.31127441326777, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.539243457466364, "policy_loss": 0.0001780608232365921, "vf_loss": 3.5462590443591275, "vf_explained_var": 0.9664674003298084, "kl": 0.01664634608617541, "entropy": 1.4684495759507021, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -8.61226845076272, "episode_reward_min": -1360.2662963500527, "episode_reward_mean": -572.7876468117469, "episode_len_mean": 114.33, "episode_media": {}, "episodes_timesteps_total": 11433, "policy_reward_min": {"policy_0": -1360.2662963500527}, "policy_reward_max": {"policy_0": -8.61226845076272}, "policy_reward_mean": {"policy_0": -572.7876468117469}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-574.5162727778853, -215.96768211754278, -251.9849494175292, -263.5375221258452, -64.96216797466987, -24.242434138054577, -1109.1622237434922, -253.4523698264497, -892.9442732282193, -423.3865768011388, -102.27904069900713, -47.78322947904415, -676.063320720844, -141.3365079133423, -350.6535792188795, -783.5805096775325, -1271.8884713395435, -868.0854710558423, -921.4115654384929, -323.05387239647104, -802.9020845402816, -124.67165703172131, -143.12878337666484, -1236.5477807522452, -877.724939438132, -1345.324838212843, -1035.6725369979972, -1342.7567090545697, -157.51581125279935, -76.74840960210494, -956.2489349407981, -139.28853368948805, -1218.7491798892754, -862.7232392762667, -799.4311335713911, -96.26798555162136, -766.4345873900313, -50.3670573572619, -943.1702970131271, -241.92410648681533, -93.37713678681766, -761.7482962727005, -1195.6843021932862, -49.434188058678515, -1329.2523696545695, -213.13451046124885, -1360.2662963500527, -1264.5958756201535, -967.3824368676211, -1026.3245994827655, -685.4177544860473, -889.8982998415049, -463.9811933202772, -1208.593030966514, -472.2306562116905, -402.2983838342772, -593.4294244733179, -1109.3684496499995, -47.11949352188311, -834.6741903832622, -784.6463541024767, -16.197767026387467, -451.1449283478661, -8.61226845076272, -974.5834600831707, -967.363798351384, -156.21819404518186, -142.19235155970264, -1219.9928317567058, -717.3250983363125, -346.7453191663086, -429.59692295253706, -326.1611083159412, -429.26317299841276, -11.012133837326516, -47.671941052387666, -734.2561933643623, -124.5809345106411, -258.9239663220267, -13.010027984727861, -101.28463319245552, -103.7935074263465, -687.1618781445119, -179.60580874656648, -1164.729781111934, -95.95926474525847, -1291.5169398085154, -693.766779335376, -9.54662507090372, -997.7455336580574, -35.21889976960129, -1060.0125266273096, -236.90600625169913, -969.8981459076788, -739.4517238296567, -35.64851219701608, -700.3996449036167, -1172.290239918265, -172.84537163868896, -925.3825523746889], "episode_lengths": [150, 71, 85, 85, 64, 48, 150, 146, 150, 110, 73, 50, 150, 70, 122, 150, 150, 150, 150, 123, 150, 71, 76, 150, 150, 150, 150, 150, 55, 63, 150, 58, 150, 150, 150, 67, 150, 54, 150, 82, 70, 150, 150, 52, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 51, 150, 150, 40, 111, 40, 150, 150, 62, 82, 150, 150, 142, 118, 125, 124, 39, 49, 139, 66, 74, 37, 59, 57, 145, 88, 150, 71, 150, 150, 36, 150, 50, 150, 81, 150, 150, 47, 150, 150, 90, 150], "policy_policy_0_reward": [-574.5162727778853, -215.96768211754278, -251.9849494175292, -263.5375221258452, -64.96216797466987, -24.242434138054577, -1109.1622237434922, -253.4523698264497, -892.9442732282193, -423.3865768011388, -102.27904069900713, -47.78322947904415, -676.063320720844, -141.3365079133423, -350.6535792188795, -783.5805096775325, -1271.8884713395435, -868.0854710558423, -921.4115654384929, -323.05387239647104, -802.9020845402816, -124.67165703172131, -143.12878337666484, -1236.5477807522452, -877.724939438132, -1345.324838212843, -1035.6725369979972, -1342.7567090545697, -157.51581125279935, -76.74840960210494, -956.2489349407981, -139.28853368948805, -1218.7491798892754, -862.7232392762667, -799.4311335713911, -96.26798555162136, -766.4345873900313, -50.3670573572619, -943.1702970131271, -241.92410648681533, -93.37713678681766, -761.7482962727005, -1195.6843021932862, -49.434188058678515, -1329.2523696545695, -213.13451046124885, -1360.2662963500527, -1264.5958756201535, -967.3824368676211, -1026.3245994827655, -685.4177544860473, -889.8982998415049, -463.9811933202772, -1208.593030966514, -472.2306562116905, -402.2983838342772, -593.4294244733179, -1109.3684496499995, -47.11949352188311, -834.6741903832622, -784.6463541024767, -16.197767026387467, -451.1449283478661, -8.61226845076272, -974.5834600831707, -967.363798351384, -156.21819404518186, -142.19235155970264, -1219.9928317567058, -717.3250983363125, -346.7453191663086, -429.59692295253706, -326.1611083159412, -429.26317299841276, -11.012133837326516, -47.671941052387666, -734.2561933643623, -124.5809345106411, -258.9239663220267, -13.010027984727861, -101.28463319245552, -103.7935074263465, -687.1618781445119, -179.60580874656648, -1164.729781111934, -95.95926474525847, -1291.5169398085154, -693.766779335376, -9.54662507090372, -997.7455336580574, -35.21889976960129, -1060.0125266273096, -236.90600625169913, -969.8981459076788, -739.4517238296567, -35.64851219701608, -700.3996449036167, -1172.290239918265, -172.84537163868896, -925.3825523746889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524598138785399, "mean_inference_ms": 1.7060316248264078, "mean_action_processing_ms": 0.2739138370140778, "mean_env_wait_ms": 3.4698169636746212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013207674026489258, "StateBufferConnector_ms": 0.007923364639282227, "ViewRequirementAgentConnector_ms": 0.19277358055114746}, "num_episodes": 38, "episode_return_max": -8.61226845076272, "episode_return_min": -1360.2662963500527, "episode_return_mean": -572.7876468117469, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.3989928082129, "num_env_steps_trained_throughput_per_sec": 356.3989928082129, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12365.229, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12365.156, "sample_time_ms": 1208.195, "learn_time_ms": 11089.83, "learn_throughput": 360.691, "synch_weights_time_ms": 66.327}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "07142_00000", "date": "2024-08-04_10-19-47", "timestamp": 1722746987, "time_this_iter_s": 11.236306190490723, "time_total_s": 388.8856294155121, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449a680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 388.8856294155121, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.887500000000003, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 234.41004524827002, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.581957720965147, "policy_loss": -0.0071961652797957265, "vf_loss": 3.599202004323403, "vf_explained_var": 0.984619886179765, "kl": 0.014567333058857912, "entropy": 1.660341260706385, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -8.61226845076272, "episode_reward_min": -1360.2662963500527, "episode_reward_mean": -621.9130419564658, "episode_len_mean": 118.11, "episode_media": {}, "episodes_timesteps_total": 11811, "policy_reward_min": {"policy_0": -1360.2662963500527}, "policy_reward_max": {"policy_0": -8.61226845076272}, "policy_reward_mean": {"policy_0": -621.9130419564658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-862.7232392762667, -799.4311335713911, -96.26798555162136, -766.4345873900313, -50.3670573572619, -943.1702970131271, -241.92410648681533, -93.37713678681766, -761.7482962727005, -1195.6843021932862, -49.434188058678515, -1329.2523696545695, -213.13451046124885, -1360.2662963500527, -1264.5958756201535, -967.3824368676211, -1026.3245994827655, -685.4177544860473, -889.8982998415049, -463.9811933202772, -1208.593030966514, -472.2306562116905, -402.2983838342772, -593.4294244733179, -1109.3684496499995, -47.11949352188311, -834.6741903832622, -784.6463541024767, -16.197767026387467, -451.1449283478661, -8.61226845076272, -974.5834600831707, -967.363798351384, -156.21819404518186, -142.19235155970264, -1219.9928317567058, -717.3250983363125, -346.7453191663086, -429.59692295253706, -326.1611083159412, -429.26317299841276, -11.012133837326516, -47.671941052387666, -734.2561933643623, -124.5809345106411, -258.9239663220267, -13.010027984727861, -101.28463319245552, -103.7935074263465, -687.1618781445119, -179.60580874656648, -1164.729781111934, -95.95926474525847, -1291.5169398085154, -693.766779335376, -9.54662507090372, -997.7455336580574, -35.21889976960129, -1060.0125266273096, -236.90600625169913, -969.8981459076788, -739.4517238296567, -35.64851219701608, -700.3996449036167, -1172.290239918265, -172.84537163868896, -925.3825523746889, -765.2821256253006, -752.680509071337, -1179.067717711892, -661.026868168558, -13.071333457329695, -63.9318202483257, -113.7613733010831, -65.70031157522902, -1258.4968306196902, -714.9216151450165, -61.99901494166497, -769.438498716645, -1295.1827952073158, -237.40029195442222, -649.3412585982492, -1250.6364292514377, -506.68630685711656, -1197.831706059506, -1193.4451471768298, -285.02480528002, -1186.49765242018, -249.4385265613973, -955.8009268828381, -489.51654295045734, -1236.5261926040303, -871.7810638691785, -1066.5598290843188, -882.0044896601902, -842.2775748546107, -982.0806194066563, -1115.2918539035004, -104.90569754266373, -912.5040246336359], "episode_lengths": [150, 150, 67, 150, 54, 150, 82, 70, 150, 150, 52, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 51, 150, 150, 40, 111, 40, 150, 150, 62, 82, 150, 150, 142, 118, 125, 124, 39, 49, 139, 66, 74, 37, 59, 57, 145, 88, 150, 71, 150, 150, 36, 150, 50, 150, 81, 150, 150, 47, 150, 150, 90, 150, 150, 150, 150, 150, 44, 55, 70, 60, 150, 150, 64, 150, 150, 80, 150, 150, 133, 150, 150, 74, 150, 87, 150, 127, 150, 150, 150, 150, 150, 150, 150, 54, 150], "policy_policy_0_reward": [-862.7232392762667, -799.4311335713911, -96.26798555162136, -766.4345873900313, -50.3670573572619, -943.1702970131271, -241.92410648681533, -93.37713678681766, -761.7482962727005, -1195.6843021932862, -49.434188058678515, -1329.2523696545695, -213.13451046124885, -1360.2662963500527, -1264.5958756201535, -967.3824368676211, -1026.3245994827655, -685.4177544860473, -889.8982998415049, -463.9811933202772, -1208.593030966514, -472.2306562116905, -402.2983838342772, -593.4294244733179, -1109.3684496499995, -47.11949352188311, -834.6741903832622, -784.6463541024767, -16.197767026387467, -451.1449283478661, -8.61226845076272, -974.5834600831707, -967.363798351384, -156.21819404518186, -142.19235155970264, -1219.9928317567058, -717.3250983363125, -346.7453191663086, -429.59692295253706, -326.1611083159412, -429.26317299841276, -11.012133837326516, -47.671941052387666, -734.2561933643623, -124.5809345106411, -258.9239663220267, -13.010027984727861, -101.28463319245552, -103.7935074263465, -687.1618781445119, -179.60580874656648, -1164.729781111934, -95.95926474525847, -1291.5169398085154, -693.766779335376, -9.54662507090372, -997.7455336580574, -35.21889976960129, -1060.0125266273096, -236.90600625169913, -969.8981459076788, -739.4517238296567, -35.64851219701608, -700.3996449036167, -1172.290239918265, -172.84537163868896, -925.3825523746889, -765.2821256253006, -752.680509071337, -1179.067717711892, -661.026868168558, -13.071333457329695, -63.9318202483257, -113.7613733010831, -65.70031157522902, -1258.4968306196902, -714.9216151450165, -61.99901494166497, -769.438498716645, -1295.1827952073158, -237.40029195442222, -649.3412585982492, -1250.6364292514377, -506.68630685711656, -1197.831706059506, -1193.4451471768298, -285.02480528002, -1186.49765242018, -249.4385265613973, -955.8009268828381, -489.51654295045734, -1236.5261926040303, -871.7810638691785, -1066.5598290843188, -882.0044896601902, -842.2775748546107, -982.0806194066563, -1115.2918539035004, -104.90569754266373, -912.5040246336359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523119648252041, "mean_inference_ms": 1.7214887715599803, "mean_action_processing_ms": 0.2737049588298975, "mean_env_wait_ms": 3.466082941560269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011930704116821289, "StateBufferConnector_ms": 0.007907390594482422, "ViewRequirementAgentConnector_ms": 0.19159245491027832}, "num_episodes": 33, "episode_return_max": -8.61226845076272, "episode_return_min": -1360.2662963500527, "episode_return_mean": -621.9130419564658, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.27083142414745, "num_env_steps_trained_throughput_per_sec": 306.27083142414745, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12505.866, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12505.794, "sample_time_ms": 1213.227, "learn_time_ms": 11227.21, "learn_throughput": 356.277, "synch_weights_time_ms": 64.569}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "07142_00000", "date": "2024-08-04_10-20-00", "timestamp": 1722747000, "time_this_iter_s": 13.071548223495483, "time_total_s": 401.95717763900757, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f4a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.95717763900757, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.926315789473687, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 295.73146257599194, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.512525421505173, "policy_loss": -0.005068806979882841, "vf_loss": 3.5230729398628076, "vf_explained_var": 0.9773273934299748, "kl": 0.017379037761323504, "entropy": 1.3299270067984859, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -9.54662507090372, "episode_reward_min": -1360.594167838146, "episode_reward_mean": -596.6436408283087, "episode_len_mean": 116.83, "episode_media": {}, "episodes_timesteps_total": 11683, "policy_reward_min": {"policy_0": -1360.594167838146}, "policy_reward_max": {"policy_0": -9.54662507090372}, "policy_reward_mean": {"policy_0": -596.6436408283087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-974.5834600831707, -967.363798351384, -156.21819404518186, -142.19235155970264, -1219.9928317567058, -717.3250983363125, -346.7453191663086, -429.59692295253706, -326.1611083159412, -429.26317299841276, -11.012133837326516, -47.671941052387666, -734.2561933643623, -124.5809345106411, -258.9239663220267, -13.010027984727861, -101.28463319245552, -103.7935074263465, -687.1618781445119, -179.60580874656648, -1164.729781111934, -95.95926474525847, -1291.5169398085154, -693.766779335376, -9.54662507090372, -997.7455336580574, -35.21889976960129, -1060.0125266273096, -236.90600625169913, -969.8981459076788, -739.4517238296567, -35.64851219701608, -700.3996449036167, -1172.290239918265, -172.84537163868896, -925.3825523746889, -765.2821256253006, -752.680509071337, -1179.067717711892, -661.026868168558, -13.071333457329695, -63.9318202483257, -113.7613733010831, -65.70031157522902, -1258.4968306196902, -714.9216151450165, -61.99901494166497, -769.438498716645, -1295.1827952073158, -237.40029195442222, -649.3412585982492, -1250.6364292514377, -506.68630685711656, -1197.831706059506, -1193.4451471768298, -285.02480528002, -1186.49765242018, -249.4385265613973, -955.8009268828381, -489.51654295045734, -1236.5261926040303, -871.7810638691785, -1066.5598290843188, -882.0044896601902, -842.2775748546107, -982.0806194066563, -1115.2918539035004, -104.90569754266373, -912.5040246336359, -672.6149331989616, -58.299146133066294, -137.64138020066343, -876.7608654894353, -755.4598637824467, -90.85424340809996, -98.29529462749694, -893.352179610534, -156.8092428678514, -1110.6698609394589, -1132.3377468530025, -498.6644222807157, -841.2666016750727, -534.3474791825112, -316.7041063975458, -634.5994389334098, -815.5275411121032, -118.24253607928709, -144.0662043766478, -263.16106852833826, -1219.0100000134105, -93.40895455510173, -902.1242096497477, -993.9947108150556, -1360.594167838146, -159.9805589701528, -193.95781807083802, -1127.252980875567, -219.36277645087742, -885.8499143351593, -156.98025294426094], "episode_lengths": [150, 150, 62, 82, 150, 150, 142, 118, 125, 124, 39, 49, 139, 66, 74, 37, 59, 57, 145, 88, 150, 71, 150, 150, 36, 150, 50, 150, 81, 150, 150, 47, 150, 150, 90, 150, 150, 150, 150, 150, 44, 55, 70, 60, 150, 150, 64, 150, 150, 80, 150, 150, 133, 150, 150, 74, 150, 87, 150, 127, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 53, 84, 150, 142, 53, 72, 150, 84, 150, 150, 120, 150, 134, 98, 150, 150, 71, 75, 120, 150, 61, 150, 150, 150, 90, 95, 150, 115, 150, 87], "policy_policy_0_reward": [-974.5834600831707, -967.363798351384, -156.21819404518186, -142.19235155970264, -1219.9928317567058, -717.3250983363125, -346.7453191663086, -429.59692295253706, -326.1611083159412, -429.26317299841276, -11.012133837326516, -47.671941052387666, -734.2561933643623, -124.5809345106411, -258.9239663220267, -13.010027984727861, -101.28463319245552, -103.7935074263465, -687.1618781445119, -179.60580874656648, -1164.729781111934, -95.95926474525847, -1291.5169398085154, -693.766779335376, -9.54662507090372, -997.7455336580574, -35.21889976960129, -1060.0125266273096, -236.90600625169913, -969.8981459076788, -739.4517238296567, -35.64851219701608, -700.3996449036167, -1172.290239918265, -172.84537163868896, -925.3825523746889, -765.2821256253006, -752.680509071337, -1179.067717711892, -661.026868168558, -13.071333457329695, -63.9318202483257, -113.7613733010831, -65.70031157522902, -1258.4968306196902, -714.9216151450165, -61.99901494166497, -769.438498716645, -1295.1827952073158, -237.40029195442222, -649.3412585982492, -1250.6364292514377, -506.68630685711656, -1197.831706059506, -1193.4451471768298, -285.02480528002, -1186.49765242018, -249.4385265613973, -955.8009268828381, -489.51654295045734, -1236.5261926040303, -871.7810638691785, -1066.5598290843188, -882.0044896601902, -842.2775748546107, -982.0806194066563, -1115.2918539035004, -104.90569754266373, -912.5040246336359, -672.6149331989616, -58.299146133066294, -137.64138020066343, -876.7608654894353, -755.4598637824467, -90.85424340809996, -98.29529462749694, -893.352179610534, -156.8092428678514, -1110.6698609394589, -1132.3377468530025, -498.6644222807157, -841.2666016750727, -534.3474791825112, -316.7041063975458, -634.5994389334098, -815.5275411121032, -118.24253607928709, -144.0662043766478, -263.16106852833826, -1219.0100000134105, -93.40895455510173, -902.1242096497477, -993.9947108150556, -1360.594167838146, -159.9805589701528, -193.95781807083802, -1127.252980875567, -219.36277645087742, -885.8499143351593, -156.98025294426094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55223831868533, "mean_inference_ms": 1.7228213643757564, "mean_action_processing_ms": 0.2738666094546882, "mean_env_wait_ms": 3.4647428042654167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012621402740478516, "StateBufferConnector_ms": 0.007807016372680664, "ViewRequirementAgentConnector_ms": 0.19079017639160156}, "num_episodes": 31, "episode_return_max": -9.54662507090372, "episode_return_min": -1360.594167838146, "episode_return_mean": -596.6436408283087, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.60732926459644, "num_env_steps_trained_throughput_per_sec": 315.60732926459644, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12567.699, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12567.625, "sample_time_ms": 1218.362, "learn_time_ms": 11282.443, "learn_throughput": 354.533, "synch_weights_time_ms": 65.981}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "07142_00000", "date": "2024-08-04_10-20-12", "timestamp": 1722747012, "time_this_iter_s": 12.687205791473389, "time_total_s": 414.64438343048096, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 414.64438343048096, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.22222222222222, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 238.02631384134293, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.662232306599617, "policy_loss": -0.020572311736274666, "vf_loss": 3.686534810314576, "vf_explained_var": 0.9903356162210305, "kl": 0.022358436949919794, "entropy": 1.37914784985284, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -13.071333457329695, "episode_reward_min": -1447.5942580755375, "episode_reward_mean": -599.464794773436, "episode_len_mean": 118.82, "episode_media": {}, "episodes_timesteps_total": 11882, "policy_reward_min": {"policy_0": -1447.5942580755375}, "policy_reward_max": {"policy_0": -13.071333457329695}, "policy_reward_mean": {"policy_0": -599.464794773436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-752.680509071337, -1179.067717711892, -661.026868168558, -13.071333457329695, -63.9318202483257, -113.7613733010831, -65.70031157522902, -1258.4968306196902, -714.9216151450165, -61.99901494166497, -769.438498716645, -1295.1827952073158, -237.40029195442222, -649.3412585982492, -1250.6364292514377, -506.68630685711656, -1197.831706059506, -1193.4451471768298, -285.02480528002, -1186.49765242018, -249.4385265613973, -955.8009268828381, -489.51654295045734, -1236.5261926040303, -871.7810638691785, -1066.5598290843188, -882.0044896601902, -842.2775748546107, -982.0806194066563, -1115.2918539035004, -104.90569754266373, -912.5040246336359, -672.6149331989616, -58.299146133066294, -137.64138020066343, -876.7608654894353, -755.4598637824467, -90.85424340809996, -98.29529462749694, -893.352179610534, -156.8092428678514, -1110.6698609394589, -1132.3377468530025, -498.6644222807157, -841.2666016750727, -534.3474791825112, -316.7041063975458, -634.5994389334098, -815.5275411121032, -118.24253607928709, -144.0662043766478, -263.16106852833826, -1219.0100000134105, -93.40895455510173, -902.1242096497477, -993.9947108150556, -1360.594167838146, -159.9805589701528, -193.95781807083802, -1127.252980875567, -219.36277645087742, -885.8499143351593, -156.98025294426094, -382.36984248326337, -105.20969156947687, -748.473379724215, -120.98150563745948, -329.35628904339393, -145.67137523276475, -442.65608233525677, -1447.5942580755375, -219.63710636793078, -490.8428123422997, -277.03991369868663, -286.6847008908581, -1058.0676602242293, -204.63927368924416, -159.2806552977983, -1254.973098186631, -228.37826630861963, -63.38579679696535, -1030.7657846908592, -931.6334574312793, -141.38087409693813, -896.2717945038689, -197.65811011160284, -114.40587412076715, -938.0704106717571, -125.36942828201681, -439.68711075360227, -301.22238606578526, -1037.5823080519485, -207.97296962731482, -877.1562676710333, -374.28141911764754, -1105.305197583614, -1215.330563314777, -156.27119089978783, -1037.4964810341507, -226.3560134999377], "episode_lengths": [150, 150, 150, 44, 55, 70, 60, 150, 150, 64, 150, 150, 80, 150, 150, 133, 150, 150, 74, 150, 87, 150, 127, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 53, 84, 150, 142, 53, 72, 150, 84, 150, 150, 120, 150, 134, 98, 150, 150, 71, 75, 120, 150, 61, 150, 150, 150, 90, 95, 150, 115, 150, 87, 150, 75, 150, 78, 87, 64, 134, 150, 100, 150, 124, 78, 150, 72, 88, 150, 100, 65, 150, 150, 82, 150, 83, 70, 150, 81, 143, 102, 150, 75, 150, 124, 150, 150, 84, 150, 71], "policy_policy_0_reward": [-752.680509071337, -1179.067717711892, -661.026868168558, -13.071333457329695, -63.9318202483257, -113.7613733010831, -65.70031157522902, -1258.4968306196902, -714.9216151450165, -61.99901494166497, -769.438498716645, -1295.1827952073158, -237.40029195442222, -649.3412585982492, -1250.6364292514377, -506.68630685711656, -1197.831706059506, -1193.4451471768298, -285.02480528002, -1186.49765242018, -249.4385265613973, -955.8009268828381, -489.51654295045734, -1236.5261926040303, -871.7810638691785, -1066.5598290843188, -882.0044896601902, -842.2775748546107, -982.0806194066563, -1115.2918539035004, -104.90569754266373, -912.5040246336359, -672.6149331989616, -58.299146133066294, -137.64138020066343, -876.7608654894353, -755.4598637824467, -90.85424340809996, -98.29529462749694, -893.352179610534, -156.8092428678514, -1110.6698609394589, -1132.3377468530025, -498.6644222807157, -841.2666016750727, -534.3474791825112, -316.7041063975458, -634.5994389334098, -815.5275411121032, -118.24253607928709, -144.0662043766478, -263.16106852833826, -1219.0100000134105, -93.40895455510173, -902.1242096497477, -993.9947108150556, -1360.594167838146, -159.9805589701528, -193.95781807083802, -1127.252980875567, -219.36277645087742, -885.8499143351593, -156.98025294426094, -382.36984248326337, -105.20969156947687, -748.473379724215, -120.98150563745948, -329.35628904339393, -145.67137523276475, -442.65608233525677, -1447.5942580755375, -219.63710636793078, -490.8428123422997, -277.03991369868663, -286.6847008908581, -1058.0676602242293, -204.63927368924416, -159.2806552977983, -1254.973098186631, -228.37826630861963, -63.38579679696535, -1030.7657846908592, -931.6334574312793, -141.38087409693813, -896.2717945038689, -197.65811011160284, -114.40587412076715, -938.0704106717571, -125.36942828201681, -439.68711075360227, -301.22238606578526, -1037.5823080519485, -207.97296962731482, -877.1562676710333, -374.28141911764754, -1105.305197583614, -1215.330563314777, -156.27119089978783, -1037.4964810341507, -226.3560134999377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522828941171345, "mean_inference_ms": 1.721863107994644, "mean_action_processing_ms": 0.27379854437267304, "mean_env_wait_ms": 3.4658918583947536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01245880126953125, "StateBufferConnector_ms": 0.007975339889526367, "ViewRequirementAgentConnector_ms": 0.19325542449951172}, "num_episodes": 37, "episode_return_max": -13.071333457329695, "episode_return_min": -1447.5942580755375, "episode_return_mean": -599.464794773436, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.0114700979982, "num_env_steps_trained_throughput_per_sec": 305.0114700979982, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12621.842, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12621.766, "sample_time_ms": 1214.454, "learn_time_ms": 11339.272, "learn_throughput": 352.756, "synch_weights_time_ms": 67.194}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "07142_00000", "date": "2024-08-04_10-20-26", "timestamp": 1722747026, "time_this_iter_s": 13.127099990844727, "time_total_s": 427.7714834213257, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724499ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.7714834213257, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.95555555555556, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 236.2258565624555, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.892335556074977, "policy_loss": -0.012399014048181318, "vf_loss": 3.9113950210313004, "vf_explained_var": 0.9922862601156036, "kl": 0.01345497373282952, "entropy": 1.5742562831689915, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -18.03528933023682, "episode_reward_min": -1447.5942580755375, "episode_reward_mean": -585.5684222238802, "episode_len_mean": 117.65, "episode_media": {}, "episodes_timesteps_total": 11765, "policy_reward_min": {"policy_0": -1447.5942580755375}, "policy_reward_max": {"policy_0": -18.03528933023682}, "policy_reward_mean": {"policy_0": -585.5684222238802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-876.7608654894353, -755.4598637824467, -90.85424340809996, -98.29529462749694, -893.352179610534, -156.8092428678514, -1110.6698609394589, -1132.3377468530025, -498.6644222807157, -841.2666016750727, -534.3474791825112, -316.7041063975458, -634.5994389334098, -815.5275411121032, -118.24253607928709, -144.0662043766478, -263.16106852833826, -1219.0100000134105, -93.40895455510173, -902.1242096497477, -993.9947108150556, -1360.594167838146, -159.9805589701528, -193.95781807083802, -1127.252980875567, -219.36277645087742, -885.8499143351593, -156.98025294426094, -382.36984248326337, -105.20969156947687, -748.473379724215, -120.98150563745948, -329.35628904339393, -145.67137523276475, -442.65608233525677, -1447.5942580755375, -219.63710636793078, -490.8428123422997, -277.03991369868663, -286.6847008908581, -1058.0676602242293, -204.63927368924416, -159.2806552977983, -1254.973098186631, -228.37826630861963, -63.38579679696535, -1030.7657846908592, -931.6334574312793, -141.38087409693813, -896.2717945038689, -197.65811011160284, -114.40587412076715, -938.0704106717571, -125.36942828201681, -439.68711075360227, -301.22238606578526, -1037.5823080519485, -207.97296962731482, -877.1562676710333, -374.28141911764754, -1105.305197583614, -1215.330563314777, -156.27119089978783, -1037.4964810341507, -226.3560134999377, -1052.7594093148523, -746.6401270097707, -1193.4898135928374, -139.1109614030616, -1382.5106839599034, -126.85336792682554, -1172.6753435166274, -129.99570300900174, -183.92283764227028, -1184.0537019867058, -355.2155735328448, -1250.8568453144173, -138.57579534935888, -742.3250849315915, -1209.9417128354246, -1273.9492594721187, -1029.6268388732394, -932.5155189200152, -298.8718082743176, -586.1604315111641, -980.2964248404596, -1399.5367853082444, -1314.818593205132, -232.57170455993497, -328.8209777692941, -273.99464347991585, -954.9201654511028, -48.822743077007004, -287.99375132148083, -779.2980212548191, -731.1072956891384, -21.02195592084925, -110.81256350077838, -18.03528933023682, -31.646099207691655], "episode_lengths": [150, 142, 53, 72, 150, 84, 150, 150, 120, 150, 134, 98, 150, 150, 71, 75, 120, 150, 61, 150, 150, 150, 90, 95, 150, 115, 150, 87, 150, 75, 150, 78, 87, 64, 134, 150, 100, 150, 124, 78, 150, 72, 88, 150, 100, 65, 150, 150, 82, 150, 83, 70, 150, 81, 143, 102, 150, 75, 150, 124, 150, 150, 84, 150, 71, 150, 150, 150, 76, 150, 63, 150, 73, 81, 150, 101, 150, 83, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 121, 110, 123, 150, 56, 121, 150, 150, 39, 62, 40, 49], "policy_policy_0_reward": [-876.7608654894353, -755.4598637824467, -90.85424340809996, -98.29529462749694, -893.352179610534, -156.8092428678514, -1110.6698609394589, -1132.3377468530025, -498.6644222807157, -841.2666016750727, -534.3474791825112, -316.7041063975458, -634.5994389334098, -815.5275411121032, -118.24253607928709, -144.0662043766478, -263.16106852833826, -1219.0100000134105, -93.40895455510173, -902.1242096497477, -993.9947108150556, -1360.594167838146, -159.9805589701528, -193.95781807083802, -1127.252980875567, -219.36277645087742, -885.8499143351593, -156.98025294426094, -382.36984248326337, -105.20969156947687, -748.473379724215, -120.98150563745948, -329.35628904339393, -145.67137523276475, -442.65608233525677, -1447.5942580755375, -219.63710636793078, -490.8428123422997, -277.03991369868663, -286.6847008908581, -1058.0676602242293, -204.63927368924416, -159.2806552977983, -1254.973098186631, -228.37826630861963, -63.38579679696535, -1030.7657846908592, -931.6334574312793, -141.38087409693813, -896.2717945038689, -197.65811011160284, -114.40587412076715, -938.0704106717571, -125.36942828201681, -439.68711075360227, -301.22238606578526, -1037.5823080519485, -207.97296962731482, -877.1562676710333, -374.28141911764754, -1105.305197583614, -1215.330563314777, -156.27119089978783, -1037.4964810341507, -226.3560134999377, -1052.7594093148523, -746.6401270097707, -1193.4898135928374, -139.1109614030616, -1382.5106839599034, -126.85336792682554, -1172.6753435166274, -129.99570300900174, -183.92283764227028, -1184.0537019867058, -355.2155735328448, -1250.8568453144173, -138.57579534935888, -742.3250849315915, -1209.9417128354246, -1273.9492594721187, -1029.6268388732394, -932.5155189200152, -298.8718082743176, -586.1604315111641, -980.2964248404596, -1399.5367853082444, -1314.818593205132, -232.57170455993497, -328.8209777692941, -273.99464347991585, -954.9201654511028, -48.822743077007004, -287.99375132148083, -779.2980212548191, -731.1072956891384, -21.02195592084925, -110.81256350077838, -18.03528933023682, -31.646099207691655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518574763879811, "mean_inference_ms": 1.720826547509779, "mean_action_processing_ms": 0.2736287238658457, "mean_env_wait_ms": 3.4682346885497166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012583255767822266, "StateBufferConnector_ms": 0.008029937744140625, "ViewRequirementAgentConnector_ms": 0.19472241401672363}, "num_episodes": 35, "episode_return_max": -18.03528933023682, "episode_return_min": -1447.5942580755375, "episode_return_mean": -585.5684222238802, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.56623829503343, "num_env_steps_trained_throughput_per_sec": 306.56623829503343, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12658.227, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12658.153, "sample_time_ms": 1214.044, "learn_time_ms": 11376.533, "learn_throughput": 351.601, "synch_weights_time_ms": 66.729}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "07142_00000", "date": "2024-08-04_10-20-39", "timestamp": 1722747039, "time_this_iter_s": 13.060593843460083, "time_total_s": 440.83207726478577, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449b130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 440.83207726478577, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.55789473684211, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 263.2829019129276, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.238742466146747, "policy_loss": -0.0028227565213455818, "vf_loss": 3.2468737701574963, "vf_explained_var": 0.9761665226270755, "kl": 0.013546938711518427, "entropy": 1.4452721555406849, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -3.2859894185474636, "episode_reward_min": -1447.5942580755375, "episode_reward_mean": -565.7980185893139, "episode_len_mean": 114.88, "episode_media": {}, "episodes_timesteps_total": 11488, "policy_reward_min": {"policy_0": -1447.5942580755375}, "policy_reward_max": {"policy_0": -3.2859894185474636}, "policy_reward_mean": {"policy_0": -565.7980185893139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-145.67137523276475, -442.65608233525677, -1447.5942580755375, -219.63710636793078, -490.8428123422997, -277.03991369868663, -286.6847008908581, -1058.0676602242293, -204.63927368924416, -159.2806552977983, -1254.973098186631, -228.37826630861963, -63.38579679696535, -1030.7657846908592, -931.6334574312793, -141.38087409693813, -896.2717945038689, -197.65811011160284, -114.40587412076715, -938.0704106717571, -125.36942828201681, -439.68711075360227, -301.22238606578526, -1037.5823080519485, -207.97296962731482, -877.1562676710333, -374.28141911764754, -1105.305197583614, -1215.330563314777, -156.27119089978783, -1037.4964810341507, -226.3560134999377, -1052.7594093148523, -746.6401270097707, -1193.4898135928374, -139.1109614030616, -1382.5106839599034, -126.85336792682554, -1172.6753435166274, -129.99570300900174, -183.92283764227028, -1184.0537019867058, -355.2155735328448, -1250.8568453144173, -138.57579534935888, -742.3250849315915, -1209.9417128354246, -1273.9492594721187, -1029.6268388732394, -932.5155189200152, -298.8718082743176, -586.1604315111641, -980.2964248404596, -1399.5367853082444, -1314.818593205132, -232.57170455993497, -328.8209777692941, -273.99464347991585, -954.9201654511028, -48.822743077007004, -287.99375132148083, -779.2980212548191, -731.1072956891384, -21.02195592084925, -110.81256350077838, -18.03528933023682, -31.646099207691655, -951.2365691927097, -685.6439306080483, -25.453345198599546, -138.1974336571765, -190.28821364509852, -1066.0064023390266, -474.9287917418901, -209.40814094628763, -107.00422637895177, -163.10614535976868, -388.7356839925194, -900.5300470617427, -1193.6132707926893, -3.2859894185474636, -318.9715939683893, -34.077301467535584, -181.3012745009229, -1033.2388452140253, -667.6643410895269, -388.13177172360037, -576.0289415733585, -1118.1285233803915, -510.11508735231905, -1211.5143808277166, -236.051588158297, -1121.5046776260372, -183.76064108156436, -367.48012399909635, -106.03001081137161, -276.98950957149884, -948.3373833804542, -144.86730807038066, -381.3538915339034], "episode_lengths": [64, 134, 150, 100, 150, 124, 78, 150, 72, 88, 150, 100, 65, 150, 150, 82, 150, 83, 70, 150, 81, 143, 102, 150, 75, 150, 124, 150, 150, 84, 150, 71, 150, 150, 150, 76, 150, 63, 150, 73, 81, 150, 101, 150, 83, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 121, 110, 123, 150, 56, 121, 150, 150, 39, 62, 40, 49, 150, 150, 40, 85, 69, 150, 137, 105, 75, 74, 150, 150, 150, 32, 104, 50, 90, 150, 150, 93, 150, 150, 145, 150, 77, 150, 65, 92, 81, 78, 150, 82, 106], "policy_policy_0_reward": [-145.67137523276475, -442.65608233525677, -1447.5942580755375, -219.63710636793078, -490.8428123422997, -277.03991369868663, -286.6847008908581, -1058.0676602242293, -204.63927368924416, -159.2806552977983, -1254.973098186631, -228.37826630861963, -63.38579679696535, -1030.7657846908592, -931.6334574312793, -141.38087409693813, -896.2717945038689, -197.65811011160284, -114.40587412076715, -938.0704106717571, -125.36942828201681, -439.68711075360227, -301.22238606578526, -1037.5823080519485, -207.97296962731482, -877.1562676710333, -374.28141911764754, -1105.305197583614, -1215.330563314777, -156.27119089978783, -1037.4964810341507, -226.3560134999377, -1052.7594093148523, -746.6401270097707, -1193.4898135928374, -139.1109614030616, -1382.5106839599034, -126.85336792682554, -1172.6753435166274, -129.99570300900174, -183.92283764227028, -1184.0537019867058, -355.2155735328448, -1250.8568453144173, -138.57579534935888, -742.3250849315915, -1209.9417128354246, -1273.9492594721187, -1029.6268388732394, -932.5155189200152, -298.8718082743176, -586.1604315111641, -980.2964248404596, -1399.5367853082444, -1314.818593205132, -232.57170455993497, -328.8209777692941, -273.99464347991585, -954.9201654511028, -48.822743077007004, -287.99375132148083, -779.2980212548191, -731.1072956891384, -21.02195592084925, -110.81256350077838, -18.03528933023682, -31.646099207691655, -951.2365691927097, -685.6439306080483, -25.453345198599546, -138.1974336571765, -190.28821364509852, -1066.0064023390266, -474.9287917418901, -209.40814094628763, -107.00422637895177, -163.10614535976868, -388.7356839925194, -900.5300470617427, -1193.6132707926893, -3.2859894185474636, -318.9715939683893, -34.077301467535584, -181.3012745009229, -1033.2388452140253, -667.6643410895269, -388.13177172360037, -576.0289415733585, -1118.1285233803915, -510.11508735231905, -1211.5143808277166, -236.051588158297, -1121.5046776260372, -183.76064108156436, -367.48012399909635, -106.03001081137161, -276.98950957149884, -948.3373833804542, -144.86730807038066, -381.3538915339034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520632593387949, "mean_inference_ms": 1.719766182855752, "mean_action_processing_ms": 0.2737431925043969, "mean_env_wait_ms": 3.4702249728792447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011888265609741211, "StateBufferConnector_ms": 0.008051395416259766, "ViewRequirementAgentConnector_ms": 0.1940910816192627}, "num_episodes": 33, "episode_return_max": -3.2859894185474636, "episode_return_min": -1447.5942580755375, "episode_return_mean": -565.7980185893139, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.46847159717476, "num_env_steps_trained_throughput_per_sec": 317.46847159717476, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12749.122, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12749.049, "sample_time_ms": 1213.821, "learn_time_ms": 11467.093, "learn_throughput": 348.824, "synch_weights_time_ms": 67.271}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "07142_00000", "date": "2024-08-04_10-20-51", "timestamp": 1722747051, "time_this_iter_s": 12.611791133880615, "time_total_s": 453.4438683986664, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724417250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 453.4438683986664, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.744444444444447, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 277.4042201558749, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.317217933634917, "policy_loss": -0.00022315984654899996, "vf_loss": 3.3238403720160323, "vf_explained_var": 0.979828819570442, "kl": 0.012751375348125342, "entropy": 1.5006464657684166, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -3.2859894185474636, "episode_reward_min": -1399.5367853082444, "episode_reward_mean": -580.0936218197079, "episode_len_mean": 114.75, "episode_media": {}, "episodes_timesteps_total": 11475, "policy_reward_min": {"policy_0": -1399.5367853082444}, "policy_reward_max": {"policy_0": -3.2859894185474636}, "policy_reward_mean": {"policy_0": -580.0936218197079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1193.4898135928374, -139.1109614030616, -1382.5106839599034, -126.85336792682554, -1172.6753435166274, -129.99570300900174, -183.92283764227028, -1184.0537019867058, -355.2155735328448, -1250.8568453144173, -138.57579534935888, -742.3250849315915, -1209.9417128354246, -1273.9492594721187, -1029.6268388732394, -932.5155189200152, -298.8718082743176, -586.1604315111641, -980.2964248404596, -1399.5367853082444, -1314.818593205132, -232.57170455993497, -328.8209777692941, -273.99464347991585, -954.9201654511028, -48.822743077007004, -287.99375132148083, -779.2980212548191, -731.1072956891384, -21.02195592084925, -110.81256350077838, -18.03528933023682, -31.646099207691655, -951.2365691927097, -685.6439306080483, -25.453345198599546, -138.1974336571765, -190.28821364509852, -1066.0064023390266, -474.9287917418901, -209.40814094628763, -107.00422637895177, -163.10614535976868, -388.7356839925194, -900.5300470617427, -1193.6132707926893, -3.2859894185474636, -318.9715939683893, -34.077301467535584, -181.3012745009229, -1033.2388452140253, -667.6643410895269, -388.13177172360037, -576.0289415733585, -1118.1285233803915, -510.11508735231905, -1211.5143808277166, -236.051588158297, -1121.5046776260372, -183.76064108156436, -367.48012399909635, -106.03001081137161, -276.98950957149884, -948.3373833804542, -144.86730807038066, -381.3538915339034, -1014.9967452847329, -991.9731319995301, -952.9624487737191, -830.1411845964726, -57.92777514544324, -113.42366657711912, -1095.17144229588, -858.3252170381037, -452.2640137951415, -315.6229959889101, -51.76167315707633, -52.13222803297481, -627.2033810003687, -970.9244051186064, -1197.2299372741363, -929.8361187696628, -827.2297238543799, -268.0746338984031, -251.40653516517884, -1086.9776513314048, -1088.369213619708, -1098.9020044918186, -22.015501001264916, -831.0605410709384, -699.6076240519977, -872.2817195720341, -131.8631878528199, -1394.2469682689646, -821.5042996816298, -251.3728803164537, -94.39931866744863, -86.73371027238372, -415.84845450911877, -108.23816786570255], "episode_lengths": [150, 76, 150, 63, 150, 73, 81, 150, 101, 150, 83, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 121, 110, 123, 150, 56, 121, 150, 150, 39, 62, 40, 49, 150, 150, 40, 85, 69, 150, 137, 105, 75, 74, 150, 150, 150, 32, 104, 50, 90, 150, 150, 93, 150, 150, 145, 150, 77, 150, 65, 92, 81, 78, 150, 82, 106, 150, 150, 150, 150, 58, 68, 150, 143, 134, 111, 58, 64, 150, 150, 150, 150, 150, 75, 78, 150, 150, 150, 41, 150, 150, 150, 65, 150, 150, 72, 53, 72, 110, 75], "policy_policy_0_reward": [-1193.4898135928374, -139.1109614030616, -1382.5106839599034, -126.85336792682554, -1172.6753435166274, -129.99570300900174, -183.92283764227028, -1184.0537019867058, -355.2155735328448, -1250.8568453144173, -138.57579534935888, -742.3250849315915, -1209.9417128354246, -1273.9492594721187, -1029.6268388732394, -932.5155189200152, -298.8718082743176, -586.1604315111641, -980.2964248404596, -1399.5367853082444, -1314.818593205132, -232.57170455993497, -328.8209777692941, -273.99464347991585, -954.9201654511028, -48.822743077007004, -287.99375132148083, -779.2980212548191, -731.1072956891384, -21.02195592084925, -110.81256350077838, -18.03528933023682, -31.646099207691655, -951.2365691927097, -685.6439306080483, -25.453345198599546, -138.1974336571765, -190.28821364509852, -1066.0064023390266, -474.9287917418901, -209.40814094628763, -107.00422637895177, -163.10614535976868, -388.7356839925194, -900.5300470617427, -1193.6132707926893, -3.2859894185474636, -318.9715939683893, -34.077301467535584, -181.3012745009229, -1033.2388452140253, -667.6643410895269, -388.13177172360037, -576.0289415733585, -1118.1285233803915, -510.11508735231905, -1211.5143808277166, -236.051588158297, -1121.5046776260372, -183.76064108156436, -367.48012399909635, -106.03001081137161, -276.98950957149884, -948.3373833804542, -144.86730807038066, -381.3538915339034, -1014.9967452847329, -991.9731319995301, -952.9624487737191, -830.1411845964726, -57.92777514544324, -113.42366657711912, -1095.17144229588, -858.3252170381037, -452.2640137951415, -315.6229959889101, -51.76167315707633, -52.13222803297481, -627.2033810003687, -970.9244051186064, -1197.2299372741363, -929.8361187696628, -827.2297238543799, -268.0746338984031, -251.40653516517884, -1086.9776513314048, -1088.369213619708, -1098.9020044918186, -22.015501001264916, -831.0605410709384, -699.6076240519977, -872.2817195720341, -131.8631878528199, -1394.2469682689646, -821.5042996816298, -251.3728803164537, -94.39931866744863, -86.73371027238372, -415.84845450911877, -108.23816786570255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.551967240039347, "mean_inference_ms": 1.7180254767425132, "mean_action_processing_ms": 0.27377526627433063, "mean_env_wait_ms": 3.4732360237486826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011998176574707031, "StateBufferConnector_ms": 0.008063316345214844, "ViewRequirementAgentConnector_ms": 0.19459104537963867}, "num_episodes": 34, "episode_return_max": -3.2859894185474636, "episode_return_min": -1399.5367853082444, "episode_return_mean": -580.0936218197079, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.3939252696293, "num_env_steps_trained_throughput_per_sec": 368.3939252696293, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12534.882, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12534.811, "sample_time_ms": 1208.465, "learn_time_ms": 11260.361, "learn_throughput": 355.228, "synch_weights_time_ms": 65.119}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "07142_00000", "date": "2024-08-04_10-21-02", "timestamp": 1722747062, "time_this_iter_s": 10.87019944190979, "time_total_s": 464.3140678405762, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724499ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 464.3140678405762, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.213333333333335, "ram_util_percent": 28.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 245.13462852040928, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.3072751365602016, "policy_loss": -0.0023618676107920087, "vf_loss": 3.314615495254596, "vf_explained_var": 0.9788634076714515, "kl": 0.01318190913692285, "entropy": 1.3876286764939627, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -3.2859894185474636, "episode_reward_min": -1394.2469682689646, "episode_reward_mean": -547.9493004695842, "episode_len_mean": 113.79, "episode_media": {}, "episodes_timesteps_total": 11379, "policy_reward_min": {"policy_0": -1394.2469682689646}, "policy_reward_max": {"policy_0": -3.2859894185474636}, "policy_reward_mean": {"policy_0": -547.9493004695842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1066.0064023390266, -474.9287917418901, -209.40814094628763, -107.00422637895177, -163.10614535976868, -388.7356839925194, -900.5300470617427, -1193.6132707926893, -3.2859894185474636, -318.9715939683893, -34.077301467535584, -181.3012745009229, -1033.2388452140253, -667.6643410895269, -388.13177172360037, -576.0289415733585, -1118.1285233803915, -510.11508735231905, -1211.5143808277166, -236.051588158297, -1121.5046776260372, -183.76064108156436, -367.48012399909635, -106.03001081137161, -276.98950957149884, -948.3373833804542, -144.86730807038066, -381.3538915339034, -1014.9967452847329, -991.9731319995301, -952.9624487737191, -830.1411845964726, -57.92777514544324, -113.42366657711912, -1095.17144229588, -858.3252170381037, -452.2640137951415, -315.6229959889101, -51.76167315707633, -52.13222803297481, -627.2033810003687, -970.9244051186064, -1197.2299372741363, -929.8361187696628, -827.2297238543799, -268.0746338984031, -251.40653516517884, -1086.9776513314048, -1088.369213619708, -1098.9020044918186, -22.015501001264916, -831.0605410709384, -699.6076240519977, -872.2817195720341, -131.8631878528199, -1394.2469682689646, -821.5042996816298, -251.3728803164537, -94.39931866744863, -86.73371027238372, -415.84845450911877, -108.23816786570255, -818.7704564884247, -529.3755602962297, -160.8502536899175, -521.2395773736569, -91.36525965770198, -87.02259158923783, -972.4572249198413, -39.83588166624027, -164.25204797478526, -139.19507255398372, -790.8414392055058, -1076.7212860121897, -132.83882935712964, -286.43660905492663, -1082.4393307480739, -96.27890133430503, -1194.601937327857, -409.71262925309776, -339.99217479578726, -34.200935144586154, -826.5185728530577, -1202.6685491359272, -347.62695233064113, -854.2108303981532, -1266.0043023623853, -115.89884730026128, -123.26478368783063, -816.6460346743232, -45.4660661810772, -917.4254179439755, -20.03589922451072, -1052.640430760616, -72.20935197975027, -240.82787240560452, -84.2730953865264, -1279.050462300542, -394.35596746486283, -993.1842184235506], "episode_lengths": [150, 137, 105, 75, 74, 150, 150, 150, 32, 104, 50, 90, 150, 150, 93, 150, 150, 145, 150, 77, 150, 65, 92, 81, 78, 150, 82, 106, 150, 150, 150, 150, 58, 68, 150, 143, 134, 111, 58, 64, 150, 150, 150, 150, 150, 75, 78, 150, 150, 150, 41, 150, 150, 150, 65, 150, 150, 72, 53, 72, 110, 75, 135, 149, 91, 119, 61, 63, 150, 58, 84, 83, 150, 150, 78, 120, 150, 70, 150, 116, 129, 49, 150, 150, 110, 150, 150, 87, 76, 150, 58, 150, 43, 150, 66, 113, 58, 150, 150, 150], "policy_policy_0_reward": [-1066.0064023390266, -474.9287917418901, -209.40814094628763, -107.00422637895177, -163.10614535976868, -388.7356839925194, -900.5300470617427, -1193.6132707926893, -3.2859894185474636, -318.9715939683893, -34.077301467535584, -181.3012745009229, -1033.2388452140253, -667.6643410895269, -388.13177172360037, -576.0289415733585, -1118.1285233803915, -510.11508735231905, -1211.5143808277166, -236.051588158297, -1121.5046776260372, -183.76064108156436, -367.48012399909635, -106.03001081137161, -276.98950957149884, -948.3373833804542, -144.86730807038066, -381.3538915339034, -1014.9967452847329, -991.9731319995301, -952.9624487737191, -830.1411845964726, -57.92777514544324, -113.42366657711912, -1095.17144229588, -858.3252170381037, -452.2640137951415, -315.6229959889101, -51.76167315707633, -52.13222803297481, -627.2033810003687, -970.9244051186064, -1197.2299372741363, -929.8361187696628, -827.2297238543799, -268.0746338984031, -251.40653516517884, -1086.9776513314048, -1088.369213619708, -1098.9020044918186, -22.015501001264916, -831.0605410709384, -699.6076240519977, -872.2817195720341, -131.8631878528199, -1394.2469682689646, -821.5042996816298, -251.3728803164537, -94.39931866744863, -86.73371027238372, -415.84845450911877, -108.23816786570255, -818.7704564884247, -529.3755602962297, -160.8502536899175, -521.2395773736569, -91.36525965770198, -87.02259158923783, -972.4572249198413, -39.83588166624027, -164.25204797478526, -139.19507255398372, -790.8414392055058, -1076.7212860121897, -132.83882935712964, -286.43660905492663, -1082.4393307480739, -96.27890133430503, -1194.601937327857, -409.71262925309776, -339.99217479578726, -34.200935144586154, -826.5185728530577, -1202.6685491359272, -347.62695233064113, -854.2108303981532, -1266.0043023623853, -115.89884730026128, -123.26478368783063, -816.6460346743232, -45.4660661810772, -917.4254179439755, -20.03589922451072, -1052.640430760616, -72.20935197975027, -240.82787240560452, -84.2730953865264, -1279.050462300542, -394.35596746486283, -993.1842184235506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524933615966507, "mean_inference_ms": 1.7173235180830217, "mean_action_processing_ms": 0.27372520089281355, "mean_env_wait_ms": 3.471791846991149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011719703674316406, "StateBufferConnector_ms": 0.00796961784362793, "ViewRequirementAgentConnector_ms": 0.19089412689208984}, "num_episodes": 38, "episode_return_max": -3.2859894185474636, "episode_return_min": -1394.2469682689646, "episode_return_mean": -547.9493004695842, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.56966736382446, "num_env_steps_trained_throughput_per_sec": 298.56966736382446, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12606.118, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12606.046, "sample_time_ms": 1211.016, "learn_time_ms": 11329.536, "learn_throughput": 353.059, "synch_weights_time_ms": 64.632}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "07142_00000", "date": "2024-08-04_10-21-16", "timestamp": 1722747076, "time_this_iter_s": 13.409072637557983, "time_total_s": 477.72314047813416, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f5750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 477.72314047813416, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.336842105263155, "ram_util_percent": 28.210526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 307.8540855149428, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.9793439611792563, "policy_loss": -0.012951426978300635, "vf_loss": 3.002852987498045, "vf_explained_var": 0.9883702687298258, "kl": 0.010196557283476727, "entropy": 1.7440277031312386, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -20.03589922451072, "episode_reward_min": -1394.2469682689646, "episode_reward_mean": -580.3191574640648, "episode_len_mean": 116.83, "episode_media": {}, "episodes_timesteps_total": 11683, "policy_reward_min": {"policy_0": -1394.2469682689646}, "policy_reward_max": {"policy_0": -20.03589922451072}, "policy_reward_mean": {"policy_0": -580.3191574640648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-952.9624487737191, -830.1411845964726, -57.92777514544324, -113.42366657711912, -1095.17144229588, -858.3252170381037, -452.2640137951415, -315.6229959889101, -51.76167315707633, -52.13222803297481, -627.2033810003687, -970.9244051186064, -1197.2299372741363, -929.8361187696628, -827.2297238543799, -268.0746338984031, -251.40653516517884, -1086.9776513314048, -1088.369213619708, -1098.9020044918186, -22.015501001264916, -831.0605410709384, -699.6076240519977, -872.2817195720341, -131.8631878528199, -1394.2469682689646, -821.5042996816298, -251.3728803164537, -94.39931866744863, -86.73371027238372, -415.84845450911877, -108.23816786570255, -818.7704564884247, -529.3755602962297, -160.8502536899175, -521.2395773736569, -91.36525965770198, -87.02259158923783, -972.4572249198413, -39.83588166624027, -164.25204797478526, -139.19507255398372, -790.8414392055058, -1076.7212860121897, -132.83882935712964, -286.43660905492663, -1082.4393307480739, -96.27890133430503, -1194.601937327857, -409.71262925309776, -339.99217479578726, -34.200935144586154, -826.5185728530577, -1202.6685491359272, -347.62695233064113, -854.2108303981532, -1266.0043023623853, -115.89884730026128, -123.26478368783063, -816.6460346743232, -45.4660661810772, -917.4254179439755, -20.03589922451072, -1052.640430760616, -72.20935197975027, -240.82787240560452, -84.2730953865264, -1279.050462300542, -394.35596746486283, -993.1842184235506, -304.1223148484824, -42.33446388062024, -1106.4509835257215, -80.43478721238976, -1363.740416398631, -1097.5834412637425, -894.1624083361015, -825.3877792336341, -417.04061321077745, -1059.3739183980151, -151.60020429338584, -1124.552310369291, -77.39207800963301, -213.43789974078368, -563.9305988332645, -46.47282738726741, -1120.945731951807, -42.65165727265618, -705.0159460063633, -1163.827570754214, -637.090924420124, -221.9452369054701, -164.89382741315222, -782.507606197677, -678.9449439206613, -1157.760912104946, -1295.6662911170126, -981.4914322155867, -839.2529471920517, -396.1093976806708], "episode_lengths": [150, 150, 58, 68, 150, 143, 134, 111, 58, 64, 150, 150, 150, 150, 150, 75, 78, 150, 150, 150, 41, 150, 150, 150, 65, 150, 150, 72, 53, 72, 110, 75, 135, 149, 91, 119, 61, 63, 150, 58, 84, 83, 150, 150, 78, 120, 150, 70, 150, 116, 129, 49, 150, 150, 110, 150, 150, 87, 76, 150, 58, 150, 43, 150, 66, 113, 58, 150, 150, 150, 112, 56, 150, 59, 150, 150, 150, 150, 140, 150, 76, 150, 52, 93, 150, 67, 150, 57, 139, 150, 150, 102, 87, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-952.9624487737191, -830.1411845964726, -57.92777514544324, -113.42366657711912, -1095.17144229588, -858.3252170381037, -452.2640137951415, -315.6229959889101, -51.76167315707633, -52.13222803297481, -627.2033810003687, -970.9244051186064, -1197.2299372741363, -929.8361187696628, -827.2297238543799, -268.0746338984031, -251.40653516517884, -1086.9776513314048, -1088.369213619708, -1098.9020044918186, -22.015501001264916, -831.0605410709384, -699.6076240519977, -872.2817195720341, -131.8631878528199, -1394.2469682689646, -821.5042996816298, -251.3728803164537, -94.39931866744863, -86.73371027238372, -415.84845450911877, -108.23816786570255, -818.7704564884247, -529.3755602962297, -160.8502536899175, -521.2395773736569, -91.36525965770198, -87.02259158923783, -972.4572249198413, -39.83588166624027, -164.25204797478526, -139.19507255398372, -790.8414392055058, -1076.7212860121897, -132.83882935712964, -286.43660905492663, -1082.4393307480739, -96.27890133430503, -1194.601937327857, -409.71262925309776, -339.99217479578726, -34.200935144586154, -826.5185728530577, -1202.6685491359272, -347.62695233064113, -854.2108303981532, -1266.0043023623853, -115.89884730026128, -123.26478368783063, -816.6460346743232, -45.4660661810772, -917.4254179439755, -20.03589922451072, -1052.640430760616, -72.20935197975027, -240.82787240560452, -84.2730953865264, -1279.050462300542, -394.35596746486283, -993.1842184235506, -304.1223148484824, -42.33446388062024, -1106.4509835257215, -80.43478721238976, -1363.740416398631, -1097.5834412637425, -894.1624083361015, -825.3877792336341, -417.04061321077745, -1059.3739183980151, -151.60020429338584, -1124.552310369291, -77.39207800963301, -213.43789974078368, -563.9305988332645, -46.47282738726741, -1120.945731951807, -42.65165727265618, -705.0159460063633, -1163.827570754214, -637.090924420124, -221.9452369054701, -164.89382741315222, -782.507606197677, -678.9449439206613, -1157.760912104946, -1295.6662911170126, -981.4914322155867, -839.2529471920517, -396.1093976806708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525945530180804, "mean_inference_ms": 1.7161076560246749, "mean_action_processing_ms": 0.2735804358118012, "mean_env_wait_ms": 3.4709260248238736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011713504791259766, "StateBufferConnector_ms": 0.007946252822875977, "ViewRequirementAgentConnector_ms": 0.1918473243713379}, "num_episodes": 30, "episode_return_max": -20.03589922451072, "episode_return_min": -1394.2469682689646, "episode_return_mean": -580.3191574640648, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.69132181855724, "num_env_steps_trained_throughput_per_sec": 306.69132181855724, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12625.39, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12625.319, "sample_time_ms": 1210.563, "learn_time_ms": 11348.762, "learn_throughput": 352.461, "synch_weights_time_ms": 65.128}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "07142_00000", "date": "2024-08-04_10-21-29", "timestamp": 1722747089, "time_this_iter_s": 13.05423355102539, "time_total_s": 490.77737402915955, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 490.77737402915955, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.263157894736842, "ram_util_percent": 28.289473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 248.54268516898156, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.158617761855324, "policy_loss": -0.010378222156335444, "vf_loss": 3.1751736647138995, "vf_explained_var": 0.9926984294628104, "kl": 0.013149276745086098, "entropy": 1.5053441087404886, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -2.0584752940032933, "episode_reward_min": -1363.740416398631, "episode_reward_mean": -561.951011492451, "episode_len_mean": 114.25, "episode_media": {}, "episodes_timesteps_total": 11425, "policy_reward_min": {"policy_0": -1363.740416398631}, "policy_reward_max": {"policy_0": -2.0584752940032933}, "policy_reward_mean": {"policy_0": -561.951011492451}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.83588166624027, -164.25204797478526, -139.19507255398372, -790.8414392055058, -1076.7212860121897, -132.83882935712964, -286.43660905492663, -1082.4393307480739, -96.27890133430503, -1194.601937327857, -409.71262925309776, -339.99217479578726, -34.200935144586154, -826.5185728530577, -1202.6685491359272, -347.62695233064113, -854.2108303981532, -1266.0043023623853, -115.89884730026128, -123.26478368783063, -816.6460346743232, -45.4660661810772, -917.4254179439755, -20.03589922451072, -1052.640430760616, -72.20935197975027, -240.82787240560452, -84.2730953865264, -1279.050462300542, -394.35596746486283, -993.1842184235506, -304.1223148484824, -42.33446388062024, -1106.4509835257215, -80.43478721238976, -1363.740416398631, -1097.5834412637425, -894.1624083361015, -825.3877792336341, -417.04061321077745, -1059.3739183980151, -151.60020429338584, -1124.552310369291, -77.39207800963301, -213.43789974078368, -563.9305988332645, -46.47282738726741, -1120.945731951807, -42.65165727265618, -705.0159460063633, -1163.827570754214, -637.090924420124, -221.9452369054701, -164.89382741315222, -782.507606197677, -678.9449439206613, -1157.760912104946, -1295.6662911170126, -981.4914322155867, -839.2529471920517, -396.1093976806708, -941.2395323684032, -203.0892494182191, -917.7977239359375, -773.5359339121494, -1160.2607787110405, -406.44200934059324, -226.54892274890491, -398.8754739385505, -1123.6074995428826, -23.40917697714323, -114.49222745748477, -43.21593963165351, -77.40003124469084, -1114.376182883362, -33.33461614967833, -1128.6951515147366, -2.0584752940032933, -13.536791698888122, -1187.4907024266276, -1035.5724520369345, -87.37507718890132, -502.96869617138003, -44.17642406101194, -91.40930880463036, -859.9611185006505, -291.8077829333052, -1114.290956271441, -1040.6232311720516, -302.25751995570715, -640.2764351338462, -126.17618020648396, -1030.9167363491727, -1055.542323834238, -717.9229343728791, -74.562132797411, -128.66529908808508, -219.4077067436802, -843.8570420804036, -102.14917301174958], "episode_lengths": [58, 84, 83, 150, 150, 78, 120, 150, 70, 150, 116, 129, 49, 150, 150, 110, 150, 150, 87, 76, 150, 58, 150, 43, 150, 66, 113, 58, 150, 150, 150, 112, 56, 150, 59, 150, 150, 150, 150, 140, 150, 76, 150, 52, 93, 150, 67, 150, 57, 139, 150, 150, 102, 87, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 104, 137, 150, 40, 76, 38, 56, 150, 39, 150, 41, 37, 150, 150, 79, 143, 39, 63, 150, 77, 150, 150, 108, 125, 61, 150, 150, 150, 64, 65, 100, 150, 77], "policy_policy_0_reward": [-39.83588166624027, -164.25204797478526, -139.19507255398372, -790.8414392055058, -1076.7212860121897, -132.83882935712964, -286.43660905492663, -1082.4393307480739, -96.27890133430503, -1194.601937327857, -409.71262925309776, -339.99217479578726, -34.200935144586154, -826.5185728530577, -1202.6685491359272, -347.62695233064113, -854.2108303981532, -1266.0043023623853, -115.89884730026128, -123.26478368783063, -816.6460346743232, -45.4660661810772, -917.4254179439755, -20.03589922451072, -1052.640430760616, -72.20935197975027, -240.82787240560452, -84.2730953865264, -1279.050462300542, -394.35596746486283, -993.1842184235506, -304.1223148484824, -42.33446388062024, -1106.4509835257215, -80.43478721238976, -1363.740416398631, -1097.5834412637425, -894.1624083361015, -825.3877792336341, -417.04061321077745, -1059.3739183980151, -151.60020429338584, -1124.552310369291, -77.39207800963301, -213.43789974078368, -563.9305988332645, -46.47282738726741, -1120.945731951807, -42.65165727265618, -705.0159460063633, -1163.827570754214, -637.090924420124, -221.9452369054701, -164.89382741315222, -782.507606197677, -678.9449439206613, -1157.760912104946, -1295.6662911170126, -981.4914322155867, -839.2529471920517, -396.1093976806708, -941.2395323684032, -203.0892494182191, -917.7977239359375, -773.5359339121494, -1160.2607787110405, -406.44200934059324, -226.54892274890491, -398.8754739385505, -1123.6074995428826, -23.40917697714323, -114.49222745748477, -43.21593963165351, -77.40003124469084, -1114.376182883362, -33.33461614967833, -1128.6951515147366, -2.0584752940032933, -13.536791698888122, -1187.4907024266276, -1035.5724520369345, -87.37507718890132, -502.96869617138003, -44.17642406101194, -91.40930880463036, -859.9611185006505, -291.8077829333052, -1114.290956271441, -1040.6232311720516, -302.25751995570715, -640.2764351338462, -126.17618020648396, -1030.9167363491727, -1055.542323834238, -717.9229343728791, -74.562132797411, -128.66529908808508, -219.4077067436802, -843.8570420804036, -102.14917301174958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527325355316322, "mean_inference_ms": 1.715593295951613, "mean_action_processing_ms": 0.27366150408068124, "mean_env_wait_ms": 3.4726777013343195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011866569519042969, "StateBufferConnector_ms": 0.007879257202148438, "ViewRequirementAgentConnector_ms": 0.19063901901245117}, "num_episodes": 39, "episode_return_max": -2.0584752940032933, "episode_return_min": -1363.740416398631, "episode_return_mean": -561.951011492451, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.5944796453089, "num_env_steps_trained_throughput_per_sec": 306.5944796453089, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12606.364, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12606.293, "sample_time_ms": 1175.091, "learn_time_ms": 11366.01, "learn_throughput": 351.926, "synch_weights_time_ms": 64.326}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "07142_00000", "date": "2024-08-04_10-21-42", "timestamp": 1722747102, "time_this_iter_s": 13.058321237564087, "time_total_s": 503.83569526672363, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449ad40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 503.83569526672363, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.59473684210526, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 295.10877504746117, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.96685075648129, "policy_loss": -0.010426446696995603, "vf_loss": 2.985572955136498, "vf_explained_var": 0.9938800358523925, "kl": 0.013881023517509118, "entropy": 1.766545303290089, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -2.0584752940032933, "episode_reward_min": -1455.9762929804908, "episode_reward_mean": -579.8358801552706, "episode_len_mean": 115.18, "episode_media": {}, "episodes_timesteps_total": 11518, "policy_reward_min": {"policy_0": -1455.9762929804908}, "policy_reward_max": {"policy_0": -2.0584752940032933}, "policy_reward_mean": {"policy_0": -579.8358801552706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1363.740416398631, -1097.5834412637425, -894.1624083361015, -825.3877792336341, -417.04061321077745, -1059.3739183980151, -151.60020429338584, -1124.552310369291, -77.39207800963301, -213.43789974078368, -563.9305988332645, -46.47282738726741, -1120.945731951807, -42.65165727265618, -705.0159460063633, -1163.827570754214, -637.090924420124, -221.9452369054701, -164.89382741315222, -782.507606197677, -678.9449439206613, -1157.760912104946, -1295.6662911170126, -981.4914322155867, -839.2529471920517, -396.1093976806708, -941.2395323684032, -203.0892494182191, -917.7977239359375, -773.5359339121494, -1160.2607787110405, -406.44200934059324, -226.54892274890491, -398.8754739385505, -1123.6074995428826, -23.40917697714323, -114.49222745748477, -43.21593963165351, -77.40003124469084, -1114.376182883362, -33.33461614967833, -1128.6951515147366, -2.0584752940032933, -13.536791698888122, -1187.4907024266276, -1035.5724520369345, -87.37507718890132, -502.96869617138003, -44.17642406101194, -91.40930880463036, -859.9611185006505, -291.8077829333052, -1114.290956271441, -1040.6232311720516, -302.25751995570715, -640.2764351338462, -126.17618020648396, -1030.9167363491727, -1055.542323834238, -717.9229343728791, -74.562132797411, -128.66529908808508, -219.4077067436802, -843.8570420804036, -102.14917301174958, -652.4975255568968, -336.16443289523545, -103.62959774299568, -169.45187178371796, -1231.2348868704994, -1218.6789155690526, -1455.9762929804908, -92.42051547965535, -32.380622299917604, -979.7237029215185, -542.4932595708965, -1107.8899983183926, -215.69259507381506, -409.4606708089659, -939.5490716454777, -12.625011487361046, -847.3887197207949, -201.81702884058092, -163.87155154552087, -31.423874455668226, -1170.9143747142052, -1358.8185676906928, -33.13597001626806, -195.9024547914782, -979.4529056589516, -184.50218897406253, -395.698689540472, -1168.6502711489275, -160.84064554106635, -590.78914571494, -958.1127318464384, -209.6635490340638, -49.65960940748656, -312.7299840343438, -1248.2429113103897], "episode_lengths": [150, 150, 150, 150, 140, 150, 76, 150, 52, 93, 150, 67, 150, 57, 139, 150, 150, 102, 87, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 104, 137, 150, 40, 76, 38, 56, 150, 39, 150, 41, 37, 150, 150, 79, 143, 39, 63, 150, 77, 150, 150, 108, 125, 61, 150, 150, 150, 64, 65, 100, 150, 77, 150, 135, 71, 82, 150, 150, 150, 56, 46, 150, 143, 150, 94, 128, 150, 46, 150, 84, 80, 49, 150, 150, 47, 77, 150, 104, 150, 150, 94, 150, 150, 97, 56, 79, 150], "policy_policy_0_reward": [-1363.740416398631, -1097.5834412637425, -894.1624083361015, -825.3877792336341, -417.04061321077745, -1059.3739183980151, -151.60020429338584, -1124.552310369291, -77.39207800963301, -213.43789974078368, -563.9305988332645, -46.47282738726741, -1120.945731951807, -42.65165727265618, -705.0159460063633, -1163.827570754214, -637.090924420124, -221.9452369054701, -164.89382741315222, -782.507606197677, -678.9449439206613, -1157.760912104946, -1295.6662911170126, -981.4914322155867, -839.2529471920517, -396.1093976806708, -941.2395323684032, -203.0892494182191, -917.7977239359375, -773.5359339121494, -1160.2607787110405, -406.44200934059324, -226.54892274890491, -398.8754739385505, -1123.6074995428826, -23.40917697714323, -114.49222745748477, -43.21593963165351, -77.40003124469084, -1114.376182883362, -33.33461614967833, -1128.6951515147366, -2.0584752940032933, -13.536791698888122, -1187.4907024266276, -1035.5724520369345, -87.37507718890132, -502.96869617138003, -44.17642406101194, -91.40930880463036, -859.9611185006505, -291.8077829333052, -1114.290956271441, -1040.6232311720516, -302.25751995570715, -640.2764351338462, -126.17618020648396, -1030.9167363491727, -1055.542323834238, -717.9229343728791, -74.562132797411, -128.66529908808508, -219.4077067436802, -843.8570420804036, -102.14917301174958, -652.4975255568968, -336.16443289523545, -103.62959774299568, -169.45187178371796, -1231.2348868704994, -1218.6789155690526, -1455.9762929804908, -92.42051547965535, -32.380622299917604, -979.7237029215185, -542.4932595708965, -1107.8899983183926, -215.69259507381506, -409.4606708089659, -939.5490716454777, -12.625011487361046, -847.3887197207949, -201.81702884058092, -163.87155154552087, -31.423874455668226, -1170.9143747142052, -1358.8185676906928, -33.13597001626806, -195.9024547914782, -979.4529056589516, -184.50218897406253, -395.698689540472, -1168.6502711489275, -160.84064554106635, -590.78914571494, -958.1127318464384, -209.6635490340638, -49.65960940748656, -312.7299840343438, -1248.2429113103897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527913822223849, "mean_inference_ms": 1.7132931987450752, "mean_action_processing_ms": 0.27354753311945595, "mean_env_wait_ms": 3.471198834371336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01225900650024414, "StateBufferConnector_ms": 0.00803685188293457, "ViewRequirementAgentConnector_ms": 0.19481134414672852}, "num_episodes": 35, "episode_return_max": -2.0584752940032933, "episode_return_min": -1455.9762929804908, "episode_return_mean": -579.8358801552706, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.4913810461816, "num_env_steps_trained_throughput_per_sec": 301.4913810461816, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12810.764, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12810.693, "sample_time_ms": 1154.96, "learn_time_ms": 11589.486, "learn_throughput": 345.14, "synch_weights_time_ms": 65.407}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "07142_00000", "date": "2024-08-04_10-21-55", "timestamp": 1722747115, "time_this_iter_s": 13.279903650283813, "time_total_s": 517.1155989170074, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f4e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 517.1155989170074, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.405263157894737, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 256.2329364756743, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.560247158134977, "policy_loss": -0.004235022688711372, "vf_loss": 3.566882336139679, "vf_explained_var": 0.9834258935724696, "kl": 0.01745999054749821, "entropy": 1.4185635882119338, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -2.0584752940032933, "episode_reward_min": -1455.9762929804908, "episode_reward_mean": -543.4650353436579, "episode_len_mean": 110.22, "episode_media": {}, "episodes_timesteps_total": 11022, "policy_reward_min": {"policy_0": -1455.9762929804908}, "policy_reward_max": {"policy_0": -2.0584752940032933}, "policy_reward_mean": {"policy_0": -543.4650353436579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.49222745748477, -43.21593963165351, -77.40003124469084, -1114.376182883362, -33.33461614967833, -1128.6951515147366, -2.0584752940032933, -13.536791698888122, -1187.4907024266276, -1035.5724520369345, -87.37507718890132, -502.96869617138003, -44.17642406101194, -91.40930880463036, -859.9611185006505, -291.8077829333052, -1114.290956271441, -1040.6232311720516, -302.25751995570715, -640.2764351338462, -126.17618020648396, -1030.9167363491727, -1055.542323834238, -717.9229343728791, -74.562132797411, -128.66529908808508, -219.4077067436802, -843.8570420804036, -102.14917301174958, -652.4975255568968, -336.16443289523545, -103.62959774299568, -169.45187178371796, -1231.2348868704994, -1218.6789155690526, -1455.9762929804908, -92.42051547965535, -32.380622299917604, -979.7237029215185, -542.4932595708965, -1107.8899983183926, -215.69259507381506, -409.4606708089659, -939.5490716454777, -12.625011487361046, -847.3887197207949, -201.81702884058092, -163.87155154552087, -31.423874455668226, -1170.9143747142052, -1358.8185676906928, -33.13597001626806, -195.9024547914782, -979.4529056589516, -184.50218897406253, -395.698689540472, -1168.6502711489275, -160.84064554106635, -590.78914571494, -958.1127318464384, -209.6635490340638, -49.65960940748656, -312.7299840343438, -1248.2429113103897, -6.743873781882494, -93.8551775119356, -963.0266153125747, -761.9197099904877, -55.95531420051406, -642.5615653393035, -1221.3969044048126, -322.6376997879639, -1075.2230092834557, -151.31431387169934, -236.8287245185065, -179.0867239081457, -68.7240872947194, -954.331195714368, -879.5287514932024, -1410.2429946557152, -1218.850381414055, -523.176188161232, -64.54935394408373, -164.36091244132336, -117.36742705258216, -388.62701148871184, -966.7563713084139, -100.72941173509165, -1114.7147900817358, -182.7387622561055, -1093.3939350082792, -1117.2378289687726, -230.9062420776586, -1362.830129720158, -486.00325908137165, -345.2349502384879, -356.62126891522746, -192.52329148027323, -467.94513053831156, -1042.5574333782893], "episode_lengths": [76, 38, 56, 150, 39, 150, 41, 37, 150, 150, 79, 143, 39, 63, 150, 77, 150, 150, 108, 125, 61, 150, 150, 150, 64, 65, 100, 150, 77, 150, 135, 71, 82, 150, 150, 150, 56, 46, 150, 143, 150, 94, 128, 150, 46, 150, 84, 80, 49, 150, 150, 47, 77, 150, 104, 150, 150, 94, 150, 150, 97, 56, 79, 150, 36, 57, 150, 150, 52, 150, 150, 130, 150, 79, 102, 73, 62, 150, 150, 150, 150, 150, 64, 71, 74, 150, 150, 60, 150, 86, 150, 150, 103, 150, 119, 107, 99, 74, 118, 150], "policy_policy_0_reward": [-114.49222745748477, -43.21593963165351, -77.40003124469084, -1114.376182883362, -33.33461614967833, -1128.6951515147366, -2.0584752940032933, -13.536791698888122, -1187.4907024266276, -1035.5724520369345, -87.37507718890132, -502.96869617138003, -44.17642406101194, -91.40930880463036, -859.9611185006505, -291.8077829333052, -1114.290956271441, -1040.6232311720516, -302.25751995570715, -640.2764351338462, -126.17618020648396, -1030.9167363491727, -1055.542323834238, -717.9229343728791, -74.562132797411, -128.66529908808508, -219.4077067436802, -843.8570420804036, -102.14917301174958, -652.4975255568968, -336.16443289523545, -103.62959774299568, -169.45187178371796, -1231.2348868704994, -1218.6789155690526, -1455.9762929804908, -92.42051547965535, -32.380622299917604, -979.7237029215185, -542.4932595708965, -1107.8899983183926, -215.69259507381506, -409.4606708089659, -939.5490716454777, -12.625011487361046, -847.3887197207949, -201.81702884058092, -163.87155154552087, -31.423874455668226, -1170.9143747142052, -1358.8185676906928, -33.13597001626806, -195.9024547914782, -979.4529056589516, -184.50218897406253, -395.698689540472, -1168.6502711489275, -160.84064554106635, -590.78914571494, -958.1127318464384, -209.6635490340638, -49.65960940748656, -312.7299840343438, -1248.2429113103897, -6.743873781882494, -93.8551775119356, -963.0266153125747, -761.9197099904877, -55.95531420051406, -642.5615653393035, -1221.3969044048126, -322.6376997879639, -1075.2230092834557, -151.31431387169934, -236.8287245185065, -179.0867239081457, -68.7240872947194, -954.331195714368, -879.5287514932024, -1410.2429946557152, -1218.850381414055, -523.176188161232, -64.54935394408373, -164.36091244132336, -117.36742705258216, -388.62701148871184, -966.7563713084139, -100.72941173509165, -1114.7147900817358, -182.7387622561055, -1093.3939350082792, -1117.2378289687726, -230.9062420776586, -1362.830129720158, -486.00325908137165, -345.2349502384879, -356.62126891522746, -192.52329148027323, -467.94513053831156, -1042.5574333782893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525876341845559, "mean_inference_ms": 1.712076115812807, "mean_action_processing_ms": 0.27353505147371093, "mean_env_wait_ms": 3.4715196081316724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012676715850830078, "StateBufferConnector_ms": 0.00813603401184082, "ViewRequirementAgentConnector_ms": 0.19638562202453613}, "num_episodes": 36, "episode_return_max": -2.0584752940032933, "episode_return_min": -1455.9762929804908, "episode_return_mean": -543.4650353436579, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.77431264527814, "num_env_steps_trained_throughput_per_sec": 309.77431264527814, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12795.993, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12795.923, "sample_time_ms": 1149.489, "learn_time_ms": 11580.238, "learn_throughput": 345.416, "synch_weights_time_ms": 65.364}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "07142_00000", "date": "2024-08-04_10-22-08", "timestamp": 1722747128, "time_this_iter_s": 12.9252347946167, "time_total_s": 530.0408337116241, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f4d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 530.0408337116241, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.72222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 218.83787844777106, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.2635518734653792, "policy_loss": -0.007708886428251086, "vf_loss": 3.2762986795355875, "vf_explained_var": 0.9896633114044865, "kl": 0.013271596962734637, "entropy": 1.3996256787950794, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -6.743873781882494, "episode_reward_min": -1410.2429946557152, "episode_reward_mean": -547.7694832171378, "episode_len_mean": 113.18, "episode_media": {}, "episodes_timesteps_total": 11318, "policy_reward_min": {"policy_0": -1410.2429946557152}, "policy_reward_max": {"policy_0": -6.743873781882494}, "policy_reward_mean": {"policy_0": -547.7694832171378}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-542.4932595708965, -1107.8899983183926, -215.69259507381506, -409.4606708089659, -939.5490716454777, -12.625011487361046, -847.3887197207949, -201.81702884058092, -163.87155154552087, -31.423874455668226, -1170.9143747142052, -1358.8185676906928, -33.13597001626806, -195.9024547914782, -979.4529056589516, -184.50218897406253, -395.698689540472, -1168.6502711489275, -160.84064554106635, -590.78914571494, -958.1127318464384, -209.6635490340638, -49.65960940748656, -312.7299840343438, -1248.2429113103897, -6.743873781882494, -93.8551775119356, -963.0266153125747, -761.9197099904877, -55.95531420051406, -642.5615653393035, -1221.3969044048126, -322.6376997879639, -1075.2230092834557, -151.31431387169934, -236.8287245185065, -179.0867239081457, -68.7240872947194, -954.331195714368, -879.5287514932024, -1410.2429946557152, -1218.850381414055, -523.176188161232, -64.54935394408373, -164.36091244132336, -117.36742705258216, -388.62701148871184, -966.7563713084139, -100.72941173509165, -1114.7147900817358, -182.7387622561055, -1093.3939350082792, -1117.2378289687726, -230.9062420776586, -1362.830129720158, -486.00325908137165, -345.2349502384879, -356.62126891522746, -192.52329148027323, -467.94513053831156, -1042.5574333782893, -1021.6680555175972, -23.691121117946373, -28.237615025392714, -462.2969880900662, -52.63632216563229, -71.40996299720922, -443.23558045450073, -247.57208562154946, -352.89054012298936, -1100.5993926442534, -1172.909413034411, -1079.5245571169007, -780.7515567687996, -50.346967469401555, -757.4074898732283, -1288.1223508388443, -126.77006371863007, -375.6583400780917, -1108.5903406815385, -809.0029241648847, -205.42998516446403, -1199.5618956678593, -428.2042776843196, -313.8266466747488, -417.0763610849804, -152.0703207110673, -207.57860391343718, -101.55179657544687, -176.887590259754, -41.035272145739384, -856.2390008886323, -67.41728327096021, -750.5372283733924, -1255.0636425345958, -1129.4395100036913, -205.06644501134886, -1118.2675912795796, -665.2072836294622, -83.33939808771191], "episode_lengths": [143, 150, 94, 128, 150, 46, 150, 84, 80, 49, 150, 150, 47, 77, 150, 104, 150, 150, 94, 150, 150, 97, 56, 79, 150, 36, 57, 150, 150, 52, 150, 150, 130, 150, 79, 102, 73, 62, 150, 150, 150, 150, 150, 64, 71, 74, 150, 150, 60, 150, 86, 150, 150, 103, 150, 119, 107, 99, 74, 118, 150, 150, 47, 34, 150, 53, 71, 141, 103, 105, 150, 150, 150, 150, 44, 150, 150, 75, 98, 150, 146, 96, 150, 134, 81, 143, 86, 92, 63, 82, 54, 150, 68, 150, 150, 150, 95, 150, 150, 63], "policy_policy_0_reward": [-542.4932595708965, -1107.8899983183926, -215.69259507381506, -409.4606708089659, -939.5490716454777, -12.625011487361046, -847.3887197207949, -201.81702884058092, -163.87155154552087, -31.423874455668226, -1170.9143747142052, -1358.8185676906928, -33.13597001626806, -195.9024547914782, -979.4529056589516, -184.50218897406253, -395.698689540472, -1168.6502711489275, -160.84064554106635, -590.78914571494, -958.1127318464384, -209.6635490340638, -49.65960940748656, -312.7299840343438, -1248.2429113103897, -6.743873781882494, -93.8551775119356, -963.0266153125747, -761.9197099904877, -55.95531420051406, -642.5615653393035, -1221.3969044048126, -322.6376997879639, -1075.2230092834557, -151.31431387169934, -236.8287245185065, -179.0867239081457, -68.7240872947194, -954.331195714368, -879.5287514932024, -1410.2429946557152, -1218.850381414055, -523.176188161232, -64.54935394408373, -164.36091244132336, -117.36742705258216, -388.62701148871184, -966.7563713084139, -100.72941173509165, -1114.7147900817358, -182.7387622561055, -1093.3939350082792, -1117.2378289687726, -230.9062420776586, -1362.830129720158, -486.00325908137165, -345.2349502384879, -356.62126891522746, -192.52329148027323, -467.94513053831156, -1042.5574333782893, -1021.6680555175972, -23.691121117946373, -28.237615025392714, -462.2969880900662, -52.63632216563229, -71.40996299720922, -443.23558045450073, -247.57208562154946, -352.89054012298936, -1100.5993926442534, -1172.909413034411, -1079.5245571169007, -780.7515567687996, -50.346967469401555, -757.4074898732283, -1288.1223508388443, -126.77006371863007, -375.6583400780917, -1108.5903406815385, -809.0029241648847, -205.42998516446403, -1199.5618956678593, -428.2042776843196, -313.8266466747488, -417.0763610849804, -152.0703207110673, -207.57860391343718, -101.55179657544687, -176.887590259754, -41.035272145739384, -856.2390008886323, -67.41728327096021, -750.5372283733924, -1255.0636425345958, -1129.4395100036913, -205.06644501134886, -1118.2675912795796, -665.2072836294622, -83.33939808771191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525868240158084, "mean_inference_ms": 1.7104955048794852, "mean_action_processing_ms": 0.27362889558311043, "mean_env_wait_ms": 3.4728176909470894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012871503829956055, "StateBufferConnector_ms": 0.008074760437011719, "ViewRequirementAgentConnector_ms": 0.20331048965454102}, "num_episodes": 39, "episode_return_max": -6.743873781882494, "episode_return_min": -1410.2429946557152, "episode_return_mean": -547.7694832171378, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.89545020362186, "num_env_steps_trained_throughput_per_sec": 307.89545020362186, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12827.737, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12827.671, "sample_time_ms": 1158.604, "learn_time_ms": 11603.87, "learn_throughput": 344.713, "synch_weights_time_ms": 64.402}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "07142_00000", "date": "2024-08-04_10-22-21", "timestamp": 1722747141, "time_this_iter_s": 13.004116773605347, "time_total_s": 543.0449504852295, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f4c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 543.0449504852295, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.48421052631579, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 281.80961873928703, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7589062536756197, "policy_loss": -0.011784831432548042, "vf_loss": 3.7736979944010574, "vf_explained_var": 0.9876297338555257, "kl": 0.013488389600388524, "entropy": 1.2111578756943344, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -8.930531365598116, "episode_reward_min": -1410.2429946557152, "episode_reward_mean": -524.1443748359161, "episode_len_mean": 111.86, "episode_media": {}, "episodes_timesteps_total": 11186, "policy_reward_min": {"policy_0": -1410.2429946557152}, "policy_reward_max": {"policy_0": -8.930531365598116}, "policy_reward_mean": {"policy_0": -524.1443748359161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1075.2230092834557, -151.31431387169934, -236.8287245185065, -179.0867239081457, -68.7240872947194, -954.331195714368, -879.5287514932024, -1410.2429946557152, -1218.850381414055, -523.176188161232, -64.54935394408373, -164.36091244132336, -117.36742705258216, -388.62701148871184, -966.7563713084139, -100.72941173509165, -1114.7147900817358, -182.7387622561055, -1093.3939350082792, -1117.2378289687726, -230.9062420776586, -1362.830129720158, -486.00325908137165, -345.2349502384879, -356.62126891522746, -192.52329148027323, -467.94513053831156, -1042.5574333782893, -1021.6680555175972, -23.691121117946373, -28.237615025392714, -462.2969880900662, -52.63632216563229, -71.40996299720922, -443.23558045450073, -247.57208562154946, -352.89054012298936, -1100.5993926442534, -1172.909413034411, -1079.5245571169007, -780.7515567687996, -50.346967469401555, -757.4074898732283, -1288.1223508388443, -126.77006371863007, -375.6583400780917, -1108.5903406815385, -809.0029241648847, -205.42998516446403, -1199.5618956678593, -428.2042776843196, -313.8266466747488, -417.0763610849804, -152.0703207110673, -207.57860391343718, -101.55179657544687, -176.887590259754, -41.035272145739384, -856.2390008886323, -67.41728327096021, -750.5372283733924, -1255.0636425345958, -1129.4395100036913, -205.06644501134886, -1118.2675912795796, -665.2072836294622, -83.33939808771191, -1036.710990581995, -48.00179395824738, -168.40215109632868, -1105.429348406848, -712.830732289001, -252.27844829396477, -1030.8463024290327, -1066.9028544117261, -20.334379222782413, -278.63802385265194, -543.3855718990714, -1016.0356625352038, -993.3902176687529, -58.636848282609165, -127.70032897016395, -204.8410912660799, -19.801205752388594, -112.84411533941383, -444.5814863735214, -650.5706771788781, -701.3537089103856, -149.0927411443575, -205.49148177163278, -57.159521293799045, -8.930531365598116, -191.53161960939812, -328.5913883885215, -1103.6412183082268, -494.3324467098917, -776.5631750173851, -854.2281858445426, -348.2260908368497, -83.60746408933441], "episode_lengths": [150, 79, 102, 73, 62, 150, 150, 150, 150, 150, 64, 71, 74, 150, 150, 60, 150, 86, 150, 150, 103, 150, 119, 107, 99, 74, 118, 150, 150, 47, 34, 150, 53, 71, 141, 103, 105, 150, 150, 150, 150, 44, 150, 150, 75, 98, 150, 146, 96, 150, 134, 81, 143, 86, 92, 63, 82, 54, 150, 68, 150, 150, 150, 95, 150, 150, 63, 150, 49, 96, 150, 150, 109, 150, 150, 43, 108, 146, 150, 150, 48, 54, 76, 43, 74, 126, 150, 150, 84, 63, 60, 40, 89, 126, 150, 150, 150, 150, 132, 55], "policy_policy_0_reward": [-1075.2230092834557, -151.31431387169934, -236.8287245185065, -179.0867239081457, -68.7240872947194, -954.331195714368, -879.5287514932024, -1410.2429946557152, -1218.850381414055, -523.176188161232, -64.54935394408373, -164.36091244132336, -117.36742705258216, -388.62701148871184, -966.7563713084139, -100.72941173509165, -1114.7147900817358, -182.7387622561055, -1093.3939350082792, -1117.2378289687726, -230.9062420776586, -1362.830129720158, -486.00325908137165, -345.2349502384879, -356.62126891522746, -192.52329148027323, -467.94513053831156, -1042.5574333782893, -1021.6680555175972, -23.691121117946373, -28.237615025392714, -462.2969880900662, -52.63632216563229, -71.40996299720922, -443.23558045450073, -247.57208562154946, -352.89054012298936, -1100.5993926442534, -1172.909413034411, -1079.5245571169007, -780.7515567687996, -50.346967469401555, -757.4074898732283, -1288.1223508388443, -126.77006371863007, -375.6583400780917, -1108.5903406815385, -809.0029241648847, -205.42998516446403, -1199.5618956678593, -428.2042776843196, -313.8266466747488, -417.0763610849804, -152.0703207110673, -207.57860391343718, -101.55179657544687, -176.887590259754, -41.035272145739384, -856.2390008886323, -67.41728327096021, -750.5372283733924, -1255.0636425345958, -1129.4395100036913, -205.06644501134886, -1118.2675912795796, -665.2072836294622, -83.33939808771191, -1036.710990581995, -48.00179395824738, -168.40215109632868, -1105.429348406848, -712.830732289001, -252.27844829396477, -1030.8463024290327, -1066.9028544117261, -20.334379222782413, -278.63802385265194, -543.3855718990714, -1016.0356625352038, -993.3902176687529, -58.636848282609165, -127.70032897016395, -204.8410912660799, -19.801205752388594, -112.84411533941383, -444.5814863735214, -650.5706771788781, -701.3537089103856, -149.0927411443575, -205.49148177163278, -57.159521293799045, -8.930531365598116, -191.53161960939812, -328.5913883885215, -1103.6412183082268, -494.3324467098917, -776.5631750173851, -854.2281858445426, -348.2260908368497, -83.60746408933441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527196590951591, "mean_inference_ms": 1.709631448236577, "mean_action_processing_ms": 0.2734587303929221, "mean_env_wait_ms": 3.472151326371095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012375831604003906, "StateBufferConnector_ms": 0.008009672164916992, "ViewRequirementAgentConnector_ms": 0.20123863220214844}, "num_episodes": 33, "episode_return_max": -8.930531365598116, "episode_return_min": -1410.2429946557152, "episode_return_mean": -524.1443748359161, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.23706947259114, "num_env_steps_trained_throughput_per_sec": 307.23706947259114, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12818.237, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12818.173, "sample_time_ms": 1152.285, "learn_time_ms": 11602.456, "learn_throughput": 344.755, "synch_weights_time_ms": 62.646}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "07142_00000", "date": "2024-08-04_10-22-34", "timestamp": 1722747154, "time_this_iter_s": 13.033412218093872, "time_total_s": 556.0783627033234, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f4310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 556.0783627033234, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.599999999999998, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 272.2885465999444, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.2539646100252866, "policy_loss": -0.013992481193660448, "vf_loss": 3.273059460769097, "vf_explained_var": 0.9913413986563683, "kl": 0.013600645400098728, "entropy": 1.4282812184343736, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -8.930531365598116, "episode_reward_min": -1288.1223508388443, "episode_reward_mean": -504.61510922054833, "episode_len_mean": 111.92, "episode_media": {}, "episodes_timesteps_total": 11192, "policy_reward_min": {"policy_0": -1288.1223508388443}, "policy_reward_max": {"policy_0": -8.930531365598116}, "policy_reward_mean": {"policy_0": -504.61510922054833}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1100.5993926442534, -1172.909413034411, -1079.5245571169007, -780.7515567687996, -50.346967469401555, -757.4074898732283, -1288.1223508388443, -126.77006371863007, -375.6583400780917, -1108.5903406815385, -809.0029241648847, -205.42998516446403, -1199.5618956678593, -428.2042776843196, -313.8266466747488, -417.0763610849804, -152.0703207110673, -207.57860391343718, -101.55179657544687, -176.887590259754, -41.035272145739384, -856.2390008886323, -67.41728327096021, -750.5372283733924, -1255.0636425345958, -1129.4395100036913, -205.06644501134886, -1118.2675912795796, -665.2072836294622, -83.33939808771191, -1036.710990581995, -48.00179395824738, -168.40215109632868, -1105.429348406848, -712.830732289001, -252.27844829396477, -1030.8463024290327, -1066.9028544117261, -20.334379222782413, -278.63802385265194, -543.3855718990714, -1016.0356625352038, -993.3902176687529, -58.636848282609165, -127.70032897016395, -204.8410912660799, -19.801205752388594, -112.84411533941383, -444.5814863735214, -650.5706771788781, -701.3537089103856, -149.0927411443575, -205.49148177163278, -57.159521293799045, -8.930531365598116, -191.53161960939812, -328.5913883885215, -1103.6412183082268, -494.3324467098917, -776.5631750173851, -854.2281858445426, -348.2260908368497, -83.60746408933441, -34.683283631321636, -385.3903997373263, -827.6882068629803, -8.951630270656732, -555.6758967334299, -128.9958585375545, -115.50462855074242, -976.7134785432369, -1179.2190271388704, -345.8838326330688, -268.65492512430586, -758.0385208728579, -288.3858831965282, -178.99505975993563, -123.78976330571247, -536.2695289446422, -929.6826551903995, -521.4923063593523, -925.0839429034673, -38.6675964566652, -85.8028405921608, -1191.7461835616082, -235.27339013152715, -110.81996341392006, -132.72884053704644, -245.2653467468184, -874.6188801115574, -1222.2839362383077, -306.9481883868757, -180.03025293897377, -20.619848318198017, -1073.079281256788, -363.07315001088955, -974.8355151166807, -310.3889558548335, -123.50362796643115, -664.3309636703901], "episode_lengths": [150, 150, 150, 150, 44, 150, 150, 75, 98, 150, 146, 96, 150, 134, 81, 143, 86, 92, 63, 82, 54, 150, 68, 150, 150, 150, 95, 150, 150, 63, 150, 49, 96, 150, 150, 109, 150, 150, 43, 108, 146, 150, 150, 48, 54, 76, 43, 74, 126, 150, 150, 84, 63, 60, 40, 89, 126, 150, 150, 150, 150, 132, 55, 41, 119, 150, 39, 150, 78, 73, 150, 150, 123, 93, 150, 116, 87, 78, 150, 150, 150, 150, 52, 71, 150, 102, 65, 69, 80, 150, 150, 131, 104, 36, 150, 148, 150, 82, 64, 150], "policy_policy_0_reward": [-1100.5993926442534, -1172.909413034411, -1079.5245571169007, -780.7515567687996, -50.346967469401555, -757.4074898732283, -1288.1223508388443, -126.77006371863007, -375.6583400780917, -1108.5903406815385, -809.0029241648847, -205.42998516446403, -1199.5618956678593, -428.2042776843196, -313.8266466747488, -417.0763610849804, -152.0703207110673, -207.57860391343718, -101.55179657544687, -176.887590259754, -41.035272145739384, -856.2390008886323, -67.41728327096021, -750.5372283733924, -1255.0636425345958, -1129.4395100036913, -205.06644501134886, -1118.2675912795796, -665.2072836294622, -83.33939808771191, -1036.710990581995, -48.00179395824738, -168.40215109632868, -1105.429348406848, -712.830732289001, -252.27844829396477, -1030.8463024290327, -1066.9028544117261, -20.334379222782413, -278.63802385265194, -543.3855718990714, -1016.0356625352038, -993.3902176687529, -58.636848282609165, -127.70032897016395, -204.8410912660799, -19.801205752388594, -112.84411533941383, -444.5814863735214, -650.5706771788781, -701.3537089103856, -149.0927411443575, -205.49148177163278, -57.159521293799045, -8.930531365598116, -191.53161960939812, -328.5913883885215, -1103.6412183082268, -494.3324467098917, -776.5631750173851, -854.2281858445426, -348.2260908368497, -83.60746408933441, -34.683283631321636, -385.3903997373263, -827.6882068629803, -8.951630270656732, -555.6758967334299, -128.9958585375545, -115.50462855074242, -976.7134785432369, -1179.2190271388704, -345.8838326330688, -268.65492512430586, -758.0385208728579, -288.3858831965282, -178.99505975993563, -123.78976330571247, -536.2695289446422, -929.6826551903995, -521.4923063593523, -925.0839429034673, -38.6675964566652, -85.8028405921608, -1191.7461835616082, -235.27339013152715, -110.81996341392006, -132.72884053704644, -245.2653467468184, -874.6188801115574, -1222.2839362383077, -306.9481883868757, -180.03025293897377, -20.619848318198017, -1073.079281256788, -363.07315001088955, -974.8355151166807, -310.3889558548335, -123.50362796643115, -664.3309636703901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529386100131848, "mean_inference_ms": 1.7085977268981032, "mean_action_processing_ms": 0.27337088602114923, "mean_env_wait_ms": 3.469815884730556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012727975845336914, "StateBufferConnector_ms": 0.008104085922241211, "ViewRequirementAgentConnector_ms": 0.20490431785583496}, "num_episodes": 37, "episode_return_max": -8.930531365598116, "episode_return_min": -1288.1223508388443, "episode_return_mean": -504.61510922054833, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.04857568064097, "num_env_steps_trained_throughput_per_sec": 308.04857568064097, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12811.959, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12811.893, "sample_time_ms": 1149.247, "learn_time_ms": 11600.666, "learn_throughput": 344.808, "synch_weights_time_ms": 61.193}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "07142_00000", "date": "2024-08-04_10-22-47", "timestamp": 1722747167, "time_this_iter_s": 12.998040199279785, "time_total_s": 569.0764029026031, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244981f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 569.0764029026031, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.52105263157895, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 230.09897537827493, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.4576865293085577, "policy_loss": -0.011133564217501165, "vf_loss": 3.4721722955505054, "vf_explained_var": 0.9923294603203734, "kl": 0.014111666382026064, "entropy": 1.2877565569554765, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -8.930531365598116, "episode_reward_min": -1296.8543157513118, "episode_reward_mean": -469.26650768676836, "episode_len_mean": 109.92, "episode_media": {}, "episodes_timesteps_total": 10992, "policy_reward_min": {"policy_0": -1296.8543157513118}, "policy_reward_max": {"policy_0": -8.930531365598116}, "policy_reward_mean": {"policy_0": -469.26650768676836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1066.9028544117261, -20.334379222782413, -278.63802385265194, -543.3855718990714, -1016.0356625352038, -993.3902176687529, -58.636848282609165, -127.70032897016395, -204.8410912660799, -19.801205752388594, -112.84411533941383, -444.5814863735214, -650.5706771788781, -701.3537089103856, -149.0927411443575, -205.49148177163278, -57.159521293799045, -8.930531365598116, -191.53161960939812, -328.5913883885215, -1103.6412183082268, -494.3324467098917, -776.5631750173851, -854.2281858445426, -348.2260908368497, -83.60746408933441, -34.683283631321636, -385.3903997373263, -827.6882068629803, -8.951630270656732, -555.6758967334299, -128.9958585375545, -115.50462855074242, -976.7134785432369, -1179.2190271388704, -345.8838326330688, -268.65492512430586, -758.0385208728579, -288.3858831965282, -178.99505975993563, -123.78976330571247, -536.2695289446422, -929.6826551903995, -521.4923063593523, -925.0839429034673, -38.6675964566652, -85.8028405921608, -1191.7461835616082, -235.27339013152715, -110.81996341392006, -132.72884053704644, -245.2653467468184, -874.6188801115574, -1222.2839362383077, -306.9481883868757, -180.03025293897377, -20.619848318198017, -1073.079281256788, -363.07315001088955, -974.8355151166807, -310.3889558548335, -123.50362796643115, -664.3309636703901, -1296.8543157513118, -1118.4978908466483, -124.48874254868082, -162.42456010504654, -1105.8959318556335, -17.23953324334748, -83.26675956373849, -281.3986882157124, -72.13941804606269, -716.0753194739557, -830.720708552095, -356.568500144832, -1224.9368346099834, -678.5337982386652, -706.4372032232827, -954.3992984893431, -391.42096813448507, -200.423384293604, -9.120351686242678, -579.1099446851067, -1052.967413502314, -1079.0377116921377, -820.5154027221795, -713.5261471202709, -165.45474720406762, -499.993456040729, -102.48045595194566, -90.75614406490337, -218.2870889794981, -749.5991791154468, -129.16774320558306, -211.2989200676044, -100.35750725560368, -196.93453005493103, -246.97318850422806, -1288.396863528743, -267.4244923096414], "episode_lengths": [150, 43, 108, 146, 150, 150, 48, 54, 76, 43, 74, 126, 150, 150, 84, 63, 60, 40, 89, 126, 150, 150, 150, 150, 132, 55, 41, 119, 150, 39, 150, 78, 73, 150, 150, 123, 93, 150, 116, 87, 78, 150, 150, 150, 150, 52, 71, 150, 102, 65, 69, 80, 150, 150, 131, 104, 36, 150, 148, 150, 82, 64, 150, 150, 150, 76, 87, 150, 39, 63, 104, 64, 150, 150, 150, 150, 150, 150, 150, 108, 85, 35, 141, 150, 150, 150, 150, 92, 130, 77, 61, 90, 150, 77, 91, 62, 94, 104, 150, 94], "policy_policy_0_reward": [-1066.9028544117261, -20.334379222782413, -278.63802385265194, -543.3855718990714, -1016.0356625352038, -993.3902176687529, -58.636848282609165, -127.70032897016395, -204.8410912660799, -19.801205752388594, -112.84411533941383, -444.5814863735214, -650.5706771788781, -701.3537089103856, -149.0927411443575, -205.49148177163278, -57.159521293799045, -8.930531365598116, -191.53161960939812, -328.5913883885215, -1103.6412183082268, -494.3324467098917, -776.5631750173851, -854.2281858445426, -348.2260908368497, -83.60746408933441, -34.683283631321636, -385.3903997373263, -827.6882068629803, -8.951630270656732, -555.6758967334299, -128.9958585375545, -115.50462855074242, -976.7134785432369, -1179.2190271388704, -345.8838326330688, -268.65492512430586, -758.0385208728579, -288.3858831965282, -178.99505975993563, -123.78976330571247, -536.2695289446422, -929.6826551903995, -521.4923063593523, -925.0839429034673, -38.6675964566652, -85.8028405921608, -1191.7461835616082, -235.27339013152715, -110.81996341392006, -132.72884053704644, -245.2653467468184, -874.6188801115574, -1222.2839362383077, -306.9481883868757, -180.03025293897377, -20.619848318198017, -1073.079281256788, -363.07315001088955, -974.8355151166807, -310.3889558548335, -123.50362796643115, -664.3309636703901, -1296.8543157513118, -1118.4978908466483, -124.48874254868082, -162.42456010504654, -1105.8959318556335, -17.23953324334748, -83.26675956373849, -281.3986882157124, -72.13941804606269, -716.0753194739557, -830.720708552095, -356.568500144832, -1224.9368346099834, -678.5337982386652, -706.4372032232827, -954.3992984893431, -391.42096813448507, -200.423384293604, -9.120351686242678, -579.1099446851067, -1052.967413502314, -1079.0377116921377, -820.5154027221795, -713.5261471202709, -165.45474720406762, -499.993456040729, -102.48045595194566, -90.75614406490337, -218.2870889794981, -749.5991791154468, -129.16774320558306, -211.2989200676044, -100.35750725560368, -196.93453005493103, -246.97318850422806, -1288.396863528743, -267.4244923096414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527236189401902, "mean_inference_ms": 1.7088742271992963, "mean_action_processing_ms": 0.2735084905472822, "mean_env_wait_ms": 3.4709740918332193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012476444244384766, "StateBufferConnector_ms": 0.008037328720092773, "ViewRequirementAgentConnector_ms": 0.19940519332885742}, "num_episodes": 37, "episode_return_max": -8.930531365598116, "episode_return_min": -1296.8543157513118, "episode_return_mean": -469.26650768676836, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.575167614081, "num_env_steps_trained_throughput_per_sec": 316.575167614081, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12815.514, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12815.448, "sample_time_ms": 1147.536, "learn_time_ms": 11607.747, "learn_throughput": 344.597, "synch_weights_time_ms": 59.392}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "07142_00000", "date": "2024-08-04_10-23-00", "timestamp": 1722747180, "time_this_iter_s": 12.647229194641113, "time_total_s": 581.7236320972443, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244995a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 581.7236320972443, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.572222222222223, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.250521504879, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.661366093655427, "policy_loss": -0.010837706847814843, "vf_loss": 3.6744573168456554, "vf_explained_var": 0.9846501755838593, "kl": 0.014676293095605312, "entropy": 1.216000892780721, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -2.0677739381680325, "episode_reward_min": -1417.562735232634, "episode_reward_mean": -501.64785180107, "episode_len_mean": 112.54, "episode_media": {}, "episodes_timesteps_total": 11254, "policy_reward_min": {"policy_0": -1417.562735232634}, "policy_reward_max": {"policy_0": -2.0677739381680325}, "policy_reward_mean": {"policy_0": -501.64785180107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1179.2190271388704, -345.8838326330688, -268.65492512430586, -758.0385208728579, -288.3858831965282, -178.99505975993563, -123.78976330571247, -536.2695289446422, -929.6826551903995, -521.4923063593523, -925.0839429034673, -38.6675964566652, -85.8028405921608, -1191.7461835616082, -235.27339013152715, -110.81996341392006, -132.72884053704644, -245.2653467468184, -874.6188801115574, -1222.2839362383077, -306.9481883868757, -180.03025293897377, -20.619848318198017, -1073.079281256788, -363.07315001088955, -974.8355151166807, -310.3889558548335, -123.50362796643115, -664.3309636703901, -1296.8543157513118, -1118.4978908466483, -124.48874254868082, -162.42456010504654, -1105.8959318556335, -17.23953324334748, -83.26675956373849, -281.3986882157124, -72.13941804606269, -716.0753194739557, -830.720708552095, -356.568500144832, -1224.9368346099834, -678.5337982386652, -706.4372032232827, -954.3992984893431, -391.42096813448507, -200.423384293604, -9.120351686242678, -579.1099446851067, -1052.967413502314, -1079.0377116921377, -820.5154027221795, -713.5261471202709, -165.45474720406762, -499.993456040729, -102.48045595194566, -90.75614406490337, -218.2870889794981, -749.5991791154468, -129.16774320558306, -211.2989200676044, -100.35750725560368, -196.93453005493103, -246.97318850422806, -1288.396863528743, -267.4244923096414, -131.39453933320786, -1308.2325721441343, -849.4609851955836, -1320.3246989717036, -756.1276981942731, -833.8863196136008, -401.57992833146903, -1291.6201569803466, -227.06413427222984, -667.87462955952, -7.218168684980547, -1127.5188873906702, -16.95991795921211, -153.32316366417916, -64.23029657470018, -648.7222381874927, -985.7759708449939, -308.09100326556353, -1417.562735232634, -431.11361648033716, -523.5674128607834, -235.37958134348543, -72.35640876284826, -753.8142503971865, -198.8355128561818, -62.68355460057737, -368.0437936217645, -551.841685814439, -512.7973357316574, -121.44511170585862, -2.0677739381680325, -223.16744152078334, -438.0125557015008, -100.05575060452082], "episode_lengths": [150, 123, 93, 150, 116, 87, 78, 150, 150, 150, 150, 52, 71, 150, 102, 65, 69, 80, 150, 150, 131, 104, 36, 150, 148, 150, 82, 64, 150, 150, 150, 76, 87, 150, 39, 63, 104, 64, 150, 150, 150, 150, 150, 150, 150, 108, 85, 35, 141, 150, 150, 150, 150, 92, 130, 77, 61, 90, 150, 77, 91, 62, 94, 104, 150, 94, 78, 150, 150, 150, 150, 150, 132, 150, 85, 150, 36, 150, 39, 79, 62, 150, 150, 122, 150, 149, 136, 73, 64, 150, 67, 63, 99, 150, 150, 76, 35, 83, 150, 51], "policy_policy_0_reward": [-1179.2190271388704, -345.8838326330688, -268.65492512430586, -758.0385208728579, -288.3858831965282, -178.99505975993563, -123.78976330571247, -536.2695289446422, -929.6826551903995, -521.4923063593523, -925.0839429034673, -38.6675964566652, -85.8028405921608, -1191.7461835616082, -235.27339013152715, -110.81996341392006, -132.72884053704644, -245.2653467468184, -874.6188801115574, -1222.2839362383077, -306.9481883868757, -180.03025293897377, -20.619848318198017, -1073.079281256788, -363.07315001088955, -974.8355151166807, -310.3889558548335, -123.50362796643115, -664.3309636703901, -1296.8543157513118, -1118.4978908466483, -124.48874254868082, -162.42456010504654, -1105.8959318556335, -17.23953324334748, -83.26675956373849, -281.3986882157124, -72.13941804606269, -716.0753194739557, -830.720708552095, -356.568500144832, -1224.9368346099834, -678.5337982386652, -706.4372032232827, -954.3992984893431, -391.42096813448507, -200.423384293604, -9.120351686242678, -579.1099446851067, -1052.967413502314, -1079.0377116921377, -820.5154027221795, -713.5261471202709, -165.45474720406762, -499.993456040729, -102.48045595194566, -90.75614406490337, -218.2870889794981, -749.5991791154468, -129.16774320558306, -211.2989200676044, -100.35750725560368, -196.93453005493103, -246.97318850422806, -1288.396863528743, -267.4244923096414, -131.39453933320786, -1308.2325721441343, -849.4609851955836, -1320.3246989717036, -756.1276981942731, -833.8863196136008, -401.57992833146903, -1291.6201569803466, -227.06413427222984, -667.87462955952, -7.218168684980547, -1127.5188873906702, -16.95991795921211, -153.32316366417916, -64.23029657470018, -648.7222381874927, -985.7759708449939, -308.09100326556353, -1417.562735232634, -431.11361648033716, -523.5674128607834, -235.37958134348543, -72.35640876284826, -753.8142503971865, -198.8355128561818, -62.68355460057737, -368.0437936217645, -551.841685814439, -512.7973357316574, -121.44511170585862, -2.0677739381680325, -223.16744152078334, -438.0125557015008, -100.05575060452082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528614787730206, "mean_inference_ms": 1.7075897925896206, "mean_action_processing_ms": 0.2736916450476583, "mean_env_wait_ms": 3.4727217791522156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012342214584350586, "StateBufferConnector_ms": 0.007926464080810547, "ViewRequirementAgentConnector_ms": 0.19739699363708496}, "num_episodes": 34, "episode_return_max": -2.0677739381680325, "episode_return_min": -1417.562735232634, "episode_return_mean": -501.64785180107, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.9712673428938, "num_env_steps_trained_throughput_per_sec": 312.9712673428938, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 13007.793, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13007.727, "sample_time_ms": 1130.266, "learn_time_ms": 11814.175, "learn_throughput": 338.576, "synch_weights_time_ms": 62.512}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "07142_00000", "date": "2024-08-04_10-23-13", "timestamp": 1722747193, "time_this_iter_s": 12.792848110198975, "time_total_s": 594.5164802074432, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 594.5164802074432, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.394444444444442, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 294.4142555236816, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.319701328749458, "policy_loss": -0.014407005384661413, "vf_loss": 3.3384095005691052, "vf_explained_var": 0.9927306940158208, "kl": 0.014425645547028932, "entropy": 1.4038478242233396, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -2.0677739381680325, "episode_reward_min": -1417.562735232634, "episode_reward_mean": -508.59160126370523, "episode_len_mean": 112.41, "episode_media": {}, "episodes_timesteps_total": 11241, "policy_reward_min": {"policy_0": -1417.562735232634}, "policy_reward_max": {"policy_0": -2.0677739381680325}, "policy_reward_mean": {"policy_0": -508.59160126370523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-830.720708552095, -356.568500144832, -1224.9368346099834, -678.5337982386652, -706.4372032232827, -954.3992984893431, -391.42096813448507, -200.423384293604, -9.120351686242678, -579.1099446851067, -1052.967413502314, -1079.0377116921377, -820.5154027221795, -713.5261471202709, -165.45474720406762, -499.993456040729, -102.48045595194566, -90.75614406490337, -218.2870889794981, -749.5991791154468, -129.16774320558306, -211.2989200676044, -100.35750725560368, -196.93453005493103, -246.97318850422806, -1288.396863528743, -267.4244923096414, -131.39453933320786, -1308.2325721441343, -849.4609851955836, -1320.3246989717036, -756.1276981942731, -833.8863196136008, -401.57992833146903, -1291.6201569803466, -227.06413427222984, -667.87462955952, -7.218168684980547, -1127.5188873906702, -16.95991795921211, -153.32316366417916, -64.23029657470018, -648.7222381874927, -985.7759708449939, -308.09100326556353, -1417.562735232634, -431.11361648033716, -523.5674128607834, -235.37958134348543, -72.35640876284826, -753.8142503971865, -198.8355128561818, -62.68355460057737, -368.0437936217645, -551.841685814439, -512.7973357316574, -121.44511170585862, -2.0677739381680325, -223.16744152078334, -438.0125557015008, -100.05575060452082, -893.3127451684019, -10.634678683861548, -238.73474370389528, -1265.2429128166611, -567.5419107647452, -192.19332975359237, -1166.8248186037902, -1055.3982236828226, -1168.407164825653, -15.687918631158908, -1224.1685377087938, -556.6946813160615, -194.7480794863152, -1106.7399057044272, -190.32615241033656, -993.830530850835, -129.51801261590734, -121.01710754850748, -172.94084799147774, -1302.0871261195714, -916.5317356136292, -635.0744408549134, -410.7952409557271, -443.83676031716504, -522.2806233307949, -69.69728866617831, -375.7970519894801, -94.55038518186055, -924.2928186880206, -164.44307738609993, -963.5914580421256, -203.9156869677431, -56.848522724340675, -177.82074277472753, -765.8814830534461, -132.76877848464525, -75.37863396522113, -33.28128953879645, -349.332865730739], "episode_lengths": [150, 150, 150, 150, 150, 150, 108, 85, 35, 141, 150, 150, 150, 150, 92, 130, 77, 61, 90, 150, 77, 91, 62, 94, 104, 150, 94, 78, 150, 150, 150, 150, 150, 132, 150, 85, 150, 36, 150, 39, 79, 62, 150, 150, 122, 150, 149, 136, 73, 64, 150, 67, 63, 99, 150, 150, 76, 35, 83, 150, 51, 150, 32, 112, 150, 136, 90, 150, 150, 150, 40, 150, 150, 83, 150, 68, 150, 75, 75, 82, 150, 150, 130, 150, 135, 136, 67, 146, 75, 150, 66, 150, 107, 61, 68, 150, 76, 68, 37, 106], "policy_policy_0_reward": [-830.720708552095, -356.568500144832, -1224.9368346099834, -678.5337982386652, -706.4372032232827, -954.3992984893431, -391.42096813448507, -200.423384293604, -9.120351686242678, -579.1099446851067, -1052.967413502314, -1079.0377116921377, -820.5154027221795, -713.5261471202709, -165.45474720406762, -499.993456040729, -102.48045595194566, -90.75614406490337, -218.2870889794981, -749.5991791154468, -129.16774320558306, -211.2989200676044, -100.35750725560368, -196.93453005493103, -246.97318850422806, -1288.396863528743, -267.4244923096414, -131.39453933320786, -1308.2325721441343, -849.4609851955836, -1320.3246989717036, -756.1276981942731, -833.8863196136008, -401.57992833146903, -1291.6201569803466, -227.06413427222984, -667.87462955952, -7.218168684980547, -1127.5188873906702, -16.95991795921211, -153.32316366417916, -64.23029657470018, -648.7222381874927, -985.7759708449939, -308.09100326556353, -1417.562735232634, -431.11361648033716, -523.5674128607834, -235.37958134348543, -72.35640876284826, -753.8142503971865, -198.8355128561818, -62.68355460057737, -368.0437936217645, -551.841685814439, -512.7973357316574, -121.44511170585862, -2.0677739381680325, -223.16744152078334, -438.0125557015008, -100.05575060452082, -893.3127451684019, -10.634678683861548, -238.73474370389528, -1265.2429128166611, -567.5419107647452, -192.19332975359237, -1166.8248186037902, -1055.3982236828226, -1168.407164825653, -15.687918631158908, -1224.1685377087938, -556.6946813160615, -194.7480794863152, -1106.7399057044272, -190.32615241033656, -993.830530850835, -129.51801261590734, -121.01710754850748, -172.94084799147774, -1302.0871261195714, -916.5317356136292, -635.0744408549134, -410.7952409557271, -443.83676031716504, -522.2806233307949, -69.69728866617831, -375.7970519894801, -94.55038518186055, -924.2928186880206, -164.44307738609993, -963.5914580421256, -203.9156869677431, -56.848522724340675, -177.82074277472753, -765.8814830534461, -132.76877848464525, -75.37863396522113, -33.28128953879645, -349.332865730739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528128687860101, "mean_inference_ms": 1.7059164560184357, "mean_action_processing_ms": 0.2736986012797794, "mean_env_wait_ms": 3.4722846184712406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012162446975708008, "StateBufferConnector_ms": 0.007896900177001953, "ViewRequirementAgentConnector_ms": 0.1962277889251709}, "num_episodes": 39, "episode_return_max": -2.0677739381680325, "episode_return_min": -1417.562735232634, "episode_return_mean": -508.59160126370523, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.2875112916634, "num_env_steps_trained_throughput_per_sec": 308.2875112916634, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12965.562, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12965.495, "sample_time_ms": 1118.798, "learn_time_ms": 11783.217, "learn_throughput": 339.466, "synch_weights_time_ms": 62.705}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "07142_00000", "date": "2024-08-04_10-23-26", "timestamp": 1722747206, "time_this_iter_s": 12.988966941833496, "time_total_s": 607.5054471492767, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f4f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 607.5054471492767, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.66666666666667, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 258.7912688453992, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.5555017290016013, "policy_loss": -0.014395198267690527, "vf_loss": 3.57258960219721, "vf_explained_var": 0.9896575963124633, "kl": 0.01448801929991537, "entropy": 1.2472100559001167, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -2.0677739381680325, "episode_reward_min": -1417.562735232634, "episode_reward_mean": -436.7712780268134, "episode_len_mean": 103.6, "episode_media": {}, "episodes_timesteps_total": 10360, "policy_reward_min": {"policy_0": -1417.562735232634}, "policy_reward_max": {"policy_0": -2.0677739381680325}, "policy_reward_mean": {"policy_0": -436.7712780268134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.218168684980547, -1127.5188873906702, -16.95991795921211, -153.32316366417916, -64.23029657470018, -648.7222381874927, -985.7759708449939, -308.09100326556353, -1417.562735232634, -431.11361648033716, -523.5674128607834, -235.37958134348543, -72.35640876284826, -753.8142503971865, -198.8355128561818, -62.68355460057737, -368.0437936217645, -551.841685814439, -512.7973357316574, -121.44511170585862, -2.0677739381680325, -223.16744152078334, -438.0125557015008, -100.05575060452082, -893.3127451684019, -10.634678683861548, -238.73474370389528, -1265.2429128166611, -567.5419107647452, -192.19332975359237, -1166.8248186037902, -1055.3982236828226, -1168.407164825653, -15.687918631158908, -1224.1685377087938, -556.6946813160615, -194.7480794863152, -1106.7399057044272, -190.32615241033656, -993.830530850835, -129.51801261590734, -121.01710754850748, -172.94084799147774, -1302.0871261195714, -916.5317356136292, -635.0744408549134, -410.7952409557271, -443.83676031716504, -522.2806233307949, -69.69728866617831, -375.7970519894801, -94.55038518186055, -924.2928186880206, -164.44307738609993, -963.5914580421256, -203.9156869677431, -56.848522724340675, -177.82074277472753, -765.8814830534461, -132.76877848464525, -75.37863396522113, -33.28128953879645, -349.332865730739, -18.27183338910164, -158.29652078264985, -172.66508851466716, -99.16120763574082, -164.56300569860898, -90.07457221145356, -33.348553494948625, -119.70840702240996, -328.04394956810484, -136.74719346662917, -198.49034873273547, -997.0208151525893, -424.2514105920568, -715.5096741672365, -401.2876387068108, -1179.438350326878, -1307.73762960008, -176.04943335815452, -964.546790173722, -1021.8282947119978, -825.565612146324, -1245.1737609452546, -140.5791281248944, -16.54010711893689, -7.492633328074315, -229.93321885195743, -424.8896092160343, -99.61208257043737, -71.16718120237827, -6.43920129855603, -59.443701252158654, -30.562717033526877, -585.4322313561914, -466.5368635851325, -135.8052215142691, -187.87899754654762, -1230.2823378870996], "episode_lengths": [36, 150, 39, 79, 62, 150, 150, 122, 150, 149, 136, 73, 64, 150, 67, 63, 99, 150, 150, 76, 35, 83, 150, 51, 150, 32, 112, 150, 136, 90, 150, 150, 150, 40, 150, 150, 83, 150, 68, 150, 75, 75, 82, 150, 150, 130, 150, 135, 136, 67, 146, 75, 150, 66, 150, 107, 61, 68, 150, 76, 68, 37, 106, 43, 98, 81, 69, 92, 72, 56, 86, 100, 78, 81, 150, 150, 150, 114, 150, 150, 73, 150, 150, 150, 150, 78, 44, 42, 67, 124, 60, 40, 45, 59, 54, 150, 143, 70, 86, 150], "policy_policy_0_reward": [-7.218168684980547, -1127.5188873906702, -16.95991795921211, -153.32316366417916, -64.23029657470018, -648.7222381874927, -985.7759708449939, -308.09100326556353, -1417.562735232634, -431.11361648033716, -523.5674128607834, -235.37958134348543, -72.35640876284826, -753.8142503971865, -198.8355128561818, -62.68355460057737, -368.0437936217645, -551.841685814439, -512.7973357316574, -121.44511170585862, -2.0677739381680325, -223.16744152078334, -438.0125557015008, -100.05575060452082, -893.3127451684019, -10.634678683861548, -238.73474370389528, -1265.2429128166611, -567.5419107647452, -192.19332975359237, -1166.8248186037902, -1055.3982236828226, -1168.407164825653, -15.687918631158908, -1224.1685377087938, -556.6946813160615, -194.7480794863152, -1106.7399057044272, -190.32615241033656, -993.830530850835, -129.51801261590734, -121.01710754850748, -172.94084799147774, -1302.0871261195714, -916.5317356136292, -635.0744408549134, -410.7952409557271, -443.83676031716504, -522.2806233307949, -69.69728866617831, -375.7970519894801, -94.55038518186055, -924.2928186880206, -164.44307738609993, -963.5914580421256, -203.9156869677431, -56.848522724340675, -177.82074277472753, -765.8814830534461, -132.76877848464525, -75.37863396522113, -33.28128953879645, -349.332865730739, -18.27183338910164, -158.29652078264985, -172.66508851466716, -99.16120763574082, -164.56300569860898, -90.07457221145356, -33.348553494948625, -119.70840702240996, -328.04394956810484, -136.74719346662917, -198.49034873273547, -997.0208151525893, -424.2514105920568, -715.5096741672365, -401.2876387068108, -1179.438350326878, -1307.73762960008, -176.04943335815452, -964.546790173722, -1021.8282947119978, -825.565612146324, -1245.1737609452546, -140.5791281248944, -16.54010711893689, -7.492633328074315, -229.93321885195743, -424.8896092160343, -99.61208257043737, -71.16718120237827, -6.43920129855603, -59.443701252158654, -30.562717033526877, -585.4322313561914, -466.5368635851325, -135.8052215142691, -187.87899754654762, -1230.2823378870996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525466312084883, "mean_inference_ms": 1.7046112974475187, "mean_action_processing_ms": 0.2734202706874809, "mean_env_wait_ms": 3.4681198893907537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012243270874023438, "StateBufferConnector_ms": 0.007925033569335938, "ViewRequirementAgentConnector_ms": 0.19197726249694824}, "num_episodes": 37, "episode_return_max": -2.0677739381680325, "episode_return_min": -1417.562735232634, "episode_return_mean": -436.7712780268134, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.2428647302368, "num_env_steps_trained_throughput_per_sec": 307.2428647302368, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12963.221, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12963.153, "sample_time_ms": 1120.26, "learn_time_ms": 11780.242, "learn_throughput": 339.552, "synch_weights_time_ms": 61.871}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "07142_00000", "date": "2024-08-04_10-23-39", "timestamp": 1722747219, "time_this_iter_s": 13.031734466552734, "time_total_s": 620.5371816158295, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f6f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 620.5371816158295, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.48947368421053, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.42148621678353, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7443516274293263, "policy_loss": -0.015355020981708852, "vf_loss": 3.761810184021791, "vf_explained_var": 0.9897260574623943, "kl": 0.015509094605477053, "entropy": 1.257216875317196, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -6.43920129855603, "episode_reward_min": -1385.1448150124477, "episode_reward_mean": -464.5886038798887, "episode_len_mean": 107.41, "episode_media": {}, "episodes_timesteps_total": 10741, "policy_reward_min": {"policy_0": -1385.1448150124477}, "policy_reward_max": {"policy_0": -6.43920129855603}, "policy_reward_mean": {"policy_0": -464.5886038798887}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1224.1685377087938, -556.6946813160615, -194.7480794863152, -1106.7399057044272, -190.32615241033656, -993.830530850835, -129.51801261590734, -121.01710754850748, -172.94084799147774, -1302.0871261195714, -916.5317356136292, -635.0744408549134, -410.7952409557271, -443.83676031716504, -522.2806233307949, -69.69728866617831, -375.7970519894801, -94.55038518186055, -924.2928186880206, -164.44307738609993, -963.5914580421256, -203.9156869677431, -56.848522724340675, -177.82074277472753, -765.8814830534461, -132.76877848464525, -75.37863396522113, -33.28128953879645, -349.332865730739, -18.27183338910164, -158.29652078264985, -172.66508851466716, -99.16120763574082, -164.56300569860898, -90.07457221145356, -33.348553494948625, -119.70840702240996, -328.04394956810484, -136.74719346662917, -198.49034873273547, -997.0208151525893, -424.2514105920568, -715.5096741672365, -401.2876387068108, -1179.438350326878, -1307.73762960008, -176.04943335815452, -964.546790173722, -1021.8282947119978, -825.565612146324, -1245.1737609452546, -140.5791281248944, -16.54010711893689, -7.492633328074315, -229.93321885195743, -424.8896092160343, -99.61208257043737, -71.16718120237827, -6.43920129855603, -59.443701252158654, -30.562717033526877, -585.4322313561914, -466.5368635851325, -135.8052215142691, -187.87899754654762, -1230.2823378870996, -1199.544274885156, -147.07678538566324, -340.2717435155131, -758.2687674501162, -608.9062137340579, -168.58660165363844, -925.9477979925974, -227.56842276051825, -1109.8648995300446, -1000.7455862004001, -1091.6461491983703, -1385.1448150124477, -7.549773132240344, -67.03598881411051, -330.9674902163606, -1136.6085738277538, -327.8025654138066, -299.73693544620585, -823.3602280265209, -131.14644515025344, -1088.1723805016381, -320.83939857949366, -76.2744887872384, -974.4024619350753, -1110.706885110694, -71.31581315751208, -225.0823742888107, -271.34705977433924, -26.59005609440976, -36.10075405299107, -606.639087791895, -461.71294860322786, -859.5354522392778, -463.7959814242461], "episode_lengths": [150, 150, 83, 150, 68, 150, 75, 75, 82, 150, 150, 130, 150, 135, 136, 67, 146, 75, 150, 66, 150, 107, 61, 68, 150, 76, 68, 37, 106, 43, 98, 81, 69, 92, 72, 56, 86, 100, 78, 81, 150, 150, 150, 114, 150, 150, 73, 150, 150, 150, 150, 78, 44, 42, 67, 124, 60, 40, 45, 59, 54, 150, 143, 70, 86, 150, 150, 90, 150, 150, 150, 94, 150, 118, 150, 150, 150, 150, 39, 64, 99, 150, 107, 79, 150, 71, 150, 130, 66, 150, 150, 67, 87, 75, 48, 51, 150, 150, 150, 140], "policy_policy_0_reward": [-1224.1685377087938, -556.6946813160615, -194.7480794863152, -1106.7399057044272, -190.32615241033656, -993.830530850835, -129.51801261590734, -121.01710754850748, -172.94084799147774, -1302.0871261195714, -916.5317356136292, -635.0744408549134, -410.7952409557271, -443.83676031716504, -522.2806233307949, -69.69728866617831, -375.7970519894801, -94.55038518186055, -924.2928186880206, -164.44307738609993, -963.5914580421256, -203.9156869677431, -56.848522724340675, -177.82074277472753, -765.8814830534461, -132.76877848464525, -75.37863396522113, -33.28128953879645, -349.332865730739, -18.27183338910164, -158.29652078264985, -172.66508851466716, -99.16120763574082, -164.56300569860898, -90.07457221145356, -33.348553494948625, -119.70840702240996, -328.04394956810484, -136.74719346662917, -198.49034873273547, -997.0208151525893, -424.2514105920568, -715.5096741672365, -401.2876387068108, -1179.438350326878, -1307.73762960008, -176.04943335815452, -964.546790173722, -1021.8282947119978, -825.565612146324, -1245.1737609452546, -140.5791281248944, -16.54010711893689, -7.492633328074315, -229.93321885195743, -424.8896092160343, -99.61208257043737, -71.16718120237827, -6.43920129855603, -59.443701252158654, -30.562717033526877, -585.4322313561914, -466.5368635851325, -135.8052215142691, -187.87899754654762, -1230.2823378870996, -1199.544274885156, -147.07678538566324, -340.2717435155131, -758.2687674501162, -608.9062137340579, -168.58660165363844, -925.9477979925974, -227.56842276051825, -1109.8648995300446, -1000.7455862004001, -1091.6461491983703, -1385.1448150124477, -7.549773132240344, -67.03598881411051, -330.9674902163606, -1136.6085738277538, -327.8025654138066, -299.73693544620585, -823.3602280265209, -131.14644515025344, -1088.1723805016381, -320.83939857949366, -76.2744887872384, -974.4024619350753, -1110.706885110694, -71.31581315751208, -225.0823742888107, -271.34705977433924, -26.59005609440976, -36.10075405299107, -606.639087791895, -461.71294860322786, -859.5354522392778, -463.7959814242461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526437867367666, "mean_inference_ms": 1.7038773367413387, "mean_action_processing_ms": 0.2733814141429255, "mean_env_wait_ms": 3.4658237156759286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012128114700317383, "StateBufferConnector_ms": 0.00810384750366211, "ViewRequirementAgentConnector_ms": 0.194746732711792}, "num_episodes": 34, "episode_return_max": -6.43920129855603, "episode_return_min": -1385.1448150124477, "episode_return_mean": -464.5886038798887, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.62691024203184, "num_env_steps_trained_throughput_per_sec": 310.62691024203184, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 12946.285, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12946.214, "sample_time_ms": 1121.253, "learn_time_ms": 11761.204, "learn_throughput": 340.101, "synch_weights_time_ms": 62.979}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "07142_00000", "date": "2024-08-04_10-23-52", "timestamp": 1722747232, "time_this_iter_s": 12.888514995574951, "time_total_s": 633.4256966114044, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f6ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 633.4256966114044, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.766666666666666, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.0772322197755, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.507427600522836, "policy_loss": -0.01581648287731999, "vf_loss": 3.5263388906915982, "vf_explained_var": 0.9908836472779512, "kl": 0.01537410063591172, "entropy": 1.3472330681358775, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -6.43920129855603, "episode_reward_min": -1385.1448150124477, "episode_reward_mean": -489.77075104687, "episode_len_mean": 110.68, "episode_media": {}, "episodes_timesteps_total": 11068, "policy_reward_min": {"policy_0": -1385.1448150124477}, "policy_reward_max": {"policy_0": -6.43920129855603}, "policy_reward_mean": {"policy_0": -489.77075104687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.348553494948625, -119.70840702240996, -328.04394956810484, -136.74719346662917, -198.49034873273547, -997.0208151525893, -424.2514105920568, -715.5096741672365, -401.2876387068108, -1179.438350326878, -1307.73762960008, -176.04943335815452, -964.546790173722, -1021.8282947119978, -825.565612146324, -1245.1737609452546, -140.5791281248944, -16.54010711893689, -7.492633328074315, -229.93321885195743, -424.8896092160343, -99.61208257043737, -71.16718120237827, -6.43920129855603, -59.443701252158654, -30.562717033526877, -585.4322313561914, -466.5368635851325, -135.8052215142691, -187.87899754654762, -1230.2823378870996, -1199.544274885156, -147.07678538566324, -340.2717435155131, -758.2687674501162, -608.9062137340579, -168.58660165363844, -925.9477979925974, -227.56842276051825, -1109.8648995300446, -1000.7455862004001, -1091.6461491983703, -1385.1448150124477, -7.549773132240344, -67.03598881411051, -330.9674902163606, -1136.6085738277538, -327.8025654138066, -299.73693544620585, -823.3602280265209, -131.14644515025344, -1088.1723805016381, -320.83939857949366, -76.2744887872384, -974.4024619350753, -1110.706885110694, -71.31581315751208, -225.0823742888107, -271.34705977433924, -26.59005609440976, -36.10075405299107, -606.639087791895, -461.71294860322786, -859.5354522392778, -463.7959814242461, -469.6331197277836, -150.48289095863203, -982.2365237994177, -156.22520088078005, -1022.52739241359, -23.90397187244617, -151.71342879945092, -364.5643467359332, -370.4107967446864, -60.97296693808304, -7.406852077768625, -557.3887048140226, -61.93978120282425, -394.00816046573283, -643.208111164828, -1108.5441889058638, -135.6285539508503, -419.17854019295703, -1143.4681389516566, -30.82065985876998, -658.45298540493, -1219.7311206092572, -208.41926306914655, -700.5504470275772, -1167.2097280073995, -537.0450296728632, -78.54132356345916, -525.5426271171749, -101.85865910673715, -213.0938723620804, -209.343291031181, -751.4566867743581, -1046.387347563386, -189.3328964980677, -668.2092026845482], "episode_lengths": [56, 86, 100, 78, 81, 150, 150, 150, 114, 150, 150, 73, 150, 150, 150, 150, 78, 44, 42, 67, 124, 60, 40, 45, 59, 54, 150, 143, 70, 86, 150, 150, 90, 150, 150, 150, 94, 150, 118, 150, 150, 150, 150, 39, 64, 99, 150, 107, 79, 150, 71, 150, 130, 66, 150, 150, 67, 87, 75, 48, 51, 150, 150, 150, 140, 150, 87, 150, 84, 150, 48, 90, 96, 134, 48, 38, 150, 62, 138, 150, 150, 77, 139, 150, 45, 150, 150, 109, 150, 150, 150, 40, 150, 77, 95, 66, 150, 150, 70, 150], "policy_policy_0_reward": [-33.348553494948625, -119.70840702240996, -328.04394956810484, -136.74719346662917, -198.49034873273547, -997.0208151525893, -424.2514105920568, -715.5096741672365, -401.2876387068108, -1179.438350326878, -1307.73762960008, -176.04943335815452, -964.546790173722, -1021.8282947119978, -825.565612146324, -1245.1737609452546, -140.5791281248944, -16.54010711893689, -7.492633328074315, -229.93321885195743, -424.8896092160343, -99.61208257043737, -71.16718120237827, -6.43920129855603, -59.443701252158654, -30.562717033526877, -585.4322313561914, -466.5368635851325, -135.8052215142691, -187.87899754654762, -1230.2823378870996, -1199.544274885156, -147.07678538566324, -340.2717435155131, -758.2687674501162, -608.9062137340579, -168.58660165363844, -925.9477979925974, -227.56842276051825, -1109.8648995300446, -1000.7455862004001, -1091.6461491983703, -1385.1448150124477, -7.549773132240344, -67.03598881411051, -330.9674902163606, -1136.6085738277538, -327.8025654138066, -299.73693544620585, -823.3602280265209, -131.14644515025344, -1088.1723805016381, -320.83939857949366, -76.2744887872384, -974.4024619350753, -1110.706885110694, -71.31581315751208, -225.0823742888107, -271.34705977433924, -26.59005609440976, -36.10075405299107, -606.639087791895, -461.71294860322786, -859.5354522392778, -463.7959814242461, -469.6331197277836, -150.48289095863203, -982.2365237994177, -156.22520088078005, -1022.52739241359, -23.90397187244617, -151.71342879945092, -364.5643467359332, -370.4107967446864, -60.97296693808304, -7.406852077768625, -557.3887048140226, -61.93978120282425, -394.00816046573283, -643.208111164828, -1108.5441889058638, -135.6285539508503, -419.17854019295703, -1143.4681389516566, -30.82065985876998, -658.45298540493, -1219.7311206092572, -208.41926306914655, -700.5504470275772, -1167.2097280073995, -537.0450296728632, -78.54132356345916, -525.5426271171749, -101.85865910673715, -213.0938723620804, -209.343291031181, -751.4566867743581, -1046.387347563386, -189.3328964980677, -668.2092026845482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526716098189133, "mean_inference_ms": 1.7041777127502045, "mean_action_processing_ms": 0.27331839524972074, "mean_env_wait_ms": 3.468548238818838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012101173400878906, "StateBufferConnector_ms": 0.008315324783325195, "ViewRequirementAgentConnector_ms": 0.1927638053894043}, "num_episodes": 35, "episode_return_max": -6.43920129855603, "episode_return_min": -1385.1448150124477, "episode_return_mean": -489.77075104687, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.8294486929604, "num_env_steps_trained_throughput_per_sec": 304.8294486929604, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 12931.757, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12931.684, "sample_time_ms": 1127.932, "learn_time_ms": 11740.306, "learn_throughput": 340.707, "synch_weights_time_ms": 62.666}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "07142_00000", "date": "2024-08-04_10-24-05", "timestamp": 1722747245, "time_this_iter_s": 13.133588552474976, "time_total_s": 646.5592851638794, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f86814bc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 646.5592851638794, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.51052631578947, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 220.42595162391663, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.4281220619877177, "policy_loss": -0.014203607919140875, "vf_loss": 3.4461410373449324, "vf_explained_var": 0.9898916892086466, "kl": 0.01429214928551427, "entropy": 1.3462562731777628, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": -7.406852077768625, "episode_reward_min": -1385.1448150124477, "episode_reward_mean": -544.6282722962006, "episode_len_mean": 119.12, "episode_media": {}, "episodes_timesteps_total": 11912, "policy_reward_min": {"policy_0": -1385.1448150124477}, "policy_reward_max": {"policy_0": -7.406852077768625}, "policy_reward_mean": {"policy_0": -544.6282722962006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-147.07678538566324, -340.2717435155131, -758.2687674501162, -608.9062137340579, -168.58660165363844, -925.9477979925974, -227.56842276051825, -1109.8648995300446, -1000.7455862004001, -1091.6461491983703, -1385.1448150124477, -7.549773132240344, -67.03598881411051, -330.9674902163606, -1136.6085738277538, -327.8025654138066, -299.73693544620585, -823.3602280265209, -131.14644515025344, -1088.1723805016381, -320.83939857949366, -76.2744887872384, -974.4024619350753, -1110.706885110694, -71.31581315751208, -225.0823742888107, -271.34705977433924, -26.59005609440976, -36.10075405299107, -606.639087791895, -461.71294860322786, -859.5354522392778, -463.7959814242461, -469.6331197277836, -150.48289095863203, -982.2365237994177, -156.22520088078005, -1022.52739241359, -23.90397187244617, -151.71342879945092, -364.5643467359332, -370.4107967446864, -60.97296693808304, -7.406852077768625, -557.3887048140226, -61.93978120282425, -394.00816046573283, -643.208111164828, -1108.5441889058638, -135.6285539508503, -419.17854019295703, -1143.4681389516566, -30.82065985876998, -658.45298540493, -1219.7311206092572, -208.41926306914655, -700.5504470275772, -1167.2097280073995, -537.0450296728632, -78.54132356345916, -525.5426271171749, -101.85865910673715, -213.0938723620804, -209.343291031181, -751.4566867743581, -1046.387347563386, -189.3328964980677, -668.2092026845482, -1030.4668618433063, -630.100845113858, -535.4316545427926, -329.2119432700063, -303.3077043577132, -706.3147885045352, -1041.6709638701673, -37.86758154943036, -180.77520839155295, -1111.1398814025763, -311.63180218176814, -276.66671035229575, -1177.9814314254584, -512.4130382235372, -1272.9665861962737, -1277.465917355735, -568.1270957434398, -1259.4743434378802, -880.4039225342682, -1054.7510679217746, -970.8947458009959, -925.5700905765444, -557.7041807214969, -237.5415394071625, -254.56835897706307, -775.3437988303283, -636.620878871971, -153.82596169213292, -646.7353320504819, -77.28094396268402, -700.9776054122766, -17.406709348831292], "episode_lengths": [90, 150, 150, 150, 94, 150, 118, 150, 150, 150, 150, 39, 64, 99, 150, 107, 79, 150, 71, 150, 130, 66, 150, 150, 67, 87, 75, 48, 51, 150, 150, 150, 140, 150, 87, 150, 84, 150, 48, 90, 96, 134, 48, 38, 150, 62, 138, 150, 150, 77, 139, 150, 45, 150, 150, 109, 150, 150, 150, 40, 150, 77, 95, 66, 150, 150, 70, 150, 150, 150, 150, 137, 107, 150, 150, 37, 90, 150, 125, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 147, 150, 142, 81, 150, 68, 150, 41], "policy_policy_0_reward": [-147.07678538566324, -340.2717435155131, -758.2687674501162, -608.9062137340579, -168.58660165363844, -925.9477979925974, -227.56842276051825, -1109.8648995300446, -1000.7455862004001, -1091.6461491983703, -1385.1448150124477, -7.549773132240344, -67.03598881411051, -330.9674902163606, -1136.6085738277538, -327.8025654138066, -299.73693544620585, -823.3602280265209, -131.14644515025344, -1088.1723805016381, -320.83939857949366, -76.2744887872384, -974.4024619350753, -1110.706885110694, -71.31581315751208, -225.0823742888107, -271.34705977433924, -26.59005609440976, -36.10075405299107, -606.639087791895, -461.71294860322786, -859.5354522392778, -463.7959814242461, -469.6331197277836, -150.48289095863203, -982.2365237994177, -156.22520088078005, -1022.52739241359, -23.90397187244617, -151.71342879945092, -364.5643467359332, -370.4107967446864, -60.97296693808304, -7.406852077768625, -557.3887048140226, -61.93978120282425, -394.00816046573283, -643.208111164828, -1108.5441889058638, -135.6285539508503, -419.17854019295703, -1143.4681389516566, -30.82065985876998, -658.45298540493, -1219.7311206092572, -208.41926306914655, -700.5504470275772, -1167.2097280073995, -537.0450296728632, -78.54132356345916, -525.5426271171749, -101.85865910673715, -213.0938723620804, -209.343291031181, -751.4566867743581, -1046.387347563386, -189.3328964980677, -668.2092026845482, -1030.4668618433063, -630.100845113858, -535.4316545427926, -329.2119432700063, -303.3077043577132, -706.3147885045352, -1041.6709638701673, -37.86758154943036, -180.77520839155295, -1111.1398814025763, -311.63180218176814, -276.66671035229575, -1177.9814314254584, -512.4130382235372, -1272.9665861962737, -1277.465917355735, -568.1270957434398, -1259.4743434378802, -880.4039225342682, -1054.7510679217746, -970.8947458009959, -925.5700905765444, -557.7041807214969, -237.5415394071625, -254.56835897706307, -775.3437988303283, -636.620878871971, -153.82596169213292, -646.7353320504819, -77.28094396268402, -700.9776054122766, -17.406709348831292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526660069973467, "mean_inference_ms": 1.7031597129108178, "mean_action_processing_ms": 0.27334147588310764, "mean_env_wait_ms": 3.46950826877518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012053251266479492, "StateBufferConnector_ms": 0.008347034454345703, "ViewRequirementAgentConnector_ms": 0.19327449798583984}, "num_episodes": 32, "episode_return_max": -7.406852077768625, "episode_return_min": -1385.1448150124477, "episode_return_mean": -544.6282722962006, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.358252731225, "num_env_steps_trained_throughput_per_sec": 307.358252731225, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 12941.907, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12941.834, "sample_time_ms": 1128.151, "learn_time_ms": 11749.517, "learn_throughput": 340.44, "synch_weights_time_ms": 63.37}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "07142_00000", "date": "2024-08-04_10-24-18", "timestamp": 1722747258, "time_this_iter_s": 13.02692723274231, "time_total_s": 659.5862123966217, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f5120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 659.5862123966217, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.342105263157894, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 279.51242403189343, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.960295410702626, "policy_loss": -0.010016875307095082, "vf_loss": 3.9755267053842545, "vf_explained_var": 0.981116061968108, "kl": 0.013118258966460416, "entropy": 1.4069244268039862, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -5.272037505223557, "episode_reward_min": -1277.465917355735, "episode_reward_mean": -521.7829116456468, "episode_len_mean": 115.14, "episode_media": {}, "episodes_timesteps_total": 11514, "policy_reward_min": {"policy_0": -1277.465917355735}, "policy_reward_max": {"policy_0": -5.272037505223557}, "policy_reward_mean": {"policy_0": -521.7829116456468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.90397187244617, -151.71342879945092, -364.5643467359332, -370.4107967446864, -60.97296693808304, -7.406852077768625, -557.3887048140226, -61.93978120282425, -394.00816046573283, -643.208111164828, -1108.5441889058638, -135.6285539508503, -419.17854019295703, -1143.4681389516566, -30.82065985876998, -658.45298540493, -1219.7311206092572, -208.41926306914655, -700.5504470275772, -1167.2097280073995, -537.0450296728632, -78.54132356345916, -525.5426271171749, -101.85865910673715, -213.0938723620804, -209.343291031181, -751.4566867743581, -1046.387347563386, -189.3328964980677, -668.2092026845482, -1030.4668618433063, -630.100845113858, -535.4316545427926, -329.2119432700063, -303.3077043577132, -706.3147885045352, -1041.6709638701673, -37.86758154943036, -180.77520839155295, -1111.1398814025763, -311.63180218176814, -276.66671035229575, -1177.9814314254584, -512.4130382235372, -1272.9665861962737, -1277.465917355735, -568.1270957434398, -1259.4743434378802, -880.4039225342682, -1054.7510679217746, -970.8947458009959, -925.5700905765444, -557.7041807214969, -237.5415394071625, -254.56835897706307, -775.3437988303283, -636.620878871971, -153.82596169213292, -646.7353320504819, -77.28094396268402, -700.9776054122766, -17.406709348831292, -1068.446149016965, -34.23382323902578, -42.72520410697451, -1050.411799124901, -169.82606180563863, -393.8994298075438, -23.497748628738137, -112.19425000961516, -918.7905794573443, -907.8942312345567, -1050.1224478540855, -838.2515187796674, -69.39453090584216, -107.01622746793257, -5.272037505223557, -86.32007968006609, -135.0295466004775, -924.5023498748737, -146.95821786546486, -182.85765315092425, -723.7196900097534, -641.3854802364384, -25.517648362633796, -563.0476672035779, -905.7625345892349, -493.2423178738837, -880.8402479762525, -812.4614493651305, -918.263480745545, -1058.4613641816147, -123.29544169197732, -26.58538391659873, -11.850454986889051, -1084.0013636133622, -22.54829369371352, -1070.2912163087133, -163.67550127333257, -184.7265653817977], "episode_lengths": [48, 90, 96, 134, 48, 38, 150, 62, 138, 150, 150, 77, 139, 150, 45, 150, 150, 109, 150, 150, 150, 40, 150, 77, 95, 66, 150, 150, 70, 150, 150, 150, 150, 137, 107, 150, 150, 37, 90, 150, 125, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 147, 150, 142, 81, 150, 68, 150, 41, 150, 50, 55, 150, 68, 136, 45, 73, 150, 150, 150, 150, 56, 74, 45, 65, 78, 150, 82, 89, 150, 150, 51, 150, 150, 150, 150, 146, 150, 150, 74, 36, 42, 150, 47, 150, 83, 103], "policy_policy_0_reward": [-23.90397187244617, -151.71342879945092, -364.5643467359332, -370.4107967446864, -60.97296693808304, -7.406852077768625, -557.3887048140226, -61.93978120282425, -394.00816046573283, -643.208111164828, -1108.5441889058638, -135.6285539508503, -419.17854019295703, -1143.4681389516566, -30.82065985876998, -658.45298540493, -1219.7311206092572, -208.41926306914655, -700.5504470275772, -1167.2097280073995, -537.0450296728632, -78.54132356345916, -525.5426271171749, -101.85865910673715, -213.0938723620804, -209.343291031181, -751.4566867743581, -1046.387347563386, -189.3328964980677, -668.2092026845482, -1030.4668618433063, -630.100845113858, -535.4316545427926, -329.2119432700063, -303.3077043577132, -706.3147885045352, -1041.6709638701673, -37.86758154943036, -180.77520839155295, -1111.1398814025763, -311.63180218176814, -276.66671035229575, -1177.9814314254584, -512.4130382235372, -1272.9665861962737, -1277.465917355735, -568.1270957434398, -1259.4743434378802, -880.4039225342682, -1054.7510679217746, -970.8947458009959, -925.5700905765444, -557.7041807214969, -237.5415394071625, -254.56835897706307, -775.3437988303283, -636.620878871971, -153.82596169213292, -646.7353320504819, -77.28094396268402, -700.9776054122766, -17.406709348831292, -1068.446149016965, -34.23382323902578, -42.72520410697451, -1050.411799124901, -169.82606180563863, -393.8994298075438, -23.497748628738137, -112.19425000961516, -918.7905794573443, -907.8942312345567, -1050.1224478540855, -838.2515187796674, -69.39453090584216, -107.01622746793257, -5.272037505223557, -86.32007968006609, -135.0295466004775, -924.5023498748737, -146.95821786546486, -182.85765315092425, -723.7196900097534, -641.3854802364384, -25.517648362633796, -563.0476672035779, -905.7625345892349, -493.2423178738837, -880.8402479762525, -812.4614493651305, -918.263480745545, -1058.4613641816147, -123.29544169197732, -26.58538391659873, -11.850454986889051, -1084.0013636133622, -22.54829369371352, -1070.2912163087133, -163.67550127333257, -184.7265653817977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525582445745887, "mean_inference_ms": 1.7022408510941163, "mean_action_processing_ms": 0.2733419733788035, "mean_env_wait_ms": 3.4702961550562508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012764930725097656, "StateBufferConnector_ms": 0.008321285247802734, "ViewRequirementAgentConnector_ms": 0.1933300495147705}, "num_episodes": 38, "episode_return_max": -5.272037505223557, "episode_return_min": -1277.465917355735, "episode_return_mean": -521.7829116456468, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.14057163610363, "num_env_steps_trained_throughput_per_sec": 308.14057163610363, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 12940.874, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12940.798, "sample_time_ms": 1113.363, "learn_time_ms": 11762.952, "learn_throughput": 340.051, "synch_weights_time_ms": 63.696}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "07142_00000", "date": "2024-08-04_10-24-31", "timestamp": 1722747271, "time_this_iter_s": 12.993841409683228, "time_total_s": 672.5800538063049, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f40d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 672.5800538063049, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.605555555555554, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.4258424560229, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7110127194474143, "policy_loss": -0.0142926258573425, "vf_loss": 3.7288774681588013, "vf_explained_var": 0.9895656994233529, "kl": 0.01401009606100468, "entropy": 1.302894218141834, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -5.272037505223557, "episode_reward_min": -1322.1582329205066, "episode_reward_mean": -537.881357563551, "episode_len_mean": 114.5, "episode_media": {}, "episodes_timesteps_total": 11450, "policy_reward_min": {"policy_0": -1322.1582329205066}, "policy_reward_max": {"policy_0": -5.272037505223557}, "policy_reward_mean": {"policy_0": -537.881357563551}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-706.3147885045352, -1041.6709638701673, -37.86758154943036, -180.77520839155295, -1111.1398814025763, -311.63180218176814, -276.66671035229575, -1177.9814314254584, -512.4130382235372, -1272.9665861962737, -1277.465917355735, -568.1270957434398, -1259.4743434378802, -880.4039225342682, -1054.7510679217746, -970.8947458009959, -925.5700905765444, -557.7041807214969, -237.5415394071625, -254.56835897706307, -775.3437988303283, -636.620878871971, -153.82596169213292, -646.7353320504819, -77.28094396268402, -700.9776054122766, -17.406709348831292, -1068.446149016965, -34.23382323902578, -42.72520410697451, -1050.411799124901, -169.82606180563863, -393.8994298075438, -23.497748628738137, -112.19425000961516, -918.7905794573443, -907.8942312345567, -1050.1224478540855, -838.2515187796674, -69.39453090584216, -107.01622746793257, -5.272037505223557, -86.32007968006609, -135.0295466004775, -924.5023498748737, -146.95821786546486, -182.85765315092425, -723.7196900097534, -641.3854802364384, -25.517648362633796, -563.0476672035779, -905.7625345892349, -493.2423178738837, -880.8402479762525, -812.4614493651305, -918.263480745545, -1058.4613641816147, -123.29544169197732, -26.58538391659873, -11.850454986889051, -1084.0013636133622, -22.54829369371352, -1070.2912163087133, -163.67550127333257, -184.7265653817977, -180.7609942969773, -127.92968795324919, -658.1996691579318, -306.6704285828948, -1322.1582329205066, -1242.9050360663248, -891.7325120475181, -280.7103018267877, -627.3651105620796, -87.746920163365, -510.82953859309356, -1040.6239710789305, -312.93882967447183, -1243.3379756368493, -145.83685903273638, -188.20679117239726, -1015.1231885302159, -41.01989504152874, -124.95090491730994, -71.30062300960705, -260.20850820483344, -25.783255175563298, -278.92941372286253, -218.11626721222638, -53.9350891880999, -666.5169729455012, -1299.8536826849847, -581.6861235523019, -636.695070911897, -1139.797630126793, -240.95760178396344, -16.889650580431805, -145.33798141846722, -1149.8953120186322, -1051.7452542947947], "episode_lengths": [150, 150, 37, 90, 150, 125, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 147, 150, 142, 81, 150, 68, 150, 41, 150, 50, 55, 150, 68, 136, 45, 73, 150, 150, 150, 150, 56, 74, 45, 65, 78, 150, 82, 89, 150, 150, 51, 150, 150, 150, 150, 146, 150, 150, 74, 36, 42, 150, 47, 150, 83, 103, 97, 71, 150, 88, 150, 150, 150, 117, 150, 64, 111, 150, 130, 150, 72, 85, 150, 57, 73, 67, 109, 54, 127, 99, 43, 150, 150, 141, 150, 150, 124, 39, 84, 150, 150], "policy_policy_0_reward": [-706.3147885045352, -1041.6709638701673, -37.86758154943036, -180.77520839155295, -1111.1398814025763, -311.63180218176814, -276.66671035229575, -1177.9814314254584, -512.4130382235372, -1272.9665861962737, -1277.465917355735, -568.1270957434398, -1259.4743434378802, -880.4039225342682, -1054.7510679217746, -970.8947458009959, -925.5700905765444, -557.7041807214969, -237.5415394071625, -254.56835897706307, -775.3437988303283, -636.620878871971, -153.82596169213292, -646.7353320504819, -77.28094396268402, -700.9776054122766, -17.406709348831292, -1068.446149016965, -34.23382323902578, -42.72520410697451, -1050.411799124901, -169.82606180563863, -393.8994298075438, -23.497748628738137, -112.19425000961516, -918.7905794573443, -907.8942312345567, -1050.1224478540855, -838.2515187796674, -69.39453090584216, -107.01622746793257, -5.272037505223557, -86.32007968006609, -135.0295466004775, -924.5023498748737, -146.95821786546486, -182.85765315092425, -723.7196900097534, -641.3854802364384, -25.517648362633796, -563.0476672035779, -905.7625345892349, -493.2423178738837, -880.8402479762525, -812.4614493651305, -918.263480745545, -1058.4613641816147, -123.29544169197732, -26.58538391659873, -11.850454986889051, -1084.0013636133622, -22.54829369371352, -1070.2912163087133, -163.67550127333257, -184.7265653817977, -180.7609942969773, -127.92968795324919, -658.1996691579318, -306.6704285828948, -1322.1582329205066, -1242.9050360663248, -891.7325120475181, -280.7103018267877, -627.3651105620796, -87.746920163365, -510.82953859309356, -1040.6239710789305, -312.93882967447183, -1243.3379756368493, -145.83685903273638, -188.20679117239726, -1015.1231885302159, -41.01989504152874, -124.95090491730994, -71.30062300960705, -260.20850820483344, -25.783255175563298, -278.92941372286253, -218.11626721222638, -53.9350891880999, -666.5169729455012, -1299.8536826849847, -581.6861235523019, -636.695070911897, -1139.797630126793, -240.95760178396344, -16.889650580431805, -145.33798141846722, -1149.8953120186322, -1051.7452542947947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552445702026173, "mean_inference_ms": 1.700192029124151, "mean_action_processing_ms": 0.2730880983139916, "mean_env_wait_ms": 3.466503020593375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012783288955688477, "StateBufferConnector_ms": 0.007972240447998047, "ViewRequirementAgentConnector_ms": 0.20087003707885742}, "num_episodes": 35, "episode_return_max": -5.272037505223557, "episode_return_min": -1322.1582329205066, "episode_return_mean": -537.881357563551, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.725912777157, "num_env_steps_trained_throughput_per_sec": 302.725912777157, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 12960.275, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12960.199, "sample_time_ms": 1122.934, "learn_time_ms": 11771.407, "learn_throughput": 339.806, "synch_weights_time_ms": 65.036}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "07142_00000", "date": "2024-08-04_10-24-44", "timestamp": 1722747284, "time_this_iter_s": 13.226527452468872, "time_total_s": 685.8065812587738, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f86814bc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 685.8065812587738, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.52105263157895, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225.1738984922568, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.5010697399576505, "policy_loss": -0.012588437497712827, "vf_loss": 3.513946581383546, "vf_explained_var": 0.989520249205331, "kl": 0.015761530341478647, "entropy": 1.0927430549636483, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -5.272037505223557, "episode_reward_min": -1322.1582329205066, "episode_reward_mean": -455.2014329291889, "episode_len_mean": 107.38, "episode_media": {}, "episodes_timesteps_total": 10738, "policy_reward_min": {"policy_0": -1322.1582329205066}, "policy_reward_max": {"policy_0": -5.272037505223557}, "policy_reward_mean": {"policy_0": -455.2014329291889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.01622746793257, -5.272037505223557, -86.32007968006609, -135.0295466004775, -924.5023498748737, -146.95821786546486, -182.85765315092425, -723.7196900097534, -641.3854802364384, -25.517648362633796, -563.0476672035779, -905.7625345892349, -493.2423178738837, -880.8402479762525, -812.4614493651305, -918.263480745545, -1058.4613641816147, -123.29544169197732, -26.58538391659873, -11.850454986889051, -1084.0013636133622, -22.54829369371352, -1070.2912163087133, -163.67550127333257, -184.7265653817977, -180.7609942969773, -127.92968795324919, -658.1996691579318, -306.6704285828948, -1322.1582329205066, -1242.9050360663248, -891.7325120475181, -280.7103018267877, -627.3651105620796, -87.746920163365, -510.82953859309356, -1040.6239710789305, -312.93882967447183, -1243.3379756368493, -145.83685903273638, -188.20679117239726, -1015.1231885302159, -41.01989504152874, -124.95090491730994, -71.30062300960705, -260.20850820483344, -25.783255175563298, -278.92941372286253, -218.11626721222638, -53.9350891880999, -666.5169729455012, -1299.8536826849847, -581.6861235523019, -636.695070911897, -1139.797630126793, -240.95760178396344, -16.889650580431805, -145.33798141846722, -1149.8953120186322, -1051.7452542947947, -240.59393952949466, -934.1386189269938, -702.0687134890622, -110.31451783106385, -43.91143395377377, -226.02516619779374, -72.8997882504346, -208.11762242790684, -561.9171406664552, -313.9069812534206, -102.09881989489217, -1174.6321786875287, -76.69513153839036, -173.31341528738892, -433.5517963149657, -44.07219567714554, -45.40965531794924, -606.8882684116212, -282.5440649491431, -162.61596118600798, -711.7699026794523, -815.7555466827797, -452.88625780919165, -169.146536936818, -13.90915833995806, -25.654771777545783, -52.50230941103348, -175.18950096134904, -176.5673909670631, -167.85002304901215, -1054.9438797283606, -23.00030862953143, -526.7968460866623, -1153.446072861947, -1132.8122382248166, -979.7614150513195, -849.6525241063072, -118.91479571838153, -258.6175627644429, -660.923343699939], "episode_lengths": [74, 45, 65, 78, 150, 82, 89, 150, 150, 51, 150, 150, 150, 150, 146, 150, 150, 74, 36, 42, 150, 47, 150, 83, 103, 97, 71, 150, 88, 150, 150, 150, 117, 150, 64, 111, 150, 130, 150, 72, 85, 150, 57, 73, 67, 109, 54, 127, 99, 43, 150, 150, 141, 150, 150, 124, 39, 84, 150, 150, 118, 150, 150, 79, 42, 95, 51, 92, 150, 87, 66, 150, 53, 85, 124, 54, 64, 150, 101, 83, 150, 150, 139, 82, 42, 36, 56, 95, 89, 84, 150, 46, 150, 150, 150, 150, 150, 82, 92, 134], "policy_policy_0_reward": [-107.01622746793257, -5.272037505223557, -86.32007968006609, -135.0295466004775, -924.5023498748737, -146.95821786546486, -182.85765315092425, -723.7196900097534, -641.3854802364384, -25.517648362633796, -563.0476672035779, -905.7625345892349, -493.2423178738837, -880.8402479762525, -812.4614493651305, -918.263480745545, -1058.4613641816147, -123.29544169197732, -26.58538391659873, -11.850454986889051, -1084.0013636133622, -22.54829369371352, -1070.2912163087133, -163.67550127333257, -184.7265653817977, -180.7609942969773, -127.92968795324919, -658.1996691579318, -306.6704285828948, -1322.1582329205066, -1242.9050360663248, -891.7325120475181, -280.7103018267877, -627.3651105620796, -87.746920163365, -510.82953859309356, -1040.6239710789305, -312.93882967447183, -1243.3379756368493, -145.83685903273638, -188.20679117239726, -1015.1231885302159, -41.01989504152874, -124.95090491730994, -71.30062300960705, -260.20850820483344, -25.783255175563298, -278.92941372286253, -218.11626721222638, -53.9350891880999, -666.5169729455012, -1299.8536826849847, -581.6861235523019, -636.695070911897, -1139.797630126793, -240.95760178396344, -16.889650580431805, -145.33798141846722, -1149.8953120186322, -1051.7452542947947, -240.59393952949466, -934.1386189269938, -702.0687134890622, -110.31451783106385, -43.91143395377377, -226.02516619779374, -72.8997882504346, -208.11762242790684, -561.9171406664552, -313.9069812534206, -102.09881989489217, -1174.6321786875287, -76.69513153839036, -173.31341528738892, -433.5517963149657, -44.07219567714554, -45.40965531794924, -606.8882684116212, -282.5440649491431, -162.61596118600798, -711.7699026794523, -815.7555466827797, -452.88625780919165, -169.146536936818, -13.90915833995806, -25.654771777545783, -52.50230941103348, -175.18950096134904, -176.5673909670631, -167.85002304901215, -1054.9438797283606, -23.00030862953143, -526.7968460866623, -1153.446072861947, -1132.8122382248166, -979.7614150513195, -849.6525241063072, -118.91479571838153, -258.6175627644429, -660.923343699939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521321902436784, "mean_inference_ms": 1.6996649486827666, "mean_action_processing_ms": 0.27320681705343186, "mean_env_wait_ms": 3.4634978214328487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012359142303466797, "StateBufferConnector_ms": 0.00803065299987793, "ViewRequirementAgentConnector_ms": 0.20180940628051758}, "num_episodes": 40, "episode_return_max": -5.272037505223557, "episode_return_min": -1322.1582329205066, "episode_return_mean": -455.2014329291889, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.8483941571047, "num_env_steps_trained_throughput_per_sec": 299.8483941571047, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 12995.786, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12995.705, "sample_time_ms": 1120.901, "learn_time_ms": 11808.083, "learn_throughput": 338.751, "synch_weights_time_ms": 65.899}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "07142_00000", "date": "2024-08-04_10-24-58", "timestamp": 1722747298, "time_this_iter_s": 13.35268497467041, "time_total_s": 699.1592662334442, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f7eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 699.1592662334442, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.321052631578947, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 233.61201436718304, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.233299894382556, "policy_loss": -0.017770192237609686, "vf_loss": 3.2566623501479626, "vf_explained_var": 0.9915928896516562, "kl": 0.015032465134815313, "entropy": 1.573917568102479, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": -4.338270864187648, "episode_reward_min": -1299.8536826849847, "episode_reward_mean": -463.5771678586219, "episode_len_mean": 108.48, "episode_media": {}, "episodes_timesteps_total": 10848, "policy_reward_min": {"policy_0": -1299.8536826849847}, "policy_reward_max": {"policy_0": -4.338270864187648}, "policy_reward_mean": {"policy_0": -463.5771678586219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-280.7103018267877, -627.3651105620796, -87.746920163365, -510.82953859309356, -1040.6239710789305, -312.93882967447183, -1243.3379756368493, -145.83685903273638, -188.20679117239726, -1015.1231885302159, -41.01989504152874, -124.95090491730994, -71.30062300960705, -260.20850820483344, -25.783255175563298, -278.92941372286253, -218.11626721222638, -53.9350891880999, -666.5169729455012, -1299.8536826849847, -581.6861235523019, -636.695070911897, -1139.797630126793, -240.95760178396344, -16.889650580431805, -145.33798141846722, -1149.8953120186322, -1051.7452542947947, -240.59393952949466, -934.1386189269938, -702.0687134890622, -110.31451783106385, -43.91143395377377, -226.02516619779374, -72.8997882504346, -208.11762242790684, -561.9171406664552, -313.9069812534206, -102.09881989489217, -1174.6321786875287, -76.69513153839036, -173.31341528738892, -433.5517963149657, -44.07219567714554, -45.40965531794924, -606.8882684116212, -282.5440649491431, -162.61596118600798, -711.7699026794523, -815.7555466827797, -452.88625780919165, -169.146536936818, -13.90915833995806, -25.654771777545783, -52.50230941103348, -175.18950096134904, -176.5673909670631, -167.85002304901215, -1054.9438797283606, -23.00030862953143, -526.7968460866623, -1153.446072861947, -1132.8122382248166, -979.7614150513195, -849.6525241063072, -118.91479571838153, -258.6175627644429, -660.923343699939, -496.6138215680686, -844.945865904013, -747.7727099053899, -1182.382688617216, -199.54860476131256, -278.75217281507565, -1054.2953980863515, -857.3248107146696, -1274.2009892380113, -499.7457204557933, -1175.9594584646588, -336.5209769065217, -17.594523792681176, -1164.0369508600716, -103.61841339821977, -124.66361323453502, -4.338270864187648, -174.69317982080844, -397.8883264755896, -362.3169098225411, -38.67087229614817, -136.959828505318, -1282.0003693966244, -809.3125781611092, -43.00580159298905, -1079.660130239319, -73.00132067024954, -97.82819505722765, -848.4179250298612, -809.5087672246452, -20.581738280568644, -329.4013353643443], "episode_lengths": [117, 150, 64, 111, 150, 130, 150, 72, 85, 150, 57, 73, 67, 109, 54, 127, 99, 43, 150, 150, 141, 150, 150, 124, 39, 84, 150, 150, 118, 150, 150, 79, 42, 95, 51, 92, 150, 87, 66, 150, 53, 85, 124, 54, 64, 150, 101, 83, 150, 150, 139, 82, 42, 36, 56, 95, 89, 84, 150, 46, 150, 150, 150, 150, 150, 82, 92, 134, 135, 150, 150, 150, 94, 107, 150, 150, 150, 150, 150, 129, 44, 150, 67, 51, 37, 86, 150, 136, 56, 81, 150, 150, 57, 150, 60, 60, 150, 150, 47, 134], "policy_policy_0_reward": [-280.7103018267877, -627.3651105620796, -87.746920163365, -510.82953859309356, -1040.6239710789305, -312.93882967447183, -1243.3379756368493, -145.83685903273638, -188.20679117239726, -1015.1231885302159, -41.01989504152874, -124.95090491730994, -71.30062300960705, -260.20850820483344, -25.783255175563298, -278.92941372286253, -218.11626721222638, -53.9350891880999, -666.5169729455012, -1299.8536826849847, -581.6861235523019, -636.695070911897, -1139.797630126793, -240.95760178396344, -16.889650580431805, -145.33798141846722, -1149.8953120186322, -1051.7452542947947, -240.59393952949466, -934.1386189269938, -702.0687134890622, -110.31451783106385, -43.91143395377377, -226.02516619779374, -72.8997882504346, -208.11762242790684, -561.9171406664552, -313.9069812534206, -102.09881989489217, -1174.6321786875287, -76.69513153839036, -173.31341528738892, -433.5517963149657, -44.07219567714554, -45.40965531794924, -606.8882684116212, -282.5440649491431, -162.61596118600798, -711.7699026794523, -815.7555466827797, -452.88625780919165, -169.146536936818, -13.90915833995806, -25.654771777545783, -52.50230941103348, -175.18950096134904, -176.5673909670631, -167.85002304901215, -1054.9438797283606, -23.00030862953143, -526.7968460866623, -1153.446072861947, -1132.8122382248166, -979.7614150513195, -849.6525241063072, -118.91479571838153, -258.6175627644429, -660.923343699939, -496.6138215680686, -844.945865904013, -747.7727099053899, -1182.382688617216, -199.54860476131256, -278.75217281507565, -1054.2953980863515, -857.3248107146696, -1274.2009892380113, -499.7457204557933, -1175.9594584646588, -336.5209769065217, -17.594523792681176, -1164.0369508600716, -103.61841339821977, -124.66361323453502, -4.338270864187648, -174.69317982080844, -397.8883264755896, -362.3169098225411, -38.67087229614817, -136.959828505318, -1282.0003693966244, -809.3125781611092, -43.00580159298905, -1079.660130239319, -73.00132067024954, -97.82819505722765, -848.4179250298612, -809.5087672246452, -20.581738280568644, -329.4013353643443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525677487081544, "mean_inference_ms": 1.6997402104058486, "mean_action_processing_ms": 0.2731511842619662, "mean_env_wait_ms": 3.462344470490299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012350320816040039, "StateBufferConnector_ms": 0.008140325546264648, "ViewRequirementAgentConnector_ms": 0.1985759735107422}, "num_episodes": 32, "episode_return_max": -4.338270864187648, "episode_return_min": -1299.8536826849847, "episode_return_mean": -463.5771678586219, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.90974647439947, "num_env_steps_trained_throughput_per_sec": 358.90974647439947, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 12846.75, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12846.669, "sample_time_ms": 1126.369, "learn_time_ms": 11652.29, "learn_throughput": 343.28, "synch_weights_time_ms": 67.187}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "07142_00000", "date": "2024-08-04_10-25-09", "timestamp": 1722747309, "time_this_iter_s": 11.157315254211426, "time_total_s": 710.3165814876556, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f7f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 710.3165814876556, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 18.7375, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 254.73828914761543, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.611337395509084, "policy_loss": -0.011464238105691037, "vf_loss": 3.6300509942074615, "vf_explained_var": 0.9855744730681181, "kl": 0.014221853007560093, "entropy": 1.6849114418029785, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": -4.338270864187648, "episode_reward_min": -1346.5860513886096, "episode_reward_mean": -529.8187846510733, "episode_len_mean": 112.47, "episode_media": {}, "episodes_timesteps_total": 11247, "policy_reward_min": {"policy_0": -1346.5860513886096}, "policy_reward_max": {"policy_0": -4.338270864187648}, "policy_reward_mean": {"policy_0": -529.8187846510733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-208.11762242790684, -561.9171406664552, -313.9069812534206, -102.09881989489217, -1174.6321786875287, -76.69513153839036, -173.31341528738892, -433.5517963149657, -44.07219567714554, -45.40965531794924, -606.8882684116212, -282.5440649491431, -162.61596118600798, -711.7699026794523, -815.7555466827797, -452.88625780919165, -169.146536936818, -13.90915833995806, -25.654771777545783, -52.50230941103348, -175.18950096134904, -176.5673909670631, -167.85002304901215, -1054.9438797283606, -23.00030862953143, -526.7968460866623, -1153.446072861947, -1132.8122382248166, -979.7614150513195, -849.6525241063072, -118.91479571838153, -258.6175627644429, -660.923343699939, -496.6138215680686, -844.945865904013, -747.7727099053899, -1182.382688617216, -199.54860476131256, -278.75217281507565, -1054.2953980863515, -857.3248107146696, -1274.2009892380113, -499.7457204557933, -1175.9594584646588, -336.5209769065217, -17.594523792681176, -1164.0369508600716, -103.61841339821977, -124.66361323453502, -4.338270864187648, -174.69317982080844, -397.8883264755896, -362.3169098225411, -38.67087229614817, -136.959828505318, -1282.0003693966244, -809.3125781611092, -43.00580159298905, -1079.660130239319, -73.00132067024954, -97.82819505722765, -848.4179250298612, -809.5087672246452, -20.581738280568644, -329.4013353643443, -603.803310044456, -59.404762174931946, -1057.1878790889907, -1237.0034812700965, -1055.4801250937633, -287.3760222374315, -1065.9200863720507, -433.7577401808412, -214.52755178545254, -855.009787135158, -1085.2561807972634, -121.51574273682931, -7.832465544709969, -104.03881586789139, -5.899636231260064, -67.12437114692935, -1033.3372499194058, -1050.4634417014822, -1047.1923287742393, -936.0653722281347, -236.61481482216072, -1174.9531487572972, -1181.2054078942222, -177.5605960932825, -454.8870755816933, -643.0984625601245, -1147.1758976054182, -1298.3281982267933, -237.9717216795254, -336.5259440500209, -944.397633102809, -1346.5860513886096, -44.206289209342316, -391.5038328537647, -467.2411563281088], "episode_lengths": [92, 150, 87, 66, 150, 53, 85, 124, 54, 64, 150, 101, 83, 150, 150, 139, 82, 42, 36, 56, 95, 89, 84, 150, 46, 150, 150, 150, 150, 150, 82, 92, 134, 135, 150, 150, 150, 94, 107, 150, 150, 150, 150, 150, 129, 44, 150, 67, 51, 37, 86, 150, 136, 56, 81, 150, 150, 57, 150, 60, 60, 150, 150, 47, 134, 139, 56, 150, 150, 150, 120, 150, 150, 91, 150, 150, 60, 34, 67, 37, 55, 150, 150, 150, 150, 87, 150, 150, 150, 109, 150, 150, 150, 73, 113, 150, 150, 53, 93, 143], "policy_policy_0_reward": [-208.11762242790684, -561.9171406664552, -313.9069812534206, -102.09881989489217, -1174.6321786875287, -76.69513153839036, -173.31341528738892, -433.5517963149657, -44.07219567714554, -45.40965531794924, -606.8882684116212, -282.5440649491431, -162.61596118600798, -711.7699026794523, -815.7555466827797, -452.88625780919165, -169.146536936818, -13.90915833995806, -25.654771777545783, -52.50230941103348, -175.18950096134904, -176.5673909670631, -167.85002304901215, -1054.9438797283606, -23.00030862953143, -526.7968460866623, -1153.446072861947, -1132.8122382248166, -979.7614150513195, -849.6525241063072, -118.91479571838153, -258.6175627644429, -660.923343699939, -496.6138215680686, -844.945865904013, -747.7727099053899, -1182.382688617216, -199.54860476131256, -278.75217281507565, -1054.2953980863515, -857.3248107146696, -1274.2009892380113, -499.7457204557933, -1175.9594584646588, -336.5209769065217, -17.594523792681176, -1164.0369508600716, -103.61841339821977, -124.66361323453502, -4.338270864187648, -174.69317982080844, -397.8883264755896, -362.3169098225411, -38.67087229614817, -136.959828505318, -1282.0003693966244, -809.3125781611092, -43.00580159298905, -1079.660130239319, -73.00132067024954, -97.82819505722765, -848.4179250298612, -809.5087672246452, -20.581738280568644, -329.4013353643443, -603.803310044456, -59.404762174931946, -1057.1878790889907, -1237.0034812700965, -1055.4801250937633, -287.3760222374315, -1065.9200863720507, -433.7577401808412, -214.52755178545254, -855.009787135158, -1085.2561807972634, -121.51574273682931, -7.832465544709969, -104.03881586789139, -5.899636231260064, -67.12437114692935, -1033.3372499194058, -1050.4634417014822, -1047.1923287742393, -936.0653722281347, -236.61481482216072, -1174.9531487572972, -1181.2054078942222, -177.5605960932825, -454.8870755816933, -643.0984625601245, -1147.1758976054182, -1298.3281982267933, -237.9717216795254, -336.5259440500209, -944.397633102809, -1346.5860513886096, -44.206289209342316, -391.5038328537647, -467.2411563281088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528188361092049, "mean_inference_ms": 1.69967639666095, "mean_action_processing_ms": 0.27320138802789706, "mean_env_wait_ms": 3.4662358959388304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012547016143798828, "StateBufferConnector_ms": 0.008227825164794922, "ViewRequirementAgentConnector_ms": 0.20294451713562012}, "num_episodes": 35, "episode_return_max": -4.338270864187648, "episode_return_min": -1346.5860513886096, "episode_return_mean": -529.8187846510733, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.87538720279235, "num_env_steps_trained_throughput_per_sec": 302.87538720279235, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 12889.352, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12889.27, "sample_time_ms": 1141.223, "learn_time_ms": 11681.874, "learn_throughput": 342.411, "synch_weights_time_ms": 65.351}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "07142_00000", "date": "2024-08-04_10-25-22", "timestamp": 1722747322, "time_this_iter_s": 13.218702793121338, "time_total_s": 723.535284280777, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f5120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 723.535284280777, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.844444444444445, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 289.84844624996185, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.441144789631168, "policy_loss": -0.003083880942237253, "vf_loss": 3.4519235894083975, "vf_explained_var": 0.977373622233669, "kl": 0.014978280564522113, "entropy": 1.780526394272844, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": -4.338270864187648, "episode_reward_min": -1379.4391616330936, "episode_reward_mean": -619.8064372107257, "episode_len_mean": 120.21, "episode_media": {}, "episodes_timesteps_total": 12021, "policy_reward_min": {"policy_0": -1379.4391616330936}, "policy_reward_max": {"policy_0": -4.338270864187648}, "policy_reward_mean": {"policy_0": -619.8064372107257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.91479571838153, -258.6175627644429, -660.923343699939, -496.6138215680686, -844.945865904013, -747.7727099053899, -1182.382688617216, -199.54860476131256, -278.75217281507565, -1054.2953980863515, -857.3248107146696, -1274.2009892380113, -499.7457204557933, -1175.9594584646588, -336.5209769065217, -17.594523792681176, -1164.0369508600716, -103.61841339821977, -124.66361323453502, -4.338270864187648, -174.69317982080844, -397.8883264755896, -362.3169098225411, -38.67087229614817, -136.959828505318, -1282.0003693966244, -809.3125781611092, -43.00580159298905, -1079.660130239319, -73.00132067024954, -97.82819505722765, -848.4179250298612, -809.5087672246452, -20.581738280568644, -329.4013353643443, -603.803310044456, -59.404762174931946, -1057.1878790889907, -1237.0034812700965, -1055.4801250937633, -287.3760222374315, -1065.9200863720507, -433.7577401808412, -214.52755178545254, -855.009787135158, -1085.2561807972634, -121.51574273682931, -7.832465544709969, -104.03881586789139, -5.899636231260064, -67.12437114692935, -1033.3372499194058, -1050.4634417014822, -1047.1923287742393, -936.0653722281347, -236.61481482216072, -1174.9531487572972, -1181.2054078942222, -177.5605960932825, -454.8870755816933, -643.0984625601245, -1147.1758976054182, -1298.3281982267933, -237.9717216795254, -336.5259440500209, -944.397633102809, -1346.5860513886096, -44.206289209342316, -391.5038328537647, -467.2411563281088, -820.9401982577017, -1119.810306513489, -1133.973171454386, -751.4940264869949, -607.4201699880343, -311.09308722663826, -1011.1272960678906, -1379.4391616330936, -1051.5552824125887, -472.36893960595677, -1024.1761346928406, -1271.8270592367828, -96.21363058377607, -37.506704772579745, -1189.4207535278022, -1254.9254048504863, -751.1954687020341, -494.3988476919659, -41.432911791294345, -783.0478042376818, -646.5562406613599, -124.79838589536728, -961.5877638390563, -114.99912533480975, -867.1058509247515, -630.1582951936763, -691.27343118068, -162.04463923824204, -931.4759847496077, -932.8070941296248], "episode_lengths": [82, 92, 134, 135, 150, 150, 150, 94, 107, 150, 150, 150, 150, 150, 129, 44, 150, 67, 51, 37, 86, 150, 136, 56, 81, 150, 150, 57, 150, 60, 60, 150, 150, 47, 134, 139, 56, 150, 150, 150, 120, 150, 150, 91, 150, 150, 60, 34, 67, 37, 55, 150, 150, 150, 150, 87, 150, 150, 150, 109, 150, 150, 150, 73, 113, 150, 150, 53, 93, 143, 150, 150, 150, 136, 150, 102, 150, 150, 150, 102, 150, 150, 68, 51, 150, 150, 150, 150, 59, 150, 150, 76, 150, 52, 150, 150, 150, 106, 150, 150], "policy_policy_0_reward": [-118.91479571838153, -258.6175627644429, -660.923343699939, -496.6138215680686, -844.945865904013, -747.7727099053899, -1182.382688617216, -199.54860476131256, -278.75217281507565, -1054.2953980863515, -857.3248107146696, -1274.2009892380113, -499.7457204557933, -1175.9594584646588, -336.5209769065217, -17.594523792681176, -1164.0369508600716, -103.61841339821977, -124.66361323453502, -4.338270864187648, -174.69317982080844, -397.8883264755896, -362.3169098225411, -38.67087229614817, -136.959828505318, -1282.0003693966244, -809.3125781611092, -43.00580159298905, -1079.660130239319, -73.00132067024954, -97.82819505722765, -848.4179250298612, -809.5087672246452, -20.581738280568644, -329.4013353643443, -603.803310044456, -59.404762174931946, -1057.1878790889907, -1237.0034812700965, -1055.4801250937633, -287.3760222374315, -1065.9200863720507, -433.7577401808412, -214.52755178545254, -855.009787135158, -1085.2561807972634, -121.51574273682931, -7.832465544709969, -104.03881586789139, -5.899636231260064, -67.12437114692935, -1033.3372499194058, -1050.4634417014822, -1047.1923287742393, -936.0653722281347, -236.61481482216072, -1174.9531487572972, -1181.2054078942222, -177.5605960932825, -454.8870755816933, -643.0984625601245, -1147.1758976054182, -1298.3281982267933, -237.9717216795254, -336.5259440500209, -944.397633102809, -1346.5860513886096, -44.206289209342316, -391.5038328537647, -467.2411563281088, -820.9401982577017, -1119.810306513489, -1133.973171454386, -751.4940264869949, -607.4201699880343, -311.09308722663826, -1011.1272960678906, -1379.4391616330936, -1051.5552824125887, -472.36893960595677, -1024.1761346928406, -1271.8270592367828, -96.21363058377607, -37.506704772579745, -1189.4207535278022, -1254.9254048504863, -751.1954687020341, -494.3988476919659, -41.432911791294345, -783.0478042376818, -646.5562406613599, -124.79838589536728, -961.5877638390563, -114.99912533480975, -867.1058509247515, -630.1582951936763, -691.27343118068, -162.04463923824204, -931.4759847496077, -932.8070941296248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527115193651216, "mean_inference_ms": 1.6990626148649668, "mean_action_processing_ms": 0.2732586978411802, "mean_env_wait_ms": 3.4675289629229105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012468099594116211, "StateBufferConnector_ms": 0.008198738098144531, "ViewRequirementAgentConnector_ms": 0.20333218574523926}, "num_episodes": 30, "episode_return_max": -4.338270864187648, "episode_return_min": -1379.4391616330936, "episode_return_mean": -619.8064372107257, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.1225052230024, "num_env_steps_trained_throughput_per_sec": 310.1225052230024, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 12881.676, "restore_workers_time_ms": 0.038, "training_step_time_ms": 12881.59, "sample_time_ms": 1141.945, "learn_time_ms": 11672.129, "learn_throughput": 342.697, "synch_weights_time_ms": 66.685}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "07142_00000", "date": "2024-08-04_10-25-35", "timestamp": 1722747335, "time_this_iter_s": 12.911672115325928, "time_total_s": 736.4469563961029, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f6560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 736.4469563961029, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.310526315789474, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.06023013790448, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.303121198465427, "policy_loss": -0.010804376065304192, "vf_loss": 4.317863210042318, "vf_explained_var": 0.9638691611588002, "kl": 0.013504854088023422, "entropy": 1.3053396296997866, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -0.25492853600219334, "episode_reward_min": -1379.4391616330936, "episode_reward_mean": -629.0647772606449, "episode_len_mean": 121.85, "episode_media": {}, "episodes_timesteps_total": 12185, "policy_reward_min": {"policy_0": -1379.4391616330936}, "policy_reward_max": {"policy_0": -0.25492853600219334}, "policy_reward_mean": {"policy_0": -629.0647772606449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.5087672246452, -20.581738280568644, -329.4013353643443, -603.803310044456, -59.404762174931946, -1057.1878790889907, -1237.0034812700965, -1055.4801250937633, -287.3760222374315, -1065.9200863720507, -433.7577401808412, -214.52755178545254, -855.009787135158, -1085.2561807972634, -121.51574273682931, -7.832465544709969, -104.03881586789139, -5.899636231260064, -67.12437114692935, -1033.3372499194058, -1050.4634417014822, -1047.1923287742393, -936.0653722281347, -236.61481482216072, -1174.9531487572972, -1181.2054078942222, -177.5605960932825, -454.8870755816933, -643.0984625601245, -1147.1758976054182, -1298.3281982267933, -237.9717216795254, -336.5259440500209, -944.397633102809, -1346.5860513886096, -44.206289209342316, -391.5038328537647, -467.2411563281088, -820.9401982577017, -1119.810306513489, -1133.973171454386, -751.4940264869949, -607.4201699880343, -311.09308722663826, -1011.1272960678906, -1379.4391616330936, -1051.5552824125887, -472.36893960595677, -1024.1761346928406, -1271.8270592367828, -96.21363058377607, -37.506704772579745, -1189.4207535278022, -1254.9254048504863, -751.1954687020341, -494.3988476919659, -41.432911791294345, -783.0478042376818, -646.5562406613599, -124.79838589536728, -961.5877638390563, -114.99912533480975, -867.1058509247515, -630.1582951936763, -691.27343118068, -162.04463923824204, -931.4759847496077, -932.8070941296248, -176.1428327241272, -941.7683853950441, -155.74190897112047, -967.5004729429684, -829.4738592890104, -894.5541106922452, -41.45683437635969, -571.7037569928051, -329.3454417110013, -574.2787326397698, -968.4769008503864, -136.56612995472807, -407.9255587949112, -1182.9186026869638, -995.899891900184, -369.63114925967596, -1283.3145886044522, -99.6276484128841, -337.8033410742393, -466.9155190438309, -1043.7289882591458, -371.04568120229453, -687.9956757318932, -33.8882516459617, -1075.319857000348, -579.2721833261957, -705.7185716444098, -254.2762072890139, -0.25492853600219334, -310.7340886008029, -63.35800170823775, -813.7220325682321], "episode_lengths": [150, 47, 134, 139, 56, 150, 150, 150, 120, 150, 150, 91, 150, 150, 60, 34, 67, 37, 55, 150, 150, 150, 150, 87, 150, 150, 150, 109, 150, 150, 150, 73, 113, 150, 150, 53, 93, 143, 150, 150, 150, 136, 150, 102, 150, 150, 150, 102, 150, 150, 68, 51, 150, 150, 150, 150, 59, 150, 150, 76, 150, 52, 150, 150, 150, 106, 150, 150, 92, 150, 60, 150, 150, 150, 55, 150, 101, 150, 150, 86, 112, 150, 150, 105, 150, 69, 94, 150, 150, 117, 134, 53, 150, 142, 150, 105, 31, 104, 62, 150], "policy_policy_0_reward": [-809.5087672246452, -20.581738280568644, -329.4013353643443, -603.803310044456, -59.404762174931946, -1057.1878790889907, -1237.0034812700965, -1055.4801250937633, -287.3760222374315, -1065.9200863720507, -433.7577401808412, -214.52755178545254, -855.009787135158, -1085.2561807972634, -121.51574273682931, -7.832465544709969, -104.03881586789139, -5.899636231260064, -67.12437114692935, -1033.3372499194058, -1050.4634417014822, -1047.1923287742393, -936.0653722281347, -236.61481482216072, -1174.9531487572972, -1181.2054078942222, -177.5605960932825, -454.8870755816933, -643.0984625601245, -1147.1758976054182, -1298.3281982267933, -237.9717216795254, -336.5259440500209, -944.397633102809, -1346.5860513886096, -44.206289209342316, -391.5038328537647, -467.2411563281088, -820.9401982577017, -1119.810306513489, -1133.973171454386, -751.4940264869949, -607.4201699880343, -311.09308722663826, -1011.1272960678906, -1379.4391616330936, -1051.5552824125887, -472.36893960595677, -1024.1761346928406, -1271.8270592367828, -96.21363058377607, -37.506704772579745, -1189.4207535278022, -1254.9254048504863, -751.1954687020341, -494.3988476919659, -41.432911791294345, -783.0478042376818, -646.5562406613599, -124.79838589536728, -961.5877638390563, -114.99912533480975, -867.1058509247515, -630.1582951936763, -691.27343118068, -162.04463923824204, -931.4759847496077, -932.8070941296248, -176.1428327241272, -941.7683853950441, -155.74190897112047, -967.5004729429684, -829.4738592890104, -894.5541106922452, -41.45683437635969, -571.7037569928051, -329.3454417110013, -574.2787326397698, -968.4769008503864, -136.56612995472807, -407.9255587949112, -1182.9186026869638, -995.899891900184, -369.63114925967596, -1283.3145886044522, -99.6276484128841, -337.8033410742393, -466.9155190438309, -1043.7289882591458, -371.04568120229453, -687.9956757318932, -33.8882516459617, -1075.319857000348, -579.2721833261957, -705.7185716444098, -254.2762072890139, -0.25492853600219334, -310.7340886008029, -63.35800170823775, -813.7220325682321]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526482140247935, "mean_inference_ms": 1.6975635495019503, "mean_action_processing_ms": 0.2734042760018702, "mean_env_wait_ms": 3.4703697497880768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01240849494934082, "StateBufferConnector_ms": 0.008131742477416992, "ViewRequirementAgentConnector_ms": 0.20177793502807617}, "num_episodes": 32, "episode_return_max": -0.25492853600219334, "episode_return_min": -1379.4391616330936, "episode_return_mean": -629.0647772606449, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.0265011681479, "num_env_steps_trained_throughput_per_sec": 307.0265011681479, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 12882.593, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12882.508, "sample_time_ms": 1142.205, "learn_time_ms": 11671.714, "learn_throughput": 342.709, "synch_weights_time_ms": 67.749}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "07142_00000", "date": "2024-08-04_10-25-48", "timestamp": 1722747348, "time_this_iter_s": 13.039766788482666, "time_total_s": 749.4867231845856, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244153f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 749.4867231845856, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.67777777777778, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.32161152760187, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.9028775771458943, "policy_loss": -0.013223378601348182, "vf_loss": 3.9223081695536774, "vf_explained_var": 0.9630692823479573, "kl": 0.012685492362985972, "entropy": 1.4769925670077404, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": -0.25492853600219334, "episode_reward_min": -1379.4391616330936, "episode_reward_mean": -592.0668034039022, "episode_len_mean": 122.41, "episode_media": {}, "episodes_timesteps_total": 12241, "policy_reward_min": {"policy_0": -1379.4391616330936}, "policy_reward_max": {"policy_0": -0.25492853600219334}, "policy_reward_mean": {"policy_0": -592.0668034039022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-336.5259440500209, -944.397633102809, -1346.5860513886096, -44.206289209342316, -391.5038328537647, -467.2411563281088, -820.9401982577017, -1119.810306513489, -1133.973171454386, -751.4940264869949, -607.4201699880343, -311.09308722663826, -1011.1272960678906, -1379.4391616330936, -1051.5552824125887, -472.36893960595677, -1024.1761346928406, -1271.8270592367828, -96.21363058377607, -37.506704772579745, -1189.4207535278022, -1254.9254048504863, -751.1954687020341, -494.3988476919659, -41.432911791294345, -783.0478042376818, -646.5562406613599, -124.79838589536728, -961.5877638390563, -114.99912533480975, -867.1058509247515, -630.1582951936763, -691.27343118068, -162.04463923824204, -931.4759847496077, -932.8070941296248, -176.1428327241272, -941.7683853950441, -155.74190897112047, -967.5004729429684, -829.4738592890104, -894.5541106922452, -41.45683437635969, -571.7037569928051, -329.3454417110013, -574.2787326397698, -968.4769008503864, -136.56612995472807, -407.9255587949112, -1182.9186026869638, -995.899891900184, -369.63114925967596, -1283.3145886044522, -99.6276484128841, -337.8033410742393, -466.9155190438309, -1043.7289882591458, -371.04568120229453, -687.9956757318932, -33.8882516459617, -1075.319857000348, -579.2721833261957, -705.7185716444098, -254.2762072890139, -0.25492853600219334, -310.7340886008029, -63.35800170823775, -813.7220325682321, -814.4040249316323, -135.35346301274382, -142.4902941853961, -170.94004508654731, -659.5215265888638, -804.1903068116561, -91.72520627370615, -1145.983023176282, -659.7391221175507, -1255.3938708018952, -345.7933253919021, -0.6145321273898707, -510.16749574647883, -553.7628969972797, -546.0405010946915, -1046.595367543975, -10.704544898680554, -560.8177106825134, -555.234268244257, -858.1765872727893, -220.74919235553352, -327.76160890251066, -873.1528822360164, -260.5912905904231, -605.3000620959563, -98.707480394587, -237.63862124082868, -562.3443934183489, -611.91617237127, -1022.6462037434281, -306.5615201441562, -344.668588267839], "episode_lengths": [113, 150, 150, 53, 93, 143, 150, 150, 150, 136, 150, 102, 150, 150, 150, 102, 150, 150, 68, 51, 150, 150, 150, 150, 59, 150, 150, 76, 150, 52, 150, 150, 150, 106, 150, 150, 92, 150, 60, 150, 150, 150, 55, 150, 101, 150, 150, 86, 112, 150, 150, 105, 150, 69, 94, 150, 150, 117, 134, 53, 150, 142, 150, 105, 31, 104, 62, 150, 150, 88, 90, 88, 150, 150, 57, 150, 121, 150, 124, 32, 150, 149, 150, 150, 41, 150, 125, 150, 92, 150, 150, 99, 124, 72, 108, 150, 150, 150, 117, 88], "policy_policy_0_reward": [-336.5259440500209, -944.397633102809, -1346.5860513886096, -44.206289209342316, -391.5038328537647, -467.2411563281088, -820.9401982577017, -1119.810306513489, -1133.973171454386, -751.4940264869949, -607.4201699880343, -311.09308722663826, -1011.1272960678906, -1379.4391616330936, -1051.5552824125887, -472.36893960595677, -1024.1761346928406, -1271.8270592367828, -96.21363058377607, -37.506704772579745, -1189.4207535278022, -1254.9254048504863, -751.1954687020341, -494.3988476919659, -41.432911791294345, -783.0478042376818, -646.5562406613599, -124.79838589536728, -961.5877638390563, -114.99912533480975, -867.1058509247515, -630.1582951936763, -691.27343118068, -162.04463923824204, -931.4759847496077, -932.8070941296248, -176.1428327241272, -941.7683853950441, -155.74190897112047, -967.5004729429684, -829.4738592890104, -894.5541106922452, -41.45683437635969, -571.7037569928051, -329.3454417110013, -574.2787326397698, -968.4769008503864, -136.56612995472807, -407.9255587949112, -1182.9186026869638, -995.899891900184, -369.63114925967596, -1283.3145886044522, -99.6276484128841, -337.8033410742393, -466.9155190438309, -1043.7289882591458, -371.04568120229453, -687.9956757318932, -33.8882516459617, -1075.319857000348, -579.2721833261957, -705.7185716444098, -254.2762072890139, -0.25492853600219334, -310.7340886008029, -63.35800170823775, -813.7220325682321, -814.4040249316323, -135.35346301274382, -142.4902941853961, -170.94004508654731, -659.5215265888638, -804.1903068116561, -91.72520627370615, -1145.983023176282, -659.7391221175507, -1255.3938708018952, -345.7933253919021, -0.6145321273898707, -510.16749574647883, -553.7628969972797, -546.0405010946915, -1046.595367543975, -10.704544898680554, -560.8177106825134, -555.234268244257, -858.1765872727893, -220.74919235553352, -327.76160890251066, -873.1528822360164, -260.5912905904231, -605.3000620959563, -98.707480394587, -237.63862124082868, -562.3443934183489, -611.91617237127, -1022.6462037434281, -306.5615201441562, -344.668588267839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527103588037648, "mean_inference_ms": 1.6970030349662864, "mean_action_processing_ms": 0.2734678441080208, "mean_env_wait_ms": 3.468905442750079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011970996856689453, "StateBufferConnector_ms": 0.008115530014038086, "ViewRequirementAgentConnector_ms": 0.20200753211975098}, "num_episodes": 32, "episode_return_max": -0.25492853600219334, "episode_return_min": -1379.4391616330936, "episode_return_mean": -592.0668034039022, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.2615682497429, "num_env_steps_trained_throughput_per_sec": 308.2615682497429, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 12892.474, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12892.39, "sample_time_ms": 1142.075, "learn_time_ms": 11682.203, "learn_throughput": 342.401, "synch_weights_time_ms": 67.264}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "07142_00000", "date": "2024-08-04_10-26-01", "timestamp": 1722747361, "time_this_iter_s": 12.990293502807617, "time_total_s": 762.4770166873932, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f868148820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 762.4770166873932, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.431578947368422, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 258.55529443621634, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.6076166982452076, "policy_loss": -0.015334917057286172, "vf_loss": 3.6316612010200817, "vf_explained_var": 0.9763755266244213, "kl": 0.012057281082070454, "entropy": 1.6848234980056682, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": -0.25492853600219334, "episode_reward_min": -1283.3145886044522, "episode_reward_mean": -558.6099666726676, "episode_len_mean": 120.21, "episode_media": {}, "episodes_timesteps_total": 12021, "policy_reward_min": {"policy_0": -1283.3145886044522}, "policy_reward_max": {"policy_0": -0.25492853600219334}, "policy_reward_mean": {"policy_0": -558.6099666726676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-941.7683853950441, -155.74190897112047, -967.5004729429684, -829.4738592890104, -894.5541106922452, -41.45683437635969, -571.7037569928051, -329.3454417110013, -574.2787326397698, -968.4769008503864, -136.56612995472807, -407.9255587949112, -1182.9186026869638, -995.899891900184, -369.63114925967596, -1283.3145886044522, -99.6276484128841, -337.8033410742393, -466.9155190438309, -1043.7289882591458, -371.04568120229453, -687.9956757318932, -33.8882516459617, -1075.319857000348, -579.2721833261957, -705.7185716444098, -254.2762072890139, -0.25492853600219334, -310.7340886008029, -63.35800170823775, -813.7220325682321, -814.4040249316323, -135.35346301274382, -142.4902941853961, -170.94004508654731, -659.5215265888638, -804.1903068116561, -91.72520627370615, -1145.983023176282, -659.7391221175507, -1255.3938708018952, -345.7933253919021, -0.6145321273898707, -510.16749574647883, -553.7628969972797, -546.0405010946915, -1046.595367543975, -10.704544898680554, -560.8177106825134, -555.234268244257, -858.1765872727893, -220.74919235553352, -327.76160890251066, -873.1528822360164, -260.5912905904231, -605.3000620959563, -98.707480394587, -237.63862124082868, -562.3443934183489, -611.91617237127, -1022.6462037434281, -306.5615201441562, -344.668588267839, -384.88841584261445, -73.05790663978337, -660.4280307564868, -107.1705714944269, -990.0361113766595, -154.7739820600686, -994.2435088719474, -1151.5357804366881, -643.2765180884131, -1067.5502313969066, -722.2883101235548, -866.92262358758, -162.5743644821109, -1270.7800983831196, -1010.5764560981821, -1035.503865835929, -408.2294147750783, -988.0070884848805, -755.0956543450213, -94.47314538135494, -59.9792216438425, -184.48393949666553, -269.4247171956871, -930.9172322479701, -927.1072948662775, -171.56985474138054, -1062.257095661122, -47.489294113762426, -741.0718752390048, -130.25499147998022, -78.75889345896822, -560.5087591386183, -1208.8887759698373, -385.110322861015, -381.261862225536, -278.80283832763513, -1067.794190286403], "episode_lengths": [150, 60, 150, 150, 150, 55, 150, 101, 150, 150, 86, 112, 150, 150, 105, 150, 69, 94, 150, 150, 117, 134, 53, 150, 142, 150, 105, 31, 104, 62, 150, 150, 88, 90, 88, 150, 150, 57, 150, 121, 150, 124, 32, 150, 149, 150, 150, 41, 150, 125, 150, 92, 150, 150, 99, 124, 72, 108, 150, 150, 150, 117, 88, 150, 49, 150, 62, 150, 88, 150, 150, 150, 150, 133, 150, 94, 150, 150, 150, 89, 150, 142, 68, 58, 95, 142, 150, 150, 93, 150, 47, 150, 84, 60, 150, 150, 129, 93, 100, 150], "policy_policy_0_reward": [-941.7683853950441, -155.74190897112047, -967.5004729429684, -829.4738592890104, -894.5541106922452, -41.45683437635969, -571.7037569928051, -329.3454417110013, -574.2787326397698, -968.4769008503864, -136.56612995472807, -407.9255587949112, -1182.9186026869638, -995.899891900184, -369.63114925967596, -1283.3145886044522, -99.6276484128841, -337.8033410742393, -466.9155190438309, -1043.7289882591458, -371.04568120229453, -687.9956757318932, -33.8882516459617, -1075.319857000348, -579.2721833261957, -705.7185716444098, -254.2762072890139, -0.25492853600219334, -310.7340886008029, -63.35800170823775, -813.7220325682321, -814.4040249316323, -135.35346301274382, -142.4902941853961, -170.94004508654731, -659.5215265888638, -804.1903068116561, -91.72520627370615, -1145.983023176282, -659.7391221175507, -1255.3938708018952, -345.7933253919021, -0.6145321273898707, -510.16749574647883, -553.7628969972797, -546.0405010946915, -1046.595367543975, -10.704544898680554, -560.8177106825134, -555.234268244257, -858.1765872727893, -220.74919235553352, -327.76160890251066, -873.1528822360164, -260.5912905904231, -605.3000620959563, -98.707480394587, -237.63862124082868, -562.3443934183489, -611.91617237127, -1022.6462037434281, -306.5615201441562, -344.668588267839, -384.88841584261445, -73.05790663978337, -660.4280307564868, -107.1705714944269, -990.0361113766595, -154.7739820600686, -994.2435088719474, -1151.5357804366881, -643.2765180884131, -1067.5502313969066, -722.2883101235548, -866.92262358758, -162.5743644821109, -1270.7800983831196, -1010.5764560981821, -1035.503865835929, -408.2294147750783, -988.0070884848805, -755.0956543450213, -94.47314538135494, -59.9792216438425, -184.48393949666553, -269.4247171956871, -930.9172322479701, -927.1072948662775, -171.56985474138054, -1062.257095661122, -47.489294113762426, -741.0718752390048, -130.25499147998022, -78.75889345896822, -560.5087591386183, -1208.8887759698373, -385.110322861015, -381.261862225536, -278.80283832763513, -1067.794190286403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530670091230543, "mean_inference_ms": 1.6967259991091945, "mean_action_processing_ms": 0.27331628378516554, "mean_env_wait_ms": 3.4696482498943624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013018369674682617, "StateBufferConnector_ms": 0.008246183395385742, "ViewRequirementAgentConnector_ms": 0.20428013801574707}, "num_episodes": 37, "episode_return_max": -0.25492853600219334, "episode_return_min": -1283.3145886044522, "episode_return_mean": -558.6099666726676, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.52778172618326, "num_env_steps_trained_throughput_per_sec": 304.52778172618326, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 12893.773, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12893.692, "sample_time_ms": 1138.69, "learn_time_ms": 11686.977, "learn_throughput": 342.261, "synch_weights_time_ms": 67.176}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "07142_00000", "date": "2024-08-04_10-26-15", "timestamp": 1722747375, "time_this_iter_s": 13.147663831710815, "time_total_s": 775.624680519104, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f6560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 775.624680519104, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.284210526315793, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 278.2644796570142, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.393117293467124, "policy_loss": -0.014748048767796718, "vf_loss": 3.4136912462611995, "vf_explained_var": 0.9922361927106976, "kl": 0.01722242754952586, "entropy": 1.745104710633556, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -0.6145321273898707, "episode_reward_min": -1361.9041414338883, "episode_reward_mean": -598.6986384668916, "episode_len_mean": 123.02, "episode_media": {}, "episodes_timesteps_total": 12302, "policy_reward_min": {"policy_0": -1361.9041414338883}, "policy_reward_max": {"policy_0": -0.6145321273898707}, "policy_reward_mean": {"policy_0": -598.6986384668916}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310.7340886008029, -63.35800170823775, -813.7220325682321, -814.4040249316323, -135.35346301274382, -142.4902941853961, -170.94004508654731, -659.5215265888638, -804.1903068116561, -91.72520627370615, -1145.983023176282, -659.7391221175507, -1255.3938708018952, -345.7933253919021, -0.6145321273898707, -510.16749574647883, -553.7628969972797, -546.0405010946915, -1046.595367543975, -10.704544898680554, -560.8177106825134, -555.234268244257, -858.1765872727893, -220.74919235553352, -327.76160890251066, -873.1528822360164, -260.5912905904231, -605.3000620959563, -98.707480394587, -237.63862124082868, -562.3443934183489, -611.91617237127, -1022.6462037434281, -306.5615201441562, -344.668588267839, -384.88841584261445, -73.05790663978337, -660.4280307564868, -107.1705714944269, -990.0361113766595, -154.7739820600686, -994.2435088719474, -1151.5357804366881, -643.2765180884131, -1067.5502313969066, -722.2883101235548, -866.92262358758, -162.5743644821109, -1270.7800983831196, -1010.5764560981821, -1035.503865835929, -408.2294147750783, -988.0070884848805, -755.0956543450213, -94.47314538135494, -59.9792216438425, -184.48393949666553, -269.4247171956871, -930.9172322479701, -927.1072948662775, -171.56985474138054, -1062.257095661122, -47.489294113762426, -741.0718752390048, -130.25499147998022, -78.75889345896822, -560.5087591386183, -1208.8887759698373, -385.110322861015, -381.261862225536, -278.80283832763513, -1067.794190286403, -621.0427006434077, -682.206761775128, -983.734645453107, -987.1690083709098, -1177.602623406161, -1049.3128821987493, -237.77461046910744, -72.1143436926076, -179.10162258808006, -916.6333053096337, -1009.6876555494766, -332.3599376282113, -761.9263178864506, -1128.8150428082315, -52.7573450662279, -1.6705716504942878, -1168.7703836355552, -590.9745793264985, -278.8250102763072, -874.9249659557121, -1058.3912932398398, -1253.0966542753615, -515.1911356747308, -1022.7383316688511, -475.72093596725, -212.37364068252532, -1308.4499110177437, -1361.9041414338883], "episode_lengths": [104, 62, 150, 150, 88, 90, 88, 150, 150, 57, 150, 121, 150, 124, 32, 150, 149, 150, 150, 41, 150, 125, 150, 92, 150, 150, 99, 124, 72, 108, 150, 150, 150, 117, 88, 150, 49, 150, 62, 150, 88, 150, 150, 150, 150, 133, 150, 94, 150, 150, 150, 89, 150, 142, 68, 58, 95, 142, 150, 150, 93, 150, 47, 150, 84, 60, 150, 150, 129, 93, 100, 150, 150, 150, 150, 150, 150, 150, 81, 60, 87, 150, 150, 150, 150, 150, 59, 33, 150, 150, 95, 150, 150, 150, 150, 150, 150, 80, 150, 150], "policy_policy_0_reward": [-310.7340886008029, -63.35800170823775, -813.7220325682321, -814.4040249316323, -135.35346301274382, -142.4902941853961, -170.94004508654731, -659.5215265888638, -804.1903068116561, -91.72520627370615, -1145.983023176282, -659.7391221175507, -1255.3938708018952, -345.7933253919021, -0.6145321273898707, -510.16749574647883, -553.7628969972797, -546.0405010946915, -1046.595367543975, -10.704544898680554, -560.8177106825134, -555.234268244257, -858.1765872727893, -220.74919235553352, -327.76160890251066, -873.1528822360164, -260.5912905904231, -605.3000620959563, -98.707480394587, -237.63862124082868, -562.3443934183489, -611.91617237127, -1022.6462037434281, -306.5615201441562, -344.668588267839, -384.88841584261445, -73.05790663978337, -660.4280307564868, -107.1705714944269, -990.0361113766595, -154.7739820600686, -994.2435088719474, -1151.5357804366881, -643.2765180884131, -1067.5502313969066, -722.2883101235548, -866.92262358758, -162.5743644821109, -1270.7800983831196, -1010.5764560981821, -1035.503865835929, -408.2294147750783, -988.0070884848805, -755.0956543450213, -94.47314538135494, -59.9792216438425, -184.48393949666553, -269.4247171956871, -930.9172322479701, -927.1072948662775, -171.56985474138054, -1062.257095661122, -47.489294113762426, -741.0718752390048, -130.25499147998022, -78.75889345896822, -560.5087591386183, -1208.8887759698373, -385.110322861015, -381.261862225536, -278.80283832763513, -1067.794190286403, -621.0427006434077, -682.206761775128, -983.734645453107, -987.1690083709098, -1177.602623406161, -1049.3128821987493, -237.77461046910744, -72.1143436926076, -179.10162258808006, -916.6333053096337, -1009.6876555494766, -332.3599376282113, -761.9263178864506, -1128.8150428082315, -52.7573450662279, -1.6705716504942878, -1168.7703836355552, -590.9745793264985, -278.8250102763072, -874.9249659557121, -1058.3912932398398, -1253.0966542753615, -515.1911356747308, -1022.7383316688511, -475.72093596725, -212.37364068252532, -1308.4499110177437, -1361.9041414338883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532270585165642, "mean_inference_ms": 1.6966662585247156, "mean_action_processing_ms": 0.27330176985728505, "mean_env_wait_ms": 3.470199451311484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013154745101928711, "StateBufferConnector_ms": 0.008190631866455078, "ViewRequirementAgentConnector_ms": 0.20170211791992188}, "num_episodes": 28, "episode_return_max": -0.6145321273898707, "episode_return_min": -1361.9041414338883, "episode_return_mean": -598.6986384668916, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.8870269216802, "num_env_steps_trained_throughput_per_sec": 300.8870269216802, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 12921.763, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12921.68, "sample_time_ms": 1141.575, "learn_time_ms": 11713.669, "learn_throughput": 341.481, "synch_weights_time_ms": 65.599}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "07142_00000", "date": "2024-08-04_10-26-28", "timestamp": 1722747388, "time_this_iter_s": 13.307078123092651, "time_total_s": 788.9317586421967, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724161900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 788.9317586421967, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.673684210526318, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 287.8549076378346, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.4610569845885037, "policy_loss": -0.017290002107620238, "vf_loss": 3.484137590229511, "vf_explained_var": 0.9856294546897213, "kl": 0.015190818707742493, "entropy": 1.604441179210941, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -1.6705716504942878, "episode_reward_min": -1361.9041414338883, "episode_reward_mean": -635.383352629576, "episode_len_mean": 123.77, "episode_media": {}, "episodes_timesteps_total": 12377, "policy_reward_min": {"policy_0": -1361.9041414338883}, "policy_reward_max": {"policy_0": -1.6705716504942878}, "policy_reward_mean": {"policy_0": -635.383352629576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73.05790663978337, -660.4280307564868, -107.1705714944269, -990.0361113766595, -154.7739820600686, -994.2435088719474, -1151.5357804366881, -643.2765180884131, -1067.5502313969066, -722.2883101235548, -866.92262358758, -162.5743644821109, -1270.7800983831196, -1010.5764560981821, -1035.503865835929, -408.2294147750783, -988.0070884848805, -755.0956543450213, -94.47314538135494, -59.9792216438425, -184.48393949666553, -269.4247171956871, -930.9172322479701, -927.1072948662775, -171.56985474138054, -1062.257095661122, -47.489294113762426, -741.0718752390048, -130.25499147998022, -78.75889345896822, -560.5087591386183, -1208.8887759698373, -385.110322861015, -381.261862225536, -278.80283832763513, -1067.794190286403, -621.0427006434077, -682.206761775128, -983.734645453107, -987.1690083709098, -1177.602623406161, -1049.3128821987493, -237.77461046910744, -72.1143436926076, -179.10162258808006, -916.6333053096337, -1009.6876555494766, -332.3599376282113, -761.9263178864506, -1128.8150428082315, -52.7573450662279, -1.6705716504942878, -1168.7703836355552, -590.9745793264985, -278.8250102763072, -874.9249659557121, -1058.3912932398398, -1253.0966542753615, -515.1911356747308, -1022.7383316688511, -475.72093596725, -212.37364068252532, -1308.4499110177437, -1361.9041414338883, -711.9321203927714, -900.2124659491215, -1163.7702673847166, -1227.0154927801946, -236.01611224182548, -661.7741750232911, -294.5715905040314, -78.14065096928891, -183.99976867105187, -229.8598350375097, -1100.2499029241174, -191.63434482353898, -102.31187608983126, -246.6143926168274, -266.56862748624894, -1034.7364921121948, -68.40788732504174, -219.0764144502198, -865.9889882337469, -703.6802847018058, -358.40850342955383, -255.18123266233718, -1082.5659537242732, -104.34300667086147, -850.95236389, -818.2638062777962, -1072.6890175720746, -1186.6603352308684, -166.0168909301319, -1102.9033630629187, -20.546588926140924, -998.2081487493319, -786.5980210098975, -861.8383316642697, -446.7098363722907, -982.4129938453269], "episode_lengths": [49, 150, 62, 150, 88, 150, 150, 150, 150, 133, 150, 94, 150, 150, 150, 89, 150, 142, 68, 58, 95, 142, 150, 150, 93, 150, 47, 150, 84, 60, 150, 150, 129, 93, 100, 150, 150, 150, 150, 150, 150, 150, 81, 60, 87, 150, 150, 150, 150, 150, 59, 33, 150, 150, 95, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 68, 150, 89, 64, 77, 71, 150, 107, 74, 73, 150, 150, 58, 109, 150, 150, 150, 114, 150, 68, 150, 150, 150, 150, 91, 150, 43, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-73.05790663978337, -660.4280307564868, -107.1705714944269, -990.0361113766595, -154.7739820600686, -994.2435088719474, -1151.5357804366881, -643.2765180884131, -1067.5502313969066, -722.2883101235548, -866.92262358758, -162.5743644821109, -1270.7800983831196, -1010.5764560981821, -1035.503865835929, -408.2294147750783, -988.0070884848805, -755.0956543450213, -94.47314538135494, -59.9792216438425, -184.48393949666553, -269.4247171956871, -930.9172322479701, -927.1072948662775, -171.56985474138054, -1062.257095661122, -47.489294113762426, -741.0718752390048, -130.25499147998022, -78.75889345896822, -560.5087591386183, -1208.8887759698373, -385.110322861015, -381.261862225536, -278.80283832763513, -1067.794190286403, -621.0427006434077, -682.206761775128, -983.734645453107, -987.1690083709098, -1177.602623406161, -1049.3128821987493, -237.77461046910744, -72.1143436926076, -179.10162258808006, -916.6333053096337, -1009.6876555494766, -332.3599376282113, -761.9263178864506, -1128.8150428082315, -52.7573450662279, -1.6705716504942878, -1168.7703836355552, -590.9745793264985, -278.8250102763072, -874.9249659557121, -1058.3912932398398, -1253.0966542753615, -515.1911356747308, -1022.7383316688511, -475.72093596725, -212.37364068252532, -1308.4499110177437, -1361.9041414338883, -711.9321203927714, -900.2124659491215, -1163.7702673847166, -1227.0154927801946, -236.01611224182548, -661.7741750232911, -294.5715905040314, -78.14065096928891, -183.99976867105187, -229.8598350375097, -1100.2499029241174, -191.63434482353898, -102.31187608983126, -246.6143926168274, -266.56862748624894, -1034.7364921121948, -68.40788732504174, -219.0764144502198, -865.9889882337469, -703.6802847018058, -358.40850342955383, -255.18123266233718, -1082.5659537242732, -104.34300667086147, -850.95236389, -818.2638062777962, -1072.6890175720746, -1186.6603352308684, -166.0168909301319, -1102.9033630629187, -20.546588926140924, -998.2081487493319, -786.5980210098975, -861.8383316642697, -446.7098363722907, -982.4129938453269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534692612627485, "mean_inference_ms": 1.6962690005618777, "mean_action_processing_ms": 0.27316944720724357, "mean_env_wait_ms": 3.4703259900587984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013188838958740234, "StateBufferConnector_ms": 0.008229494094848633, "ViewRequirementAgentConnector_ms": 0.1982100009918213}, "num_episodes": 36, "episode_return_max": -1.6705716504942878, "episode_return_min": -1361.9041414338883, "episode_return_mean": -635.383352629576, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.3367126906528, "num_env_steps_trained_throughput_per_sec": 372.3367126906528, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 12697.95, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12697.869, "sample_time_ms": 1143.86, "learn_time_ms": 11489.16, "learn_throughput": 348.154, "synch_weights_time_ms": 64.023}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "07142_00000", "date": "2024-08-04_10-26-39", "timestamp": 1722747399, "time_this_iter_s": 10.7548246383667, "time_total_s": 799.6865832805634, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724415000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 799.6865832805634, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 19.2, "ram_util_percent": 28.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.31654436190922, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.70265830916663, "policy_loss": -0.014401461738937844, "vf_loss": 3.7220835465937854, "vf_explained_var": 0.9873179908220967, "kl": 0.015147902191165486, "entropy": 1.5248621407896281, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": -1.6705716504942878, "episode_reward_min": -1434.277136506149, "episode_reward_mean": -635.6342307852732, "episode_len_mean": 122.88, "episode_media": {}, "episodes_timesteps_total": 12288, "policy_reward_min": {"policy_0": -1434.277136506149}, "policy_reward_max": {"policy_0": -1.6705716504942878}, "policy_reward_mean": {"policy_0": -635.6342307852732}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-381.261862225536, -278.80283832763513, -1067.794190286403, -621.0427006434077, -682.206761775128, -983.734645453107, -987.1690083709098, -1177.602623406161, -1049.3128821987493, -237.77461046910744, -72.1143436926076, -179.10162258808006, -916.6333053096337, -1009.6876555494766, -332.3599376282113, -761.9263178864506, -1128.8150428082315, -52.7573450662279, -1.6705716504942878, -1168.7703836355552, -590.9745793264985, -278.8250102763072, -874.9249659557121, -1058.3912932398398, -1253.0966542753615, -515.1911356747308, -1022.7383316688511, -475.72093596725, -212.37364068252532, -1308.4499110177437, -1361.9041414338883, -711.9321203927714, -900.2124659491215, -1163.7702673847166, -1227.0154927801946, -236.01611224182548, -661.7741750232911, -294.5715905040314, -78.14065096928891, -183.99976867105187, -229.8598350375097, -1100.2499029241174, -191.63434482353898, -102.31187608983126, -246.6143926168274, -266.56862748624894, -1034.7364921121948, -68.40788732504174, -219.0764144502198, -865.9889882337469, -703.6802847018058, -358.40850342955383, -255.18123266233718, -1082.5659537242732, -104.34300667086147, -850.95236389, -818.2638062777962, -1072.6890175720746, -1186.6603352308684, -166.0168909301319, -1102.9033630629187, -20.546588926140924, -998.2081487493319, -786.5980210098975, -861.8383316642697, -446.7098363722907, -982.4129938453269, -845.5072701618292, -332.9633995615663, -595.2720240970542, -37.81846404632636, -787.7597853721539, -662.1184951761815, -5.27071785941698, -173.486788131686, -224.89157165680405, -933.365822217198, -117.05633732808556, -678.4373472734378, -1073.4051496861996, -82.53279192694286, -380.65766665245445, -330.5376848473299, -117.65690612707739, -531.6470691295947, -1127.6425857946638, -173.9934502219162, -960.1904854443299, -177.1183137453963, -994.3778919069275, -798.2655976875327, -1222.6266475027994, -934.173583689377, -1159.9950482131999, -253.0293936015039, -1434.277136506149, -1055.462159941615, -118.98690262852526, -205.85559797057212, -1413.0536601962099], "episode_lengths": [93, 100, 150, 150, 150, 150, 150, 150, 150, 81, 60, 87, 150, 150, 150, 150, 150, 59, 33, 150, 150, 95, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 68, 150, 89, 64, 77, 71, 150, 107, 74, 73, 150, 150, 58, 109, 150, 150, 150, 114, 150, 68, 150, 150, 150, 150, 91, 150, 43, 150, 150, 150, 150, 150, 150, 90, 150, 46, 150, 150, 36, 91, 71, 150, 75, 150, 150, 64, 131, 88, 74, 150, 150, 94, 150, 79, 150, 150, 150, 150, 150, 123, 150, 150, 66, 66, 150], "policy_policy_0_reward": [-381.261862225536, -278.80283832763513, -1067.794190286403, -621.0427006434077, -682.206761775128, -983.734645453107, -987.1690083709098, -1177.602623406161, -1049.3128821987493, -237.77461046910744, -72.1143436926076, -179.10162258808006, -916.6333053096337, -1009.6876555494766, -332.3599376282113, -761.9263178864506, -1128.8150428082315, -52.7573450662279, -1.6705716504942878, -1168.7703836355552, -590.9745793264985, -278.8250102763072, -874.9249659557121, -1058.3912932398398, -1253.0966542753615, -515.1911356747308, -1022.7383316688511, -475.72093596725, -212.37364068252532, -1308.4499110177437, -1361.9041414338883, -711.9321203927714, -900.2124659491215, -1163.7702673847166, -1227.0154927801946, -236.01611224182548, -661.7741750232911, -294.5715905040314, -78.14065096928891, -183.99976867105187, -229.8598350375097, -1100.2499029241174, -191.63434482353898, -102.31187608983126, -246.6143926168274, -266.56862748624894, -1034.7364921121948, -68.40788732504174, -219.0764144502198, -865.9889882337469, -703.6802847018058, -358.40850342955383, -255.18123266233718, -1082.5659537242732, -104.34300667086147, -850.95236389, -818.2638062777962, -1072.6890175720746, -1186.6603352308684, -166.0168909301319, -1102.9033630629187, -20.546588926140924, -998.2081487493319, -786.5980210098975, -861.8383316642697, -446.7098363722907, -982.4129938453269, -845.5072701618292, -332.9633995615663, -595.2720240970542, -37.81846404632636, -787.7597853721539, -662.1184951761815, -5.27071785941698, -173.486788131686, -224.89157165680405, -933.365822217198, -117.05633732808556, -678.4373472734378, -1073.4051496861996, -82.53279192694286, -380.65766665245445, -330.5376848473299, -117.65690612707739, -531.6470691295947, -1127.6425857946638, -173.9934502219162, -960.1904854443299, -177.1183137453963, -994.3778919069275, -798.2655976875327, -1222.6266475027994, -934.173583689377, -1159.9950482131999, -253.0293936015039, -1434.277136506149, -1055.462159941615, -118.98690262852526, -205.85559797057212, -1413.0536601962099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532790618369522, "mean_inference_ms": 1.695314628262896, "mean_action_processing_ms": 0.27317309411287016, "mean_env_wait_ms": 3.469217348661244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012659788131713867, "StateBufferConnector_ms": 0.008127927780151367, "ViewRequirementAgentConnector_ms": 0.1963059902191162}, "num_episodes": 33, "episode_return_max": -1.6705716504942878, "episode_return_min": -1434.277136506149, "episode_return_mean": -635.6342307852732, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.0300241888841, "num_env_steps_trained_throughput_per_sec": 353.0300241888841, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 12509.671, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12509.589, "sample_time_ms": 1133.608, "learn_time_ms": 11312.069, "learn_throughput": 353.605, "synch_weights_time_ms": 63.108}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "07142_00000", "date": "2024-08-04_10-26-50", "timestamp": 1722747410, "time_this_iter_s": 11.343691110610962, "time_total_s": 811.0302743911743, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f5090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 811.0302743911743, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 18.69375, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.69203686714172, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7925077420969804, "policy_loss": -0.01136487594631035, "vf_loss": 3.8070288629581532, "vf_explained_var": 0.9802420906722545, "kl": 0.016658417678521196, "entropy": 1.4400665368884802, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": -5.27071785941698, "episode_reward_min": -1434.277136506149, "episode_reward_mean": -560.3310167916003, "episode_len_mean": 117.71, "episode_media": {}, "episodes_timesteps_total": 11771, "policy_reward_min": {"policy_0": -1434.277136506149}, "policy_reward_max": {"policy_0": -5.27071785941698}, "policy_reward_mean": {"policy_0": -560.3310167916003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-294.5715905040314, -78.14065096928891, -183.99976867105187, -229.8598350375097, -1100.2499029241174, -191.63434482353898, -102.31187608983126, -246.6143926168274, -266.56862748624894, -1034.7364921121948, -68.40788732504174, -219.0764144502198, -865.9889882337469, -703.6802847018058, -358.40850342955383, -255.18123266233718, -1082.5659537242732, -104.34300667086147, -850.95236389, -818.2638062777962, -1072.6890175720746, -1186.6603352308684, -166.0168909301319, -1102.9033630629187, -20.546588926140924, -998.2081487493319, -786.5980210098975, -861.8383316642697, -446.7098363722907, -982.4129938453269, -845.5072701618292, -332.9633995615663, -595.2720240970542, -37.81846404632636, -787.7597853721539, -662.1184951761815, -5.27071785941698, -173.486788131686, -224.89157165680405, -933.365822217198, -117.05633732808556, -678.4373472734378, -1073.4051496861996, -82.53279192694286, -380.65766665245445, -330.5376848473299, -117.65690612707739, -531.6470691295947, -1127.6425857946638, -173.9934502219162, -960.1904854443299, -177.1183137453963, -994.3778919069275, -798.2655976875327, -1222.6266475027994, -934.173583689377, -1159.9950482131999, -253.0293936015039, -1434.277136506149, -1055.462159941615, -118.98690262852526, -205.85559797057212, -1413.0536601962099, -787.9487933281785, -1114.364889717337, -425.0635917847243, -205.0404375084182, -633.4798228619003, -1131.1301370931699, -828.2571671674033, -529.2888862848204, -725.0582650119859, -153.12423455848267, -265.1557253432681, -158.77306193929323, -129.05918458993784, -1231.2426181920841, -465.9575471118534, -943.2965570345751, -734.9806003577022, -530.8101719897344, -290.00805576773234, -1118.5318480517044, -335.5889751921856, -157.81230669384368, -243.73404926523807, -67.99747912821584, -1090.3731622911337, -642.0198200441315, -899.229175707928, -790.664989609304, -135.16832881057294, -779.2416839397589, -13.526124958115764, -92.7827234985219, -63.20549170756175, -148.70549437037485, -83.17935070106192, -897.4424904948951, -572.2852407872931], "episode_lengths": [89, 64, 77, 71, 150, 107, 74, 73, 150, 150, 58, 109, 150, 150, 150, 114, 150, 68, 150, 150, 150, 150, 91, 150, 43, 150, 150, 150, 150, 150, 150, 90, 150, 46, 150, 150, 36, 91, 71, 150, 75, 150, 150, 64, 131, 88, 74, 150, 150, 94, 150, 79, 150, 150, 150, 150, 150, 123, 150, 150, 66, 66, 150, 133, 150, 150, 85, 150, 150, 150, 150, 150, 57, 94, 82, 68, 150, 150, 150, 150, 125, 90, 150, 113, 82, 91, 49, 150, 150, 150, 150, 71, 150, 45, 64, 57, 76, 60, 150, 147], "policy_policy_0_reward": [-294.5715905040314, -78.14065096928891, -183.99976867105187, -229.8598350375097, -1100.2499029241174, -191.63434482353898, -102.31187608983126, -246.6143926168274, -266.56862748624894, -1034.7364921121948, -68.40788732504174, -219.0764144502198, -865.9889882337469, -703.6802847018058, -358.40850342955383, -255.18123266233718, -1082.5659537242732, -104.34300667086147, -850.95236389, -818.2638062777962, -1072.6890175720746, -1186.6603352308684, -166.0168909301319, -1102.9033630629187, -20.546588926140924, -998.2081487493319, -786.5980210098975, -861.8383316642697, -446.7098363722907, -982.4129938453269, -845.5072701618292, -332.9633995615663, -595.2720240970542, -37.81846404632636, -787.7597853721539, -662.1184951761815, -5.27071785941698, -173.486788131686, -224.89157165680405, -933.365822217198, -117.05633732808556, -678.4373472734378, -1073.4051496861996, -82.53279192694286, -380.65766665245445, -330.5376848473299, -117.65690612707739, -531.6470691295947, -1127.6425857946638, -173.9934502219162, -960.1904854443299, -177.1183137453963, -994.3778919069275, -798.2655976875327, -1222.6266475027994, -934.173583689377, -1159.9950482131999, -253.0293936015039, -1434.277136506149, -1055.462159941615, -118.98690262852526, -205.85559797057212, -1413.0536601962099, -787.9487933281785, -1114.364889717337, -425.0635917847243, -205.0404375084182, -633.4798228619003, -1131.1301370931699, -828.2571671674033, -529.2888862848204, -725.0582650119859, -153.12423455848267, -265.1557253432681, -158.77306193929323, -129.05918458993784, -1231.2426181920841, -465.9575471118534, -943.2965570345751, -734.9806003577022, -530.8101719897344, -290.00805576773234, -1118.5318480517044, -335.5889751921856, -157.81230669384368, -243.73404926523807, -67.99747912821584, -1090.3731622911337, -642.0198200441315, -899.229175707928, -790.664989609304, -135.16832881057294, -779.2416839397589, -13.526124958115764, -92.7827234985219, -63.20549170756175, -148.70549437037485, -83.17935070106192, -897.4424904948951, -572.2852407872931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531671360067719, "mean_inference_ms": 1.6940302798352662, "mean_action_processing_ms": 0.2732508386382165, "mean_env_wait_ms": 3.4685546335945463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012679338455200195, "StateBufferConnector_ms": 0.008208274841308594, "ViewRequirementAgentConnector_ms": 0.1978931427001953}, "num_episodes": 37, "episode_return_max": -5.27071785941698, "episode_return_min": -1434.277136506149, "episode_return_mean": -560.3310167916003, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.3969901522027, "num_env_steps_trained_throughput_per_sec": 321.3969901522027, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 12420.23, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12420.153, "sample_time_ms": 1135.476, "learn_time_ms": 11220.266, "learn_throughput": 356.498, "synch_weights_time_ms": 63.605}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "07142_00000", "date": "2024-08-04_10-27-03", "timestamp": 1722747423, "time_this_iter_s": 12.458222150802612, "time_total_s": 823.4884965419769, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f5d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 823.4884965419769, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.738888888888887, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 289.9767740805944, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.5391031920909883, "policy_loss": -0.0090518672290879, "vf_loss": 3.55522830846409, "vf_explained_var": 0.9651258655513326, "kl": 0.011644189339964821, "entropy": 1.4933073490858078, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": -5.27071785941698, "episode_reward_min": -1434.277136506149, "episode_reward_mean": -552.1787492455576, "episode_len_mean": 115.06, "episode_media": {}, "episodes_timesteps_total": 11506, "policy_reward_min": {"policy_0": -1434.277136506149}, "policy_reward_max": {"policy_0": -5.27071785941698}, "policy_reward_mean": {"policy_0": -552.1787492455576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-595.2720240970542, -37.81846404632636, -787.7597853721539, -662.1184951761815, -5.27071785941698, -173.486788131686, -224.89157165680405, -933.365822217198, -117.05633732808556, -678.4373472734378, -1073.4051496861996, -82.53279192694286, -380.65766665245445, -330.5376848473299, -117.65690612707739, -531.6470691295947, -1127.6425857946638, -173.9934502219162, -960.1904854443299, -177.1183137453963, -994.3778919069275, -798.2655976875327, -1222.6266475027994, -934.173583689377, -1159.9950482131999, -253.0293936015039, -1434.277136506149, -1055.462159941615, -118.98690262852526, -205.85559797057212, -1413.0536601962099, -787.9487933281785, -1114.364889717337, -425.0635917847243, -205.0404375084182, -633.4798228619003, -1131.1301370931699, -828.2571671674033, -529.2888862848204, -725.0582650119859, -153.12423455848267, -265.1557253432681, -158.77306193929323, -129.05918458993784, -1231.2426181920841, -465.9575471118534, -943.2965570345751, -734.9806003577022, -530.8101719897344, -290.00805576773234, -1118.5318480517044, -335.5889751921856, -157.81230669384368, -243.73404926523807, -67.99747912821584, -1090.3731622911337, -642.0198200441315, -899.229175707928, -790.664989609304, -135.16832881057294, -779.2416839397589, -13.526124958115764, -92.7827234985219, -63.20549170756175, -148.70549437037485, -83.17935070106192, -897.4424904948951, -572.2852407872931, -992.9653363402526, -852.7359691067356, -1205.408541083281, -134.42924449524074, -989.654044714728, -940.2250944295105, -383.0341612853873, -72.94963653819191, -28.819178601334464, -855.7302229379155, -1044.1850193376179, -235.5166193355421, -746.4889719757252, -924.7381613468393, -335.8399592910735, -218.56876302427568, -274.31700075721307, -117.04946842003655, -134.50668444965962, -95.27099592195853, -857.6953222266684, -917.2238310825776, -15.189772663059404, -137.04186314987098, -1093.2291440245976, -17.531763421496038, -574.3858328452943, -583.9041938242044, -60.09394403993652, -953.4485117499777, -1111.947564296853, -139.25854836559628], "episode_lengths": [150, 46, 150, 150, 36, 91, 71, 150, 75, 150, 150, 64, 131, 88, 74, 150, 150, 94, 150, 79, 150, 150, 150, 150, 150, 123, 150, 150, 66, 66, 150, 133, 150, 150, 85, 150, 150, 150, 150, 150, 57, 94, 82, 68, 150, 150, 150, 150, 125, 90, 150, 113, 82, 91, 49, 150, 150, 150, 150, 71, 150, 45, 64, 57, 76, 60, 150, 147, 150, 150, 150, 55, 150, 150, 150, 69, 33, 150, 150, 87, 142, 150, 85, 84, 120, 86, 60, 70, 150, 150, 38, 77, 150, 41, 129, 150, 55, 150, 150, 82], "policy_policy_0_reward": [-595.2720240970542, -37.81846404632636, -787.7597853721539, -662.1184951761815, -5.27071785941698, -173.486788131686, -224.89157165680405, -933.365822217198, -117.05633732808556, -678.4373472734378, -1073.4051496861996, -82.53279192694286, -380.65766665245445, -330.5376848473299, -117.65690612707739, -531.6470691295947, -1127.6425857946638, -173.9934502219162, -960.1904854443299, -177.1183137453963, -994.3778919069275, -798.2655976875327, -1222.6266475027994, -934.173583689377, -1159.9950482131999, -253.0293936015039, -1434.277136506149, -1055.462159941615, -118.98690262852526, -205.85559797057212, -1413.0536601962099, -787.9487933281785, -1114.364889717337, -425.0635917847243, -205.0404375084182, -633.4798228619003, -1131.1301370931699, -828.2571671674033, -529.2888862848204, -725.0582650119859, -153.12423455848267, -265.1557253432681, -158.77306193929323, -129.05918458993784, -1231.2426181920841, -465.9575471118534, -943.2965570345751, -734.9806003577022, -530.8101719897344, -290.00805576773234, -1118.5318480517044, -335.5889751921856, -157.81230669384368, -243.73404926523807, -67.99747912821584, -1090.3731622911337, -642.0198200441315, -899.229175707928, -790.664989609304, -135.16832881057294, -779.2416839397589, -13.526124958115764, -92.7827234985219, -63.20549170756175, -148.70549437037485, -83.17935070106192, -897.4424904948951, -572.2852407872931, -992.9653363402526, -852.7359691067356, -1205.408541083281, -134.42924449524074, -989.654044714728, -940.2250944295105, -383.0341612853873, -72.94963653819191, -28.819178601334464, -855.7302229379155, -1044.1850193376179, -235.5166193355421, -746.4889719757252, -924.7381613468393, -335.8399592910735, -218.56876302427568, -274.31700075721307, -117.04946842003655, -134.50668444965962, -95.27099592195853, -857.6953222266684, -917.2238310825776, -15.189772663059404, -137.04186314987098, -1093.2291440245976, -17.531763421496038, -574.3858328452943, -583.9041938242044, -60.09394403993652, -953.4485117499777, -1111.947564296853, -139.25854836559628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532733287563789, "mean_inference_ms": 1.6936847392547298, "mean_action_processing_ms": 0.2732093263785241, "mean_env_wait_ms": 3.4697032735930615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012848615646362305, "StateBufferConnector_ms": 0.008111000061035156, "ViewRequirementAgentConnector_ms": 0.19529342651367188}, "num_episodes": 32, "episode_return_max": -5.27071785941698, "episode_return_min": -1434.277136506149, "episode_return_mean": -552.1787492455576, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2473986348514, "num_env_steps_trained_throughput_per_sec": 310.2473986348514, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 12595.038, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12594.961, "sample_time_ms": 1128.871, "learn_time_ms": 11401.789, "learn_throughput": 350.822, "synch_weights_time_ms": 63.495}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "07142_00000", "date": "2024-08-04_10-27-16", "timestamp": 1722747436, "time_this_iter_s": 12.90609860420227, "time_total_s": 836.3945951461792, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724415000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 836.3945951461792, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.644444444444446, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 250.73495600422223, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.3587843740979832, "policy_loss": -0.013224148629039216, "vf_loss": 3.3797517141948146, "vf_explained_var": 0.9830936354895433, "kl": 0.012288038103330788, "entropy": 1.6037624035030604, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": -13.526124958115764, "episode_reward_min": -1432.7689257553805, "episode_reward_mean": -563.3569150173702, "episode_len_mean": 115.78, "episode_media": {}, "episodes_timesteps_total": 11578, "policy_reward_min": {"policy_0": -1432.7689257553805}, "policy_reward_max": {"policy_0": -13.526124958115764}, "policy_reward_mean": {"policy_0": -563.3569150173702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-633.4798228619003, -1131.1301370931699, -828.2571671674033, -529.2888862848204, -725.0582650119859, -153.12423455848267, -265.1557253432681, -158.77306193929323, -129.05918458993784, -1231.2426181920841, -465.9575471118534, -943.2965570345751, -734.9806003577022, -530.8101719897344, -290.00805576773234, -1118.5318480517044, -335.5889751921856, -157.81230669384368, -243.73404926523807, -67.99747912821584, -1090.3731622911337, -642.0198200441315, -899.229175707928, -790.664989609304, -135.16832881057294, -779.2416839397589, -13.526124958115764, -92.7827234985219, -63.20549170756175, -148.70549437037485, -83.17935070106192, -897.4424904948951, -572.2852407872931, -992.9653363402526, -852.7359691067356, -1205.408541083281, -134.42924449524074, -989.654044714728, -940.2250944295105, -383.0341612853873, -72.94963653819191, -28.819178601334464, -855.7302229379155, -1044.1850193376179, -235.5166193355421, -746.4889719757252, -924.7381613468393, -335.8399592910735, -218.56876302427568, -274.31700075721307, -117.04946842003655, -134.50668444965962, -95.27099592195853, -857.6953222266684, -917.2238310825776, -15.189772663059404, -137.04186314987098, -1093.2291440245976, -17.531763421496038, -574.3858328452943, -583.9041938242044, -60.09394403993652, -953.4485117499777, -1111.947564296853, -139.25854836559628, -457.68728536120716, -54.90440802071069, -160.63271613602325, -1148.360917810315, -128.72303041959987, -136.8406144323263, -217.1023357592588, -723.7037141757932, -592.9472645559192, -586.185772883051, -1317.6398379222246, -1017.3960863029572, -1361.4523572131827, -1020.6367178908122, -1363.912712189545, -266.5404099215679, -187.28161244749467, -1140.9142106463735, -1283.4378889905174, -98.80280312441432, -808.6528322152077, -53.64087884653725, -1432.7689257553805, -699.173798750277, -1082.9809933056865, -725.9392831426228, -968.4449673892359, -22.24955732611102, -782.8031124954821, -102.53361847256681, -200.9424157145646, -223.17419288413274, -854.1916187501905, -1011.4277543090991, -177.1707205381901], "episode_lengths": [150, 150, 150, 150, 150, 57, 94, 82, 68, 150, 150, 150, 150, 125, 90, 150, 113, 82, 91, 49, 150, 150, 150, 150, 71, 150, 45, 64, 57, 76, 60, 150, 147, 150, 150, 150, 55, 150, 150, 150, 69, 33, 150, 150, 87, 142, 150, 85, 84, 120, 86, 60, 70, 150, 150, 38, 77, 150, 41, 129, 150, 55, 150, 150, 82, 150, 47, 97, 150, 88, 74, 109, 150, 150, 150, 150, 150, 150, 150, 150, 124, 97, 150, 150, 73, 140, 36, 150, 150, 150, 150, 150, 36, 150, 64, 87, 85, 150, 150, 87], "policy_policy_0_reward": [-633.4798228619003, -1131.1301370931699, -828.2571671674033, -529.2888862848204, -725.0582650119859, -153.12423455848267, -265.1557253432681, -158.77306193929323, -129.05918458993784, -1231.2426181920841, -465.9575471118534, -943.2965570345751, -734.9806003577022, -530.8101719897344, -290.00805576773234, -1118.5318480517044, -335.5889751921856, -157.81230669384368, -243.73404926523807, -67.99747912821584, -1090.3731622911337, -642.0198200441315, -899.229175707928, -790.664989609304, -135.16832881057294, -779.2416839397589, -13.526124958115764, -92.7827234985219, -63.20549170756175, -148.70549437037485, -83.17935070106192, -897.4424904948951, -572.2852407872931, -992.9653363402526, -852.7359691067356, -1205.408541083281, -134.42924449524074, -989.654044714728, -940.2250944295105, -383.0341612853873, -72.94963653819191, -28.819178601334464, -855.7302229379155, -1044.1850193376179, -235.5166193355421, -746.4889719757252, -924.7381613468393, -335.8399592910735, -218.56876302427568, -274.31700075721307, -117.04946842003655, -134.50668444965962, -95.27099592195853, -857.6953222266684, -917.2238310825776, -15.189772663059404, -137.04186314987098, -1093.2291440245976, -17.531763421496038, -574.3858328452943, -583.9041938242044, -60.09394403993652, -953.4485117499777, -1111.947564296853, -139.25854836559628, -457.68728536120716, -54.90440802071069, -160.63271613602325, -1148.360917810315, -128.72303041959987, -136.8406144323263, -217.1023357592588, -723.7037141757932, -592.9472645559192, -586.185772883051, -1317.6398379222246, -1017.3960863029572, -1361.4523572131827, -1020.6367178908122, -1363.912712189545, -266.5404099215679, -187.28161244749467, -1140.9142106463735, -1283.4378889905174, -98.80280312441432, -808.6528322152077, -53.64087884653725, -1432.7689257553805, -699.173798750277, -1082.9809933056865, -725.9392831426228, -968.4449673892359, -22.24955732611102, -782.8031124954821, -102.53361847256681, -200.9424157145646, -223.17419288413274, -854.1916187501905, -1011.4277543090991, -177.1707205381901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535092099998107, "mean_inference_ms": 1.693567846343557, "mean_action_processing_ms": 0.2733039864840443, "mean_env_wait_ms": 3.4706890229226746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012762069702148438, "StateBufferConnector_ms": 0.008077144622802734, "ViewRequirementAgentConnector_ms": 0.1929326057434082}, "num_episodes": 35, "episode_return_max": -13.526124958115764, "episode_return_min": -1432.7689257553805, "episode_return_mean": -563.3569150173702, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7848310527583, "num_env_steps_trained_throughput_per_sec": 303.7848310527583, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 12591.084, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12591.008, "sample_time_ms": 1130.82, "learn_time_ms": 11396.117, "learn_throughput": 350.997, "synch_weights_time_ms": 63.256}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "07142_00000", "date": "2024-08-04_10-27-29", "timestamp": 1722747449, "time_this_iter_s": 13.179036378860474, "time_total_s": 849.5736315250397, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724161ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 849.5736315250397, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.673684210526318, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 248.74918005665143, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.509682876244187, "policy_loss": -0.011744143092558564, "vf_loss": 3.52435650502642, "vf_explained_var": 0.9887435502062242, "kl": 0.017427752228900317, "entropy": 1.4693214137107133, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": -6.619392199879426, "episode_reward_min": -1432.7689257553805, "episode_reward_mean": -561.0458021848832, "episode_len_mean": 114.28, "episode_media": {}, "episodes_timesteps_total": 11428, "policy_reward_min": {"policy_0": -1432.7689257553805}, "policy_reward_max": {"policy_0": -6.619392199879426}, "policy_reward_mean": {"policy_0": -561.0458021848832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.42924449524074, -989.654044714728, -940.2250944295105, -383.0341612853873, -72.94963653819191, -28.819178601334464, -855.7302229379155, -1044.1850193376179, -235.5166193355421, -746.4889719757252, -924.7381613468393, -335.8399592910735, -218.56876302427568, -274.31700075721307, -117.04946842003655, -134.50668444965962, -95.27099592195853, -857.6953222266684, -917.2238310825776, -15.189772663059404, -137.04186314987098, -1093.2291440245976, -17.531763421496038, -574.3858328452943, -583.9041938242044, -60.09394403993652, -953.4485117499777, -1111.947564296853, -139.25854836559628, -457.68728536120716, -54.90440802071069, -160.63271613602325, -1148.360917810315, -128.72303041959987, -136.8406144323263, -217.1023357592588, -723.7037141757932, -592.9472645559192, -586.185772883051, -1317.6398379222246, -1017.3960863029572, -1361.4523572131827, -1020.6367178908122, -1363.912712189545, -266.5404099215679, -187.28161244749467, -1140.9142106463735, -1283.4378889905174, -98.80280312441432, -808.6528322152077, -53.64087884653725, -1432.7689257553805, -699.173798750277, -1082.9809933056865, -725.9392831426228, -968.4449673892359, -22.24955732611102, -782.8031124954821, -102.53361847256681, -200.9424157145646, -223.17419288413274, -854.1916187501905, -1011.4277543090991, -177.1707205381901, -635.402646153533, -766.7900560215461, -1063.6015808249717, -265.8754644940532, -1013.5906643265085, -116.30635598356213, -93.8605318619624, -504.3569894432207, -1107.263412408076, -938.4917952786226, -1013.9252316949462, -130.539802953075, -1352.5884721486646, -269.05883500515137, -1006.2907821426505, -98.10140065762279, -1079.6205251621282, -120.65819811390871, -172.72721363370218, -881.09928092893, -650.621794793918, -6.619392199879426, -48.74990668689118, -170.05443181647945, -199.42374655899943, -1203.208447877835, -642.7996679175412, -823.452137254191, -862.4915391652289, -201.77061067401456, -14.875901806820615, -107.39915891670528, -47.83919167855913, -789.3172321686611, -165.60138237618693, -1136.7355527086117], "episode_lengths": [55, 150, 150, 150, 69, 33, 150, 150, 87, 142, 150, 85, 84, 120, 86, 60, 70, 150, 150, 38, 77, 150, 41, 129, 150, 55, 150, 150, 82, 150, 47, 97, 150, 88, 74, 109, 150, 150, 150, 150, 150, 150, 150, 150, 124, 97, 150, 150, 73, 140, 36, 150, 150, 150, 150, 150, 36, 150, 64, 87, 85, 150, 150, 87, 150, 150, 150, 93, 150, 75, 43, 112, 150, 150, 150, 89, 150, 92, 150, 77, 150, 73, 85, 150, 150, 43, 52, 93, 96, 150, 150, 150, 150, 94, 46, 71, 52, 150, 85, 150], "policy_policy_0_reward": [-134.42924449524074, -989.654044714728, -940.2250944295105, -383.0341612853873, -72.94963653819191, -28.819178601334464, -855.7302229379155, -1044.1850193376179, -235.5166193355421, -746.4889719757252, -924.7381613468393, -335.8399592910735, -218.56876302427568, -274.31700075721307, -117.04946842003655, -134.50668444965962, -95.27099592195853, -857.6953222266684, -917.2238310825776, -15.189772663059404, -137.04186314987098, -1093.2291440245976, -17.531763421496038, -574.3858328452943, -583.9041938242044, -60.09394403993652, -953.4485117499777, -1111.947564296853, -139.25854836559628, -457.68728536120716, -54.90440802071069, -160.63271613602325, -1148.360917810315, -128.72303041959987, -136.8406144323263, -217.1023357592588, -723.7037141757932, -592.9472645559192, -586.185772883051, -1317.6398379222246, -1017.3960863029572, -1361.4523572131827, -1020.6367178908122, -1363.912712189545, -266.5404099215679, -187.28161244749467, -1140.9142106463735, -1283.4378889905174, -98.80280312441432, -808.6528322152077, -53.64087884653725, -1432.7689257553805, -699.173798750277, -1082.9809933056865, -725.9392831426228, -968.4449673892359, -22.24955732611102, -782.8031124954821, -102.53361847256681, -200.9424157145646, -223.17419288413274, -854.1916187501905, -1011.4277543090991, -177.1707205381901, -635.402646153533, -766.7900560215461, -1063.6015808249717, -265.8754644940532, -1013.5906643265085, -116.30635598356213, -93.8605318619624, -504.3569894432207, -1107.263412408076, -938.4917952786226, -1013.9252316949462, -130.539802953075, -1352.5884721486646, -269.05883500515137, -1006.2907821426505, -98.10140065762279, -1079.6205251621282, -120.65819811390871, -172.72721363370218, -881.09928092893, -650.621794793918, -6.619392199879426, -48.74990668689118, -170.05443181647945, -199.42374655899943, -1203.208447877835, -642.7996679175412, -823.452137254191, -862.4915391652289, -201.77061067401456, -14.875901806820615, -107.39915891670528, -47.83919167855913, -789.3172321686611, -165.60138237618693, -1136.7355527086117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536661849329377, "mean_inference_ms": 1.6942070499375115, "mean_action_processing_ms": 0.27332417373873563, "mean_env_wait_ms": 3.4709508222911403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012395620346069336, "StateBufferConnector_ms": 0.007943153381347656, "ViewRequirementAgentConnector_ms": 0.19208765029907227}, "num_episodes": 36, "episode_return_max": -6.619392199879426, "episode_return_min": -1432.7689257553805, "episode_return_mean": -561.0458021848832, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.34223257192264, "num_env_steps_trained_throughput_per_sec": 308.34223257192264, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 12598.53, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12598.459, "sample_time_ms": 1128.781, "learn_time_ms": 11406.923, "learn_throughput": 350.664, "synch_weights_time_ms": 61.948}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "07142_00000", "date": "2024-08-04_10-27-42", "timestamp": 1722747462, "time_this_iter_s": 12.984200716018677, "time_total_s": 862.5578322410583, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724161cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 862.5578322410583, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.352631578947364, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 249.82846500674884, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.469699482743939, "policy_loss": -0.017113572832992457, "vf_loss": 3.493487761542201, "vf_explained_var": 0.9929005164032181, "kl": 0.014920887417611177, "entropy": 1.674629630893469, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": -6.619392199879426, "episode_reward_min": -1432.7689257553805, "episode_reward_mean": -618.9213916952325, "episode_len_mean": 119.52, "episode_media": {}, "episodes_timesteps_total": 11952, "policy_reward_min": {"policy_0": -1432.7689257553805}, "policy_reward_max": {"policy_0": -6.619392199879426}, "policy_reward_mean": {"policy_0": -618.9213916952325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.90440802071069, -160.63271613602325, -1148.360917810315, -128.72303041959987, -136.8406144323263, -217.1023357592588, -723.7037141757932, -592.9472645559192, -586.185772883051, -1317.6398379222246, -1017.3960863029572, -1361.4523572131827, -1020.6367178908122, -1363.912712189545, -266.5404099215679, -187.28161244749467, -1140.9142106463735, -1283.4378889905174, -98.80280312441432, -808.6528322152077, -53.64087884653725, -1432.7689257553805, -699.173798750277, -1082.9809933056865, -725.9392831426228, -968.4449673892359, -22.24955732611102, -782.8031124954821, -102.53361847256681, -200.9424157145646, -223.17419288413274, -854.1916187501905, -1011.4277543090991, -177.1707205381901, -635.402646153533, -766.7900560215461, -1063.6015808249717, -265.8754644940532, -1013.5906643265085, -116.30635598356213, -93.8605318619624, -504.3569894432207, -1107.263412408076, -938.4917952786226, -1013.9252316949462, -130.539802953075, -1352.5884721486646, -269.05883500515137, -1006.2907821426505, -98.10140065762279, -1079.6205251621282, -120.65819811390871, -172.72721363370218, -881.09928092893, -650.621794793918, -6.619392199879426, -48.74990668689118, -170.05443181647945, -199.42374655899943, -1203.208447877835, -642.7996679175412, -823.452137254191, -862.4915391652289, -201.77061067401456, -14.875901806820615, -107.39915891670528, -47.83919167855913, -789.3172321686611, -165.60138237618693, -1136.7355527086117, -680.6585202578517, -1219.0420719348708, -1110.2747221319703, -155.44532330570843, -1346.1026205092019, -1240.9630664209137, -179.37114491055775, -632.3128074939057, -166.68328580014597, -26.450042372783802, -183.38329035572713, -402.338769977667, -112.5439811983372, -1001.6364738392296, -1084.2837178229724, -1306.2036209235152, -85.25073921880828, -1267.414383023378, -729.4659234387968, -1060.6634120007088, -336.72519202958875, -607.4407795657842, -235.86641247782393, -75.93494743847187, -1278.6053368591297, -1194.801297444275, -679.05187997212, -546.0830055368752, -386.1708045449322, -906.352182142462], "episode_lengths": [47, 97, 150, 88, 74, 109, 150, 150, 150, 150, 150, 150, 150, 150, 124, 97, 150, 150, 73, 140, 36, 150, 150, 150, 150, 150, 36, 150, 64, 87, 85, 150, 150, 87, 150, 150, 150, 93, 150, 75, 43, 112, 150, 150, 150, 89, 150, 92, 150, 77, 150, 73, 85, 150, 150, 43, 52, 93, 96, 150, 150, 150, 150, 94, 46, 71, 52, 150, 85, 150, 150, 150, 150, 92, 150, 150, 79, 150, 80, 39, 77, 150, 80, 150, 150, 150, 73, 150, 150, 150, 126, 150, 84, 58, 150, 150, 150, 150, 149, 150], "policy_policy_0_reward": [-54.90440802071069, -160.63271613602325, -1148.360917810315, -128.72303041959987, -136.8406144323263, -217.1023357592588, -723.7037141757932, -592.9472645559192, -586.185772883051, -1317.6398379222246, -1017.3960863029572, -1361.4523572131827, -1020.6367178908122, -1363.912712189545, -266.5404099215679, -187.28161244749467, -1140.9142106463735, -1283.4378889905174, -98.80280312441432, -808.6528322152077, -53.64087884653725, -1432.7689257553805, -699.173798750277, -1082.9809933056865, -725.9392831426228, -968.4449673892359, -22.24955732611102, -782.8031124954821, -102.53361847256681, -200.9424157145646, -223.17419288413274, -854.1916187501905, -1011.4277543090991, -177.1707205381901, -635.402646153533, -766.7900560215461, -1063.6015808249717, -265.8754644940532, -1013.5906643265085, -116.30635598356213, -93.8605318619624, -504.3569894432207, -1107.263412408076, -938.4917952786226, -1013.9252316949462, -130.539802953075, -1352.5884721486646, -269.05883500515137, -1006.2907821426505, -98.10140065762279, -1079.6205251621282, -120.65819811390871, -172.72721363370218, -881.09928092893, -650.621794793918, -6.619392199879426, -48.74990668689118, -170.05443181647945, -199.42374655899943, -1203.208447877835, -642.7996679175412, -823.452137254191, -862.4915391652289, -201.77061067401456, -14.875901806820615, -107.39915891670528, -47.83919167855913, -789.3172321686611, -165.60138237618693, -1136.7355527086117, -680.6585202578517, -1219.0420719348708, -1110.2747221319703, -155.44532330570843, -1346.1026205092019, -1240.9630664209137, -179.37114491055775, -632.3128074939057, -166.68328580014597, -26.450042372783802, -183.38329035572713, -402.338769977667, -112.5439811983372, -1001.6364738392296, -1084.2837178229724, -1306.2036209235152, -85.25073921880828, -1267.414383023378, -729.4659234387968, -1060.6634120007088, -336.72519202958875, -607.4407795657842, -235.86641247782393, -75.93494743847187, -1278.6053368591297, -1194.801297444275, -679.05187997212, -546.0830055368752, -386.1708045449322, -906.352182142462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534269615943536, "mean_inference_ms": 1.6940316712215573, "mean_action_processing_ms": 0.273377357171243, "mean_env_wait_ms": 3.47150164810994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012469291687011719, "StateBufferConnector_ms": 0.007965087890625, "ViewRequirementAgentConnector_ms": 0.1925361156463623}, "num_episodes": 30, "episode_return_max": -6.619392199879426, "episode_return_min": -1432.7689257553805, "episode_return_mean": -618.9213916952325, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.0945533621998, "num_env_steps_trained_throughput_per_sec": 305.0945533621998, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 12606.78, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12606.71, "sample_time_ms": 1127.598, "learn_time_ms": 11417.5, "learn_throughput": 350.339, "synch_weights_time_ms": 60.822}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "07142_00000", "date": "2024-08-04_10-27-55", "timestamp": 1722747475, "time_this_iter_s": 13.124069452285767, "time_total_s": 875.6819016933441, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f6680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 875.6819016933441, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.63888888888889, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 242.08508463899295, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.41536254050831, "policy_loss": -0.006471745658685298, "vf_loss": 3.429196420808633, "vf_explained_var": 0.9837840018173059, "kl": 0.013039609021022212, "entropy": 1.6163877377907434, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": -6.065536803872648, "episode_reward_min": -1378.0167850657047, "episode_reward_mean": -564.8060071968498, "episode_len_mean": 115.78, "episode_media": {}, "episodes_timesteps_total": 11578, "policy_reward_min": {"policy_0": -1378.0167850657047}, "policy_reward_max": {"policy_0": -6.065536803872648}, "policy_reward_mean": {"policy_0": -564.8060071968498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1063.6015808249717, -265.8754644940532, -1013.5906643265085, -116.30635598356213, -93.8605318619624, -504.3569894432207, -1107.263412408076, -938.4917952786226, -1013.9252316949462, -130.539802953075, -1352.5884721486646, -269.05883500515137, -1006.2907821426505, -98.10140065762279, -1079.6205251621282, -120.65819811390871, -172.72721363370218, -881.09928092893, -650.621794793918, -6.619392199879426, -48.74990668689118, -170.05443181647945, -199.42374655899943, -1203.208447877835, -642.7996679175412, -823.452137254191, -862.4915391652289, -201.77061067401456, -14.875901806820615, -107.39915891670528, -47.83919167855913, -789.3172321686611, -165.60138237618693, -1136.7355527086117, -680.6585202578517, -1219.0420719348708, -1110.2747221319703, -155.44532330570843, -1346.1026205092019, -1240.9630664209137, -179.37114491055775, -632.3128074939057, -166.68328580014597, -26.450042372783802, -183.38329035572713, -402.338769977667, -112.5439811983372, -1001.6364738392296, -1084.2837178229724, -1306.2036209235152, -85.25073921880828, -1267.414383023378, -729.4659234387968, -1060.6634120007088, -336.72519202958875, -607.4407795657842, -235.86641247782393, -75.93494743847187, -1278.6053368591297, -1194.801297444275, -679.05187997212, -546.0830055368752, -386.1708045449322, -906.352182142462, -844.7086064128906, -503.72983460964457, -193.75133929013973, -562.5027368658082, -150.54795755249134, -755.5786244983908, -1129.3652461205868, -870.3935096647886, -146.64352442146637, -1031.204015398667, -44.58956981641161, -1093.5262584177033, -63.141964462588554, -1165.2349312529343, -1172.7572475894278, -152.69001308182678, -322.94901926766255, -133.87166223497258, -171.7588164091579, -6.065536803872648, -471.8439081834967, -103.39003106730243, -327.7171823770984, -53.57895201120816, -108.70531005735604, -925.4748547301955, -270.8524096037875, -594.8691949045765, -115.10770555598663, -880.9287456965021, -313.9985488522639, -427.20789135038495, -1378.0167850657047, -741.9200302195624, -132.1416086820269, -583.4007605453106], "episode_lengths": [150, 93, 150, 75, 43, 112, 150, 150, 150, 89, 150, 92, 150, 77, 150, 73, 85, 150, 150, 43, 52, 93, 96, 150, 150, 150, 150, 94, 46, 71, 52, 150, 85, 150, 150, 150, 150, 92, 150, 150, 79, 150, 80, 39, 77, 150, 80, 150, 150, 150, 73, 150, 150, 150, 126, 150, 84, 58, 150, 150, 150, 150, 149, 150, 150, 144, 103, 129, 103, 150, 150, 150, 84, 150, 51, 150, 50, 150, 150, 81, 80, 82, 69, 38, 150, 78, 85, 52, 71, 150, 87, 150, 67, 150, 105, 129, 150, 150, 82, 150], "policy_policy_0_reward": [-1063.6015808249717, -265.8754644940532, -1013.5906643265085, -116.30635598356213, -93.8605318619624, -504.3569894432207, -1107.263412408076, -938.4917952786226, -1013.9252316949462, -130.539802953075, -1352.5884721486646, -269.05883500515137, -1006.2907821426505, -98.10140065762279, -1079.6205251621282, -120.65819811390871, -172.72721363370218, -881.09928092893, -650.621794793918, -6.619392199879426, -48.74990668689118, -170.05443181647945, -199.42374655899943, -1203.208447877835, -642.7996679175412, -823.452137254191, -862.4915391652289, -201.77061067401456, -14.875901806820615, -107.39915891670528, -47.83919167855913, -789.3172321686611, -165.60138237618693, -1136.7355527086117, -680.6585202578517, -1219.0420719348708, -1110.2747221319703, -155.44532330570843, -1346.1026205092019, -1240.9630664209137, -179.37114491055775, -632.3128074939057, -166.68328580014597, -26.450042372783802, -183.38329035572713, -402.338769977667, -112.5439811983372, -1001.6364738392296, -1084.2837178229724, -1306.2036209235152, -85.25073921880828, -1267.414383023378, -729.4659234387968, -1060.6634120007088, -336.72519202958875, -607.4407795657842, -235.86641247782393, -75.93494743847187, -1278.6053368591297, -1194.801297444275, -679.05187997212, -546.0830055368752, -386.1708045449322, -906.352182142462, -844.7086064128906, -503.72983460964457, -193.75133929013973, -562.5027368658082, -150.54795755249134, -755.5786244983908, -1129.3652461205868, -870.3935096647886, -146.64352442146637, -1031.204015398667, -44.58956981641161, -1093.5262584177033, -63.141964462588554, -1165.2349312529343, -1172.7572475894278, -152.69001308182678, -322.94901926766255, -133.87166223497258, -171.7588164091579, -6.065536803872648, -471.8439081834967, -103.39003106730243, -327.7171823770984, -53.57895201120816, -108.70531005735604, -925.4748547301955, -270.8524096037875, -594.8691949045765, -115.10770555598663, -880.9287456965021, -313.9985488522639, -427.20789135038495, -1378.0167850657047, -741.9200302195624, -132.1416086820269, -583.4007605453106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535069885407738, "mean_inference_ms": 1.6932752879962436, "mean_action_processing_ms": 0.2731768358768821, "mean_env_wait_ms": 3.471092728381629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012279987335205078, "StateBufferConnector_ms": 0.008016347885131836, "ViewRequirementAgentConnector_ms": 0.19396495819091797}, "num_episodes": 36, "episode_return_max": -6.065536803872648, "episode_return_min": -1378.0167850657047, "episode_return_mean": -564.8060071968498, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.191127375942, "num_env_steps_trained_throughput_per_sec": 310.191127375942, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 12598.708, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12598.638, "sample_time_ms": 1126.937, "learn_time_ms": 11409.57, "learn_throughput": 350.583, "synch_weights_time_ms": 61.349}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "07142_00000", "date": "2024-08-04_10-28-08", "timestamp": 1722747488, "time_this_iter_s": 12.908100128173828, "time_total_s": 888.590001821518, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f72449a9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 888.590001821518, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.65263157894737, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 262.1819902439912, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.196088470270236, "policy_loss": -0.010282943440931074, "vf_loss": 3.2118897069245578, "vf_explained_var": 0.9928705824539066, "kl": 0.01683827297156313, "entropy": 1.6884119120736918, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -6.065536803872648, "episode_reward_min": -1378.0167850657047, "episode_reward_mean": -553.459553253183, "episode_len_mean": 115.55, "episode_media": {}, "episodes_timesteps_total": 11555, "policy_reward_min": {"policy_0": -1378.0167850657047}, "policy_reward_max": {"policy_0": -6.065536803872648}, "policy_reward_mean": {"policy_0": -553.459553253183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1110.2747221319703, -155.44532330570843, -1346.1026205092019, -1240.9630664209137, -179.37114491055775, -632.3128074939057, -166.68328580014597, -26.450042372783802, -183.38329035572713, -402.338769977667, -112.5439811983372, -1001.6364738392296, -1084.2837178229724, -1306.2036209235152, -85.25073921880828, -1267.414383023378, -729.4659234387968, -1060.6634120007088, -336.72519202958875, -607.4407795657842, -235.86641247782393, -75.93494743847187, -1278.6053368591297, -1194.801297444275, -679.05187997212, -546.0830055368752, -386.1708045449322, -906.352182142462, -844.7086064128906, -503.72983460964457, -193.75133929013973, -562.5027368658082, -150.54795755249134, -755.5786244983908, -1129.3652461205868, -870.3935096647886, -146.64352442146637, -1031.204015398667, -44.58956981641161, -1093.5262584177033, -63.141964462588554, -1165.2349312529343, -1172.7572475894278, -152.69001308182678, -322.94901926766255, -133.87166223497258, -171.7588164091579, -6.065536803872648, -471.8439081834967, -103.39003106730243, -327.7171823770984, -53.57895201120816, -108.70531005735604, -925.4748547301955, -270.8524096037875, -594.8691949045765, -115.10770555598663, -880.9287456965021, -313.9985488522639, -427.20789135038495, -1378.0167850657047, -741.9200302195624, -132.1416086820269, -583.4007605453106, -1372.9201861446486, -144.8756069880876, -1372.2193045303743, -160.46010940075462, -583.084358717227, -264.7035759955051, -689.4619190373451, -421.6793015269435, -907.7149650866772, -929.2821129044387, -175.5529715960288, -272.80157028961906, -470.91152527497235, -54.646875782098434, -856.1732395199116, -1185.7787302425534, -234.2758127880599, -174.9964090577835, -1224.1988162304012, -384.9799852475885, -123.48704866710895, -127.89316615629855, -1376.3485785288049, -233.66756731522133, -993.9193886476845, -96.85701920132405, -311.78670193112725, -51.81690605747099, -217.27296491512865, -746.0417687824677, -946.2344335647515, -286.44816125766374, -369.01696382456527, -1195.6567941496207, -62.443340057123315, -44.363650070946996], "episode_lengths": [150, 92, 150, 150, 79, 150, 80, 39, 77, 150, 80, 150, 150, 150, 73, 150, 150, 150, 126, 150, 84, 58, 150, 150, 150, 150, 149, 150, 150, 144, 103, 129, 103, 150, 150, 150, 84, 150, 51, 150, 50, 150, 150, 81, 80, 82, 69, 38, 150, 78, 85, 52, 71, 150, 87, 150, 67, 150, 105, 129, 150, 150, 82, 150, 150, 64, 150, 78, 142, 117, 150, 103, 150, 150, 100, 112, 140, 61, 150, 150, 111, 97, 150, 98, 79, 78, 150, 84, 150, 66, 108, 48, 87, 150, 150, 77, 128, 150, 67, 53], "policy_policy_0_reward": [-1110.2747221319703, -155.44532330570843, -1346.1026205092019, -1240.9630664209137, -179.37114491055775, -632.3128074939057, -166.68328580014597, -26.450042372783802, -183.38329035572713, -402.338769977667, -112.5439811983372, -1001.6364738392296, -1084.2837178229724, -1306.2036209235152, -85.25073921880828, -1267.414383023378, -729.4659234387968, -1060.6634120007088, -336.72519202958875, -607.4407795657842, -235.86641247782393, -75.93494743847187, -1278.6053368591297, -1194.801297444275, -679.05187997212, -546.0830055368752, -386.1708045449322, -906.352182142462, -844.7086064128906, -503.72983460964457, -193.75133929013973, -562.5027368658082, -150.54795755249134, -755.5786244983908, -1129.3652461205868, -870.3935096647886, -146.64352442146637, -1031.204015398667, -44.58956981641161, -1093.5262584177033, -63.141964462588554, -1165.2349312529343, -1172.7572475894278, -152.69001308182678, -322.94901926766255, -133.87166223497258, -171.7588164091579, -6.065536803872648, -471.8439081834967, -103.39003106730243, -327.7171823770984, -53.57895201120816, -108.70531005735604, -925.4748547301955, -270.8524096037875, -594.8691949045765, -115.10770555598663, -880.9287456965021, -313.9985488522639, -427.20789135038495, -1378.0167850657047, -741.9200302195624, -132.1416086820269, -583.4007605453106, -1372.9201861446486, -144.8756069880876, -1372.2193045303743, -160.46010940075462, -583.084358717227, -264.7035759955051, -689.4619190373451, -421.6793015269435, -907.7149650866772, -929.2821129044387, -175.5529715960288, -272.80157028961906, -470.91152527497235, -54.646875782098434, -856.1732395199116, -1185.7787302425534, -234.2758127880599, -174.9964090577835, -1224.1988162304012, -384.9799852475885, -123.48704866710895, -127.89316615629855, -1376.3485785288049, -233.66756731522133, -993.9193886476845, -96.85701920132405, -311.78670193112725, -51.81690605747099, -217.27296491512865, -746.0417687824677, -946.2344335647515, -286.44816125766374, -369.01696382456527, -1195.6567941496207, -62.443340057123315, -44.363650070946996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553414975562527, "mean_inference_ms": 1.6923478095005207, "mean_action_processing_ms": 0.27311366847375146, "mean_env_wait_ms": 3.4705746017547825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012510299682617188, "StateBufferConnector_ms": 0.008248329162597656, "ViewRequirementAgentConnector_ms": 0.19487404823303223}, "num_episodes": 36, "episode_return_max": -6.065536803872648, "episode_return_min": -1378.0167850657047, "episode_return_mean": -553.459553253183, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.8071697924761, "num_env_steps_trained_throughput_per_sec": 311.8071697924761, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 12568.043, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12567.972, "sample_time_ms": 1121.49, "learn_time_ms": 11384.363, "learn_throughput": 351.359, "synch_weights_time_ms": 61.305}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "07142_00000", "date": "2024-08-04_10-28-21", "timestamp": 1722747501, "time_this_iter_s": 12.839966297149658, "time_total_s": 901.4299681186676, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7244992d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 901.4299681186676, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.52222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 311.47260076204935, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.695877231905858, "policy_loss": -0.00885027515081068, "vf_loss": 3.7117679598430793, "vf_explained_var": 0.9860724257926147, "kl": 0.013622059496022666, "entropy": 1.623534957692027, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": -6.065536803872648, "episode_reward_min": -1378.0167850657047, "episode_reward_mean": -557.5123599056803, "episode_len_mean": 114.34, "episode_media": {}, "episodes_timesteps_total": 11434, "policy_reward_min": {"policy_0": -1378.0167850657047}, "policy_reward_max": {"policy_0": -6.065536803872648}, "policy_reward_mean": {"policy_0": -557.5123599056803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-755.5786244983908, -1129.3652461205868, -870.3935096647886, -146.64352442146637, -1031.204015398667, -44.58956981641161, -1093.5262584177033, -63.141964462588554, -1165.2349312529343, -1172.7572475894278, -152.69001308182678, -322.94901926766255, -133.87166223497258, -171.7588164091579, -6.065536803872648, -471.8439081834967, -103.39003106730243, -327.7171823770984, -53.57895201120816, -108.70531005735604, -925.4748547301955, -270.8524096037875, -594.8691949045765, -115.10770555598663, -880.9287456965021, -313.9985488522639, -427.20789135038495, -1378.0167850657047, -741.9200302195624, -132.1416086820269, -583.4007605453106, -1372.9201861446486, -144.8756069880876, -1372.2193045303743, -160.46010940075462, -583.084358717227, -264.7035759955051, -689.4619190373451, -421.6793015269435, -907.7149650866772, -929.2821129044387, -175.5529715960288, -272.80157028961906, -470.91152527497235, -54.646875782098434, -856.1732395199116, -1185.7787302425534, -234.2758127880599, -174.9964090577835, -1224.1988162304012, -384.9799852475885, -123.48704866710895, -127.89316615629855, -1376.3485785288049, -233.66756731522133, -993.9193886476845, -96.85701920132405, -311.78670193112725, -51.81690605747099, -217.27296491512865, -746.0417687824677, -946.2344335647515, -286.44816125766374, -369.01696382456527, -1195.6567941496207, -62.443340057123315, -44.363650070946996, -197.7371312422942, -165.41744152146643, -735.4498907676295, -99.32063476033198, -360.4994914122792, -1026.0643152186162, -585.6267680089221, -1117.3862933711707, -1190.7913011992712, -238.56012470032036, -1154.9812325025327, -1174.9702090597941, -281.32245132357946, -310.3830946907435, -1038.330864779668, -475.3944516731145, -474.68627161098317, -32.618714461302716, -895.504607770947, -326.6977109735556, -1167.5798268263504, -450.49799440363046, -827.8271155602225, -784.2059354667024, -743.4572769888725, -253.56214380216718, -859.9890379162349, -140.9225025424346, -36.35362896892452, -1311.8239318050487, -488.34674358684856, -1098.097260325478, -953.9339034950455], "episode_lengths": [150, 150, 150, 84, 150, 51, 150, 50, 150, 150, 81, 80, 82, 69, 38, 150, 78, 85, 52, 71, 150, 87, 150, 67, 150, 105, 129, 150, 150, 82, 150, 150, 64, 150, 78, 142, 117, 150, 103, 150, 150, 100, 112, 140, 61, 150, 150, 111, 97, 150, 98, 79, 78, 150, 84, 150, 66, 108, 48, 87, 150, 150, 77, 128, 150, 67, 53, 94, 67, 127, 61, 131, 150, 150, 150, 150, 108, 150, 150, 105, 103, 150, 136, 111, 39, 150, 85, 150, 136, 150, 150, 150, 70, 150, 65, 46, 150, 111, 150, 150], "policy_policy_0_reward": [-755.5786244983908, -1129.3652461205868, -870.3935096647886, -146.64352442146637, -1031.204015398667, -44.58956981641161, -1093.5262584177033, -63.141964462588554, -1165.2349312529343, -1172.7572475894278, -152.69001308182678, -322.94901926766255, -133.87166223497258, -171.7588164091579, -6.065536803872648, -471.8439081834967, -103.39003106730243, -327.7171823770984, -53.57895201120816, -108.70531005735604, -925.4748547301955, -270.8524096037875, -594.8691949045765, -115.10770555598663, -880.9287456965021, -313.9985488522639, -427.20789135038495, -1378.0167850657047, -741.9200302195624, -132.1416086820269, -583.4007605453106, -1372.9201861446486, -144.8756069880876, -1372.2193045303743, -160.46010940075462, -583.084358717227, -264.7035759955051, -689.4619190373451, -421.6793015269435, -907.7149650866772, -929.2821129044387, -175.5529715960288, -272.80157028961906, -470.91152527497235, -54.646875782098434, -856.1732395199116, -1185.7787302425534, -234.2758127880599, -174.9964090577835, -1224.1988162304012, -384.9799852475885, -123.48704866710895, -127.89316615629855, -1376.3485785288049, -233.66756731522133, -993.9193886476845, -96.85701920132405, -311.78670193112725, -51.81690605747099, -217.27296491512865, -746.0417687824677, -946.2344335647515, -286.44816125766374, -369.01696382456527, -1195.6567941496207, -62.443340057123315, -44.363650070946996, -197.7371312422942, -165.41744152146643, -735.4498907676295, -99.32063476033198, -360.4994914122792, -1026.0643152186162, -585.6267680089221, -1117.3862933711707, -1190.7913011992712, -238.56012470032036, -1154.9812325025327, -1174.9702090597941, -281.32245132357946, -310.3830946907435, -1038.330864779668, -475.3944516731145, -474.68627161098317, -32.618714461302716, -895.504607770947, -326.6977109735556, -1167.5798268263504, -450.49799440363046, -827.8271155602225, -784.2059354667024, -743.4572769888725, -253.56214380216718, -859.9890379162349, -140.9225025424346, -36.35362896892452, -1311.8239318050487, -488.34674358684856, -1098.097260325478, -953.9339034950455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533584189174197, "mean_inference_ms": 1.6919500558011868, "mean_action_processing_ms": 0.2732638411860438, "mean_env_wait_ms": 3.4698375113307507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012407779693603516, "StateBufferConnector_ms": 0.008398771286010742, "ViewRequirementAgentConnector_ms": 0.19533467292785645}, "num_episodes": 33, "episode_return_max": -6.065536803872648, "episode_return_min": -1378.0167850657047, "episode_return_mean": -557.5123599056803, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6216601015736, "num_env_steps_trained_throughput_per_sec": 308.6216601015736, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 12534.726, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12534.657, "sample_time_ms": 1122.336, "learn_time_ms": 11350.407, "learn_throughput": 352.41, "synch_weights_time_ms": 61.101}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "07142_00000", "date": "2024-08-04_10-28-34", "timestamp": 1722747514, "time_this_iter_s": 12.973068475723267, "time_total_s": 914.4030365943909, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f6680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 914.4030365943909, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 18.105555555555554, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 277.06456438302996, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.536203905691703, "policy_loss": -0.01362400204767861, "vf_loss": 3.5616232975075643, "vf_explained_var": 0.9743866042544445, "kl": 0.01191462127820469, "entropy": 1.9837767818321785, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": -13.022577374179075, "episode_reward_min": -1376.3485785288049, "episode_reward_mean": -610.1013720960207, "episode_len_mean": 118.23, "episode_media": {}, "episodes_timesteps_total": 11823, "policy_reward_min": {"policy_0": -1376.3485785288049}, "policy_reward_max": {"policy_0": -13.022577374179075}, "policy_reward_mean": {"policy_0": -610.1013720960207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.46010940075462, -583.084358717227, -264.7035759955051, -689.4619190373451, -421.6793015269435, -907.7149650866772, -929.2821129044387, -175.5529715960288, -272.80157028961906, -470.91152527497235, -54.646875782098434, -856.1732395199116, -1185.7787302425534, -234.2758127880599, -174.9964090577835, -1224.1988162304012, -384.9799852475885, -123.48704866710895, -127.89316615629855, -1376.3485785288049, -233.66756731522133, -993.9193886476845, -96.85701920132405, -311.78670193112725, -51.81690605747099, -217.27296491512865, -746.0417687824677, -946.2344335647515, -286.44816125766374, -369.01696382456527, -1195.6567941496207, -62.443340057123315, -44.363650070946996, -197.7371312422942, -165.41744152146643, -735.4498907676295, -99.32063476033198, -360.4994914122792, -1026.0643152186162, -585.6267680089221, -1117.3862933711707, -1190.7913011992712, -238.56012470032036, -1154.9812325025327, -1174.9702090597941, -281.32245132357946, -310.3830946907435, -1038.330864779668, -475.3944516731145, -474.68627161098317, -32.618714461302716, -895.504607770947, -326.6977109735556, -1167.5798268263504, -450.49799440363046, -827.8271155602225, -784.2059354667024, -743.4572769888725, -253.56214380216718, -859.9890379162349, -140.9225025424346, -36.35362896892452, -1311.8239318050487, -488.34674358684856, -1098.097260325478, -953.9339034950455, -1127.0029250228088, -122.08842555151503, -1117.738856603308, -1127.593656182591, -32.89219871823933, -638.2534782458188, -13.022577374179075, -765.4241634998227, -1081.3889451688042, -1230.6516803421198, -96.79683199994605, -298.27332971209603, -1056.5317671227876, -465.01058071206586, -283.6383850897516, -1352.1516199020014, -858.8374523934854, -1242.3941210169974, -975.223347813311, -524.8262345418431, -1173.2828687590809, -678.221756180358, -911.628560044216, -160.00416633165585, -317.15162576732814, -1027.8602260073433, -1026.1348657228968, -1167.5980695991882, -756.4507861045662, -184.3520774105508, -30.87145886869312, -1221.5461315067005, -81.8791804489733, -691.1178252753153], "episode_lengths": [78, 142, 117, 150, 103, 150, 150, 100, 112, 140, 61, 150, 150, 111, 97, 150, 98, 79, 78, 150, 84, 150, 66, 108, 48, 87, 150, 150, 77, 128, 150, 67, 53, 94, 67, 127, 61, 131, 150, 150, 150, 150, 108, 150, 150, 105, 103, 150, 136, 111, 39, 150, 85, 150, 136, 150, 150, 150, 70, 150, 65, 46, 150, 111, 150, 150, 150, 65, 150, 150, 46, 130, 36, 150, 150, 150, 67, 112, 150, 150, 94, 150, 150, 150, 150, 150, 150, 132, 150, 73, 82, 150, 150, 150, 150, 85, 35, 150, 60, 127], "policy_policy_0_reward": [-160.46010940075462, -583.084358717227, -264.7035759955051, -689.4619190373451, -421.6793015269435, -907.7149650866772, -929.2821129044387, -175.5529715960288, -272.80157028961906, -470.91152527497235, -54.646875782098434, -856.1732395199116, -1185.7787302425534, -234.2758127880599, -174.9964090577835, -1224.1988162304012, -384.9799852475885, -123.48704866710895, -127.89316615629855, -1376.3485785288049, -233.66756731522133, -993.9193886476845, -96.85701920132405, -311.78670193112725, -51.81690605747099, -217.27296491512865, -746.0417687824677, -946.2344335647515, -286.44816125766374, -369.01696382456527, -1195.6567941496207, -62.443340057123315, -44.363650070946996, -197.7371312422942, -165.41744152146643, -735.4498907676295, -99.32063476033198, -360.4994914122792, -1026.0643152186162, -585.6267680089221, -1117.3862933711707, -1190.7913011992712, -238.56012470032036, -1154.9812325025327, -1174.9702090597941, -281.32245132357946, -310.3830946907435, -1038.330864779668, -475.3944516731145, -474.68627161098317, -32.618714461302716, -895.504607770947, -326.6977109735556, -1167.5798268263504, -450.49799440363046, -827.8271155602225, -784.2059354667024, -743.4572769888725, -253.56214380216718, -859.9890379162349, -140.9225025424346, -36.35362896892452, -1311.8239318050487, -488.34674358684856, -1098.097260325478, -953.9339034950455, -1127.0029250228088, -122.08842555151503, -1117.738856603308, -1127.593656182591, -32.89219871823933, -638.2534782458188, -13.022577374179075, -765.4241634998227, -1081.3889451688042, -1230.6516803421198, -96.79683199994605, -298.27332971209603, -1056.5317671227876, -465.01058071206586, -283.6383850897516, -1352.1516199020014, -858.8374523934854, -1242.3941210169974, -975.223347813311, -524.8262345418431, -1173.2828687590809, -678.221756180358, -911.628560044216, -160.00416633165585, -317.15162576732814, -1027.8602260073433, -1026.1348657228968, -1167.5980695991882, -756.4507861045662, -184.3520774105508, -30.87145886869312, -1221.5461315067005, -81.8791804489733, -691.1178252753153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533783528733932, "mean_inference_ms": 1.6923921677831644, "mean_action_processing_ms": 0.27323528225729743, "mean_env_wait_ms": 3.471007203159937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012146472930908203, "StateBufferConnector_ms": 0.008324384689331055, "ViewRequirementAgentConnector_ms": 0.19940400123596191}, "num_episodes": 34, "episode_return_max": -13.022577374179075, "episode_return_min": -1376.3485785288049, "episode_return_mean": -610.1013720960207, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.8769339800767, "num_env_steps_trained_throughput_per_sec": 303.8769339800767, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 12776.752, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12776.683, "sample_time_ms": 1130.593, "learn_time_ms": 11582.89, "learn_throughput": 345.337, "synch_weights_time_ms": 62.375}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "07142_00000", "date": "2024-08-04_10-28-47", "timestamp": 1722747527, "time_this_iter_s": 13.175657749176025, "time_total_s": 927.5786943435669, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724160c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 927.5786943435669, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 18.263157894736842, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 244.73544397950172, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.9465828644732635, "policy_loss": -0.011262394294317347, "vf_loss": 3.961853395154079, "vf_explained_var": 0.9697470748176177, "kl": 0.016258958051124258, "entropy": 1.4982937979201476, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": -13.022577374179075, "episode_reward_min": -1352.1516199020014, "episode_reward_mean": -621.7643436530138, "episode_len_mean": 119.97, "episode_media": {}, "episodes_timesteps_total": 11997, "policy_reward_min": {"policy_0": -1352.1516199020014}, "policy_reward_max": {"policy_0": -13.022577374179075}, "policy_reward_mean": {"policy_0": -621.7643436530138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.443340057123315, -44.363650070946996, -197.7371312422942, -165.41744152146643, -735.4498907676295, -99.32063476033198, -360.4994914122792, -1026.0643152186162, -585.6267680089221, -1117.3862933711707, -1190.7913011992712, -238.56012470032036, -1154.9812325025327, -1174.9702090597941, -281.32245132357946, -310.3830946907435, -1038.330864779668, -475.3944516731145, -474.68627161098317, -32.618714461302716, -895.504607770947, -326.6977109735556, -1167.5798268263504, -450.49799440363046, -827.8271155602225, -784.2059354667024, -743.4572769888725, -253.56214380216718, -859.9890379162349, -140.9225025424346, -36.35362896892452, -1311.8239318050487, -488.34674358684856, -1098.097260325478, -953.9339034950455, -1127.0029250228088, -122.08842555151503, -1117.738856603308, -1127.593656182591, -32.89219871823933, -638.2534782458188, -13.022577374179075, -765.4241634998227, -1081.3889451688042, -1230.6516803421198, -96.79683199994605, -298.27332971209603, -1056.5317671227876, -465.01058071206586, -283.6383850897516, -1352.1516199020014, -858.8374523934854, -1242.3941210169974, -975.223347813311, -524.8262345418431, -1173.2828687590809, -678.221756180358, -911.628560044216, -160.00416633165585, -317.15162576732814, -1027.8602260073433, -1026.1348657228968, -1167.5980695991882, -756.4507861045662, -184.3520774105508, -30.87145886869312, -1221.5461315067005, -81.8791804489733, -691.1178252753153, -1100.0431212468477, -550.4267642553718, -1028.394623343933, -985.5745370873788, -550.4135133731057, -831.0799454465287, -710.6266552921039, -115.6895245665887, -62.46892167814304, -742.268462623578, -113.03066962562539, -440.2222784377198, -945.8711684532634, -833.1488006153268, -83.19307481842596, -100.44881217382061, -1172.6580654494383, -186.1103880535207, -582.3335644587386, -545.1286837089392, -223.56153982881733, -164.8744486080737, -412.3205225831167, -959.0262982271239, -123.28308283898428, -188.99594234071472, -588.9043462303163, -1224.3165366732662, -314.63093575667335, -983.4323697226231, -370.9692998783662], "episode_lengths": [67, 53, 94, 67, 127, 61, 131, 150, 150, 150, 150, 108, 150, 150, 105, 103, 150, 136, 111, 39, 150, 85, 150, 136, 150, 150, 150, 70, 150, 65, 46, 150, 111, 150, 150, 150, 65, 150, 150, 46, 130, 36, 150, 150, 150, 67, 112, 150, 150, 94, 150, 150, 150, 150, 150, 150, 132, 150, 73, 82, 150, 150, 150, 150, 85, 35, 150, 60, 127, 150, 150, 150, 150, 150, 150, 137, 71, 58, 150, 64, 125, 150, 150, 61, 60, 150, 98, 150, 117, 82, 105, 150, 150, 75, 107, 150, 150, 89, 150, 89], "policy_policy_0_reward": [-62.443340057123315, -44.363650070946996, -197.7371312422942, -165.41744152146643, -735.4498907676295, -99.32063476033198, -360.4994914122792, -1026.0643152186162, -585.6267680089221, -1117.3862933711707, -1190.7913011992712, -238.56012470032036, -1154.9812325025327, -1174.9702090597941, -281.32245132357946, -310.3830946907435, -1038.330864779668, -475.3944516731145, -474.68627161098317, -32.618714461302716, -895.504607770947, -326.6977109735556, -1167.5798268263504, -450.49799440363046, -827.8271155602225, -784.2059354667024, -743.4572769888725, -253.56214380216718, -859.9890379162349, -140.9225025424346, -36.35362896892452, -1311.8239318050487, -488.34674358684856, -1098.097260325478, -953.9339034950455, -1127.0029250228088, -122.08842555151503, -1117.738856603308, -1127.593656182591, -32.89219871823933, -638.2534782458188, -13.022577374179075, -765.4241634998227, -1081.3889451688042, -1230.6516803421198, -96.79683199994605, -298.27332971209603, -1056.5317671227876, -465.01058071206586, -283.6383850897516, -1352.1516199020014, -858.8374523934854, -1242.3941210169974, -975.223347813311, -524.8262345418431, -1173.2828687590809, -678.221756180358, -911.628560044216, -160.00416633165585, -317.15162576732814, -1027.8602260073433, -1026.1348657228968, -1167.5980695991882, -756.4507861045662, -184.3520774105508, -30.87145886869312, -1221.5461315067005, -81.8791804489733, -691.1178252753153, -1100.0431212468477, -550.4267642553718, -1028.394623343933, -985.5745370873788, -550.4135133731057, -831.0799454465287, -710.6266552921039, -115.6895245665887, -62.46892167814304, -742.268462623578, -113.03066962562539, -440.2222784377198, -945.8711684532634, -833.1488006153268, -83.19307481842596, -100.44881217382061, -1172.6580654494383, -186.1103880535207, -582.3335644587386, -545.1286837089392, -223.56153982881733, -164.8744486080737, -412.3205225831167, -959.0262982271239, -123.28308283898428, -188.99594234071472, -588.9043462303163, -1224.3165366732662, -314.63093575667335, -983.4323697226231, -370.9692998783662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531719745089342, "mean_inference_ms": 1.6913249510753423, "mean_action_processing_ms": 0.2735046384008663, "mean_env_wait_ms": 3.471549405607626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012121915817260742, "StateBufferConnector_ms": 0.00809335708618164, "ViewRequirementAgentConnector_ms": 0.19842123985290527}, "num_episodes": 31, "episode_return_max": -13.022577374179075, "episode_return_min": -1352.1516199020014, "episode_return_mean": -621.7643436530138, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.29451150375155, "num_env_steps_trained_throughput_per_sec": 340.29451150375155, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 12819.155, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12819.088, "sample_time_ms": 1133.385, "learn_time_ms": 11621.711, "learn_throughput": 344.183, "synch_weights_time_ms": 63.162}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "07142_00000", "date": "2024-08-04_10-28-59", "timestamp": 1722747539, "time_this_iter_s": 11.766814470291138, "time_total_s": 939.345508813858, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f724163370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 939.345508813858, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 19.211764705882356, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 234.9514795223872, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.896492851898074, "policy_loss": -0.013215616141678765, "vf_loss": 3.918359329427282, "vf_explained_var": 0.9789824845269323, "kl": 0.012934778079246286, "entropy": 1.738184750204285, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": -13.022577374179075, "episode_reward_min": -1352.1516199020014, "episode_reward_mean": -603.9254273057576, "episode_len_mean": 120.02, "episode_media": {}, "episodes_timesteps_total": 12002, "policy_reward_min": {"policy_0": -1352.1516199020014}, "policy_reward_max": {"policy_0": -13.022577374179075}, "policy_reward_mean": {"policy_0": -603.9254273057576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1127.0029250228088, -122.08842555151503, -1117.738856603308, -1127.593656182591, -32.89219871823933, -638.2534782458188, -13.022577374179075, -765.4241634998227, -1081.3889451688042, -1230.6516803421198, -96.79683199994605, -298.27332971209603, -1056.5317671227876, -465.01058071206586, -283.6383850897516, -1352.1516199020014, -858.8374523934854, -1242.3941210169974, -975.223347813311, -524.8262345418431, -1173.2828687590809, -678.221756180358, -911.628560044216, -160.00416633165585, -317.15162576732814, -1027.8602260073433, -1026.1348657228968, -1167.5980695991882, -756.4507861045662, -184.3520774105508, -30.87145886869312, -1221.5461315067005, -81.8791804489733, -691.1178252753153, -1100.0431212468477, -550.4267642553718, -1028.394623343933, -985.5745370873788, -550.4135133731057, -831.0799454465287, -710.6266552921039, -115.6895245665887, -62.46892167814304, -742.268462623578, -113.03066962562539, -440.2222784377198, -945.8711684532634, -833.1488006153268, -83.19307481842596, -100.44881217382061, -1172.6580654494383, -186.1103880535207, -582.3335644587386, -545.1286837089392, -223.56153982881733, -164.8744486080737, -412.3205225831167, -959.0262982271239, -123.28308283898428, -188.99594234071472, -588.9043462303163, -1224.3165366732662, -314.63093575667335, -983.4323697226231, -370.9692998783662, -684.2376221948867, -997.8779090921238, -561.3411951803041, -948.5833277493274, -84.90351863074211, -688.2944397886629, -732.2011834859176, -1291.6618524857167, -89.97061846136957, -659.2186754685592, -691.7165076958205, -167.61797717266526, -873.1988845342812, -145.14513878374186, -172.24169305508389, -1053.9738833309782, -307.96619579601656, -686.8127490411729, -107.62044747048056, -188.60743953612598, -972.3664537800669, -60.831430336564516, -578.5672195952192, -179.3232309039298, -417.55245258303876, -1140.1024400196222, -327.009469470418, -1112.8268590802682, -224.7068096234957, -1256.4884323844271, -384.2346922121666, -94.3170374516167, -105.11077203929254, -926.441900862373, -408.1851988424477], "episode_lengths": [150, 65, 150, 150, 46, 130, 36, 150, 150, 150, 67, 112, 150, 150, 94, 150, 150, 150, 150, 150, 150, 132, 150, 73, 82, 150, 150, 150, 150, 85, 35, 150, 60, 127, 150, 150, 150, 150, 150, 150, 137, 71, 58, 150, 64, 125, 150, 150, 61, 60, 150, 98, 150, 117, 82, 105, 150, 150, 75, 107, 150, 150, 89, 150, 89, 150, 150, 150, 150, 61, 150, 134, 150, 48, 150, 150, 58, 150, 70, 82, 150, 105, 150, 68, 87, 150, 57, 150, 105, 150, 150, 112, 150, 77, 150, 136, 64, 53, 150, 103], "policy_policy_0_reward": [-1127.0029250228088, -122.08842555151503, -1117.738856603308, -1127.593656182591, -32.89219871823933, -638.2534782458188, -13.022577374179075, -765.4241634998227, -1081.3889451688042, -1230.6516803421198, -96.79683199994605, -298.27332971209603, -1056.5317671227876, -465.01058071206586, -283.6383850897516, -1352.1516199020014, -858.8374523934854, -1242.3941210169974, -975.223347813311, -524.8262345418431, -1173.2828687590809, -678.221756180358, -911.628560044216, -160.00416633165585, -317.15162576732814, -1027.8602260073433, -1026.1348657228968, -1167.5980695991882, -756.4507861045662, -184.3520774105508, -30.87145886869312, -1221.5461315067005, -81.8791804489733, -691.1178252753153, -1100.0431212468477, -550.4267642553718, -1028.394623343933, -985.5745370873788, -550.4135133731057, -831.0799454465287, -710.6266552921039, -115.6895245665887, -62.46892167814304, -742.268462623578, -113.03066962562539, -440.2222784377198, -945.8711684532634, -833.1488006153268, -83.19307481842596, -100.44881217382061, -1172.6580654494383, -186.1103880535207, -582.3335644587386, -545.1286837089392, -223.56153982881733, -164.8744486080737, -412.3205225831167, -959.0262982271239, -123.28308283898428, -188.99594234071472, -588.9043462303163, -1224.3165366732662, -314.63093575667335, -983.4323697226231, -370.9692998783662, -684.2376221948867, -997.8779090921238, -561.3411951803041, -948.5833277493274, -84.90351863074211, -688.2944397886629, -732.2011834859176, -1291.6618524857167, -89.97061846136957, -659.2186754685592, -691.7165076958205, -167.61797717266526, -873.1988845342812, -145.14513878374186, -172.24169305508389, -1053.9738833309782, -307.96619579601656, -686.8127490411729, -107.62044747048056, -188.60743953612598, -972.3664537800669, -60.831430336564516, -578.5672195952192, -179.3232309039298, -417.55245258303876, -1140.1024400196222, -327.009469470418, -1112.8268590802682, -224.7068096234957, -1256.4884323844271, -384.2346922121666, -94.3170374516167, -105.11077203929254, -926.441900862373, -408.1851988424477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535006440729846, "mean_inference_ms": 1.6914321752008004, "mean_action_processing_ms": 0.2733706573336257, "mean_env_wait_ms": 3.470321379122563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012224435806274414, "StateBufferConnector_ms": 0.007978439331054688, "ViewRequirementAgentConnector_ms": 0.1985480785369873}, "num_episodes": 35, "episode_return_max": -13.022577374179075, "episode_return_min": -1352.1516199020014, "episode_return_mean": -603.9254273057576, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.03198477364094, "num_env_steps_trained_throughput_per_sec": 306.03198477364094, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 12881.641, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12881.571, "sample_time_ms": 1136.832, "learn_time_ms": 11682.067, "learn_throughput": 342.405, "synch_weights_time_ms": 61.846}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "07142_00000", "date": "2024-08-04_10-29-12", "timestamp": 1722747552, "time_this_iter_s": 13.084027290344238, "time_total_s": 952.4295361042023, "pid": 621849, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x70f7240f6560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 952.4295361042023, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.468421052631577, "ram_util_percent": 28.3}}
