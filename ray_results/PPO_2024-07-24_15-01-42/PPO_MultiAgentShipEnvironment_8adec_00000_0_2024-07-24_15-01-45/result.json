{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8915708335426946, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.748200075825055, "policy_loss": -0.008841444950182147, "vf_loss": 9.768922427296639, "vf_explained_var": 0.002922644466161728, "kl": 0.01056502021790493, "entropy": 1.3993916557480892, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -179.61030557727614, "episode_reward_min": -1334.54070553279, "episode_reward_mean": -827.8030656288231, "episode_len_mean": 140.04761904761904, "episode_media": {}, "episodes_timesteps_total": 2941, "policy_reward_min": {"policy_0": -1334.54070553279}, "policy_reward_max": {"policy_0": -179.61030557727614}, "policy_reward_mean": {"policy_0": -827.8030656288231}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-426.87944752722467, -941.423700712548, -1334.54070553279, -1315.111657759418, -991.2757435114045, -1281.644247501357, -855.8220403602063, -457.32503805278566, -279.8413205742187, -992.39582029232, -179.61030557727614, -1055.407396097296, -1234.1814121063023, -893.2033808703247, -871.8366350742033, -778.3767559761551, -735.0999112261395, -778.20447094446, -761.6177593128444, -804.4180022743774, -415.64862692163234], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 102, 78, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-426.87944752722467, -941.423700712548, -1334.54070553279, -1315.111657759418, -991.2757435114045, -1281.644247501357, -855.8220403602063, -457.32503805278566, -279.8413205742187, -992.39582029232, -179.61030557727614, -1055.407396097296, -1234.1814121063023, -893.2033808703247, -871.8366350742033, -778.3767559761551, -735.0999112261395, -778.20447094446, -761.6177593128444, -804.4180022743774, -415.64862692163234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5147410241158419, "mean_inference_ms": 1.5511164815469363, "mean_action_processing_ms": 0.2552001178617642, "mean_env_wait_ms": 3.5057662081814467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010959307352701822, "StateBufferConnector_ms": 0.007546515691848029, "ViewRequirementAgentConnector_ms": 0.17038299923851377}, "num_episodes": 21, "episode_return_max": -179.61030557727614, "episode_return_min": -1334.54070553279, "episode_return_mean": -827.8030656288231, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.42199451586197, "num_env_steps_trained_throughput_per_sec": 427.42199451586197, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9358.447, "restore_workers_time_ms": 0.043, "training_step_time_ms": 9358.349, "sample_time_ms": 1279.363, "learn_time_ms": 8014.813, "learn_throughput": 499.076, "synch_weights_time_ms": 63.37}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "8adec_00000", "date": "2024-07-24_15-02-18", "timestamp": 1721813538, "time_this_iter_s": 9.367660999298096, "time_total_s": 9.367660999298096, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bb91480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9.367660999298096, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.992857142857144, "ram_util_percent": 41.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7587463021278381, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.826681018869083, "policy_loss": -0.00668873657414224, "vf_loss": 9.845898590485255, "vf_explained_var": 0.0027609532078107196, "kl": 0.012019296247376587, "entropy": 1.4932729830344518, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -8.59687459875936, "episode_reward_min": -1389.7853493767445, "episode_reward_mean": -786.9842303539978, "episode_len_mean": 135.0212765957447, "episode_media": {}, "episodes_timesteps_total": 6346, "policy_reward_min": {"policy_0": -1389.7853493767445}, "policy_reward_max": {"policy_0": -8.59687459875936}, "policy_reward_mean": {"policy_0": -786.9842303539978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-426.87944752722467, -941.423700712548, -1334.54070553279, -1315.111657759418, -991.2757435114045, -1281.644247501357, -855.8220403602063, -457.32503805278566, -279.8413205742187, -992.39582029232, -179.61030557727614, -1055.407396097296, -1234.1814121063023, -893.2033808703247, -871.8366350742033, -778.3767559761551, -735.0999112261395, -778.20447094446, -761.6177593128444, -804.4180022743774, -415.64862692163234, -996.00803177828, -790.6203209018348, -46.41621051223533, -1027.496082464035, -785.9681912870121, -1134.1799221702133, -1218.0238162032456, -609.4506067624806, -1187.410255216253, -1170.7552399579235, -1003.5594228905584, -612.9273219058585, -8.59687459875936, -360.74370104944296, -1360.4157971684285, -923.8939296063031, -720.7860624004799, -278.4315692545593, -1096.9838193846294, -112.2475555433732, -627.7438212005668, -361.91342450002713, -1015.4938960272004, -442.66015062438674, -1389.7853493767445, -321.88307564778705], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 102, 78, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 87, 150, 150, 133, 85, 150, 64, 150, 135, 150, 148, 150, 115], "policy_policy_0_reward": [-426.87944752722467, -941.423700712548, -1334.54070553279, -1315.111657759418, -991.2757435114045, -1281.644247501357, -855.8220403602063, -457.32503805278566, -279.8413205742187, -992.39582029232, -179.61030557727614, -1055.407396097296, -1234.1814121063023, -893.2033808703247, -871.8366350742033, -778.3767559761551, -735.0999112261395, -778.20447094446, -761.6177593128444, -804.4180022743774, -415.64862692163234, -996.00803177828, -790.6203209018348, -46.41621051223533, -1027.496082464035, -785.9681912870121, -1134.1799221702133, -1218.0238162032456, -609.4506067624806, -1187.410255216253, -1170.7552399579235, -1003.5594228905584, -612.9273219058585, -8.59687459875936, -360.74370104944296, -1360.4157971684285, -923.8939296063031, -720.7860624004799, -278.4315692545593, -1096.9838193846294, -112.2475555433732, -627.7438212005668, -361.91342450002713, -1015.4938960272004, -442.66015062438674, -1389.7853493767445, -321.88307564778705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5324966113312617, "mean_inference_ms": 1.6081426780164088, "mean_action_processing_ms": 0.2633893784666298, "mean_env_wait_ms": 3.58476437106741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01352188435006649, "StateBufferConnector_ms": 0.008115362613759142, "ViewRequirementAgentConnector_ms": 0.18058431909439412}, "num_episodes": 26, "episode_return_max": -8.59687459875936, "episode_return_min": -1389.7853493767445, "episode_return_mean": -786.9842303539978, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.31084558514226, "num_env_steps_trained_throughput_per_sec": 353.31084558514226, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10339.968, "restore_workers_time_ms": 0.035, "training_step_time_ms": 10339.884, "sample_time_ms": 1328.934, "learn_time_ms": 8950.064, "learn_throughput": 446.924, "synch_weights_time_ms": 59.931}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "8adec_00000", "date": "2024-07-24_15-02-29", "timestamp": 1721813549, "time_this_iter_s": 11.330222368240356, "time_total_s": 20.697883367538452, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf09d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.697883367538452, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.43125, "ram_util_percent": 41.912499999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.15205483774965, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.570363000035286, "policy_loss": -0.01001670544501394, "vf_loss": 9.592676628629366, "vf_explained_var": -0.004187517675260702, "kl": 0.013919615654170537, "entropy": 1.5080815138916175, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -8.59687459875936, "episode_reward_min": -1389.7853493767445, "episode_reward_mean": -798.4112845050873, "episode_len_mean": 136.02409638554218, "episode_media": {}, "episodes_timesteps_total": 11290, "policy_reward_min": {"policy_0": -1389.7853493767445}, "policy_reward_max": {"policy_0": -8.59687459875936}, "policy_reward_mean": {"policy_0": -798.4112845050873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-426.87944752722467, -941.423700712548, -1334.54070553279, -1315.111657759418, -991.2757435114045, -1281.644247501357, -855.8220403602063, -457.32503805278566, -279.8413205742187, -992.39582029232, -179.61030557727614, -1055.407396097296, -1234.1814121063023, -893.2033808703247, -871.8366350742033, -778.3767559761551, -735.0999112261395, -778.20447094446, -761.6177593128444, -804.4180022743774, -415.64862692163234, -996.00803177828, -790.6203209018348, -46.41621051223533, -1027.496082464035, -785.9681912870121, -1134.1799221702133, -1218.0238162032456, -609.4506067624806, -1187.410255216253, -1170.7552399579235, -1003.5594228905584, -612.9273219058585, -8.59687459875936, -360.74370104944296, -1360.4157971684285, -923.8939296063031, -720.7860624004799, -278.4315692545593, -1096.9838193846294, -112.2475555433732, -627.7438212005668, -361.91342450002713, -1015.4938960272004, -442.66015062438674, -1389.7853493767445, -321.88307564778705, -1098.1140578007378, -134.50623217810804, -959.5677489860237, -1019.0958322704491, -1165.1020202586076, -656.585332140568, -561.6192259170347, -425.41650079425307, -1173.9502359609266, -1064.7389885624384, -1056.8557834002745, -1116.7898331860006, -1078.8294159350385, -812.7555155248151, -1139.034970379589, -565.0573449551747, -916.6727707151422, -485.84784658090626, -83.113265283744, -1177.3957799497566, -885.6955484072968, -1128.48149626385, -1087.7529340264969, -1021.4566825400487, -1364.8370970369654, -72.16842322906639, -755.520661369382, -601.6637850371011, -913.0639895346307, -398.30457538555, -805.9825181508538, -426.1994165407268, -617.3600384808713, -315.47333815166354, -1147.644775740481, -1047.2238066097764], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 102, 78, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 87, 150, 150, 133, 85, 150, 64, 150, 135, 150, 148, 150, 115, 150, 62, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 40, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 99, 150, 150, 150, 97, 150, 150], "policy_policy_0_reward": [-426.87944752722467, -941.423700712548, -1334.54070553279, -1315.111657759418, -991.2757435114045, -1281.644247501357, -855.8220403602063, -457.32503805278566, -279.8413205742187, -992.39582029232, -179.61030557727614, -1055.407396097296, -1234.1814121063023, -893.2033808703247, -871.8366350742033, -778.3767559761551, -735.0999112261395, -778.20447094446, -761.6177593128444, -804.4180022743774, -415.64862692163234, -996.00803177828, -790.6203209018348, -46.41621051223533, -1027.496082464035, -785.9681912870121, -1134.1799221702133, -1218.0238162032456, -609.4506067624806, -1187.410255216253, -1170.7552399579235, -1003.5594228905584, -612.9273219058585, -8.59687459875936, -360.74370104944296, -1360.4157971684285, -923.8939296063031, -720.7860624004799, -278.4315692545593, -1096.9838193846294, -112.2475555433732, -627.7438212005668, -361.91342450002713, -1015.4938960272004, -442.66015062438674, -1389.7853493767445, -321.88307564778705, -1098.1140578007378, -134.50623217810804, -959.5677489860237, -1019.0958322704491, -1165.1020202586076, -656.585332140568, -561.6192259170347, -425.41650079425307, -1173.9502359609266, -1064.7389885624384, -1056.8557834002745, -1116.7898331860006, -1078.8294159350385, -812.7555155248151, -1139.034970379589, -565.0573449551747, -916.6727707151422, -485.84784658090626, -83.113265283744, -1177.3957799497566, -885.6955484072968, -1128.48149626385, -1087.7529340264969, -1021.4566825400487, -1364.8370970369654, -72.16842322906639, -755.520661369382, -601.6637850371011, -913.0639895346307, -398.30457538555, -805.9825181508538, -426.1994165407268, -617.3600384808713, -315.47333815166354, -1147.644775740481, -1047.2238066097764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5357523878220148, "mean_inference_ms": 1.6126831576072076, "mean_action_processing_ms": 0.26471029885994296, "mean_env_wait_ms": 3.6027076761265553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013012196644242987, "StateBufferConnector_ms": 0.007987596902502588, "ViewRequirementAgentConnector_ms": 0.17712575843535275}, "num_episodes": 36, "episode_return_max": -8.59687459875936, "episode_return_min": -1389.7853493767445, "episode_return_mean": -798.4112845050873, "episodes_this_iter": 36}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.2087293816653, "num_env_steps_trained_throughput_per_sec": 357.2087293816653, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10625.96, "restore_workers_time_ms": 0.03, "training_step_time_ms": 10625.887, "sample_time_ms": 1313.461, "learn_time_ms": 9250.968, "learn_throughput": 432.387, "synch_weights_time_ms": 60.581}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "8adec_00000", "date": "2024-07-24_15-02-40", "timestamp": 1721813560, "time_this_iter_s": 11.208291292190552, "time_total_s": 31.906174659729004, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf00d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.906174659729004, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.00625, "ram_util_percent": 41.643750000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4902687513579924, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.552581200003624, "policy_loss": -0.018239607672633915, "vf_loss": 9.581828423341115, "vf_explained_var": -0.00042506313572327294, "kl": 0.0197515476192469, "entropy": 1.4957897204905748, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -8.59687459875936, "episode_reward_min": -1389.7853493767445, "episode_reward_mean": -759.3791312169044, "episode_len_mean": 133.56, "episode_media": {}, "episodes_timesteps_total": 13356, "policy_reward_min": {"policy_0": -1389.7853493767445}, "policy_reward_max": {"policy_0": -8.59687459875936}, "policy_reward_mean": {"policy_0": -759.3791312169044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.8413205742187, -992.39582029232, -179.61030557727614, -1055.407396097296, -1234.1814121063023, -893.2033808703247, -871.8366350742033, -778.3767559761551, -735.0999112261395, -778.20447094446, -761.6177593128444, -804.4180022743774, -415.64862692163234, -996.00803177828, -790.6203209018348, -46.41621051223533, -1027.496082464035, -785.9681912870121, -1134.1799221702133, -1218.0238162032456, -609.4506067624806, -1187.410255216253, -1170.7552399579235, -1003.5594228905584, -612.9273219058585, -8.59687459875936, -360.74370104944296, -1360.4157971684285, -923.8939296063031, -720.7860624004799, -278.4315692545593, -1096.9838193846294, -112.2475555433732, -627.7438212005668, -361.91342450002713, -1015.4938960272004, -442.66015062438674, -1389.7853493767445, -321.88307564778705, -1098.1140578007378, -134.50623217810804, -959.5677489860237, -1019.0958322704491, -1165.1020202586076, -656.585332140568, -561.6192259170347, -425.41650079425307, -1173.9502359609266, -1064.7389885624384, -1056.8557834002745, -1116.7898331860006, -1078.8294159350385, -812.7555155248151, -1139.034970379589, -565.0573449551747, -916.6727707151422, -485.84784658090626, -83.113265283744, -1177.3957799497566, -885.6955484072968, -1128.48149626385, -1087.7529340264969, -1021.4566825400487, -1364.8370970369654, -72.16842322906639, -755.520661369382, -601.6637850371011, -913.0639895346307, -398.30457538555, -805.9825181508538, -426.1994165407268, -617.3600384808713, -315.47333815166354, -1147.644775740481, -1047.2238066097764, -1160.03756872018, -407.8613973651773, -829.4939619594851, -349.3512711563611, -790.8091177826789, -1032.562159833375, -9.658797667091353, -689.5240363938759, -40.527370690925274, -649.0297748112426, -111.3500198646828, -554.4977596624482, -865.5230863237858, -475.0247655603519, -1295.8009501397462, -752.6372451375526, -679.5977353506659, -724.8391557580545, -1034.4656349219506, -1129.2741336248268, -506.3835384038035, -1231.8332957437901, -533.6744623894497, -545.5634686774902, -874.4783807869239], "episode_lengths": [78, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 87, 150, 150, 133, 85, 150, 64, 150, 135, 150, 148, 150, 115, 150, 62, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 40, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 99, 150, 150, 150, 97, 150, 150, 150, 93, 150, 112, 150, 150, 36, 150, 45, 150, 68, 122, 150, 150, 150, 150, 150, 128, 150, 150, 110, 150, 150, 104, 150], "policy_policy_0_reward": [-279.8413205742187, -992.39582029232, -179.61030557727614, -1055.407396097296, -1234.1814121063023, -893.2033808703247, -871.8366350742033, -778.3767559761551, -735.0999112261395, -778.20447094446, -761.6177593128444, -804.4180022743774, -415.64862692163234, -996.00803177828, -790.6203209018348, -46.41621051223533, -1027.496082464035, -785.9681912870121, -1134.1799221702133, -1218.0238162032456, -609.4506067624806, -1187.410255216253, -1170.7552399579235, -1003.5594228905584, -612.9273219058585, -8.59687459875936, -360.74370104944296, -1360.4157971684285, -923.8939296063031, -720.7860624004799, -278.4315692545593, -1096.9838193846294, -112.2475555433732, -627.7438212005668, -361.91342450002713, -1015.4938960272004, -442.66015062438674, -1389.7853493767445, -321.88307564778705, -1098.1140578007378, -134.50623217810804, -959.5677489860237, -1019.0958322704491, -1165.1020202586076, -656.585332140568, -561.6192259170347, -425.41650079425307, -1173.9502359609266, -1064.7389885624384, -1056.8557834002745, -1116.7898331860006, -1078.8294159350385, -812.7555155248151, -1139.034970379589, -565.0573449551747, -916.6727707151422, -485.84784658090626, -83.113265283744, -1177.3957799497566, -885.6955484072968, -1128.48149626385, -1087.7529340264969, -1021.4566825400487, -1364.8370970369654, -72.16842322906639, -755.520661369382, -601.6637850371011, -913.0639895346307, -398.30457538555, -805.9825181508538, -426.1994165407268, -617.3600384808713, -315.47333815166354, -1147.644775740481, -1047.2238066097764, -1160.03756872018, -407.8613973651773, -829.4939619594851, -349.3512711563611, -790.8091177826789, -1032.562159833375, -9.658797667091353, -689.5240363938759, -40.527370690925274, -649.0297748112426, -111.3500198646828, -554.4977596624482, -865.5230863237858, -475.0247655603519, -1295.8009501397462, -752.6372451375526, -679.5977353506659, -724.8391557580545, -1034.4656349219506, -1129.2741336248268, -506.3835384038035, -1231.8332957437901, -533.6744623894497, -545.5634686774902, -874.4783807869239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5376193658384326, "mean_inference_ms": 1.6154153485105573, "mean_action_processing_ms": 0.2657301794670074, "mean_env_wait_ms": 3.619681917217593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013100624084472656, "StateBufferConnector_ms": 0.008113861083984375, "ViewRequirementAgentConnector_ms": 0.17887210845947266}, "num_episodes": 25, "episode_return_max": -8.59687459875936, "episode_return_min": -1389.7853493767445, "episode_return_mean": -759.3791312169044, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.2726962260913, "num_env_steps_trained_throughput_per_sec": 339.2726962260913, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10916.955, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10916.884, "sample_time_ms": 1305.948, "learn_time_ms": 9544.719, "learn_throughput": 419.08, "synch_weights_time_ms": 65.329}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "8adec_00000", "date": "2024-07-24_15-02-52", "timestamp": 1721813572, "time_this_iter_s": 11.800885438919067, "time_total_s": 43.70706009864807, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf1c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43.70706009864807, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.68235294117647, "ram_util_percent": 41.635294117647064}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3776317053784926, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.998708280424276, "policy_loss": -0.01304206061467994, "vf_loss": 9.022993126511574, "vf_explained_var": 0.10065315732111534, "kl": 0.016258117893842912, "entropy": 1.4494375416388114, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -9.658797667091353, "episode_reward_min": -1479.305865075872, "episode_reward_mean": -689.7131829762795, "episode_len_mean": 129.77, "episode_media": {}, "episodes_timesteps_total": 12977, "policy_reward_min": {"policy_0": -1479.305865075872}, "policy_reward_max": {"policy_0": -9.658797667091353}, "policy_reward_mean": {"policy_0": -689.7131829762795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-361.91342450002713, -1015.4938960272004, -442.66015062438674, -1389.7853493767445, -321.88307564778705, -1098.1140578007378, -134.50623217810804, -959.5677489860237, -1019.0958322704491, -1165.1020202586076, -656.585332140568, -561.6192259170347, -425.41650079425307, -1173.9502359609266, -1064.7389885624384, -1056.8557834002745, -1116.7898331860006, -1078.8294159350385, -812.7555155248151, -1139.034970379589, -565.0573449551747, -916.6727707151422, -485.84784658090626, -83.113265283744, -1177.3957799497566, -885.6955484072968, -1128.48149626385, -1087.7529340264969, -1021.4566825400487, -1364.8370970369654, -72.16842322906639, -755.520661369382, -601.6637850371011, -913.0639895346307, -398.30457538555, -805.9825181508538, -426.1994165407268, -617.3600384808713, -315.47333815166354, -1147.644775740481, -1047.2238066097764, -1160.03756872018, -407.8613973651773, -829.4939619594851, -349.3512711563611, -790.8091177826789, -1032.562159833375, -9.658797667091353, -689.5240363938759, -40.527370690925274, -649.0297748112426, -111.3500198646828, -554.4977596624482, -865.5230863237858, -475.0247655603519, -1295.8009501397462, -752.6372451375526, -679.5977353506659, -724.8391557580545, -1034.4656349219506, -1129.2741336248268, -506.3835384038035, -1231.8332957437901, -533.6744623894497, -545.5634686774902, -874.4783807869239, -229.06748577200182, -172.2121059065635, -280.71597378345774, -1479.305865075872, -309.10570541679044, -119.59640606606563, -242.40779108803457, -497.0260129136134, -435.49123120610057, -1076.230115096252, -477.22639285254536, -177.92261171332882, -736.8682570595709, -1411.4148295631671, -671.9527821462431, -432.7201791160516, -1033.549788818457, -481.42237602480094, -547.0828665737415, -76.63248834783958, -314.8930282426055, -865.378710568926, -387.98409284799965, -357.48679758182044, -772.4272682280133, -854.0069883609182, -745.4135231456557, -551.1212595314879, -84.88829935297511, -427.17647439205217, -590.493540172784, -510.11183003310447, -1096.4552680056468, -440.11718043705457], "episode_lengths": [135, 150, 148, 150, 115, 150, 62, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 40, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 99, 150, 150, 150, 97, 150, 150, 150, 93, 150, 112, 150, 150, 36, 150, 45, 150, 68, 122, 150, 150, 150, 150, 150, 128, 150, 150, 110, 150, 150, 104, 150, 75, 83, 104, 150, 82, 68, 94, 150, 150, 150, 131, 64, 138, 150, 150, 94, 150, 150, 150, 45, 83, 139, 150, 101, 150, 150, 150, 150, 59, 107, 150, 150, 150, 100], "policy_policy_0_reward": [-361.91342450002713, -1015.4938960272004, -442.66015062438674, -1389.7853493767445, -321.88307564778705, -1098.1140578007378, -134.50623217810804, -959.5677489860237, -1019.0958322704491, -1165.1020202586076, -656.585332140568, -561.6192259170347, -425.41650079425307, -1173.9502359609266, -1064.7389885624384, -1056.8557834002745, -1116.7898331860006, -1078.8294159350385, -812.7555155248151, -1139.034970379589, -565.0573449551747, -916.6727707151422, -485.84784658090626, -83.113265283744, -1177.3957799497566, -885.6955484072968, -1128.48149626385, -1087.7529340264969, -1021.4566825400487, -1364.8370970369654, -72.16842322906639, -755.520661369382, -601.6637850371011, -913.0639895346307, -398.30457538555, -805.9825181508538, -426.1994165407268, -617.3600384808713, -315.47333815166354, -1147.644775740481, -1047.2238066097764, -1160.03756872018, -407.8613973651773, -829.4939619594851, -349.3512711563611, -790.8091177826789, -1032.562159833375, -9.658797667091353, -689.5240363938759, -40.527370690925274, -649.0297748112426, -111.3500198646828, -554.4977596624482, -865.5230863237858, -475.0247655603519, -1295.8009501397462, -752.6372451375526, -679.5977353506659, -724.8391557580545, -1034.4656349219506, -1129.2741336248268, -506.3835384038035, -1231.8332957437901, -533.6744623894497, -545.5634686774902, -874.4783807869239, -229.06748577200182, -172.2121059065635, -280.71597378345774, -1479.305865075872, -309.10570541679044, -119.59640606606563, -242.40779108803457, -497.0260129136134, -435.49123120610057, -1076.230115096252, -477.22639285254536, -177.92261171332882, -736.8682570595709, -1411.4148295631671, -671.9527821462431, -432.7201791160516, -1033.549788818457, -481.42237602480094, -547.0828665737415, -76.63248834783958, -314.8930282426055, -865.378710568926, -387.98409284799965, -357.48679758182044, -772.4272682280133, -854.0069883609182, -745.4135231456557, -551.1212595314879, -84.88829935297511, -427.17647439205217, -590.493540172784, -510.11183003310447, -1096.4552680056468, -440.11718043705457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5343095149066626, "mean_inference_ms": 1.604398965673787, "mean_action_processing_ms": 0.26538291795415786, "mean_env_wait_ms": 3.6187867463171255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012807130813598633, "StateBufferConnector_ms": 0.00786900520324707, "ViewRequirementAgentConnector_ms": 0.1730670928955078}, "num_episodes": 34, "episode_return_max": -9.658797667091353, "episode_return_min": -1479.305865075872, "episode_return_mean": -689.7131829762795, "episodes_this_iter": 34}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.03012388530453, "num_env_steps_trained_throughput_per_sec": 330.03012388530453, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11157.587, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11157.519, "sample_time_ms": 1300.666, "learn_time_ms": 9791.599, "learn_throughput": 408.513, "synch_weights_time_ms": 64.391}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "8adec_00000", "date": "2024-07-24_15-03-04", "timestamp": 1721813584, "time_this_iter_s": 12.131479501724243, "time_total_s": 55.838539600372314, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf1bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55.838539600372314, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.276470588235295, "ram_util_percent": 41.54705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8486367487659057, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.965578933556875, "policy_loss": -0.010506210378662218, "vf_loss": 8.988893728951613, "vf_explained_var": 0.1869602828597029, "kl": 0.016327217661637406, "entropy": 1.6074051551520825, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -9.658797667091353, "episode_reward_min": -1479.305865075872, "episode_reward_mean": -657.7299491375684, "episode_len_mean": 130.56, "episode_media": {}, "episodes_timesteps_total": 13056, "policy_reward_min": {"policy_0": -1479.305865075872}, "policy_reward_max": {"policy_0": -9.658797667091353}, "policy_reward_mean": {"policy_0": -657.7299491375684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1364.8370970369654, -72.16842322906639, -755.520661369382, -601.6637850371011, -913.0639895346307, -398.30457538555, -805.9825181508538, -426.1994165407268, -617.3600384808713, -315.47333815166354, -1147.644775740481, -1047.2238066097764, -1160.03756872018, -407.8613973651773, -829.4939619594851, -349.3512711563611, -790.8091177826789, -1032.562159833375, -9.658797667091353, -689.5240363938759, -40.527370690925274, -649.0297748112426, -111.3500198646828, -554.4977596624482, -865.5230863237858, -475.0247655603519, -1295.8009501397462, -752.6372451375526, -679.5977353506659, -724.8391557580545, -1034.4656349219506, -1129.2741336248268, -506.3835384038035, -1231.8332957437901, -533.6744623894497, -545.5634686774902, -874.4783807869239, -229.06748577200182, -172.2121059065635, -280.71597378345774, -1479.305865075872, -309.10570541679044, -119.59640606606563, -242.40779108803457, -497.0260129136134, -435.49123120610057, -1076.230115096252, -477.22639285254536, -177.92261171332882, -736.8682570595709, -1411.4148295631671, -671.9527821462431, -432.7201791160516, -1033.549788818457, -481.42237602480094, -547.0828665737415, -76.63248834783958, -314.8930282426055, -865.378710568926, -387.98409284799965, -357.48679758182044, -772.4272682280133, -854.0069883609182, -745.4135231456557, -551.1212595314879, -84.88829935297511, -427.17647439205217, -590.493540172784, -510.11183003310447, -1096.4552680056468, -440.11718043705457, -904.5259784977058, -401.46403746582877, -480.82695426846396, -815.070946385059, -781.7055473421434, -992.6774331248803, -1094.2447045710944, -172.76743310187683, -371.79486773112023, -350.7333925301901, -599.7237572887976, -726.3919581160624, -689.237022634403, -1124.8806623215032, -748.0034363912932, -528.8388365853517, -931.0324825379101, -221.10251331754964, -765.1018494373361, -1208.929210113256, -609.64061929688, -819.7359927599725, -827.05748186557, -982.6168791869998, -1383.8070637203011, -1131.3807490988243, -880.1284524092912, -125.49297985093432, -478.93463237170596], "episode_lengths": [150, 61, 150, 150, 150, 99, 150, 150, 150, 97, 150, 150, 150, 93, 150, 112, 150, 150, 36, 150, 45, 150, 68, 122, 150, 150, 150, 150, 150, 128, 150, 150, 110, 150, 150, 104, 150, 75, 83, 104, 150, 82, 68, 94, 150, 150, 150, 131, 64, 138, 150, 150, 94, 150, 150, 150, 45, 83, 139, 150, 101, 150, 150, 150, 150, 59, 107, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 137, 150, 150, 150, 150, 55, 150], "policy_policy_0_reward": [-1364.8370970369654, -72.16842322906639, -755.520661369382, -601.6637850371011, -913.0639895346307, -398.30457538555, -805.9825181508538, -426.1994165407268, -617.3600384808713, -315.47333815166354, -1147.644775740481, -1047.2238066097764, -1160.03756872018, -407.8613973651773, -829.4939619594851, -349.3512711563611, -790.8091177826789, -1032.562159833375, -9.658797667091353, -689.5240363938759, -40.527370690925274, -649.0297748112426, -111.3500198646828, -554.4977596624482, -865.5230863237858, -475.0247655603519, -1295.8009501397462, -752.6372451375526, -679.5977353506659, -724.8391557580545, -1034.4656349219506, -1129.2741336248268, -506.3835384038035, -1231.8332957437901, -533.6744623894497, -545.5634686774902, -874.4783807869239, -229.06748577200182, -172.2121059065635, -280.71597378345774, -1479.305865075872, -309.10570541679044, -119.59640606606563, -242.40779108803457, -497.0260129136134, -435.49123120610057, -1076.230115096252, -477.22639285254536, -177.92261171332882, -736.8682570595709, -1411.4148295631671, -671.9527821462431, -432.7201791160516, -1033.549788818457, -481.42237602480094, -547.0828665737415, -76.63248834783958, -314.8930282426055, -865.378710568926, -387.98409284799965, -357.48679758182044, -772.4272682280133, -854.0069883609182, -745.4135231456557, -551.1212595314879, -84.88829935297511, -427.17647439205217, -590.493540172784, -510.11183003310447, -1096.4552680056468, -440.11718043705457, -904.5259784977058, -401.46403746582877, -480.82695426846396, -815.070946385059, -781.7055473421434, -992.6774331248803, -1094.2447045710944, -172.76743310187683, -371.79486773112023, -350.7333925301901, -599.7237572887976, -726.3919581160624, -689.237022634403, -1124.8806623215032, -748.0034363912932, -528.8388365853517, -931.0324825379101, -221.10251331754964, -765.1018494373361, -1208.929210113256, -609.64061929688, -819.7359927599725, -827.05748186557, -982.6168791869998, -1383.8070637203011, -1131.3807490988243, -880.1284524092912, -125.49297985093432, -478.93463237170596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5295457181745007, "mean_inference_ms": 1.5920785700278461, "mean_action_processing_ms": 0.26445075944251584, "mean_env_wait_ms": 3.6078636419951993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217044830322266, "StateBufferConnector_ms": 0.00766754150390625, "ViewRequirementAgentConnector_ms": 0.17226219177246094}, "num_episodes": 29, "episode_return_max": -9.658797667091353, "episode_return_min": -1479.305865075872, "episode_return_mean": -657.7299491375684, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3845140453428, "num_env_steps_trained_throughput_per_sec": 310.3845140453428, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11445.865, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11445.798, "sample_time_ms": 1296.998, "learn_time_ms": 10082.758, "learn_throughput": 396.717, "synch_weights_time_ms": 65.2}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "8adec_00000", "date": "2024-07-24_15-03-17", "timestamp": 1721813597, "time_this_iter_s": 12.898550033569336, "time_total_s": 68.73708963394165, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf2ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 68.73708963394165, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.44736842105263, "ram_util_percent": 41.44210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.82643162359794, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.765522437791029, "policy_loss": -0.012347621021035593, "vf_loss": 8.791483378410339, "vf_explained_var": 0.39700523633509877, "kl": 0.017050519157358703, "entropy": 1.702343931297461, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -2.7652594331559786, "episode_reward_min": -1479.305865075872, "episode_reward_mean": -659.7391975926496, "episode_len_mean": 129.5, "episode_media": {}, "episodes_timesteps_total": 12950, "policy_reward_min": {"policy_0": -1479.305865075872}, "policy_reward_max": {"policy_0": -2.7652594331559786}, "policy_reward_mean": {"policy_0": -659.7391975926496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1129.2741336248268, -506.3835384038035, -1231.8332957437901, -533.6744623894497, -545.5634686774902, -874.4783807869239, -229.06748577200182, -172.2121059065635, -280.71597378345774, -1479.305865075872, -309.10570541679044, -119.59640606606563, -242.40779108803457, -497.0260129136134, -435.49123120610057, -1076.230115096252, -477.22639285254536, -177.92261171332882, -736.8682570595709, -1411.4148295631671, -671.9527821462431, -432.7201791160516, -1033.549788818457, -481.42237602480094, -547.0828665737415, -76.63248834783958, -314.8930282426055, -865.378710568926, -387.98409284799965, -357.48679758182044, -772.4272682280133, -854.0069883609182, -745.4135231456557, -551.1212595314879, -84.88829935297511, -427.17647439205217, -590.493540172784, -510.11183003310447, -1096.4552680056468, -440.11718043705457, -904.5259784977058, -401.46403746582877, -480.82695426846396, -815.070946385059, -781.7055473421434, -992.6774331248803, -1094.2447045710944, -172.76743310187683, -371.79486773112023, -350.7333925301901, -599.7237572887976, -726.3919581160624, -689.237022634403, -1124.8806623215032, -748.0034363912932, -528.8388365853517, -931.0324825379101, -221.10251331754964, -765.1018494373361, -1208.929210113256, -609.64061929688, -819.7359927599725, -827.05748186557, -982.6168791869998, -1383.8070637203011, -1131.3807490988243, -880.1284524092912, -125.49297985093432, -478.93463237170596, -936.7069211216566, -619.9769321566833, -21.202086088507148, -629.337303781683, -1318.9962654859444, -406.5802964049375, -641.8454336618723, -1229.2264341707546, -1007.7473812352994, -39.47451867884003, -845.155488071644, -1148.7817398030977, -1085.819672768996, -18.410378403167712, -1103.163643534704, -973.7497284383666, -1081.2487574933855, -369.6943073633522, -520.123288664066, -995.1788768222164, -596.5305640078712, -2.7652594331559786, -1116.287229014325, -209.22786804184938, -939.3354747059637, -849.1477636444413, -335.82661973342306, -48.402215119401966, -353.1121106261821, -921.7024518699662, -754.2020695290644], "episode_lengths": [150, 110, 150, 150, 104, 150, 75, 83, 104, 150, 82, 68, 94, 150, 150, 150, 131, 64, 138, 150, 150, 94, 150, 150, 150, 45, 83, 139, 150, 101, 150, 150, 150, 150, 59, 107, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 137, 150, 150, 150, 150, 55, 150, 150, 150, 37, 150, 150, 128, 150, 150, 150, 48, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 145, 36, 150, 64, 150, 150, 90, 56, 111, 150, 150], "policy_policy_0_reward": [-1129.2741336248268, -506.3835384038035, -1231.8332957437901, -533.6744623894497, -545.5634686774902, -874.4783807869239, -229.06748577200182, -172.2121059065635, -280.71597378345774, -1479.305865075872, -309.10570541679044, -119.59640606606563, -242.40779108803457, -497.0260129136134, -435.49123120610057, -1076.230115096252, -477.22639285254536, -177.92261171332882, -736.8682570595709, -1411.4148295631671, -671.9527821462431, -432.7201791160516, -1033.549788818457, -481.42237602480094, -547.0828665737415, -76.63248834783958, -314.8930282426055, -865.378710568926, -387.98409284799965, -357.48679758182044, -772.4272682280133, -854.0069883609182, -745.4135231456557, -551.1212595314879, -84.88829935297511, -427.17647439205217, -590.493540172784, -510.11183003310447, -1096.4552680056468, -440.11718043705457, -904.5259784977058, -401.46403746582877, -480.82695426846396, -815.070946385059, -781.7055473421434, -992.6774331248803, -1094.2447045710944, -172.76743310187683, -371.79486773112023, -350.7333925301901, -599.7237572887976, -726.3919581160624, -689.237022634403, -1124.8806623215032, -748.0034363912932, -528.8388365853517, -931.0324825379101, -221.10251331754964, -765.1018494373361, -1208.929210113256, -609.64061929688, -819.7359927599725, -827.05748186557, -982.6168791869998, -1383.8070637203011, -1131.3807490988243, -880.1284524092912, -125.49297985093432, -478.93463237170596, -936.7069211216566, -619.9769321566833, -21.202086088507148, -629.337303781683, -1318.9962654859444, -406.5802964049375, -641.8454336618723, -1229.2264341707546, -1007.7473812352994, -39.47451867884003, -845.155488071644, -1148.7817398030977, -1085.819672768996, -18.410378403167712, -1103.163643534704, -973.7497284383666, -1081.2487574933855, -369.6943073633522, -520.123288664066, -995.1788768222164, -596.5305640078712, -2.7652594331559786, -1116.287229014325, -209.22786804184938, -939.3354747059637, -849.1477636444413, -335.82661973342306, -48.402215119401966, -353.1121106261821, -921.7024518699662, -754.2020695290644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5236738242358957, "mean_inference_ms": 1.5809592527350609, "mean_action_processing_ms": 0.26272395794696474, "mean_env_wait_ms": 3.5914473369389657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012076139450073242, "StateBufferConnector_ms": 0.0076982975006103516, "ViewRequirementAgentConnector_ms": 0.17634177207946777}, "num_episodes": 31, "episode_return_max": -2.7652594331559786, "episode_return_min": -1479.305865075872, "episode_return_mean": -659.7391975926496, "episodes_this_iter": 31}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.5738218702997, "num_env_steps_trained_throughput_per_sec": 344.5738218702997, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11469.106, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11469.04, "sample_time_ms": 1293.033, "learn_time_ms": 10110.419, "learn_throughput": 395.631, "synch_weights_time_ms": 64.765}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "8adec_00000", "date": "2024-07-24_15-03-29", "timestamp": 1721813609, "time_this_iter_s": 11.61865234375, "time_total_s": 80.35574197769165, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf3e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80.35574197769165, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.9875, "ram_util_percent": 41.487500000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.39536928857366, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.773587201535702, "policy_loss": -0.013692488477681763, "vf_loss": 7.800438269476095, "vf_explained_var": 0.6208328613390525, "kl": 0.01920202610502505, "entropy": 1.699897626042366, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -2.7652594331559786, "episode_reward_min": -1383.8070637203011, "episode_reward_mean": -694.8792908929167, "episode_len_mean": 133.61, "episode_media": {}, "episodes_timesteps_total": 13361, "policy_reward_min": {"policy_0": -1383.8070637203011}, "policy_reward_max": {"policy_0": -2.7652594331559786}, "policy_reward_mean": {"policy_0": -694.8792908929167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-357.48679758182044, -772.4272682280133, -854.0069883609182, -745.4135231456557, -551.1212595314879, -84.88829935297511, -427.17647439205217, -590.493540172784, -510.11183003310447, -1096.4552680056468, -440.11718043705457, -904.5259784977058, -401.46403746582877, -480.82695426846396, -815.070946385059, -781.7055473421434, -992.6774331248803, -1094.2447045710944, -172.76743310187683, -371.79486773112023, -350.7333925301901, -599.7237572887976, -726.3919581160624, -689.237022634403, -1124.8806623215032, -748.0034363912932, -528.8388365853517, -931.0324825379101, -221.10251331754964, -765.1018494373361, -1208.929210113256, -609.64061929688, -819.7359927599725, -827.05748186557, -982.6168791869998, -1383.8070637203011, -1131.3807490988243, -880.1284524092912, -125.49297985093432, -478.93463237170596, -936.7069211216566, -619.9769321566833, -21.202086088507148, -629.337303781683, -1318.9962654859444, -406.5802964049375, -641.8454336618723, -1229.2264341707546, -1007.7473812352994, -39.47451867884003, -845.155488071644, -1148.7817398030977, -1085.819672768996, -18.410378403167712, -1103.163643534704, -973.7497284383666, -1081.2487574933855, -369.6943073633522, -520.123288664066, -995.1788768222164, -596.5305640078712, -2.7652594331559786, -1116.287229014325, -209.22786804184938, -939.3354747059637, -849.1477636444413, -335.82661973342306, -48.402215119401966, -353.1121106261821, -921.7024518699662, -754.2020695290644, -140.97736782675423, -714.598252822906, -1187.780563271207, -661.8429142293747, -717.2217449961847, -731.0161346870069, -118.8920148690559, -1052.7672386120362, -529.6923908830393, -884.9799337663718, -1186.6338727819302, -758.4626981838379, -967.7817800980143, -618.0395204168547, -1266.8361449659367, -346.45535458756353, -754.0962909879438, -409.69317040734376, -1017.2720775488078, -111.7198628754714, -624.5124655324106, -530.7203771113657, -970.3926953581217, -991.6731405804263, -602.5761506269295, -1066.2233066120928, -701.8787900728761, -113.58383875288378, -1013.1036123882957], "episode_lengths": [101, 150, 150, 150, 150, 59, 107, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 137, 150, 150, 150, 150, 55, 150, 150, 150, 37, 150, 150, 128, 150, 150, 150, 48, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 145, 36, 150, 64, 150, 150, 90, 56, 111, 150, 150, 51, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 72, 150, 140, 150, 150, 129, 150, 150, 65, 150], "policy_policy_0_reward": [-357.48679758182044, -772.4272682280133, -854.0069883609182, -745.4135231456557, -551.1212595314879, -84.88829935297511, -427.17647439205217, -590.493540172784, -510.11183003310447, -1096.4552680056468, -440.11718043705457, -904.5259784977058, -401.46403746582877, -480.82695426846396, -815.070946385059, -781.7055473421434, -992.6774331248803, -1094.2447045710944, -172.76743310187683, -371.79486773112023, -350.7333925301901, -599.7237572887976, -726.3919581160624, -689.237022634403, -1124.8806623215032, -748.0034363912932, -528.8388365853517, -931.0324825379101, -221.10251331754964, -765.1018494373361, -1208.929210113256, -609.64061929688, -819.7359927599725, -827.05748186557, -982.6168791869998, -1383.8070637203011, -1131.3807490988243, -880.1284524092912, -125.49297985093432, -478.93463237170596, -936.7069211216566, -619.9769321566833, -21.202086088507148, -629.337303781683, -1318.9962654859444, -406.5802964049375, -641.8454336618723, -1229.2264341707546, -1007.7473812352994, -39.47451867884003, -845.155488071644, -1148.7817398030977, -1085.819672768996, -18.410378403167712, -1103.163643534704, -973.7497284383666, -1081.2487574933855, -369.6943073633522, -520.123288664066, -995.1788768222164, -596.5305640078712, -2.7652594331559786, -1116.287229014325, -209.22786804184938, -939.3354747059637, -849.1477636444413, -335.82661973342306, -48.402215119401966, -353.1121106261821, -921.7024518699662, -754.2020695290644, -140.97736782675423, -714.598252822906, -1187.780563271207, -661.8429142293747, -717.2217449961847, -731.0161346870069, -118.8920148690559, -1052.7672386120362, -529.6923908830393, -884.9799337663718, -1186.6338727819302, -758.4626981838379, -967.7817800980143, -618.0395204168547, -1266.8361449659367, -346.45535458756353, -754.0962909879438, -409.69317040734376, -1017.2720775488078, -111.7198628754714, -624.5124655324106, -530.7203771113657, -970.3926953581217, -991.6731405804263, -602.5761506269295, -1066.2233066120928, -701.8787900728761, -113.58383875288378, -1013.1036123882957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5240555898573028, "mean_inference_ms": 1.5833045140072501, "mean_action_processing_ms": 0.2627113800252409, "mean_env_wait_ms": 3.5957669912489907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011511087417602539, "StateBufferConnector_ms": 0.0076446533203125, "ViewRequirementAgentConnector_ms": 0.1987926959991455}, "num_episodes": 29, "episode_return_max": -2.7652594331559786, "episode_return_min": -1383.8070637203011, "episode_return_mean": -694.8792908929167, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.9087700600623, "num_env_steps_trained_throughput_per_sec": 299.9087700600623, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11702.643, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11702.576, "sample_time_ms": 1306.155, "learn_time_ms": 10332.316, "learn_throughput": 387.135, "synch_weights_time_ms": 63.293}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "8adec_00000", "date": "2024-07-24_15-03-42", "timestamp": 1721813622, "time_this_iter_s": 13.34764051437378, "time_total_s": 93.70338249206543, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf3c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.70338249206543, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.11052631578947, "ram_util_percent": 41.705263157894734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.390872519214945, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.372696149845918, "policy_loss": -0.01111225703304323, "vf_loss": 6.395955750842889, "vf_explained_var": 0.7548279305920005, "kl": 0.0173440139706751, "entropy": 1.5616144706805548, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 5.054678324055983, "episode_reward_min": -1383.8070637203011, "episode_reward_mean": -679.3268397548002, "episode_len_mean": 128.94, "episode_media": {}, "episodes_timesteps_total": 12894, "policy_reward_min": {"policy_0": -1383.8070637203011}, "policy_reward_max": {"policy_0": 5.054678324055983}, "policy_reward_mean": {"policy_0": -679.3268397548002}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-819.7359927599725, -827.05748186557, -982.6168791869998, -1383.8070637203011, -1131.3807490988243, -880.1284524092912, -125.49297985093432, -478.93463237170596, -936.7069211216566, -619.9769321566833, -21.202086088507148, -629.337303781683, -1318.9962654859444, -406.5802964049375, -641.8454336618723, -1229.2264341707546, -1007.7473812352994, -39.47451867884003, -845.155488071644, -1148.7817398030977, -1085.819672768996, -18.410378403167712, -1103.163643534704, -973.7497284383666, -1081.2487574933855, -369.6943073633522, -520.123288664066, -995.1788768222164, -596.5305640078712, -2.7652594331559786, -1116.287229014325, -209.22786804184938, -939.3354747059637, -849.1477636444413, -335.82661973342306, -48.402215119401966, -353.1121106261821, -921.7024518699662, -754.2020695290644, -140.97736782675423, -714.598252822906, -1187.780563271207, -661.8429142293747, -717.2217449961847, -731.0161346870069, -118.8920148690559, -1052.7672386120362, -529.6923908830393, -884.9799337663718, -1186.6338727819302, -758.4626981838379, -967.7817800980143, -618.0395204168547, -1266.8361449659367, -346.45535458756353, -754.0962909879438, -409.69317040734376, -1017.2720775488078, -111.7198628754714, -624.5124655324106, -530.7203771113657, -970.3926953581217, -991.6731405804263, -602.5761506269295, -1066.2233066120928, -701.8787900728761, -113.58383875288378, -1013.1036123882957, -144.45824085964895, -1024.5429236337648, -752.6505836844397, -1220.7767866773445, -1036.4014388507735, -175.32104503018584, -885.336222794124, -980.7161044364134, -643.0378907786842, -231.7687974848238, -1147.4276089481566, -160.65341356493641, -1051.3984228181428, -593.4259583362373, -1043.2805180252253, -687.5464567885098, -518.662371411966, -652.3804556418737, 5.054678324055983, -408.9236464527868, -1097.7531667917845, 4.7769215748111, -688.0495509197302, -410.8544976765655, -583.8728131419018, -394.6691479007259, -584.3247490467189, -25.849370697539158, -409.471668934196, -212.19060444277122, -656.8889633953696, -980.3451392220769], "episode_lengths": [150, 137, 150, 150, 150, 150, 55, 150, 150, 150, 37, 150, 150, 128, 150, 150, 150, 48, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 145, 36, 150, 64, 150, 150, 90, 56, 111, 150, 150, 51, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 72, 150, 140, 150, 150, 129, 150, 150, 65, 150, 74, 150, 133, 150, 150, 56, 150, 150, 150, 92, 150, 74, 150, 150, 150, 137, 150, 150, 29, 150, 150, 29, 150, 150, 150, 150, 114, 49, 101, 84, 150, 150], "policy_policy_0_reward": [-819.7359927599725, -827.05748186557, -982.6168791869998, -1383.8070637203011, -1131.3807490988243, -880.1284524092912, -125.49297985093432, -478.93463237170596, -936.7069211216566, -619.9769321566833, -21.202086088507148, -629.337303781683, -1318.9962654859444, -406.5802964049375, -641.8454336618723, -1229.2264341707546, -1007.7473812352994, -39.47451867884003, -845.155488071644, -1148.7817398030977, -1085.819672768996, -18.410378403167712, -1103.163643534704, -973.7497284383666, -1081.2487574933855, -369.6943073633522, -520.123288664066, -995.1788768222164, -596.5305640078712, -2.7652594331559786, -1116.287229014325, -209.22786804184938, -939.3354747059637, -849.1477636444413, -335.82661973342306, -48.402215119401966, -353.1121106261821, -921.7024518699662, -754.2020695290644, -140.97736782675423, -714.598252822906, -1187.780563271207, -661.8429142293747, -717.2217449961847, -731.0161346870069, -118.8920148690559, -1052.7672386120362, -529.6923908830393, -884.9799337663718, -1186.6338727819302, -758.4626981838379, -967.7817800980143, -618.0395204168547, -1266.8361449659367, -346.45535458756353, -754.0962909879438, -409.69317040734376, -1017.2720775488078, -111.7198628754714, -624.5124655324106, -530.7203771113657, -970.3926953581217, -991.6731405804263, -602.5761506269295, -1066.2233066120928, -701.8787900728761, -113.58383875288378, -1013.1036123882957, -144.45824085964895, -1024.5429236337648, -752.6505836844397, -1220.7767866773445, -1036.4014388507735, -175.32104503018584, -885.336222794124, -980.7161044364134, -643.0378907786842, -231.7687974848238, -1147.4276089481566, -160.65341356493641, -1051.3984228181428, -593.4259583362373, -1043.2805180252253, -687.5464567885098, -518.662371411966, -652.3804556418737, 5.054678324055983, -408.9236464527868, -1097.7531667917845, 4.7769215748111, -688.0495509197302, -410.8544976765655, -583.8728131419018, -394.6691479007259, -584.3247490467189, -25.849370697539158, -409.471668934196, -212.19060444277122, -656.8889633953696, -980.3451392220769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5237196093626548, "mean_inference_ms": 1.5831012534911661, "mean_action_processing_ms": 0.26222762472765615, "mean_env_wait_ms": 3.5991645980555655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01184535026550293, "StateBufferConnector_ms": 0.007699251174926758, "ViewRequirementAgentConnector_ms": 0.20209693908691406}, "num_episodes": 32, "episode_return_max": 5.054678324055983, "episode_return_min": -1383.8070637203011, "episode_return_mean": -679.3268397548002, "episodes_this_iter": 32}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.8686582861422, "num_env_steps_trained_throughput_per_sec": 358.8686582861422, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11640.811, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11640.745, "sample_time_ms": 1303.499, "learn_time_ms": 10274.362, "learn_throughput": 389.319, "synch_weights_time_ms": 62.078}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "8adec_00000", "date": "2024-07-24_15-03-54", "timestamp": 1721813634, "time_this_iter_s": 11.15680193901062, "time_total_s": 104.86018443107605, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf2cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.86018443107605, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.4125, "ram_util_percent": 41.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69.48806778490544, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.3297260041038195, "policy_loss": -0.01203554530366091, "vf_loss": 5.35385517552495, "vf_explained_var": 0.8565492946654558, "kl": 0.015857692674975016, "entropy": 1.5265167667220036, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 5.054678324055983, "episode_reward_min": -1266.8361449659367, "episode_reward_mean": -627.5658142338649, "episode_len_mean": 130.72, "episode_media": {}, "episodes_timesteps_total": 13072, "policy_reward_min": {"policy_0": -1266.8361449659367}, "policy_reward_max": {"policy_0": 5.054678324055983}, "policy_reward_mean": {"policy_0": -627.5658142338649}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-939.3354747059637, -849.1477636444413, -335.82661973342306, -48.402215119401966, -353.1121106261821, -921.7024518699662, -754.2020695290644, -140.97736782675423, -714.598252822906, -1187.780563271207, -661.8429142293747, -717.2217449961847, -731.0161346870069, -118.8920148690559, -1052.7672386120362, -529.6923908830393, -884.9799337663718, -1186.6338727819302, -758.4626981838379, -967.7817800980143, -618.0395204168547, -1266.8361449659367, -346.45535458756353, -754.0962909879438, -409.69317040734376, -1017.2720775488078, -111.7198628754714, -624.5124655324106, -530.7203771113657, -970.3926953581217, -991.6731405804263, -602.5761506269295, -1066.2233066120928, -701.8787900728761, -113.58383875288378, -1013.1036123882957, -144.45824085964895, -1024.5429236337648, -752.6505836844397, -1220.7767866773445, -1036.4014388507735, -175.32104503018584, -885.336222794124, -980.7161044364134, -643.0378907786842, -231.7687974848238, -1147.4276089481566, -160.65341356493641, -1051.3984228181428, -593.4259583362373, -1043.2805180252253, -687.5464567885098, -518.662371411966, -652.3804556418737, 5.054678324055983, -408.9236464527868, -1097.7531667917845, 4.7769215748111, -688.0495509197302, -410.8544976765655, -583.8728131419018, -394.6691479007259, -584.3247490467189, -25.849370697539158, -409.471668934196, -212.19060444277122, -656.8889633953696, -980.3451392220769, -276.42621628002166, -49.96250846949728, -1050.2645216279518, -343.26260233632814, -557.7106874223063, -905.7599808555908, -869.0976173667615, -1016.4098759110547, -765.7547996895848, -54.1223621928975, -723.2055276622276, -509.8568834722722, -311.44665799389156, -485.83518870865606, -723.468373280058, -680.2765775540374, -576.3932162019865, -548.8425360357056, -471.9132002634887, -119.26686778572498, -562.8642137851167, -360.19692824329394, -326.993199429335, -747.4691655197788, -824.351150949994, -504.92570904041816, -539.0735896460533, -460.0109708638016, -1125.1014596164862, -330.8599278280421, -711.7265012606367, -837.43303652346], "episode_lengths": [150, 150, 90, 56, 111, 150, 150, 51, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 72, 150, 140, 150, 150, 129, 150, 150, 65, 150, 74, 150, 133, 150, 150, 56, 150, 150, 150, 92, 150, 74, 150, 150, 150, 137, 150, 150, 29, 150, 150, 29, 150, 150, 150, 150, 114, 49, 101, 84, 150, 150, 109, 46, 150, 133, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 139, 150, 150, 150, 60, 150, 133, 119, 150, 150, 150, 150, 150, 150, 88, 150, 150], "policy_policy_0_reward": [-939.3354747059637, -849.1477636444413, -335.82661973342306, -48.402215119401966, -353.1121106261821, -921.7024518699662, -754.2020695290644, -140.97736782675423, -714.598252822906, -1187.780563271207, -661.8429142293747, -717.2217449961847, -731.0161346870069, -118.8920148690559, -1052.7672386120362, -529.6923908830393, -884.9799337663718, -1186.6338727819302, -758.4626981838379, -967.7817800980143, -618.0395204168547, -1266.8361449659367, -346.45535458756353, -754.0962909879438, -409.69317040734376, -1017.2720775488078, -111.7198628754714, -624.5124655324106, -530.7203771113657, -970.3926953581217, -991.6731405804263, -602.5761506269295, -1066.2233066120928, -701.8787900728761, -113.58383875288378, -1013.1036123882957, -144.45824085964895, -1024.5429236337648, -752.6505836844397, -1220.7767866773445, -1036.4014388507735, -175.32104503018584, -885.336222794124, -980.7161044364134, -643.0378907786842, -231.7687974848238, -1147.4276089481566, -160.65341356493641, -1051.3984228181428, -593.4259583362373, -1043.2805180252253, -687.5464567885098, -518.662371411966, -652.3804556418737, 5.054678324055983, -408.9236464527868, -1097.7531667917845, 4.7769215748111, -688.0495509197302, -410.8544976765655, -583.8728131419018, -394.6691479007259, -584.3247490467189, -25.849370697539158, -409.471668934196, -212.19060444277122, -656.8889633953696, -980.3451392220769, -276.42621628002166, -49.96250846949728, -1050.2645216279518, -343.26260233632814, -557.7106874223063, -905.7599808555908, -869.0976173667615, -1016.4098759110547, -765.7547996895848, -54.1223621928975, -723.2055276622276, -509.8568834722722, -311.44665799389156, -485.83518870865606, -723.468373280058, -680.2765775540374, -576.3932162019865, -548.8425360357056, -471.9132002634887, -119.26686778572498, -562.8642137851167, -360.19692824329394, -326.993199429335, -747.4691655197788, -824.351150949994, -504.92570904041816, -539.0735896460533, -460.0109708638016, -1125.1014596164862, -330.8599278280421, -711.7265012606367, -837.43303652346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5240750998205811, "mean_inference_ms": 1.5849677725906401, "mean_action_processing_ms": 0.2621125286566322, "mean_env_wait_ms": 3.598693330302442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011615276336669922, "StateBufferConnector_ms": 0.007387638092041016, "ViewRequirementAgentConnector_ms": 0.19537997245788574}, "num_episodes": 32, "episode_return_max": 5.054678324055983, "episode_return_min": -1266.8361449659367, "episode_return_mean": -627.5658142338649, "episodes_this_iter": 32}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.9219284674412, "num_env_steps_trained_throughput_per_sec": 361.9219284674412, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11581.942, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11581.873, "sample_time_ms": 1298.295, "learn_time_ms": 10221.093, "learn_throughput": 391.348, "synch_weights_time_ms": 61.686}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "8adec_00000", "date": "2024-07-24_15-04-05", "timestamp": 1721813645, "time_this_iter_s": 11.06289005279541, "time_total_s": 115.92307448387146, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf1f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.92307448387146, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.3125, "ram_util_percent": 41.743750000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.9825483550628, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.600250837951899, "policy_loss": -0.012580278246120239, "vf_loss": 5.624913717309634, "vf_explained_var": 0.862936542990307, "kl": 0.019425777563446916, "entropy": 1.5967768824348847, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": 5.054678324055983, "episode_reward_min": -1220.7767866773445, "episode_reward_mean": -579.5507305019052, "episode_len_mean": 127.4, "episode_media": {}, "episodes_timesteps_total": 12740, "policy_reward_min": {"policy_0": -1220.7767866773445}, "policy_reward_max": {"policy_0": 5.054678324055983}, "policy_reward_mean": {"policy_0": -579.5507305019052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1066.2233066120928, -701.8787900728761, -113.58383875288378, -1013.1036123882957, -144.45824085964895, -1024.5429236337648, -752.6505836844397, -1220.7767866773445, -1036.4014388507735, -175.32104503018584, -885.336222794124, -980.7161044364134, -643.0378907786842, -231.7687974848238, -1147.4276089481566, -160.65341356493641, -1051.3984228181428, -593.4259583362373, -1043.2805180252253, -687.5464567885098, -518.662371411966, -652.3804556418737, 5.054678324055983, -408.9236464527868, -1097.7531667917845, 4.7769215748111, -688.0495509197302, -410.8544976765655, -583.8728131419018, -394.6691479007259, -584.3247490467189, -25.849370697539158, -409.471668934196, -212.19060444277122, -656.8889633953696, -980.3451392220769, -276.42621628002166, -49.96250846949728, -1050.2645216279518, -343.26260233632814, -557.7106874223063, -905.7599808555908, -869.0976173667615, -1016.4098759110547, -765.7547996895848, -54.1223621928975, -723.2055276622276, -509.8568834722722, -311.44665799389156, -485.83518870865606, -723.468373280058, -680.2765775540374, -576.3932162019865, -548.8425360357056, -471.9132002634887, -119.26686778572498, -562.8642137851167, -360.19692824329394, -326.993199429335, -747.4691655197788, -824.351150949994, -504.92570904041816, -539.0735896460533, -460.0109708638016, -1125.1014596164862, -330.8599278280421, -711.7265012606367, -837.43303652346, -293.933880452397, -415.6638491044802, -512.701806465211, -198.16694785576647, -351.2254040996358, -999.4162075111327, -221.7071452956913, -177.0571077149208, -700.6770276554022, -628.0873087179634, -788.143862470757, -969.8433176457202, -748.825986033087, -165.62714006575342, -528.1565024582466, -207.08910261859188, -100.31172537382075, -960.9371351732651, -1098.6275527996625, -554.7887094997478, -541.1181417310655, -887.7037812008681, -406.72859940871444, -60.982717203981714, -170.6916497989885, -612.9716570757114, -871.8716803750472, -550.8347798816766, -1116.4154280565494, -523.9753361087143, -291.4509361332244, -641.1220640735767], "episode_lengths": [150, 150, 65, 150, 74, 150, 133, 150, 150, 56, 150, 150, 150, 92, 150, 74, 150, 150, 150, 137, 150, 150, 29, 150, 150, 29, 150, 150, 150, 150, 114, 49, 101, 84, 150, 150, 109, 46, 150, 133, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 139, 150, 150, 150, 60, 150, 133, 119, 150, 150, 150, 150, 150, 150, 88, 150, 150, 85, 150, 150, 82, 103, 150, 64, 56, 150, 133, 150, 150, 150, 60, 150, 77, 51, 150, 150, 150, 150, 150, 150, 56, 76, 150, 150, 150, 150, 141, 101, 150], "policy_policy_0_reward": [-1066.2233066120928, -701.8787900728761, -113.58383875288378, -1013.1036123882957, -144.45824085964895, -1024.5429236337648, -752.6505836844397, -1220.7767866773445, -1036.4014388507735, -175.32104503018584, -885.336222794124, -980.7161044364134, -643.0378907786842, -231.7687974848238, -1147.4276089481566, -160.65341356493641, -1051.3984228181428, -593.4259583362373, -1043.2805180252253, -687.5464567885098, -518.662371411966, -652.3804556418737, 5.054678324055983, -408.9236464527868, -1097.7531667917845, 4.7769215748111, -688.0495509197302, -410.8544976765655, -583.8728131419018, -394.6691479007259, -584.3247490467189, -25.849370697539158, -409.471668934196, -212.19060444277122, -656.8889633953696, -980.3451392220769, -276.42621628002166, -49.96250846949728, -1050.2645216279518, -343.26260233632814, -557.7106874223063, -905.7599808555908, -869.0976173667615, -1016.4098759110547, -765.7547996895848, -54.1223621928975, -723.2055276622276, -509.8568834722722, -311.44665799389156, -485.83518870865606, -723.468373280058, -680.2765775540374, -576.3932162019865, -548.8425360357056, -471.9132002634887, -119.26686778572498, -562.8642137851167, -360.19692824329394, -326.993199429335, -747.4691655197788, -824.351150949994, -504.92570904041816, -539.0735896460533, -460.0109708638016, -1125.1014596164862, -330.8599278280421, -711.7265012606367, -837.43303652346, -293.933880452397, -415.6638491044802, -512.701806465211, -198.16694785576647, -351.2254040996358, -999.4162075111327, -221.7071452956913, -177.0571077149208, -700.6770276554022, -628.0873087179634, -788.143862470757, -969.8433176457202, -748.825986033087, -165.62714006575342, -528.1565024582466, -207.08910261859188, -100.31172537382075, -960.9371351732651, -1098.6275527996625, -554.7887094997478, -541.1181417310655, -887.7037812008681, -406.72859940871444, -60.982717203981714, -170.6916497989885, -612.9716570757114, -871.8716803750472, -550.8347798816766, -1116.4154280565494, -523.9753361087143, -291.4509361332244, -641.1220640735767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.521849689001714, "mean_inference_ms": 1.5792039448376805, "mean_action_processing_ms": 0.2610158424990113, "mean_env_wait_ms": 3.5882774061955236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01160573959350586, "StateBufferConnector_ms": 0.007276296615600586, "ViewRequirementAgentConnector_ms": 0.17452383041381836}, "num_episodes": 32, "episode_return_max": 5.054678324055983, "episode_return_min": -1220.7767866773445, "episode_return_mean": -579.5507305019052, "episodes_this_iter": 32}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.322715025341, "num_env_steps_trained_throughput_per_sec": 314.322715025341, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11918.676, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11918.609, "sample_time_ms": 1298.028, "learn_time_ms": 10558.148, "learn_throughput": 378.854, "synch_weights_time_ms": 61.633}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "8adec_00000", "date": "2024-07-24_15-04-17", "timestamp": 1721813657, "time_this_iter_s": 12.737833738327026, "time_total_s": 128.6609082221985, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bb91000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.6609082221985, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.583333333333332, "ram_util_percent": 41.472222222222214}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.38481058577696, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.78597819035252, "policy_loss": -0.01827488621347584, "vf_loss": 5.814865058163802, "vf_explained_var": 0.8871231560284892, "kl": 0.02450451140218018, "entropy": 1.5512885152051845, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -20.672366014035, "episode_reward_min": -1141.6894781282542, "episode_reward_mean": -523.5355257884526, "episode_len_mean": 122.36, "episode_media": {}, "episodes_timesteps_total": 12236, "policy_reward_min": {"policy_0": -1141.6894781282542}, "policy_reward_max": {"policy_0": -20.672366014035}, "policy_reward_mean": {"policy_0": -523.5355257884526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276.42621628002166, -49.96250846949728, -1050.2645216279518, -343.26260233632814, -557.7106874223063, -905.7599808555908, -869.0976173667615, -1016.4098759110547, -765.7547996895848, -54.1223621928975, -723.2055276622276, -509.8568834722722, -311.44665799389156, -485.83518870865606, -723.468373280058, -680.2765775540374, -576.3932162019865, -548.8425360357056, -471.9132002634887, -119.26686778572498, -562.8642137851167, -360.19692824329394, -326.993199429335, -747.4691655197788, -824.351150949994, -504.92570904041816, -539.0735896460533, -460.0109708638016, -1125.1014596164862, -330.8599278280421, -711.7265012606367, -837.43303652346, -293.933880452397, -415.6638491044802, -512.701806465211, -198.16694785576647, -351.2254040996358, -999.4162075111327, -221.7071452956913, -177.0571077149208, -700.6770276554022, -628.0873087179634, -788.143862470757, -969.8433176457202, -748.825986033087, -165.62714006575342, -528.1565024582466, -207.08910261859188, -100.31172537382075, -960.9371351732651, -1098.6275527996625, -554.7887094997478, -541.1181417310655, -887.7037812008681, -406.72859940871444, -60.982717203981714, -170.6916497989885, -612.9716570757114, -871.8716803750472, -550.8347798816766, -1116.4154280565494, -523.9753361087143, -291.4509361332244, -641.1220640735767, -167.2437684032901, -103.16235897811437, -35.876084218221614, -747.1953542254339, -1141.6894781282542, -602.0231414484682, -737.3995075198656, -89.94637261293059, -804.92416236436, -208.39928341533368, -548.7619568812368, -432.4298542511546, -844.3516025042495, -1131.3553337199214, -52.12760376574456, -138.35912571959716, -240.83100014973053, -927.8162493238909, -537.9941500110236, -862.3273196821975, -530.9878571934593, -462.2986726716968, -218.9900839964909, -109.07126483751117, -852.8957229504315, -960.5444797788471, -613.9573238441253, -418.0825623963127, -585.6027476036456, -47.58286553608121, -74.15064128817266, -257.63977796431396, -426.39268327381797, -20.672366014035, -197.240299207194, -556.0929790902671], "episode_lengths": [109, 46, 150, 133, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 139, 150, 150, 150, 60, 150, 133, 119, 150, 150, 150, 150, 150, 150, 88, 150, 150, 85, 150, 150, 82, 103, 150, 64, 56, 150, 133, 150, 150, 150, 60, 150, 77, 51, 150, 150, 150, 150, 150, 150, 56, 76, 150, 150, 150, 150, 141, 101, 150, 91, 44, 44, 150, 150, 150, 150, 60, 150, 78, 150, 150, 150, 150, 50, 68, 78, 150, 135, 150, 150, 129, 84, 51, 150, 150, 150, 108, 150, 38, 59, 77, 115, 39, 85, 150], "policy_policy_0_reward": [-276.42621628002166, -49.96250846949728, -1050.2645216279518, -343.26260233632814, -557.7106874223063, -905.7599808555908, -869.0976173667615, -1016.4098759110547, -765.7547996895848, -54.1223621928975, -723.2055276622276, -509.8568834722722, -311.44665799389156, -485.83518870865606, -723.468373280058, -680.2765775540374, -576.3932162019865, -548.8425360357056, -471.9132002634887, -119.26686778572498, -562.8642137851167, -360.19692824329394, -326.993199429335, -747.4691655197788, -824.351150949994, -504.92570904041816, -539.0735896460533, -460.0109708638016, -1125.1014596164862, -330.8599278280421, -711.7265012606367, -837.43303652346, -293.933880452397, -415.6638491044802, -512.701806465211, -198.16694785576647, -351.2254040996358, -999.4162075111327, -221.7071452956913, -177.0571077149208, -700.6770276554022, -628.0873087179634, -788.143862470757, -969.8433176457202, -748.825986033087, -165.62714006575342, -528.1565024582466, -207.08910261859188, -100.31172537382075, -960.9371351732651, -1098.6275527996625, -554.7887094997478, -541.1181417310655, -887.7037812008681, -406.72859940871444, -60.982717203981714, -170.6916497989885, -612.9716570757114, -871.8716803750472, -550.8347798816766, -1116.4154280565494, -523.9753361087143, -291.4509361332244, -641.1220640735767, -167.2437684032901, -103.16235897811437, -35.876084218221614, -747.1953542254339, -1141.6894781282542, -602.0231414484682, -737.3995075198656, -89.94637261293059, -804.92416236436, -208.39928341533368, -548.7619568812368, -432.4298542511546, -844.3516025042495, -1131.3553337199214, -52.12760376574456, -138.35912571959716, -240.83100014973053, -927.8162493238909, -537.9941500110236, -862.3273196821975, -530.9878571934593, -462.2986726716968, -218.9900839964909, -109.07126483751117, -852.8957229504315, -960.5444797788471, -613.9573238441253, -418.0825623963127, -585.6027476036456, -47.58286553608121, -74.15064128817266, -257.63977796431396, -426.39268327381797, -20.672366014035, -197.240299207194, -556.0929790902671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5208920516248648, "mean_inference_ms": 1.5757434971188977, "mean_action_processing_ms": 0.2605001696721451, "mean_env_wait_ms": 3.57968012896186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011449337005615234, "StateBufferConnector_ms": 0.00738835334777832, "ViewRequirementAgentConnector_ms": 0.17614054679870605}, "num_episodes": 36, "episode_return_max": -20.672366014035, "episode_return_min": -1141.6894781282542, "episode_return_mean": -523.5355257884526, "episodes_this_iter": 36}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.05842107271997, "num_env_steps_trained_throughput_per_sec": 301.05842107271997, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12115.175, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12115.106, "sample_time_ms": 1290.178, "learn_time_ms": 10762.548, "learn_throughput": 371.659, "synch_weights_time_ms": 61.608}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "8adec_00000", "date": "2024-07-24_15-04-31", "timestamp": 1721813671, "time_this_iter_s": 13.297717809677124, "time_total_s": 141.9586260318756, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bb912d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.9586260318756, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.405263157894737, "ram_util_percent": 41.515789473684215}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.80901539127032, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.692019633203745, "policy_loss": -0.015382086246002775, "vf_loss": 4.71531567449371, "vf_explained_var": 0.9390063509345055, "kl": 0.019333219768062328, "entropy": 1.3713917206972837, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -11.6605034775651, "episode_reward_min": -1164.6934816408564, "episode_reward_mean": -458.0289817523851, "episode_len_mean": 111.22, "episode_media": {}, "episodes_timesteps_total": 11122, "policy_reward_min": {"policy_0": -1164.6934816408564}, "policy_reward_max": {"policy_0": -11.6605034775651}, "policy_reward_mean": {"policy_0": -458.0289817523851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-999.4162075111327, -221.7071452956913, -177.0571077149208, -700.6770276554022, -628.0873087179634, -788.143862470757, -969.8433176457202, -748.825986033087, -165.62714006575342, -528.1565024582466, -207.08910261859188, -100.31172537382075, -960.9371351732651, -1098.6275527996625, -554.7887094997478, -541.1181417310655, -887.7037812008681, -406.72859940871444, -60.982717203981714, -170.6916497989885, -612.9716570757114, -871.8716803750472, -550.8347798816766, -1116.4154280565494, -523.9753361087143, -291.4509361332244, -641.1220640735767, -167.2437684032901, -103.16235897811437, -35.876084218221614, -747.1953542254339, -1141.6894781282542, -602.0231414484682, -737.3995075198656, -89.94637261293059, -804.92416236436, -208.39928341533368, -548.7619568812368, -432.4298542511546, -844.3516025042495, -1131.3553337199214, -52.12760376574456, -138.35912571959716, -240.83100014973053, -927.8162493238909, -537.9941500110236, -862.3273196821975, -530.9878571934593, -462.2986726716968, -218.9900839964909, -109.07126483751117, -852.8957229504315, -960.5444797788471, -613.9573238441253, -418.0825623963127, -585.6027476036456, -47.58286553608121, -74.15064128817266, -257.63977796431396, -426.39268327381797, -20.672366014035, -197.240299207194, -556.0929790902671, -1164.6934816408564, -577.270599640371, -617.8638525802567, -111.20013332038266, -448.9398072805856, -305.54267475557424, -173.5164580681278, -289.58406315087734, -874.5270163301652, -398.72662171128644, -287.0821028440155, -568.9899864089307, -53.467239288524176, -138.2547511750199, -46.82875778585337, -40.96888254041265, -653.2205215677059, -81.9957042846322, -229.02816841195843, -912.1896523641811, -33.224279697306265, -471.953730722587, -67.17737341110848, -129.9200111370328, -555.9647019750404, -606.5822715262227, -177.40794952466632, -176.4484677446392, -26.372260131234338, -367.3882132971396, -329.5501749331883, -187.9282231950751, -96.945713585714, -537.914910864521, -11.6605034775651, -682.0443963015331, -1158.9458815129076], "episode_lengths": [150, 64, 56, 150, 133, 150, 150, 150, 60, 150, 77, 51, 150, 150, 150, 150, 150, 150, 56, 76, 150, 150, 150, 150, 141, 101, 150, 91, 44, 44, 150, 150, 150, 150, 60, 150, 78, 150, 150, 150, 150, 50, 68, 78, 150, 135, 150, 150, 129, 84, 51, 150, 150, 150, 108, 150, 38, 59, 77, 115, 39, 85, 150, 150, 150, 150, 71, 150, 150, 74, 105, 150, 99, 92, 150, 51, 65, 46, 48, 150, 49, 89, 150, 40, 150, 55, 70, 150, 150, 79, 72, 41, 111, 105, 63, 64, 150, 35, 150, 150], "policy_policy_0_reward": [-999.4162075111327, -221.7071452956913, -177.0571077149208, -700.6770276554022, -628.0873087179634, -788.143862470757, -969.8433176457202, -748.825986033087, -165.62714006575342, -528.1565024582466, -207.08910261859188, -100.31172537382075, -960.9371351732651, -1098.6275527996625, -554.7887094997478, -541.1181417310655, -887.7037812008681, -406.72859940871444, -60.982717203981714, -170.6916497989885, -612.9716570757114, -871.8716803750472, -550.8347798816766, -1116.4154280565494, -523.9753361087143, -291.4509361332244, -641.1220640735767, -167.2437684032901, -103.16235897811437, -35.876084218221614, -747.1953542254339, -1141.6894781282542, -602.0231414484682, -737.3995075198656, -89.94637261293059, -804.92416236436, -208.39928341533368, -548.7619568812368, -432.4298542511546, -844.3516025042495, -1131.3553337199214, -52.12760376574456, -138.35912571959716, -240.83100014973053, -927.8162493238909, -537.9941500110236, -862.3273196821975, -530.9878571934593, -462.2986726716968, -218.9900839964909, -109.07126483751117, -852.8957229504315, -960.5444797788471, -613.9573238441253, -418.0825623963127, -585.6027476036456, -47.58286553608121, -74.15064128817266, -257.63977796431396, -426.39268327381797, -20.672366014035, -197.240299207194, -556.0929790902671, -1164.6934816408564, -577.270599640371, -617.8638525802567, -111.20013332038266, -448.9398072805856, -305.54267475557424, -173.5164580681278, -289.58406315087734, -874.5270163301652, -398.72662171128644, -287.0821028440155, -568.9899864089307, -53.467239288524176, -138.2547511750199, -46.82875778585337, -40.96888254041265, -653.2205215677059, -81.9957042846322, -229.02816841195843, -912.1896523641811, -33.224279697306265, -471.953730722587, -67.17737341110848, -129.9200111370328, -555.9647019750404, -606.5822715262227, -177.40794952466632, -176.4484677446392, -26.372260131234338, -367.3882132971396, -329.5501749331883, -187.9282231950751, -96.945713585714, -537.914910864521, -11.6605034775651, -682.0443963015331, -1158.9458815129076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.520891675144932, "mean_inference_ms": 1.5738000448377476, "mean_action_processing_ms": 0.26019296293313215, "mean_env_wait_ms": 3.5795576598725347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011292695999145508, "StateBufferConnector_ms": 0.007407426834106445, "ViewRequirementAgentConnector_ms": 0.17781519889831543}, "num_episodes": 37, "episode_return_max": -11.6605034775651, "episode_return_min": -1164.6934816408564, "episode_return_mean": -458.0289817523851, "episodes_this_iter": 37}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.5538346379523, "num_env_steps_trained_throughput_per_sec": 317.5538346379523, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12255.01, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12254.94, "sample_time_ms": 1293.171, "learn_time_ms": 10900.178, "learn_throughput": 366.966, "synch_weights_time_ms": 60.817}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "8adec_00000", "date": "2024-07-24_15-04-43", "timestamp": 1721813683, "time_this_iter_s": 12.60877799987793, "time_total_s": 154.56740403175354, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc65b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.56740403175354, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.144444444444446, "ram_util_percent": 41.583333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.40388872226079, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.9561434569458167, "policy_loss": -0.015005044600305458, "vf_loss": 3.9784217618405817, "vf_explained_var": 0.968143295062085, "kl": 0.0174865491573049, "entropy": 1.2519240765521924, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -11.6605034775651, "episode_reward_min": -1164.6934816408564, "episode_reward_mean": -412.5167967507925, "episode_len_mean": 110.06, "episode_media": {}, "episodes_timesteps_total": 11006, "policy_reward_min": {"policy_0": -1164.6934816408564}, "policy_reward_max": {"policy_0": -11.6605034775651}, "policy_reward_mean": {"policy_0": -412.5167967507925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.94637261293059, -804.92416236436, -208.39928341533368, -548.7619568812368, -432.4298542511546, -844.3516025042495, -1131.3553337199214, -52.12760376574456, -138.35912571959716, -240.83100014973053, -927.8162493238909, -537.9941500110236, -862.3273196821975, -530.9878571934593, -462.2986726716968, -218.9900839964909, -109.07126483751117, -852.8957229504315, -960.5444797788471, -613.9573238441253, -418.0825623963127, -585.6027476036456, -47.58286553608121, -74.15064128817266, -257.63977796431396, -426.39268327381797, -20.672366014035, -197.240299207194, -556.0929790902671, -1164.6934816408564, -577.270599640371, -617.8638525802567, -111.20013332038266, -448.9398072805856, -305.54267475557424, -173.5164580681278, -289.58406315087734, -874.5270163301652, -398.72662171128644, -287.0821028440155, -568.9899864089307, -53.467239288524176, -138.2547511750199, -46.82875778585337, -40.96888254041265, -653.2205215677059, -81.9957042846322, -229.02816841195843, -912.1896523641811, -33.224279697306265, -471.953730722587, -67.17737341110848, -129.9200111370328, -555.9647019750404, -606.5822715262227, -177.40794952466632, -176.4484677446392, -26.372260131234338, -367.3882132971396, -329.5501749331883, -187.9282231950751, -96.945713585714, -537.914910864521, -11.6605034775651, -682.0443963015331, -1158.9458815129076, -808.5497098805449, -799.7112849976376, -261.2304172361048, -571.2619819805038, -561.8947092299727, -512.1168979397776, -221.54384885429207, -334.2515568557457, -592.8772451038872, -518.1950062239305, -638.4822899919027, -662.2031851296399, -299.5814819540284, -392.23365508282416, -86.30489195809209, -36.658422511447945, -717.8985431824688, -140.41817807761302, -228.55658237701437, -451.11309786487465, -639.3460808566581, -24.987759059146534, -486.3747877480754, -559.3111784291777, -914.1751432896142, -54.33087813781408, -598.1428679937356, -420.9597232487243, -428.8813993040168, -75.33506777838276, -373.81840047477476, -28.073524927897843, -572.7702172777866, -496.94377988617947], "episode_lengths": [60, 150, 78, 150, 150, 150, 150, 50, 68, 78, 150, 135, 150, 150, 129, 84, 51, 150, 150, 150, 108, 150, 38, 59, 77, 115, 39, 85, 150, 150, 150, 150, 71, 150, 150, 74, 105, 150, 99, 92, 150, 51, 65, 46, 48, 150, 49, 89, 150, 40, 150, 55, 70, 150, 150, 79, 72, 41, 111, 105, 63, 64, 150, 35, 150, 150, 150, 150, 104, 150, 141, 150, 89, 107, 150, 137, 150, 150, 119, 122, 58, 48, 150, 70, 74, 150, 150, 33, 150, 150, 150, 46, 142, 137, 120, 60, 126, 45, 150, 150], "policy_policy_0_reward": [-89.94637261293059, -804.92416236436, -208.39928341533368, -548.7619568812368, -432.4298542511546, -844.3516025042495, -1131.3553337199214, -52.12760376574456, -138.35912571959716, -240.83100014973053, -927.8162493238909, -537.9941500110236, -862.3273196821975, -530.9878571934593, -462.2986726716968, -218.9900839964909, -109.07126483751117, -852.8957229504315, -960.5444797788471, -613.9573238441253, -418.0825623963127, -585.6027476036456, -47.58286553608121, -74.15064128817266, -257.63977796431396, -426.39268327381797, -20.672366014035, -197.240299207194, -556.0929790902671, -1164.6934816408564, -577.270599640371, -617.8638525802567, -111.20013332038266, -448.9398072805856, -305.54267475557424, -173.5164580681278, -289.58406315087734, -874.5270163301652, -398.72662171128644, -287.0821028440155, -568.9899864089307, -53.467239288524176, -138.2547511750199, -46.82875778585337, -40.96888254041265, -653.2205215677059, -81.9957042846322, -229.02816841195843, -912.1896523641811, -33.224279697306265, -471.953730722587, -67.17737341110848, -129.9200111370328, -555.9647019750404, -606.5822715262227, -177.40794952466632, -176.4484677446392, -26.372260131234338, -367.3882132971396, -329.5501749331883, -187.9282231950751, -96.945713585714, -537.914910864521, -11.6605034775651, -682.0443963015331, -1158.9458815129076, -808.5497098805449, -799.7112849976376, -261.2304172361048, -571.2619819805038, -561.8947092299727, -512.1168979397776, -221.54384885429207, -334.2515568557457, -592.8772451038872, -518.1950062239305, -638.4822899919027, -662.2031851296399, -299.5814819540284, -392.23365508282416, -86.30489195809209, -36.658422511447945, -717.8985431824688, -140.41817807761302, -228.55658237701437, -451.11309786487465, -639.3460808566581, -24.987759059146534, -486.3747877480754, -559.3111784291777, -914.1751432896142, -54.33087813781408, -598.1428679937356, -420.9597232487243, -428.8813993040168, -75.33506777838276, -373.81840047477476, -28.073524927897843, -572.7702172777866, -496.94377988617947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5209699875763948, "mean_inference_ms": 1.5733635627263323, "mean_action_processing_ms": 0.26016296038908315, "mean_env_wait_ms": 3.5890508707230238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011120080947875977, "StateBufferConnector_ms": 0.007427215576171875, "ViewRequirementAgentConnector_ms": 0.17917132377624512}, "num_episodes": 34, "episode_return_max": -11.6605034775651, "episode_return_min": -1164.6934816408564, "episode_return_mean": -412.5167967507925, "episodes_this_iter": 34}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.0823577386321, "num_env_steps_trained_throughput_per_sec": 313.0823577386321, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12353.637, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12353.566, "sample_time_ms": 1295.071, "learn_time_ms": 11000.027, "learn_throughput": 363.635, "synch_weights_time_ms": 57.712}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "8adec_00000", "date": "2024-07-24_15-04-56", "timestamp": 1721813696, "time_this_iter_s": 12.78714632987976, "time_total_s": 167.3545503616333, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc663b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 167.3545503616333, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.68888888888889, "ram_util_percent": 41.29999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.44543409248193, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7513854631533223, "policy_loss": -0.014068951330167086, "vf_loss": 3.771692483872175, "vf_explained_var": 0.9702616410329938, "kl": 0.01981322917648261, "entropy": 1.218204212002456, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -11.6605034775651, "episode_reward_min": -1158.9458815129076, "episode_reward_mean": -342.0895047687573, "episode_len_mean": 103.24, "episode_media": {}, "episodes_timesteps_total": 10324, "policy_reward_min": {"policy_0": -1158.9458815129076}, "policy_reward_max": {"policy_0": -11.6605034775651}, "policy_reward_mean": {"policy_0": -342.0895047687573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.96888254041265, -653.2205215677059, -81.9957042846322, -229.02816841195843, -912.1896523641811, -33.224279697306265, -471.953730722587, -67.17737341110848, -129.9200111370328, -555.9647019750404, -606.5822715262227, -177.40794952466632, -176.4484677446392, -26.372260131234338, -367.3882132971396, -329.5501749331883, -187.9282231950751, -96.945713585714, -537.914910864521, -11.6605034775651, -682.0443963015331, -1158.9458815129076, -808.5497098805449, -799.7112849976376, -261.2304172361048, -571.2619819805038, -561.8947092299727, -512.1168979397776, -221.54384885429207, -334.2515568557457, -592.8772451038872, -518.1950062239305, -638.4822899919027, -662.2031851296399, -299.5814819540284, -392.23365508282416, -86.30489195809209, -36.658422511447945, -717.8985431824688, -140.41817807761302, -228.55658237701437, -451.11309786487465, -639.3460808566581, -24.987759059146534, -486.3747877480754, -559.3111784291777, -914.1751432896142, -54.33087813781408, -598.1428679937356, -420.9597232487243, -428.8813993040168, -75.33506777838276, -373.81840047477476, -28.073524927897843, -572.7702172777866, -496.94377988617947, -498.95780087028004, -88.61194446976052, -193.18258750297366, -84.53152318219114, -268.194205440281, -371.9352998128524, -399.84277687416477, -448.52324534045675, -142.90655606826124, -43.88031963370163, -723.2964729250418, -56.29978770643744, -48.397551940411674, -78.84974736265481, -620.7248530334255, -90.26166770739275, -349.78703225771426, -43.034134703892896, -113.70330882262029, -235.39049137334334, -364.8314578700122, -380.32262131903497, -478.9816604201341, -713.8410759782073, -59.10059460193817, -650.6833349436424, -318.07209690481534, -487.4676654484084, -481.54798982970595, -16.903602927539527, -125.58868308025899, -41.39397899682802, -70.8228260705092, -118.88922164699925, -88.16750819046754, -93.54318712390715, -353.0085214552706, -44.71372292203683, -1019.1995630748871, -474.3357072698061, -227.95348817349517, -403.0468929579528, -119.37356495844605, -133.48441663291524], "episode_lengths": [48, 150, 49, 89, 150, 40, 150, 55, 70, 150, 150, 79, 72, 41, 111, 105, 63, 64, 150, 35, 150, 150, 150, 150, 104, 150, 141, 150, 89, 107, 150, 137, 150, 150, 119, 122, 58, 48, 150, 70, 74, 150, 150, 33, 150, 150, 150, 46, 142, 137, 120, 60, 126, 45, 150, 150, 150, 63, 91, 54, 118, 136, 126, 150, 71, 48, 150, 54, 53, 56, 142, 61, 108, 42, 68, 97, 108, 118, 140, 150, 44, 127, 104, 150, 150, 35, 82, 43, 62, 71, 63, 50, 141, 42, 150, 150, 84, 128, 71, 74], "policy_policy_0_reward": [-40.96888254041265, -653.2205215677059, -81.9957042846322, -229.02816841195843, -912.1896523641811, -33.224279697306265, -471.953730722587, -67.17737341110848, -129.9200111370328, -555.9647019750404, -606.5822715262227, -177.40794952466632, -176.4484677446392, -26.372260131234338, -367.3882132971396, -329.5501749331883, -187.9282231950751, -96.945713585714, -537.914910864521, -11.6605034775651, -682.0443963015331, -1158.9458815129076, -808.5497098805449, -799.7112849976376, -261.2304172361048, -571.2619819805038, -561.8947092299727, -512.1168979397776, -221.54384885429207, -334.2515568557457, -592.8772451038872, -518.1950062239305, -638.4822899919027, -662.2031851296399, -299.5814819540284, -392.23365508282416, -86.30489195809209, -36.658422511447945, -717.8985431824688, -140.41817807761302, -228.55658237701437, -451.11309786487465, -639.3460808566581, -24.987759059146534, -486.3747877480754, -559.3111784291777, -914.1751432896142, -54.33087813781408, -598.1428679937356, -420.9597232487243, -428.8813993040168, -75.33506777838276, -373.81840047477476, -28.073524927897843, -572.7702172777866, -496.94377988617947, -498.95780087028004, -88.61194446976052, -193.18258750297366, -84.53152318219114, -268.194205440281, -371.9352998128524, -399.84277687416477, -448.52324534045675, -142.90655606826124, -43.88031963370163, -723.2964729250418, -56.29978770643744, -48.397551940411674, -78.84974736265481, -620.7248530334255, -90.26166770739275, -349.78703225771426, -43.034134703892896, -113.70330882262029, -235.39049137334334, -364.8314578700122, -380.32262131903497, -478.9816604201341, -713.8410759782073, -59.10059460193817, -650.6833349436424, -318.07209690481534, -487.4676654484084, -481.54798982970595, -16.903602927539527, -125.58868308025899, -41.39397899682802, -70.8228260705092, -118.88922164699925, -88.16750819046754, -93.54318712390715, -353.0085214552706, -44.71372292203683, -1019.1995630748871, -474.3357072698061, -227.95348817349517, -403.0468929579528, -119.37356495844605, -133.48441663291524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5198177232821787, "mean_inference_ms": 1.5700977246251233, "mean_action_processing_ms": 0.2594962267916053, "mean_env_wait_ms": 3.594446304697887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010934829711914062, "StateBufferConnector_ms": 0.007290363311767578, "ViewRequirementAgentConnector_ms": 0.1787118911743164}, "num_episodes": 44, "episode_return_max": -11.6605034775651, "episode_return_min": -1158.9458815129076, "episode_return_mean": -342.0895047687573, "episodes_this_iter": 44}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.33679512299796, "num_env_steps_trained_throughput_per_sec": 422.33679512299796, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12088.738, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12088.666, "sample_time_ms": 1298.641, "learn_time_ms": 10732.059, "learn_throughput": 372.715, "synch_weights_time_ms": 57.17}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "8adec_00000", "date": "2024-07-24_15-05-06", "timestamp": 1721813706, "time_this_iter_s": 9.48275351524353, "time_total_s": 176.83730387687683, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bb93e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.83730387687683, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.549999999999994, "ram_util_percent": 41.32857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.90529565016429, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.006099570294221, "policy_loss": -0.021380355811076394, "vf_loss": 3.0320263990511496, "vf_explained_var": 0.9872819822281599, "kl": 0.019727229712952977, "entropy": 1.0464637865001956, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -0.8935343260012454, "episode_reward_min": -1019.1995630748871, "episode_reward_mean": -263.2557687171009, "episode_len_mean": 94.9, "episode_media": {}, "episodes_timesteps_total": 9490, "policy_reward_min": {"policy_0": -1019.1995630748871}, "policy_reward_max": {"policy_0": -0.8935343260012454}, "policy_reward_mean": {"policy_0": -263.2557687171009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-598.1428679937356, -420.9597232487243, -428.8813993040168, -75.33506777838276, -373.81840047477476, -28.073524927897843, -572.7702172777866, -496.94377988617947, -498.95780087028004, -88.61194446976052, -193.18258750297366, -84.53152318219114, -268.194205440281, -371.9352998128524, -399.84277687416477, -448.52324534045675, -142.90655606826124, -43.88031963370163, -723.2964729250418, -56.29978770643744, -48.397551940411674, -78.84974736265481, -620.7248530334255, -90.26166770739275, -349.78703225771426, -43.034134703892896, -113.70330882262029, -235.39049137334334, -364.8314578700122, -380.32262131903497, -478.9816604201341, -713.8410759782073, -59.10059460193817, -650.6833349436424, -318.07209690481534, -487.4676654484084, -481.54798982970595, -16.903602927539527, -125.58868308025899, -41.39397899682802, -70.8228260705092, -118.88922164699925, -88.16750819046754, -93.54318712390715, -353.0085214552706, -44.71372292203683, -1019.1995630748871, -474.3357072698061, -227.95348817349517, -403.0468929579528, -119.37356495844605, -133.48441663291524, -620.1260155841917, -274.3626766845998, -477.5145394323412, -360.18542980049693, -240.02449510685045, -219.98937131009328, -634.8842096117235, -344.0912293798781, -6.550665981212781, -48.879435914054326, -22.917107202751794, -575.3281213102763, -14.005810778588712, -438.40364288537745, -235.24580098082316, -1.5411288514241337, -83.78016112992867, -157.70740044459632, -74.29940812005268, -115.16993533877975, -111.71057657459981, -396.24812729068316, -13.611673013818077, -65.63605324619546, -352.5636448537693, -230.1258856080632, -429.65088846451226, -479.4733869348666, -292.50425195376494, -110.67545876619218, -141.10833922131508, -52.37402848774369, -361.2507102644589, -52.4614621746848, -230.6737757726371, -300.1104975602758, -0.8935343260012454, -306.8954531932657, -502.66973488189313, -115.84924356653346, -215.01755468108266, -255.32816177379684, -98.86035051463406, -32.27881953919928, -533.6284042679802, -81.28810211695846, -231.6283609289244, -225.54413516762654], "episode_lengths": [142, 137, 120, 60, 126, 45, 150, 150, 150, 63, 91, 54, 118, 136, 126, 150, 71, 48, 150, 54, 53, 56, 142, 61, 108, 42, 68, 97, 108, 118, 140, 150, 44, 127, 104, 150, 150, 35, 82, 43, 62, 71, 63, 50, 141, 42, 150, 150, 84, 128, 71, 74, 150, 98, 145, 110, 113, 84, 150, 138, 32, 53, 41, 147, 31, 147, 98, 31, 61, 87, 60, 78, 65, 133, 35, 57, 118, 103, 126, 150, 106, 60, 75, 55, 120, 54, 95, 129, 33, 105, 150, 68, 94, 94, 68, 40, 148, 61, 103, 86], "policy_policy_0_reward": [-598.1428679937356, -420.9597232487243, -428.8813993040168, -75.33506777838276, -373.81840047477476, -28.073524927897843, -572.7702172777866, -496.94377988617947, -498.95780087028004, -88.61194446976052, -193.18258750297366, -84.53152318219114, -268.194205440281, -371.9352998128524, -399.84277687416477, -448.52324534045675, -142.90655606826124, -43.88031963370163, -723.2964729250418, -56.29978770643744, -48.397551940411674, -78.84974736265481, -620.7248530334255, -90.26166770739275, -349.78703225771426, -43.034134703892896, -113.70330882262029, -235.39049137334334, -364.8314578700122, -380.32262131903497, -478.9816604201341, -713.8410759782073, -59.10059460193817, -650.6833349436424, -318.07209690481534, -487.4676654484084, -481.54798982970595, -16.903602927539527, -125.58868308025899, -41.39397899682802, -70.8228260705092, -118.88922164699925, -88.16750819046754, -93.54318712390715, -353.0085214552706, -44.71372292203683, -1019.1995630748871, -474.3357072698061, -227.95348817349517, -403.0468929579528, -119.37356495844605, -133.48441663291524, -620.1260155841917, -274.3626766845998, -477.5145394323412, -360.18542980049693, -240.02449510685045, -219.98937131009328, -634.8842096117235, -344.0912293798781, -6.550665981212781, -48.879435914054326, -22.917107202751794, -575.3281213102763, -14.005810778588712, -438.40364288537745, -235.24580098082316, -1.5411288514241337, -83.78016112992867, -157.70740044459632, -74.29940812005268, -115.16993533877975, -111.71057657459981, -396.24812729068316, -13.611673013818077, -65.63605324619546, -352.5636448537693, -230.1258856080632, -429.65088846451226, -479.4733869348666, -292.50425195376494, -110.67545876619218, -141.10833922131508, -52.37402848774369, -361.2507102644589, -52.4614621746848, -230.6737757726371, -300.1104975602758, -0.8935343260012454, -306.8954531932657, -502.66973488189313, -115.84924356653346, -215.01755468108266, -255.32816177379684, -98.86035051463406, -32.27881953919928, -533.6284042679802, -81.28810211695846, -231.6283609289244, -225.54413516762654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5191758476730347, "mean_inference_ms": 1.566913258242398, "mean_action_processing_ms": 0.2588467106850285, "mean_env_wait_ms": 3.6014727164264673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011418819427490234, "StateBufferConnector_ms": 0.007432460784912109, "ViewRequirementAgentConnector_ms": 0.181532621383667}, "num_episodes": 48, "episode_return_max": -0.8935343260012454, "episode_return_min": -1019.1995630748871, "episode_return_mean": -263.2557687171009, "episodes_this_iter": 48}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.0471390426205, "num_env_steps_trained_throughput_per_sec": 337.0471390426205, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 11986.792, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11986.719, "sample_time_ms": 1302.295, "learn_time_ms": 10627.993, "learn_throughput": 376.365, "synch_weights_time_ms": 55.623}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "8adec_00000", "date": "2024-07-24_15-05-18", "timestamp": 1721813718, "time_this_iter_s": 11.879268646240234, "time_total_s": 188.71657252311707, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf1d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.71657252311707, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.88823529411765, "ram_util_percent": 38.417647058823526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.15429175098737, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.7553739666938784, "policy_loss": -0.016033156193831624, "vf_loss": 2.7753019209951164, "vf_explained_var": 0.9904594472919901, "kl": 0.018265369124916723, "entropy": 0.9374406496062875, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -0.8935343260012454, "episode_reward_min": -634.8842096117235, "episode_reward_mean": -202.43668934971484, "episode_len_mean": 84.84, "episode_media": {}, "episodes_timesteps_total": 8484, "policy_reward_min": {"policy_0": -634.8842096117235}, "policy_reward_max": {"policy_0": -0.8935343260012454}, "policy_reward_mean": {"policy_0": -202.43668934971484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-133.48441663291524, -620.1260155841917, -274.3626766845998, -477.5145394323412, -360.18542980049693, -240.02449510685045, -219.98937131009328, -634.8842096117235, -344.0912293798781, -6.550665981212781, -48.879435914054326, -22.917107202751794, -575.3281213102763, -14.005810778588712, -438.40364288537745, -235.24580098082316, -1.5411288514241337, -83.78016112992867, -157.70740044459632, -74.29940812005268, -115.16993533877975, -111.71057657459981, -396.24812729068316, -13.611673013818077, -65.63605324619546, -352.5636448537693, -230.1258856080632, -429.65088846451226, -479.4733869348666, -292.50425195376494, -110.67545876619218, -141.10833922131508, -52.37402848774369, -361.2507102644589, -52.4614621746848, -230.6737757726371, -300.1104975602758, -0.8935343260012454, -306.8954531932657, -502.66973488189313, -115.84924356653346, -215.01755468108266, -255.32816177379684, -98.86035051463406, -32.27881953919928, -533.6284042679802, -81.28810211695846, -231.6283609289244, -225.54413516762654, -252.777513847822, -28.992517227857114, -363.57042621771046, -174.06294139540145, -245.59380373601826, -50.64823143192963, -171.78096545373387, -184.4138260254974, -301.1788651061842, -57.79908923865183, -201.1397240088192, -372.7206967720787, -290.250411736643, -194.4731483068837, -67.34831059388547, -96.46351169084258, -436.1299992239319, -350.92680013215454, -27.310492294381824, -8.181905801529657, -293.2806639047948, -81.7111234266766, -62.13479606885515, -63.311236665084394, -47.003521526494076, -307.04661305473365, -93.91721186275919, -13.79854286722316, -48.60929049258674, -96.71996350609834, -186.3023857375841, -219.7745803255138, -18.763004037218952, -93.82685503918687, -158.12451898365265, -188.6744879244661, -119.18769024899967, -149.9847433480213, -59.21378474134741, -246.13540346440058, -282.09473621099664, -502.49146901182246, -89.61641748126051, -101.57260095776631, -217.7333812711043, -154.055632958641, -273.4647998800142, -337.435485360861, -349.11125235887476, -184.14403795362034, -30.11390643243345], "episode_lengths": [74, 150, 98, 145, 110, 113, 84, 150, 138, 32, 53, 41, 147, 31, 147, 98, 31, 61, 87, 60, 78, 65, 133, 35, 57, 118, 103, 126, 150, 106, 60, 75, 55, 120, 54, 95, 129, 33, 105, 150, 68, 94, 94, 68, 40, 148, 61, 103, 86, 93, 41, 121, 84, 88, 56, 79, 76, 105, 53, 96, 129, 101, 83, 60, 57, 133, 108, 46, 33, 99, 56, 46, 59, 53, 123, 65, 35, 57, 68, 84, 92, 37, 61, 73, 81, 72, 73, 56, 94, 104, 148, 63, 64, 88, 78, 88, 109, 113, 97, 47], "policy_policy_0_reward": [-133.48441663291524, -620.1260155841917, -274.3626766845998, -477.5145394323412, -360.18542980049693, -240.02449510685045, -219.98937131009328, -634.8842096117235, -344.0912293798781, -6.550665981212781, -48.879435914054326, -22.917107202751794, -575.3281213102763, -14.005810778588712, -438.40364288537745, -235.24580098082316, -1.5411288514241337, -83.78016112992867, -157.70740044459632, -74.29940812005268, -115.16993533877975, -111.71057657459981, -396.24812729068316, -13.611673013818077, -65.63605324619546, -352.5636448537693, -230.1258856080632, -429.65088846451226, -479.4733869348666, -292.50425195376494, -110.67545876619218, -141.10833922131508, -52.37402848774369, -361.2507102644589, -52.4614621746848, -230.6737757726371, -300.1104975602758, -0.8935343260012454, -306.8954531932657, -502.66973488189313, -115.84924356653346, -215.01755468108266, -255.32816177379684, -98.86035051463406, -32.27881953919928, -533.6284042679802, -81.28810211695846, -231.6283609289244, -225.54413516762654, -252.777513847822, -28.992517227857114, -363.57042621771046, -174.06294139540145, -245.59380373601826, -50.64823143192963, -171.78096545373387, -184.4138260254974, -301.1788651061842, -57.79908923865183, -201.1397240088192, -372.7206967720787, -290.250411736643, -194.4731483068837, -67.34831059388547, -96.46351169084258, -436.1299992239319, -350.92680013215454, -27.310492294381824, -8.181905801529657, -293.2806639047948, -81.7111234266766, -62.13479606885515, -63.311236665084394, -47.003521526494076, -307.04661305473365, -93.91721186275919, -13.79854286722316, -48.60929049258674, -96.71996350609834, -186.3023857375841, -219.7745803255138, -18.763004037218952, -93.82685503918687, -158.12451898365265, -188.6744879244661, -119.18769024899967, -149.9847433480213, -59.21378474134741, -246.13540346440058, -282.09473621099664, -502.49146901182246, -89.61641748126051, -101.57260095776631, -217.7333812711043, -154.055632958641, -273.4647998800142, -337.435485360861, -349.11125235887476, -184.14403795362034, -30.11390643243345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5201714194392716, "mean_inference_ms": 1.565985925781009, "mean_action_processing_ms": 0.25857575585638554, "mean_env_wait_ms": 3.6145245318432484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011583566665649414, "StateBufferConnector_ms": 0.007354736328125, "ViewRequirementAgentConnector_ms": 0.17926526069641113}, "num_episodes": 51, "episode_return_max": -0.8935343260012454, "episode_return_min": -634.8842096117235, "episode_return_mean": -202.43668934971484, "episodes_this_iter": 51}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.6935478901888, "num_env_steps_trained_throughput_per_sec": 358.6935478901888, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 11941.096, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11941.022, "sample_time_ms": 1308.457, "learn_time_ms": 10576.447, "learn_throughput": 378.199, "synch_weights_time_ms": 55.305}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "8adec_00000", "date": "2024-07-24_15-05-29", "timestamp": 1721813729, "time_this_iter_s": 11.163578987121582, "time_total_s": 199.88015151023865, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf1bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.88015151023865, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.9875, "ram_util_percent": 37.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.1781326343616, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.094982506831487, "policy_loss": -0.021954106053938934, "vf_loss": 2.1214826765159764, "vf_explained_var": 0.9942129773398241, "kl": 0.018687499288383456, "entropy": 1.0152315347145, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -5.499479540366176, "episode_reward_min": -632.0209559528921, "episode_reward_mean": -167.71711626164193, "episode_len_mean": 77.89, "episode_media": {}, "episodes_timesteps_total": 7789, "policy_reward_min": {"policy_0": -632.0209559528921}, "policy_reward_max": {"policy_0": -5.499479540366176}, "policy_reward_mean": {"policy_0": -167.71711626164193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.06294139540145, -245.59380373601826, -50.64823143192963, -171.78096545373387, -184.4138260254974, -301.1788651061842, -57.79908923865183, -201.1397240088192, -372.7206967720787, -290.250411736643, -194.4731483068837, -67.34831059388547, -96.46351169084258, -436.1299992239319, -350.92680013215454, -27.310492294381824, -8.181905801529657, -293.2806639047948, -81.7111234266766, -62.13479606885515, -63.311236665084394, -47.003521526494076, -307.04661305473365, -93.91721186275919, -13.79854286722316, -48.60929049258674, -96.71996350609834, -186.3023857375841, -219.7745803255138, -18.763004037218952, -93.82685503918687, -158.12451898365265, -188.6744879244661, -119.18769024899967, -149.9847433480213, -59.21378474134741, -246.13540346440058, -282.09473621099664, -502.49146901182246, -89.61641748126051, -101.57260095776631, -217.7333812711043, -154.055632958641, -273.4647998800142, -337.435485360861, -349.11125235887476, -184.14403795362034, -30.11390643243345, -495.96372905480206, -247.27086534455697, -112.03565378675223, -281.35301030245336, -46.04976438893379, -212.86276305762618, -104.7588458820268, -86.42364560430423, -50.21602040735808, -56.09039306131286, -51.23291687445038, -557.2762972296264, -33.72601639881953, -632.0209559528921, -327.56186357942045, -352.7650355839878, -18.528957293830945, -226.37644798926956, -67.11057013633656, -203.89618459556473, -51.227167113184706, -204.66768083492897, -33.10813906761618, -78.51076222965962, -142.90053292570494, -11.213271568848423, -40.756454186739084, -14.820235556533506, -38.08674886893622, -213.76987093276045, -264.1932365944135, -269.2058205265072, -364.17294588470475, -99.64904144638841, -181.77694745398557, -106.51564569890913, -92.11896251705664, -159.43703280929554, -162.05182945034375, -5.499479540366176, -120.23542922314103, -72.18446146885339, -232.37849013509313, -50.86792429212614, -250.77543813540512, -168.76449697647962, -110.3090414576905, -105.86378467503792, -278.93504167885374, -190.949448593638, -170.8492101708313, -22.620257574174417], "episode_lengths": [84, 88, 56, 79, 76, 105, 53, 96, 129, 101, 83, 60, 57, 133, 108, 46, 33, 99, 56, 46, 59, 53, 123, 65, 35, 57, 68, 84, 92, 37, 61, 73, 81, 72, 73, 56, 94, 104, 148, 63, 64, 88, 78, 88, 109, 113, 97, 47, 150, 94, 73, 104, 49, 89, 67, 54, 51, 53, 58, 150, 49, 150, 112, 121, 38, 102, 58, 97, 50, 90, 37, 60, 80, 44, 52, 37, 50, 98, 97, 100, 125, 66, 86, 63, 62, 77, 72, 36, 72, 59, 108, 55, 93, 80, 65, 65, 102, 98, 80, 41], "policy_policy_0_reward": [-174.06294139540145, -245.59380373601826, -50.64823143192963, -171.78096545373387, -184.4138260254974, -301.1788651061842, -57.79908923865183, -201.1397240088192, -372.7206967720787, -290.250411736643, -194.4731483068837, -67.34831059388547, -96.46351169084258, -436.1299992239319, -350.92680013215454, -27.310492294381824, -8.181905801529657, -293.2806639047948, -81.7111234266766, -62.13479606885515, -63.311236665084394, -47.003521526494076, -307.04661305473365, -93.91721186275919, -13.79854286722316, -48.60929049258674, -96.71996350609834, -186.3023857375841, -219.7745803255138, -18.763004037218952, -93.82685503918687, -158.12451898365265, -188.6744879244661, -119.18769024899967, -149.9847433480213, -59.21378474134741, -246.13540346440058, -282.09473621099664, -502.49146901182246, -89.61641748126051, -101.57260095776631, -217.7333812711043, -154.055632958641, -273.4647998800142, -337.435485360861, -349.11125235887476, -184.14403795362034, -30.11390643243345, -495.96372905480206, -247.27086534455697, -112.03565378675223, -281.35301030245336, -46.04976438893379, -212.86276305762618, -104.7588458820268, -86.42364560430423, -50.21602040735808, -56.09039306131286, -51.23291687445038, -557.2762972296264, -33.72601639881953, -632.0209559528921, -327.56186357942045, -352.7650355839878, -18.528957293830945, -226.37644798926956, -67.11057013633656, -203.89618459556473, -51.227167113184706, -204.66768083492897, -33.10813906761618, -78.51076222965962, -142.90053292570494, -11.213271568848423, -40.756454186739084, -14.820235556533506, -38.08674886893622, -213.76987093276045, -264.1932365944135, -269.2058205265072, -364.17294588470475, -99.64904144638841, -181.77694745398557, -106.51564569890913, -92.11896251705664, -159.43703280929554, -162.05182945034375, -5.499479540366176, -120.23542922314103, -72.18446146885339, -232.37849013509313, -50.86792429212614, -250.77543813540512, -168.76449697647962, -110.3090414576905, -105.86378467503792, -278.93504167885374, -190.949448593638, -170.8492101708313, -22.620257574174417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5193420938315869, "mean_inference_ms": 1.5642536532240272, "mean_action_processing_ms": 0.2582643092501311, "mean_env_wait_ms": 3.623788360389309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011058807373046875, "StateBufferConnector_ms": 0.007361173629760742, "ViewRequirementAgentConnector_ms": 0.17879700660705566}, "num_episodes": 52, "episode_return_max": -5.499479540366176, "episode_return_min": -632.0209559528921, "episode_return_mean": -167.71711626164193, "episodes_this_iter": 52}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.4000405351261, "num_env_steps_trained_throughput_per_sec": 319.4000405351261, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 11859.705, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11859.631, "sample_time_ms": 1301.245, "learn_time_ms": 10502.23, "learn_throughput": 380.871, "synch_weights_time_ms": 55.342}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "8adec_00000", "date": "2024-07-24_15-05-42", "timestamp": 1721813742, "time_this_iter_s": 12.534772872924805, "time_total_s": 212.41492438316345, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf3d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.41492438316345, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.072222222222223, "ram_util_percent": 37.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.84511738320192, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.788428085607787, "policy_loss": -0.018522799863421823, "vf_loss": 1.8116459101438522, "vf_explained_var": 0.9942665442203482, "kl": 0.016999043874511715, "entropy": 0.9794735245406627, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": 5.5576905034307025, "episode_reward_min": -632.0209559528921, "episode_reward_mean": -150.65932316201992, "episode_len_mean": 74.82, "episode_media": {}, "episodes_timesteps_total": 7482, "policy_reward_min": {"policy_0": -632.0209559528921}, "policy_reward_max": {"policy_0": 5.5576905034307025}, "policy_reward_mean": {"policy_0": -150.65932316201992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.21602040735808, -56.09039306131286, -51.23291687445038, -557.2762972296264, -33.72601639881953, -632.0209559528921, -327.56186357942045, -352.7650355839878, -18.528957293830945, -226.37644798926956, -67.11057013633656, -203.89618459556473, -51.227167113184706, -204.66768083492897, -33.10813906761618, -78.51076222965962, -142.90053292570494, -11.213271568848423, -40.756454186739084, -14.820235556533506, -38.08674886893622, -213.76987093276045, -264.1932365944135, -269.2058205265072, -364.17294588470475, -99.64904144638841, -181.77694745398557, -106.51564569890913, -92.11896251705664, -159.43703280929554, -162.05182945034375, -5.499479540366176, -120.23542922314103, -72.18446146885339, -232.37849013509313, -50.86792429212614, -250.77543813540512, -168.76449697647962, -110.3090414576905, -105.86378467503792, -278.93504167885374, -190.949448593638, -170.8492101708313, -22.620257574174417, -197.69514019795398, -226.2005398745162, -122.45770676634363, -265.7706501859007, -25.946761284095, -548.3099560631948, -102.56042316554473, -215.73562409525104, -88.4483978222717, -235.0368145351784, -372.1813505385337, -16.114214614334042, -35.07201754399216, -17.72243774656957, -305.1381253046356, -37.42987679574612, -35.705462635285336, -159.8287453473011, -328.7049455279971, -237.69485644154298, -27.124889249909657, -315.0559565774288, -236.11613506132738, -44.99539713700076, -166.31357152993797, -124.71036249866589, -108.14716860979127, 5.5576905034307025, -127.23614093592899, -0.5271237698689081, -14.649264266081113, -99.50516837022731, -54.11356015549975, -299.37554367926174, -44.00970930830815, -32.10828624294858, -287.00053954274466, -127.52918419677418, -67.63339698071479, -16.388053871883656, -224.771859869928, -207.26401509067728, -187.41446963576357, -297.82597071049815, -164.71631975869587, -160.827479965175, -58.88094399297927, -234.23009299327478, -265.87337212415923, -74.57604895902018, -73.18893716228013, -166.61097733902062, -22.543320223736806, -172.524873049832, -86.17992123822262, -22.551417430593812], "episode_lengths": [51, 53, 58, 150, 49, 150, 112, 121, 38, 102, 58, 97, 50, 90, 37, 60, 80, 44, 52, 37, 50, 98, 97, 100, 125, 66, 86, 63, 62, 77, 72, 36, 72, 59, 108, 55, 93, 80, 65, 65, 102, 98, 80, 41, 99, 91, 72, 96, 43, 146, 65, 93, 67, 116, 130, 37, 43, 38, 110, 42, 52, 74, 113, 100, 39, 112, 95, 55, 96, 69, 70, 33, 70, 30, 37, 66, 58, 115, 51, 43, 101, 68, 56, 37, 93, 89, 84, 105, 78, 82, 57, 90, 99, 58, 63, 95, 44, 80, 60, 38], "policy_policy_0_reward": [-50.21602040735808, -56.09039306131286, -51.23291687445038, -557.2762972296264, -33.72601639881953, -632.0209559528921, -327.56186357942045, -352.7650355839878, -18.528957293830945, -226.37644798926956, -67.11057013633656, -203.89618459556473, -51.227167113184706, -204.66768083492897, -33.10813906761618, -78.51076222965962, -142.90053292570494, -11.213271568848423, -40.756454186739084, -14.820235556533506, -38.08674886893622, -213.76987093276045, -264.1932365944135, -269.2058205265072, -364.17294588470475, -99.64904144638841, -181.77694745398557, -106.51564569890913, -92.11896251705664, -159.43703280929554, -162.05182945034375, -5.499479540366176, -120.23542922314103, -72.18446146885339, -232.37849013509313, -50.86792429212614, -250.77543813540512, -168.76449697647962, -110.3090414576905, -105.86378467503792, -278.93504167885374, -190.949448593638, -170.8492101708313, -22.620257574174417, -197.69514019795398, -226.2005398745162, -122.45770676634363, -265.7706501859007, -25.946761284095, -548.3099560631948, -102.56042316554473, -215.73562409525104, -88.4483978222717, -235.0368145351784, -372.1813505385337, -16.114214614334042, -35.07201754399216, -17.72243774656957, -305.1381253046356, -37.42987679574612, -35.705462635285336, -159.8287453473011, -328.7049455279971, -237.69485644154298, -27.124889249909657, -315.0559565774288, -236.11613506132738, -44.99539713700076, -166.31357152993797, -124.71036249866589, -108.14716860979127, 5.5576905034307025, -127.23614093592899, -0.5271237698689081, -14.649264266081113, -99.50516837022731, -54.11356015549975, -299.37554367926174, -44.00970930830815, -32.10828624294858, -287.00053954274466, -127.52918419677418, -67.63339698071479, -16.388053871883656, -224.771859869928, -207.26401509067728, -187.41446963576357, -297.82597071049815, -164.71631975869587, -160.827479965175, -58.88094399297927, -234.23009299327478, -265.87337212415923, -74.57604895902018, -73.18893716228013, -166.61097733902062, -22.543320223736806, -172.524873049832, -86.17992123822262, -22.551417430593812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5191746940912938, "mean_inference_ms": 1.5617468505783634, "mean_action_processing_ms": 0.25772952609462374, "mean_env_wait_ms": 3.6271579966602787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010682344436645508, "StateBufferConnector_ms": 0.0073089599609375, "ViewRequirementAgentConnector_ms": 0.1754922866821289}, "num_episodes": 56, "episode_return_max": 5.5576905034307025, "episode_return_min": -632.0209559528921, "episode_return_mean": -150.65932316201992, "episodes_this_iter": 56}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.53510656959475, "num_env_steps_trained_throughput_per_sec": 306.53510656959475, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12050.001, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12049.923, "sample_time_ms": 1305.123, "learn_time_ms": 10688.833, "learn_throughput": 374.222, "synch_weights_time_ms": 55.155}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "8adec_00000", "date": "2024-07-24_15-05-55", "timestamp": 1721813755, "time_this_iter_s": 13.059595346450806, "time_total_s": 225.47451972961426, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc65510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.47451972961426, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.600000000000005, "ram_util_percent": 37.80555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.74804730713367, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.5949279457951586, "policy_loss": -0.022798734471143688, "vf_loss": 1.6208210388819377, "vf_explained_var": 0.9966853681951762, "kl": 0.02010195230541285, "entropy": 0.9124944801752766, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 5.5576905034307025, "episode_reward_min": -461.8665292634533, "episode_reward_mean": -129.6002568540097, "episode_len_mean": 70.56, "episode_media": {}, "episodes_timesteps_total": 7056, "policy_reward_min": {"policy_0": -461.8665292634533}, "policy_reward_max": {"policy_0": 5.5576905034307025}, "policy_reward_mean": {"policy_0": -129.6002568540097}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305.1381253046356, -37.42987679574612, -35.705462635285336, -159.8287453473011, -328.7049455279971, -237.69485644154298, -27.124889249909657, -315.0559565774288, -236.11613506132738, -44.99539713700076, -166.31357152993797, -124.71036249866589, -108.14716860979127, 5.5576905034307025, -127.23614093592899, -0.5271237698689081, -14.649264266081113, -99.50516837022731, -54.11356015549975, -299.37554367926174, -44.00970930830815, -32.10828624294858, -287.00053954274466, -127.52918419677418, -67.63339698071479, -16.388053871883656, -224.771859869928, -207.26401509067728, -187.41446963576357, -297.82597071049815, -164.71631975869587, -160.827479965175, -58.88094399297927, -234.23009299327478, -265.87337212415923, -74.57604895902018, -73.18893716228013, -166.61097733902062, -22.543320223736806, -172.524873049832, -86.17992123822262, -22.551417430593812, -171.14459245267412, -37.60615978283077, -18.100012019089913, -2.53520754002305, -319.19529315726334, -262.69143386304756, -78.54841619217976, -317.0948770071061, -461.8665292634533, -101.35085801652495, -107.62033479279656, -243.5218777102686, -305.371239845051, -5.04666160133295, -179.9088650392919, -112.55221724990997, -157.45342018987856, -190.63322253951864, -21.521208423628305, -181.89835004491584, -54.979979731550536, -52.72857135672002, -61.57445975986712, -296.42407346092006, -101.70130909909206, -169.13861504632754, -121.75656374920241, -156.0801780335342, -9.53290355741902, -190.14644709894117, -53.016235135263514, -16.215745567445392, -128.60075285700972, -80.35409170252079, -168.73085969933447, -174.27056275848096, -78.32744355440673, -201.81460318280355, -40.509416596628725, -7.187202932069736, -41.77777213995089, -23.087128348683965, 3.5383196621466393, -9.77174600784827, -158.14138304481654, -3.977542566014042, -40.63664264084033, -144.67185513161422, -96.86620004566083, -48.123924271235424, -196.08468565616292, -198.19184661971028, -63.62334713670963, -47.90712961935078, -252.17431455650447, -48.87340892283623, -283.39141264493617, -156.04908102268092], "episode_lengths": [110, 42, 52, 74, 113, 100, 39, 112, 95, 55, 96, 69, 70, 33, 70, 30, 37, 66, 58, 115, 51, 43, 101, 68, 56, 37, 93, 89, 84, 105, 78, 82, 57, 90, 99, 58, 63, 95, 44, 80, 60, 38, 76, 52, 46, 34, 112, 95, 56, 111, 145, 81, 69, 92, 105, 35, 81, 70, 76, 85, 43, 82, 56, 58, 63, 107, 64, 89, 67, 90, 38, 88, 56, 40, 71, 62, 84, 81, 60, 98, 49, 35, 45, 44, 32, 33, 76, 33, 53, 77, 72, 58, 87, 99, 53, 56, 99, 48, 104, 78], "policy_policy_0_reward": [-305.1381253046356, -37.42987679574612, -35.705462635285336, -159.8287453473011, -328.7049455279971, -237.69485644154298, -27.124889249909657, -315.0559565774288, -236.11613506132738, -44.99539713700076, -166.31357152993797, -124.71036249866589, -108.14716860979127, 5.5576905034307025, -127.23614093592899, -0.5271237698689081, -14.649264266081113, -99.50516837022731, -54.11356015549975, -299.37554367926174, -44.00970930830815, -32.10828624294858, -287.00053954274466, -127.52918419677418, -67.63339698071479, -16.388053871883656, -224.771859869928, -207.26401509067728, -187.41446963576357, -297.82597071049815, -164.71631975869587, -160.827479965175, -58.88094399297927, -234.23009299327478, -265.87337212415923, -74.57604895902018, -73.18893716228013, -166.61097733902062, -22.543320223736806, -172.524873049832, -86.17992123822262, -22.551417430593812, -171.14459245267412, -37.60615978283077, -18.100012019089913, -2.53520754002305, -319.19529315726334, -262.69143386304756, -78.54841619217976, -317.0948770071061, -461.8665292634533, -101.35085801652495, -107.62033479279656, -243.5218777102686, -305.371239845051, -5.04666160133295, -179.9088650392919, -112.55221724990997, -157.45342018987856, -190.63322253951864, -21.521208423628305, -181.89835004491584, -54.979979731550536, -52.72857135672002, -61.57445975986712, -296.42407346092006, -101.70130909909206, -169.13861504632754, -121.75656374920241, -156.0801780335342, -9.53290355741902, -190.14644709894117, -53.016235135263514, -16.215745567445392, -128.60075285700972, -80.35409170252079, -168.73085969933447, -174.27056275848096, -78.32744355440673, -201.81460318280355, -40.509416596628725, -7.187202932069736, -41.77777213995089, -23.087128348683965, 3.5383196621466393, -9.77174600784827, -158.14138304481654, -3.977542566014042, -40.63664264084033, -144.67185513161422, -96.86620004566083, -48.123924271235424, -196.08468565616292, -198.19184661971028, -63.62334713670963, -47.90712961935078, -252.17431455650447, -48.87340892283623, -283.39141264493617, -156.04908102268092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5193909840639725, "mean_inference_ms": 1.5600592027645859, "mean_action_processing_ms": 0.25755036730243025, "mean_env_wait_ms": 3.6343316379760706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01096653938293457, "StateBufferConnector_ms": 0.00726628303527832, "ViewRequirementAgentConnector_ms": 0.17449402809143066}, "num_episodes": 58, "episode_return_max": 5.5576905034307025, "episode_return_min": -461.8665292634533, "episode_return_mean": -129.6002568540097, "episodes_this_iter": 58}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.06778726958527, "num_env_steps_trained_throughput_per_sec": 313.06778726958527, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12222.468, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12222.393, "sample_time_ms": 1312.01, "learn_time_ms": 10855.848, "learn_throughput": 368.465, "synch_weights_time_ms": 53.725}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "8adec_00000", "date": "2024-07-24_15-06-08", "timestamp": 1721813768, "time_this_iter_s": 12.788938522338867, "time_total_s": 238.26345825195312, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc66cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.26345825195312, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.426315789473687, "ram_util_percent": 37.81052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.75633233288924, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.7026780361309648, "policy_loss": -0.01764316129507885, "vf_loss": 1.7220186884204547, "vf_explained_var": 0.9940823166941603, "kl": 0.01546991531812032, "entropy": 0.865895606763661, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 5.604200920672646, "episode_reward_min": -296.42407346092006, "episode_reward_mean": -100.28317056233152, "episode_len_mean": 65.24, "episode_media": {}, "episodes_timesteps_total": 6524, "policy_reward_min": {"policy_0": -296.42407346092006}, "policy_reward_max": {"policy_0": 5.604200920672646}, "policy_reward_mean": {"policy_0": -100.28317056233152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.63322253951864, -21.521208423628305, -181.89835004491584, -54.979979731550536, -52.72857135672002, -61.57445975986712, -296.42407346092006, -101.70130909909206, -169.13861504632754, -121.75656374920241, -156.0801780335342, -9.53290355741902, -190.14644709894117, -53.016235135263514, -16.215745567445392, -128.60075285700972, -80.35409170252079, -168.73085969933447, -174.27056275848096, -78.32744355440673, -201.81460318280355, -40.509416596628725, -7.187202932069736, -41.77777213995089, -23.087128348683965, 3.5383196621466393, -9.77174600784827, -158.14138304481654, -3.977542566014042, -40.63664264084033, -144.67185513161422, -96.86620004566083, -48.123924271235424, -196.08468565616292, -198.19184661971028, -63.62334713670963, -47.90712961935078, -252.17431455650447, -48.87340892283623, -283.39141264493617, -156.04908102268092, -31.445061699769187, -49.29332583507961, -84.890298275431, -197.61634764861648, -183.47775473970466, -118.1918915537504, -5.153456021842588, -80.97875512938148, -21.57365597540578, -60.3803020523649, -153.8161469500074, -177.63270308427914, -13.686573608423691, -74.65740041929492, -235.18849737179352, -204.46761205678405, -70.23583827423796, -18.22221281865324, -160.78000206506945, -46.24937978091945, -57.45550135046643, -117.62827242014332, -91.16567346927832, -79.0522636923618, -83.1647607975452, -98.12960100938321, -118.41662235630652, -144.8452185923686, 5.604200920672646, -188.43313463632163, -51.05028626924443, -53.09734471834527, -197.33227382208736, -120.41969513085542, -259.5084863460935, -120.62931674837246, -14.540809856652224, -33.49450043559888, -44.559775289971384, -22.54431625189714, -18.999495689945682, -108.00221384121109, -59.85345461926292, -72.61353374195257, -51.49615393966989, -27.53624350887354, -102.99850724176787, -139.81980774846645, -67.36140921714919, -74.7482685662816, -117.49000610077444, 2.72547908698591, -245.35975316984346, -82.74483118645126, -231.0078625858047, -54.61741066802919, -53.36708658306554, -160.08679531274754, -118.18493736440158], "episode_lengths": [85, 43, 82, 56, 58, 63, 107, 64, 89, 67, 90, 38, 88, 56, 40, 71, 62, 84, 81, 60, 98, 49, 35, 45, 44, 32, 33, 76, 33, 53, 77, 72, 58, 87, 99, 53, 56, 99, 48, 104, 78, 52, 47, 56, 87, 89, 71, 35, 67, 48, 62, 79, 82, 47, 63, 86, 89, 60, 48, 86, 56, 53, 65, 62, 62, 62, 61, 70, 80, 35, 87, 57, 62, 93, 71, 99, 67, 35, 53, 48, 45, 47, 71, 60, 55, 57, 50, 63, 69, 63, 65, 84, 40, 96, 63, 99, 61, 50, 73, 68], "policy_policy_0_reward": [-190.63322253951864, -21.521208423628305, -181.89835004491584, -54.979979731550536, -52.72857135672002, -61.57445975986712, -296.42407346092006, -101.70130909909206, -169.13861504632754, -121.75656374920241, -156.0801780335342, -9.53290355741902, -190.14644709894117, -53.016235135263514, -16.215745567445392, -128.60075285700972, -80.35409170252079, -168.73085969933447, -174.27056275848096, -78.32744355440673, -201.81460318280355, -40.509416596628725, -7.187202932069736, -41.77777213995089, -23.087128348683965, 3.5383196621466393, -9.77174600784827, -158.14138304481654, -3.977542566014042, -40.63664264084033, -144.67185513161422, -96.86620004566083, -48.123924271235424, -196.08468565616292, -198.19184661971028, -63.62334713670963, -47.90712961935078, -252.17431455650447, -48.87340892283623, -283.39141264493617, -156.04908102268092, -31.445061699769187, -49.29332583507961, -84.890298275431, -197.61634764861648, -183.47775473970466, -118.1918915537504, -5.153456021842588, -80.97875512938148, -21.57365597540578, -60.3803020523649, -153.8161469500074, -177.63270308427914, -13.686573608423691, -74.65740041929492, -235.18849737179352, -204.46761205678405, -70.23583827423796, -18.22221281865324, -160.78000206506945, -46.24937978091945, -57.45550135046643, -117.62827242014332, -91.16567346927832, -79.0522636923618, -83.1647607975452, -98.12960100938321, -118.41662235630652, -144.8452185923686, 5.604200920672646, -188.43313463632163, -51.05028626924443, -53.09734471834527, -197.33227382208736, -120.41969513085542, -259.5084863460935, -120.62931674837246, -14.540809856652224, -33.49450043559888, -44.559775289971384, -22.54431625189714, -18.999495689945682, -108.00221384121109, -59.85345461926292, -72.61353374195257, -51.49615393966989, -27.53624350887354, -102.99850724176787, -139.81980774846645, -67.36140921714919, -74.7482685662816, -117.49000610077444, 2.72547908698591, -245.35975316984346, -82.74483118645126, -231.0078625858047, -54.61741066802919, -53.36708658306554, -160.08679531274754, -118.18493736440158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5191433457856831, "mean_inference_ms": 1.557651545527864, "mean_action_processing_ms": 0.25721399337138506, "mean_env_wait_ms": 3.6351879325077787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011109352111816406, "StateBufferConnector_ms": 0.0073587894439697266, "ViewRequirementAgentConnector_ms": 0.17726922035217285}, "num_episodes": 59, "episode_return_max": 5.604200920672646, "episode_return_min": -296.42407346092006, "episode_return_mean": -100.28317056233152, "episodes_this_iter": 59}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.93383624963644, "num_env_steps_trained_throughput_per_sec": 309.93383624963644, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12240.489, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12240.416, "sample_time_ms": 1316.505, "learn_time_ms": 10870.86, "learn_throughput": 367.956, "synch_weights_time_ms": 52.251}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "8adec_00000", "date": "2024-07-24_15-06-21", "timestamp": 1721813781, "time_this_iter_s": 12.916836738586426, "time_total_s": 251.18029499053955, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc67880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 251.18029499053955, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.033333333333335, "ram_util_percent": 37.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.959431574742, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.4963213186090192, "policy_loss": -0.02130292773169155, "vf_loss": 1.5194051776702204, "vf_explained_var": 0.995727373411258, "kl": 0.015777180243185286, "entropy": 0.8880663447702924, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 13.21657768298035, "episode_reward_min": -285.0699956338008, "episode_reward_mean": -108.64218832110286, "episode_len_mean": 67.79, "episode_media": {}, "episodes_timesteps_total": 6779, "policy_reward_min": {"policy_0": -285.0699956338008}, "policy_reward_max": {"policy_0": 13.21657768298035}, "policy_reward_mean": {"policy_0": -108.64218832110286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.78000206506945, -46.24937978091945, -57.45550135046643, -117.62827242014332, -91.16567346927832, -79.0522636923618, -83.1647607975452, -98.12960100938321, -118.41662235630652, -144.8452185923686, 5.604200920672646, -188.43313463632163, -51.05028626924443, -53.09734471834527, -197.33227382208736, -120.41969513085542, -259.5084863460935, -120.62931674837246, -14.540809856652224, -33.49450043559888, -44.559775289971384, -22.54431625189714, -18.999495689945682, -108.00221384121109, -59.85345461926292, -72.61353374195257, -51.49615393966989, -27.53624350887354, -102.99850724176787, -139.81980774846645, -67.36140921714919, -74.7482685662816, -117.49000610077444, 2.72547908698591, -245.35975316984346, -82.74483118645126, -231.0078625858047, -54.61741066802919, -53.36708658306554, -160.08679531274754, -118.18493736440158, -160.44874121868583, -4.036482590615437, -153.88515742795678, -18.597851769947997, -53.235465741988456, -222.1672556701824, -246.23481377939657, -101.0939657499043, -78.98270218089631, -112.87458335746652, -35.24730660202859, -0.20265341874404608, -26.535008201375966, -97.7284004562691, -7.252634085771577, -27.02949057909265, -149.31584190435825, -14.798991082423115, -118.58025560463389, -199.22992523055754, -86.03331026523853, -33.29879959699374, -11.464777639778143, -220.37653307574112, -162.0725888830335, -248.8358700387157, -146.9090075505765, -130.39954871718066, -181.72260877279467, -38.153402380009005, -122.74463635474798, -116.97820255495463, -87.1946623385106, -60.43087061502253, -285.0699956338008, -106.13912219602855, -179.76352951516532, -185.61696777006975, 13.21657768298035, -201.2400499864672, -9.650343474115893, -30.408396003468024, -234.8748874621318, -256.0692852602035, -257.3310549811993, -277.44264865551474, -78.07953859446958, -99.04487648983022, -192.87758924101487, -112.74074152455098, -237.0552434214834, -48.17720345812128, -95.14432907686108, -157.49998621780483, -104.30808680312636, -30.288967327559643, -9.025203117309703, -125.25262767877322, -209.78706435127873], "episode_lengths": [86, 56, 53, 65, 62, 62, 62, 61, 70, 80, 35, 87, 57, 62, 93, 71, 99, 67, 35, 53, 48, 45, 47, 71, 60, 55, 57, 50, 63, 69, 63, 65, 84, 40, 96, 63, 99, 61, 50, 73, 68, 87, 40, 79, 39, 59, 97, 102, 57, 60, 71, 48, 32, 47, 68, 33, 44, 81, 46, 71, 103, 62, 48, 45, 90, 80, 95, 74, 78, 88, 50, 90, 70, 59, 63, 97, 84, 84, 80, 28, 96, 44, 44, 94, 98, 99, 103, 57, 63, 89, 68, 110, 53, 71, 94, 69, 45, 45, 74, 91], "policy_policy_0_reward": [-160.78000206506945, -46.24937978091945, -57.45550135046643, -117.62827242014332, -91.16567346927832, -79.0522636923618, -83.1647607975452, -98.12960100938321, -118.41662235630652, -144.8452185923686, 5.604200920672646, -188.43313463632163, -51.05028626924443, -53.09734471834527, -197.33227382208736, -120.41969513085542, -259.5084863460935, -120.62931674837246, -14.540809856652224, -33.49450043559888, -44.559775289971384, -22.54431625189714, -18.999495689945682, -108.00221384121109, -59.85345461926292, -72.61353374195257, -51.49615393966989, -27.53624350887354, -102.99850724176787, -139.81980774846645, -67.36140921714919, -74.7482685662816, -117.49000610077444, 2.72547908698591, -245.35975316984346, -82.74483118645126, -231.0078625858047, -54.61741066802919, -53.36708658306554, -160.08679531274754, -118.18493736440158, -160.44874121868583, -4.036482590615437, -153.88515742795678, -18.597851769947997, -53.235465741988456, -222.1672556701824, -246.23481377939657, -101.0939657499043, -78.98270218089631, -112.87458335746652, -35.24730660202859, -0.20265341874404608, -26.535008201375966, -97.7284004562691, -7.252634085771577, -27.02949057909265, -149.31584190435825, -14.798991082423115, -118.58025560463389, -199.22992523055754, -86.03331026523853, -33.29879959699374, -11.464777639778143, -220.37653307574112, -162.0725888830335, -248.8358700387157, -146.9090075505765, -130.39954871718066, -181.72260877279467, -38.153402380009005, -122.74463635474798, -116.97820255495463, -87.1946623385106, -60.43087061502253, -285.0699956338008, -106.13912219602855, -179.76352951516532, -185.61696777006975, 13.21657768298035, -201.2400499864672, -9.650343474115893, -30.408396003468024, -234.8748874621318, -256.0692852602035, -257.3310549811993, -277.44264865551474, -78.07953859446958, -99.04487648983022, -192.87758924101487, -112.74074152455098, -237.0552434214834, -48.17720345812128, -95.14432907686108, -157.49998621780483, -104.30808680312636, -30.288967327559643, -9.025203117309703, -125.25262767877322, -209.78706435127873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5204986683785411, "mean_inference_ms": 1.5620340855655785, "mean_action_processing_ms": 0.25718370559663656, "mean_env_wait_ms": 3.6483074602887715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011162519454956055, "StateBufferConnector_ms": 0.007428169250488281, "ViewRequirementAgentConnector_ms": 0.17754054069519043}, "num_episodes": 59, "episode_return_max": 13.21657768298035, "episode_return_min": -285.0699956338008, "episode_return_mean": -108.64218832110286, "episodes_this_iter": 59}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.2332482692559, "num_env_steps_trained_throughput_per_sec": 305.2332482692559, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12222.316, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12222.242, "sample_time_ms": 1334.309, "learn_time_ms": 10835.148, "learn_throughput": 369.169, "synch_weights_time_ms": 51.993}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "8adec_00000", "date": "2024-07-24_15-06-34", "timestamp": 1721813794, "time_this_iter_s": 13.11648440361023, "time_total_s": 264.2967793941498, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf09d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.2967793941498, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.30526315789474, "ram_util_percent": 37.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.39680626591047, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.3192637578894695, "policy_loss": -0.02162730246054707, "vf_loss": 1.3402761791522304, "vf_explained_var": 0.9969341514632106, "kl": 0.018365926304340974, "entropy": 0.7649782573804259, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": 13.21657768298035, "episode_reward_min": -285.0699956338008, "episode_reward_mean": -105.85453836921371, "episode_len_mean": 67.02, "episode_media": {}, "episodes_timesteps_total": 6702, "policy_reward_min": {"policy_0": -285.0699956338008}, "policy_reward_max": {"policy_0": 13.21657768298035}, "policy_reward_mean": {"policy_0": -105.85453836921371}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.29879959699374, -11.464777639778143, -220.37653307574112, -162.0725888830335, -248.8358700387157, -146.9090075505765, -130.39954871718066, -181.72260877279467, -38.153402380009005, -122.74463635474798, -116.97820255495463, -87.1946623385106, -60.43087061502253, -285.0699956338008, -106.13912219602855, -179.76352951516532, -185.61696777006975, 13.21657768298035, -201.2400499864672, -9.650343474115893, -30.408396003468024, -234.8748874621318, -256.0692852602035, -257.3310549811993, -277.44264865551474, -78.07953859446958, -99.04487648983022, -192.87758924101487, -112.74074152455098, -237.0552434214834, -48.17720345812128, -95.14432907686108, -157.49998621780483, -104.30808680312636, -30.288967327559643, -9.025203117309703, -125.25262767877322, -209.78706435127873, -255.58505686481644, -40.11483094643342, -144.0740869830331, -72.80189455761, -180.8073744641907, -101.70746899448083, -197.2917206976836, -138.47907570764303, -18.65671150315995, 9.35306377161958, -97.48162468013648, -1.4386928618931363, -219.32287021281581, -180.72820090684064, -83.31672647284957, -3.0889330324398854, -5.359093724010954, -101.52986617102447, 2.200774169753922, -2.3142761868197828, -45.22467611878192, -145.69088288983832, -210.907655309034, -37.76620733013522, -60.861339728277045, -18.618565218149442, -116.25271129618324, -77.48652063868231, -211.60756091064118, -40.81052690782076, -126.53428100852419, 1.5902925970090493, -57.266940469314534, 2.092018568401897, -174.82323494914093, -26.336361426131738, -149.07936306074643, -172.72305161104188, 0.17371617258386196, 7.713759516617557, -63.976232520471385, -211.8236807443532, -66.69936448605951, -154.58695840670106, -153.24653068889552, 10.228742150985601, -92.8948360968175, -4.442762918165889, -127.19591774040181, -112.74460255510408, -92.75850093205143, -123.035711948304, -138.6755256341616, -12.101060850955786, -143.54349513174554, -174.0201506911883, -119.92501734387999, -52.81839221689249, -30.831171574309373, -16.318832623227816, -109.9281866327309, -30.89821921617282], "episode_lengths": [48, 45, 90, 80, 95, 74, 78, 88, 50, 90, 70, 59, 63, 97, 84, 84, 80, 28, 96, 44, 44, 94, 98, 99, 103, 57, 63, 89, 68, 110, 53, 71, 94, 69, 45, 45, 74, 91, 96, 53, 81, 56, 79, 67, 90, 72, 48, 35, 65, 44, 89, 84, 66, 40, 38, 70, 34, 38, 53, 78, 92, 56, 52, 51, 69, 64, 83, 57, 76, 36, 57, 36, 79, 51, 78, 79, 34, 29, 59, 89, 55, 77, 81, 28, 65, 32, 74, 84, 67, 73, 78, 47, 80, 82, 86, 59, 57, 46, 68, 50], "policy_policy_0_reward": [-33.29879959699374, -11.464777639778143, -220.37653307574112, -162.0725888830335, -248.8358700387157, -146.9090075505765, -130.39954871718066, -181.72260877279467, -38.153402380009005, -122.74463635474798, -116.97820255495463, -87.1946623385106, -60.43087061502253, -285.0699956338008, -106.13912219602855, -179.76352951516532, -185.61696777006975, 13.21657768298035, -201.2400499864672, -9.650343474115893, -30.408396003468024, -234.8748874621318, -256.0692852602035, -257.3310549811993, -277.44264865551474, -78.07953859446958, -99.04487648983022, -192.87758924101487, -112.74074152455098, -237.0552434214834, -48.17720345812128, -95.14432907686108, -157.49998621780483, -104.30808680312636, -30.288967327559643, -9.025203117309703, -125.25262767877322, -209.78706435127873, -255.58505686481644, -40.11483094643342, -144.0740869830331, -72.80189455761, -180.8073744641907, -101.70746899448083, -197.2917206976836, -138.47907570764303, -18.65671150315995, 9.35306377161958, -97.48162468013648, -1.4386928618931363, -219.32287021281581, -180.72820090684064, -83.31672647284957, -3.0889330324398854, -5.359093724010954, -101.52986617102447, 2.200774169753922, -2.3142761868197828, -45.22467611878192, -145.69088288983832, -210.907655309034, -37.76620733013522, -60.861339728277045, -18.618565218149442, -116.25271129618324, -77.48652063868231, -211.60756091064118, -40.81052690782076, -126.53428100852419, 1.5902925970090493, -57.266940469314534, 2.092018568401897, -174.82323494914093, -26.336361426131738, -149.07936306074643, -172.72305161104188, 0.17371617258386196, 7.713759516617557, -63.976232520471385, -211.8236807443532, -66.69936448605951, -154.58695840670106, -153.24653068889552, 10.228742150985601, -92.8948360968175, -4.442762918165889, -127.19591774040181, -112.74460255510408, -92.75850093205143, -123.035711948304, -138.6755256341616, -12.101060850955786, -143.54349513174554, -174.0201506911883, -119.92501734387999, -52.81839221689249, -30.831171574309373, -16.318832623227816, -109.9281866327309, -30.89821921617282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5210221726287722, "mean_inference_ms": 1.5647587386670856, "mean_action_processing_ms": 0.25708149564857935, "mean_env_wait_ms": 3.659395487567689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010966062545776367, "StateBufferConnector_ms": 0.007340669631958008, "ViewRequirementAgentConnector_ms": 0.17751693725585938}, "num_episodes": 62, "episode_return_max": 13.21657768298035, "episode_return_min": -285.0699956338008, "episode_return_mean": -105.85453836921371, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.7043311518151, "num_env_steps_trained_throughput_per_sec": 311.7043311518151, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12245.955, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12245.881, "sample_time_ms": 1335.197, "learn_time_ms": 10858.436, "learn_throughput": 368.377, "synch_weights_time_ms": 51.452}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "8adec_00000", "date": "2024-07-24_15-06-47", "timestamp": 1721813807, "time_this_iter_s": 12.843111753463745, "time_total_s": 277.1398911476135, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf1b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.1398911476135, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.705555555555556, "ram_util_percent": 37.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.73678267796835, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0092622520557295, "policy_loss": -0.02265472438496848, "vf_loss": 1.0326082949526607, "vf_explained_var": 0.9976034410918753, "kl": 0.015723041498555797, "entropy": 0.7766684861853719, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 12.201302899244496, "episode_reward_min": -441.9073353804915, "episode_reward_mean": -92.98554760320123, "episode_len_mean": 65.07, "episode_media": {}, "episodes_timesteps_total": 6507, "policy_reward_min": {"policy_0": -441.9073353804915}, "policy_reward_max": {"policy_0": 12.201302899244496}, "policy_reward_mean": {"policy_0": -92.98554760320123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.861339728277045, -18.618565218149442, -116.25271129618324, -77.48652063868231, -211.60756091064118, -40.81052690782076, -126.53428100852419, 1.5902925970090493, -57.266940469314534, 2.092018568401897, -174.82323494914093, -26.336361426131738, -149.07936306074643, -172.72305161104188, 0.17371617258386196, 7.713759516617557, -63.976232520471385, -211.8236807443532, -66.69936448605951, -154.58695840670106, -153.24653068889552, 10.228742150985601, -92.8948360968175, -4.442762918165889, -127.19591774040181, -112.74460255510408, -92.75850093205143, -123.035711948304, -138.6755256341616, -12.101060850955786, -143.54349513174554, -174.0201506911883, -119.92501734387999, -52.81839221689249, -30.831171574309373, -16.318832623227816, -109.9281866327309, -30.89821921617282, -126.4920255770871, -133.1093722749796, -44.97733419557483, -58.53943848773649, -37.16449847973348, -58.62157676987639, -60.655789469401796, -114.13852922649531, -153.55894168445425, -128.95022360785958, -144.6427353938477, -41.967046348543164, -28.939122635906912, -110.46212144702876, -110.3003830853514, -215.5683883834113, -13.543283011067542, -195.90565492046667, -106.9684055534899, -43.09302805611758, -15.111276625391424, -193.90791848656, -90.9294541746222, -40.55967645317722, -441.9073353804915, -23.253857054749105, -116.64711660188898, -150.21597354131436, -147.31987695538155, -140.46316063757814, -74.49283727050043, -10.902298307800823, -12.154826525440498, 12.201302899244496, -112.67880798486438, -28.97571759205731, -111.11415964696346, -29.06001647583981, -122.447124333811, -22.572787645655367, -88.75513991641262, -68.02236952365584, -164.66803156243563, -74.46361544971828, -51.8969244881224, -237.4241961528294, -51.78884315657123, -44.47553958299747, -6.4514206286049784, -119.53789343115551, -110.87405178387539, -41.4257600406886, -114.14898685008329, -14.896505672345635, -164.00139690752474, -235.794305560351, -44.28951786077519, -30.2161902533596, -231.73349168222998, -180.73047442237555, -41.64649284237513, -138.13571597671765], "episode_lengths": [52, 51, 69, 64, 83, 57, 76, 36, 57, 36, 79, 51, 78, 79, 34, 29, 59, 89, 55, 77, 81, 28, 65, 32, 74, 84, 67, 73, 78, 47, 80, 82, 86, 59, 57, 46, 68, 50, 73, 77, 59, 55, 47, 61, 53, 71, 79, 77, 78, 57, 42, 70, 74, 97, 43, 87, 69, 60, 40, 91, 68, 55, 128, 52, 75, 81, 80, 78, 65, 44, 39, 37, 71, 54, 70, 53, 70, 44, 69, 65, 79, 67, 61, 96, 56, 59, 37, 72, 81, 56, 70, 47, 81, 97, 59, 58, 95, 86, 49, 75], "policy_policy_0_reward": [-60.861339728277045, -18.618565218149442, -116.25271129618324, -77.48652063868231, -211.60756091064118, -40.81052690782076, -126.53428100852419, 1.5902925970090493, -57.266940469314534, 2.092018568401897, -174.82323494914093, -26.336361426131738, -149.07936306074643, -172.72305161104188, 0.17371617258386196, 7.713759516617557, -63.976232520471385, -211.8236807443532, -66.69936448605951, -154.58695840670106, -153.24653068889552, 10.228742150985601, -92.8948360968175, -4.442762918165889, -127.19591774040181, -112.74460255510408, -92.75850093205143, -123.035711948304, -138.6755256341616, -12.101060850955786, -143.54349513174554, -174.0201506911883, -119.92501734387999, -52.81839221689249, -30.831171574309373, -16.318832623227816, -109.9281866327309, -30.89821921617282, -126.4920255770871, -133.1093722749796, -44.97733419557483, -58.53943848773649, -37.16449847973348, -58.62157676987639, -60.655789469401796, -114.13852922649531, -153.55894168445425, -128.95022360785958, -144.6427353938477, -41.967046348543164, -28.939122635906912, -110.46212144702876, -110.3003830853514, -215.5683883834113, -13.543283011067542, -195.90565492046667, -106.9684055534899, -43.09302805611758, -15.111276625391424, -193.90791848656, -90.9294541746222, -40.55967645317722, -441.9073353804915, -23.253857054749105, -116.64711660188898, -150.21597354131436, -147.31987695538155, -140.46316063757814, -74.49283727050043, -10.902298307800823, -12.154826525440498, 12.201302899244496, -112.67880798486438, -28.97571759205731, -111.11415964696346, -29.06001647583981, -122.447124333811, -22.572787645655367, -88.75513991641262, -68.02236952365584, -164.66803156243563, -74.46361544971828, -51.8969244881224, -237.4241961528294, -51.78884315657123, -44.47553958299747, -6.4514206286049784, -119.53789343115551, -110.87405178387539, -41.4257600406886, -114.14898685008329, -14.896505672345635, -164.00139690752474, -235.794305560351, -44.28951786077519, -30.2161902533596, -231.73349168222998, -180.73047442237555, -41.64649284237513, -138.13571597671765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.520380918024177, "mean_inference_ms": 1.5621348118608887, "mean_action_processing_ms": 0.2566943285797174, "mean_env_wait_ms": 3.6568612425992653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010686635971069336, "StateBufferConnector_ms": 0.0073528289794921875, "ViewRequirementAgentConnector_ms": 0.17904424667358398}, "num_episodes": 62, "episode_return_max": 12.201302899244496, "episode_return_min": -441.9073353804915, "episode_return_mean": -92.98554760320123, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.8135018144464, "num_env_steps_trained_throughput_per_sec": 324.8135018144464, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12199.811, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12199.738, "sample_time_ms": 1337.894, "learn_time_ms": 10808.394, "learn_throughput": 370.083, "synch_weights_time_ms": 52.644}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "8adec_00000", "date": "2024-07-24_15-06-59", "timestamp": 1721813819, "time_this_iter_s": 12.32734751701355, "time_total_s": 289.4672386646271, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc670a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.4672386646271, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.633333333333336, "ram_util_percent": 37.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.26838786850372, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8481793891560907, "policy_loss": -0.02152168478545112, "vf_loss": 0.8687613607384265, "vf_explained_var": 0.9981986651817958, "kl": 0.01750469335869034, "entropy": 0.693739850136141, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": 12.201302899244496, "episode_reward_min": -441.9073353804915, "episode_reward_mean": -91.5363202606903, "episode_len_mean": 65.02, "episode_media": {}, "episodes_timesteps_total": 6502, "policy_reward_min": {"policy_0": -441.9073353804915}, "policy_reward_max": {"policy_0": 12.201302899244496}, "policy_reward_mean": {"policy_0": -91.5363202606903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-441.9073353804915, -23.253857054749105, -116.64711660188898, -150.21597354131436, -147.31987695538155, -140.46316063757814, -74.49283727050043, -10.902298307800823, -12.154826525440498, 12.201302899244496, -112.67880798486438, -28.97571759205731, -111.11415964696346, -29.06001647583981, -122.447124333811, -22.572787645655367, -88.75513991641262, -68.02236952365584, -164.66803156243563, -74.46361544971828, -51.8969244881224, -237.4241961528294, -51.78884315657123, -44.47553958299747, -6.4514206286049784, -119.53789343115551, -110.87405178387539, -41.4257600406886, -114.14898685008329, -14.896505672345635, -164.00139690752474, -235.794305560351, -44.28951786077519, -30.2161902533596, -231.73349168222998, -180.73047442237555, -41.64649284237513, -138.13571597671765, -107.7534214771011, 5.5272465548173395, -177.43127716687565, -1.7312111758086446, -94.97300846403606, -61.8912241080514, 2.5414474393526243, -183.32021033532226, -80.03529663288089, -43.909645748497915, -136.69507242222213, -40.62336691483635, -9.412153780612178, -182.69967235519627, -1.476512387832002, -87.99662076312508, -88.9114513443882, -250.80522283614346, -20.01587198866722, -21.089680649884485, -198.85425856603652, -26.47009497669108, -68.31632095857802, 4.038328214606945, -9.371965594760304, -8.889569085904364, 1.025702471729956, -106.20973715649173, -141.81274152743475, -94.86881170790258, -118.61961639706193, -162.34627865499138, -154.02418758277284, -19.4566953778681, -207.78522980602554, -44.19935656352301, -130.2912024335741, -94.91489143830213, -86.92943087178388, -11.148036503442663, -14.501348660426515, -105.04779931205076, -80.02240010869804, -145.74916416540808, -9.596063760408086, -120.99096879237787, 5.223912240990488, -8.43516854433766, -199.45996931404832, -209.79543776266897, -164.1478639200896, -27.71910225751873, -79.26824689018028, -32.89814883649038, -108.0244384636049, -151.80286657284722, -16.072150244920735, -36.76570427257551, -254.0140888132452, -91.09537404397273, -206.26442705937288, -47.65712864036094], "episode_lengths": [128, 52, 75, 81, 80, 78, 65, 44, 39, 37, 71, 54, 70, 53, 70, 44, 69, 65, 79, 67, 61, 96, 56, 59, 37, 72, 81, 56, 70, 47, 81, 97, 59, 58, 95, 86, 49, 75, 69, 36, 86, 35, 69, 55, 34, 91, 64, 53, 76, 54, 38, 89, 34, 66, 69, 101, 47, 47, 92, 52, 55, 35, 46, 41, 41, 74, 75, 66, 89, 83, 77, 47, 91, 57, 79, 67, 68, 43, 45, 69, 63, 79, 46, 74, 30, 46, 88, 98, 86, 48, 67, 55, 70, 79, 45, 57, 99, 66, 91, 54], "policy_policy_0_reward": [-441.9073353804915, -23.253857054749105, -116.64711660188898, -150.21597354131436, -147.31987695538155, -140.46316063757814, -74.49283727050043, -10.902298307800823, -12.154826525440498, 12.201302899244496, -112.67880798486438, -28.97571759205731, -111.11415964696346, -29.06001647583981, -122.447124333811, -22.572787645655367, -88.75513991641262, -68.02236952365584, -164.66803156243563, -74.46361544971828, -51.8969244881224, -237.4241961528294, -51.78884315657123, -44.47553958299747, -6.4514206286049784, -119.53789343115551, -110.87405178387539, -41.4257600406886, -114.14898685008329, -14.896505672345635, -164.00139690752474, -235.794305560351, -44.28951786077519, -30.2161902533596, -231.73349168222998, -180.73047442237555, -41.64649284237513, -138.13571597671765, -107.7534214771011, 5.5272465548173395, -177.43127716687565, -1.7312111758086446, -94.97300846403606, -61.8912241080514, 2.5414474393526243, -183.32021033532226, -80.03529663288089, -43.909645748497915, -136.69507242222213, -40.62336691483635, -9.412153780612178, -182.69967235519627, -1.476512387832002, -87.99662076312508, -88.9114513443882, -250.80522283614346, -20.01587198866722, -21.089680649884485, -198.85425856603652, -26.47009497669108, -68.31632095857802, 4.038328214606945, -9.371965594760304, -8.889569085904364, 1.025702471729956, -106.20973715649173, -141.81274152743475, -94.86881170790258, -118.61961639706193, -162.34627865499138, -154.02418758277284, -19.4566953778681, -207.78522980602554, -44.19935656352301, -130.2912024335741, -94.91489143830213, -86.92943087178388, -11.148036503442663, -14.501348660426515, -105.04779931205076, -80.02240010869804, -145.74916416540808, -9.596063760408086, -120.99096879237787, 5.223912240990488, -8.43516854433766, -199.45996931404832, -209.79543776266897, -164.1478639200896, -27.71910225751873, -79.26824689018028, -32.89814883649038, -108.0244384636049, -151.80286657284722, -16.072150244920735, -36.76570427257551, -254.0140888132452, -91.09537404397273, -206.26442705937288, -47.65712864036094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5204965908294582, "mean_inference_ms": 1.5614319496689435, "mean_action_processing_ms": 0.2563911428261557, "mean_env_wait_ms": 3.660888073136838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011763572692871094, "StateBufferConnector_ms": 0.007306337356567383, "ViewRequirementAgentConnector_ms": 0.17741942405700684}, "num_episodes": 62, "episode_return_max": 12.201302899244496, "episode_return_min": -441.9073353804915, "episode_return_mean": -91.5363202606903, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.0885998090552, "num_env_steps_trained_throughput_per_sec": 389.0885998090552, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12280.743, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12280.671, "sample_time_ms": 1352.049, "learn_time_ms": 10875.376, "learn_throughput": 367.803, "synch_weights_time_ms": 52.477}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "8adec_00000", "date": "2024-07-24_15-07-09", "timestamp": 1721813829, "time_this_iter_s": 10.291624069213867, "time_total_s": 299.75886273384094, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc65e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 299.75886273384094, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 20.78571428571429, "ram_util_percent": 37.80714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.01511916667224, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8061062056881686, "policy_loss": -0.008841162644481907, "vf_loss": 0.8156822968274355, "vf_explained_var": 0.9973811163256566, "kl": 0.013725150070877134, "entropy": 0.6911246660475929, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 11.87215256034492, "episode_reward_min": -254.0140888132452, "episode_reward_mean": -84.73195066955023, "episode_len_mean": 64.53, "episode_media": {}, "episodes_timesteps_total": 6453, "policy_reward_min": {"policy_0": -254.0140888132452}, "policy_reward_max": {"policy_0": 11.87215256034492}, "policy_reward_mean": {"policy_0": -84.73195066955023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.20973715649173, -141.81274152743475, -94.86881170790258, -118.61961639706193, -162.34627865499138, -154.02418758277284, -19.4566953778681, -207.78522980602554, -44.19935656352301, -130.2912024335741, -94.91489143830213, -86.92943087178388, -11.148036503442663, -14.501348660426515, -105.04779931205076, -80.02240010869804, -145.74916416540808, -9.596063760408086, -120.99096879237787, 5.223912240990488, -8.43516854433766, -199.45996931404832, -209.79543776266897, -164.1478639200896, -27.71910225751873, -79.26824689018028, -32.89814883649038, -108.0244384636049, -151.80286657284722, -16.072150244920735, -36.76570427257551, -254.0140888132452, -91.09537404397273, -206.26442705937288, -47.65712864036094, -96.03154255517552, -21.140661226322056, -69.98120312996525, 11.87215256034492, -129.0716979952208, -237.312054840404, -22.0705888396453, -80.36484848487318, 7.3381594635734535, -112.34385246151507, -65.90173634638481, -66.53292916610503, -121.43082440345995, -152.4704695951595, -160.6941715444311, -32.857726005799464, -35.32903139310686, -83.61213472974653, -131.50270296052025, -117.42414142762661, -153.90380215820468, -1.0714101014236777, -145.83392211404913, 6.113483609260963, -40.935518287101196, -29.761820368843047, -100.54368614626513, -0.3723963610757788, -23.16283401160559, -5.58529208643273, -38.29642840567156, -112.36897176853026, -26.15772605616192, -59.33362514503889, -24.707996795262112, -52.6640183482355, 1.362839469901022, -19.894649899643284, -31.8394820105364, -106.89996790291086, -121.5894818382657, -18.498781607941787, -171.59385478771412, -122.06150379577458, -46.40116974243854, -16.0449511014059, -5.675307739302969, -12.643321571804652, -6.234313575970046, -15.084518383813831, -156.04611334932184, -107.35521700667684, -163.78942273013973, -94.69953178256729, -28.660752900240105, -32.62017311551935, -128.9994792124728, -51.28657753792594, -188.08060404448108, -212.77026886803512, -24.35628811297909, -101.27153836374728, -99.68126968260714, -183.31068940990076, -205.01054250881614], "episode_lengths": [74, 75, 66, 89, 83, 77, 47, 91, 57, 79, 67, 68, 43, 45, 69, 63, 79, 46, 74, 30, 46, 88, 98, 86, 48, 67, 55, 70, 79, 45, 57, 99, 66, 91, 54, 74, 52, 62, 28, 76, 100, 43, 63, 37, 72, 57, 57, 73, 79, 98, 47, 59, 68, 74, 71, 77, 40, 81, 33, 58, 56, 69, 44, 52, 45, 56, 78, 55, 63, 50, 61, 35, 52, 56, 71, 86, 47, 90, 72, 50, 45, 40, 51, 46, 42, 81, 67, 88, 67, 56, 48, 76, 59, 87, 95, 55, 66, 66, 87, 93], "policy_policy_0_reward": [-106.20973715649173, -141.81274152743475, -94.86881170790258, -118.61961639706193, -162.34627865499138, -154.02418758277284, -19.4566953778681, -207.78522980602554, -44.19935656352301, -130.2912024335741, -94.91489143830213, -86.92943087178388, -11.148036503442663, -14.501348660426515, -105.04779931205076, -80.02240010869804, -145.74916416540808, -9.596063760408086, -120.99096879237787, 5.223912240990488, -8.43516854433766, -199.45996931404832, -209.79543776266897, -164.1478639200896, -27.71910225751873, -79.26824689018028, -32.89814883649038, -108.0244384636049, -151.80286657284722, -16.072150244920735, -36.76570427257551, -254.0140888132452, -91.09537404397273, -206.26442705937288, -47.65712864036094, -96.03154255517552, -21.140661226322056, -69.98120312996525, 11.87215256034492, -129.0716979952208, -237.312054840404, -22.0705888396453, -80.36484848487318, 7.3381594635734535, -112.34385246151507, -65.90173634638481, -66.53292916610503, -121.43082440345995, -152.4704695951595, -160.6941715444311, -32.857726005799464, -35.32903139310686, -83.61213472974653, -131.50270296052025, -117.42414142762661, -153.90380215820468, -1.0714101014236777, -145.83392211404913, 6.113483609260963, -40.935518287101196, -29.761820368843047, -100.54368614626513, -0.3723963610757788, -23.16283401160559, -5.58529208643273, -38.29642840567156, -112.36897176853026, -26.15772605616192, -59.33362514503889, -24.707996795262112, -52.6640183482355, 1.362839469901022, -19.894649899643284, -31.8394820105364, -106.89996790291086, -121.5894818382657, -18.498781607941787, -171.59385478771412, -122.06150379577458, -46.40116974243854, -16.0449511014059, -5.675307739302969, -12.643321571804652, -6.234313575970046, -15.084518383813831, -156.04611334932184, -107.35521700667684, -163.78942273013973, -94.69953178256729, -28.660752900240105, -32.62017311551935, -128.9994792124728, -51.28657753792594, -188.08060404448108, -212.77026886803512, -24.35628811297909, -101.27153836374728, -99.68126968260714, -183.31068940990076, -205.01054250881614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5209172607247767, "mean_inference_ms": 1.5608910914694658, "mean_action_processing_ms": 0.2562507526341522, "mean_env_wait_ms": 3.6639264444051856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011910200119018555, "StateBufferConnector_ms": 0.0074617862701416016, "ViewRequirementAgentConnector_ms": 0.18250274658203125}, "num_episodes": 65, "episode_return_max": 11.87215256034492, "episode_return_min": -254.0140888132452, "episode_return_mean": -84.73195066955023, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.961992298139, "num_env_steps_trained_throughput_per_sec": 491.961992298139, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 11907.036, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11906.964, "sample_time_ms": 1352.405, "learn_time_ms": 10498.933, "learn_throughput": 380.991, "synch_weights_time_ms": 54.83}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "8adec_00000", "date": "2024-07-24_15-07-18", "timestamp": 1721813838, "time_this_iter_s": 8.142703533172607, "time_total_s": 307.90156626701355, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc65d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.90156626701355, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 22.63333333333333, "ram_util_percent": 37.824999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 78.73319890499116, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.6780380359540383, "policy_loss": -0.020310070825507863, "vf_loss": 0.6972404348043104, "vf_explained_var": 0.9988436598330737, "kl": 0.016985475722322025, "entropy": 0.6535793011387189, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 17.921241211610667, "episode_reward_min": -247.43747188021183, "episode_reward_mean": -72.89581426047609, "episode_len_mean": 61.45, "episode_media": {}, "episodes_timesteps_total": 6145, "policy_reward_min": {"policy_0": -247.43747188021183}, "policy_reward_max": {"policy_0": 17.921241211610667}, "policy_reward_mean": {"policy_0": -72.89581426047609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.36897176853026, -26.15772605616192, -59.33362514503889, -24.707996795262112, -52.6640183482355, 1.362839469901022, -19.894649899643284, -31.8394820105364, -106.89996790291086, -121.5894818382657, -18.498781607941787, -171.59385478771412, -122.06150379577458, -46.40116974243854, -16.0449511014059, -5.675307739302969, -12.643321571804652, -6.234313575970046, -15.084518383813831, -156.04611334932184, -107.35521700667684, -163.78942273013973, -94.69953178256729, -28.660752900240105, -32.62017311551935, -128.9994792124728, -51.28657753792594, -188.08060404448108, -212.77026886803512, -24.35628811297909, -101.27153836374728, -99.68126968260714, -183.31068940990076, -205.01054250881614, -58.37507591241107, -13.24806166282984, -11.498945425039928, -14.76185016842005, -184.3642956237856, 1.6663816611381268, -48.08678825226697, -86.25780100112351, -89.96476368974139, 11.018381878592631, -49.34495867139393, -38.251862491390995, -33.89825650800523, -19.131314432426432, -0.49670070867432725, -150.8146876389454, 1.363291437489236, -96.83759234718417, -131.84866455638266, -8.55866050503263, -54.302618860645715, -95.05949960909871, -30.279044102696215, -23.15825289636328, -105.5276829665186, -197.44175434493468, -112.06185804692237, 2.558541494063161, 5.818239655666842, -34.02218655622108, -22.733722544700093, -134.14093604233156, -97.5365161373275, -0.9382965700996064, -74.0646498198616, -65.27801475017539, -105.52093487985013, -223.76739523871547, -217.79080862557504, -83.42328239012767, -66.63825325895124, -11.05515879483414, 17.921241211610667, -183.32267020959347, -15.240758230697683, -119.6123487365106, -16.40425183081696, -58.13748295610343, -247.43747188021183, -63.22154886576381, -166.4758120722178, 8.028175470398956, -0.6903148272255198, -39.01538808387197, -89.68846420995227, -16.77959358881304, -91.09667193408978, -28.581254668278078, -113.00910474136673, -69.06949391964694, -64.40190417998006, -69.38590873198099, -12.73820619675503, -146.01341994363224, -21.55364795209172, -169.32954383968385], "episode_lengths": [78, 55, 63, 50, 61, 35, 52, 56, 71, 86, 47, 90, 72, 50, 45, 40, 51, 46, 42, 81, 67, 88, 67, 56, 48, 76, 59, 87, 95, 55, 66, 66, 87, 93, 64, 50, 41, 41, 88, 40, 55, 67, 64, 34, 56, 45, 53, 48, 43, 79, 40, 65, 76, 43, 61, 65, 48, 52, 83, 89, 74, 34, 36, 51, 46, 79, 84, 45, 60, 56, 86, 97, 93, 60, 60, 42, 27, 87, 50, 76, 46, 62, 101, 60, 82, 35, 40, 50, 65, 47, 68, 48, 82, 61, 58, 58, 47, 80, 56, 85], "policy_policy_0_reward": [-112.36897176853026, -26.15772605616192, -59.33362514503889, -24.707996795262112, -52.6640183482355, 1.362839469901022, -19.894649899643284, -31.8394820105364, -106.89996790291086, -121.5894818382657, -18.498781607941787, -171.59385478771412, -122.06150379577458, -46.40116974243854, -16.0449511014059, -5.675307739302969, -12.643321571804652, -6.234313575970046, -15.084518383813831, -156.04611334932184, -107.35521700667684, -163.78942273013973, -94.69953178256729, -28.660752900240105, -32.62017311551935, -128.9994792124728, -51.28657753792594, -188.08060404448108, -212.77026886803512, -24.35628811297909, -101.27153836374728, -99.68126968260714, -183.31068940990076, -205.01054250881614, -58.37507591241107, -13.24806166282984, -11.498945425039928, -14.76185016842005, -184.3642956237856, 1.6663816611381268, -48.08678825226697, -86.25780100112351, -89.96476368974139, 11.018381878592631, -49.34495867139393, -38.251862491390995, -33.89825650800523, -19.131314432426432, -0.49670070867432725, -150.8146876389454, 1.363291437489236, -96.83759234718417, -131.84866455638266, -8.55866050503263, -54.302618860645715, -95.05949960909871, -30.279044102696215, -23.15825289636328, -105.5276829665186, -197.44175434493468, -112.06185804692237, 2.558541494063161, 5.818239655666842, -34.02218655622108, -22.733722544700093, -134.14093604233156, -97.5365161373275, -0.9382965700996064, -74.0646498198616, -65.27801475017539, -105.52093487985013, -223.76739523871547, -217.79080862557504, -83.42328239012767, -66.63825325895124, -11.05515879483414, 17.921241211610667, -183.32267020959347, -15.240758230697683, -119.6123487365106, -16.40425183081696, -58.13748295610343, -247.43747188021183, -63.22154886576381, -166.4758120722178, 8.028175470398956, -0.6903148272255198, -39.01538808387197, -89.68846420995227, -16.77959358881304, -91.09667193408978, -28.581254668278078, -113.00910474136673, -69.06949391964694, -64.40190417998006, -69.38590873198099, -12.73820619675503, -146.01341994363224, -21.55364795209172, -169.32954383968385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.521033139558565, "mean_inference_ms": 1.6003140690774469, "mean_action_processing_ms": 0.25630587586298176, "mean_env_wait_ms": 3.6653527284602183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011750221252441406, "StateBufferConnector_ms": 0.007552623748779297, "ViewRequirementAgentConnector_ms": 0.18286776542663574}, "num_episodes": 66, "episode_return_max": 17.921241211610667, "episode_return_min": -247.43747188021183, "episode_return_mean": -72.89581426047609, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.94888258145625, "num_env_steps_trained_throughput_per_sec": 317.94888258145625, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12049.942, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12049.869, "sample_time_ms": 1385.954, "learn_time_ms": 10607.814, "learn_throughput": 377.081, "synch_weights_time_ms": 55.296}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "8adec_00000", "date": "2024-07-24_15-07-30", "timestamp": 1721813850, "time_this_iter_s": 12.592099666595459, "time_total_s": 320.493665933609, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc67ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 320.493665933609, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 20.888888888888893, "ram_util_percent": 37.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.00280170192321, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.5092108522629133, "policy_loss": -0.017555839046932913, "vf_loss": 0.5241219526467223, "vf_explained_var": 0.9987927858407298, "kl": 0.019703579706098647, "entropy": 0.6221871249067287, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 17.921241211610667, "episode_reward_min": -247.43747188021183, "episode_reward_mean": -74.35502743053104, "episode_len_mean": 61.77, "episode_media": {}, "episodes_timesteps_total": 6177, "policy_reward_min": {"policy_0": -247.43747188021183}, "policy_reward_max": {"policy_0": 17.921241211610667}, "policy_reward_mean": {"policy_0": -74.35502743053104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.14093604233156, -97.5365161373275, -0.9382965700996064, -74.0646498198616, -65.27801475017539, -105.52093487985013, -223.76739523871547, -217.79080862557504, -83.42328239012767, -66.63825325895124, -11.05515879483414, 17.921241211610667, -183.32267020959347, -15.240758230697683, -119.6123487365106, -16.40425183081696, -58.13748295610343, -247.43747188021183, -63.22154886576381, -166.4758120722178, 8.028175470398956, -0.6903148272255198, -39.01538808387197, -89.68846420995227, -16.77959358881304, -91.09667193408978, -28.581254668278078, -113.00910474136673, -69.06949391964694, -64.40190417998006, -69.38590873198099, -12.73820619675503, -146.01341994363224, -21.55364795209172, -169.32954383968385, -109.69010401712168, -8.241222731268453, -163.9477536779302, -85.25704954258784, -17.593784173202895, 16.264636143484864, -78.9894492342171, -193.76527593931675, -173.43206238348495, -169.7751361789192, -86.78878542719282, -74.56305076455176, 6.346437875276277, -134.85821459320692, 15.064882044722038, -191.2517473756351, -152.34350126087244, -31.752515784920533, 1.4682555924777039, -188.54453999724066, -192.22888743649162, -19.509592015056196, -126.21896053041692, -139.47324762226623, -41.92575360560184, -17.761213393277465, -54.30721652731933, 3.2211433340744384, -41.09778491108358, -23.661972393866588, -13.43701524187393, -115.84104008208206, -49.21748906563963, -103.79351210660278, -201.4248512198283, -61.76196548498293, -60.17411688142836, -101.23220221060052, -18.391499529752082, -80.84870216519654, -133.70599376426625, 2.5847885885790514, -78.82764810759589, -15.699108198397296, -20.97310338482292, -41.55476416769109, -68.15347487987557, 8.725996801901521, -95.05085449616587, -86.6161461323341, -80.19355898633447, -81.57480690936808, -111.16650924307072, -12.5621860994378, -7.73387999912674, -78.41297071535008, -97.56192460254233, -121.94993909803983, -18.121714728102326, -9.320560210358611, -2.5019125142366403, -33.74982320322667, -16.69723665229424, -79.15837152716071, -19.381088883662695], "episode_lengths": [79, 84, 45, 60, 56, 86, 97, 93, 60, 60, 42, 27, 87, 50, 76, 46, 62, 101, 60, 82, 35, 40, 50, 65, 47, 68, 48, 82, 61, 58, 58, 47, 80, 56, 85, 70, 46, 88, 76, 46, 34, 62, 89, 84, 84, 71, 54, 32, 75, 33, 88, 88, 46, 37, 91, 92, 46, 84, 79, 49, 45, 64, 38, 50, 52, 47, 71, 55, 71, 93, 60, 58, 70, 43, 67, 78, 36, 62, 47, 50, 61, 61, 29, 71, 64, 62, 66, 69, 52, 40, 67, 74, 75, 48, 46, 37, 58, 47, 63, 53], "policy_policy_0_reward": [-134.14093604233156, -97.5365161373275, -0.9382965700996064, -74.0646498198616, -65.27801475017539, -105.52093487985013, -223.76739523871547, -217.79080862557504, -83.42328239012767, -66.63825325895124, -11.05515879483414, 17.921241211610667, -183.32267020959347, -15.240758230697683, -119.6123487365106, -16.40425183081696, -58.13748295610343, -247.43747188021183, -63.22154886576381, -166.4758120722178, 8.028175470398956, -0.6903148272255198, -39.01538808387197, -89.68846420995227, -16.77959358881304, -91.09667193408978, -28.581254668278078, -113.00910474136673, -69.06949391964694, -64.40190417998006, -69.38590873198099, -12.73820619675503, -146.01341994363224, -21.55364795209172, -169.32954383968385, -109.69010401712168, -8.241222731268453, -163.9477536779302, -85.25704954258784, -17.593784173202895, 16.264636143484864, -78.9894492342171, -193.76527593931675, -173.43206238348495, -169.7751361789192, -86.78878542719282, -74.56305076455176, 6.346437875276277, -134.85821459320692, 15.064882044722038, -191.2517473756351, -152.34350126087244, -31.752515784920533, 1.4682555924777039, -188.54453999724066, -192.22888743649162, -19.509592015056196, -126.21896053041692, -139.47324762226623, -41.92575360560184, -17.761213393277465, -54.30721652731933, 3.2211433340744384, -41.09778491108358, -23.661972393866588, -13.43701524187393, -115.84104008208206, -49.21748906563963, -103.79351210660278, -201.4248512198283, -61.76196548498293, -60.17411688142836, -101.23220221060052, -18.391499529752082, -80.84870216519654, -133.70599376426625, 2.5847885885790514, -78.82764810759589, -15.699108198397296, -20.97310338482292, -41.55476416769109, -68.15347487987557, 8.725996801901521, -95.05085449616587, -86.6161461323341, -80.19355898633447, -81.57480690936808, -111.16650924307072, -12.5621860994378, -7.73387999912674, -78.41297071535008, -97.56192460254233, -121.94993909803983, -18.121714728102326, -9.320560210358611, -2.5019125142366403, -33.74982320322667, -16.69723665229424, -79.15837152716071, -19.381088883662695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5210733048792374, "mean_inference_ms": 1.6183536375615413, "mean_action_processing_ms": 0.2559855147016595, "mean_env_wait_ms": 3.6651940022953875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01188516616821289, "StateBufferConnector_ms": 0.007384300231933594, "ViewRequirementAgentConnector_ms": 0.1769719123840332}, "num_episodes": 65, "episode_return_max": 17.921241211610667, "episode_return_min": -247.43747188021183, "episode_return_mean": -74.35502743053104, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.7855293265469, "num_env_steps_trained_throughput_per_sec": 395.7855293265469, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 11808.242, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11808.169, "sample_time_ms": 1384.488, "learn_time_ms": 10366.567, "learn_throughput": 385.856, "synch_weights_time_ms": 56.31}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "8adec_00000", "date": "2024-07-24_15-07-40", "timestamp": 1721813860, "time_this_iter_s": 10.118064403533936, "time_total_s": 330.61173033714294, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc66440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 330.61173033714294, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.85, "ram_util_percent": 37.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.71621284832557, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.629050683452321, "policy_loss": -0.014731202961896391, "vf_loss": 0.6431342267431319, "vf_explained_var": 0.9981910629197955, "kl": 0.015330242164524577, "entropy": 0.6250949883212645, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": 15.44764720586596, "episode_reward_min": -226.08927580479266, "episode_reward_mean": -64.36161143337497, "episode_len_mean": 59.82, "episode_media": {}, "episodes_timesteps_total": 5982, "policy_reward_min": {"policy_0": -226.08927580479266}, "policy_reward_max": {"policy_0": 15.44764720586596}, "policy_reward_mean": {"policy_0": -64.36161143337497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.21748906563963, -103.79351210660278, -201.4248512198283, -61.76196548498293, -60.17411688142836, -101.23220221060052, -18.391499529752082, -80.84870216519654, -133.70599376426625, 2.5847885885790514, -78.82764810759589, -15.699108198397296, -20.97310338482292, -41.55476416769109, -68.15347487987557, 8.725996801901521, -95.05085449616587, -86.6161461323341, -80.19355898633447, -81.57480690936808, -111.16650924307072, -12.5621860994378, -7.73387999912674, -78.41297071535008, -97.56192460254233, -121.94993909803983, -18.121714728102326, -9.320560210358611, -2.5019125142366403, -33.74982320322667, -16.69723665229424, -79.15837152716071, -19.381088883662695, -125.17417859972863, -125.03406050555957, -146.29456747495107, -53.906139672872236, 4.058793457035464, -5.6456101042970745, -127.39067190323206, -0.5017458894902151, -86.98145822843676, -167.49335594863626, -199.28949705286712, -117.22096128239502, -1.4792100731616502, -29.439689801201933, 10.265881083557266, -31.7971169891606, -11.308287378025103, -18.68423438235268, -72.37599546689151, 4.636595301894596, -17.120849534364428, -17.744111142443245, -46.9579534551317, 10.45262091823153, -23.191559574191498, -103.2481154297111, -226.08927580479266, -140.6065279968167, -40.916115476564414, -12.027353291545621, -41.94508932630809, -29.601812723875426, -11.721837333902695, 15.44764720586596, -85.35452558163378, -41.27186540528374, -7.779656471403313, -74.1817058227419, 11.119079587770576, -197.97407382180756, -111.61498283029081, -4.863992792328454, -216.11810640074413, -140.17777877059237, -0.5816144739120654, -47.509226038231056, -6.916684752385106, 10.66533309599082, -187.67278745168895, -31.832206826132698, -81.2272474291717, -83.74724949986506, -99.55714594237544, -91.44704347053319, -83.56742797541578, -11.903045306230009, -39.09558457778102, -109.08088059213145, -202.57322712305321, -75.71040644345796, -1.9844248674445404, -98.08719940355361, -46.91386427431822, -9.33961563372423, -94.58535653755119, -88.57650191311315, -124.17315393902959], "episode_lengths": [55, 71, 93, 60, 58, 70, 43, 67, 78, 36, 62, 47, 50, 61, 61, 29, 71, 64, 62, 66, 69, 52, 40, 67, 74, 75, 48, 46, 37, 58, 47, 63, 53, 77, 72, 75, 59, 36, 38, 76, 46, 69, 83, 91, 79, 44, 56, 41, 52, 50, 46, 64, 39, 46, 48, 58, 31, 56, 71, 92, 79, 56, 49, 52, 56, 40, 32, 67, 61, 46, 63, 40, 90, 75, 43, 98, 82, 46, 48, 40, 33, 89, 52, 63, 67, 77, 69, 66, 54, 55, 73, 93, 78, 37, 70, 54, 46, 71, 70, 74], "policy_policy_0_reward": [-49.21748906563963, -103.79351210660278, -201.4248512198283, -61.76196548498293, -60.17411688142836, -101.23220221060052, -18.391499529752082, -80.84870216519654, -133.70599376426625, 2.5847885885790514, -78.82764810759589, -15.699108198397296, -20.97310338482292, -41.55476416769109, -68.15347487987557, 8.725996801901521, -95.05085449616587, -86.6161461323341, -80.19355898633447, -81.57480690936808, -111.16650924307072, -12.5621860994378, -7.73387999912674, -78.41297071535008, -97.56192460254233, -121.94993909803983, -18.121714728102326, -9.320560210358611, -2.5019125142366403, -33.74982320322667, -16.69723665229424, -79.15837152716071, -19.381088883662695, -125.17417859972863, -125.03406050555957, -146.29456747495107, -53.906139672872236, 4.058793457035464, -5.6456101042970745, -127.39067190323206, -0.5017458894902151, -86.98145822843676, -167.49335594863626, -199.28949705286712, -117.22096128239502, -1.4792100731616502, -29.439689801201933, 10.265881083557266, -31.7971169891606, -11.308287378025103, -18.68423438235268, -72.37599546689151, 4.636595301894596, -17.120849534364428, -17.744111142443245, -46.9579534551317, 10.45262091823153, -23.191559574191498, -103.2481154297111, -226.08927580479266, -140.6065279968167, -40.916115476564414, -12.027353291545621, -41.94508932630809, -29.601812723875426, -11.721837333902695, 15.44764720586596, -85.35452558163378, -41.27186540528374, -7.779656471403313, -74.1817058227419, 11.119079587770576, -197.97407382180756, -111.61498283029081, -4.863992792328454, -216.11810640074413, -140.17777877059237, -0.5816144739120654, -47.509226038231056, -6.916684752385106, 10.66533309599082, -187.67278745168895, -31.832206826132698, -81.2272474291717, -83.74724949986506, -99.55714594237544, -91.44704347053319, -83.56742797541578, -11.903045306230009, -39.09558457778102, -109.08088059213145, -202.57322712305321, -75.71040644345796, -1.9844248674445404, -98.08719940355361, -46.91386427431822, -9.33961563372423, -94.58535653755119, -88.57650191311315, -124.17315393902959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5212013939066505, "mean_inference_ms": 1.6145502525867754, "mean_action_processing_ms": 0.2557328990234354, "mean_env_wait_ms": 3.661918728203085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011034488677978516, "StateBufferConnector_ms": 0.007427692413330078, "ViewRequirementAgentConnector_ms": 0.17807626724243164}, "num_episodes": 67, "episode_return_max": 15.44764720586596, "episode_return_min": -226.08927580479266, "episode_return_mean": -64.36161143337497, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.7364927972275, "num_env_steps_trained_throughput_per_sec": 311.7364927972275, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 11786.468, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11786.398, "sample_time_ms": 1382.746, "learn_time_ms": 10345.965, "learn_throughput": 386.624, "synch_weights_time_ms": 56.881}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "8adec_00000", "date": "2024-07-24_15-07-53", "timestamp": 1721813873, "time_this_iter_s": 12.84281611442566, "time_total_s": 343.4545464515686, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc66c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 343.4545464515686, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.868421052631575, "ram_util_percent": 37.94210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.20838010211786, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.512534394611915, "policy_loss": -0.016796353119813527, "vf_loss": 0.5277792650895814, "vf_explained_var": 0.9990687986214956, "kl": 0.017559965306152964, "entropy": 0.6350501783192157, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 15.44764720586596, "episode_reward_min": -233.29434056789862, "episode_reward_mean": -74.44161803878438, "episode_len_mean": 63.15, "episode_media": {}, "episodes_timesteps_total": 6315, "policy_reward_min": {"policy_0": -233.29434056789862}, "policy_reward_max": {"policy_0": 15.44764720586596}, "policy_reward_mean": {"policy_0": -74.44161803878438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.94508932630809, -29.601812723875426, -11.721837333902695, 15.44764720586596, -85.35452558163378, -41.27186540528374, -7.779656471403313, -74.1817058227419, 11.119079587770576, -197.97407382180756, -111.61498283029081, -4.863992792328454, -216.11810640074413, -140.17777877059237, -0.5816144739120654, -47.509226038231056, -6.916684752385106, 10.66533309599082, -187.67278745168895, -31.832206826132698, -81.2272474291717, -83.74724949986506, -99.55714594237544, -91.44704347053319, -83.56742797541578, -11.903045306230009, -39.09558457778102, -109.08088059213145, -202.57322712305321, -75.71040644345796, -1.9844248674445404, -98.08719940355361, -46.91386427431822, -9.33961563372423, -94.58535653755119, -88.57650191311315, -124.17315393902959, -233.29434056789862, -111.59144330958716, -130.22977723121082, -166.46007758163088, -12.541402618521111, -30.957889250510316, -133.70709328186857, -138.03969107854238, -9.968518847663674, -104.1441093927349, -8.904847702661636, -84.83744101569292, 9.952782956380972, -124.79995424664169, -90.56935092972775, -224.9139414937836, -115.65988778422974, -112.04133727025362, -59.45595926525017, -124.85982544320026, -228.99048416716886, -38.84498576554456, -39.33604060028375, 3.8387168377031076, -49.80070000071296, -109.91585949726662, 1.217674365474133, -12.192889011933435, -79.9404095713788, -42.32061360320119, -37.21172813289108, -117.57539426642772, -98.92110718420798, 6.597621149803981, -54.76106756216298, -22.89158873672773, -23.688399566346718, -92.69526583926488, 5.9742902951165995, -24.31150099784814, -214.86534729791137, -16.629500238351834, -89.14278874937442, -16.80525135910449, -107.33196568833324, -176.32114736039986, -92.44721744730366, -163.71276234144958, -42.49880911203288, -61.9328182742385, -73.36235976699258, -75.18306384814248, -30.000264480111603, 14.204002339308067, -49.36082473043789, -71.23270937219117, -104.82492888584599, -86.51454324967253, -140.6122912482872, -122.39152087730932, -50.27125090853713, -76.09011986209778, 7.414777953261714], "episode_lengths": [52, 56, 40, 32, 67, 61, 46, 63, 40, 90, 75, 43, 98, 82, 46, 48, 40, 33, 89, 52, 63, 67, 77, 69, 66, 54, 55, 73, 93, 78, 37, 70, 54, 46, 71, 70, 74, 99, 72, 76, 86, 49, 56, 78, 79, 51, 74, 47, 64, 38, 77, 68, 95, 77, 71, 58, 84, 96, 58, 51, 45, 55, 72, 44, 41, 64, 53, 58, 74, 72, 36, 64, 44, 50, 65, 37, 54, 96, 43, 69, 53, 75, 91, 69, 86, 54, 63, 63, 78, 59, 31, 52, 65, 72, 70, 80, 82, 55, 69, 38], "policy_policy_0_reward": [-41.94508932630809, -29.601812723875426, -11.721837333902695, 15.44764720586596, -85.35452558163378, -41.27186540528374, -7.779656471403313, -74.1817058227419, 11.119079587770576, -197.97407382180756, -111.61498283029081, -4.863992792328454, -216.11810640074413, -140.17777877059237, -0.5816144739120654, -47.509226038231056, -6.916684752385106, 10.66533309599082, -187.67278745168895, -31.832206826132698, -81.2272474291717, -83.74724949986506, -99.55714594237544, -91.44704347053319, -83.56742797541578, -11.903045306230009, -39.09558457778102, -109.08088059213145, -202.57322712305321, -75.71040644345796, -1.9844248674445404, -98.08719940355361, -46.91386427431822, -9.33961563372423, -94.58535653755119, -88.57650191311315, -124.17315393902959, -233.29434056789862, -111.59144330958716, -130.22977723121082, -166.46007758163088, -12.541402618521111, -30.957889250510316, -133.70709328186857, -138.03969107854238, -9.968518847663674, -104.1441093927349, -8.904847702661636, -84.83744101569292, 9.952782956380972, -124.79995424664169, -90.56935092972775, -224.9139414937836, -115.65988778422974, -112.04133727025362, -59.45595926525017, -124.85982544320026, -228.99048416716886, -38.84498576554456, -39.33604060028375, 3.8387168377031076, -49.80070000071296, -109.91585949726662, 1.217674365474133, -12.192889011933435, -79.9404095713788, -42.32061360320119, -37.21172813289108, -117.57539426642772, -98.92110718420798, 6.597621149803981, -54.76106756216298, -22.89158873672773, -23.688399566346718, -92.69526583926488, 5.9742902951165995, -24.31150099784814, -214.86534729791137, -16.629500238351834, -89.14278874937442, -16.80525135910449, -107.33196568833324, -176.32114736039986, -92.44721744730366, -163.71276234144958, -42.49880911203288, -61.9328182742385, -73.36235976699258, -75.18306384814248, -30.000264480111603, 14.204002339308067, -49.36082473043789, -71.23270937219117, -104.82492888584599, -86.51454324967253, -140.6122912482872, -122.39152087730932, -50.27125090853713, -76.09011986209778, 7.414777953261714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5206859565421059, "mean_inference_ms": 1.610238359844039, "mean_action_processing_ms": 0.25519444073292796, "mean_env_wait_ms": 3.653278406144573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01125192642211914, "StateBufferConnector_ms": 0.007477998733520508, "ViewRequirementAgentConnector_ms": 0.18076324462890625}, "num_episodes": 63, "episode_return_max": 15.44764720586596, "episode_return_min": -233.29434056789862, "episode_return_mean": -74.44161803878438, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.1868379531321, "num_env_steps_trained_throughput_per_sec": 321.1868379531321, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 11754.17, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11754.1, "sample_time_ms": 1380.246, "learn_time_ms": 10314.18, "learn_throughput": 387.816, "synch_weights_time_ms": 58.868}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "8adec_00000", "date": "2024-07-24_15-08-06", "timestamp": 1721813886, "time_this_iter_s": 12.465538740158081, "time_total_s": 355.9200851917267, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc677f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 355.9200851917267, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 20.93529411764706, "ram_util_percent": 37.92941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.71921659509341, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.46107065647956913, "policy_loss": -0.011080323685988939, "vf_loss": 0.4711587840691209, "vf_explained_var": 0.9992144221439958, "kl": 0.0146802836594361, "entropy": 0.5613932543123762, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": 14.204002339308067, "episode_reward_min": -214.86534729791137, "episode_reward_mean": -72.42133647191515, "episode_len_mean": 63.78, "episode_media": {}, "episodes_timesteps_total": 6378, "policy_reward_min": {"policy_0": -214.86534729791137}, "policy_reward_max": {"policy_0": 14.204002339308067}, "policy_reward_mean": {"policy_0": -72.42133647191515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.217674365474133, -12.192889011933435, -79.9404095713788, -42.32061360320119, -37.21172813289108, -117.57539426642772, -98.92110718420798, 6.597621149803981, -54.76106756216298, -22.89158873672773, -23.688399566346718, -92.69526583926488, 5.9742902951165995, -24.31150099784814, -214.86534729791137, -16.629500238351834, -89.14278874937442, -16.80525135910449, -107.33196568833324, -176.32114736039986, -92.44721744730366, -163.71276234144958, -42.49880911203288, -61.9328182742385, -73.36235976699258, -75.18306384814248, -30.000264480111603, 14.204002339308067, -49.36082473043789, -71.23270937219117, -104.82492888584599, -86.51454324967253, -140.6122912482872, -122.39152087730932, -50.27125090853713, -76.09011986209778, 7.414777953261714, -118.46797729667425, -26.807719256572035, -55.822694043332476, -9.087476881873352, -61.24109685570149, 0.6625315475292634, -102.83724981842934, -94.35035587902549, -89.51736784178249, -91.7003081587665, -174.9216511470698, -96.53049029919653, -85.57619008891916, -101.79011023561111, -122.14936240099368, -67.92619730316093, -59.693363212725636, -79.50742353546559, -83.75191032558635, -93.76065467032448, -97.10799055276097, -146.6902833979669, -81.64239532549179, -5.005796147226361, -90.55489901599135, 2.0677861354420104, -122.4071161226434, -95.0822234046126, -1.8637786874935742, -66.963336191352, -113.96389344436788, -84.71839284411112, -94.29548381104773, -114.29447733881673, -15.290971064118953, -93.66234816628818, -30.204581292443695, -112.15774529758859, -93.75553655069535, -125.32544839252819, -70.39840472518752, -12.888959565358377, -127.40383861330346, -16.318621125778563, -89.18853885084735, -39.02015604799464, -25.380479250800356, -50.007463443196755, -115.97931815664876, -147.6236610929496, -106.83512991392298, -98.5354425078904, -108.13212986760819, 1.9783026088611249, 8.631789356810966, -20.58008534609494, -52.34710003619885, -139.77708242584475, -106.27601409394468, -3.447037556912838, -96.0750970032289, 7.813671433460618, -204.013788883601], "episode_lengths": [44, 41, 64, 53, 58, 74, 72, 36, 64, 44, 50, 65, 37, 54, 96, 43, 69, 53, 75, 91, 69, 86, 54, 63, 63, 78, 59, 31, 52, 65, 72, 70, 80, 82, 55, 69, 38, 74, 59, 56, 52, 61, 39, 71, 78, 67, 82, 88, 81, 73, 73, 80, 60, 58, 73, 81, 70, 70, 81, 64, 48, 77, 37, 75, 71, 47, 59, 72, 67, 69, 74, 51, 82, 47, 81, 69, 78, 62, 48, 76, 50, 68, 51, 52, 57, 73, 84, 69, 67, 74, 37, 40, 47, 65, 81, 71, 44, 67, 39, 92], "policy_policy_0_reward": [1.217674365474133, -12.192889011933435, -79.9404095713788, -42.32061360320119, -37.21172813289108, -117.57539426642772, -98.92110718420798, 6.597621149803981, -54.76106756216298, -22.89158873672773, -23.688399566346718, -92.69526583926488, 5.9742902951165995, -24.31150099784814, -214.86534729791137, -16.629500238351834, -89.14278874937442, -16.80525135910449, -107.33196568833324, -176.32114736039986, -92.44721744730366, -163.71276234144958, -42.49880911203288, -61.9328182742385, -73.36235976699258, -75.18306384814248, -30.000264480111603, 14.204002339308067, -49.36082473043789, -71.23270937219117, -104.82492888584599, -86.51454324967253, -140.6122912482872, -122.39152087730932, -50.27125090853713, -76.09011986209778, 7.414777953261714, -118.46797729667425, -26.807719256572035, -55.822694043332476, -9.087476881873352, -61.24109685570149, 0.6625315475292634, -102.83724981842934, -94.35035587902549, -89.51736784178249, -91.7003081587665, -174.9216511470698, -96.53049029919653, -85.57619008891916, -101.79011023561111, -122.14936240099368, -67.92619730316093, -59.693363212725636, -79.50742353546559, -83.75191032558635, -93.76065467032448, -97.10799055276097, -146.6902833979669, -81.64239532549179, -5.005796147226361, -90.55489901599135, 2.0677861354420104, -122.4071161226434, -95.0822234046126, -1.8637786874935742, -66.963336191352, -113.96389344436788, -84.71839284411112, -94.29548381104773, -114.29447733881673, -15.290971064118953, -93.66234816628818, -30.204581292443695, -112.15774529758859, -93.75553655069535, -125.32544839252819, -70.39840472518752, -12.888959565358377, -127.40383861330346, -16.318621125778563, -89.18853885084735, -39.02015604799464, -25.380479250800356, -50.007463443196755, -115.97931815664876, -147.6236610929496, -106.83512991392298, -98.5354425078904, -108.13212986760819, 1.9783026088611249, 8.631789356810966, -20.58008534609494, -52.34710003619885, -139.77708242584475, -106.27601409394468, -3.447037556912838, -96.0750970032289, 7.813671433460618, -204.013788883601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5219391333858211, "mean_inference_ms": 1.6092472725741007, "mean_action_processing_ms": 0.25552334671985377, "mean_env_wait_ms": 3.6569066384574933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011262655258178711, "StateBufferConnector_ms": 0.007388591766357422, "ViewRequirementAgentConnector_ms": 0.17976069450378418}, "num_episodes": 63, "episode_return_max": 14.204002339308067, "episode_return_min": -214.86534729791137, "episode_return_mean": -72.42133647191515, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.33359353326995, "num_env_steps_trained_throughput_per_sec": 331.33359353326995, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 11670.814, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11670.745, "sample_time_ms": 1379.117, "learn_time_ms": 10231.71, "learn_throughput": 390.941, "synch_weights_time_ms": 59.106}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "8adec_00000", "date": "2024-07-24_15-08-18", "timestamp": 1721813898, "time_this_iter_s": 12.083816051483154, "time_total_s": 368.00390124320984, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf04c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.00390124320984, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.63888888888889, "ram_util_percent": 37.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.15124191691478, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.38091575356277946, "policy_loss": -0.012811346680003529, "vf_loss": 0.3905019571073353, "vf_explained_var": 0.9993707475562891, "kl": 0.018328010299198165, "entropy": 0.5022461307545503, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 19.190524317072516, "episode_reward_min": -216.0805992228973, "episode_reward_mean": -76.73903506798067, "episode_len_mean": 63.94, "episode_media": {}, "episodes_timesteps_total": 6394, "policy_reward_min": {"policy_0": -216.0805992228973}, "policy_reward_max": {"policy_0": 19.190524317072516}, "policy_reward_mean": {"policy_0": -76.73903506798067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.005796147226361, -90.55489901599135, 2.0677861354420104, -122.4071161226434, -95.0822234046126, -1.8637786874935742, -66.963336191352, -113.96389344436788, -84.71839284411112, -94.29548381104773, -114.29447733881673, -15.290971064118953, -93.66234816628818, -30.204581292443695, -112.15774529758859, -93.75553655069535, -125.32544839252819, -70.39840472518752, -12.888959565358377, -127.40383861330346, -16.318621125778563, -89.18853885084735, -39.02015604799464, -25.380479250800356, -50.007463443196755, -115.97931815664876, -147.6236610929496, -106.83512991392298, -98.5354425078904, -108.13212986760819, 1.9783026088611249, 8.631789356810966, -20.58008534609494, -52.34710003619885, -139.77708242584475, -106.27601409394468, -3.447037556912838, -96.0750970032289, 7.813671433460618, -204.013788883601, -63.85307939553848, 15.333662780389611, -65.20475261543373, -148.6904137501158, 11.702982363538945, -22.11517592301241, -64.94346095072429, -17.288337656946737, -62.04552501999112, -33.58928303709643, -11.643235511931852, -10.139205687355254, -17.2610887269058, 18.254115065131522, -14.503355774546904, -20.20873588410396, -66.96851371800405, -43.39296052164672, 12.686840136623628, -93.10627679453206, 19.190524317072516, -74.10792457617927, -188.47975496795058, -124.86393047753043, -120.3840527788621, -37.27393218085423, -67.49798488567282, -99.0516257247844, -28.552847005830646, -113.59669718959073, -26.32199619732166, -31.508848593448654, -152.2560632166663, -191.98061668949063, -86.46085899228359, -163.74760013081706, -115.38813063390995, -175.5431186495455, 7.929263144981486, -216.0805992228973, 0.8130597947460454, -86.94458293799232, -209.40143292272154, -155.3717825364391, -1.2261223575128353, -76.88561979593571, -87.31738392797551, -102.69106015994201, -68.19997794771545, -190.42171552501145, -149.1963010138333, -31.072304851825113, -107.89011587113535, -100.86226939096548, -72.71284282710054, -179.5832854812457, -162.45116394702322, -105.6876460692683, -153.95945849140904, -80.60607851991328], "episode_lengths": [48, 77, 37, 75, 71, 47, 59, 72, 67, 69, 74, 51, 82, 47, 81, 69, 78, 62, 48, 76, 50, 68, 51, 52, 57, 73, 84, 69, 67, 74, 37, 40, 47, 65, 81, 71, 44, 67, 39, 92, 62, 27, 65, 86, 29, 50, 60, 50, 59, 60, 46, 47, 55, 28, 48, 52, 67, 57, 30, 67, 29, 68, 91, 76, 74, 51, 67, 73, 46, 75, 48, 51, 86, 90, 79, 83, 79, 89, 32, 97, 41, 66, 97, 82, 40, 73, 77, 71, 62, 90, 83, 57, 72, 71, 64, 88, 83, 72, 82, 76], "policy_policy_0_reward": [-5.005796147226361, -90.55489901599135, 2.0677861354420104, -122.4071161226434, -95.0822234046126, -1.8637786874935742, -66.963336191352, -113.96389344436788, -84.71839284411112, -94.29548381104773, -114.29447733881673, -15.290971064118953, -93.66234816628818, -30.204581292443695, -112.15774529758859, -93.75553655069535, -125.32544839252819, -70.39840472518752, -12.888959565358377, -127.40383861330346, -16.318621125778563, -89.18853885084735, -39.02015604799464, -25.380479250800356, -50.007463443196755, -115.97931815664876, -147.6236610929496, -106.83512991392298, -98.5354425078904, -108.13212986760819, 1.9783026088611249, 8.631789356810966, -20.58008534609494, -52.34710003619885, -139.77708242584475, -106.27601409394468, -3.447037556912838, -96.0750970032289, 7.813671433460618, -204.013788883601, -63.85307939553848, 15.333662780389611, -65.20475261543373, -148.6904137501158, 11.702982363538945, -22.11517592301241, -64.94346095072429, -17.288337656946737, -62.04552501999112, -33.58928303709643, -11.643235511931852, -10.139205687355254, -17.2610887269058, 18.254115065131522, -14.503355774546904, -20.20873588410396, -66.96851371800405, -43.39296052164672, 12.686840136623628, -93.10627679453206, 19.190524317072516, -74.10792457617927, -188.47975496795058, -124.86393047753043, -120.3840527788621, -37.27393218085423, -67.49798488567282, -99.0516257247844, -28.552847005830646, -113.59669718959073, -26.32199619732166, -31.508848593448654, -152.2560632166663, -191.98061668949063, -86.46085899228359, -163.74760013081706, -115.38813063390995, -175.5431186495455, 7.929263144981486, -216.0805992228973, 0.8130597947460454, -86.94458293799232, -209.40143292272154, -155.3717825364391, -1.2261223575128353, -76.88561979593571, -87.31738392797551, -102.69106015994201, -68.19997794771545, -190.42171552501145, -149.1963010138333, -31.072304851825113, -107.89011587113535, -100.86226939096548, -72.71284282710054, -179.5832854812457, -162.45116394702322, -105.6876460692683, -153.95945849140904, -80.60607851991328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5218711351982512, "mean_inference_ms": 1.606601951263854, "mean_action_processing_ms": 0.25528244897271, "mean_env_wait_ms": 3.656660735897107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010922670364379883, "StateBufferConnector_ms": 0.0071926116943359375, "ViewRequirementAgentConnector_ms": 0.1752009391784668}, "num_episodes": 60, "episode_return_max": 19.190524317072516, "episode_return_min": -216.0805992228973, "episode_return_mean": -76.73903506798067, "episodes_this_iter": 60}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.85662223383304, "num_env_steps_trained_throughput_per_sec": 305.85662223383304, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11668.143, "restore_workers_time_ms": 0.023, "training_step_time_ms": 11668.077, "sample_time_ms": 1361.691, "learn_time_ms": 10245.467, "learn_throughput": 390.417, "synch_weights_time_ms": 60.095}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "8adec_00000", "date": "2024-07-24_15-08-31", "timestamp": 1721813911, "time_this_iter_s": 13.089725255966187, "time_total_s": 381.093626499176, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8c8ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 381.093626499176, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.54444444444444, "ram_util_percent": 37.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.96141188939412, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.36956083402280154, "policy_loss": -0.008411989270340807, "vf_loss": 0.37560208270636697, "vf_explained_var": 0.9991442097971837, "kl": 0.015360064943721833, "entropy": 0.4541289766629537, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": 12.988739566854049, "episode_reward_min": -216.0805992228973, "episode_reward_mean": -79.77685570894069, "episode_len_mean": 66.07, "episode_media": {}, "episodes_timesteps_total": 6607, "policy_reward_min": {"policy_0": -216.0805992228973}, "policy_reward_max": {"policy_0": 12.988739566854049}, "policy_reward_mean": {"policy_0": -79.77685570894069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.27393218085423, -67.49798488567282, -99.0516257247844, -28.552847005830646, -113.59669718959073, -26.32199619732166, -31.508848593448654, -152.2560632166663, -191.98061668949063, -86.46085899228359, -163.74760013081706, -115.38813063390995, -175.5431186495455, 7.929263144981486, -216.0805992228973, 0.8130597947460454, -86.94458293799232, -209.40143292272154, -155.3717825364391, -1.2261223575128353, -76.88561979593571, -87.31738392797551, -102.69106015994201, -68.19997794771545, -190.42171552501145, -149.1963010138333, -31.072304851825113, -107.89011587113535, -100.86226939096548, -72.71284282710054, -179.5832854812457, -162.45116394702322, -105.6876460692683, -153.95945849140904, -80.60607851991328, -82.54061746606364, -11.749366272032649, -0.8465015394958075, -67.9764542558846, -30.319677402345093, 2.672119896234107, -64.4783821747833, -26.65328626364497, -74.99951471720573, 1.4502240991632533, -51.41358905826766, -74.15612006938326, -140.25497678235678, -98.29556360748329, -21.261959429532112, -179.14468954161225, -18.242456554917986, -17.303304545100897, -90.87667975196099, -54.3930418382193, -188.94313234476778, -9.061803005618783, -62.246690200843915, -24.62215040564007, -81.9651316490475, -77.565639375748, -17.408350294141208, -50.42525502969481, -94.45870851584115, -36.951030431019674, -61.403192905302156, -150.4956105635954, 12.988739566854049, -89.11995852947722, -96.01135064342914, -2.859464287052522, -109.2192254011739, -71.27145887946705, -106.09762342713167, -73.79847701987285, -20.45065773490475, -83.85229833868571, -70.3078397335602, -46.534763848430345, 1.4685955103480233, -30.830384609336583, -170.6018321892084, -17.030272967463926, -54.33873281931458, -137.6538920494181, -80.66128563385791, -10.619462445072795, 6.960531635823471, -121.38034190338635, -124.79842194358434, -116.14444919608268, -139.880431228766, -45.355686302181596, -86.23162479338625, -85.65689398789272, -54.3855881734546, -86.35138784764308, -98.33241398628628, -108.61657267781946, -85.38037206524889], "episode_lengths": [51, 67, 73, 46, 75, 48, 51, 86, 90, 79, 83, 79, 89, 32, 97, 41, 66, 97, 82, 40, 73, 77, 71, 62, 90, 83, 57, 72, 71, 64, 88, 83, 72, 82, 76, 65, 46, 44, 60, 57, 42, 58, 57, 63, 42, 58, 67, 78, 71, 50, 88, 51, 53, 70, 65, 92, 44, 65, 56, 66, 65, 50, 64, 69, 62, 59, 83, 34, 71, 72, 45, 81, 66, 76, 74, 53, 64, 77, 62, 44, 48, 86, 53, 56, 78, 66, 44, 37, 75, 77, 74, 81, 62, 81, 69, 61, 67, 70, 71, 79], "policy_policy_0_reward": [-37.27393218085423, -67.49798488567282, -99.0516257247844, -28.552847005830646, -113.59669718959073, -26.32199619732166, -31.508848593448654, -152.2560632166663, -191.98061668949063, -86.46085899228359, -163.74760013081706, -115.38813063390995, -175.5431186495455, 7.929263144981486, -216.0805992228973, 0.8130597947460454, -86.94458293799232, -209.40143292272154, -155.3717825364391, -1.2261223575128353, -76.88561979593571, -87.31738392797551, -102.69106015994201, -68.19997794771545, -190.42171552501145, -149.1963010138333, -31.072304851825113, -107.89011587113535, -100.86226939096548, -72.71284282710054, -179.5832854812457, -162.45116394702322, -105.6876460692683, -153.95945849140904, -80.60607851991328, -82.54061746606364, -11.749366272032649, -0.8465015394958075, -67.9764542558846, -30.319677402345093, 2.672119896234107, -64.4783821747833, -26.65328626364497, -74.99951471720573, 1.4502240991632533, -51.41358905826766, -74.15612006938326, -140.25497678235678, -98.29556360748329, -21.261959429532112, -179.14468954161225, -18.242456554917986, -17.303304545100897, -90.87667975196099, -54.3930418382193, -188.94313234476778, -9.061803005618783, -62.246690200843915, -24.62215040564007, -81.9651316490475, -77.565639375748, -17.408350294141208, -50.42525502969481, -94.45870851584115, -36.951030431019674, -61.403192905302156, -150.4956105635954, 12.988739566854049, -89.11995852947722, -96.01135064342914, -2.859464287052522, -109.2192254011739, -71.27145887946705, -106.09762342713167, -73.79847701987285, -20.45065773490475, -83.85229833868571, -70.3078397335602, -46.534763848430345, 1.4685955103480233, -30.830384609336583, -170.6018321892084, -17.030272967463926, -54.33873281931458, -137.6538920494181, -80.66128563385791, -10.619462445072795, 6.960531635823471, -121.38034190338635, -124.79842194358434, -116.14444919608268, -139.880431228766, -45.355686302181596, -86.23162479338625, -85.65689398789272, -54.3855881734546, -86.35138784764308, -98.33241398628628, -108.61657267781946, -85.38037206524889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5211259234444423, "mean_inference_ms": 1.6033085818435862, "mean_action_processing_ms": 0.255074933476797, "mean_env_wait_ms": 3.6503456150919242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010962724685668945, "StateBufferConnector_ms": 0.007277011871337891, "ViewRequirementAgentConnector_ms": 0.17568588256835938}, "num_episodes": 65, "episode_return_max": 12.988739566854049, "episode_return_min": -216.0805992228973, "episode_return_mean": -79.77685570894069, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.954074156423, "num_env_steps_trained_throughput_per_sec": 429.954074156423, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 11315.207, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11315.14, "sample_time_ms": 1360.749, "learn_time_ms": 9893.591, "learn_throughput": 404.302, "synch_weights_time_ms": 59.979}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "8adec_00000", "date": "2024-07-24_15-08-40", "timestamp": 1721813920, "time_this_iter_s": 9.314871072769165, "time_total_s": 390.4084975719452, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8c9630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 390.4084975719452, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.928571428571427, "ram_util_percent": 37.81428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.44686186214288, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.3774764183287819, "policy_loss": -0.014234434269019403, "vf_loss": 0.3895837978615115, "vf_explained_var": 0.9988732796162367, "kl": 0.014404425586205132, "entropy": 0.4354937200124065, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 19.64130687908757, "episode_reward_min": -210.4787810538702, "episode_reward_mean": -71.51998585867027, "episode_len_mean": 63.38, "episode_media": {}, "episodes_timesteps_total": 6338, "policy_reward_min": {"policy_0": -210.4787810538702}, "policy_reward_max": {"policy_0": 19.64130687908757}, "policy_reward_mean": {"policy_0": -71.51998585867027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.951030431019674, -61.403192905302156, -150.4956105635954, 12.988739566854049, -89.11995852947722, -96.01135064342914, -2.859464287052522, -109.2192254011739, -71.27145887946705, -106.09762342713167, -73.79847701987285, -20.45065773490475, -83.85229833868571, -70.3078397335602, -46.534763848430345, 1.4685955103480233, -30.830384609336583, -170.6018321892084, -17.030272967463926, -54.33873281931458, -137.6538920494181, -80.66128563385791, -10.619462445072795, 6.960531635823471, -121.38034190338635, -124.79842194358434, -116.14444919608268, -139.880431228766, -45.355686302181596, -86.23162479338625, -85.65689398789272, -54.3855881734546, -86.35138784764308, -98.33241398628628, -108.61657267781946, -85.38037206524889, -160.91656734730606, -15.415524420526783, 19.64130687908757, -69.74030546642616, -166.8372802696583, -26.408023281566596, -117.39434987827329, 9.28203192455149, -191.62821237001722, -28.41695937578169, -24.28772314751734, -108.08771153209857, -34.26985092084658, -6.055337819561969, -8.488006433854533, -172.52834411850895, -210.4787810538702, -27.24571536678579, -78.64270850997737, -55.88548119664347, -86.62268331665219, 4.270584404111792, -101.24983529978323, -59.14223484247113, -4.9119142061064185, -173.20151220873316, -94.2887756944275, -91.10890275413158, -125.71686081706264, -33.60112618756426, 19.621378421229036, -109.36548754861991, -139.00295733742882, -82.67433948276624, -45.318738794733235, -177.45957626791366, -50.847682416678225, -54.823529349557916, 2.1184188784613345, -82.42102907255529, -24.068635300842015, -42.336657795014396, -147.57995775594006, -0.23698217149605616, -183.27595235196617, -15.784185119803345, -56.87023942314225, -148.49413231518122, -33.01910148353451, -88.05843478354184, -10.705878198533501, -54.320362725517384, -8.054707044777105, -79.1097017485256, -58.55630556768306, -21.815704522242036, -93.7064786292526, -80.49559316541296, -77.59457703822186, -128.52799013940916, 13.241566329878685, -21.99090716781695, -90.27937494258497, -89.60281335802011], "episode_lengths": [62, 59, 83, 34, 71, 72, 45, 81, 66, 76, 74, 53, 64, 77, 62, 44, 48, 86, 53, 56, 78, 66, 44, 37, 75, 77, 74, 81, 62, 81, 69, 61, 67, 70, 71, 79, 84, 48, 28, 60, 85, 46, 74, 39, 92, 47, 54, 74, 58, 39, 46, 90, 96, 48, 63, 57, 70, 37, 70, 64, 49, 87, 68, 76, 77, 57, 29, 72, 79, 69, 61, 86, 64, 63, 42, 69, 44, 49, 81, 42, 92, 49, 61, 82, 52, 67, 41, 56, 46, 80, 59, 45, 74, 65, 63, 90, 34, 56, 68, 67], "policy_policy_0_reward": [-36.951030431019674, -61.403192905302156, -150.4956105635954, 12.988739566854049, -89.11995852947722, -96.01135064342914, -2.859464287052522, -109.2192254011739, -71.27145887946705, -106.09762342713167, -73.79847701987285, -20.45065773490475, -83.85229833868571, -70.3078397335602, -46.534763848430345, 1.4685955103480233, -30.830384609336583, -170.6018321892084, -17.030272967463926, -54.33873281931458, -137.6538920494181, -80.66128563385791, -10.619462445072795, 6.960531635823471, -121.38034190338635, -124.79842194358434, -116.14444919608268, -139.880431228766, -45.355686302181596, -86.23162479338625, -85.65689398789272, -54.3855881734546, -86.35138784764308, -98.33241398628628, -108.61657267781946, -85.38037206524889, -160.91656734730606, -15.415524420526783, 19.64130687908757, -69.74030546642616, -166.8372802696583, -26.408023281566596, -117.39434987827329, 9.28203192455149, -191.62821237001722, -28.41695937578169, -24.28772314751734, -108.08771153209857, -34.26985092084658, -6.055337819561969, -8.488006433854533, -172.52834411850895, -210.4787810538702, -27.24571536678579, -78.64270850997737, -55.88548119664347, -86.62268331665219, 4.270584404111792, -101.24983529978323, -59.14223484247113, -4.9119142061064185, -173.20151220873316, -94.2887756944275, -91.10890275413158, -125.71686081706264, -33.60112618756426, 19.621378421229036, -109.36548754861991, -139.00295733742882, -82.67433948276624, -45.318738794733235, -177.45957626791366, -50.847682416678225, -54.823529349557916, 2.1184188784613345, -82.42102907255529, -24.068635300842015, -42.336657795014396, -147.57995775594006, -0.23698217149605616, -183.27595235196617, -15.784185119803345, -56.87023942314225, -148.49413231518122, -33.01910148353451, -88.05843478354184, -10.705878198533501, -54.320362725517384, -8.054707044777105, -79.1097017485256, -58.55630556768306, -21.815704522242036, -93.7064786292526, -80.49559316541296, -77.59457703822186, -128.52799013940916, 13.241566329878685, -21.99090716781695, -90.27937494258497, -89.60281335802011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5218248771093768, "mean_inference_ms": 1.6021234221775598, "mean_action_processing_ms": 0.255053728338811, "mean_env_wait_ms": 3.6530704282347735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011469125747680664, "StateBufferConnector_ms": 0.00762629508972168, "ViewRequirementAgentConnector_ms": 0.18254947662353516}, "num_episodes": 64, "episode_return_max": 19.64130687908757, "episode_return_min": -210.4787810538702, "episode_return_mean": -71.51998585867027, "episodes_this_iter": 64}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.1510294992944, "num_env_steps_trained_throughput_per_sec": 320.1510294992944, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 11333.142, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11333.073, "sample_time_ms": 1364.346, "learn_time_ms": 9907.308, "learn_throughput": 403.742, "synch_weights_time_ms": 60.59}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "8adec_00000", "date": "2024-07-24_15-08-53", "timestamp": 1721813933, "time_this_iter_s": 12.504651069641113, "time_total_s": 402.9131486415863, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bb91240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 402.9131486415863, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 20.458823529411767, "ram_util_percent": 37.85294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.95855377564828, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.364699141822833, "policy_loss": -0.008215342143860957, "vf_loss": 0.37044230472917355, "vf_explained_var": 0.9987587376187245, "kl": 0.015090437024779628, "entropy": 0.43185167452320455, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": 19.621378421229036, "episode_reward_min": -237.46781860697882, "episode_reward_mean": -69.69329878249349, "episode_len_mean": 62.69, "episode_media": {}, "episodes_timesteps_total": 6269, "policy_reward_min": {"policy_0": -237.46781860697882}, "policy_reward_max": {"policy_0": 19.621378421229036}, "policy_reward_mean": {"policy_0": -69.69329878249349}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-91.10890275413158, -125.71686081706264, -33.60112618756426, 19.621378421229036, -109.36548754861991, -139.00295733742882, -82.67433948276624, -45.318738794733235, -177.45957626791366, -50.847682416678225, -54.823529349557916, 2.1184188784613345, -82.42102907255529, -24.068635300842015, -42.336657795014396, -147.57995775594006, -0.23698217149605616, -183.27595235196617, -15.784185119803345, -56.87023942314225, -148.49413231518122, -33.01910148353451, -88.05843478354184, -10.705878198533501, -54.320362725517384, -8.054707044777105, -79.1097017485256, -58.55630556768306, -21.815704522242036, -93.7064786292526, -80.49559316541296, -77.59457703822186, -128.52799013940916, 13.241566329878685, -21.99090716781695, -90.27937494258497, -89.60281335802011, -41.28105778068313, 7.026225318056244, -82.8144021212184, -96.48125383222165, -19.972112422535467, -8.425702739326216, -59.55215348011164, -78.03771250571178, -213.1374623487317, -176.97244495467203, -29.452096965814185, -7.570013160825247, -32.028229026462235, -147.6299204500929, -52.99673254935712, -145.08306829900962, -101.20688184135119, -81.1870777399788, -209.73622596721782, -173.78394640284554, -96.06671962592793, -23.97470721726436, -13.434126487878356, -79.67201029346766, -64.35334883561787, -120.77478436569352, 7.554585403725776, -22.820228235557767, -29.906072929148515, -104.09243958562959, -82.53696699647816, 9.306659791800937, -64.2716555640299, -188.4965937059564, -55.9072674550815, -67.24662101387939, 3.4245253387468058, -0.8818139831019842, -64.93933801202839, -151.32222822896483, -161.64519239529218, -80.4805139466744, -19.866460377447357, -3.562239377766571, -28.32688601101666, -24.608118932273452, -75.48394392394185, -237.46781860697882, -7.283338288123793, -66.99435851412461, 4.110062696183064, -208.3811442182687, -106.1118859599901, 5.842472915924217, -108.94141613453704, -19.25579594035475, -97.31696377768128, -54.790897901992395, -34.601751747426924, -109.47289370935036, 11.161726268802044, -14.672744221490284, -58.60281572608069], "episode_lengths": [76, 77, 57, 29, 72, 79, 69, 61, 86, 64, 63, 42, 69, 44, 49, 81, 42, 92, 49, 61, 82, 52, 67, 41, 56, 46, 80, 59, 45, 74, 65, 63, 90, 34, 56, 68, 67, 61, 37, 62, 83, 47, 42, 66, 64, 96, 86, 56, 48, 56, 82, 64, 81, 69, 65, 95, 87, 71, 56, 51, 65, 57, 76, 42, 55, 60, 80, 78, 34, 61, 89, 58, 67, 35, 42, 59, 81, 84, 70, 49, 47, 50, 50, 73, 100, 48, 60, 41, 93, 71, 35, 69, 53, 69, 63, 61, 71, 36, 47, 58], "policy_policy_0_reward": [-91.10890275413158, -125.71686081706264, -33.60112618756426, 19.621378421229036, -109.36548754861991, -139.00295733742882, -82.67433948276624, -45.318738794733235, -177.45957626791366, -50.847682416678225, -54.823529349557916, 2.1184188784613345, -82.42102907255529, -24.068635300842015, -42.336657795014396, -147.57995775594006, -0.23698217149605616, -183.27595235196617, -15.784185119803345, -56.87023942314225, -148.49413231518122, -33.01910148353451, -88.05843478354184, -10.705878198533501, -54.320362725517384, -8.054707044777105, -79.1097017485256, -58.55630556768306, -21.815704522242036, -93.7064786292526, -80.49559316541296, -77.59457703822186, -128.52799013940916, 13.241566329878685, -21.99090716781695, -90.27937494258497, -89.60281335802011, -41.28105778068313, 7.026225318056244, -82.8144021212184, -96.48125383222165, -19.972112422535467, -8.425702739326216, -59.55215348011164, -78.03771250571178, -213.1374623487317, -176.97244495467203, -29.452096965814185, -7.570013160825247, -32.028229026462235, -147.6299204500929, -52.99673254935712, -145.08306829900962, -101.20688184135119, -81.1870777399788, -209.73622596721782, -173.78394640284554, -96.06671962592793, -23.97470721726436, -13.434126487878356, -79.67201029346766, -64.35334883561787, -120.77478436569352, 7.554585403725776, -22.820228235557767, -29.906072929148515, -104.09243958562959, -82.53696699647816, 9.306659791800937, -64.2716555640299, -188.4965937059564, -55.9072674550815, -67.24662101387939, 3.4245253387468058, -0.8818139831019842, -64.93933801202839, -151.32222822896483, -161.64519239529218, -80.4805139466744, -19.866460377447357, -3.562239377766571, -28.32688601101666, -24.608118932273452, -75.48394392394185, -237.46781860697882, -7.283338288123793, -66.99435851412461, 4.110062696183064, -208.3811442182687, -106.1118859599901, 5.842472915924217, -108.94141613453704, -19.25579594035475, -97.31696377768128, -54.790897901992395, -34.601751747426924, -109.47289370935036, 11.161726268802044, -14.672744221490284, -58.60281572608069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5218778412751727, "mean_inference_ms": 1.600016029156539, "mean_action_processing_ms": 0.2550263973336824, "mean_env_wait_ms": 3.6506658039519078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010706901550292969, "StateBufferConnector_ms": 0.007338047027587891, "ViewRequirementAgentConnector_ms": 0.17815542221069336}, "num_episodes": 63, "episode_return_max": 19.621378421229036, "episode_return_min": -237.46781860697882, "episode_return_mean": -69.69329878249349, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.68893967846793, "num_env_steps_trained_throughput_per_sec": 468.68893967846793, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 11158.543, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11158.472, "sample_time_ms": 1369.137, "learn_time_ms": 9727.788, "learn_throughput": 411.193, "synch_weights_time_ms": 60.714}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "8adec_00000", "date": "2024-07-24_15-09-02", "timestamp": 1721813942, "time_this_iter_s": 8.546664714813232, "time_total_s": 411.45981335639954, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc651b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 411.45981335639954, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 21.792307692307695, "ram_util_percent": 37.93076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.394366942346096, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.2908610520569103, "policy_loss": -0.007721117201920909, "vf_loss": 0.29336164697694284, "vf_explained_var": 0.9994210654248794, "kl": 0.01916701175820589, "entropy": 0.34046319299377503, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 15.561595700579502, "episode_reward_min": -237.46781860697882, "episode_reward_mean": -72.08492344866862, "episode_len_mean": 62.99, "episode_media": {}, "episodes_timesteps_total": 6299, "policy_reward_min": {"policy_0": -237.46781860697882}, "policy_reward_max": {"policy_0": 15.561595700579502}, "policy_reward_mean": {"policy_0": -72.08492344866862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.35334883561787, -120.77478436569352, 7.554585403725776, -22.820228235557767, -29.906072929148515, -104.09243958562959, -82.53696699647816, 9.306659791800937, -64.2716555640299, -188.4965937059564, -55.9072674550815, -67.24662101387939, 3.4245253387468058, -0.8818139831019842, -64.93933801202839, -151.32222822896483, -161.64519239529218, -80.4805139466744, -19.866460377447357, -3.562239377766571, -28.32688601101666, -24.608118932273452, -75.48394392394185, -237.46781860697882, -7.283338288123793, -66.99435851412461, 4.110062696183064, -208.3811442182687, -106.1118859599901, 5.842472915924217, -108.94141613453704, -19.25579594035475, -97.31696377768128, -54.790897901992395, -34.601751747426924, -109.47289370935036, 11.161726268802044, -14.672744221490284, -58.60281572608069, -165.60397769839994, -24.52469675599524, -9.449864856327876, 9.263527920166768, -80.14041550076004, -35.48436210814534, -42.364745219780914, -123.18388149396912, -105.30034373074675, 7.319092063950452, -80.62709223329206, -125.46682401121964, -50.235321820141074, -91.32264160327497, -192.51793324690692, -107.02852440216887, -73.56477611091906, -33.46061461896396, -172.92628593159424, -193.6782541247384, 7.200366466245675, -185.07920708302098, -132.64078421635105, -41.07827382627481, -44.04973453165747, -123.08825173286748, -44.19964434748305, -77.22588231423785, 2.9583880873820263, -79.14032171653125, -140.13833696161444, -102.4106538746917, -72.0407825460117, 0.7645988376154689, -134.83971049896346, -78.20547779468363, -202.63337529430814, -44.975861895043614, -83.69279845701939, 15.561595700579502, -140.71043901888447, -22.708471134034603, -74.92131210390903, -111.57797871412873, -209.35529693577828, -83.34921970824855, -13.469039030526382, -121.88570905283505, -45.17427920379221, 7.905751527696113, -224.5816026180696, -0.2397944116362003, -33.98547105771467, 4.927453528610085, -6.130843668424213, -62.66581849667284, -77.46798842201706, -109.84170400195347, 6.386849360251604, -32.04116730462196, -114.33767471121055], "episode_lengths": [57, 76, 42, 55, 60, 80, 78, 34, 61, 89, 58, 67, 35, 42, 59, 81, 84, 70, 49, 47, 50, 50, 73, 100, 48, 60, 41, 93, 71, 35, 69, 53, 69, 63, 61, 71, 36, 47, 58, 83, 58, 54, 36, 67, 56, 55, 78, 72, 44, 68, 75, 53, 67, 91, 75, 68, 55, 92, 90, 40, 89, 78, 51, 52, 83, 56, 65, 43, 66, 92, 69, 60, 46, 87, 70, 93, 62, 66, 30, 81, 55, 63, 72, 97, 65, 41, 78, 55, 39, 98, 42, 50, 39, 48, 57, 68, 76, 37, 58, 73], "policy_policy_0_reward": [-64.35334883561787, -120.77478436569352, 7.554585403725776, -22.820228235557767, -29.906072929148515, -104.09243958562959, -82.53696699647816, 9.306659791800937, -64.2716555640299, -188.4965937059564, -55.9072674550815, -67.24662101387939, 3.4245253387468058, -0.8818139831019842, -64.93933801202839, -151.32222822896483, -161.64519239529218, -80.4805139466744, -19.866460377447357, -3.562239377766571, -28.32688601101666, -24.608118932273452, -75.48394392394185, -237.46781860697882, -7.283338288123793, -66.99435851412461, 4.110062696183064, -208.3811442182687, -106.1118859599901, 5.842472915924217, -108.94141613453704, -19.25579594035475, -97.31696377768128, -54.790897901992395, -34.601751747426924, -109.47289370935036, 11.161726268802044, -14.672744221490284, -58.60281572608069, -165.60397769839994, -24.52469675599524, -9.449864856327876, 9.263527920166768, -80.14041550076004, -35.48436210814534, -42.364745219780914, -123.18388149396912, -105.30034373074675, 7.319092063950452, -80.62709223329206, -125.46682401121964, -50.235321820141074, -91.32264160327497, -192.51793324690692, -107.02852440216887, -73.56477611091906, -33.46061461896396, -172.92628593159424, -193.6782541247384, 7.200366466245675, -185.07920708302098, -132.64078421635105, -41.07827382627481, -44.04973453165747, -123.08825173286748, -44.19964434748305, -77.22588231423785, 2.9583880873820263, -79.14032171653125, -140.13833696161444, -102.4106538746917, -72.0407825460117, 0.7645988376154689, -134.83971049896346, -78.20547779468363, -202.63337529430814, -44.975861895043614, -83.69279845701939, 15.561595700579502, -140.71043901888447, -22.708471134034603, -74.92131210390903, -111.57797871412873, -209.35529693577828, -83.34921970824855, -13.469039030526382, -121.88570905283505, -45.17427920379221, 7.905751527696113, -224.5816026180696, -0.2397944116362003, -33.98547105771467, 4.927453528610085, -6.130843668424213, -62.66581849667284, -77.46798842201706, -109.84170400195347, 6.386849360251604, -32.04116730462196, -114.33767471121055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5216867865638273, "mean_inference_ms": 1.5974222058657022, "mean_action_processing_ms": 0.2548275661517676, "mean_env_wait_ms": 3.6511800759085666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010803937911987305, "StateBufferConnector_ms": 0.0072329044342041016, "ViewRequirementAgentConnector_ms": 0.17452716827392578}, "num_episodes": 61, "episode_return_max": 15.561595700579502, "episode_return_min": -237.46781860697882, "episode_return_mean": -72.08492344866862, "episodes_this_iter": 61}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.15749415769426, "num_env_steps_trained_throughput_per_sec": 302.15749415769426, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11669.286, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11669.212, "sample_time_ms": 1369.852, "learn_time_ms": 10240.806, "learn_throughput": 390.594, "synch_weights_time_ms": 57.758}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "8adec_00000", "date": "2024-07-24_15-09-15", "timestamp": 1721813955, "time_this_iter_s": 13.251687288284302, "time_total_s": 424.71150064468384, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc66a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 424.71150064468384, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.705555555555556, "ram_util_percent": 37.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.26291311432918, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.285727404349988, "policy_loss": -0.008488042145230187, "vf_loss": 0.2898295785766095, "vf_explained_var": 0.9994656215111415, "kl": 0.017753586676038442, "entropy": 0.3603245691706737, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": 16.02750170600776, "episode_reward_min": -224.5816026180696, "episode_reward_mean": -64.57433644096922, "episode_len_mean": 61.37, "episode_media": {}, "episodes_timesteps_total": 6137, "policy_reward_min": {"policy_0": -224.5816026180696}, "policy_reward_max": {"policy_0": 16.02750170600776}, "policy_reward_mean": {"policy_0": -64.57433644096922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.4106538746917, -72.0407825460117, 0.7645988376154689, -134.83971049896346, -78.20547779468363, -202.63337529430814, -44.975861895043614, -83.69279845701939, 15.561595700579502, -140.71043901888447, -22.708471134034603, -74.92131210390903, -111.57797871412873, -209.35529693577828, -83.34921970824855, -13.469039030526382, -121.88570905283505, -45.17427920379221, 7.905751527696113, -224.5816026180696, -0.2397944116362003, -33.98547105771467, 4.927453528610085, -6.130843668424213, -62.66581849667284, -77.46798842201706, -109.84170400195347, 6.386849360251604, -32.04116730462196, -114.33767471121055, -24.309829198921094, -133.92010487487764, -99.20258228053486, -120.91721236187297, -123.53831432886332, -161.783116068677, -104.38689132488156, -152.82091621812398, -1.6179121647033683, -70.89590735199356, -35.568897984296335, -92.57639673433908, -86.20073080885936, -70.7248960813784, -119.89895982048874, -36.600795704765666, -19.356101808159792, 0.8406785648956216, -151.11176188412676, -65.10596783885772, -157.28587975436383, -11.427149865798482, -4.704583706529029, 2.4800525755701246, -3.261227179270569, -155.07170086208504, -36.81288041887062, -4.974410651425387, -17.0565902074176, 13.759974220129266, -168.64300071438325, -74.14250266109349, -65.28648609209563, -181.38076512967658, -210.53461706608556, -45.84299319189101, 2.1293749344634554, 9.168065033611331, 7.064057297011943, -80.95907076744916, -97.28329914185966, -142.83056579062904, 7.347242412072558, -10.061617854560142, -19.861967306509108, -57.60014210855316, -17.59931458051316, 5.468845017924827, 11.980269893851398, 0.21690295534057036, -31.556928352963535, -22.278633689415535, -14.327033308539324, -142.3770884163333, -24.436014115191725, -89.41845482554686, -71.45021253146439, -105.89865563833402, -29.326111410492025, -19.8765325662279, -60.478299303022204, -94.19008911538606, -25.96008171764306, -91.76238936637506, 16.02750170600776, 8.499708582095785, -107.35747455955051, -64.64245017267001, -127.35797903066182, -18.86760827987206], "episode_lengths": [69, 60, 46, 87, 70, 93, 62, 66, 30, 81, 55, 63, 72, 97, 65, 41, 78, 55, 39, 98, 42, 50, 39, 48, 57, 68, 76, 37, 58, 73, 49, 80, 77, 82, 76, 85, 72, 83, 46, 65, 57, 69, 67, 74, 74, 54, 58, 39, 85, 59, 88, 43, 46, 44, 41, 82, 54, 46, 54, 30, 88, 70, 66, 92, 98, 62, 43, 41, 44, 65, 71, 79, 44, 45, 57, 65, 49, 36, 29, 44, 59, 46, 51, 82, 58, 68, 68, 72, 46, 57, 58, 74, 45, 69, 38, 36, 71, 62, 78, 57], "policy_policy_0_reward": [-102.4106538746917, -72.0407825460117, 0.7645988376154689, -134.83971049896346, -78.20547779468363, -202.63337529430814, -44.975861895043614, -83.69279845701939, 15.561595700579502, -140.71043901888447, -22.708471134034603, -74.92131210390903, -111.57797871412873, -209.35529693577828, -83.34921970824855, -13.469039030526382, -121.88570905283505, -45.17427920379221, 7.905751527696113, -224.5816026180696, -0.2397944116362003, -33.98547105771467, 4.927453528610085, -6.130843668424213, -62.66581849667284, -77.46798842201706, -109.84170400195347, 6.386849360251604, -32.04116730462196, -114.33767471121055, -24.309829198921094, -133.92010487487764, -99.20258228053486, -120.91721236187297, -123.53831432886332, -161.783116068677, -104.38689132488156, -152.82091621812398, -1.6179121647033683, -70.89590735199356, -35.568897984296335, -92.57639673433908, -86.20073080885936, -70.7248960813784, -119.89895982048874, -36.600795704765666, -19.356101808159792, 0.8406785648956216, -151.11176188412676, -65.10596783885772, -157.28587975436383, -11.427149865798482, -4.704583706529029, 2.4800525755701246, -3.261227179270569, -155.07170086208504, -36.81288041887062, -4.974410651425387, -17.0565902074176, 13.759974220129266, -168.64300071438325, -74.14250266109349, -65.28648609209563, -181.38076512967658, -210.53461706608556, -45.84299319189101, 2.1293749344634554, 9.168065033611331, 7.064057297011943, -80.95907076744916, -97.28329914185966, -142.83056579062904, 7.347242412072558, -10.061617854560142, -19.861967306509108, -57.60014210855316, -17.59931458051316, 5.468845017924827, 11.980269893851398, 0.21690295534057036, -31.556928352963535, -22.278633689415535, -14.327033308539324, -142.3770884163333, -24.436014115191725, -89.41845482554686, -71.45021253146439, -105.89865563833402, -29.326111410492025, -19.8765325662279, -60.478299303022204, -94.19008911538606, -25.96008171764306, -91.76238936637506, 16.02750170600776, 8.499708582095785, -107.35747455955051, -64.64245017267001, -127.35797903066182, -18.86760827987206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5225404345157386, "mean_inference_ms": 1.597980587545314, "mean_action_processing_ms": 0.2552063175518615, "mean_env_wait_ms": 3.6577358588283975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011111259460449219, "StateBufferConnector_ms": 0.007445335388183594, "ViewRequirementAgentConnector_ms": 0.18083834648132324}, "num_episodes": 70, "episode_return_max": 16.02750170600776, "episode_return_min": -224.5816026180696, "episode_return_mean": -64.57433644096922, "episodes_this_iter": 70}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.1849887635546, "num_env_steps_trained_throughput_per_sec": 309.1849887635546, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 11704.945, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11704.873, "sample_time_ms": 1334.446, "learn_time_ms": 10310.87, "learn_throughput": 387.94, "synch_weights_time_ms": 58.773}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "8adec_00000", "date": "2024-07-24_15-09-28", "timestamp": 1721813968, "time_this_iter_s": 12.948421239852905, "time_total_s": 437.65992188453674, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bb91240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 437.65992188453674, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.55263157894737, "ram_util_percent": 37.92105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.40092666943868, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.2919544931452644, "policy_loss": -0.009049086873225557, "vf_loss": 0.2957087743639325, "vf_explained_var": 0.9994773380458355, "kl": 0.01909034170700278, "entropy": 0.3295847311305503, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 16.02750170600776, "episode_reward_min": -210.53461706608556, "episode_reward_mean": -63.35080795050001, "episode_len_mean": 61.33, "episode_media": {}, "episodes_timesteps_total": 6133, "policy_reward_min": {"policy_0": -210.53461706608556}, "policy_reward_max": {"policy_0": 16.02750170600776}, "policy_reward_mean": {"policy_0": -63.35080795050001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.64300071438325, -74.14250266109349, -65.28648609209563, -181.38076512967658, -210.53461706608556, -45.84299319189101, 2.1293749344634554, 9.168065033611331, 7.064057297011943, -80.95907076744916, -97.28329914185966, -142.83056579062904, 7.347242412072558, -10.061617854560142, -19.861967306509108, -57.60014210855316, -17.59931458051316, 5.468845017924827, 11.980269893851398, 0.21690295534057036, -31.556928352963535, -22.278633689415535, -14.327033308539324, -142.3770884163333, -24.436014115191725, -89.41845482554686, -71.45021253146439, -105.89865563833402, -29.326111410492025, -19.8765325662279, -60.478299303022204, -94.19008911538606, -25.96008171764306, -91.76238936637506, 16.02750170600776, 8.499708582095785, -107.35747455955051, -64.64245017267001, -127.35797903066182, -18.86760827987206, -127.75538012020358, -129.1462381861683, -57.07988536712633, -204.64275283352353, -53.144250762662, -41.591473979749736, -129.03448762704124, -85.71026495650615, -19.50791854670962, -161.59134601777066, -103.36727069678406, -9.52826238778232, -2.53155176556217, -165.95801870930197, -60.53503527845898, -24.007176987629464, -127.26990336569487, -27.83232762363919, -61.55416082166036, -150.8383097966125, -105.99340646111587, -86.84870188622875, -52.16617243541123, -55.703989516164114, 7.042863561045307, -68.11507801891646, -17.970042634726457, -22.271663108559142, -150.06171792873326, -44.231994263621765, -112.89767337195761, 4.374834272910116, 3.274071883216961, -26.331810713895532, -92.96445508449531, 13.756979868852168, -86.22063800819708, -114.05825176936911, -28.735993459829334, -28.23376863574049, -68.35550157805882, -114.80866226425624, -127.4798463664059, -5.970607525054401, -21.487959388620297, -203.10404993363738, -19.31775270007536, -33.14565021296845, -23.610008311206602, -16.810482372836, -79.22515053989237, -105.08355151417739, -162.48254300352426, -66.77103137279009, -40.38932780407754, -60.27538455628319, -8.530549998539346, -29.375944809423068, 2.2066895696700426, -98.39444585371115], "episode_lengths": [88, 70, 66, 92, 98, 62, 43, 41, 44, 65, 71, 79, 44, 45, 57, 65, 49, 36, 29, 44, 59, 46, 51, 82, 58, 68, 68, 72, 46, 57, 58, 74, 45, 69, 38, 36, 71, 62, 78, 57, 75, 79, 57, 96, 55, 50, 78, 68, 52, 88, 73, 54, 48, 89, 60, 58, 80, 58, 65, 82, 75, 66, 65, 66, 43, 60, 50, 51, 84, 53, 74, 39, 46, 56, 68, 29, 69, 73, 59, 60, 68, 75, 76, 42, 45, 94, 49, 51, 45, 56, 64, 73, 87, 62, 54, 59, 40, 52, 35, 72], "policy_policy_0_reward": [-168.64300071438325, -74.14250266109349, -65.28648609209563, -181.38076512967658, -210.53461706608556, -45.84299319189101, 2.1293749344634554, 9.168065033611331, 7.064057297011943, -80.95907076744916, -97.28329914185966, -142.83056579062904, 7.347242412072558, -10.061617854560142, -19.861967306509108, -57.60014210855316, -17.59931458051316, 5.468845017924827, 11.980269893851398, 0.21690295534057036, -31.556928352963535, -22.278633689415535, -14.327033308539324, -142.3770884163333, -24.436014115191725, -89.41845482554686, -71.45021253146439, -105.89865563833402, -29.326111410492025, -19.8765325662279, -60.478299303022204, -94.19008911538606, -25.96008171764306, -91.76238936637506, 16.02750170600776, 8.499708582095785, -107.35747455955051, -64.64245017267001, -127.35797903066182, -18.86760827987206, -127.75538012020358, -129.1462381861683, -57.07988536712633, -204.64275283352353, -53.144250762662, -41.591473979749736, -129.03448762704124, -85.71026495650615, -19.50791854670962, -161.59134601777066, -103.36727069678406, -9.52826238778232, -2.53155176556217, -165.95801870930197, -60.53503527845898, -24.007176987629464, -127.26990336569487, -27.83232762363919, -61.55416082166036, -150.8383097966125, -105.99340646111587, -86.84870188622875, -52.16617243541123, -55.703989516164114, 7.042863561045307, -68.11507801891646, -17.970042634726457, -22.271663108559142, -150.06171792873326, -44.231994263621765, -112.89767337195761, 4.374834272910116, 3.274071883216961, -26.331810713895532, -92.96445508449531, 13.756979868852168, -86.22063800819708, -114.05825176936911, -28.735993459829334, -28.23376863574049, -68.35550157805882, -114.80866226425624, -127.4798463664059, -5.970607525054401, -21.487959388620297, -203.10404993363738, -19.31775270007536, -33.14565021296845, -23.610008311206602, -16.810482372836, -79.22515053989237, -105.08355151417739, -162.48254300352426, -66.77103137279009, -40.38932780407754, -60.27538455628319, -8.530549998539346, -29.375944809423068, 2.2066895696700426, -98.39444585371115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5226986896469916, "mean_inference_ms": 1.5963003514928755, "mean_action_processing_ms": 0.25512770071491137, "mean_env_wait_ms": 3.657536084820889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01086568832397461, "StateBufferConnector_ms": 0.007271289825439453, "ViewRequirementAgentConnector_ms": 0.17513394355773926}, "num_episodes": 60, "episode_return_max": 16.02750170600776, "episode_return_min": -210.53461706608556, "episode_return_mean": -63.35080795050001, "episodes_this_iter": 60}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.9146333703816, "num_env_steps_trained_throughput_per_sec": 407.9146333703816, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 11674.894, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11674.824, "sample_time_ms": 1335.176, "learn_time_ms": 10281.876, "learn_throughput": 389.034, "synch_weights_time_ms": 56.992}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "8adec_00000", "date": "2024-07-24_15-09-38", "timestamp": 1721813978, "time_this_iter_s": 9.815813779830933, "time_total_s": 447.4757356643677, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8c9630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 447.4757356643677, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.05714285714286, "ram_util_percent": 37.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.61099235117435, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.2395270129845206, "policy_loss": -0.007864916337712202, "vf_loss": 0.2417812563634167, "vf_explained_var": 0.999553153415521, "kl": 0.017902789317061758, "entropy": 0.2445581524943312, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 21.35925007754735, "episode_reward_min": -203.10404993363738, "episode_reward_mean": -64.72779358643149, "episode_len_mean": 62.18, "episode_media": {}, "episodes_timesteps_total": 6218, "policy_reward_min": {"policy_0": -203.10404993363738}, "policy_reward_max": {"policy_0": 21.35925007754735}, "policy_reward_mean": {"policy_0": -64.72779358643149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.11507801891646, -17.970042634726457, -22.271663108559142, -150.06171792873326, -44.231994263621765, -112.89767337195761, 4.374834272910116, 3.274071883216961, -26.331810713895532, -92.96445508449531, 13.756979868852168, -86.22063800819708, -114.05825176936911, -28.735993459829334, -28.23376863574049, -68.35550157805882, -114.80866226425624, -127.4798463664059, -5.970607525054401, -21.487959388620297, -203.10404993363738, -19.31775270007536, -33.14565021296845, -23.610008311206602, -16.810482372836, -79.22515053989237, -105.08355151417739, -162.48254300352426, -66.77103137279009, -40.38932780407754, -60.27538455628319, -8.530549998539346, -29.375944809423068, 2.2066895696700426, -98.39444585371115, -21.101772703251413, -178.46187421323634, -101.87597141034672, -66.71760861081601, -32.26885407455374, -73.19584708033992, -120.42775765656035, -95.77856898791299, -98.83098631416036, -118.57324265684802, -42.91197535268263, -3.093082704885268, -33.1691144012131, -112.29686742433385, -106.00511775156049, -3.497819635860413, 21.35925007754735, -87.64666213121112, -12.297174750182265, -42.89460263871596, -82.17792084480959, -140.61031693324097, -66.04625660367827, -135.7106991984442, -41.3222351403719, -50.08555904295683, -15.472792024010674, -75.54364662093342, -82.82619973758203, -32.28978699804012, -125.56960640754524, -56.95052783003206, -34.420351556194085, -76.92151798603163, -163.52998911663275, -55.34326716229302, -27.98483101239761, 18.31204908654684, -66.05144258529062, -130.1801837132758, -28.551124861299467, -156.67781903439493, -43.05907617340926, -121.04984234187042, -72.99379842616119, -62.626569906602604, -69.93905991886174, -15.695830517232178, -27.89472588006329, -200.57261505826264, 14.805340457525233, -50.365462699887495, -83.49410278416678, -104.69324239641686, 1.0821888906514012, -57.93297560733171, -144.944037236958, -86.52338991119659, -108.3463131116713, -34.67196384230335, -40.192138928406244, -69.625474583819, -51.675248252877616, 2.534821894626842, -36.16720505549377], "episode_lengths": [60, 50, 51, 84, 53, 74, 39, 46, 56, 68, 29, 69, 73, 59, 60, 68, 75, 76, 42, 45, 94, 49, 51, 45, 56, 64, 73, 87, 62, 54, 59, 40, 52, 35, 72, 59, 92, 70, 66, 57, 68, 76, 70, 77, 74, 60, 43, 58, 74, 73, 43, 33, 71, 52, 60, 68, 80, 62, 82, 60, 54, 53, 66, 70, 58, 80, 63, 50, 80, 85, 64, 59, 31, 72, 78, 48, 86, 57, 78, 67, 67, 73, 51, 49, 94, 29, 61, 69, 75, 40, 57, 84, 67, 74, 59, 56, 61, 55, 44, 56], "policy_policy_0_reward": [-68.11507801891646, -17.970042634726457, -22.271663108559142, -150.06171792873326, -44.231994263621765, -112.89767337195761, 4.374834272910116, 3.274071883216961, -26.331810713895532, -92.96445508449531, 13.756979868852168, -86.22063800819708, -114.05825176936911, -28.735993459829334, -28.23376863574049, -68.35550157805882, -114.80866226425624, -127.4798463664059, -5.970607525054401, -21.487959388620297, -203.10404993363738, -19.31775270007536, -33.14565021296845, -23.610008311206602, -16.810482372836, -79.22515053989237, -105.08355151417739, -162.48254300352426, -66.77103137279009, -40.38932780407754, -60.27538455628319, -8.530549998539346, -29.375944809423068, 2.2066895696700426, -98.39444585371115, -21.101772703251413, -178.46187421323634, -101.87597141034672, -66.71760861081601, -32.26885407455374, -73.19584708033992, -120.42775765656035, -95.77856898791299, -98.83098631416036, -118.57324265684802, -42.91197535268263, -3.093082704885268, -33.1691144012131, -112.29686742433385, -106.00511775156049, -3.497819635860413, 21.35925007754735, -87.64666213121112, -12.297174750182265, -42.89460263871596, -82.17792084480959, -140.61031693324097, -66.04625660367827, -135.7106991984442, -41.3222351403719, -50.08555904295683, -15.472792024010674, -75.54364662093342, -82.82619973758203, -32.28978699804012, -125.56960640754524, -56.95052783003206, -34.420351556194085, -76.92151798603163, -163.52998911663275, -55.34326716229302, -27.98483101239761, 18.31204908654684, -66.05144258529062, -130.1801837132758, -28.551124861299467, -156.67781903439493, -43.05907617340926, -121.04984234187042, -72.99379842616119, -62.626569906602604, -69.93905991886174, -15.695830517232178, -27.89472588006329, -200.57261505826264, 14.805340457525233, -50.365462699887495, -83.49410278416678, -104.69324239641686, 1.0821888906514012, -57.93297560733171, -144.944037236958, -86.52338991119659, -108.3463131116713, -34.67196384230335, -40.192138928406244, -69.625474583819, -51.675248252877616, 2.534821894626842, -36.16720505549377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5223249994051515, "mean_inference_ms": 1.5932025503177478, "mean_action_processing_ms": 0.2547852643553721, "mean_env_wait_ms": 3.6551171683864805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01065516471862793, "StateBufferConnector_ms": 0.0072727203369140625, "ViewRequirementAgentConnector_ms": 0.17411565780639648}, "num_episodes": 65, "episode_return_max": 21.35925007754735, "episode_return_min": -203.10404993363738, "episode_return_mean": -64.72779358643149, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.98507948395905, "num_env_steps_trained_throughput_per_sec": 356.98507948395905, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 11512.255, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11512.183, "sample_time_ms": 1335.427, "learn_time_ms": 10120.772, "learn_throughput": 395.227, "synch_weights_time_ms": 55.212}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "8adec_00000", "date": "2024-07-24_15-09-49", "timestamp": 1721813989, "time_this_iter_s": 11.215404510498047, "time_total_s": 458.6911401748657, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 458.6911401748657, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 21.375, "ram_util_percent": 37.83125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.0441671381394, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.2695534393632746, "policy_loss": -0.00739067664447551, "vf_loss": 0.2711711262197544, "vf_explained_var": 0.9995490614324808, "kl": 0.017842408637807262, "entropy": 0.2256094427391266, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 19.264663039944907, "episode_reward_min": -200.57261505826264, "episode_reward_mean": -60.437729222399874, "episode_len_mean": 60.68, "episode_media": {}, "episodes_timesteps_total": 6068, "policy_reward_min": {"policy_0": -200.57261505826264}, "policy_reward_max": {"policy_0": 19.264663039944907}, "policy_reward_mean": {"policy_0": -60.437729222399874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.82619973758203, -32.28978699804012, -125.56960640754524, -56.95052783003206, -34.420351556194085, -76.92151798603163, -163.52998911663275, -55.34326716229302, -27.98483101239761, 18.31204908654684, -66.05144258529062, -130.1801837132758, -28.551124861299467, -156.67781903439493, -43.05907617340926, -121.04984234187042, -72.99379842616119, -62.626569906602604, -69.93905991886174, -15.695830517232178, -27.89472588006329, -200.57261505826264, 14.805340457525233, -50.365462699887495, -83.49410278416678, -104.69324239641686, 1.0821888906514012, -57.93297560733171, -144.944037236958, -86.52338991119659, -108.3463131116713, -34.67196384230335, -40.192138928406244, -69.625474583819, -51.675248252877616, 2.534821894626842, -36.16720505549377, -37.20054480002895, -45.51113747178097, -13.451062074254494, -55.53262354004506, -46.31080833034163, -71.74471654476083, -12.425066387779198, -17.40379331342549, -168.74094862096524, -18.423796322827034, -157.49194556054772, -42.44980812399182, -61.95298606410408, -11.584707519783695, -50.490914657095615, -149.5100710038039, -38.23718418993124, -22.3380991026187, -29.68786420714989, -155.2621697020402, -59.53856180858866, -2.7754918366049646, -20.57974988192607, -32.12330058861697, 10.843897957124453, -120.5946699948654, -92.08387718408791, -20.709590984215165, -31.338582033826505, -96.01447195763375, -79.33309307347106, -36.33159762861441, -181.47684989548682, 7.001731930202595, -58.82866029915751, -17.247326984201887, -3.46683032511389, 11.724586579580858, -13.303917482450007, 0.205987724357797, -74.22394721955455, -156.42048459872018, -162.8504062805629, -22.0310823570561, -87.03928945284834, 3.5383791400197113, -78.2194669444017, 19.264663039944907, 14.933880349368003, 1.4737323521581092, -123.08194362506659, -19.42693860238826, -64.18547951731837, 2.5038474432487146, -91.02201078611657, -31.439325168479858, -82.81266974596879, -97.98912678534091, -117.98358157119489, -187.25716866235038, -87.83967473393415, -75.29099756830426, -1.627895335597892], "episode_lengths": [70, 58, 80, 63, 50, 80, 85, 64, 59, 31, 72, 78, 48, 86, 57, 78, 67, 67, 73, 51, 49, 94, 29, 61, 69, 75, 40, 57, 84, 67, 74, 59, 56, 61, 55, 44, 56, 56, 55, 44, 63, 56, 63, 46, 54, 89, 56, 84, 59, 60, 47, 55, 86, 60, 50, 53, 83, 58, 41, 54, 61, 33, 76, 69, 49, 49, 70, 66, 55, 91, 43, 60, 42, 38, 31, 49, 45, 63, 84, 86, 45, 70, 38, 63, 29, 38, 48, 76, 44, 61, 39, 71, 56, 78, 72, 84, 92, 68, 68, 49], "policy_policy_0_reward": [-82.82619973758203, -32.28978699804012, -125.56960640754524, -56.95052783003206, -34.420351556194085, -76.92151798603163, -163.52998911663275, -55.34326716229302, -27.98483101239761, 18.31204908654684, -66.05144258529062, -130.1801837132758, -28.551124861299467, -156.67781903439493, -43.05907617340926, -121.04984234187042, -72.99379842616119, -62.626569906602604, -69.93905991886174, -15.695830517232178, -27.89472588006329, -200.57261505826264, 14.805340457525233, -50.365462699887495, -83.49410278416678, -104.69324239641686, 1.0821888906514012, -57.93297560733171, -144.944037236958, -86.52338991119659, -108.3463131116713, -34.67196384230335, -40.192138928406244, -69.625474583819, -51.675248252877616, 2.534821894626842, -36.16720505549377, -37.20054480002895, -45.51113747178097, -13.451062074254494, -55.53262354004506, -46.31080833034163, -71.74471654476083, -12.425066387779198, -17.40379331342549, -168.74094862096524, -18.423796322827034, -157.49194556054772, -42.44980812399182, -61.95298606410408, -11.584707519783695, -50.490914657095615, -149.5100710038039, -38.23718418993124, -22.3380991026187, -29.68786420714989, -155.2621697020402, -59.53856180858866, -2.7754918366049646, -20.57974988192607, -32.12330058861697, 10.843897957124453, -120.5946699948654, -92.08387718408791, -20.709590984215165, -31.338582033826505, -96.01447195763375, -79.33309307347106, -36.33159762861441, -181.47684989548682, 7.001731930202595, -58.82866029915751, -17.247326984201887, -3.46683032511389, 11.724586579580858, -13.303917482450007, 0.205987724357797, -74.22394721955455, -156.42048459872018, -162.8504062805629, -22.0310823570561, -87.03928945284834, 3.5383791400197113, -78.2194669444017, 19.264663039944907, 14.933880349368003, 1.4737323521581092, -123.08194362506659, -19.42693860238826, -64.18547951731837, 2.5038474432487146, -91.02201078611657, -31.439325168479858, -82.81266974596879, -97.98912678534091, -117.98358157119489, -187.25716866235038, -87.83967473393415, -75.29099756830426, -1.627895335597892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.524022053002749, "mean_inference_ms": 1.5928125041571284, "mean_action_processing_ms": 0.2547022933605584, "mean_env_wait_ms": 3.659723196350975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01116323471069336, "StateBufferConnector_ms": 0.007366180419921875, "ViewRequirementAgentConnector_ms": 0.1864166259765625}, "num_episodes": 63, "episode_return_max": 19.264663039944907, "episode_return_min": -200.57261505826264, "episode_return_mean": -60.437729222399874, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.50906521070635, "num_env_steps_trained_throughput_per_sec": 386.50906521070635, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 11301.778, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11301.705, "sample_time_ms": 1345.428, "learn_time_ms": 9901.847, "learn_throughput": 403.965, "synch_weights_time_ms": 53.655}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "8adec_00000", "date": "2024-07-24_15-09-59", "timestamp": 1721813999, "time_this_iter_s": 10.36160397529602, "time_total_s": 469.05274415016174, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc66b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 469.05274415016174, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 21.67333333333333, "ram_util_percent": 37.813333333333325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.2566069940726, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.25149331905680206, "policy_loss": -0.00847526881795299, "vf_loss": 0.2532264751382172, "vf_explained_var": 0.9995489975437521, "kl": 0.01828010844971385, "entropy": 0.14839367285506644, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": 19.264663039944907, "episode_reward_min": -211.49748740917167, "episode_reward_mean": -64.12326235870408, "episode_len_mean": 61.38, "episode_media": {}, "episodes_timesteps_total": 6138, "policy_reward_min": {"policy_0": -211.49748740917167}, "policy_reward_max": {"policy_0": 19.264663039944907}, "policy_reward_mean": {"policy_0": -64.12326235870408}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.338582033826505, -96.01447195763375, -79.33309307347106, -36.33159762861441, -181.47684989548682, 7.001731930202595, -58.82866029915751, -17.247326984201887, -3.46683032511389, 11.724586579580858, -13.303917482450007, 0.205987724357797, -74.22394721955455, -156.42048459872018, -162.8504062805629, -22.0310823570561, -87.03928945284834, 3.5383791400197113, -78.2194669444017, 19.264663039944907, 14.933880349368003, 1.4737323521581092, -123.08194362506659, -19.42693860238826, -64.18547951731837, 2.5038474432487146, -91.02201078611657, -31.439325168479858, -82.81266974596879, -97.98912678534091, -117.98358157119489, -187.25716866235038, -87.83967473393415, -75.29099756830426, -1.627895335597892, -19.74678163563106, 17.6558089306141, -2.000215233763487, -6.648343262390394, 1.2079695973604376, -206.9079453535487, -67.89153792316728, -85.51366662721121, -24.38634415971125, -20.94495191968066, -36.174449519719104, -78.40165912823171, -174.31546668300038, -35.45403843306022, -93.15439922026697, -128.34456658639039, -105.94642512041294, -75.59767557880404, -23.948991501648983, -172.9599860916519, -0.919319893479198, 12.248229464676605, 4.126008974988373, -103.18709914425682, -22.807603947658578, -55.8596785118839, -59.21546726387247, -42.82688598501195, 11.800078582918921, 2.9619882212851474, -60.690584048761416, -159.55037636659125, -62.64991210738181, -145.30221162003056, -172.70138064978855, -3.460747298665602, -30.236397868710842, -37.25081119303399, -150.14642126132787, -20.42347374639634, -47.733133786274884, -46.03628476311732, -79.29595645220222, -14.954153718257297, -139.1921836697563, -93.8896538592865, -92.85927736219308, -53.43551707480059, -100.66955955687362, -41.67998636752035, -41.99810700081121, -37.5061158500765, 9.30088447723106, -91.97456318615758, -129.9622436747718, -211.49748740917167, -71.29868735385811, -51.3295263646758, -73.75258072072573, -115.04100084085164, -74.41845562351317, -85.05663799598939, -50.22446654161171, -54.68298778513466, -170.13681220043048], "episode_lengths": [49, 70, 66, 55, 91, 43, 60, 42, 38, 31, 49, 45, 63, 84, 86, 45, 70, 38, 63, 29, 38, 48, 76, 44, 61, 39, 71, 56, 78, 72, 84, 92, 68, 68, 49, 48, 27, 46, 45, 37, 97, 60, 67, 53, 50, 51, 81, 89, 56, 68, 78, 70, 63, 56, 87, 38, 33, 40, 76, 49, 64, 63, 54, 40, 40, 59, 83, 65, 81, 87, 40, 49, 59, 86, 56, 61, 56, 68, 53, 82, 71, 75, 62, 83, 52, 52, 55, 41, 72, 78, 96, 67, 61, 73, 75, 67, 71, 60, 65, 90], "policy_policy_0_reward": [-31.338582033826505, -96.01447195763375, -79.33309307347106, -36.33159762861441, -181.47684989548682, 7.001731930202595, -58.82866029915751, -17.247326984201887, -3.46683032511389, 11.724586579580858, -13.303917482450007, 0.205987724357797, -74.22394721955455, -156.42048459872018, -162.8504062805629, -22.0310823570561, -87.03928945284834, 3.5383791400197113, -78.2194669444017, 19.264663039944907, 14.933880349368003, 1.4737323521581092, -123.08194362506659, -19.42693860238826, -64.18547951731837, 2.5038474432487146, -91.02201078611657, -31.439325168479858, -82.81266974596879, -97.98912678534091, -117.98358157119489, -187.25716866235038, -87.83967473393415, -75.29099756830426, -1.627895335597892, -19.74678163563106, 17.6558089306141, -2.000215233763487, -6.648343262390394, 1.2079695973604376, -206.9079453535487, -67.89153792316728, -85.51366662721121, -24.38634415971125, -20.94495191968066, -36.174449519719104, -78.40165912823171, -174.31546668300038, -35.45403843306022, -93.15439922026697, -128.34456658639039, -105.94642512041294, -75.59767557880404, -23.948991501648983, -172.9599860916519, -0.919319893479198, 12.248229464676605, 4.126008974988373, -103.18709914425682, -22.807603947658578, -55.8596785118839, -59.21546726387247, -42.82688598501195, 11.800078582918921, 2.9619882212851474, -60.690584048761416, -159.55037636659125, -62.64991210738181, -145.30221162003056, -172.70138064978855, -3.460747298665602, -30.236397868710842, -37.25081119303399, -150.14642126132787, -20.42347374639634, -47.733133786274884, -46.03628476311732, -79.29595645220222, -14.954153718257297, -139.1921836697563, -93.8896538592865, -92.85927736219308, -53.43551707480059, -100.66955955687362, -41.67998636752035, -41.99810700081121, -37.5061158500765, 9.30088447723106, -91.97456318615758, -129.9622436747718, -211.49748740917167, -71.29868735385811, -51.3295263646758, -73.75258072072573, -115.04100084085164, -74.41845562351317, -85.05663799598939, -50.22446654161171, -54.68298778513466, -170.13681220043048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5238724207646722, "mean_inference_ms": 1.5911308124302357, "mean_action_processing_ms": 0.25459579153038997, "mean_env_wait_ms": 3.6635423601164727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01181650161743164, "StateBufferConnector_ms": 0.007462501525878906, "ViewRequirementAgentConnector_ms": 0.17884302139282227}, "num_episodes": 65, "episode_return_max": 19.264663039944907, "episode_return_min": -211.49748740917167, "episode_return_mean": -64.12326235870408, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.4583758426073, "num_env_steps_trained_throughput_per_sec": 347.4583758426073, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 11245.753, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11245.678, "sample_time_ms": 1343.458, "learn_time_ms": 9846.913, "learn_throughput": 406.219, "synch_weights_time_ms": 54.49}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "8adec_00000", "date": "2024-07-24_15-10-11", "timestamp": 1721814011, "time_this_iter_s": 11.523307085037231, "time_total_s": 480.576051235199, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf2710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 480.576051235199, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 19.5875, "ram_util_percent": 37.824999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.80660982628663, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.22265266514150425, "policy_loss": -0.005024361547354298, "vf_loss": 0.21872147208390136, "vf_explained_var": 0.9995578880732258, "kl": 0.023175474438782356, "entropy": 0.14734084685721124, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 17.921295430349705, "episode_reward_min": -224.5841336818119, "episode_reward_mean": -64.76742655505242, "episode_len_mean": 61.92, "episode_media": {}, "episodes_timesteps_total": 6192, "policy_reward_min": {"policy_0": -224.5841336818119}, "policy_reward_max": {"policy_0": 17.921295430349705}, "policy_reward_mean": {"policy_0": -64.76742655505242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.64991210738181, -145.30221162003056, -172.70138064978855, -3.460747298665602, -30.236397868710842, -37.25081119303399, -150.14642126132787, -20.42347374639634, -47.733133786274884, -46.03628476311732, -79.29595645220222, -14.954153718257297, -139.1921836697563, -93.8896538592865, -92.85927736219308, -53.43551707480059, -100.66955955687362, -41.67998636752035, -41.99810700081121, -37.5061158500765, 9.30088447723106, -91.97456318615758, -129.9622436747718, -211.49748740917167, -71.29868735385811, -51.3295263646758, -73.75258072072573, -115.04100084085164, -74.41845562351317, -85.05663799598939, -50.22446654161171, -54.68298778513466, -170.13681220043048, -106.84727191931641, 15.49907947958253, 13.085004801632047, -105.77324707878182, -208.81363756583409, -109.45571033606365, -38.52443944834979, -156.43550922318923, -100.77886888241736, -0.5266737045359968, 1.1523392509486716, 12.801782823225539, -62.36389700867896, -11.6226879096484, -35.28285488649389, -23.86652083245048, 13.447151414303523, -113.40950530476637, 1.7049847005485763, -133.59422552816022, -10.592502510393349, -46.68940653613164, -23.237449029195215, 7.448742439509739, 5.765496059517969, 15.520019111687526, -139.15905393291322, 5.651919304923365, -34.86897584972784, -129.54291631940305, 17.921295430349705, -4.360905403545875, -40.99072952136457, -10.197656562859107, -74.31635473072903, -9.774034914059957, -25.646123591507976, -119.1670255535008, -90.70118874793984, -102.87832004141015, -43.08326139503819, -93.26338434249898, -123.48738634441321, -29.056793776984815, -109.09108437869945, -12.826328878250445, -124.17932448874807, 14.379759496663613, -4.066641129357479, 13.623268055136107, -76.3277458193054, -125.36818193662567, -87.40937766639605, -139.43546416270124, 14.587270579367871, -5.233484492377007, -166.2808744448576, -27.545153450774432, -224.5841336818119, -161.50025838996, -19.417622655096356, -189.8024434440667, -38.971801733829906, -6.624392722662514, -35.98524611263955, -54.68014388557265, -80.19669582043798], "episode_lengths": [65, 81, 87, 40, 49, 59, 86, 56, 61, 56, 68, 53, 82, 71, 75, 62, 83, 52, 52, 55, 41, 72, 78, 96, 67, 61, 73, 75, 67, 71, 60, 65, 90, 81, 28, 36, 71, 95, 78, 57, 83, 72, 49, 41, 33, 61, 51, 51, 51, 32, 74, 40, 79, 45, 59, 54, 44, 40, 36, 85, 45, 51, 77, 27, 48, 52, 45, 64, 41, 58, 82, 73, 74, 61, 72, 79, 58, 72, 47, 77, 32, 39, 40, 65, 84, 68, 80, 38, 49, 87, 56, 100, 84, 56, 89, 52, 50, 54, 62, 69], "policy_policy_0_reward": [-62.64991210738181, -145.30221162003056, -172.70138064978855, -3.460747298665602, -30.236397868710842, -37.25081119303399, -150.14642126132787, -20.42347374639634, -47.733133786274884, -46.03628476311732, -79.29595645220222, -14.954153718257297, -139.1921836697563, -93.8896538592865, -92.85927736219308, -53.43551707480059, -100.66955955687362, -41.67998636752035, -41.99810700081121, -37.5061158500765, 9.30088447723106, -91.97456318615758, -129.9622436747718, -211.49748740917167, -71.29868735385811, -51.3295263646758, -73.75258072072573, -115.04100084085164, -74.41845562351317, -85.05663799598939, -50.22446654161171, -54.68298778513466, -170.13681220043048, -106.84727191931641, 15.49907947958253, 13.085004801632047, -105.77324707878182, -208.81363756583409, -109.45571033606365, -38.52443944834979, -156.43550922318923, -100.77886888241736, -0.5266737045359968, 1.1523392509486716, 12.801782823225539, -62.36389700867896, -11.6226879096484, -35.28285488649389, -23.86652083245048, 13.447151414303523, -113.40950530476637, 1.7049847005485763, -133.59422552816022, -10.592502510393349, -46.68940653613164, -23.237449029195215, 7.448742439509739, 5.765496059517969, 15.520019111687526, -139.15905393291322, 5.651919304923365, -34.86897584972784, -129.54291631940305, 17.921295430349705, -4.360905403545875, -40.99072952136457, -10.197656562859107, -74.31635473072903, -9.774034914059957, -25.646123591507976, -119.1670255535008, -90.70118874793984, -102.87832004141015, -43.08326139503819, -93.26338434249898, -123.48738634441321, -29.056793776984815, -109.09108437869945, -12.826328878250445, -124.17932448874807, 14.379759496663613, -4.066641129357479, 13.623268055136107, -76.3277458193054, -125.36818193662567, -87.40937766639605, -139.43546416270124, 14.587270579367871, -5.233484492377007, -166.2808744448576, -27.545153450774432, -224.5841336818119, -161.50025838996, -19.417622655096356, -189.8024434440667, -38.971801733829906, -6.624392722662514, -35.98524611263955, -54.68014388557265, -80.19669582043798]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5243771430738379, "mean_inference_ms": 1.5910550483987844, "mean_action_processing_ms": 0.25469124248597974, "mean_env_wait_ms": 3.6688772249652697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011472940444946289, "StateBufferConnector_ms": 0.007452726364135742, "ViewRequirementAgentConnector_ms": 0.18022918701171875}, "num_episodes": 67, "episode_return_max": 17.921295430349705, "episode_return_min": -224.5841336818119, "episode_return_mean": -64.76742655505242, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.63075402926995, "num_env_steps_trained_throughput_per_sec": 352.63075402926995, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 11072.283, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11072.201, "sample_time_ms": 1366.449, "learn_time_ms": 9651.385, "learn_throughput": 414.448, "synch_weights_time_ms": 53.554}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "8adec_00000", "date": "2024-07-24_15-10-22", "timestamp": 1721814022, "time_this_iter_s": 11.354958295822144, "time_total_s": 491.9310095310211, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bbf2200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 491.9310095310211, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 21.225, "ram_util_percent": 37.86875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.10285394837459, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.24004976294333272, "policy_loss": -0.009400349034694954, "vf_loss": 0.24128110949726153, "vf_explained_var": 0.999616493533055, "kl": 0.014286133285107432, "entropy": 0.14741384160006418, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": 17.921295430349705, "episode_reward_min": -224.8961316768225, "episode_reward_mean": -71.45888625035278, "episode_len_mean": 64.15, "episode_media": {}, "episodes_timesteps_total": 6415, "policy_reward_min": {"policy_0": -224.8961316768225}, "policy_reward_max": {"policy_0": 17.921295430349705}, "policy_reward_mean": {"policy_0": -71.45888625035278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.921295430349705, -4.360905403545875, -40.99072952136457, -10.197656562859107, -74.31635473072903, -9.774034914059957, -25.646123591507976, -119.1670255535008, -90.70118874793984, -102.87832004141015, -43.08326139503819, -93.26338434249898, -123.48738634441321, -29.056793776984815, -109.09108437869945, -12.826328878250445, -124.17932448874807, 14.379759496663613, -4.066641129357479, 13.623268055136107, -76.3277458193054, -125.36818193662567, -87.40937766639605, -139.43546416270124, 14.587270579367871, -5.233484492377007, -166.2808744448576, -27.545153450774432, -224.5841336818119, -161.50025838996, -19.417622655096356, -189.8024434440667, -38.971801733829906, -6.624392722662514, -35.98524611263955, -54.68014388557265, -80.19669582043798, 14.667669261450415, 6.025242696242612, -68.54936248348469, -20.7053158172203, -55.594590903772385, -109.85060794183373, -90.26348834554626, -106.84379567801894, -157.56044449141325, 9.703334934260788, -19.725816317014324, -79.45538619467581, -74.20322141546941, -125.51434851876247, -43.8279682751501, -39.34494978224087, -6.513102799248521, 6.458282665860624, -66.39705024024936, -155.73829116466976, -27.673522770165476, -24.003763388371524, -85.6439986280408, -131.34643762384684, -127.79313868520131, -13.514061690008376, -224.8961316768225, -4.334703654686367, -13.10011740884169, -89.87463307786966, -56.164662978455254, -142.70868523041952, 1.2072298525572274, -170.68662818655332, -90.72247287876034, -52.319855908489245, -48.90544695452507, -95.65790174274603, -168.11706710718502, -43.016393223512566, -114.74844491342164, -29.35007999989779, -117.97912551575159, -156.96210425373258, -12.65813236311453, -62.16791252276202, -74.80624631763935, -113.46646350602167, -11.377281871443701, -202.00603829555357, -79.39738261778841, -184.984920654475, -118.67823276182175, -126.30217398595386, 6.3181901597488865, -129.59078745343376, 6.270294011977426, -83.08037108153066, -152.33404243799654, -37.970604122456834, -91.5378314219782, 0.8951675935501577, -71.53052627237506], "episode_lengths": [27, 48, 52, 45, 64, 41, 58, 82, 73, 74, 61, 72, 79, 58, 72, 47, 77, 32, 39, 40, 65, 84, 68, 80, 38, 49, 87, 56, 100, 84, 56, 89, 52, 50, 54, 62, 69, 33, 37, 64, 54, 61, 82, 68, 75, 84, 37, 45, 69, 66, 81, 63, 58, 50, 42, 61, 83, 57, 55, 77, 78, 77, 50, 97, 43, 52, 70, 57, 79, 42, 88, 79, 62, 57, 62, 90, 60, 76, 56, 78, 84, 47, 66, 76, 85, 46, 92, 68, 93, 78, 76, 34, 77, 43, 65, 83, 60, 79, 46, 78], "policy_policy_0_reward": [17.921295430349705, -4.360905403545875, -40.99072952136457, -10.197656562859107, -74.31635473072903, -9.774034914059957, -25.646123591507976, -119.1670255535008, -90.70118874793984, -102.87832004141015, -43.08326139503819, -93.26338434249898, -123.48738634441321, -29.056793776984815, -109.09108437869945, -12.826328878250445, -124.17932448874807, 14.379759496663613, -4.066641129357479, 13.623268055136107, -76.3277458193054, -125.36818193662567, -87.40937766639605, -139.43546416270124, 14.587270579367871, -5.233484492377007, -166.2808744448576, -27.545153450774432, -224.5841336818119, -161.50025838996, -19.417622655096356, -189.8024434440667, -38.971801733829906, -6.624392722662514, -35.98524611263955, -54.68014388557265, -80.19669582043798, 14.667669261450415, 6.025242696242612, -68.54936248348469, -20.7053158172203, -55.594590903772385, -109.85060794183373, -90.26348834554626, -106.84379567801894, -157.56044449141325, 9.703334934260788, -19.725816317014324, -79.45538619467581, -74.20322141546941, -125.51434851876247, -43.8279682751501, -39.34494978224087, -6.513102799248521, 6.458282665860624, -66.39705024024936, -155.73829116466976, -27.673522770165476, -24.003763388371524, -85.6439986280408, -131.34643762384684, -127.79313868520131, -13.514061690008376, -224.8961316768225, -4.334703654686367, -13.10011740884169, -89.87463307786966, -56.164662978455254, -142.70868523041952, 1.2072298525572274, -170.68662818655332, -90.72247287876034, -52.319855908489245, -48.90544695452507, -95.65790174274603, -168.11706710718502, -43.016393223512566, -114.74844491342164, -29.35007999989779, -117.97912551575159, -156.96210425373258, -12.65813236311453, -62.16791252276202, -74.80624631763935, -113.46646350602167, -11.377281871443701, -202.00603829555357, -79.39738261778841, -184.984920654475, -118.67823276182175, -126.30217398595386, 6.3181901597488865, -129.59078745343376, 6.270294011977426, -83.08037108153066, -152.33404243799654, -37.970604122456834, -91.5378314219782, 0.8951675935501577, -71.53052627237506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5245328665912402, "mean_inference_ms": 1.5895426239902446, "mean_action_processing_ms": 0.2546202765317434, "mean_env_wait_ms": 3.6695023246509515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010932683944702148, "StateBufferConnector_ms": 0.007474184036254883, "ViewRequirementAgentConnector_ms": 0.1808168888092041}, "num_episodes": 63, "episode_return_max": 17.921295430349705, "episode_return_min": -224.8961316768225, "episode_return_mean": -71.45888625035278, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.5911731947843, "num_env_steps_trained_throughput_per_sec": 351.5911731947843, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 11279.636, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11279.554, "sample_time_ms": 1368.117, "learn_time_ms": 9856.721, "learn_throughput": 405.814, "synch_weights_time_ms": 53.904}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "8adec_00000", "date": "2024-07-24_15-10-34", "timestamp": 1721814034, "time_this_iter_s": 11.387108087539673, "time_total_s": 503.3181176185608, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8c8d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 503.3181176185608, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 19.58823529411765, "ram_util_percent": 37.911764705882355}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.817552491029105, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.270322710541465, "policy_loss": -0.005270194315138118, "vf_loss": 0.2664396661799401, "vf_explained_var": 0.9994737437615792, "kl": 0.015130874796629239, "entropy": 0.10601027314211629, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 18.383119421256293, "episode_reward_min": -202.00603829555357, "episode_reward_mean": -69.38682767505503, "episode_len_mean": 63.57, "episode_media": {}, "episodes_timesteps_total": 6357, "policy_reward_min": {"policy_0": -202.00603829555357}, "policy_reward_max": {"policy_0": 18.383119421256293}, "policy_reward_mean": {"policy_0": -69.38682767505503}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.87463307786966, -56.164662978455254, -142.70868523041952, 1.2072298525572274, -170.68662818655332, -90.72247287876034, -52.319855908489245, -48.90544695452507, -95.65790174274603, -168.11706710718502, -43.016393223512566, -114.74844491342164, -29.35007999989779, -117.97912551575159, -156.96210425373258, -12.65813236311453, -62.16791252276202, -74.80624631763935, -113.46646350602167, -11.377281871443701, -202.00603829555357, -79.39738261778841, -184.984920654475, -118.67823276182175, -126.30217398595386, 6.3181901597488865, -129.59078745343376, 6.270294011977426, -83.08037108153066, -152.33404243799654, -37.970604122456834, -91.5378314219782, 0.8951675935501577, -71.53052627237506, -124.10397982641464, 8.79558073710653, 10.180073393631426, 12.43062268399339, -19.20126780714518, 5.600742422821078, -133.0110705277898, 18.383119421256293, -1.5367628428273785, -31.455348383870025, 7.714391600323608, -37.9785069941029, -77.01059367571465, -44.254986406484534, -123.49187009644058, -158.0479982458392, -3.739571844832648, -80.93387970022432, -36.57323450186966, -7.935496423518366, -106.46828730348548, -77.1047700883171, -97.92520741750526, -35.8999535008592, -52.09304681493794, -60.28695878893379, 8.390420234090065, -49.22268861059706, -70.99363573821127, -127.13152906101311, -57.71489352192695, -27.74355827041363, -7.061784202671867, -9.826339678566935, 0.14319589705137892, -30.315033142420695, -71.40386439820664, -37.955021722986665, -103.37791719373861, -72.5546008576535, -42.01505750649712, -165.28185685696772, -174.68464924761133, -121.62473327325775, -28.445599837547007, -44.40481921749329, -6.223208294551451, -143.5836654847988, -148.5819050851168, -83.22082219742259, -120.64654683454778, -143.60339577083758, 6.982122272898145, 12.047417678027152, -108.39331235548447, -12.634158122912652, -156.05139822235589, 5.413368265189272, -92.77826280390138, -60.28604191338448, -69.00121963411695, -25.15048256730208, -118.81011192345635, -88.72862784655591, -127.8538511107383, -63.99487037568342], "episode_lengths": [70, 57, 79, 42, 88, 79, 62, 57, 62, 90, 60, 76, 56, 78, 84, 47, 66, 76, 85, 46, 92, 68, 93, 78, 76, 34, 77, 43, 65, 83, 60, 79, 46, 78, 83, 41, 32, 32, 53, 35, 78, 34, 50, 54, 38, 58, 67, 60, 76, 85, 48, 70, 51, 51, 72, 77, 73, 54, 58, 58, 36, 65, 78, 78, 64, 48, 46, 54, 41, 48, 69, 51, 71, 80, 53, 90, 87, 76, 49, 62, 40, 93, 81, 67, 87, 81, 36, 32, 71, 49, 84, 34, 72, 65, 62, 46, 76, 78, 77, 60], "policy_policy_0_reward": [-89.87463307786966, -56.164662978455254, -142.70868523041952, 1.2072298525572274, -170.68662818655332, -90.72247287876034, -52.319855908489245, -48.90544695452507, -95.65790174274603, -168.11706710718502, -43.016393223512566, -114.74844491342164, -29.35007999989779, -117.97912551575159, -156.96210425373258, -12.65813236311453, -62.16791252276202, -74.80624631763935, -113.46646350602167, -11.377281871443701, -202.00603829555357, -79.39738261778841, -184.984920654475, -118.67823276182175, -126.30217398595386, 6.3181901597488865, -129.59078745343376, 6.270294011977426, -83.08037108153066, -152.33404243799654, -37.970604122456834, -91.5378314219782, 0.8951675935501577, -71.53052627237506, -124.10397982641464, 8.79558073710653, 10.180073393631426, 12.43062268399339, -19.20126780714518, 5.600742422821078, -133.0110705277898, 18.383119421256293, -1.5367628428273785, -31.455348383870025, 7.714391600323608, -37.9785069941029, -77.01059367571465, -44.254986406484534, -123.49187009644058, -158.0479982458392, -3.739571844832648, -80.93387970022432, -36.57323450186966, -7.935496423518366, -106.46828730348548, -77.1047700883171, -97.92520741750526, -35.8999535008592, -52.09304681493794, -60.28695878893379, 8.390420234090065, -49.22268861059706, -70.99363573821127, -127.13152906101311, -57.71489352192695, -27.74355827041363, -7.061784202671867, -9.826339678566935, 0.14319589705137892, -30.315033142420695, -71.40386439820664, -37.955021722986665, -103.37791719373861, -72.5546008576535, -42.01505750649712, -165.28185685696772, -174.68464924761133, -121.62473327325775, -28.445599837547007, -44.40481921749329, -6.223208294551451, -143.5836654847988, -148.5819050851168, -83.22082219742259, -120.64654683454778, -143.60339577083758, 6.982122272898145, 12.047417678027152, -108.39331235548447, -12.634158122912652, -156.05139822235589, 5.413368265189272, -92.77826280390138, -60.28604191338448, -69.00121963411695, -25.15048256730208, -118.81011192345635, -88.72862784655591, -127.8538511107383, -63.99487037568342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5242481875060111, "mean_inference_ms": 1.5885837456892469, "mean_action_processing_ms": 0.2545830902190712, "mean_env_wait_ms": 3.6713530642383496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011208772659301758, "StateBufferConnector_ms": 0.007638216018676758, "ViewRequirementAgentConnector_ms": 0.18131089210510254}, "num_episodes": 66, "episode_return_max": 18.383119421256293, "episode_return_min": -202.00603829555357, "episode_return_mean": -69.38682767505503, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.10938104375396, "num_env_steps_trained_throughput_per_sec": 318.10938104375396, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 11287.655, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11287.574, "sample_time_ms": 1364.475, "learn_time_ms": 9869.507, "learn_throughput": 405.289, "synch_weights_time_ms": 52.793}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "8adec_00000", "date": "2024-07-24_15-10-46", "timestamp": 1721814046, "time_this_iter_s": 12.585878372192383, "time_total_s": 515.9039959907532, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8c8e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 515.9039959907532, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 20.54444444444444, "ram_util_percent": 37.83888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.62135625282924, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.21915884149154105, "policy_loss": -0.002575233160556915, "vf_loss": 0.21287247894021372, "vf_explained_var": 0.9996774979556601, "kl": 0.014137797486546333, "entropy": 0.06814177333192978, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 14.820675547389149, "episode_reward_min": -215.91771634443003, "episode_reward_mean": -63.22698656350983, "episode_len_mean": 61.19, "episode_media": {}, "episodes_timesteps_total": 6119, "policy_reward_min": {"policy_0": -215.91771634443003}, "policy_reward_max": {"policy_0": 14.820675547389149}, "policy_reward_mean": {"policy_0": -63.22698656350983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.061784202671867, -9.826339678566935, 0.14319589705137892, -30.315033142420695, -71.40386439820664, -37.955021722986665, -103.37791719373861, -72.5546008576535, -42.01505750649712, -165.28185685696772, -174.68464924761133, -121.62473327325775, -28.445599837547007, -44.40481921749329, -6.223208294551451, -143.5836654847988, -148.5819050851168, -83.22082219742259, -120.64654683454778, -143.60339577083758, 6.982122272898145, 12.047417678027152, -108.39331235548447, -12.634158122912652, -156.05139822235589, 5.413368265189272, -92.77826280390138, -60.28604191338448, -69.00121963411695, -25.15048256730208, -118.81011192345635, -88.72862784655591, -127.8538511107383, -63.99487037568342, -108.06686947102308, -26.474795088423747, 14.104749624763649, -28.61279685018686, -54.121104524279275, -27.70540763678113, -31.056264111070096, -188.5112357922403, -17.25550030345137, -63.5023457731757, -173.83789013392177, -19.649610576434267, -2.2771910553962806, -84.07405646056168, -205.16582243135855, -11.718118697985892, 14.820675547389149, -31.719725889636262, -138.32214364019276, -7.4600994285192295, -98.1038796391405, -31.27175169051084, 10.577609205389738, -19.010732069536843, -42.620407743967206, 1.289032057493714, -115.03661737766187, -45.53845233165793, -49.99664252839783, -120.33168955744648, -28.492735998809678, -100.99512071416592, -0.8414456108389594, -83.81002257329655, 7.871786919026413, 3.345144296255782, -15.294878840085492, -162.79566811592454, -8.472661372864147, 12.58953257920973, -82.74927681102807, -72.50903190948195, -67.7173983895523, -77.68661932074934, -16.735048100208033, -75.79178191452696, -29.71663151185268, 10.4492699497698, 13.985418582369796, -25.571401463617597, -95.74100444478054, -129.21627236386394, -174.7552091801542, -34.360343880602635, -83.03262336370837, -85.8363358536796, 13.948465838446289, -81.89207843128308, -159.75438395149624, -60.410025041440996, -27.08491066184479, -32.18818315190274, -11.528114704137918, -62.67391026254301, -215.91771634443003, -126.76130229965058], "episode_lengths": [46, 54, 41, 48, 69, 51, 71, 80, 53, 90, 87, 76, 49, 62, 40, 93, 81, 67, 87, 81, 36, 32, 71, 49, 84, 34, 72, 65, 62, 46, 76, 78, 77, 60, 80, 50, 38, 58, 58, 59, 59, 91, 50, 62, 88, 45, 42, 67, 96, 53, 31, 53, 80, 50, 80, 49, 34, 49, 55, 40, 73, 57, 65, 74, 52, 77, 40, 75, 43, 47, 48, 84, 47, 33, 81, 62, 74, 66, 42, 69, 51, 35, 32, 46, 69, 78, 88, 52, 66, 66, 40, 66, 84, 60, 53, 50, 49, 66, 96, 78], "policy_policy_0_reward": [-7.061784202671867, -9.826339678566935, 0.14319589705137892, -30.315033142420695, -71.40386439820664, -37.955021722986665, -103.37791719373861, -72.5546008576535, -42.01505750649712, -165.28185685696772, -174.68464924761133, -121.62473327325775, -28.445599837547007, -44.40481921749329, -6.223208294551451, -143.5836654847988, -148.5819050851168, -83.22082219742259, -120.64654683454778, -143.60339577083758, 6.982122272898145, 12.047417678027152, -108.39331235548447, -12.634158122912652, -156.05139822235589, 5.413368265189272, -92.77826280390138, -60.28604191338448, -69.00121963411695, -25.15048256730208, -118.81011192345635, -88.72862784655591, -127.8538511107383, -63.99487037568342, -108.06686947102308, -26.474795088423747, 14.104749624763649, -28.61279685018686, -54.121104524279275, -27.70540763678113, -31.056264111070096, -188.5112357922403, -17.25550030345137, -63.5023457731757, -173.83789013392177, -19.649610576434267, -2.2771910553962806, -84.07405646056168, -205.16582243135855, -11.718118697985892, 14.820675547389149, -31.719725889636262, -138.32214364019276, -7.4600994285192295, -98.1038796391405, -31.27175169051084, 10.577609205389738, -19.010732069536843, -42.620407743967206, 1.289032057493714, -115.03661737766187, -45.53845233165793, -49.99664252839783, -120.33168955744648, -28.492735998809678, -100.99512071416592, -0.8414456108389594, -83.81002257329655, 7.871786919026413, 3.345144296255782, -15.294878840085492, -162.79566811592454, -8.472661372864147, 12.58953257920973, -82.74927681102807, -72.50903190948195, -67.7173983895523, -77.68661932074934, -16.735048100208033, -75.79178191452696, -29.71663151185268, 10.4492699497698, 13.985418582369796, -25.571401463617597, -95.74100444478054, -129.21627236386394, -174.7552091801542, -34.360343880602635, -83.03262336370837, -85.8363358536796, 13.948465838446289, -81.89207843128308, -159.75438395149624, -60.410025041440996, -27.08491066184479, -32.18818315190274, -11.528114704137918, -62.67391026254301, -215.91771634443003, -126.76130229965058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5246615575923163, "mean_inference_ms": 1.588623109924024, "mean_action_processing_ms": 0.25475318614055303, "mean_env_wait_ms": 3.67898074897313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011189699172973633, "StateBufferConnector_ms": 0.007394075393676758, "ViewRequirementAgentConnector_ms": 0.17923974990844727}, "num_episodes": 66, "episode_return_max": 14.820675547389149, "episode_return_min": -215.91771634443003, "episode_return_mean": -63.22698656350983, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.27310056934283, "num_env_steps_trained_throughput_per_sec": 300.27310056934283, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 11766.332, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11766.25, "sample_time_ms": 1348.568, "learn_time_ms": 10363.062, "learn_throughput": 385.986, "synch_weights_time_ms": 53.816}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "8adec_00000", "date": "2024-07-24_15-11-00", "timestamp": 1721814060, "time_this_iter_s": 13.332520008087158, "time_total_s": 529.2365159988403, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8cb7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 529.2365159988403, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.45263157894737, "ram_util_percent": 37.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 61.96822931667169, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.22714771936249842, "policy_loss": -0.0035683504034144183, "vf_loss": 0.2214715021351973, "vf_explained_var": 0.9996795310328405, "kl": 0.01519380577004199, "entropy": 0.10112521817354718, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 13.985418582369796, "episode_reward_min": -215.91771634443003, "episode_reward_mean": -72.77220983871845, "episode_len_mean": 63.34, "episode_media": {}, "episodes_timesteps_total": 6334, "policy_reward_min": {"policy_0": -215.91771634443003}, "policy_reward_max": {"policy_0": 13.985418582369796}, "policy_reward_mean": {"policy_0": -72.77220983871845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.289032057493714, -115.03661737766187, -45.53845233165793, -49.99664252839783, -120.33168955744648, -28.492735998809678, -100.99512071416592, -0.8414456108389594, -83.81002257329655, 7.871786919026413, 3.345144296255782, -15.294878840085492, -162.79566811592454, -8.472661372864147, 12.58953257920973, -82.74927681102807, -72.50903190948195, -67.7173983895523, -77.68661932074934, -16.735048100208033, -75.79178191452696, -29.71663151185268, 10.4492699497698, 13.985418582369796, -25.571401463617597, -95.74100444478054, -129.21627236386394, -174.7552091801542, -34.360343880602635, -83.03262336370837, -85.8363358536796, 13.948465838446289, -81.89207843128308, -159.75438395149624, -60.410025041440996, -27.08491066184479, -32.18818315190274, -11.528114704137918, -62.67391026254301, -215.91771634443003, -126.76130229965058, -55.00838387068236, -162.1498709090476, -81.52908049039829, -192.67989137559027, 3.212816628145247, -30.652078823698382, -45.14551425070447, -202.399607297206, 3.773511038556173, -88.06624480686612, -35.978514019270975, -19.784028947921676, 3.7683714289500756, 7.087345229307738, -70.73976951325604, -148.4024531585427, -6.06255592952243, -19.88591544813905, -142.01146814341953, -196.80813282395914, -13.659472485468946, -13.660312679752026, -76.46669403148296, -19.065619104029935, -36.75883877224757, -59.69844068790178, -201.95653010107506, -77.62143049773167, -21.822077289026005, -128.14562215515267, -96.30211939799412, -15.611630971212374, -22.050547429184352, -85.12416363193256, -18.931841231409123, -73.68743418428421, -192.60492968777766, -20.083279135035134, -77.44647449152936, -184.34007956727467, -29.581807221131143, -40.96974999246916, -69.21219042688129, -74.04968688841647, -9.738840421906044, -93.90987100058086, -208.93874539816616, -106.59591590765459, -142.98602917827174, -49.6043172430359, -183.08273723077406, -135.9343791304286, -44.91067920234575, -38.719589064628465, -148.97716324516745, -206.62035770883088, 6.563382549664392, -201.7733739205048, -85.92304207043557], "episode_lengths": [40, 73, 57, 65, 74, 52, 77, 40, 75, 43, 47, 48, 84, 47, 33, 81, 62, 74, 66, 42, 69, 51, 35, 32, 46, 69, 78, 88, 52, 66, 66, 40, 66, 84, 60, 53, 50, 49, 66, 96, 78, 61, 85, 69, 92, 43, 57, 58, 96, 36, 74, 51, 45, 48, 32, 66, 83, 41, 46, 81, 93, 51, 49, 71, 47, 59, 63, 96, 65, 59, 82, 70, 42, 57, 68, 47, 66, 92, 46, 63, 89, 49, 54, 62, 63, 41, 66, 95, 74, 82, 58, 92, 85, 55, 53, 82, 97, 46, 93, 74], "policy_policy_0_reward": [1.289032057493714, -115.03661737766187, -45.53845233165793, -49.99664252839783, -120.33168955744648, -28.492735998809678, -100.99512071416592, -0.8414456108389594, -83.81002257329655, 7.871786919026413, 3.345144296255782, -15.294878840085492, -162.79566811592454, -8.472661372864147, 12.58953257920973, -82.74927681102807, -72.50903190948195, -67.7173983895523, -77.68661932074934, -16.735048100208033, -75.79178191452696, -29.71663151185268, 10.4492699497698, 13.985418582369796, -25.571401463617597, -95.74100444478054, -129.21627236386394, -174.7552091801542, -34.360343880602635, -83.03262336370837, -85.8363358536796, 13.948465838446289, -81.89207843128308, -159.75438395149624, -60.410025041440996, -27.08491066184479, -32.18818315190274, -11.528114704137918, -62.67391026254301, -215.91771634443003, -126.76130229965058, -55.00838387068236, -162.1498709090476, -81.52908049039829, -192.67989137559027, 3.212816628145247, -30.652078823698382, -45.14551425070447, -202.399607297206, 3.773511038556173, -88.06624480686612, -35.978514019270975, -19.784028947921676, 3.7683714289500756, 7.087345229307738, -70.73976951325604, -148.4024531585427, -6.06255592952243, -19.88591544813905, -142.01146814341953, -196.80813282395914, -13.659472485468946, -13.660312679752026, -76.46669403148296, -19.065619104029935, -36.75883877224757, -59.69844068790178, -201.95653010107506, -77.62143049773167, -21.822077289026005, -128.14562215515267, -96.30211939799412, -15.611630971212374, -22.050547429184352, -85.12416363193256, -18.931841231409123, -73.68743418428421, -192.60492968777766, -20.083279135035134, -77.44647449152936, -184.34007956727467, -29.581807221131143, -40.96974999246916, -69.21219042688129, -74.04968688841647, -9.738840421906044, -93.90987100058086, -208.93874539816616, -106.59591590765459, -142.98602917827174, -49.6043172430359, -183.08273723077406, -135.9343791304286, -44.91067920234575, -38.719589064628465, -148.97716324516745, -206.62035770883088, 6.563382549664392, -201.7733739205048, -85.92304207043557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247188293833764, "mean_inference_ms": 1.5866945571671733, "mean_action_processing_ms": 0.25467243791228594, "mean_env_wait_ms": 3.6762335836871056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011398077011108398, "StateBufferConnector_ms": 0.007392406463623047, "ViewRequirementAgentConnector_ms": 0.17833256721496582}, "num_episodes": 59, "episode_return_max": 13.985418582369796, "episode_return_min": -215.91771634443003, "episode_return_mean": -72.77220983871845, "episodes_this_iter": 59}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.3498445177604, "num_env_steps_trained_throughput_per_sec": 313.3498445177604, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 11719.047, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11718.967, "sample_time_ms": 1347.835, "learn_time_ms": 10316.306, "learn_throughput": 387.736, "synch_weights_time_ms": 54.018}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "8adec_00000", "date": "2024-07-24_15-11-13", "timestamp": 1721814073, "time_this_iter_s": 12.776763439178467, "time_total_s": 542.0132794380188, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc67010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 542.0132794380188, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.70555555555556, "ram_util_percent": 37.816666666666656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.46487959523996, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2820658481228747, "policy_loss": -0.0167316596431192, "vf_loss": 0.29430056126633036, "vf_explained_var": 0.9985456216459473, "kl": 0.008629699492151607, "entropy": 0.1328102765129491, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": 15.619802592890574, "episode_reward_min": -253.1562163026461, "episode_reward_mean": -81.44905729781156, "episode_len_mean": 66.71, "episode_media": {}, "episodes_timesteps_total": 6671, "policy_reward_min": {"policy_0": -253.1562163026461}, "policy_reward_max": {"policy_0": 15.619802592890574}, "policy_reward_mean": {"policy_0": -81.44905729781156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-76.46669403148296, -19.065619104029935, -36.75883877224757, -59.69844068790178, -201.95653010107506, -77.62143049773167, -21.822077289026005, -128.14562215515267, -96.30211939799412, -15.611630971212374, -22.050547429184352, -85.12416363193256, -18.931841231409123, -73.68743418428421, -192.60492968777766, -20.083279135035134, -77.44647449152936, -184.34007956727467, -29.581807221131143, -40.96974999246916, -69.21219042688129, -74.04968688841647, -9.738840421906044, -93.90987100058086, -208.93874539816616, -106.59591590765459, -142.98602917827174, -49.6043172430359, -183.08273723077406, -135.9343791304286, -44.91067920234575, -38.719589064628465, -148.97716324516745, -206.62035770883088, 6.563382549664392, -201.7733739205048, -85.92304207043557, -22.372099197980834, -86.67787335223362, -48.08558233570033, -141.3707809462061, -40.36507225350142, -75.98617034058732, 5.165492899138487, -12.864822140418976, -15.876892358403632, -22.17287421580857, -105.10826658615743, -37.01054885474714, -48.09293488959306, -28.0186425151357, -79.49451419355026, -33.5318276492467, -34.416159522722516, -46.59404078066442, -125.90080378596251, 8.020250124590717, -26.347824858835505, -57.63349366168482, -87.5814870971718, -86.8778844992135, -23.902192849680215, -70.07304021070274, -23.361531343474912, 15.619802592890574, -5.750316196209552, -187.8358833667313, -148.82917510290275, -253.1562163026461, -133.18452712631048, -22.883308297430666, -149.63947189014368, -101.19306548027458, -1.3271546389890576, -1.0533854987672238, -105.3291912017156, -179.87928919714597, -80.86835585610764, -13.147898699687309, 4.022688922803014, -82.05758956795462, -98.2559164217644, -213.33256050715482, -169.08640900783692, -9.629653097241075, -80.50781118533793, -159.95801046456882, -11.138368514598204, -204.95234655314601, -173.31691191430957, -17.12212935491758, -97.95804102386957, -141.70877616515048, -189.05588594613863, -134.02213222910603, -100.45104287878262, -54.71409088112122, -127.45552806618048, -31.038543848308485, -45.49477233040063], "episode_lengths": [71, 47, 59, 63, 96, 65, 59, 82, 70, 42, 57, 68, 47, 66, 92, 46, 63, 89, 49, 54, 62, 63, 41, 66, 95, 74, 82, 58, 92, 85, 55, 53, 82, 97, 46, 93, 74, 58, 66, 63, 81, 54, 66, 38, 50, 47, 49, 72, 61, 64, 59, 70, 53, 57, 60, 82, 43, 55, 62, 71, 79, 58, 61, 59, 35, 50, 94, 83, 93, 92, 59, 84, 72, 46, 45, 69, 90, 69, 45, 40, 66, 72, 96, 89, 50, 70, 83, 52, 96, 88, 46, 69, 83, 96, 78, 71, 63, 78, 57, 61], "policy_policy_0_reward": [-76.46669403148296, -19.065619104029935, -36.75883877224757, -59.69844068790178, -201.95653010107506, -77.62143049773167, -21.822077289026005, -128.14562215515267, -96.30211939799412, -15.611630971212374, -22.050547429184352, -85.12416363193256, -18.931841231409123, -73.68743418428421, -192.60492968777766, -20.083279135035134, -77.44647449152936, -184.34007956727467, -29.581807221131143, -40.96974999246916, -69.21219042688129, -74.04968688841647, -9.738840421906044, -93.90987100058086, -208.93874539816616, -106.59591590765459, -142.98602917827174, -49.6043172430359, -183.08273723077406, -135.9343791304286, -44.91067920234575, -38.719589064628465, -148.97716324516745, -206.62035770883088, 6.563382549664392, -201.7733739205048, -85.92304207043557, -22.372099197980834, -86.67787335223362, -48.08558233570033, -141.3707809462061, -40.36507225350142, -75.98617034058732, 5.165492899138487, -12.864822140418976, -15.876892358403632, -22.17287421580857, -105.10826658615743, -37.01054885474714, -48.09293488959306, -28.0186425151357, -79.49451419355026, -33.5318276492467, -34.416159522722516, -46.59404078066442, -125.90080378596251, 8.020250124590717, -26.347824858835505, -57.63349366168482, -87.5814870971718, -86.8778844992135, -23.902192849680215, -70.07304021070274, -23.361531343474912, 15.619802592890574, -5.750316196209552, -187.8358833667313, -148.82917510290275, -253.1562163026461, -133.18452712631048, -22.883308297430666, -149.63947189014368, -101.19306548027458, -1.3271546389890576, -1.0533854987672238, -105.3291912017156, -179.87928919714597, -80.86835585610764, -13.147898699687309, 4.022688922803014, -82.05758956795462, -98.2559164217644, -213.33256050715482, -169.08640900783692, -9.629653097241075, -80.50781118533793, -159.95801046456882, -11.138368514598204, -204.95234655314601, -173.31691191430957, -17.12212935491758, -97.95804102386957, -141.70877616515048, -189.05588594613863, -134.02213222910603, -100.45104287878262, -54.71409088112122, -127.45552806618048, -31.038543848308485, -45.49477233040063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247358215971105, "mean_inference_ms": 1.584425312213273, "mean_action_processing_ms": 0.2543311830005072, "mean_env_wait_ms": 3.676556081789018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011220455169677734, "StateBufferConnector_ms": 0.00728297233581543, "ViewRequirementAgentConnector_ms": 0.1753833293914795}, "num_episodes": 63, "episode_return_max": 15.619802592890574, "episode_return_min": -253.1562163026461, "episode_return_mean": -81.44905729781156, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4980012824781, "num_env_steps_trained_throughput_per_sec": 311.4980012824781, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 11709.44, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11709.36, "sample_time_ms": 1350.049, "learn_time_ms": 10305.528, "learn_throughput": 388.141, "synch_weights_time_ms": 52.976}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "8adec_00000", "date": "2024-07-24_15-11-26", "timestamp": 1721814086, "time_this_iter_s": 12.852902173995972, "time_total_s": 554.8661816120148, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc67250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 554.8661816120148, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 19.022222222222226, "ram_util_percent": 37.827777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.028299707671, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2186326259218428, "policy_loss": -0.0034825386930606326, "vf_loss": 0.21230368843923011, "vf_explained_var": 0.9996104031180342, "kl": 0.015354982771502062, "entropy": 0.05531373647972941, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 15.676718280847805, "episode_reward_min": -253.1562163026461, "episode_reward_mean": -74.915125659752, "episode_len_mean": 64.42, "episode_media": {}, "episodes_timesteps_total": 6442, "policy_reward_min": {"policy_0": -253.1562163026461}, "policy_reward_max": {"policy_0": 15.676718280847805}, "policy_reward_mean": {"policy_0": -74.915125659752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.619802592890574, -5.750316196209552, -187.8358833667313, -148.82917510290275, -253.1562163026461, -133.18452712631048, -22.883308297430666, -149.63947189014368, -101.19306548027458, -1.3271546389890576, -1.0533854987672238, -105.3291912017156, -179.87928919714597, -80.86835585610764, -13.147898699687309, 4.022688922803014, -82.05758956795462, -98.2559164217644, -213.33256050715482, -169.08640900783692, -9.629653097241075, -80.50781118533793, -159.95801046456882, -11.138368514598204, -204.95234655314601, -173.31691191430957, -17.12212935491758, -97.95804102386957, -141.70877616515048, -189.05588594613863, -134.02213222910603, -100.45104287878262, -54.71409088112122, -127.45552806618048, -31.038543848308485, -45.49477233040063, -101.50890382502914, -111.92344278628107, 7.955822397655516, -82.13701970143494, -112.10286163495618, -97.34722075196304, -106.15421173649277, -110.83666682003371, -37.62910032419725, -74.49266466394324, -82.94802935856848, -143.73935225809095, -75.72565202892295, -128.28363643526416, -3.498861985497666, -19.351555082037102, -40.61301564618895, 1.1535039853685116, -73.21266136473255, -70.86367675777504, 9.552182101608192, 15.676718280847805, -68.35905250308444, -57.705937642523345, -16.366595300753332, -92.28296217112552, -6.551221124712791, -41.01763051071172, -36.92019265004333, -55.34838046100092, -28.11789362266617, -53.589526839798175, 13.059162056148871, -5.303729480028041, -1.965748015255062, -56.53819426039001, -67.74423639186745, -26.73090851694123, -33.92422517041919, -124.57031924072956, -112.45169772171741, -117.44331575320908, -26.809374380023538, -69.70818429754716, -56.21806165722764, -164.70862403587205, -61.026207726402774, -57.29028329121837, -6.479307147866952, -76.48183210239586, -210.66847910033653, -70.63929127135748, -73.75097314826832, -91.12447912673692, -80.6170551162951, -91.72662307755756, -172.8994115732776, -162.32187798954683, 9.759897979334248, 14.67729500579643, 15.49184995108077, -128.44736763280704, 0.14552549434015782, 2.924477283001377], "episode_lengths": [35, 50, 94, 83, 93, 92, 59, 84, 72, 46, 45, 69, 90, 69, 45, 40, 66, 72, 96, 89, 50, 70, 83, 52, 96, 88, 46, 69, 83, 96, 78, 71, 63, 78, 57, 61, 76, 74, 38, 70, 75, 69, 73, 74, 54, 64, 68, 84, 78, 78, 42, 43, 54, 46, 67, 62, 34, 28, 63, 58, 47, 67, 45, 62, 60, 64, 52, 62, 37, 52, 48, 58, 66, 48, 49, 76, 74, 87, 60, 65, 60, 87, 67, 58, 51, 65, 98, 63, 68, 74, 67, 72, 86, 84, 31, 31, 27, 79, 47, 46], "policy_policy_0_reward": [15.619802592890574, -5.750316196209552, -187.8358833667313, -148.82917510290275, -253.1562163026461, -133.18452712631048, -22.883308297430666, -149.63947189014368, -101.19306548027458, -1.3271546389890576, -1.0533854987672238, -105.3291912017156, -179.87928919714597, -80.86835585610764, -13.147898699687309, 4.022688922803014, -82.05758956795462, -98.2559164217644, -213.33256050715482, -169.08640900783692, -9.629653097241075, -80.50781118533793, -159.95801046456882, -11.138368514598204, -204.95234655314601, -173.31691191430957, -17.12212935491758, -97.95804102386957, -141.70877616515048, -189.05588594613863, -134.02213222910603, -100.45104287878262, -54.71409088112122, -127.45552806618048, -31.038543848308485, -45.49477233040063, -101.50890382502914, -111.92344278628107, 7.955822397655516, -82.13701970143494, -112.10286163495618, -97.34722075196304, -106.15421173649277, -110.83666682003371, -37.62910032419725, -74.49266466394324, -82.94802935856848, -143.73935225809095, -75.72565202892295, -128.28363643526416, -3.498861985497666, -19.351555082037102, -40.61301564618895, 1.1535039853685116, -73.21266136473255, -70.86367675777504, 9.552182101608192, 15.676718280847805, -68.35905250308444, -57.705937642523345, -16.366595300753332, -92.28296217112552, -6.551221124712791, -41.01763051071172, -36.92019265004333, -55.34838046100092, -28.11789362266617, -53.589526839798175, 13.059162056148871, -5.303729480028041, -1.965748015255062, -56.53819426039001, -67.74423639186745, -26.73090851694123, -33.92422517041919, -124.57031924072956, -112.45169772171741, -117.44331575320908, -26.809374380023538, -69.70818429754716, -56.21806165722764, -164.70862403587205, -61.026207726402774, -57.29028329121837, -6.479307147866952, -76.48183210239586, -210.66847910033653, -70.63929127135748, -73.75097314826832, -91.12447912673692, -80.6170551162951, -91.72662307755756, -172.8994115732776, -162.32187798954683, 9.759897979334248, 14.67729500579643, 15.49184995108077, -128.44736763280704, 0.14552549434015782, 2.924477283001377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5240990756286754, "mean_inference_ms": 1.584089936084768, "mean_action_processing_ms": 0.25438621211216733, "mean_env_wait_ms": 3.6812160187687435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01128387451171875, "StateBufferConnector_ms": 0.007477998733520508, "ViewRequirementAgentConnector_ms": 0.18065786361694336}, "num_episodes": 64, "episode_return_max": 15.676718280847805, "episode_return_min": -253.1562163026461, "episode_return_mean": -74.915125659752, "episodes_this_iter": 64}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9674204511414, "num_env_steps_trained_throughput_per_sec": 307.9674204511414, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12027.682, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12027.599, "sample_time_ms": 1358.38, "learn_time_ms": 10614.01, "learn_throughput": 376.86, "synch_weights_time_ms": 54.387}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "8adec_00000", "date": "2024-07-24_15-11-39", "timestamp": 1721814099, "time_this_iter_s": 13.000209331512451, "time_total_s": 567.8663909435272, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc677f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 567.8663909435272, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.842105263157897, "ram_util_percent": 37.963157894736845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.11556255022685, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.23995737674219222, "policy_loss": -0.006654434770462103, "vf_loss": 0.2377151577655847, "vf_explained_var": 0.9995982046549519, "kl": 0.013894666012007898, "entropy": 0.0482245286097168, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": 21.884283778503264, "episode_reward_min": -210.66847910033653, "episode_reward_mean": -68.52854585756413, "episode_len_mean": 63.49, "episode_media": {}, "episodes_timesteps_total": 6349, "policy_reward_min": {"policy_0": -210.66847910033653}, "policy_reward_max": {"policy_0": 21.884283778503264}, "policy_reward_mean": {"policy_0": -68.52854585756413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.551221124712791, -41.01763051071172, -36.92019265004333, -55.34838046100092, -28.11789362266617, -53.589526839798175, 13.059162056148871, -5.303729480028041, -1.965748015255062, -56.53819426039001, -67.74423639186745, -26.73090851694123, -33.92422517041919, -124.57031924072956, -112.45169772171741, -117.44331575320908, -26.809374380023538, -69.70818429754716, -56.21806165722764, -164.70862403587205, -61.026207726402774, -57.29028329121837, -6.479307147866952, -76.48183210239586, -210.66847910033653, -70.63929127135748, -73.75097314826832, -91.12447912673692, -80.6170551162951, -91.72662307755756, -172.8994115732776, -162.32187798954683, 9.759897979334248, 14.67729500579643, 15.49184995108077, -128.44736763280704, 0.14552549434015782, 2.924477283001377, -163.73692739137, -44.754649770744585, -103.41459640040178, -21.66695963533794, -9.74312242356822, -103.49912851456047, -141.21616454474756, -67.11513654666427, -11.540859158113683, -15.412371653799877, -72.92149597819807, -153.1540666324475, -96.9679752662997, -73.25548037026593, -56.37694821144503, -21.319729453407607, -31.451202795110316, -107.44026860584842, -187.95619603718004, -20.047110227022443, -98.36714173323348, -152.91629611235072, -195.03232979433457, -124.2399018402655, 21.884283778503264, -46.15185444820958, -81.1993764906742, -12.46707241519304, -137.91699594869942, -24.799855291440352, -28.350418512799454, -153.23803942839768, -92.48225558178926, -162.34466451996923, -53.45024834170484, -89.91169217425923, -9.011747959389911, -40.40514175977003, 0.140272849394393, 0.5851308150449526, -165.21116038002282, -85.1814276365834, -7.372969029466024, 3.8272299699323575, -64.9492586170536, -73.35714603650887, 2.0221011089673437, 7.199260986194316, -17.68053707658476, -126.08931428596613, -85.46053468029476, -169.54784330243925, 0.31865931945440984, -143.00655755261837, -174.41977507273845, -68.67945282864659, -152.48355136156036, 3.374524006697399, 10.585123417311072, -60.25852829192645, -95.37458689321687, -95.36666232874532], "episode_lengths": [45, 62, 60, 64, 52, 62, 37, 52, 48, 58, 66, 48, 49, 76, 74, 87, 60, 65, 60, 87, 67, 58, 51, 65, 98, 63, 68, 74, 67, 72, 86, 84, 31, 31, 27, 79, 47, 46, 87, 63, 71, 57, 43, 80, 86, 71, 47, 44, 67, 83, 80, 67, 61, 51, 53, 72, 90, 55, 72, 85, 92, 77, 33, 62, 68, 42, 80, 49, 56, 85, 70, 84, 61, 69, 50, 52, 43, 46, 85, 67, 41, 39, 76, 70, 48, 38, 51, 85, 69, 88, 45, 82, 89, 76, 84, 44, 34, 59, 80, 69], "policy_policy_0_reward": [-6.551221124712791, -41.01763051071172, -36.92019265004333, -55.34838046100092, -28.11789362266617, -53.589526839798175, 13.059162056148871, -5.303729480028041, -1.965748015255062, -56.53819426039001, -67.74423639186745, -26.73090851694123, -33.92422517041919, -124.57031924072956, -112.45169772171741, -117.44331575320908, -26.809374380023538, -69.70818429754716, -56.21806165722764, -164.70862403587205, -61.026207726402774, -57.29028329121837, -6.479307147866952, -76.48183210239586, -210.66847910033653, -70.63929127135748, -73.75097314826832, -91.12447912673692, -80.6170551162951, -91.72662307755756, -172.8994115732776, -162.32187798954683, 9.759897979334248, 14.67729500579643, 15.49184995108077, -128.44736763280704, 0.14552549434015782, 2.924477283001377, -163.73692739137, -44.754649770744585, -103.41459640040178, -21.66695963533794, -9.74312242356822, -103.49912851456047, -141.21616454474756, -67.11513654666427, -11.540859158113683, -15.412371653799877, -72.92149597819807, -153.1540666324475, -96.9679752662997, -73.25548037026593, -56.37694821144503, -21.319729453407607, -31.451202795110316, -107.44026860584842, -187.95619603718004, -20.047110227022443, -98.36714173323348, -152.91629611235072, -195.03232979433457, -124.2399018402655, 21.884283778503264, -46.15185444820958, -81.1993764906742, -12.46707241519304, -137.91699594869942, -24.799855291440352, -28.350418512799454, -153.23803942839768, -92.48225558178926, -162.34466451996923, -53.45024834170484, -89.91169217425923, -9.011747959389911, -40.40514175977003, 0.140272849394393, 0.5851308150449526, -165.21116038002282, -85.1814276365834, -7.372969029466024, 3.8272299699323575, -64.9492586170536, -73.35714603650887, 2.0221011089673437, 7.199260986194316, -17.68053707658476, -126.08931428596613, -85.46053468029476, -169.54784330243925, 0.31865931945440984, -143.00655755261837, -174.41977507273845, -68.67945282864659, -152.48355136156036, 3.374524006697399, 10.585123417311072, -60.25852829192645, -95.37458689321687, -95.36666232874532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5243990513653716, "mean_inference_ms": 1.5841911752780633, "mean_action_processing_ms": 0.25458720931050133, "mean_env_wait_ms": 3.6857854926407434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011540889739990234, "StateBufferConnector_ms": 0.0075626373291015625, "ViewRequirementAgentConnector_ms": 0.18208646774291992}, "num_episodes": 62, "episode_return_max": 21.884283778503264, "episode_return_min": -210.66847910033653, "episode_return_mean": -68.52854585756413, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.769767181814, "num_env_steps_trained_throughput_per_sec": 314.769767181814, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12177.957, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12177.875, "sample_time_ms": 1362.175, "learn_time_ms": 10758.674, "learn_throughput": 371.793, "synch_weights_time_ms": 56.185}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "8adec_00000", "date": "2024-07-24_15-11-52", "timestamp": 1721814112, "time_this_iter_s": 12.718597173690796, "time_total_s": 580.584988117218, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 580.584988117218, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 20.433333333333334, "ram_util_percent": 37.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.63639476299286, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2821521009512556, "policy_loss": -0.007975774004201715, "vf_loss": 0.2835298866421605, "vf_explained_var": 0.9984078944350282, "kl": 0.010012147377699421, "entropy": 0.016021111999483157, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 17.34693473770433, "episode_reward_min": -221.61529519567108, "episode_reward_mean": -67.74830681729397, "episode_len_mean": 62.54, "episode_media": {}, "episodes_timesteps_total": 6254, "policy_reward_min": {"policy_0": -221.61529519567108}, "policy_reward_max": {"policy_0": 17.34693473770433}, "policy_reward_mean": {"policy_0": -67.74830681729397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-137.91699594869942, -24.799855291440352, -28.350418512799454, -153.23803942839768, -92.48225558178926, -162.34466451996923, -53.45024834170484, -89.91169217425923, -9.011747959389911, -40.40514175977003, 0.140272849394393, 0.5851308150449526, -165.21116038002282, -85.1814276365834, -7.372969029466024, 3.8272299699323575, -64.9492586170536, -73.35714603650887, 2.0221011089673437, 7.199260986194316, -17.68053707658476, -126.08931428596613, -85.46053468029476, -169.54784330243925, 0.31865931945440984, -143.00655755261837, -174.41977507273845, -68.67945282864659, -152.48355136156036, 3.374524006697399, 10.585123417311072, -60.25852829192645, -95.37458689321687, -95.36666232874532, -62.70508427656319, -63.45290046210463, 12.190164203860379, -0.15258283561095376, -7.629220900208777, -68.16002874420248, -151.70463144190313, -69.43457140605317, -73.91023410619927, -181.18427594409866, -150.4128685729614, -73.78882396876638, -78.07805671660441, -51.019898573927094, -12.22059315013543, -152.43531672148998, 2.826227142819957, -91.91230126296958, 1.0430531923474673, -171.08871574314435, 10.371070032507145, -51.96985483569031, -114.34787247865745, -84.53986832486194, -134.18874053324697, -15.738622686100769, 16.36039935780763, -16.484560827144616, -8.832598481357927, -69.92371036493809, -98.96776469937842, -151.87021019043385, -70.90244157378544, -6.989091617796898, -11.221034994061402, 17.34693473770433, -53.214907915926126, 14.700534157578721, -5.6758827439039745, -76.34554830989109, -174.3889866345203, -180.06779600532454, -107.34431971923833, -50.51043813493373, -22.489931125742146, -71.09285723004746, -21.244635708399137, -116.51737743437468, -68.21805714449697, -7.620849102579429, 6.232203977692425, 4.0589812641015754, -137.2269566242242, -68.16992597559573, -128.96862839145479, -221.61529519567108, -4.73446735022426, 11.804276229757846, -133.24051511788144, 8.398573813180082, -79.34754260074908, -172.39815925516467, -118.6709972411912, -35.91625380983417, -72.31709303640332, -109.26113917698957], "episode_lengths": [80, 49, 56, 85, 70, 84, 61, 69, 50, 52, 43, 46, 85, 67, 41, 39, 76, 70, 48, 38, 51, 85, 69, 88, 45, 82, 89, 76, 84, 44, 34, 59, 80, 69, 61, 65, 32, 36, 49, 62, 82, 62, 67, 92, 84, 65, 71, 56, 45, 82, 41, 68, 46, 89, 32, 59, 74, 78, 79, 48, 30, 44, 45, 72, 74, 98, 67, 52, 45, 35, 58, 37, 43, 67, 89, 89, 74, 57, 51, 68, 57, 75, 62, 41, 46, 38, 81, 63, 78, 99, 48, 38, 79, 36, 80, 85, 78, 50, 63, 73], "policy_policy_0_reward": [-137.91699594869942, -24.799855291440352, -28.350418512799454, -153.23803942839768, -92.48225558178926, -162.34466451996923, -53.45024834170484, -89.91169217425923, -9.011747959389911, -40.40514175977003, 0.140272849394393, 0.5851308150449526, -165.21116038002282, -85.1814276365834, -7.372969029466024, 3.8272299699323575, -64.9492586170536, -73.35714603650887, 2.0221011089673437, 7.199260986194316, -17.68053707658476, -126.08931428596613, -85.46053468029476, -169.54784330243925, 0.31865931945440984, -143.00655755261837, -174.41977507273845, -68.67945282864659, -152.48355136156036, 3.374524006697399, 10.585123417311072, -60.25852829192645, -95.37458689321687, -95.36666232874532, -62.70508427656319, -63.45290046210463, 12.190164203860379, -0.15258283561095376, -7.629220900208777, -68.16002874420248, -151.70463144190313, -69.43457140605317, -73.91023410619927, -181.18427594409866, -150.4128685729614, -73.78882396876638, -78.07805671660441, -51.019898573927094, -12.22059315013543, -152.43531672148998, 2.826227142819957, -91.91230126296958, 1.0430531923474673, -171.08871574314435, 10.371070032507145, -51.96985483569031, -114.34787247865745, -84.53986832486194, -134.18874053324697, -15.738622686100769, 16.36039935780763, -16.484560827144616, -8.832598481357927, -69.92371036493809, -98.96776469937842, -151.87021019043385, -70.90244157378544, -6.989091617796898, -11.221034994061402, 17.34693473770433, -53.214907915926126, 14.700534157578721, -5.6758827439039745, -76.34554830989109, -174.3889866345203, -180.06779600532454, -107.34431971923833, -50.51043813493373, -22.489931125742146, -71.09285723004746, -21.244635708399137, -116.51737743437468, -68.21805714449697, -7.620849102579429, 6.232203977692425, 4.0589812641015754, -137.2269566242242, -68.16992597559573, -128.96862839145479, -221.61529519567108, -4.73446735022426, 11.804276229757846, -133.24051511788144, 8.398573813180082, -79.34754260074908, -172.39815925516467, -118.6709972411912, -35.91625380983417, -72.31709303640332, -109.26113917698957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5249105106680634, "mean_inference_ms": 1.5835714067376532, "mean_action_processing_ms": 0.25459300306910615, "mean_env_wait_ms": 3.6905873300717014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011170625686645508, "StateBufferConnector_ms": 0.007906913757324219, "ViewRequirementAgentConnector_ms": 0.18086028099060059}, "num_episodes": 66, "episode_return_max": 17.34693473770433, "episode_return_min": -221.61529519567108, "episode_return_mean": -67.74830681729397, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.4429895013545, "num_env_steps_trained_throughput_per_sec": 309.4429895013545, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12435.698, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12435.614, "sample_time_ms": 1354.143, "learn_time_ms": 11023.976, "learn_throughput": 362.846, "synch_weights_time_ms": 56.65}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "8adec_00000", "date": "2024-07-24_15-12-05", "timestamp": 1721814125, "time_this_iter_s": 12.937724590301514, "time_total_s": 593.5227127075195, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 593.5227127075195, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 20.333333333333332, "ram_util_percent": 37.888888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.274167490998906, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.23093025890460314, "policy_loss": -0.008352310539824733, "vf_loss": 0.23110190107642362, "vf_explained_var": 0.9994282891352971, "kl": 0.012139699986194803, "entropy": 0.0013628736987205533, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": 17.34693473770433, "episode_reward_min": -281.7928715907429, "episode_reward_mean": -65.64746767972167, "episode_len_mean": 62.5, "episode_media": {}, "episodes_timesteps_total": 6250, "policy_reward_min": {"policy_0": -281.7928715907429}, "policy_reward_max": {"policy_0": 17.34693473770433}, "policy_reward_mean": {"policy_0": -65.64746767972167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.832598481357927, -69.92371036493809, -98.96776469937842, -151.87021019043385, -70.90244157378544, -6.989091617796898, -11.221034994061402, 17.34693473770433, -53.214907915926126, 14.700534157578721, -5.6758827439039745, -76.34554830989109, -174.3889866345203, -180.06779600532454, -107.34431971923833, -50.51043813493373, -22.489931125742146, -71.09285723004746, -21.244635708399137, -116.51737743437468, -68.21805714449697, -7.620849102579429, 6.232203977692425, 4.0589812641015754, -137.2269566242242, -68.16992597559573, -128.96862839145479, -221.61529519567108, -4.73446735022426, 11.804276229757846, -133.24051511788144, 8.398573813180082, -79.34754260074908, -172.39815925516467, -118.6709972411912, -35.91625380983417, -72.31709303640332, -109.26113917698957, 7.0492134881155595, -95.1400338425357, -35.35029618296881, -79.75251946432307, -2.503213336665318, 14.626911274719847, -1.1980233185091322, -131.4526166612094, -13.515220213359205, -20.599393574644097, -28.416968974935806, -177.4357615239818, -49.924594322633666, -91.53359403368592, 13.341140118774886, 4.045511238646373, -26.046073750205107, -42.922524380686426, 3.198133722435114, -82.19975834663649, -146.27189369101595, -43.431564761172204, -155.50273088152278, -55.33569547855339, -34.44153121505397, -89.52709541772397, -38.773282452993094, -39.66021223440623, 1.0559464728888786, 6.8652957370926915, -126.61722050574092, -31.176664661970673, 1.1704771159763314, -87.16646483512345, 16.555594323338862, -70.78062171170441, -281.7928715907429, -12.63338372290991, -22.077446307225117, -83.50935947021266, -139.81500335801684, -26.419956427337993, -176.7737987292612, -87.60368511775549, -87.44882503168841, -70.71187566500763, -123.92386429106702, -85.36823481845657, -175.0598372102812, 13.522948041983122, -174.45034483361047, -49.47628343707131, -49.874435441441015, -50.53316038107886, -26.34086595008033, -28.246269385428764, -31.84572534180598, -125.87483612486638, -62.23052511629582, -168.04316128941338, -88.09473640278897, -28.589975561833498], "episode_lengths": [45, 72, 74, 98, 67, 52, 45, 35, 58, 37, 43, 67, 89, 89, 74, 57, 51, 68, 57, 75, 62, 41, 46, 38, 81, 63, 78, 99, 48, 38, 79, 36, 80, 85, 78, 50, 63, 73, 41, 73, 55, 79, 51, 33, 44, 80, 56, 56, 60, 87, 55, 84, 31, 44, 58, 60, 38, 71, 81, 60, 85, 57, 58, 65, 54, 62, 44, 38, 78, 52, 39, 69, 36, 67, 106, 48, 51, 68, 80, 46, 88, 68, 79, 70, 77, 68, 90, 34, 90, 58, 58, 64, 57, 50, 58, 76, 66, 88, 69, 51], "policy_policy_0_reward": [-8.832598481357927, -69.92371036493809, -98.96776469937842, -151.87021019043385, -70.90244157378544, -6.989091617796898, -11.221034994061402, 17.34693473770433, -53.214907915926126, 14.700534157578721, -5.6758827439039745, -76.34554830989109, -174.3889866345203, -180.06779600532454, -107.34431971923833, -50.51043813493373, -22.489931125742146, -71.09285723004746, -21.244635708399137, -116.51737743437468, -68.21805714449697, -7.620849102579429, 6.232203977692425, 4.0589812641015754, -137.2269566242242, -68.16992597559573, -128.96862839145479, -221.61529519567108, -4.73446735022426, 11.804276229757846, -133.24051511788144, 8.398573813180082, -79.34754260074908, -172.39815925516467, -118.6709972411912, -35.91625380983417, -72.31709303640332, -109.26113917698957, 7.0492134881155595, -95.1400338425357, -35.35029618296881, -79.75251946432307, -2.503213336665318, 14.626911274719847, -1.1980233185091322, -131.4526166612094, -13.515220213359205, -20.599393574644097, -28.416968974935806, -177.4357615239818, -49.924594322633666, -91.53359403368592, 13.341140118774886, 4.045511238646373, -26.046073750205107, -42.922524380686426, 3.198133722435114, -82.19975834663649, -146.27189369101595, -43.431564761172204, -155.50273088152278, -55.33569547855339, -34.44153121505397, -89.52709541772397, -38.773282452993094, -39.66021223440623, 1.0559464728888786, 6.8652957370926915, -126.61722050574092, -31.176664661970673, 1.1704771159763314, -87.16646483512345, 16.555594323338862, -70.78062171170441, -281.7928715907429, -12.63338372290991, -22.077446307225117, -83.50935947021266, -139.81500335801684, -26.419956427337993, -176.7737987292612, -87.60368511775549, -87.44882503168841, -70.71187566500763, -123.92386429106702, -85.36823481845657, -175.0598372102812, 13.522948041983122, -174.45034483361047, -49.47628343707131, -49.874435441441015, -50.53316038107886, -26.34086595008033, -28.246269385428764, -31.84572534180598, -125.87483612486638, -62.23052511629582, -168.04316128941338, -88.09473640278897, -28.589975561833498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.524976270859732, "mean_inference_ms": 1.582607279922314, "mean_action_processing_ms": 0.25453610754212963, "mean_env_wait_ms": 3.6914441324896425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011121749877929688, "StateBufferConnector_ms": 0.007490396499633789, "ViewRequirementAgentConnector_ms": 0.17955303192138672}, "num_episodes": 62, "episode_return_max": 17.34693473770433, "episode_return_min": -281.7928715907429, "episode_return_mean": -65.64746767972167, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.02039296847, "num_env_steps_trained_throughput_per_sec": 313.02039296847, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 12562.353, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12562.27, "sample_time_ms": 1360.567, "learn_time_ms": 11143.633, "learn_throughput": 358.949, "synch_weights_time_ms": 57.255}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "8adec_00000", "date": "2024-07-24_15-12-17", "timestamp": 1721814137, "time_this_iter_s": 12.790421485900879, "time_total_s": 606.3131341934204, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8cbeb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 606.3131341934204, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 21.077777777777776, "ram_util_percent": 37.90555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.0875515371561, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.19139575329293923, "policy_loss": 0.0007093235501088202, "vf_loss": 0.17782456977292896, "vf_explained_var": 0.9997012226531903, "kl": 0.018142707226130976, "entropy": -0.061553269380237904, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 19.84236067069337, "episode_reward_min": -281.7928715907429, "episode_reward_mean": -64.59328797324791, "episode_len_mean": 62.11, "episode_media": {}, "episodes_timesteps_total": 6211, "policy_reward_min": {"policy_0": -281.7928715907429}, "policy_reward_max": {"policy_0": 19.84236067069337}, "policy_reward_mean": {"policy_0": -64.59328797324791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.52709541772397, -38.773282452993094, -39.66021223440623, 1.0559464728888786, 6.8652957370926915, -126.61722050574092, -31.176664661970673, 1.1704771159763314, -87.16646483512345, 16.555594323338862, -70.78062171170441, -281.7928715907429, -12.63338372290991, -22.077446307225117, -83.50935947021266, -139.81500335801684, -26.419956427337993, -176.7737987292612, -87.60368511775549, -87.44882503168841, -70.71187566500763, -123.92386429106702, -85.36823481845657, -175.0598372102812, 13.522948041983122, -174.45034483361047, -49.47628343707131, -49.874435441441015, -50.53316038107886, -26.34086595008033, -28.246269385428764, -31.84572534180598, -125.87483612486638, -62.23052511629582, -168.04316128941338, -88.09473640278897, -28.589975561833498, -181.0543349871693, -59.74383558356476, 6.157495599391175, -54.358110150086375, 7.52919644455064, -136.3091196442461, -85.09435382983166, 1.3680410851514733, -78.95046066121388, -75.93187861416756, -103.67390136304402, -9.489083962937013, -36.668471278853076, -10.118118257801045, -3.994195897188154, -80.06340745214013, -72.05669366427762, -68.98179258887997, -10.165508660249891, -79.84818422661336, -63.47221951984428, -31.33998030862657, -31.6378752108363, 8.597565664571082, -82.5670192520411, -106.04991336177544, -34.3441538222651, -127.25471068886968, -88.56033801556102, -80.04122979801815, -51.970974079351066, 0.4799991166490183, -33.703741017414075, -105.57012852305762, -15.935825034091067, -64.70410412290646, -78.40789796243727, -1.8704827361072536, -115.88875425737501, -102.8323679395784, -0.3468282511351084, -68.82795636890455, -127.14239550895043, -51.31209124727886, -48.309111146059884, -73.43948787872671, -12.04344958002171, -85.35856999677857, -88.57063425504923, -100.73132326193061, -72.34244946448064, 19.84236067069337, -3.451672223821044, 6.3975925859722675, -10.516948504544665, -57.008892874798654, 6.6265873718697135, -20.53221207970791, -148.4498975954488, -143.69417596354918, -144.33090272280083, -194.34399867409198, -1.6517106590800554], "episode_lengths": [65, 54, 62, 44, 38, 78, 52, 39, 69, 36, 67, 106, 48, 51, 68, 80, 46, 88, 68, 79, 70, 77, 68, 90, 34, 90, 58, 58, 64, 57, 50, 58, 76, 66, 88, 69, 51, 89, 64, 40, 66, 36, 80, 69, 41, 79, 64, 73, 51, 62, 42, 47, 66, 66, 62, 52, 70, 63, 51, 60, 41, 67, 72, 51, 77, 73, 66, 58, 45, 53, 76, 51, 62, 65, 44, 80, 71, 44, 63, 79, 65, 56, 70, 41, 79, 71, 73, 64, 35, 40, 38, 46, 60, 40, 55, 85, 84, 85, 94, 37], "policy_policy_0_reward": [-89.52709541772397, -38.773282452993094, -39.66021223440623, 1.0559464728888786, 6.8652957370926915, -126.61722050574092, -31.176664661970673, 1.1704771159763314, -87.16646483512345, 16.555594323338862, -70.78062171170441, -281.7928715907429, -12.63338372290991, -22.077446307225117, -83.50935947021266, -139.81500335801684, -26.419956427337993, -176.7737987292612, -87.60368511775549, -87.44882503168841, -70.71187566500763, -123.92386429106702, -85.36823481845657, -175.0598372102812, 13.522948041983122, -174.45034483361047, -49.47628343707131, -49.874435441441015, -50.53316038107886, -26.34086595008033, -28.246269385428764, -31.84572534180598, -125.87483612486638, -62.23052511629582, -168.04316128941338, -88.09473640278897, -28.589975561833498, -181.0543349871693, -59.74383558356476, 6.157495599391175, -54.358110150086375, 7.52919644455064, -136.3091196442461, -85.09435382983166, 1.3680410851514733, -78.95046066121388, -75.93187861416756, -103.67390136304402, -9.489083962937013, -36.668471278853076, -10.118118257801045, -3.994195897188154, -80.06340745214013, -72.05669366427762, -68.98179258887997, -10.165508660249891, -79.84818422661336, -63.47221951984428, -31.33998030862657, -31.6378752108363, 8.597565664571082, -82.5670192520411, -106.04991336177544, -34.3441538222651, -127.25471068886968, -88.56033801556102, -80.04122979801815, -51.970974079351066, 0.4799991166490183, -33.703741017414075, -105.57012852305762, -15.935825034091067, -64.70410412290646, -78.40789796243727, -1.8704827361072536, -115.88875425737501, -102.8323679395784, -0.3468282511351084, -68.82795636890455, -127.14239550895043, -51.31209124727886, -48.309111146059884, -73.43948787872671, -12.04344958002171, -85.35856999677857, -88.57063425504923, -100.73132326193061, -72.34244946448064, 19.84236067069337, -3.451672223821044, 6.3975925859722675, -10.516948504544665, -57.008892874798654, 6.6265873718697135, -20.53221207970791, -148.4498975954488, -143.69417596354918, -144.33090272280083, -194.34399867409198, -1.6517106590800554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5250660669162303, "mean_inference_ms": 1.5820631011626725, "mean_action_processing_ms": 0.2544956408522182, "mean_env_wait_ms": 3.6942493008426043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011090517044067383, "StateBufferConnector_ms": 0.007348299026489258, "ViewRequirementAgentConnector_ms": 0.17891240119934082}, "num_episodes": 63, "episode_return_max": 19.84236067069337, "episode_return_min": -281.7928715907429, "episode_return_mean": -64.59328797324791, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.296716924424, "num_env_steps_trained_throughput_per_sec": 328.296716924424, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 12646.431, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12646.355, "sample_time_ms": 1341.424, "learn_time_ms": 11244.933, "learn_throughput": 355.716, "synch_weights_time_ms": 59.168}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "8adec_00000", "date": "2024-07-24_15-12-30", "timestamp": 1721814150, "time_this_iter_s": 12.196807622909546, "time_total_s": 618.50994181633, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 618.50994181633, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.677777777777777, "ram_util_percent": 37.81666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.280759976804255, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.20180297323386184, "policy_loss": -0.004942594768848115, "vf_loss": 0.19676177378278226, "vf_explained_var": 0.9997155704225104, "kl": 0.013774019713127927, "entropy": -0.06863313382636989, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": 20.771716513701683, "episode_reward_min": -199.05155044533532, "episode_reward_mean": -69.64082190671101, "episode_len_mean": 63.1, "episode_media": {}, "episodes_timesteps_total": 6310, "policy_reward_min": {"policy_0": -199.05155044533532}, "policy_reward_max": {"policy_0": 20.771716513701683}, "policy_reward_mean": {"policy_0": -69.64082190671101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.970974079351066, 0.4799991166490183, -33.703741017414075, -105.57012852305762, -15.935825034091067, -64.70410412290646, -78.40789796243727, -1.8704827361072536, -115.88875425737501, -102.8323679395784, -0.3468282511351084, -68.82795636890455, -127.14239550895043, -51.31209124727886, -48.309111146059884, -73.43948787872671, -12.04344958002171, -85.35856999677857, -88.57063425504923, -100.73132326193061, -72.34244946448064, 19.84236067069337, -3.451672223821044, 6.3975925859722675, -10.516948504544665, -57.008892874798654, 6.6265873718697135, -20.53221207970791, -148.4498975954488, -143.69417596354918, -144.33090272280083, -194.34399867409198, -1.6517106590800554, -161.82154836585104, -110.21078141216468, -7.239885917400818, 16.706183478999403, -96.50311142242883, 6.728938540322982, -3.4072688747502786, -37.292629442662765, -106.00125985319687, -155.14641385459623, 20.771716513701683, -79.89353108419502, -62.81067964533753, -60.805880546183964, -140.9909342780294, -98.84555172071008, -106.12289837816398, -24.326602241215404, -160.8787541336329, -121.91707299729453, -112.82107302072674, -14.612023909461731, -140.0920009063516, -128.9063705925817, -99.16801127938942, -107.72778426512346, -62.684517198542665, -78.7901730767249, 14.913113369447883, 4.015872484559903, -119.37057552361104, -97.7170490797144, -14.989639004004397, -68.43894182962143, -189.24047454218825, -56.53712500059997, -199.05155044533532, -55.39494936057678, 8.912387225164434, -178.7221573415443, 19.547052308071365, -89.06208027802839, -46.43049185551104, -176.6981028127221, -95.56907915257484, -7.5812464584061345, -58.59803248007899, -65.59270266873999, -24.281458816014467, -146.63921303960052, -95.15834792703036, -30.38883989225348, -121.60519792944685, -39.169090293297984, -85.80143368104572, 12.119421579688401, -124.82012129200531, -67.36738590033532, -30.817514667458667, -104.38661257298182, -38.665851280264015, -162.38008963813567, -128.4602060887409, -29.897583112984268, -58.80998461388597, 4.638584690683407, 4.166870318008042], "episode_lengths": [58, 45, 53, 76, 51, 62, 65, 44, 80, 71, 44, 63, 79, 65, 56, 70, 41, 79, 71, 73, 64, 35, 40, 38, 46, 60, 40, 55, 85, 84, 85, 94, 37, 85, 75, 44, 33, 69, 44, 51, 58, 73, 86, 26, 70, 63, 60, 81, 71, 73, 55, 88, 77, 76, 51, 80, 78, 80, 79, 60, 65, 32, 44, 79, 71, 47, 65, 93, 60, 94, 66, 39, 92, 32, 69, 58, 87, 72, 43, 63, 65, 52, 85, 81, 49, 77, 52, 66, 32, 78, 68, 57, 76, 53, 86, 78, 49, 60, 39, 41], "policy_policy_0_reward": [-51.970974079351066, 0.4799991166490183, -33.703741017414075, -105.57012852305762, -15.935825034091067, -64.70410412290646, -78.40789796243727, -1.8704827361072536, -115.88875425737501, -102.8323679395784, -0.3468282511351084, -68.82795636890455, -127.14239550895043, -51.31209124727886, -48.309111146059884, -73.43948787872671, -12.04344958002171, -85.35856999677857, -88.57063425504923, -100.73132326193061, -72.34244946448064, 19.84236067069337, -3.451672223821044, 6.3975925859722675, -10.516948504544665, -57.008892874798654, 6.6265873718697135, -20.53221207970791, -148.4498975954488, -143.69417596354918, -144.33090272280083, -194.34399867409198, -1.6517106590800554, -161.82154836585104, -110.21078141216468, -7.239885917400818, 16.706183478999403, -96.50311142242883, 6.728938540322982, -3.4072688747502786, -37.292629442662765, -106.00125985319687, -155.14641385459623, 20.771716513701683, -79.89353108419502, -62.81067964533753, -60.805880546183964, -140.9909342780294, -98.84555172071008, -106.12289837816398, -24.326602241215404, -160.8787541336329, -121.91707299729453, -112.82107302072674, -14.612023909461731, -140.0920009063516, -128.9063705925817, -99.16801127938942, -107.72778426512346, -62.684517198542665, -78.7901730767249, 14.913113369447883, 4.015872484559903, -119.37057552361104, -97.7170490797144, -14.989639004004397, -68.43894182962143, -189.24047454218825, -56.53712500059997, -199.05155044533532, -55.39494936057678, 8.912387225164434, -178.7221573415443, 19.547052308071365, -89.06208027802839, -46.43049185551104, -176.6981028127221, -95.56907915257484, -7.5812464584061345, -58.59803248007899, -65.59270266873999, -24.281458816014467, -146.63921303960052, -95.15834792703036, -30.38883989225348, -121.60519792944685, -39.169090293297984, -85.80143368104572, 12.119421579688401, -124.82012129200531, -67.36738590033532, -30.817514667458667, -104.38661257298182, -38.665851280264015, -162.38008963813567, -128.4602060887409, -29.897583112984268, -58.80998461388597, 4.638584690683407, 4.166870318008042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5248101494438299, "mean_inference_ms": 1.5800873370023458, "mean_action_processing_ms": 0.2544098356258941, "mean_env_wait_ms": 3.6946843448481514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011217832565307617, "StateBufferConnector_ms": 0.007393360137939453, "ViewRequirementAgentConnector_ms": 0.1802053451538086}, "num_episodes": 67, "episode_return_max": 20.771716513701683, "episode_return_min": -199.05155044533532, "episode_return_mean": -69.64082190671101, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.4664826218684, "num_env_steps_trained_throughput_per_sec": 302.4664826218684, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 12831.206, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12831.131, "sample_time_ms": 1342.874, "learn_time_ms": 11428.314, "learn_throughput": 350.008, "synch_weights_time_ms": 59.065}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "8adec_00000", "date": "2024-07-24_15-12-43", "timestamp": 1721814163, "time_this_iter_s": 13.234861135482788, "time_total_s": 631.7448029518127, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8cae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 631.7448029518127, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 18.52105263157895, "ram_util_percent": 37.80526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.80382187664509, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.20454856135547744, "policy_loss": -0.006843345240728619, "vf_loss": 0.2001042943758269, "vf_explained_var": 0.9996293217564622, "kl": 0.014793989621345401, "entropy": -0.1301669265589832, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 22.1247269510033, "episode_reward_min": -213.58714228630106, "episode_reward_mean": -66.67226319337824, "episode_len_mean": 62.16, "episode_media": {}, "episodes_timesteps_total": 6216, "policy_reward_min": {"policy_0": -213.58714228630106}, "policy_reward_max": {"policy_0": 22.1247269510033}, "policy_reward_mean": {"policy_0": -66.67226319337824}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.684517198542665, -78.7901730767249, 14.913113369447883, 4.015872484559903, -119.37057552361104, -97.7170490797144, -14.989639004004397, -68.43894182962143, -189.24047454218825, -56.53712500059997, -199.05155044533532, -55.39494936057678, 8.912387225164434, -178.7221573415443, 19.547052308071365, -89.06208027802839, -46.43049185551104, -176.6981028127221, -95.56907915257484, -7.5812464584061345, -58.59803248007899, -65.59270266873999, -24.281458816014467, -146.63921303960052, -95.15834792703036, -30.38883989225348, -121.60519792944685, -39.169090293297984, -85.80143368104572, 12.119421579688401, -124.82012129200531, -67.36738590033532, -30.817514667458667, -104.38661257298182, -38.665851280264015, -162.38008963813567, -128.4602060887409, -29.897583112984268, -58.80998461388597, 4.638584690683407, 4.166870318008042, -67.81105209586272, -130.75136830376346, 12.515039413977112, 1.6510119124546534, -70.52142157595635, -153.49852982638353, 5.465990449141135, -98.17003562663375, -105.4272902906482, -30.257387890854197, 4.215887933622781, -24.418806145260998, -123.13471509509976, -29.288639442391144, -0.5099560018870137, -39.01074628874999, 2.7619809923102414, -213.58714228630106, -21.705420850605393, -13.77222715480756, -173.81043309852726, -79.95989025948097, -105.27252919451178, -107.45329621233948, -128.40029139597667, -7.831404947118831, -30.890714543174763, -146.7562901776939, -85.24155697105172, -83.28099546023921, -42.33278173236474, -20.93037127116953, -27.91066521073051, -77.76936905495678, -16.011962173014847, 7.533937457289192, -74.71962176058834, -190.37652182486022, -5.180947658047687, -155.941702944035, -121.4074110931203, -46.31462448621778, -156.34148892580558, -145.319663414247, 22.1247269510033, -24.164227622162063, -20.5054158175809, -101.02038579263912, 8.841854715715817, -19.00782089278387, -90.24517205145996, -47.988187437225235, 14.534733735770175, 1.7240448963227837, -113.06438261688143, -126.82703455660206, -157.92381395850927, 4.5566876996841, -20.281985186410775], "episode_lengths": [60, 65, 32, 44, 79, 71, 47, 65, 93, 60, 94, 66, 39, 92, 32, 69, 58, 87, 72, 43, 63, 65, 52, 85, 81, 49, 77, 52, 66, 32, 78, 68, 57, 76, 53, 86, 78, 49, 60, 39, 41, 59, 79, 35, 37, 61, 85, 42, 80, 73, 60, 42, 55, 77, 59, 46, 58, 36, 97, 55, 48, 86, 70, 73, 79, 77, 45, 58, 83, 68, 66, 63, 53, 53, 63, 51, 34, 80, 93, 48, 88, 77, 57, 83, 81, 26, 48, 55, 71, 32, 55, 70, 62, 37, 40, 77, 85, 88, 36, 46], "policy_policy_0_reward": [-62.684517198542665, -78.7901730767249, 14.913113369447883, 4.015872484559903, -119.37057552361104, -97.7170490797144, -14.989639004004397, -68.43894182962143, -189.24047454218825, -56.53712500059997, -199.05155044533532, -55.39494936057678, 8.912387225164434, -178.7221573415443, 19.547052308071365, -89.06208027802839, -46.43049185551104, -176.6981028127221, -95.56907915257484, -7.5812464584061345, -58.59803248007899, -65.59270266873999, -24.281458816014467, -146.63921303960052, -95.15834792703036, -30.38883989225348, -121.60519792944685, -39.169090293297984, -85.80143368104572, 12.119421579688401, -124.82012129200531, -67.36738590033532, -30.817514667458667, -104.38661257298182, -38.665851280264015, -162.38008963813567, -128.4602060887409, -29.897583112984268, -58.80998461388597, 4.638584690683407, 4.166870318008042, -67.81105209586272, -130.75136830376346, 12.515039413977112, 1.6510119124546534, -70.52142157595635, -153.49852982638353, 5.465990449141135, -98.17003562663375, -105.4272902906482, -30.257387890854197, 4.215887933622781, -24.418806145260998, -123.13471509509976, -29.288639442391144, -0.5099560018870137, -39.01074628874999, 2.7619809923102414, -213.58714228630106, -21.705420850605393, -13.77222715480756, -173.81043309852726, -79.95989025948097, -105.27252919451178, -107.45329621233948, -128.40029139597667, -7.831404947118831, -30.890714543174763, -146.7562901776939, -85.24155697105172, -83.28099546023921, -42.33278173236474, -20.93037127116953, -27.91066521073051, -77.76936905495678, -16.011962173014847, 7.533937457289192, -74.71962176058834, -190.37652182486022, -5.180947658047687, -155.941702944035, -121.4074110931203, -46.31462448621778, -156.34148892580558, -145.319663414247, 22.1247269510033, -24.164227622162063, -20.5054158175809, -101.02038579263912, 8.841854715715817, -19.00782089278387, -90.24517205145996, -47.988187437225235, 14.534733735770175, 1.7240448963227837, -113.06438261688143, -126.82703455660206, -157.92381395850927, 4.5566876996841, -20.281985186410775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.524953594869541, "mean_inference_ms": 1.5784938467945682, "mean_action_processing_ms": 0.25418332094205043, "mean_env_wait_ms": 3.694791189422194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011367082595825195, "StateBufferConnector_ms": 0.007493495941162109, "ViewRequirementAgentConnector_ms": 0.18243861198425293}, "num_episodes": 59, "episode_return_max": 22.1247269510033, "episode_return_min": -213.58714228630106, "episode_return_mean": -66.67226319337824, "episodes_this_iter": 59}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.15859708327696, "num_env_steps_trained_throughput_per_sec": 358.15859708327696, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 12690.601, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12690.525, "sample_time_ms": 1347.86, "learn_time_ms": 11282.932, "learn_throughput": 354.518, "synch_weights_time_ms": 58.861}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "8adec_00000", "date": "2024-07-24_15-12-54", "timestamp": 1721814174, "time_this_iter_s": 11.179394960403442, "time_total_s": 642.9241979122162, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8cb880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 642.9241979122162, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.075, "ram_util_percent": 38.14375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.05074862639109, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.19109523436782183, "policy_loss": -0.006548686444875784, "vf_loss": 0.18567601351533086, "vf_explained_var": 0.999702263623476, "kl": 0.0161157226405825, "entropy": -0.10897948961064685, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": 22.1247269510033, "episode_reward_min": -194.18698011156994, "episode_reward_mean": -63.73957188512579, "episode_len_mean": 61.88, "episode_media": {}, "episodes_timesteps_total": 6188, "policy_reward_min": {"policy_0": -194.18698011156994}, "policy_reward_max": {"policy_0": 22.1247269510033}, "policy_reward_mean": {"policy_0": -63.73957188512579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.890714543174763, -146.7562901776939, -85.24155697105172, -83.28099546023921, -42.33278173236474, -20.93037127116953, -27.91066521073051, -77.76936905495678, -16.011962173014847, 7.533937457289192, -74.71962176058834, -190.37652182486022, -5.180947658047687, -155.941702944035, -121.4074110931203, -46.31462448621778, -156.34148892580558, -145.319663414247, 22.1247269510033, -24.164227622162063, -20.5054158175809, -101.02038579263912, 8.841854715715817, -19.00782089278387, -90.24517205145996, -47.988187437225235, 14.534733735770175, 1.7240448963227837, -113.06438261688143, -126.82703455660206, -157.92381395850927, 4.5566876996841, -20.281985186410775, -20.035109304888795, 14.113011756982782, -100.06888443526012, -125.36445431457919, -95.7556399130667, -88.6187143279877, -11.711517138010915, -38.22699179541556, -150.1312605370258, -77.180438631097, -74.96519537787474, -32.134092559860704, 20.048276229965946, -48.542022882763405, -9.496574415070079, -151.30513443257647, 10.703820654074384, -140.0432344791132, -58.439457392488464, -58.933799709738736, -2.0126694751614007, -44.58348467395066, 8.860077943548362, -19.659206367333766, -0.023038441920378627, -23.27511871536451, -131.4121408546696, -110.47144048135121, -96.46620325993914, 4.032121859425353, -84.3725486924976, -125.11344259623887, 5.959712391314858, -56.882526685935325, 2.1644040568355187, -11.954354969437812, -113.90113089814534, -182.71969494482744, -97.81142216872927, -10.104751513108617, -1.4612381183935803, -89.04323160942818, -8.279447955746459, 12.87975701184825, -63.108867812916706, -10.20732620039395, -90.92885196863544, -122.13552931730297, -165.15350361677287, -31.01559940523696, -49.835902915344086, -81.01313311066963, -45.614747174070004, -106.71501353193001, -74.95163863620144, -75.87596585879696, -121.04866039155145, -0.6257351511487113, -58.67910898532153, -52.20528803241694, -194.18698011156994, -22.867469784117077, -171.15425672949357, -45.418032571421335, -78.4928191024343, -70.33338132692563, -142.21181543511875], "episode_lengths": [58, 83, 68, 66, 63, 53, 53, 63, 51, 34, 80, 93, 48, 88, 77, 57, 83, 81, 26, 48, 55, 71, 32, 55, 70, 62, 37, 40, 77, 85, 88, 36, 46, 47, 31, 74, 77, 69, 77, 47, 59, 84, 79, 66, 47, 33, 64, 46, 83, 32, 80, 65, 59, 46, 58, 40, 50, 47, 52, 79, 73, 68, 41, 72, 88, 42, 63, 36, 42, 77, 91, 83, 48, 44, 68, 43, 31, 76, 41, 70, 82, 88, 60, 60, 74, 57, 83, 69, 65, 75, 41, 59, 60, 94, 46, 86, 61, 67, 64, 82], "policy_policy_0_reward": [-30.890714543174763, -146.7562901776939, -85.24155697105172, -83.28099546023921, -42.33278173236474, -20.93037127116953, -27.91066521073051, -77.76936905495678, -16.011962173014847, 7.533937457289192, -74.71962176058834, -190.37652182486022, -5.180947658047687, -155.941702944035, -121.4074110931203, -46.31462448621778, -156.34148892580558, -145.319663414247, 22.1247269510033, -24.164227622162063, -20.5054158175809, -101.02038579263912, 8.841854715715817, -19.00782089278387, -90.24517205145996, -47.988187437225235, 14.534733735770175, 1.7240448963227837, -113.06438261688143, -126.82703455660206, -157.92381395850927, 4.5566876996841, -20.281985186410775, -20.035109304888795, 14.113011756982782, -100.06888443526012, -125.36445431457919, -95.7556399130667, -88.6187143279877, -11.711517138010915, -38.22699179541556, -150.1312605370258, -77.180438631097, -74.96519537787474, -32.134092559860704, 20.048276229965946, -48.542022882763405, -9.496574415070079, -151.30513443257647, 10.703820654074384, -140.0432344791132, -58.439457392488464, -58.933799709738736, -2.0126694751614007, -44.58348467395066, 8.860077943548362, -19.659206367333766, -0.023038441920378627, -23.27511871536451, -131.4121408546696, -110.47144048135121, -96.46620325993914, 4.032121859425353, -84.3725486924976, -125.11344259623887, 5.959712391314858, -56.882526685935325, 2.1644040568355187, -11.954354969437812, -113.90113089814534, -182.71969494482744, -97.81142216872927, -10.104751513108617, -1.4612381183935803, -89.04323160942818, -8.279447955746459, 12.87975701184825, -63.108867812916706, -10.20732620039395, -90.92885196863544, -122.13552931730297, -165.15350361677287, -31.01559940523696, -49.835902915344086, -81.01313311066963, -45.614747174070004, -106.71501353193001, -74.95163863620144, -75.87596585879696, -121.04866039155145, -0.6257351511487113, -58.67910898532153, -52.20528803241694, -194.18698011156994, -22.867469784117077, -171.15425672949357, -45.418032571421335, -78.4928191024343, -70.33338132692563, -142.21181543511875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5251845886003788, "mean_inference_ms": 1.579410921295751, "mean_action_processing_ms": 0.2544528241303629, "mean_env_wait_ms": 3.7026406373570224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011886835098266602, "StateBufferConnector_ms": 0.007798671722412109, "ViewRequirementAgentConnector_ms": 0.18774104118347168}, "num_episodes": 67, "episode_return_max": 22.1247269510033, "episode_return_min": -194.18698011156994, "episode_return_mean": -63.73957188512579, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.88009304673506, "num_env_steps_trained_throughput_per_sec": 305.88009304673506, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 12666.182, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12666.108, "sample_time_ms": 1348.642, "learn_time_ms": 11257.309, "learn_throughput": 355.325, "synch_weights_time_ms": 59.293}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "8adec_00000", "date": "2024-07-24_15-13-07", "timestamp": 1721814187, "time_this_iter_s": 13.088177919387817, "time_total_s": 656.012375831604, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc66a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 656.012375831604, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 19.166666666666668, "ram_util_percent": 37.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.20893368770679, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.18553857805721538, "policy_loss": -0.0035479086198999237, "vf_loss": 0.17418265986877182, "vf_explained_var": 0.9997001620009541, "kl": 0.02013918747768836, "entropy": -0.1309875833481783, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 16.928828924056017, "episode_reward_min": -215.67493980365452, "episode_reward_mean": -72.53803761705622, "episode_len_mean": 64.94, "episode_media": {}, "episodes_timesteps_total": 6494, "policy_reward_min": {"policy_0": -215.67493980365452}, "policy_reward_max": {"policy_0": 16.928828924056017}, "policy_reward_mean": {"policy_0": -72.53803761705622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.032121859425353, -84.3725486924976, -125.11344259623887, 5.959712391314858, -56.882526685935325, 2.1644040568355187, -11.954354969437812, -113.90113089814534, -182.71969494482744, -97.81142216872927, -10.104751513108617, -1.4612381183935803, -89.04323160942818, -8.279447955746459, 12.87975701184825, -63.108867812916706, -10.20732620039395, -90.92885196863544, -122.13552931730297, -165.15350361677287, -31.01559940523696, -49.835902915344086, -81.01313311066963, -45.614747174070004, -106.71501353193001, -74.95163863620144, -75.87596585879696, -121.04866039155145, -0.6257351511487113, -58.67910898532153, -52.20528803241694, -194.18698011156994, -22.867469784117077, -171.15425672949357, -45.418032571421335, -78.4928191024343, -70.33338132692563, -142.21181543511875, -106.19051177177327, -37.19435130816166, -136.38046136428426, -85.59057991938437, -91.13119120981746, -120.98265546447973, -27.485318711673155, -68.8881437649278, -23.810188356821335, -43.42090898575654, -39.791764809398536, -79.09049295207718, -95.03620985554049, 8.32413426019278, 8.229113499739707, -1.2304609288302728, 11.955983578220419, 9.662344821198717, -100.16164668203007, -98.21413147245914, -67.11407589264037, -185.9258341294895, -145.06141859037035, -125.54298823272055, -215.67493980365452, -103.89730090866355, -53.46949700643293, -71.90274400569119, -92.06245850012381, 15.325019793875486, -27.836321646482386, -53.09593205306148, -130.77444434927645, -149.20292776740564, -91.52919330548048, -175.40873082896908, 13.906217623326937, -125.87186899909142, -82.41560552963465, -107.07439187832627, -158.60845165774242, -30.846266734307537, -126.2484675872484, 16.928828924056017, -79.8497144370716, -104.26982954299083, -91.26654452602548, -66.22475451559497, 11.440211242397847, -17.771275204339723, -153.97810499613254, 2.7916673831755126, 6.030825718894763, -84.02367683930929, -5.920403611269466, -186.11650040594915, -49.67894715827417, -152.70530639002294, -102.19606772629682, -13.665103648936217, -76.87014336227779, -69.31143721912548], "episode_lengths": [41, 72, 88, 42, 63, 36, 42, 77, 91, 83, 48, 44, 68, 43, 31, 76, 41, 70, 82, 88, 60, 60, 74, 57, 83, 69, 65, 75, 41, 59, 60, 94, 46, 86, 61, 67, 64, 82, 75, 53, 79, 82, 71, 76, 52, 62, 56, 60, 55, 67, 72, 37, 33, 42, 43, 42, 70, 71, 66, 93, 84, 79, 97, 86, 66, 64, 82, 32, 60, 63, 77, 85, 84, 91, 29, 77, 66, 78, 84, 50, 79, 33, 80, 73, 70, 67, 38, 56, 86, 44, 34, 70, 48, 90, 56, 82, 83, 52, 65, 68], "policy_policy_0_reward": [4.032121859425353, -84.3725486924976, -125.11344259623887, 5.959712391314858, -56.882526685935325, 2.1644040568355187, -11.954354969437812, -113.90113089814534, -182.71969494482744, -97.81142216872927, -10.104751513108617, -1.4612381183935803, -89.04323160942818, -8.279447955746459, 12.87975701184825, -63.108867812916706, -10.20732620039395, -90.92885196863544, -122.13552931730297, -165.15350361677287, -31.01559940523696, -49.835902915344086, -81.01313311066963, -45.614747174070004, -106.71501353193001, -74.95163863620144, -75.87596585879696, -121.04866039155145, -0.6257351511487113, -58.67910898532153, -52.20528803241694, -194.18698011156994, -22.867469784117077, -171.15425672949357, -45.418032571421335, -78.4928191024343, -70.33338132692563, -142.21181543511875, -106.19051177177327, -37.19435130816166, -136.38046136428426, -85.59057991938437, -91.13119120981746, -120.98265546447973, -27.485318711673155, -68.8881437649278, -23.810188356821335, -43.42090898575654, -39.791764809398536, -79.09049295207718, -95.03620985554049, 8.32413426019278, 8.229113499739707, -1.2304609288302728, 11.955983578220419, 9.662344821198717, -100.16164668203007, -98.21413147245914, -67.11407589264037, -185.9258341294895, -145.06141859037035, -125.54298823272055, -215.67493980365452, -103.89730090866355, -53.46949700643293, -71.90274400569119, -92.06245850012381, 15.325019793875486, -27.836321646482386, -53.09593205306148, -130.77444434927645, -149.20292776740564, -91.52919330548048, -175.40873082896908, 13.906217623326937, -125.87186899909142, -82.41560552963465, -107.07439187832627, -158.60845165774242, -30.846266734307537, -126.2484675872484, 16.928828924056017, -79.8497144370716, -104.26982954299083, -91.26654452602548, -66.22475451559497, 11.440211242397847, -17.771275204339723, -153.97810499613254, 2.7916673831755126, 6.030825718894763, -84.02367683930929, -5.920403611269466, -186.11650040594915, -49.67894715827417, -152.70530639002294, -102.19606772629682, -13.665103648936217, -76.87014336227779, -69.31143721912548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5252498834826234, "mean_inference_ms": 1.5795726986673575, "mean_action_processing_ms": 0.25465639886949026, "mean_env_wait_ms": 3.706400085450558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01183938980102539, "StateBufferConnector_ms": 0.007622718811035156, "ViewRequirementAgentConnector_ms": 0.18309283256530762}, "num_episodes": 62, "episode_return_max": 16.928828924056017, "episode_return_min": -215.67493980365452, "episode_return_mean": -72.53803761705622, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.7544493742658, "num_env_steps_trained_throughput_per_sec": 310.7544493742658, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 12676.843, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12676.769, "sample_time_ms": 1352.851, "learn_time_ms": 11263.007, "learn_throughput": 355.145, "synch_weights_time_ms": 60.046}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "8adec_00000", "date": "2024-07-24_15-13-20", "timestamp": 1721814200, "time_this_iter_s": 12.883042335510254, "time_total_s": 668.8954181671143, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8cae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 668.8954181671143, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 18.69473684210526, "ram_util_percent": 37.88421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.23751727143924, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.19152411228472677, "policy_loss": -0.008329461937440405, "vf_loss": 0.18469221030827612, "vf_explained_var": 0.9996534960965315, "kl": 0.013302365570370966, "entropy": -0.16927192080765963, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 16.928828924056017, "episode_reward_min": -203.895977250585, "episode_reward_mean": -59.28900870979458, "episode_len_mean": 61.17, "episode_media": {}, "episodes_timesteps_total": 6117, "policy_reward_min": {"policy_0": -203.895977250585}, "policy_reward_max": {"policy_0": 16.928828924056017}, "policy_reward_mean": {"policy_0": -59.28900870979458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.90274400569119, -92.06245850012381, 15.325019793875486, -27.836321646482386, -53.09593205306148, -130.77444434927645, -149.20292776740564, -91.52919330548048, -175.40873082896908, 13.906217623326937, -125.87186899909142, -82.41560552963465, -107.07439187832627, -158.60845165774242, -30.846266734307537, -126.2484675872484, 16.928828924056017, -79.8497144370716, -104.26982954299083, -91.26654452602548, -66.22475451559497, 11.440211242397847, -17.771275204339723, -153.97810499613254, 2.7916673831755126, 6.030825718894763, -84.02367683930929, -5.920403611269466, -186.11650040594915, -49.67894715827417, -152.70530639002294, -102.19606772629682, -13.665103648936217, -76.87014336227779, -69.31143721912548, -17.86885218958668, -58.76403097496476, -32.1531078383916, -11.727144003725703, -29.76495144333302, -89.00892092879577, -96.40407789403986, -60.81764030339692, 4.4106991176503625, -77.841654190766, -203.895977250585, -17.59960365035061, -53.61786732966195, -4.530366888641119, -41.62078430057671, -71.18425205253686, -106.74351203276697, -153.65223610977614, -90.94435240186363, 10.398007444596926, 4.834718494198254, -17.96077290789573, -89.3686660799472, -54.21227730526366, -68.71840311870884, -169.48371148256248, -124.32622285359096, -20.4350687068702, -16.544550674890075, -139.01729928406937, -60.364258056398, -60.939380544093474, -9.331319438170844, 1.8717160599678393, -183.1837237601866, -22.009976058961012, -25.187611719610494, -0.5525513438100149, -3.0395418585921665, -14.985100026801748, -67.80816730506767, 1.9330741374389422, 11.969474682667665, -70.18878088239148, -7.989642271764684, -108.18562010247814, -44.70397889231204, -72.8649923782428, -91.03385610124072, 7.425099176730501, -13.436941975203204, 11.42167213052552, 1.9645153929344723, -33.809497338367926, -80.18897247572366, -27.913997199723124, 1.0896550209262799, -76.89604426486021, -122.12768425872612, -100.08469990919787, -15.22890743202787, -44.78401600083164, -66.12349184997012, -30.703732107718302, -4.0438691463335035], "episode_lengths": [64, 82, 32, 60, 63, 77, 85, 84, 91, 29, 77, 66, 78, 84, 50, 79, 33, 80, 73, 70, 67, 38, 56, 86, 44, 34, 70, 48, 90, 56, 82, 83, 52, 65, 68, 48, 66, 50, 50, 59, 68, 84, 60, 43, 65, 97, 57, 60, 37, 57, 65, 72, 82, 69, 34, 38, 55, 68, 57, 64, 86, 77, 54, 55, 79, 61, 65, 42, 37, 91, 56, 55, 44, 44, 47, 63, 45, 30, 62, 40, 74, 62, 67, 71, 44, 52, 35, 43, 61, 68, 60, 50, 74, 82, 71, 46, 60, 63, 52, 48], "policy_policy_0_reward": [-71.90274400569119, -92.06245850012381, 15.325019793875486, -27.836321646482386, -53.09593205306148, -130.77444434927645, -149.20292776740564, -91.52919330548048, -175.40873082896908, 13.906217623326937, -125.87186899909142, -82.41560552963465, -107.07439187832627, -158.60845165774242, -30.846266734307537, -126.2484675872484, 16.928828924056017, -79.8497144370716, -104.26982954299083, -91.26654452602548, -66.22475451559497, 11.440211242397847, -17.771275204339723, -153.97810499613254, 2.7916673831755126, 6.030825718894763, -84.02367683930929, -5.920403611269466, -186.11650040594915, -49.67894715827417, -152.70530639002294, -102.19606772629682, -13.665103648936217, -76.87014336227779, -69.31143721912548, -17.86885218958668, -58.76403097496476, -32.1531078383916, -11.727144003725703, -29.76495144333302, -89.00892092879577, -96.40407789403986, -60.81764030339692, 4.4106991176503625, -77.841654190766, -203.895977250585, -17.59960365035061, -53.61786732966195, -4.530366888641119, -41.62078430057671, -71.18425205253686, -106.74351203276697, -153.65223610977614, -90.94435240186363, 10.398007444596926, 4.834718494198254, -17.96077290789573, -89.3686660799472, -54.21227730526366, -68.71840311870884, -169.48371148256248, -124.32622285359096, -20.4350687068702, -16.544550674890075, -139.01729928406937, -60.364258056398, -60.939380544093474, -9.331319438170844, 1.8717160599678393, -183.1837237601866, -22.009976058961012, -25.187611719610494, -0.5525513438100149, -3.0395418585921665, -14.985100026801748, -67.80816730506767, 1.9330741374389422, 11.969474682667665, -70.18878088239148, -7.989642271764684, -108.18562010247814, -44.70397889231204, -72.8649923782428, -91.03385610124072, 7.425099176730501, -13.436941975203204, 11.42167213052552, 1.9645153929344723, -33.809497338367926, -80.18897247572366, -27.913997199723124, 1.0896550209262799, -76.89604426486021, -122.12768425872612, -100.08469990919787, -15.22890743202787, -44.78401600083164, -66.12349184997012, -30.703732107718302, -4.0438691463335035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5254927087404269, "mean_inference_ms": 1.5775672503755152, "mean_action_processing_ms": 0.25438919946962235, "mean_env_wait_ms": 3.7072473004709052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011106252670288086, "StateBufferConnector_ms": 0.007535219192504883, "ViewRequirementAgentConnector_ms": 0.17859411239624023}, "num_episodes": 65, "episode_return_max": 16.928828924056017, "episode_return_min": -203.895977250585, "episode_return_mean": -59.28900870979458, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.5401275710458, "num_env_steps_trained_throughput_per_sec": 330.5401275710458, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 12602.866, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12602.791, "sample_time_ms": 1353.191, "learn_time_ms": 11188.857, "learn_throughput": 357.499, "synch_weights_time_ms": 59.868}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "8adec_00000", "date": "2024-07-24_15-13-32", "timestamp": 1721814212, "time_this_iter_s": 12.113574028015137, "time_total_s": 681.0089921951294, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8e9990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 681.0089921951294, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.11176470588235, "ram_util_percent": 37.923529411764704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.40824406047662, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1914565040487408, "policy_loss": -0.006583592892760256, "vf_loss": 0.1820051114152496, "vf_explained_var": 0.9996893544991811, "kl": 0.014179728743980984, "entropy": -0.16780096457805485, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 19.6151218523227, "episode_reward_min": -190.60724100027133, "episode_reward_mean": -55.22477213880272, "episode_len_mean": 60.21, "episode_media": {}, "episodes_timesteps_total": 6021, "policy_reward_min": {"policy_0": -190.60724100027133}, "policy_reward_max": {"policy_0": 19.6151218523227}, "policy_reward_mean": {"policy_0": -55.22477213880272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.939380544093474, -9.331319438170844, 1.8717160599678393, -183.1837237601866, -22.009976058961012, -25.187611719610494, -0.5525513438100149, -3.0395418585921665, -14.985100026801748, -67.80816730506767, 1.9330741374389422, 11.969474682667665, -70.18878088239148, -7.989642271764684, -108.18562010247814, -44.70397889231204, -72.8649923782428, -91.03385610124072, 7.425099176730501, -13.436941975203204, 11.42167213052552, 1.9645153929344723, -33.809497338367926, -80.18897247572366, -27.913997199723124, 1.0896550209262799, -76.89604426486021, -122.12768425872612, -100.08469990919787, -15.22890743202787, -44.78401600083164, -66.12349184997012, -30.703732107718302, -4.0438691463335035, -90.34368093067938, -59.98202887231028, -7.049114311025126, -25.381960668491956, -135.00746793499943, -95.29860774747821, -84.07452921585585, 17.008505329028242, -29.37920956866986, -36.24365813110079, -27.067848613382186, -119.56021750823284, -4.657791164418896, -137.55027773697157, -75.08675908513433, -79.91380391813078, -44.297703973114004, -10.161208738165117, -103.13893118538941, -65.1503142023813, -14.686435977775448, -93.12920894035894, -97.66316598242612, -80.51349266664188, -119.09337221077617, 4.8955573283415905, -97.14774980384114, -72.15426631374224, -49.50453067140497, -15.274066247857478, -44.308797311484355, 6.532283825092843, 18.531110282281123, -51.490042779093464, -36.89293496473782, -24.20929259500464, -99.50401842418123, 6.65010147098731, -112.5449277815979, -79.03533860701674, -135.18187624912878, -172.20863029644477, -3.481435204163816, -145.37583685647587, 19.6151218523227, -42.34692233397009, -106.43156745033745, -51.20412902138311, -21.850228624396255, -81.77356230877285, -122.38805776377862, -99.19181996532377, -59.2048062453934, -110.72353418170704, -131.0720630529169, -37.537744194086144, -127.09292960938232, 12.840520578714635, -1.2632025994436251, -49.74344307329004, -159.4687414869356, -79.50035105404883, -18.18770494064893, -190.60724100027133, 0.24318298223816037, 13.209874808109655], "episode_lengths": [65, 42, 37, 91, 56, 55, 44, 44, 47, 63, 45, 30, 62, 40, 74, 62, 67, 71, 44, 52, 35, 43, 61, 68, 60, 50, 74, 82, 71, 46, 60, 63, 52, 48, 75, 58, 42, 51, 84, 70, 68, 36, 60, 55, 56, 76, 50, 80, 80, 67, 55, 42, 83, 75, 47, 68, 82, 68, 76, 45, 79, 65, 65, 54, 64, 40, 33, 63, 53, 59, 72, 38, 74, 74, 84, 87, 52, 84, 30, 57, 74, 58, 48, 67, 77, 71, 58, 73, 79, 52, 78, 33, 46, 57, 84, 66, 47, 94, 44, 35], "policy_policy_0_reward": [-60.939380544093474, -9.331319438170844, 1.8717160599678393, -183.1837237601866, -22.009976058961012, -25.187611719610494, -0.5525513438100149, -3.0395418585921665, -14.985100026801748, -67.80816730506767, 1.9330741374389422, 11.969474682667665, -70.18878088239148, -7.989642271764684, -108.18562010247814, -44.70397889231204, -72.8649923782428, -91.03385610124072, 7.425099176730501, -13.436941975203204, 11.42167213052552, 1.9645153929344723, -33.809497338367926, -80.18897247572366, -27.913997199723124, 1.0896550209262799, -76.89604426486021, -122.12768425872612, -100.08469990919787, -15.22890743202787, -44.78401600083164, -66.12349184997012, -30.703732107718302, -4.0438691463335035, -90.34368093067938, -59.98202887231028, -7.049114311025126, -25.381960668491956, -135.00746793499943, -95.29860774747821, -84.07452921585585, 17.008505329028242, -29.37920956866986, -36.24365813110079, -27.067848613382186, -119.56021750823284, -4.657791164418896, -137.55027773697157, -75.08675908513433, -79.91380391813078, -44.297703973114004, -10.161208738165117, -103.13893118538941, -65.1503142023813, -14.686435977775448, -93.12920894035894, -97.66316598242612, -80.51349266664188, -119.09337221077617, 4.8955573283415905, -97.14774980384114, -72.15426631374224, -49.50453067140497, -15.274066247857478, -44.308797311484355, 6.532283825092843, 18.531110282281123, -51.490042779093464, -36.89293496473782, -24.20929259500464, -99.50401842418123, 6.65010147098731, -112.5449277815979, -79.03533860701674, -135.18187624912878, -172.20863029644477, -3.481435204163816, -145.37583685647587, 19.6151218523227, -42.34692233397009, -106.43156745033745, -51.20412902138311, -21.850228624396255, -81.77356230877285, -122.38805776377862, -99.19181996532377, -59.2048062453934, -110.72353418170704, -131.0720630529169, -37.537744194086144, -127.09292960938232, 12.840520578714635, -1.2632025994436251, -49.74344307329004, -159.4687414869356, -79.50035105404883, -18.18770494064893, -190.60724100027133, 0.24318298223816037, 13.209874808109655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5249560580285376, "mean_inference_ms": 1.5760725900529935, "mean_action_processing_ms": 0.2542021070777812, "mean_env_wait_ms": 3.7082444464808164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011157751083374023, "StateBufferConnector_ms": 0.007395267486572266, "ViewRequirementAgentConnector_ms": 0.1779177188873291}, "num_episodes": 66, "episode_return_max": 19.6151218523227, "episode_return_min": -190.60724100027133, "episode_return_mean": -55.22477213880272, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.49342423184464, "num_env_steps_trained_throughput_per_sec": 384.49342423184464, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 12344.357, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12344.283, "sample_time_ms": 1349.353, "learn_time_ms": 10932.552, "learn_throughput": 365.88, "synch_weights_time_ms": 61.486}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "8adec_00000", "date": "2024-07-24_15-13-43", "timestamp": 1721814223, "time_this_iter_s": 10.416512966156006, "time_total_s": 691.4255051612854, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8c9900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 691.4255051612854, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.66, "ram_util_percent": 37.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.024152061343194, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1805064923382209, "policy_loss": -0.005590895507581687, "vf_loss": 0.1721761152225857, "vf_explained_var": 0.9997177109743158, "kl": 0.012242656093925082, "entropy": -0.15255830160652598, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": 19.6151218523227, "episode_reward_min": -194.80658970035535, "episode_reward_mean": -71.1905615395936, "episode_len_mean": 63.48, "episode_media": {}, "episodes_timesteps_total": 6348, "policy_reward_min": {"policy_0": -194.80658970035535}, "policy_reward_max": {"policy_0": 19.6151218523227}, "policy_reward_mean": {"policy_0": -71.1905615395936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.308797311484355, 6.532283825092843, 18.531110282281123, -51.490042779093464, -36.89293496473782, -24.20929259500464, -99.50401842418123, 6.65010147098731, -112.5449277815979, -79.03533860701674, -135.18187624912878, -172.20863029644477, -3.481435204163816, -145.37583685647587, 19.6151218523227, -42.34692233397009, -106.43156745033745, -51.20412902138311, -21.850228624396255, -81.77356230877285, -122.38805776377862, -99.19181996532377, -59.2048062453934, -110.72353418170704, -131.0720630529169, -37.537744194086144, -127.09292960938232, 12.840520578714635, -1.2632025994436251, -49.74344307329004, -159.4687414869356, -79.50035105404883, -18.18770494064893, -190.60724100027133, 0.24318298223816037, 13.209874808109655, -71.37941395736217, -70.80972972688802, 10.556459573868192, -65.4817733838444, -4.938238754360331, -62.54342457667596, -123.54653223533566, -78.65041664713304, -58.924211181137025, -13.788543405186854, 11.221991025767828, -63.10015634415849, -28.063416683515076, -21.411906205244918, -29.900551314764545, -114.71983779042057, -4.780417008220473, -106.5094224710996, -15.40074751083214, -20.772185839310698, -66.76923166811115, -123.4787543765989, -71.9123723111701, -53.068853092074114, -126.91197720156957, -141.3944872298035, -122.37851615119348, 9.943859342348029, -109.66451539235226, -53.13037453582378, -91.2973502997295, -38.75940491219732, -94.15331299664375, -186.82012366290607, -23.897176752168402, -156.956226980196, -162.32501439011523, -62.30507790185611, -125.71530994307885, -63.03685849975568, -25.90974455177751, -148.7264649871587, -156.46753337875663, -190.31197696848147, -52.825512793830875, 4.106104403285277, -108.00526479566945, -96.40504442002609, -40.33088091910529, -127.53178580667912, -83.8088340907931, -194.80658970035535, -74.54635957178138, -38.35164902107307, 9.12783782214807, 3.4837985016169437, -22.53405691729675, -87.46831008706828, -33.452808085083774, -61.774393991021434, -182.4962359252923, -32.82498063570803, -179.87870036211785, -84.14423011081483], "episode_lengths": [64, 40, 33, 63, 53, 59, 72, 38, 74, 74, 84, 87, 52, 84, 30, 57, 74, 58, 48, 67, 77, 71, 58, 73, 79, 52, 78, 33, 46, 57, 84, 66, 47, 94, 44, 35, 78, 63, 38, 68, 39, 60, 81, 66, 64, 50, 30, 66, 59, 46, 57, 74, 40, 72, 56, 50, 60, 77, 64, 60, 77, 80, 77, 34, 73, 57, 79, 57, 69, 94, 58, 83, 85, 60, 79, 67, 58, 82, 87, 93, 59, 38, 79, 71, 57, 82, 67, 95, 65, 57, 40, 42, 48, 69, 50, 60, 90, 53, 88, 66], "policy_policy_0_reward": [-44.308797311484355, 6.532283825092843, 18.531110282281123, -51.490042779093464, -36.89293496473782, -24.20929259500464, -99.50401842418123, 6.65010147098731, -112.5449277815979, -79.03533860701674, -135.18187624912878, -172.20863029644477, -3.481435204163816, -145.37583685647587, 19.6151218523227, -42.34692233397009, -106.43156745033745, -51.20412902138311, -21.850228624396255, -81.77356230877285, -122.38805776377862, -99.19181996532377, -59.2048062453934, -110.72353418170704, -131.0720630529169, -37.537744194086144, -127.09292960938232, 12.840520578714635, -1.2632025994436251, -49.74344307329004, -159.4687414869356, -79.50035105404883, -18.18770494064893, -190.60724100027133, 0.24318298223816037, 13.209874808109655, -71.37941395736217, -70.80972972688802, 10.556459573868192, -65.4817733838444, -4.938238754360331, -62.54342457667596, -123.54653223533566, -78.65041664713304, -58.924211181137025, -13.788543405186854, 11.221991025767828, -63.10015634415849, -28.063416683515076, -21.411906205244918, -29.900551314764545, -114.71983779042057, -4.780417008220473, -106.5094224710996, -15.40074751083214, -20.772185839310698, -66.76923166811115, -123.4787543765989, -71.9123723111701, -53.068853092074114, -126.91197720156957, -141.3944872298035, -122.37851615119348, 9.943859342348029, -109.66451539235226, -53.13037453582378, -91.2973502997295, -38.75940491219732, -94.15331299664375, -186.82012366290607, -23.897176752168402, -156.956226980196, -162.32501439011523, -62.30507790185611, -125.71530994307885, -63.03685849975568, -25.90974455177751, -148.7264649871587, -156.46753337875663, -190.31197696848147, -52.825512793830875, 4.106104403285277, -108.00526479566945, -96.40504442002609, -40.33088091910529, -127.53178580667912, -83.8088340907931, -194.80658970035535, -74.54635957178138, -38.35164902107307, 9.12783782214807, 3.4837985016169437, -22.53405691729675, -87.46831008706828, -33.452808085083774, -61.774393991021434, -182.4962359252923, -32.82498063570803, -179.87870036211785, -84.14423011081483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5251667337402491, "mean_inference_ms": 1.5758585988168334, "mean_action_processing_ms": 0.2542303038894163, "mean_env_wait_ms": 3.709687303129077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011486530303955078, "StateBufferConnector_ms": 0.007563114166259766, "ViewRequirementAgentConnector_ms": 0.18290472030639648}, "num_episodes": 64, "episode_return_max": 19.6151218523227, "episode_return_min": -194.80658970035535, "episode_return_mean": -71.1905615395936, "episodes_this_iter": 64}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.1410922253807, "num_env_steps_trained_throughput_per_sec": 330.1410922253807, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 12285.191, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12285.116, "sample_time_ms": 1350.18, "learn_time_ms": 10872.656, "learn_throughput": 367.895, "synch_weights_time_ms": 61.401}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "8adec_00000", "date": "2024-07-24_15-13-55", "timestamp": 1721814235, "time_this_iter_s": 12.128095865249634, "time_total_s": 703.553601026535, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 703.553601026535, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.776470588235295, "ram_util_percent": 37.911764705882355}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.14183559566736, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.19950576253080118, "policy_loss": -0.006354105312008566, "vf_loss": 0.19176594738382846, "vf_explained_var": 0.9996596978977322, "kl": 0.012327856185144507, "entropy": -0.16119649240523964, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 23.464571292782495, "episode_reward_min": -210.09822410086576, "episode_reward_mean": -70.8898445517246, "episode_len_mean": 63.36, "episode_media": {}, "episodes_timesteps_total": 6336, "policy_reward_min": {"policy_0": -210.09822410086576}, "policy_reward_max": {"policy_0": 23.464571292782495}, "policy_reward_mean": {"policy_0": -70.8898445517246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-91.2973502997295, -38.75940491219732, -94.15331299664375, -186.82012366290607, -23.897176752168402, -156.956226980196, -162.32501439011523, -62.30507790185611, -125.71530994307885, -63.03685849975568, -25.90974455177751, -148.7264649871587, -156.46753337875663, -190.31197696848147, -52.825512793830875, 4.106104403285277, -108.00526479566945, -96.40504442002609, -40.33088091910529, -127.53178580667912, -83.8088340907931, -194.80658970035535, -74.54635957178138, -38.35164902107307, 9.12783782214807, 3.4837985016169437, -22.53405691729675, -87.46831008706828, -33.452808085083774, -61.774393991021434, -182.4962359252923, -32.82498063570803, -179.87870036211785, -84.14423011081483, -19.103782722137186, -120.22696612719515, -95.57783841231947, -37.75414230786525, 2.7739656435660143, -198.96106061000575, -88.66020590064211, -97.59954818509405, -131.26472841885624, -143.8781137684586, -46.257470079267826, 12.496961959214703, -55.742833813287774, -125.91682501401772, 8.840734131103446, -7.150872524932268, -25.79532054515272, -78.8591302008683, -43.08065537917398, -45.514989647024954, -46.76255252449829, 15.015125069370544, 18.651981393752568, -66.57510521467555, -105.64322068702428, -148.92346964141836, 6.369173837995684, -84.81517188225783, -122.14446966435342, 9.24755107734682, 3.2516290432492587, -60.403543108791055, 21.52515424924248, -98.19801961386206, -59.00670476712479, 23.464571292782495, -111.61556832996826, -87.49173695000138, -90.26804032685237, -68.14636929632984, -83.17368719089201, -15.78463467110404, -97.28220414593869, 14.644708283902387, -30.949738787089174, -86.98815773015409, 9.875187868961596, 3.12872224375165, -100.21506626924001, -5.8145085647886345, -47.89392272408863, 7.537983034802545, -61.60544082099534, -128.33651849240073, -105.16591528212166, 6.429742902111147, -129.39989665367406, -0.38738939931233163, -139.96541747324034, -143.29206982511852, -210.09822410086576, -72.15205540899836, -44.47166317118954, -92.64275327373927, -69.54057387408022, -64.58988094963793], "episode_lengths": [79, 57, 69, 94, 58, 83, 85, 60, 79, 67, 58, 82, 87, 93, 59, 38, 79, 71, 57, 82, 67, 95, 65, 57, 40, 42, 48, 69, 50, 60, 90, 53, 88, 66, 51, 76, 71, 62, 44, 93, 69, 70, 78, 86, 62, 32, 67, 82, 42, 45, 48, 68, 53, 61, 53, 33, 32, 70, 72, 82, 38, 69, 78, 36, 41, 62, 28, 70, 60, 28, 73, 69, 79, 68, 66, 47, 70, 39, 55, 67, 32, 42, 72, 47, 55, 35, 61, 78, 72, 45, 77, 45, 81, 83, 95, 71, 57, 85, 72, 59], "policy_policy_0_reward": [-91.2973502997295, -38.75940491219732, -94.15331299664375, -186.82012366290607, -23.897176752168402, -156.956226980196, -162.32501439011523, -62.30507790185611, -125.71530994307885, -63.03685849975568, -25.90974455177751, -148.7264649871587, -156.46753337875663, -190.31197696848147, -52.825512793830875, 4.106104403285277, -108.00526479566945, -96.40504442002609, -40.33088091910529, -127.53178580667912, -83.8088340907931, -194.80658970035535, -74.54635957178138, -38.35164902107307, 9.12783782214807, 3.4837985016169437, -22.53405691729675, -87.46831008706828, -33.452808085083774, -61.774393991021434, -182.4962359252923, -32.82498063570803, -179.87870036211785, -84.14423011081483, -19.103782722137186, -120.22696612719515, -95.57783841231947, -37.75414230786525, 2.7739656435660143, -198.96106061000575, -88.66020590064211, -97.59954818509405, -131.26472841885624, -143.8781137684586, -46.257470079267826, 12.496961959214703, -55.742833813287774, -125.91682501401772, 8.840734131103446, -7.150872524932268, -25.79532054515272, -78.8591302008683, -43.08065537917398, -45.514989647024954, -46.76255252449829, 15.015125069370544, 18.651981393752568, -66.57510521467555, -105.64322068702428, -148.92346964141836, 6.369173837995684, -84.81517188225783, -122.14446966435342, 9.24755107734682, 3.2516290432492587, -60.403543108791055, 21.52515424924248, -98.19801961386206, -59.00670476712479, 23.464571292782495, -111.61556832996826, -87.49173695000138, -90.26804032685237, -68.14636929632984, -83.17368719089201, -15.78463467110404, -97.28220414593869, 14.644708283902387, -30.949738787089174, -86.98815773015409, 9.875187868961596, 3.12872224375165, -100.21506626924001, -5.8145085647886345, -47.89392272408863, 7.537983034802545, -61.60544082099534, -128.33651849240073, -105.16591528212166, 6.429742902111147, -129.39989665367406, -0.38738939931233163, -139.96541747324034, -143.29206982511852, -210.09822410086576, -72.15205540899836, -44.47166317118954, -92.64275327373927, -69.54057387408022, -64.58988094963793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525633150972799, "mean_inference_ms": 1.5782487518335433, "mean_action_processing_ms": 0.25446310078415724, "mean_env_wait_ms": 3.717335957284194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012173891067504883, "StateBufferConnector_ms": 0.007750272750854492, "ViewRequirementAgentConnector_ms": 0.18382954597473145}, "num_episodes": 66, "episode_return_max": 23.464571292782495, "episode_return_min": -210.09822410086576, "episode_return_mean": -70.8898445517246, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.0324454526946, "num_env_steps_trained_throughput_per_sec": 329.0324454526946, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 12208.231, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12208.156, "sample_time_ms": 1358.023, "learn_time_ms": 10788.398, "learn_throughput": 370.769, "synch_weights_time_ms": 60.86}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "8adec_00000", "date": "2024-07-24_15-14-07", "timestamp": 1721814247, "time_this_iter_s": 12.166863203048706, "time_total_s": 715.7204642295837, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 715.7204642295837, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 20.238888888888887, "ram_util_percent": 37.844444444444434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.003404192626476, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.15135867298619513, "policy_loss": -0.0055177917844654685, "vf_loss": 0.1405908847072472, "vf_explained_var": 0.9997534760584433, "kl": 0.014321167259428573, "entropy": -0.17853979440114925, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": 23.464571292782495, "episode_reward_min": -210.09822410086576, "episode_reward_mean": -55.778501857185994, "episode_len_mean": 59.01, "episode_media": {}, "episodes_timesteps_total": 5901, "policy_reward_min": {"policy_0": -210.09822410086576}, "policy_reward_max": {"policy_0": 23.464571292782495}, "policy_reward_mean": {"policy_0": -55.778501857185994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.00670476712479, 23.464571292782495, -111.61556832996826, -87.49173695000138, -90.26804032685237, -68.14636929632984, -83.17368719089201, -15.78463467110404, -97.28220414593869, 14.644708283902387, -30.949738787089174, -86.98815773015409, 9.875187868961596, 3.12872224375165, -100.21506626924001, -5.8145085647886345, -47.89392272408863, 7.537983034802545, -61.60544082099534, -128.33651849240073, -105.16591528212166, 6.429742902111147, -129.39989665367406, -0.38738939931233163, -139.96541747324034, -143.29206982511852, -210.09822410086576, -72.15205540899836, -44.47166317118954, -92.64275327373927, -69.54057387408022, -64.58988094963793, 2.1779644051002345, -20.251404682217004, -118.10795959676422, -67.60556811729217, -81.78964825177562, -43.331216642506504, 14.530568728698062, 3.743353039502537, -87.67638925509969, 20.31596346311116, 2.4181422367184484, -66.66814684035877, -75.94358734727113, -110.14366990646211, -38.48986090459375, -92.94433984574019, 12.108918567365649, -207.72990008390704, 13.301301503341755, -121.48021976946909, -112.54395188186963, -15.02357599363422, -39.12773156559968, -133.8892758128299, -35.136839146009635, 11.764042105063638, -0.37579219406930253, -154.7291355965263, -59.48593301269223, -93.0382367383816, -76.9746164981739, -13.351076024590597, -122.36706897482497, 15.654353722940892, -112.72314012217282, -83.74208890282722, -37.830424370690785, -95.31347122777572, -123.26619140697704, -69.28586235648177, -50.247898397025466, 8.382718132073245, -8.05120058073059, -118.02978119131234, -123.3300181596804, 17.26018261104968, -8.043485019139476, -107.6720590710529, 3.2319832210447816, -62.76331306180639, 7.614565477572597, 11.35663257240177, -50.35080563672072, -26.96889304833891, -6.831436764517462, -8.897426605263949, 21.954487847837044, -83.36835985730399, -30.092154423153247, -46.87589260597101, -8.003549369355735, -6.146139248009771, 10.273155466324127, -103.19529623389492, -70.73482163824619, 7.355342001291584, -91.5459963589171, -158.5817876273774], "episode_lengths": [60, 28, 73, 69, 79, 68, 66, 47, 70, 39, 55, 67, 32, 42, 72, 47, 55, 35, 61, 78, 72, 45, 77, 45, 81, 83, 95, 71, 57, 85, 72, 59, 38, 44, 76, 63, 68, 60, 34, 37, 80, 30, 45, 61, 66, 74, 52, 73, 34, 94, 31, 76, 76, 49, 61, 78, 60, 31, 40, 84, 59, 72, 72, 45, 76, 39, 73, 66, 59, 72, 81, 62, 55, 34, 52, 79, 81, 32, 51, 72, 44, 60, 36, 35, 65, 53, 39, 46, 30, 68, 53, 57, 48, 49, 40, 73, 76, 43, 70, 84], "policy_policy_0_reward": [-59.00670476712479, 23.464571292782495, -111.61556832996826, -87.49173695000138, -90.26804032685237, -68.14636929632984, -83.17368719089201, -15.78463467110404, -97.28220414593869, 14.644708283902387, -30.949738787089174, -86.98815773015409, 9.875187868961596, 3.12872224375165, -100.21506626924001, -5.8145085647886345, -47.89392272408863, 7.537983034802545, -61.60544082099534, -128.33651849240073, -105.16591528212166, 6.429742902111147, -129.39989665367406, -0.38738939931233163, -139.96541747324034, -143.29206982511852, -210.09822410086576, -72.15205540899836, -44.47166317118954, -92.64275327373927, -69.54057387408022, -64.58988094963793, 2.1779644051002345, -20.251404682217004, -118.10795959676422, -67.60556811729217, -81.78964825177562, -43.331216642506504, 14.530568728698062, 3.743353039502537, -87.67638925509969, 20.31596346311116, 2.4181422367184484, -66.66814684035877, -75.94358734727113, -110.14366990646211, -38.48986090459375, -92.94433984574019, 12.108918567365649, -207.72990008390704, 13.301301503341755, -121.48021976946909, -112.54395188186963, -15.02357599363422, -39.12773156559968, -133.8892758128299, -35.136839146009635, 11.764042105063638, -0.37579219406930253, -154.7291355965263, -59.48593301269223, -93.0382367383816, -76.9746164981739, -13.351076024590597, -122.36706897482497, 15.654353722940892, -112.72314012217282, -83.74208890282722, -37.830424370690785, -95.31347122777572, -123.26619140697704, -69.28586235648177, -50.247898397025466, 8.382718132073245, -8.05120058073059, -118.02978119131234, -123.3300181596804, 17.26018261104968, -8.043485019139476, -107.6720590710529, 3.2319832210447816, -62.76331306180639, 7.614565477572597, 11.35663257240177, -50.35080563672072, -26.96889304833891, -6.831436764517462, -8.897426605263949, 21.954487847837044, -83.36835985730399, -30.092154423153247, -46.87589260597101, -8.003549369355735, -6.146139248009771, 10.273155466324127, -103.19529623389492, -70.73482163824619, 7.355342001291584, -91.5459963589171, -158.5817876273774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5259687573236836, "mean_inference_ms": 1.5781846917436304, "mean_action_processing_ms": 0.25448111092535375, "mean_env_wait_ms": 3.7210935461996177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011194944381713867, "StateBufferConnector_ms": 0.007283449172973633, "ViewRequirementAgentConnector_ms": 0.17601656913757324}, "num_episodes": 68, "episode_return_max": 23.464571292782495, "episode_return_min": -210.09822410086576, "episode_return_mean": -55.778501857185994, "episodes_this_iter": 68}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.74828228680934, "num_env_steps_trained_throughput_per_sec": 340.74828228680934, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 12104.246, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12104.171, "sample_time_ms": 1356.319, "learn_time_ms": 10686.988, "learn_throughput": 374.287, "synch_weights_time_ms": 59.991}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "8adec_00000", "date": "2024-07-24_15-14-19", "timestamp": 1721814259, "time_this_iter_s": 11.750099420547485, "time_total_s": 727.4705636501312, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 727.4705636501312, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 21.15625, "ram_util_percent": 37.849999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.521459045509495, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.17106130799948005, "policy_loss": -0.004132223641499877, "vf_loss": 0.16126956719284255, "vf_explained_var": 0.9997332780311505, "kl": 0.011898110297761378, "entropy": -0.18771274824393913, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 21.954487847837044, "episode_reward_min": -221.5992430867259, "episode_reward_mean": -62.853264654364054, "episode_len_mean": 61.29, "episode_media": {}, "episodes_timesteps_total": 6129, "policy_reward_min": {"policy_0": -221.5992430867259}, "policy_reward_max": {"policy_0": 21.954487847837044}, "policy_reward_mean": {"policy_0": -62.853264654364054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.351076024590597, -122.36706897482497, 15.654353722940892, -112.72314012217282, -83.74208890282722, -37.830424370690785, -95.31347122777572, -123.26619140697704, -69.28586235648177, -50.247898397025466, 8.382718132073245, -8.05120058073059, -118.02978119131234, -123.3300181596804, 17.26018261104968, -8.043485019139476, -107.6720590710529, 3.2319832210447816, -62.76331306180639, 7.614565477572597, 11.35663257240177, -50.35080563672072, -26.96889304833891, -6.831436764517462, -8.897426605263949, 21.954487847837044, -83.36835985730399, -30.092154423153247, -46.87589260597101, -8.003549369355735, -6.146139248009771, 10.273155466324127, -103.19529623389492, -70.73482163824619, 7.355342001291584, -91.5459963589171, -158.5817876273774, -115.05439154910256, -84.19744057370436, -42.51453619069457, -24.64732485157512, -30.64307053590533, -46.103116330912, -32.40874614733788, -130.76037608717823, -126.09659967313844, -98.61054196412493, -108.84255300902439, -42.974097053937065, -11.843263623760333, -73.7055626147224, -2.7114254789534806, -61.586250391251944, -109.79386384303314, -221.5992430867259, -121.16544970599574, 3.9088986718426786, -142.84239948794416, -104.95133215135704, -133.41761861051782, -104.93564465178399, -138.51982114222199, -196.51640706298423, -100.4984130455224, -1.7743509520621326, -192.24723961732582, 9.894691699257477, -3.1784901888997785, -2.3807935659285286, -122.32128638016809, -136.8202985816552, -33.8335108302767, -14.230076536575737, -64.55584788263639, -209.14139803998447, -32.525133277262476, -26.014936394409233, -40.435937361878665, -52.271908536188434, -4.232015239643442, -141.17118508289633, -44.75421209545454, -42.83435298916172, -72.8449604987998, -70.34639959880526, -125.08476427440037, 2.117248687785664, -154.09185840453378, -70.86372241119071, -16.375733657087746, -85.63422445410299, 1.4709476488497903, 19.67833515827109, -191.90796056199522, -71.3782736733182, -9.752502248658134, -86.68509572343257, -23.295704807744222, -6.249494579159397, -41.697212761743394], "episode_lengths": [45, 76, 39, 73, 66, 59, 72, 81, 62, 55, 34, 52, 79, 81, 32, 51, 72, 44, 60, 36, 35, 65, 53, 39, 46, 30, 68, 53, 57, 48, 49, 40, 73, 76, 43, 70, 84, 76, 66, 54, 52, 60, 54, 60, 78, 76, 70, 77, 55, 52, 73, 46, 58, 75, 98, 77, 34, 80, 75, 78, 72, 80, 96, 73, 49, 91, 39, 43, 42, 78, 80, 56, 42, 63, 97, 59, 51, 56, 59, 41, 81, 54, 52, 63, 65, 77, 36, 83, 68, 56, 78, 46, 32, 95, 74, 44, 71, 57, 46, 62], "policy_policy_0_reward": [-13.351076024590597, -122.36706897482497, 15.654353722940892, -112.72314012217282, -83.74208890282722, -37.830424370690785, -95.31347122777572, -123.26619140697704, -69.28586235648177, -50.247898397025466, 8.382718132073245, -8.05120058073059, -118.02978119131234, -123.3300181596804, 17.26018261104968, -8.043485019139476, -107.6720590710529, 3.2319832210447816, -62.76331306180639, 7.614565477572597, 11.35663257240177, -50.35080563672072, -26.96889304833891, -6.831436764517462, -8.897426605263949, 21.954487847837044, -83.36835985730399, -30.092154423153247, -46.87589260597101, -8.003549369355735, -6.146139248009771, 10.273155466324127, -103.19529623389492, -70.73482163824619, 7.355342001291584, -91.5459963589171, -158.5817876273774, -115.05439154910256, -84.19744057370436, -42.51453619069457, -24.64732485157512, -30.64307053590533, -46.103116330912, -32.40874614733788, -130.76037608717823, -126.09659967313844, -98.61054196412493, -108.84255300902439, -42.974097053937065, -11.843263623760333, -73.7055626147224, -2.7114254789534806, -61.586250391251944, -109.79386384303314, -221.5992430867259, -121.16544970599574, 3.9088986718426786, -142.84239948794416, -104.95133215135704, -133.41761861051782, -104.93564465178399, -138.51982114222199, -196.51640706298423, -100.4984130455224, -1.7743509520621326, -192.24723961732582, 9.894691699257477, -3.1784901888997785, -2.3807935659285286, -122.32128638016809, -136.8202985816552, -33.8335108302767, -14.230076536575737, -64.55584788263639, -209.14139803998447, -32.525133277262476, -26.014936394409233, -40.435937361878665, -52.271908536188434, -4.232015239643442, -141.17118508289633, -44.75421209545454, -42.83435298916172, -72.8449604987998, -70.34639959880526, -125.08476427440037, 2.117248687785664, -154.09185840453378, -70.86372241119071, -16.375733657087746, -85.63422445410299, 1.4709476488497903, 19.67833515827109, -191.90796056199522, -71.3782736733182, -9.752502248658134, -86.68509572343257, -23.295704807744222, -6.249494579159397, -41.697212761743394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258546810096449, "mean_inference_ms": 1.5767064427242194, "mean_action_processing_ms": 0.254459222872879, "mean_env_wait_ms": 3.721803314635173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011009693145751953, "StateBufferConnector_ms": 0.0073947906494140625, "ViewRequirementAgentConnector_ms": 0.17780375480651855}, "num_episodes": 63, "episode_return_max": 21.954487847837044, "episode_return_min": -221.5992430867259, "episode_return_mean": -62.853264654364054, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.09688303012825, "num_env_steps_trained_throughput_per_sec": 325.09688303012825, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 12116.239, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12116.164, "sample_time_ms": 1356.631, "learn_time_ms": 10701.177, "learn_throughput": 373.791, "synch_weights_time_ms": 57.508}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "8adec_00000", "date": "2024-07-24_15-14-31", "timestamp": 1721814271, "time_this_iter_s": 12.314536809921265, "time_total_s": 739.7851004600525, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 739.7851004600525, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 19.005555555555553, "ram_util_percent": 37.85555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.41840258439382, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.19949861135488997, "policy_loss": -0.0038670174724150757, "vf_loss": 0.18948089813347907, "vf_explained_var": 0.9996883746857445, "kl": 0.011846357588122731, "entropy": -0.18902925718963767, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": 23.37463546839196, "episode_reward_min": -215.36750950047912, "episode_reward_mean": -61.15264146109341, "episode_len_mean": 61.01, "episode_media": {}, "episodes_timesteps_total": 6101, "policy_reward_min": {"policy_0": -215.36750950047912}, "policy_reward_max": {"policy_0": 23.37463546839196}, "policy_reward_mean": {"policy_0": -61.15264146109341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.894691699257477, -3.1784901888997785, -2.3807935659285286, -122.32128638016809, -136.8202985816552, -33.8335108302767, -14.230076536575737, -64.55584788263639, -209.14139803998447, -32.525133277262476, -26.014936394409233, -40.435937361878665, -52.271908536188434, -4.232015239643442, -141.17118508289633, -44.75421209545454, -42.83435298916172, -72.8449604987998, -70.34639959880526, -125.08476427440037, 2.117248687785664, -154.09185840453378, -70.86372241119071, -16.375733657087746, -85.63422445410299, 1.4709476488497903, 19.67833515827109, -191.90796056199522, -71.3782736733182, -9.752502248658134, -86.68509572343257, -23.295704807744222, -6.249494579159397, -41.697212761743394, -215.36750950047912, -28.97720753151329, -104.10192910613739, -24.0649820941903, -119.89241443264802, -68.42163431526961, 7.2550282077459345, -91.44132033444, -9.738890858120588, 15.943870020459492, -42.055200052168146, -48.85206174496006, -58.096154455761095, -89.58773235173474, -151.38290998903506, -101.71664983959529, -36.26258025148812, 4.804264236189115, -33.59200134085379, 3.854429478432017, -2.4072616570540077, -32.157410376549706, -89.42809297790784, -37.020538326566474, 2.8791603272914483, -2.5296460936394203, -68.17644972305935, 10.7959819971884, -17.187667968368395, -43.058643616008894, -113.34613935013765, -86.49932407981473, -132.94907558304865, -41.66868783692918, -116.19824777940264, -151.42311254144923, -147.07694311646873, -94.97364542200403, -83.56921282947148, 1.985228476342906, -30.520568365986072, 4.273441200049462, -76.96688201670099, 8.89563515139418, -8.766122611149111, -76.54564349087516, -63.485778003535934, -6.276969094897545, -18.234673830559665, -64.18156234627065, -85.2837770648903, 10.153456902857824, -129.03685957481738, -111.48093679139531, -67.59569845561, -144.9971505894819, 23.37463546839196, -52.776714360968576, -207.670952574865, -12.727815767100518, -115.52278191210246, -101.61612139136837, -136.59243875789633, -52.03028738748272, -202.72803417655155, 2.5278359089244984], "episode_lengths": [39, 43, 42, 78, 80, 56, 42, 63, 97, 59, 51, 56, 59, 41, 81, 54, 52, 63, 65, 77, 36, 83, 68, 56, 78, 46, 32, 95, 74, 44, 71, 57, 46, 62, 96, 51, 74, 58, 76, 63, 36, 79, 41, 29, 59, 62, 62, 69, 86, 72, 60, 43, 53, 48, 45, 56, 81, 61, 46, 44, 64, 31, 57, 54, 74, 78, 79, 54, 75, 85, 82, 70, 66, 39, 57, 37, 72, 32, 49, 67, 64, 40, 52, 68, 78, 37, 79, 75, 65, 80, 27, 57, 95, 46, 76, 72, 80, 58, 94, 40], "policy_policy_0_reward": [9.894691699257477, -3.1784901888997785, -2.3807935659285286, -122.32128638016809, -136.8202985816552, -33.8335108302767, -14.230076536575737, -64.55584788263639, -209.14139803998447, -32.525133277262476, -26.014936394409233, -40.435937361878665, -52.271908536188434, -4.232015239643442, -141.17118508289633, -44.75421209545454, -42.83435298916172, -72.8449604987998, -70.34639959880526, -125.08476427440037, 2.117248687785664, -154.09185840453378, -70.86372241119071, -16.375733657087746, -85.63422445410299, 1.4709476488497903, 19.67833515827109, -191.90796056199522, -71.3782736733182, -9.752502248658134, -86.68509572343257, -23.295704807744222, -6.249494579159397, -41.697212761743394, -215.36750950047912, -28.97720753151329, -104.10192910613739, -24.0649820941903, -119.89241443264802, -68.42163431526961, 7.2550282077459345, -91.44132033444, -9.738890858120588, 15.943870020459492, -42.055200052168146, -48.85206174496006, -58.096154455761095, -89.58773235173474, -151.38290998903506, -101.71664983959529, -36.26258025148812, 4.804264236189115, -33.59200134085379, 3.854429478432017, -2.4072616570540077, -32.157410376549706, -89.42809297790784, -37.020538326566474, 2.8791603272914483, -2.5296460936394203, -68.17644972305935, 10.7959819971884, -17.187667968368395, -43.058643616008894, -113.34613935013765, -86.49932407981473, -132.94907558304865, -41.66868783692918, -116.19824777940264, -151.42311254144923, -147.07694311646873, -94.97364542200403, -83.56921282947148, 1.985228476342906, -30.520568365986072, 4.273441200049462, -76.96688201670099, 8.89563515139418, -8.766122611149111, -76.54564349087516, -63.485778003535934, -6.276969094897545, -18.234673830559665, -64.18156234627065, -85.2837770648903, 10.153456902857824, -129.03685957481738, -111.48093679139531, -67.59569845561, -144.9971505894819, 23.37463546839196, -52.776714360968576, -207.670952574865, -12.727815767100518, -115.52278191210246, -101.61612139136837, -136.59243875789633, -52.03028738748272, -202.72803417655155, 2.5278359089244984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5252537709045428, "mean_inference_ms": 1.5753211871445867, "mean_action_processing_ms": 0.254229768400063, "mean_env_wait_ms": 3.7218856084758194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011210918426513672, "StateBufferConnector_ms": 0.007588624954223633, "ViewRequirementAgentConnector_ms": 0.17929410934448242}, "num_episodes": 66, "episode_return_max": 23.37463546839196, "episode_return_min": -215.36750950047912, "episode_return_mean": -61.15264146109341, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.2041925349958, "num_env_steps_trained_throughput_per_sec": 325.2041925349958, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 12023.775, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12023.7, "sample_time_ms": 1356.52, "learn_time_ms": 10609.002, "learn_throughput": 377.038, "synch_weights_time_ms": 57.377}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "8adec_00000", "date": "2024-07-24_15-14-44", "timestamp": 1721814284, "time_this_iter_s": 12.310051679611206, "time_total_s": 752.0951521396637, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 752.0951521396637, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 19.517647058823528, "ram_util_percent": 38.03529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.1196014041702, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.20282997600879754, "policy_loss": -0.0007949637326722344, "vf_loss": 0.18640208375484993, "vf_explained_var": 0.9996860494216283, "kl": 0.014747807732298251, "entropy": -0.2290699921635678, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 23.37463546839196, "episode_reward_min": -215.91541462420508, "episode_reward_mean": -71.02702486210664, "episode_len_mean": 63.5, "episode_media": {}, "episodes_timesteps_total": 6350, "policy_reward_min": {"policy_0": -215.91541462420508}, "policy_reward_max": {"policy_0": 23.37463546839196}, "policy_reward_mean": {"policy_0": -71.02702486210664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.34613935013765, -86.49932407981473, -132.94907558304865, -41.66868783692918, -116.19824777940264, -151.42311254144923, -147.07694311646873, -94.97364542200403, -83.56921282947148, 1.985228476342906, -30.520568365986072, 4.273441200049462, -76.96688201670099, 8.89563515139418, -8.766122611149111, -76.54564349087516, -63.485778003535934, -6.276969094897545, -18.234673830559665, -64.18156234627065, -85.2837770648903, 10.153456902857824, -129.03685957481738, -111.48093679139531, -67.59569845561, -144.9971505894819, 23.37463546839196, -52.776714360968576, -207.670952574865, -12.727815767100518, -115.52278191210246, -101.61612139136837, -136.59243875789633, -52.03028738748272, -202.72803417655155, 2.5278359089244984, -118.09025429464712, -6.503176191198228, 17.95850167256629, -135.06941519410663, 16.507005048372996, 6.854673430116238, 12.961761564895335, 12.516741438363644, -43.47522630613921, -37.560645344743406, -65.81738808871968, 1.274452545523912, -116.46873439806274, -1.0122901355257088, -137.24359449702047, -176.3111400919628, -155.4853367570005, -61.949793872040544, -50.0098805774138, -131.89141123145424, -10.62975616004759, -45.36132572036358, -21.790928659334444, -44.214903405479376, -16.56347749955669, -84.93879641858918, -57.24002723618394, -99.11286672616808, -55.208969506728266, -69.44382763660697, -140.23909634618605, -88.467480170343, -83.80214265567166, -187.2621107765277, -27.19678178458581, -72.95906279422138, 6.137583043816894, -64.85765898163318, -170.2961614302535, -109.32026180209476, -163.12021492558412, -15.139103427363672, 7.792955118362095, -172.52089471318072, -41.76886463464954, -82.33901185095989, -43.77920592201848, -86.55977437652389, -33.38765362911603, 5.290129352228574, -215.91541462420508, -72.50703429554868, -24.50436432024133, -178.2817184631888, -25.22463114149719, -22.078180672010735, -70.38384156642164, -162.2928668315682, -101.04149278193749, -56.918575119270265, -90.51332551534429, -74.75039279931364, -51.8444526361183, -37.79942849296628], "episode_lengths": [74, 78, 79, 54, 75, 85, 82, 70, 66, 39, 57, 37, 72, 32, 49, 67, 64, 40, 52, 68, 78, 37, 79, 75, 65, 80, 27, 57, 95, 46, 76, 72, 80, 58, 94, 40, 83, 42, 36, 80, 37, 36, 38, 37, 61, 55, 67, 42, 81, 41, 80, 89, 89, 62, 55, 80, 47, 59, 50, 62, 54, 70, 62, 82, 60, 62, 82, 68, 66, 89, 53, 64, 42, 60, 88, 76, 86, 48, 42, 89, 63, 66, 55, 75, 50, 43, 97, 62, 49, 88, 51, 58, 68, 85, 78, 60, 77, 65, 59, 50], "policy_policy_0_reward": [-113.34613935013765, -86.49932407981473, -132.94907558304865, -41.66868783692918, -116.19824777940264, -151.42311254144923, -147.07694311646873, -94.97364542200403, -83.56921282947148, 1.985228476342906, -30.520568365986072, 4.273441200049462, -76.96688201670099, 8.89563515139418, -8.766122611149111, -76.54564349087516, -63.485778003535934, -6.276969094897545, -18.234673830559665, -64.18156234627065, -85.2837770648903, 10.153456902857824, -129.03685957481738, -111.48093679139531, -67.59569845561, -144.9971505894819, 23.37463546839196, -52.776714360968576, -207.670952574865, -12.727815767100518, -115.52278191210246, -101.61612139136837, -136.59243875789633, -52.03028738748272, -202.72803417655155, 2.5278359089244984, -118.09025429464712, -6.503176191198228, 17.95850167256629, -135.06941519410663, 16.507005048372996, 6.854673430116238, 12.961761564895335, 12.516741438363644, -43.47522630613921, -37.560645344743406, -65.81738808871968, 1.274452545523912, -116.46873439806274, -1.0122901355257088, -137.24359449702047, -176.3111400919628, -155.4853367570005, -61.949793872040544, -50.0098805774138, -131.89141123145424, -10.62975616004759, -45.36132572036358, -21.790928659334444, -44.214903405479376, -16.56347749955669, -84.93879641858918, -57.24002723618394, -99.11286672616808, -55.208969506728266, -69.44382763660697, -140.23909634618605, -88.467480170343, -83.80214265567166, -187.2621107765277, -27.19678178458581, -72.95906279422138, 6.137583043816894, -64.85765898163318, -170.2961614302535, -109.32026180209476, -163.12021492558412, -15.139103427363672, 7.792955118362095, -172.52089471318072, -41.76886463464954, -82.33901185095989, -43.77920592201848, -86.55977437652389, -33.38765362911603, 5.290129352228574, -215.91541462420508, -72.50703429554868, -24.50436432024133, -178.2817184631888, -25.22463114149719, -22.078180672010735, -70.38384156642164, -162.2928668315682, -101.04149278193749, -56.918575119270265, -90.51332551534429, -74.75039279931364, -51.8444526361183, -37.79942849296628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525609287992641, "mean_inference_ms": 1.5742782055731892, "mean_action_processing_ms": 0.25417946600624114, "mean_env_wait_ms": 3.722628722078846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011168241500854492, "StateBufferConnector_ms": 0.007386922836303711, "ViewRequirementAgentConnector_ms": 0.1797008514404297}, "num_episodes": 64, "episode_return_max": 23.37463546839196, "episode_return_min": -215.91541462420508, "episode_return_mean": -71.02702486210664, "episodes_this_iter": 64}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.4092413064218, "num_env_steps_trained_throughput_per_sec": 318.4092413064218, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 12163.196, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12163.122, "sample_time_ms": 1352.547, "learn_time_ms": 10750.972, "learn_throughput": 372.059, "synch_weights_time_ms": 58.783}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "8adec_00000", "date": "2024-07-24_15-14-56", "timestamp": 1721814296, "time_this_iter_s": 12.574530839920044, "time_total_s": 764.6696829795837, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 764.6696829795837, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 19.183333333333334, "ram_util_percent": 38.13888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.31216017305851, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.14475572412241794, "policy_loss": -0.005213899687320615, "vf_loss": 0.1326356237133344, "vf_explained_var": 0.9997722304115693, "kl": 0.014182531042024557, "entropy": -0.2974186889904862, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": 19.536134736665765, "episode_reward_min": -215.91541462420508, "episode_reward_mean": -68.01355359727556, "episode_len_mean": 63.53, "episode_media": {}, "episodes_timesteps_total": 6353, "policy_reward_min": {"policy_0": -215.91541462420508}, "policy_reward_max": {"policy_0": 19.536134736665765}, "policy_reward_mean": {"policy_0": -68.01355359727556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.11286672616808, -55.208969506728266, -69.44382763660697, -140.23909634618605, -88.467480170343, -83.80214265567166, -187.2621107765277, -27.19678178458581, -72.95906279422138, 6.137583043816894, -64.85765898163318, -170.2961614302535, -109.32026180209476, -163.12021492558412, -15.139103427363672, 7.792955118362095, -172.52089471318072, -41.76886463464954, -82.33901185095989, -43.77920592201848, -86.55977437652389, -33.38765362911603, 5.290129352228574, -215.91541462420508, -72.50703429554868, -24.50436432024133, -178.2817184631888, -25.22463114149719, -22.078180672010735, -70.38384156642164, -162.2928668315682, -101.04149278193749, -56.918575119270265, -90.51332551534429, -74.75039279931364, -51.8444526361183, -37.79942849296628, -53.389912791221896, -116.15175309501512, -132.40340466422103, -93.37514568393983, -37.00988024242311, -31.92731241264174, -62.74943749859292, -125.32648763388232, -11.137510639345217, -8.263386494363917, -6.451039607212606, -111.2581942027558, -35.04339091498142, -4.060756473606746, -87.06576569735228, -79.86446452007783, -18.70650279074116, -105.67495426556643, -94.21931667839263, -74.4277815673614, 6.2208321338875425, -108.64504471230637, -45.769408096903696, -90.55822983851407, -48.236262020724396, -53.58351403423828, 0.055843958152230755, -147.57005626145727, -178.16933817808385, -69.61378895950641, -70.63328163640202, -16.682512027694433, -76.96424525905319, -15.783543732007942, -51.74309634720477, 4.935233479076175, -14.960562482244237, -89.04627702244244, -22.123618687645482, -74.75612020457119, -18.34702049092441, -51.72755517564838, -52.78900541875105, 19.536134736665765, -82.41230420077443, 5.392334971494886, -184.87515649424793, -107.51184978110274, -37.67027828330956, -65.73900823719879, -18.59648318579949, 3.4076690958909515, -44.825113809734944, -60.493526429432244, -71.35696672040953, -25.970525985887598, -205.77961794905724, -33.6897954616217, -137.59552776298796, -59.74995815991638, -119.71006012062185, -17.372949238421576, -9.729211986537806], "episode_lengths": [82, 60, 62, 82, 68, 66, 89, 53, 64, 42, 60, 88, 76, 86, 48, 42, 89, 63, 66, 55, 75, 50, 43, 97, 62, 49, 88, 51, 58, 68, 85, 78, 60, 77, 65, 59, 50, 65, 74, 79, 79, 57, 58, 68, 79, 45, 49, 47, 74, 53, 47, 78, 64, 49, 75, 70, 66, 47, 76, 58, 81, 61, 58, 38, 82, 90, 63, 65, 54, 66, 54, 59, 43, 43, 67, 57, 68, 45, 58, 62, 26, 66, 40, 89, 74, 50, 64, 55, 48, 61, 75, 62, 53, 93, 61, 80, 57, 75, 53, 44], "policy_policy_0_reward": [-99.11286672616808, -55.208969506728266, -69.44382763660697, -140.23909634618605, -88.467480170343, -83.80214265567166, -187.2621107765277, -27.19678178458581, -72.95906279422138, 6.137583043816894, -64.85765898163318, -170.2961614302535, -109.32026180209476, -163.12021492558412, -15.139103427363672, 7.792955118362095, -172.52089471318072, -41.76886463464954, -82.33901185095989, -43.77920592201848, -86.55977437652389, -33.38765362911603, 5.290129352228574, -215.91541462420508, -72.50703429554868, -24.50436432024133, -178.2817184631888, -25.22463114149719, -22.078180672010735, -70.38384156642164, -162.2928668315682, -101.04149278193749, -56.918575119270265, -90.51332551534429, -74.75039279931364, -51.8444526361183, -37.79942849296628, -53.389912791221896, -116.15175309501512, -132.40340466422103, -93.37514568393983, -37.00988024242311, -31.92731241264174, -62.74943749859292, -125.32648763388232, -11.137510639345217, -8.263386494363917, -6.451039607212606, -111.2581942027558, -35.04339091498142, -4.060756473606746, -87.06576569735228, -79.86446452007783, -18.70650279074116, -105.67495426556643, -94.21931667839263, -74.4277815673614, 6.2208321338875425, -108.64504471230637, -45.769408096903696, -90.55822983851407, -48.236262020724396, -53.58351403423828, 0.055843958152230755, -147.57005626145727, -178.16933817808385, -69.61378895950641, -70.63328163640202, -16.682512027694433, -76.96424525905319, -15.783543732007942, -51.74309634720477, 4.935233479076175, -14.960562482244237, -89.04627702244244, -22.123618687645482, -74.75612020457119, -18.34702049092441, -51.72755517564838, -52.78900541875105, 19.536134736665765, -82.41230420077443, 5.392334971494886, -184.87515649424793, -107.51184978110274, -37.67027828330956, -65.73900823719879, -18.59648318579949, 3.4076690958909515, -44.825113809734944, -60.493526429432244, -71.35696672040953, -25.970525985887598, -205.77961794905724, -33.6897954616217, -137.59552776298796, -59.74995815991638, -119.71006012062185, -17.372949238421576, -9.729211986537806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255032127758974, "mean_inference_ms": 1.57319005023226, "mean_action_processing_ms": 0.25398324455405663, "mean_env_wait_ms": 3.7219033597484823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011642694473266602, "StateBufferConnector_ms": 0.007493734359741211, "ViewRequirementAgentConnector_ms": 0.18046808242797852}, "num_episodes": 63, "episode_return_max": 19.536134736665765, "episode_return_min": -215.91541462420508, "episode_return_mean": -68.01355359727556, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.63794449036953, "num_env_steps_trained_throughput_per_sec": 387.63794449036953, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 11887.384, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11887.31, "sample_time_ms": 1350.422, "learn_time_ms": 10479.288, "learn_throughput": 381.705, "synch_weights_time_ms": 56.785}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "8adec_00000", "date": "2024-07-24_15-15-07", "timestamp": 1721814307, "time_this_iter_s": 10.330451011657715, "time_total_s": 775.0001339912415, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8caa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 775.0001339912415, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 22.313333333333333, "ram_util_percent": 37.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.566564905146755, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1613682472758228, "policy_loss": -0.007030226772864505, "vf_loss": 0.15246115184854717, "vf_explained_var": 0.999682242795825, "kl": 0.012230700563911038, "entropy": -0.35537376113546393, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 19.536134736665765, "episode_reward_min": -205.77961794905724, "episode_reward_mean": -57.00676738937161, "episode_len_mean": 60.09, "episode_media": {}, "episodes_timesteps_total": 6009, "policy_reward_min": {"policy_0": -205.77961794905724}, "policy_reward_max": {"policy_0": 19.536134736665765}, "policy_reward_mean": {"policy_0": -57.00676738937161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.63328163640202, -16.682512027694433, -76.96424525905319, -15.783543732007942, -51.74309634720477, 4.935233479076175, -14.960562482244237, -89.04627702244244, -22.123618687645482, -74.75612020457119, -18.34702049092441, -51.72755517564838, -52.78900541875105, 19.536134736665765, -82.41230420077443, 5.392334971494886, -184.87515649424793, -107.51184978110274, -37.67027828330956, -65.73900823719879, -18.59648318579949, 3.4076690958909515, -44.825113809734944, -60.493526429432244, -71.35696672040953, -25.970525985887598, -205.77961794905724, -33.6897954616217, -137.59552776298796, -59.74995815991638, -119.71006012062185, -17.372949238421576, -9.729211986537806, -55.10714186439969, -11.51971834877017, -26.243742769423623, -35.5260984825575, -50.221043155352994, -55.108881350454695, -145.60660506410775, -82.62568444622949, -84.50404141464199, -15.773923935014597, -37.149017873432, -24.760381378603753, -23.705018140621732, -111.30969931579669, -67.0520297581421, -140.57178949737576, 16.21420976842382, -43.77613341454578, -91.42198803415826, -41.65263458928744, -5.3445745942399805, -8.684808590976765, -22.693941229550564, 0.8896843220451545, -54.34780050545544, -35.40267969654063, -0.7916422928686457, -5.239918039948016, -96.36196563544341, 11.932326078203062, -67.45006293204293, -127.91558265419039, 1.5349572742875646, -51.16318980276093, -52.743845508009414, -61.26625451858812, -124.75152997734683, -26.108894823853856, -27.50168713736474, -142.07066849483888, -66.61939826816935, 5.256732710970014, 3.3321517932584097, 9.792765192685014, -80.32252838867385, -36.04629030398576, -103.87706609286627, -122.42784221156919, -59.19946718076433, -134.65477650372202, -61.8484432051076, -52.05973022205476, -200.99429859455782, -149.2848916694665, -61.495117464900034, -103.37040242362522, -88.06156973416388, 5.704092628362112, -17.062671811556147, 6.351705194258653, 16.304820331716343, 14.85170890033158, -185.83444564241398, -143.18075199822607, -119.8525793982316, -76.74186482619922, -71.0693379159901], "episode_lengths": [65, 54, 66, 54, 59, 43, 43, 67, 57, 68, 45, 58, 62, 26, 66, 40, 89, 74, 50, 64, 55, 48, 61, 75, 62, 53, 93, 61, 80, 57, 75, 53, 44, 61, 49, 47, 50, 57, 64, 83, 66, 66, 52, 58, 47, 58, 78, 68, 83, 37, 54, 71, 62, 51, 49, 50, 44, 59, 50, 37, 44, 81, 32, 73, 83, 35, 63, 60, 61, 82, 52, 56, 82, 62, 43, 45, 37, 66, 57, 77, 77, 58, 80, 64, 57, 92, 81, 62, 85, 68, 42, 57, 41, 28, 34, 89, 80, 76, 64, 65], "policy_policy_0_reward": [-70.63328163640202, -16.682512027694433, -76.96424525905319, -15.783543732007942, -51.74309634720477, 4.935233479076175, -14.960562482244237, -89.04627702244244, -22.123618687645482, -74.75612020457119, -18.34702049092441, -51.72755517564838, -52.78900541875105, 19.536134736665765, -82.41230420077443, 5.392334971494886, -184.87515649424793, -107.51184978110274, -37.67027828330956, -65.73900823719879, -18.59648318579949, 3.4076690958909515, -44.825113809734944, -60.493526429432244, -71.35696672040953, -25.970525985887598, -205.77961794905724, -33.6897954616217, -137.59552776298796, -59.74995815991638, -119.71006012062185, -17.372949238421576, -9.729211986537806, -55.10714186439969, -11.51971834877017, -26.243742769423623, -35.5260984825575, -50.221043155352994, -55.108881350454695, -145.60660506410775, -82.62568444622949, -84.50404141464199, -15.773923935014597, -37.149017873432, -24.760381378603753, -23.705018140621732, -111.30969931579669, -67.0520297581421, -140.57178949737576, 16.21420976842382, -43.77613341454578, -91.42198803415826, -41.65263458928744, -5.3445745942399805, -8.684808590976765, -22.693941229550564, 0.8896843220451545, -54.34780050545544, -35.40267969654063, -0.7916422928686457, -5.239918039948016, -96.36196563544341, 11.932326078203062, -67.45006293204293, -127.91558265419039, 1.5349572742875646, -51.16318980276093, -52.743845508009414, -61.26625451858812, -124.75152997734683, -26.108894823853856, -27.50168713736474, -142.07066849483888, -66.61939826816935, 5.256732710970014, 3.3321517932584097, 9.792765192685014, -80.32252838867385, -36.04629030398576, -103.87706609286627, -122.42784221156919, -59.19946718076433, -134.65477650372202, -61.8484432051076, -52.05973022205476, -200.99429859455782, -149.2848916694665, -61.495117464900034, -103.37040242362522, -88.06156973416388, 5.704092628362112, -17.062671811556147, 6.351705194258653, 16.304820331716343, 14.85170890033158, -185.83444564241398, -143.18075199822607, -119.8525793982316, -76.74186482619922, -71.0693379159901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258971123913936, "mean_inference_ms": 1.573675143800831, "mean_action_processing_ms": 0.25411835887199263, "mean_env_wait_ms": 3.7262753768469645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011551141738891602, "StateBufferConnector_ms": 0.0075130462646484375, "ViewRequirementAgentConnector_ms": 0.18097186088562012}, "num_episodes": 67, "episode_return_max": 19.536134736665765, "episode_return_min": -205.77961794905724, "episode_return_mean": -57.00676738937161, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.43116071759874, "num_env_steps_trained_throughput_per_sec": 318.43116071759874, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 11856.353, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11856.28, "sample_time_ms": 1350.016, "learn_time_ms": 10447.795, "learn_throughput": 382.856, "synch_weights_time_ms": 57.661}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "8adec_00000", "date": "2024-07-24_15-15-19", "timestamp": 1721814319, "time_this_iter_s": 12.571707725524902, "time_total_s": 787.5718417167664, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8caef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 787.5718417167664, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 19.35, "ram_util_percent": 37.93888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.28187268475691, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.19086688699074633, "policy_loss": -0.0017432809584230805, "vf_loss": 0.172366253961809, "vf_explained_var": 0.999697711567084, "kl": 0.01656987605510949, "entropy": -0.3466913393077751, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": 21.423747480800177, "episode_reward_min": -204.67423656159096, "episode_reward_mean": -63.19262227410712, "episode_len_mean": 61.84, "episode_media": {}, "episodes_timesteps_total": 6184, "policy_reward_min": {"policy_0": -204.67423656159096}, "policy_reward_max": {"policy_0": 21.423747480800177}, "policy_reward_mean": {"policy_0": -63.19262227410712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.16318980276093, -52.743845508009414, -61.26625451858812, -124.75152997734683, -26.108894823853856, -27.50168713736474, -142.07066849483888, -66.61939826816935, 5.256732710970014, 3.3321517932584097, 9.792765192685014, -80.32252838867385, -36.04629030398576, -103.87706609286627, -122.42784221156919, -59.19946718076433, -134.65477650372202, -61.8484432051076, -52.05973022205476, -200.99429859455782, -149.2848916694665, -61.495117464900034, -103.37040242362522, -88.06156973416388, 5.704092628362112, -17.062671811556147, 6.351705194258653, 16.304820331716343, 14.85170890033158, -185.83444564241398, -143.18075199822607, -119.8525793982316, -76.74186482619922, -71.0693379159901, 4.161449876426945, -200.44532920763794, -36.482075968099814, -27.625793254259268, 7.129279865958274, -191.72698247675052, -73.98405561282787, 12.313033528027942, -15.809831338574433, -11.410628990983547, -14.875061310096246, -88.86994102867948, -102.12412888126421, 2.3693791599408787, -137.09024467492685, -128.42568740063865, -22.98174889068768, 16.898163445508143, -80.48213685795376, -43.618209815398245, -120.09204871614492, 0.3070851644374417, -170.13585961364967, -17.60221991512914, -90.47211736513711, -58.20426928017023, -68.84431804753228, -17.209501665870345, -36.73944106644607, -126.53362495225824, -80.09626717505631, -129.22714762326328, 6.442769467445248, -89.03897134094397, -204.67423656159096, -42.06027341883772, -25.33024800204351, -122.45596836195695, -19.52674897816594, -19.353636471335264, -4.973579169958775, -71.09653829355805, -29.436137371611096, -137.97847939439748, -84.69887518208795, -32.569525832019686, -77.54443146720419, -22.681348770633974, 1.9712429080284615, -84.4790693781152, 3.552922179984349, -63.237943774863304, -90.52400404398378, 8.467496460302073, 13.454308718483135, 21.423747480800177, -87.57105685774616, -42.75399340374343, -69.19441783208069, -19.217844170773223, -86.76716690636164, -117.74224474252723, -124.62968149273573, -101.44634078809347, -46.24516072851651, -51.40094443330999], "episode_lengths": [63, 60, 61, 82, 52, 56, 82, 62, 43, 45, 37, 66, 57, 77, 77, 58, 80, 64, 57, 92, 81, 62, 85, 68, 42, 57, 41, 28, 34, 89, 80, 76, 64, 65, 38, 95, 59, 55, 40, 94, 65, 34, 51, 56, 46, 78, 73, 42, 84, 78, 49, 34, 68, 61, 76, 44, 89, 54, 69, 60, 66, 53, 60, 79, 67, 81, 41, 67, 93, 52, 58, 77, 58, 45, 46, 65, 49, 80, 71, 56, 65, 54, 44, 69, 36, 63, 70, 33, 39, 33, 67, 63, 72, 51, 71, 85, 77, 72, 64, 57], "policy_policy_0_reward": [-51.16318980276093, -52.743845508009414, -61.26625451858812, -124.75152997734683, -26.108894823853856, -27.50168713736474, -142.07066849483888, -66.61939826816935, 5.256732710970014, 3.3321517932584097, 9.792765192685014, -80.32252838867385, -36.04629030398576, -103.87706609286627, -122.42784221156919, -59.19946718076433, -134.65477650372202, -61.8484432051076, -52.05973022205476, -200.99429859455782, -149.2848916694665, -61.495117464900034, -103.37040242362522, -88.06156973416388, 5.704092628362112, -17.062671811556147, 6.351705194258653, 16.304820331716343, 14.85170890033158, -185.83444564241398, -143.18075199822607, -119.8525793982316, -76.74186482619922, -71.0693379159901, 4.161449876426945, -200.44532920763794, -36.482075968099814, -27.625793254259268, 7.129279865958274, -191.72698247675052, -73.98405561282787, 12.313033528027942, -15.809831338574433, -11.410628990983547, -14.875061310096246, -88.86994102867948, -102.12412888126421, 2.3693791599408787, -137.09024467492685, -128.42568740063865, -22.98174889068768, 16.898163445508143, -80.48213685795376, -43.618209815398245, -120.09204871614492, 0.3070851644374417, -170.13585961364967, -17.60221991512914, -90.47211736513711, -58.20426928017023, -68.84431804753228, -17.209501665870345, -36.73944106644607, -126.53362495225824, -80.09626717505631, -129.22714762326328, 6.442769467445248, -89.03897134094397, -204.67423656159096, -42.06027341883772, -25.33024800204351, -122.45596836195695, -19.52674897816594, -19.353636471335264, -4.973579169958775, -71.09653829355805, -29.436137371611096, -137.97847939439748, -84.69887518208795, -32.569525832019686, -77.54443146720419, -22.681348770633974, 1.9712429080284615, -84.4790693781152, 3.552922179984349, -63.237943774863304, -90.52400404398378, 8.467496460302073, 13.454308718483135, 21.423747480800177, -87.57105685774616, -42.75399340374343, -69.19441783208069, -19.217844170773223, -86.76716690636164, -117.74224474252723, -124.62968149273573, -101.44634078809347, -46.24516072851651, -51.40094443330999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258314529370763, "mean_inference_ms": 1.5737422638871674, "mean_action_processing_ms": 0.25425138526590585, "mean_env_wait_ms": 3.728792556197712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011193037033081055, "StateBufferConnector_ms": 0.007425546646118164, "ViewRequirementAgentConnector_ms": 0.1794729232788086}, "num_episodes": 66, "episode_return_max": 21.423747480800177, "episode_return_min": -204.67423656159096, "episode_return_mean": -63.19262227410712, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.16505067778536, "num_env_steps_trained_throughput_per_sec": 313.16505067778536, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 11923.494, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11923.422, "sample_time_ms": 1352.078, "learn_time_ms": 10513.779, "learn_throughput": 380.453, "synch_weights_time_ms": 56.756}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "8adec_00000", "date": "2024-07-24_15-15-32", "timestamp": 1721814332, "time_this_iter_s": 12.785538911819458, "time_total_s": 800.3573806285858, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8e8f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 800.3573806285858, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 20.411111111111108, "ram_util_percent": 37.98888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.72668354908625, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.15740076715495283, "policy_loss": -0.0057698485921719115, "vf_loss": 0.1475990527619918, "vf_explained_var": 0.9997428471843401, "kl": 0.012122208775326786, "entropy": -0.3297827237363284, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 21.423747480800177, "episode_reward_min": -204.67423656159096, "episode_reward_mean": -54.741702233666146, "episode_len_mean": 59.8, "episode_media": {}, "episodes_timesteps_total": 5980, "policy_reward_min": {"policy_0": -204.67423656159096}, "policy_reward_max": {"policy_0": 21.423747480800177}, "policy_reward_mean": {"policy_0": -54.741702233666146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.22714762326328, 6.442769467445248, -89.03897134094397, -204.67423656159096, -42.06027341883772, -25.33024800204351, -122.45596836195695, -19.52674897816594, -19.353636471335264, -4.973579169958775, -71.09653829355805, -29.436137371611096, -137.97847939439748, -84.69887518208795, -32.569525832019686, -77.54443146720419, -22.681348770633974, 1.9712429080284615, -84.4790693781152, 3.552922179984349, -63.237943774863304, -90.52400404398378, 8.467496460302073, 13.454308718483135, 21.423747480800177, -87.57105685774616, -42.75399340374343, -69.19441783208069, -19.217844170773223, -86.76716690636164, -117.74224474252723, -124.62968149273573, -101.44634078809347, -46.24516072851651, -51.40094443330999, -86.95874855902616, -15.974434877148822, -95.6205365453476, -80.37611174139676, -2.5341181441908245, -73.05099653739762, -150.9768183821153, -150.12808083162562, -70.4427999058816, -154.5162706969743, -34.58345907888046, -76.77454374778699, -2.1814716854673586, -50.051951729235896, -69.17666696212403, 18.01073221044407, -61.70397577993942, -53.36064299688674, 1.5045624825643014, -109.44904717814579, 14.4952913198321, -138.53063799562133, -154.55646720051914, -68.17300214505825, -17.596038278538927, -4.961087205583893, -39.93288117172364, -76.64164986918146, -33.72044589052867, -9.84670374709859, -49.30636994379858, -190.86974859050602, -66.0840367018148, -15.073580003939048, -73.78273377117186, -105.41515867418853, -1.2097070583665916, -7.636176149745282, -63.67001216901267, -0.32286969845224434, 13.448030527301551, -31.769157394862717, -7.736484267822226, 9.936953172647303, -88.44230930957409, -5.646428776585573, -6.058127082107263, 3.6133185426522307, -80.64643188870922, -15.94129960040467, -1.934396700883307, -67.81581933564017, -4.702540918924182, 2.8711210471476214, -84.68719176141653, 19.80323042117117, -138.257534306495, -41.39326756623028, -130.9552335359783, -115.76421695639695, -137.677198734284, 13.969919681501903, 0.4810612837260515, -13.395690438181706, -101.74760625927033], "episode_lengths": [81, 41, 67, 93, 52, 58, 77, 58, 45, 46, 65, 49, 80, 71, 56, 65, 54, 44, 69, 36, 63, 70, 33, 39, 33, 67, 63, 72, 51, 71, 85, 77, 72, 64, 57, 79, 51, 70, 79, 46, 65, 85, 84, 75, 84, 54, 64, 39, 59, 67, 27, 59, 57, 43, 74, 40, 82, 84, 73, 55, 45, 55, 72, 56, 51, 60, 93, 75, 45, 66, 73, 45, 53, 64, 46, 34, 56, 46, 35, 69, 49, 42, 45, 65, 48, 49, 64, 42, 45, 73, 36, 81, 52, 78, 75, 81, 29, 43, 54, 71], "policy_policy_0_reward": [-129.22714762326328, 6.442769467445248, -89.03897134094397, -204.67423656159096, -42.06027341883772, -25.33024800204351, -122.45596836195695, -19.52674897816594, -19.353636471335264, -4.973579169958775, -71.09653829355805, -29.436137371611096, -137.97847939439748, -84.69887518208795, -32.569525832019686, -77.54443146720419, -22.681348770633974, 1.9712429080284615, -84.4790693781152, 3.552922179984349, -63.237943774863304, -90.52400404398378, 8.467496460302073, 13.454308718483135, 21.423747480800177, -87.57105685774616, -42.75399340374343, -69.19441783208069, -19.217844170773223, -86.76716690636164, -117.74224474252723, -124.62968149273573, -101.44634078809347, -46.24516072851651, -51.40094443330999, -86.95874855902616, -15.974434877148822, -95.6205365453476, -80.37611174139676, -2.5341181441908245, -73.05099653739762, -150.9768183821153, -150.12808083162562, -70.4427999058816, -154.5162706969743, -34.58345907888046, -76.77454374778699, -2.1814716854673586, -50.051951729235896, -69.17666696212403, 18.01073221044407, -61.70397577993942, -53.36064299688674, 1.5045624825643014, -109.44904717814579, 14.4952913198321, -138.53063799562133, -154.55646720051914, -68.17300214505825, -17.596038278538927, -4.961087205583893, -39.93288117172364, -76.64164986918146, -33.72044589052867, -9.84670374709859, -49.30636994379858, -190.86974859050602, -66.0840367018148, -15.073580003939048, -73.78273377117186, -105.41515867418853, -1.2097070583665916, -7.636176149745282, -63.67001216901267, -0.32286969845224434, 13.448030527301551, -31.769157394862717, -7.736484267822226, 9.936953172647303, -88.44230930957409, -5.646428776585573, -6.058127082107263, 3.6133185426522307, -80.64643188870922, -15.94129960040467, -1.934396700883307, -67.81581933564017, -4.702540918924182, 2.8711210471476214, -84.68719176141653, 19.80323042117117, -138.257534306495, -41.39326756623028, -130.9552335359783, -115.76421695639695, -137.677198734284, 13.969919681501903, 0.4810612837260515, -13.395690438181706, -101.74760625927033]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255634275125975, "mean_inference_ms": 1.5725210726418155, "mean_action_processing_ms": 0.2542147185960596, "mean_env_wait_ms": 3.728218688096057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011057615280151367, "StateBufferConnector_ms": 0.0072252750396728516, "ViewRequirementAgentConnector_ms": 0.17458367347717285}, "num_episodes": 65, "episode_return_max": 21.423747480800177, "episode_return_min": -204.67423656159096, "episode_return_mean": -54.741702233666146, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.0035340786608, "num_env_steps_trained_throughput_per_sec": 331.0035340786608, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 12091.61, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12091.538, "sample_time_ms": 1349.603, "learn_time_ms": 10686.62, "learn_throughput": 374.3, "synch_weights_time_ms": 54.527}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "8adec_00000", "date": "2024-07-24_15-15-44", "timestamp": 1721814344, "time_this_iter_s": 12.096155643463135, "time_total_s": 812.453536272049, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8e8790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 812.453536272049, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 18.866666666666667, "ram_util_percent": 37.82222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.2730068564415, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.15604827436278962, "policy_loss": -0.005026104277931154, "vf_loss": 0.14633522216851513, "vf_explained_var": 0.9997892886400223, "kl": 0.011606969839825437, "entropy": -0.29870983697474, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 21.848583819476076, "episode_reward_min": -193.04762283481622, "episode_reward_mean": -61.91384194570832, "episode_len_mean": 60.98, "episode_media": {}, "episodes_timesteps_total": 6098, "policy_reward_min": {"policy_0": -193.04762283481622}, "policy_reward_max": {"policy_0": 21.848583819476076}, "policy_reward_mean": {"policy_0": -61.91384194570832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.72044589052867, -9.84670374709859, -49.30636994379858, -190.86974859050602, -66.0840367018148, -15.073580003939048, -73.78273377117186, -105.41515867418853, -1.2097070583665916, -7.636176149745282, -63.67001216901267, -0.32286969845224434, 13.448030527301551, -31.769157394862717, -7.736484267822226, 9.936953172647303, -88.44230930957409, -5.646428776585573, -6.058127082107263, 3.6133185426522307, -80.64643188870922, -15.94129960040467, -1.934396700883307, -67.81581933564017, -4.702540918924182, 2.8711210471476214, -84.68719176141653, 19.80323042117117, -138.257534306495, -41.39326756623028, -130.9552335359783, -115.76421695639695, -137.677198734284, 13.969919681501903, 0.4810612837260515, -13.395690438181706, -101.74760625927033, -75.07968278633541, 21.848583819476076, -141.72123881393983, -122.81631389759316, -18.89519854100556, -106.86407391956399, 8.63052022849209, -94.29429958049114, 18.910054069506756, -105.01918227053501, -47.602514401364935, -170.58505551323515, -35.0347783295421, -34.242471361714266, -45.05594255284052, -120.12210443344118, -35.65432205399326, -187.71518020215117, -19.123607982023298, -183.04021907171744, -100.0418265495151, -11.220800717863867, -52.18832960549237, -49.59056006715423, -67.53288197390687, -12.935063750245746, -79.44846014891493, -193.04762283481622, -123.91824950168733, -33.57396110432252, 20.575859955965445, -170.5534804620023, -46.84054155388562, -62.80583578121916, -13.666761152229043, -107.95773479050636, -134.9158622040732, -177.64881983903206, -81.07449020808703, -150.9080873928295, 10.429849386323573, -49.87685310065682, -84.6936334775197, -119.82946625399676, 8.456189985828582, -22.617496627315735, -121.32336685475018, -57.8524499947859, -79.83212886236856, -86.72101765145028, -36.327065172885725, 7.706916626246114, -70.61665927628474, -27.301445166205532, -7.8029949161478775, -158.50166820105852, -25.112650134132732, -7.475339344237758, -105.98328901661758, -129.40905296041484, -74.1677935410311, -158.89646428612744, -23.480935899170394], "episode_lengths": [56, 51, 60, 93, 75, 45, 66, 73, 45, 53, 64, 46, 34, 56, 46, 35, 69, 49, 42, 45, 65, 48, 49, 64, 42, 45, 73, 36, 81, 52, 78, 75, 81, 29, 43, 54, 71, 63, 32, 80, 76, 56, 73, 37, 77, 33, 72, 63, 89, 53, 55, 57, 75, 60, 93, 47, 90, 72, 55, 57, 62, 63, 54, 67, 91, 78, 51, 36, 89, 61, 62, 41, 74, 79, 88, 67, 84, 32, 57, 66, 82, 36, 56, 77, 59, 65, 67, 58, 35, 65, 49, 48, 88, 46, 52, 74, 80, 65, 85, 55], "policy_policy_0_reward": [-33.72044589052867, -9.84670374709859, -49.30636994379858, -190.86974859050602, -66.0840367018148, -15.073580003939048, -73.78273377117186, -105.41515867418853, -1.2097070583665916, -7.636176149745282, -63.67001216901267, -0.32286969845224434, 13.448030527301551, -31.769157394862717, -7.736484267822226, 9.936953172647303, -88.44230930957409, -5.646428776585573, -6.058127082107263, 3.6133185426522307, -80.64643188870922, -15.94129960040467, -1.934396700883307, -67.81581933564017, -4.702540918924182, 2.8711210471476214, -84.68719176141653, 19.80323042117117, -138.257534306495, -41.39326756623028, -130.9552335359783, -115.76421695639695, -137.677198734284, 13.969919681501903, 0.4810612837260515, -13.395690438181706, -101.74760625927033, -75.07968278633541, 21.848583819476076, -141.72123881393983, -122.81631389759316, -18.89519854100556, -106.86407391956399, 8.63052022849209, -94.29429958049114, 18.910054069506756, -105.01918227053501, -47.602514401364935, -170.58505551323515, -35.0347783295421, -34.242471361714266, -45.05594255284052, -120.12210443344118, -35.65432205399326, -187.71518020215117, -19.123607982023298, -183.04021907171744, -100.0418265495151, -11.220800717863867, -52.18832960549237, -49.59056006715423, -67.53288197390687, -12.935063750245746, -79.44846014891493, -193.04762283481622, -123.91824950168733, -33.57396110432252, 20.575859955965445, -170.5534804620023, -46.84054155388562, -62.80583578121916, -13.666761152229043, -107.95773479050636, -134.9158622040732, -177.64881983903206, -81.07449020808703, -150.9080873928295, 10.429849386323573, -49.87685310065682, -84.6936334775197, -119.82946625399676, 8.456189985828582, -22.617496627315735, -121.32336685475018, -57.8524499947859, -79.83212886236856, -86.72101765145028, -36.327065172885725, 7.706916626246114, -70.61665927628474, -27.301445166205532, -7.8029949161478775, -158.50166820105852, -25.112650134132732, -7.475339344237758, -105.98328901661758, -129.40905296041484, -74.1677935410311, -158.89646428612744, -23.480935899170394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5257742049006977, "mean_inference_ms": 1.5725548021855338, "mean_action_processing_ms": 0.25423425944717293, "mean_env_wait_ms": 3.730179017931393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011360406875610352, "StateBufferConnector_ms": 0.007467746734619141, "ViewRequirementAgentConnector_ms": 0.17920207977294922}, "num_episodes": 63, "episode_return_max": 21.848583819476076, "episode_return_min": -193.04762283481622, "episode_return_mean": -61.91384194570832, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.1860073135681, "num_env_steps_trained_throughput_per_sec": 472.1860073135681, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 11727.131, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11727.06, "sample_time_ms": 1349.245, "learn_time_ms": 10322.98, "learn_throughput": 387.485, "synch_weights_time_ms": 54.048}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "8adec_00000", "date": "2024-07-24_15-15-53", "timestamp": 1721814353, "time_this_iter_s": 8.48240041732788, "time_total_s": 820.9359366893768, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8eb400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 820.9359366893768, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 23.33333333333334, "ram_util_percent": 37.949999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.35964302321275, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1649008406534752, "policy_loss": 0.0004897428938420489, "vf_loss": 0.14629881946602835, "vf_explained_var": 0.9997765868281324, "kl": 0.014746573818335188, "entropy": -0.31813717192659774, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 20.575859955965445, "episode_reward_min": -209.3625056049164, "episode_reward_mean": -77.26329554187822, "episode_len_mean": 64.86, "episode_media": {}, "episodes_timesteps_total": 6486, "policy_reward_min": {"policy_0": -209.3625056049164}, "policy_reward_max": {"policy_0": 20.575859955965445}, "policy_reward_mean": {"policy_0": -77.26329554187822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.935063750245746, -79.44846014891493, -193.04762283481622, -123.91824950168733, -33.57396110432252, 20.575859955965445, -170.5534804620023, -46.84054155388562, -62.80583578121916, -13.666761152229043, -107.95773479050636, -134.9158622040732, -177.64881983903206, -81.07449020808703, -150.9080873928295, 10.429849386323573, -49.87685310065682, -84.6936334775197, -119.82946625399676, 8.456189985828582, -22.617496627315735, -121.32336685475018, -57.8524499947859, -79.83212886236856, -86.72101765145028, -36.327065172885725, 7.706916626246114, -70.61665927628474, -27.301445166205532, -7.8029949161478775, -158.50166820105852, -25.112650134132732, -7.475339344237758, -105.98328901661758, -129.40905296041484, -74.1677935410311, -158.89646428612744, -23.480935899170394, 0.3496522360897194, -115.63795872261224, -86.88811335000183, 5.703939707632302, -19.836918952870082, -99.67702904396565, -52.392964023316985, -169.21623601344635, -138.57898285510487, -103.81560754119214, -163.91606397773472, 13.819905776667444, -151.6949030164096, -43.82208740863909, -155.23117893441125, -106.88583030206235, 6.751869418755277, -81.68383017838816, -4.45669850381095, -57.81435760196667, 1.6593802740205754, -81.42272924656982, -72.53876631380753, -89.33405109887407, -53.23911624204611, -26.61480166141291, -45.10484595586333, -171.68510080855927, -54.702141080546966, -86.52447990704009, -56.074120056256334, -20.02749908514724, -176.46599933496196, -10.19085517417661, -126.60075737275665, -161.2525861367462, -53.953791222259575, -29.206908300261855, -81.07044225856171, -68.25030532186886, -185.39807713704008, -6.674120019626322, -97.95142247767618, -164.91043805595254, -164.86338751711025, -81.49445150250816, -131.80372943083512, -55.62880418089529, -87.71123884875064, -127.77414861876987, -157.52074995096163, -209.3625056049164, -11.43884367867131, -65.698793129647, -84.45232690259665, -33.19725854399244, -134.99147824248547, -9.024939195634394, -62.63306672235372, 1.914336483357413, -19.534021019061132, -58.70885479456246], "episode_lengths": [54, 67, 91, 78, 51, 36, 89, 61, 62, 41, 74, 79, 88, 67, 84, 32, 57, 66, 82, 36, 56, 77, 59, 65, 67, 58, 35, 65, 49, 48, 88, 46, 52, 74, 80, 65, 85, 55, 47, 75, 69, 35, 53, 71, 66, 91, 80, 73, 89, 37, 87, 59, 83, 74, 40, 66, 41, 59, 48, 65, 63, 72, 57, 51, 56, 90, 59, 69, 65, 49, 89, 42, 77, 85, 59, 58, 65, 63, 92, 40, 69, 88, 88, 74, 79, 56, 68, 77, 86, 98, 53, 62, 67, 55, 80, 42, 61, 42, 53, 60], "policy_policy_0_reward": [-12.935063750245746, -79.44846014891493, -193.04762283481622, -123.91824950168733, -33.57396110432252, 20.575859955965445, -170.5534804620023, -46.84054155388562, -62.80583578121916, -13.666761152229043, -107.95773479050636, -134.9158622040732, -177.64881983903206, -81.07449020808703, -150.9080873928295, 10.429849386323573, -49.87685310065682, -84.6936334775197, -119.82946625399676, 8.456189985828582, -22.617496627315735, -121.32336685475018, -57.8524499947859, -79.83212886236856, -86.72101765145028, -36.327065172885725, 7.706916626246114, -70.61665927628474, -27.301445166205532, -7.8029949161478775, -158.50166820105852, -25.112650134132732, -7.475339344237758, -105.98328901661758, -129.40905296041484, -74.1677935410311, -158.89646428612744, -23.480935899170394, 0.3496522360897194, -115.63795872261224, -86.88811335000183, 5.703939707632302, -19.836918952870082, -99.67702904396565, -52.392964023316985, -169.21623601344635, -138.57898285510487, -103.81560754119214, -163.91606397773472, 13.819905776667444, -151.6949030164096, -43.82208740863909, -155.23117893441125, -106.88583030206235, 6.751869418755277, -81.68383017838816, -4.45669850381095, -57.81435760196667, 1.6593802740205754, -81.42272924656982, -72.53876631380753, -89.33405109887407, -53.23911624204611, -26.61480166141291, -45.10484595586333, -171.68510080855927, -54.702141080546966, -86.52447990704009, -56.074120056256334, -20.02749908514724, -176.46599933496196, -10.19085517417661, -126.60075737275665, -161.2525861367462, -53.953791222259575, -29.206908300261855, -81.07044225856171, -68.25030532186886, -185.39807713704008, -6.674120019626322, -97.95142247767618, -164.91043805595254, -164.86338751711025, -81.49445150250816, -131.80372943083512, -55.62880418089529, -87.71123884875064, -127.77414861876987, -157.52074995096163, -209.3625056049164, -11.43884367867131, -65.698793129647, -84.45232690259665, -33.19725854399244, -134.99147824248547, -9.024939195634394, -62.63306672235372, 1.914336483357413, -19.534021019061132, -58.70885479456246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256446930666029, "mean_inference_ms": 1.5711810741726244, "mean_action_processing_ms": 0.25400506249977806, "mean_env_wait_ms": 3.7288777237767374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01165008544921875, "StateBufferConnector_ms": 0.007535457611083984, "ViewRequirementAgentConnector_ms": 0.18160581588745117}, "num_episodes": 62, "episode_return_max": 20.575859955965445, "episode_return_min": -209.3625056049164, "episode_return_mean": -77.26329554187822, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.6630276302612, "num_env_steps_trained_throughput_per_sec": 385.6630276302612, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 11548.62, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11548.549, "sample_time_ms": 1343.393, "learn_time_ms": 10141.415, "learn_throughput": 394.422, "synch_weights_time_ms": 62.93}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "8adec_00000", "date": "2024-07-24_15-16-03", "timestamp": 1721814363, "time_this_iter_s": 10.380882263183594, "time_total_s": 831.3168189525604, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ebd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 831.3168189525604, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 22.36, "ram_util_percent": 38.013333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.61935281207164, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1779245162101385, "policy_loss": -0.0032059282374878725, "vf_loss": 0.16299074724471818, "vf_explained_var": 0.9997337720667322, "kl": 0.014524590027372141, "entropy": -0.3433548780973069, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": 18.042394905855545, "episode_reward_min": -209.3625056049164, "episode_reward_mean": -69.11053295010575, "episode_len_mean": 63.77, "episode_media": {}, "episodes_timesteps_total": 6377, "policy_reward_min": {"policy_0": -209.3625056049164}, "policy_reward_max": {"policy_0": 18.042394905855545}, "policy_reward_mean": {"policy_0": -69.11053295010575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.10484595586333, -171.68510080855927, -54.702141080546966, -86.52447990704009, -56.074120056256334, -20.02749908514724, -176.46599933496196, -10.19085517417661, -126.60075737275665, -161.2525861367462, -53.953791222259575, -29.206908300261855, -81.07044225856171, -68.25030532186886, -185.39807713704008, -6.674120019626322, -97.95142247767618, -164.91043805595254, -164.86338751711025, -81.49445150250816, -131.80372943083512, -55.62880418089529, -87.71123884875064, -127.77414861876987, -157.52074995096163, -209.3625056049164, -11.43884367867131, -65.698793129647, -84.45232690259665, -33.19725854399244, -134.99147824248547, -9.024939195634394, -62.63306672235372, 1.914336483357413, -19.534021019061132, -58.70885479456246, -20.201904789934037, -4.515986519103038, -121.6903890270157, -73.55224204157915, -50.272384488563254, -58.688164228898124, -5.918774009373479, -86.57833745990038, -72.3467883617204, -65.78775412138661, -58.87896602399157, -10.727328668596423, -114.01173469772665, 4.140549983742299, -61.74221113045389, -15.373268543176199, -68.73756431384783, -71.83973430785122, -5.383683463852893, -1.7839777900739104, -45.79219990825749, -97.3834887482594, -21.916888683297326, -41.349016009226744, -3.3382105243185687, -9.468406260732188, -103.31791115156607, -69.14247299527176, -193.09108816027015, -126.0268460405193, -21.621758590098846, -92.19420379296007, -91.74169281455796, -29.377784284249348, -180.4514265948311, 18.042394905855545, -102.65557564184688, 10.540658764817879, -92.30183189456574, -1.4209588010703935, -50.86840325716552, -97.15263165461413, -130.6348285959409, -8.158311929798113, -158.88555994806535, -171.84784899663137, -121.80498367168173, -139.0583246565645, -15.754805661006365, -36.948253271276045, -68.47568019824276, -197.41288412616646, -3.2993508431765965, -5.585298723417129, 11.398874913247015, -6.324240835841951, -38.01907884780786, -56.18888404082837, -4.450815553969974, 3.0687148527084775, -38.74333221729509, -189.77834559819348, -33.56115200323993, -4.700367811382556], "episode_lengths": [56, 90, 59, 69, 65, 49, 89, 42, 77, 85, 59, 58, 65, 63, 92, 40, 69, 88, 88, 74, 79, 56, 68, 77, 86, 98, 53, 62, 67, 55, 80, 42, 61, 42, 53, 60, 57, 43, 77, 69, 64, 59, 48, 70, 65, 72, 66, 47, 75, 42, 67, 51, 66, 68, 39, 48, 56, 84, 50, 63, 52, 54, 72, 66, 92, 79, 52, 78, 70, 58, 89, 27, 75, 38, 69, 45, 62, 80, 79, 49, 89, 87, 77, 81, 51, 63, 63, 94, 47, 52, 39, 48, 50, 59, 48, 43, 61, 90, 48, 39], "policy_policy_0_reward": [-45.10484595586333, -171.68510080855927, -54.702141080546966, -86.52447990704009, -56.074120056256334, -20.02749908514724, -176.46599933496196, -10.19085517417661, -126.60075737275665, -161.2525861367462, -53.953791222259575, -29.206908300261855, -81.07044225856171, -68.25030532186886, -185.39807713704008, -6.674120019626322, -97.95142247767618, -164.91043805595254, -164.86338751711025, -81.49445150250816, -131.80372943083512, -55.62880418089529, -87.71123884875064, -127.77414861876987, -157.52074995096163, -209.3625056049164, -11.43884367867131, -65.698793129647, -84.45232690259665, -33.19725854399244, -134.99147824248547, -9.024939195634394, -62.63306672235372, 1.914336483357413, -19.534021019061132, -58.70885479456246, -20.201904789934037, -4.515986519103038, -121.6903890270157, -73.55224204157915, -50.272384488563254, -58.688164228898124, -5.918774009373479, -86.57833745990038, -72.3467883617204, -65.78775412138661, -58.87896602399157, -10.727328668596423, -114.01173469772665, 4.140549983742299, -61.74221113045389, -15.373268543176199, -68.73756431384783, -71.83973430785122, -5.383683463852893, -1.7839777900739104, -45.79219990825749, -97.3834887482594, -21.916888683297326, -41.349016009226744, -3.3382105243185687, -9.468406260732188, -103.31791115156607, -69.14247299527176, -193.09108816027015, -126.0268460405193, -21.621758590098846, -92.19420379296007, -91.74169281455796, -29.377784284249348, -180.4514265948311, 18.042394905855545, -102.65557564184688, 10.540658764817879, -92.30183189456574, -1.4209588010703935, -50.86840325716552, -97.15263165461413, -130.6348285959409, -8.158311929798113, -158.88555994806535, -171.84784899663137, -121.80498367168173, -139.0583246565645, -15.754805661006365, -36.948253271276045, -68.47568019824276, -197.41288412616646, -3.2993508431765965, -5.585298723417129, 11.398874913247015, -6.324240835841951, -38.01907884780786, -56.18888404082837, -4.450815553969974, 3.0687148527084775, -38.74333221729509, -189.77834559819348, -33.56115200323993, -4.700367811382556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5251458229499705, "mean_inference_ms": 1.5693466142571342, "mean_action_processing_ms": 0.25369162962487474, "mean_env_wait_ms": 3.7286212977962316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011174201965332031, "StateBufferConnector_ms": 0.0072362422943115234, "ViewRequirementAgentConnector_ms": 0.17499971389770508}, "num_episodes": 64, "episode_return_max": 18.042394905855545, "episode_return_min": -209.3625056049164, "episode_return_mean": -69.11053295010575, "episodes_this_iter": 64}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.75895112902975, "num_env_steps_trained_throughput_per_sec": 317.75895112902975, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 11633.549, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11633.477, "sample_time_ms": 1335.589, "learn_time_ms": 10234.292, "learn_throughput": 390.843, "synch_weights_time_ms": 62.801}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "8adec_00000", "date": "2024-07-24_15-16-16", "timestamp": 1721814376, "time_this_iter_s": 12.59955358505249, "time_total_s": 843.9163725376129, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8eb370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 843.9163725376129, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 19.170588235294115, "ram_util_percent": 37.811764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.01869195103645, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1590411982848309, "policy_loss": -0.0035737188047884655, "vf_loss": 0.14445715479087085, "vf_explained_var": 0.9997770256673296, "kl": 0.014312199820172586, "entropy": -0.36666600017342715, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 24.08531142011687, "episode_reward_min": -215.55949978458503, "episode_reward_mean": -59.68827093934303, "episode_len_mean": 60.28, "episode_media": {}, "episodes_timesteps_total": 6028, "policy_reward_min": {"policy_0": -215.55949978458503}, "policy_reward_max": {"policy_0": 24.08531142011687}, "policy_reward_mean": {"policy_0": -59.68827093934303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.19420379296007, -91.74169281455796, -29.377784284249348, -180.4514265948311, 18.042394905855545, -102.65557564184688, 10.540658764817879, -92.30183189456574, -1.4209588010703935, -50.86840325716552, -97.15263165461413, -130.6348285959409, -8.158311929798113, -158.88555994806535, -171.84784899663137, -121.80498367168173, -139.0583246565645, -15.754805661006365, -36.948253271276045, -68.47568019824276, -197.41288412616646, -3.2993508431765965, -5.585298723417129, 11.398874913247015, -6.324240835841951, -38.01907884780786, -56.18888404082837, -4.450815553969974, 3.0687148527084775, -38.74333221729509, -189.77834559819348, -33.56115200323993, -4.700367811382556, -16.23719764957306, -110.82604384044666, -47.5989735587105, -129.23360739264228, -3.242863424777078, -179.26787050421106, 2.7255185689606325, 2.5920115644065387, -5.709199226915361, -215.55949978458503, -11.469079181627103, -140.40924206335592, 2.4838628468477992, -11.657062367000156, 9.0523650235473, -65.321213181171, 9.252704961418964, -145.47892976346463, -149.87251575387225, -32.1237176185485, 5.925241093892783, -81.97944198321412, -0.7686335353098319, -175.7967429534524, 8.723814200792082, -95.70767595394051, -60.60462712136811, -13.192182139566667, 4.495157359910403, -36.307625289258276, -70.22607481727306, 20.99111072639697, -64.5213237309165, -1.7911989873625274, -78.90850711180023, -153.44159221137514, -4.442244624815676, -9.678400463647828, -96.7383348035197, -44.19235897254945, -6.056907251118148, -127.35057845848046, -82.94938177794471, -126.84110903683089, -68.97161328672647, -3.729078763167376, -3.9903709232789217, -28.48099322995794, -61.923030398219915, -75.98065637003685, 10.67997340823013, 10.765299260678892, -69.40364022338274, -101.66753087245246, -3.1143197365172375, -88.47983814148188, 24.08531142011687, -29.32596872802797, -208.7115642727918, -30.958561986206025, -115.56322273286132, -61.723972261361574, -16.72305357331001, -194.88973013667925, -79.64361786881493, -9.76331737982897, -107.3072141199957], "episode_lengths": [78, 70, 58, 89, 27, 75, 38, 69, 45, 62, 80, 79, 49, 89, 87, 77, 81, 51, 63, 63, 94, 47, 52, 39, 48, 50, 59, 48, 43, 61, 90, 48, 39, 45, 76, 60, 79, 46, 92, 41, 46, 42, 99, 53, 81, 42, 42, 38, 66, 39, 82, 85, 58, 33, 77, 45, 90, 36, 73, 62, 47, 38, 50, 64, 30, 61, 51, 65, 85, 47, 50, 71, 53, 45, 79, 68, 76, 67, 43, 45, 48, 62, 65, 35, 33, 76, 72, 42, 67, 27, 59, 96, 51, 75, 75, 47, 92, 68, 52, 75], "policy_policy_0_reward": [-92.19420379296007, -91.74169281455796, -29.377784284249348, -180.4514265948311, 18.042394905855545, -102.65557564184688, 10.540658764817879, -92.30183189456574, -1.4209588010703935, -50.86840325716552, -97.15263165461413, -130.6348285959409, -8.158311929798113, -158.88555994806535, -171.84784899663137, -121.80498367168173, -139.0583246565645, -15.754805661006365, -36.948253271276045, -68.47568019824276, -197.41288412616646, -3.2993508431765965, -5.585298723417129, 11.398874913247015, -6.324240835841951, -38.01907884780786, -56.18888404082837, -4.450815553969974, 3.0687148527084775, -38.74333221729509, -189.77834559819348, -33.56115200323993, -4.700367811382556, -16.23719764957306, -110.82604384044666, -47.5989735587105, -129.23360739264228, -3.242863424777078, -179.26787050421106, 2.7255185689606325, 2.5920115644065387, -5.709199226915361, -215.55949978458503, -11.469079181627103, -140.40924206335592, 2.4838628468477992, -11.657062367000156, 9.0523650235473, -65.321213181171, 9.252704961418964, -145.47892976346463, -149.87251575387225, -32.1237176185485, 5.925241093892783, -81.97944198321412, -0.7686335353098319, -175.7967429534524, 8.723814200792082, -95.70767595394051, -60.60462712136811, -13.192182139566667, 4.495157359910403, -36.307625289258276, -70.22607481727306, 20.99111072639697, -64.5213237309165, -1.7911989873625274, -78.90850711180023, -153.44159221137514, -4.442244624815676, -9.678400463647828, -96.7383348035197, -44.19235897254945, -6.056907251118148, -127.35057845848046, -82.94938177794471, -126.84110903683089, -68.97161328672647, -3.729078763167376, -3.9903709232789217, -28.48099322995794, -61.923030398219915, -75.98065637003685, 10.67997340823013, 10.765299260678892, -69.40364022338274, -101.66753087245246, -3.1143197365172375, -88.47983814148188, 24.08531142011687, -29.32596872802797, -208.7115642727918, -30.958561986206025, -115.56322273286132, -61.723972261361574, -16.72305357331001, -194.88973013667925, -79.64361786881493, -9.76331737982897, -107.3072141199957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5251587733069261, "mean_inference_ms": 1.5688212300493862, "mean_action_processing_ms": 0.2537411153708767, "mean_env_wait_ms": 3.728152411287329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010898828506469727, "StateBufferConnector_ms": 0.007172584533691406, "ViewRequirementAgentConnector_ms": 0.17469024658203125}, "num_episodes": 67, "episode_return_max": 24.08531142011687, "episode_return_min": -215.55949978458503, "episode_return_mean": -59.68827093934303, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.7042895514522, "num_env_steps_trained_throughput_per_sec": 356.7042895514522, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 11524.523, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11524.453, "sample_time_ms": 1335.872, "learn_time_ms": 10124.631, "learn_throughput": 395.076, "synch_weights_time_ms": 63.15}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "8adec_00000", "date": "2024-07-24_15-16-27", "timestamp": 1721814387, "time_this_iter_s": 11.22424840927124, "time_total_s": 855.1406209468842, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 855.1406209468842, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 20.1, "ram_util_percent": 37.83125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.574363487958905, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.14102308131017102, "policy_loss": -0.0025845158510492184, "vf_loss": 0.12477194340511535, "vf_explained_var": 0.9997715587417285, "kl": 0.014798866044717822, "entropy": -0.3851801444000254, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": 24.38005784605917, "episode_reward_min": -208.7115642727918, "episode_reward_mean": -63.531609656592465, "episode_len_mean": 61.23, "episode_media": {}, "episodes_timesteps_total": 6123, "policy_reward_min": {"policy_0": -208.7115642727918}, "policy_reward_max": {"policy_0": 24.38005784605917}, "policy_reward_mean": {"policy_0": -63.531609656592465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.7911989873625274, -78.90850711180023, -153.44159221137514, -4.442244624815676, -9.678400463647828, -96.7383348035197, -44.19235897254945, -6.056907251118148, -127.35057845848046, -82.94938177794471, -126.84110903683089, -68.97161328672647, -3.729078763167376, -3.9903709232789217, -28.48099322995794, -61.923030398219915, -75.98065637003685, 10.67997340823013, 10.765299260678892, -69.40364022338274, -101.66753087245246, -3.1143197365172375, -88.47983814148188, 24.08531142011687, -29.32596872802797, -208.7115642727918, -30.958561986206025, -115.56322273286132, -61.723972261361574, -16.72305357331001, -194.88973013667925, -79.64361786881493, -9.76331737982897, -107.3072141199957, -108.1446298733488, -13.7822292350455, -104.407354594789, 4.688763156939107, -58.10191215146083, -47.559300611537076, 4.244319489292911, 7.4911310081296305, -53.63612926536029, -112.93655151597416, -1.082636524909108, -178.79717518783144, -51.16528286986954, -49.21985816888258, 18.30621694631057, 24.38005784605917, -11.767676525500837, -56.522908753667764, -159.89252718146147, -139.07055665182338, -9.448202466982599, -91.91755285091355, 10.67481452524897, -70.50932547454184, -3.3740058298057205, -83.48429193915837, -19.790572499926572, -140.16922133898197, -115.42722739069409, -10.197772206506693, 2.8271688529346517, -137.81937037250458, -34.06744504159863, -18.524734732686817, -67.52840301101139, -20.239287418112045, -140.4866082999623, -200.82919708241633, -39.79081121954975, -49.567491969118414, -175.79320351419585, 7.008299128465093, -130.35499007664373, -114.54525009095926, -93.0280507382957, -37.27693068065888, -89.83910885829954, -19.620286096266664, 0.16424401083126483, -169.58299853565686, -26.633646151523312, 17.80164167705009, -162.09167936060734, -127.53330682955341, -30.936149173223907, -10.314872917231176, -60.68141897805141, -75.75622588637837, 17.669200519661814, -113.44482514258284, -160.41947030432587, 8.387180350055635, -161.5545003665541, -59.3532052764553, -128.13204846626715, -83.44226085504245], "episode_lengths": [51, 65, 85, 47, 50, 71, 53, 45, 79, 68, 76, 67, 43, 45, 48, 62, 65, 35, 33, 76, 72, 42, 67, 27, 59, 96, 51, 75, 75, 47, 92, 68, 52, 75, 78, 50, 71, 43, 58, 62, 37, 41, 63, 74, 47, 92, 57, 63, 27, 27, 55, 58, 89, 83, 42, 73, 30, 68, 48, 69, 59, 80, 75, 52, 39, 80, 51, 46, 64, 55, 81, 93, 57, 56, 87, 46, 82, 75, 72, 54, 69, 47, 47, 87, 57, 35, 85, 78, 58, 42, 60, 70, 28, 74, 86, 33, 87, 62, 78, 69], "policy_policy_0_reward": [-1.7911989873625274, -78.90850711180023, -153.44159221137514, -4.442244624815676, -9.678400463647828, -96.7383348035197, -44.19235897254945, -6.056907251118148, -127.35057845848046, -82.94938177794471, -126.84110903683089, -68.97161328672647, -3.729078763167376, -3.9903709232789217, -28.48099322995794, -61.923030398219915, -75.98065637003685, 10.67997340823013, 10.765299260678892, -69.40364022338274, -101.66753087245246, -3.1143197365172375, -88.47983814148188, 24.08531142011687, -29.32596872802797, -208.7115642727918, -30.958561986206025, -115.56322273286132, -61.723972261361574, -16.72305357331001, -194.88973013667925, -79.64361786881493, -9.76331737982897, -107.3072141199957, -108.1446298733488, -13.7822292350455, -104.407354594789, 4.688763156939107, -58.10191215146083, -47.559300611537076, 4.244319489292911, 7.4911310081296305, -53.63612926536029, -112.93655151597416, -1.082636524909108, -178.79717518783144, -51.16528286986954, -49.21985816888258, 18.30621694631057, 24.38005784605917, -11.767676525500837, -56.522908753667764, -159.89252718146147, -139.07055665182338, -9.448202466982599, -91.91755285091355, 10.67481452524897, -70.50932547454184, -3.3740058298057205, -83.48429193915837, -19.790572499926572, -140.16922133898197, -115.42722739069409, -10.197772206506693, 2.8271688529346517, -137.81937037250458, -34.06744504159863, -18.524734732686817, -67.52840301101139, -20.239287418112045, -140.4866082999623, -200.82919708241633, -39.79081121954975, -49.567491969118414, -175.79320351419585, 7.008299128465093, -130.35499007664373, -114.54525009095926, -93.0280507382957, -37.27693068065888, -89.83910885829954, -19.620286096266664, 0.16424401083126483, -169.58299853565686, -26.633646151523312, 17.80164167705009, -162.09167936060734, -127.53330682955341, -30.936149173223907, -10.314872917231176, -60.68141897805141, -75.75622588637837, 17.669200519661814, -113.44482514258284, -160.41947030432587, 8.387180350055635, -161.5545003665541, -59.3532052764553, -128.13204846626715, -83.44226085504245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.52541970884274, "mean_inference_ms": 1.5688968728781696, "mean_action_processing_ms": 0.2538954484098201, "mean_env_wait_ms": 3.731234757351745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011318445205688477, "StateBufferConnector_ms": 0.007371664047241211, "ViewRequirementAgentConnector_ms": 0.17799091339111328}, "num_episodes": 66, "episode_return_max": 24.38005784605917, "episode_return_min": -208.7115642727918, "episode_return_mean": -63.531609656592465, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.5600475015206, "num_env_steps_trained_throughput_per_sec": 359.5600475015206, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 11406.997, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11406.926, "sample_time_ms": 1336.448, "learn_time_ms": 10005.756, "learn_throughput": 399.77, "synch_weights_time_ms": 63.92}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "8adec_00000", "date": "2024-07-24_15-16-39", "timestamp": 1721814399, "time_this_iter_s": 11.136253833770752, "time_total_s": 866.2768747806549, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 866.2768747806549, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 20.106250000000003, "ram_util_percent": 37.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.65890818337599, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.14299447510323565, "policy_loss": -0.007381405889464077, "vf_loss": 0.13383150391746312, "vf_explained_var": 0.9997793568919102, "kl": 0.01302033870827782, "entropy": -0.3361282934822763, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 17.80164167705009, "episode_reward_min": -213.4279379300529, "episode_reward_mean": -64.04538528991115, "episode_len_mean": 61.98, "episode_media": {}, "episodes_timesteps_total": 6198, "policy_reward_min": {"policy_0": -213.4279379300529}, "policy_reward_max": {"policy_0": 17.80164167705009}, "policy_reward_mean": {"policy_0": -64.04538528991115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.8271688529346517, -137.81937037250458, -34.06744504159863, -18.524734732686817, -67.52840301101139, -20.239287418112045, -140.4866082999623, -200.82919708241633, -39.79081121954975, -49.567491969118414, -175.79320351419585, 7.008299128465093, -130.35499007664373, -114.54525009095926, -93.0280507382957, -37.27693068065888, -89.83910885829954, -19.620286096266664, 0.16424401083126483, -169.58299853565686, -26.633646151523312, 17.80164167705009, -162.09167936060734, -127.53330682955341, -30.936149173223907, -10.314872917231176, -60.68141897805141, -75.75622588637837, 17.669200519661814, -113.44482514258284, -160.41947030432587, 8.387180350055635, -161.5545003665541, -59.3532052764553, -128.13204846626715, -83.44226085504245, -44.24882684470452, 5.78850379056697, -10.43604767193347, -116.98943883210225, 5.0919777214652076, -57.13549176353796, -62.435981016674134, -9.86492495097264, -98.72694328338152, -7.0653474158160385, -47.008729941438816, -107.3376235467198, -110.14007365841599, 3.412216833383527, -71.84911042949507, 3.458405447326988, -108.28957130392965, -125.39448655802555, -80.15160955151791, 3.4828398452624296, -24.064774949957325, -73.79735363983743, -85.81503561185188, -58.17588401011247, -46.37811481632338, 2.7835393038181957, -146.7807653042063, -80.6256677477045, -78.3989395821227, -12.523247225136512, -107.92978700441064, -62.69296846571296, 14.729688254915716, -180.10855594075633, -65.08351462083724, -1.880205141610482, -40.916725280106256, -46.23876356052253, -87.87114768975069, -3.2720947804598275, -37.95795542293493, -28.15187568609135, -66.26934997655297, -82.422826994094, -21.03764198481422, -213.4279379300529, -146.4620420065788, -1.8737404316454302, -63.13605804514295, -76.16162592174105, -67.3424574242026, -82.1602085603412, -78.28084272739154, -6.237561966691446, -25.83718359661178, -69.1745229222454, -133.8692800863104, 10.952893265809966, -83.15772323109827, 1.5532171411082238, -46.02595886618699, -94.6213666634031, -101.7403630106499, 14.51450790682764], "episode_lengths": [39, 80, 51, 46, 64, 55, 81, 93, 57, 56, 87, 46, 82, 75, 72, 54, 69, 47, 47, 87, 57, 35, 85, 78, 58, 42, 60, 70, 28, 74, 86, 33, 87, 62, 78, 69, 54, 42, 53, 74, 43, 63, 62, 47, 81, 42, 62, 75, 74, 41, 75, 34, 74, 78, 65, 38, 55, 65, 75, 58, 54, 50, 82, 68, 65, 49, 76, 76, 33, 91, 65, 48, 59, 58, 73, 50, 51, 53, 67, 66, 54, 96, 82, 51, 64, 70, 63, 71, 68, 44, 53, 65, 81, 31, 73, 44, 62, 71, 71, 30], "policy_policy_0_reward": [2.8271688529346517, -137.81937037250458, -34.06744504159863, -18.524734732686817, -67.52840301101139, -20.239287418112045, -140.4866082999623, -200.82919708241633, -39.79081121954975, -49.567491969118414, -175.79320351419585, 7.008299128465093, -130.35499007664373, -114.54525009095926, -93.0280507382957, -37.27693068065888, -89.83910885829954, -19.620286096266664, 0.16424401083126483, -169.58299853565686, -26.633646151523312, 17.80164167705009, -162.09167936060734, -127.53330682955341, -30.936149173223907, -10.314872917231176, -60.68141897805141, -75.75622588637837, 17.669200519661814, -113.44482514258284, -160.41947030432587, 8.387180350055635, -161.5545003665541, -59.3532052764553, -128.13204846626715, -83.44226085504245, -44.24882684470452, 5.78850379056697, -10.43604767193347, -116.98943883210225, 5.0919777214652076, -57.13549176353796, -62.435981016674134, -9.86492495097264, -98.72694328338152, -7.0653474158160385, -47.008729941438816, -107.3376235467198, -110.14007365841599, 3.412216833383527, -71.84911042949507, 3.458405447326988, -108.28957130392965, -125.39448655802555, -80.15160955151791, 3.4828398452624296, -24.064774949957325, -73.79735363983743, -85.81503561185188, -58.17588401011247, -46.37811481632338, 2.7835393038181957, -146.7807653042063, -80.6256677477045, -78.3989395821227, -12.523247225136512, -107.92978700441064, -62.69296846571296, 14.729688254915716, -180.10855594075633, -65.08351462083724, -1.880205141610482, -40.916725280106256, -46.23876356052253, -87.87114768975069, -3.2720947804598275, -37.95795542293493, -28.15187568609135, -66.26934997655297, -82.422826994094, -21.03764198481422, -213.4279379300529, -146.4620420065788, -1.8737404316454302, -63.13605804514295, -76.16162592174105, -67.3424574242026, -82.1602085603412, -78.28084272739154, -6.237561966691446, -25.83718359661178, -69.1745229222454, -133.8692800863104, 10.952893265809966, -83.15772323109827, 1.5532171411082238, -46.02595886618699, -94.6213666634031, -101.7403630106499, 14.51450790682764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5254123294619386, "mean_inference_ms": 1.568148461414414, "mean_action_processing_ms": 0.253792388482023, "mean_env_wait_ms": 3.731922194957996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011523008346557617, "StateBufferConnector_ms": 0.0075130462646484375, "ViewRequirementAgentConnector_ms": 0.18157458305358887}, "num_episodes": 64, "episode_return_max": 17.80164167705009, "episode_return_min": -213.4279379300529, "episode_return_mean": -64.04538528991115, "episodes_this_iter": 64}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.5257736332266, "num_env_steps_trained_throughput_per_sec": 441.5257736332266, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 11056.702, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11056.631, "sample_time_ms": 1335.387, "learn_time_ms": 9657.918, "learn_throughput": 414.168, "synch_weights_time_ms": 62.541}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "8adec_00000", "date": "2024-07-24_15-16-48", "timestamp": 1721814408, "time_this_iter_s": 9.069607973098755, "time_total_s": 875.3464827537537, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 875.3464827537537, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 21.969230769230776, "ram_util_percent": 37.89230769230768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.25949164181948, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.15169680452357473, "policy_loss": -0.008342990487775145, "vf_loss": 0.143779806777214, "vf_explained_var": 0.9997798064102729, "kl": 0.012767903937250054, "entropy": -0.33324859604084245, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 19.433877083617322, "episode_reward_min": -218.51322380068132, "episode_reward_mean": -71.24173273457207, "episode_len_mean": 64.22, "episode_media": {}, "episodes_timesteps_total": 6422, "policy_reward_min": {"policy_0": -218.51322380068132}, "policy_reward_max": {"policy_0": 19.433877083617322}, "policy_reward_mean": {"policy_0": -71.24173273457207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.7807653042063, -80.6256677477045, -78.3989395821227, -12.523247225136512, -107.92978700441064, -62.69296846571296, 14.729688254915716, -180.10855594075633, -65.08351462083724, -1.880205141610482, -40.916725280106256, -46.23876356052253, -87.87114768975069, -3.2720947804598275, -37.95795542293493, -28.15187568609135, -66.26934997655297, -82.422826994094, -21.03764198481422, -213.4279379300529, -146.4620420065788, -1.8737404316454302, -63.13605804514295, -76.16162592174105, -67.3424574242026, -82.1602085603412, -78.28084272739154, -6.237561966691446, -25.83718359661178, -69.1745229222454, -133.8692800863104, 10.952893265809966, -83.15772323109827, 1.5532171411082238, -46.02595886618699, -94.6213666634031, -101.7403630106499, 14.51450790682764, -170.6155617093575, -98.47628709469511, -156.42530052464178, -71.51571699634408, -94.84292733851062, -45.89331896898625, -42.663335832534784, -69.53097684418914, -55.32620871904237, -67.68649636366163, -0.5971133562522322, -25.255705856251616, -89.525831251819, -181.03931309613097, -87.57916601378027, -43.556608329774065, -93.78178482951104, -92.29847391019089, -42.759519794382314, -73.51434763415672, 12.840711365759613, -64.25082583395219, -59.237753112648136, -77.63827230854517, -92.49038911486652, 0.9058497636492941, -111.53050079545143, 15.821167546374776, 12.441265712617344, -71.82269927168566, -116.47771461644268, -116.1452784951522, -40.328095760951, -157.67654526694108, -27.946148051234445, -103.76531295887011, -160.40452493288768, -22.09078861673128, 19.433877083617322, -25.78867058191631, -99.6345477759011, -0.698770235081756, -55.87168888120657, -218.51322380068132, -7.6130919384343665, -140.13910724814914, 1.2302667754198535, -54.11437987212791, -152.46525300684092, -32.4422792311313, -64.4909924165872, -140.90765142652174, -26.170420764487538, -62.214141302574085, -120.23294844194953, -206.04734606264552, -145.94469348924753, -12.306589418637994, -4.0293780495183675, -113.4465489441963, -110.75515878046508, -170.41008720631532], "episode_lengths": [82, 68, 65, 49, 76, 76, 33, 91, 65, 48, 59, 58, 73, 50, 51, 53, 67, 66, 54, 96, 82, 51, 64, 70, 63, 71, 68, 44, 53, 65, 81, 31, 73, 44, 62, 71, 71, 30, 89, 75, 86, 63, 74, 63, 62, 67, 63, 61, 38, 49, 68, 91, 68, 53, 69, 68, 54, 68, 40, 66, 59, 68, 69, 49, 75, 31, 36, 66, 76, 77, 53, 85, 52, 73, 87, 57, 33, 50, 75, 47, 58, 98, 54, 80, 46, 57, 84, 60, 76, 81, 60, 59, 76, 96, 83, 48, 42, 74, 74, 89], "policy_policy_0_reward": [-146.7807653042063, -80.6256677477045, -78.3989395821227, -12.523247225136512, -107.92978700441064, -62.69296846571296, 14.729688254915716, -180.10855594075633, -65.08351462083724, -1.880205141610482, -40.916725280106256, -46.23876356052253, -87.87114768975069, -3.2720947804598275, -37.95795542293493, -28.15187568609135, -66.26934997655297, -82.422826994094, -21.03764198481422, -213.4279379300529, -146.4620420065788, -1.8737404316454302, -63.13605804514295, -76.16162592174105, -67.3424574242026, -82.1602085603412, -78.28084272739154, -6.237561966691446, -25.83718359661178, -69.1745229222454, -133.8692800863104, 10.952893265809966, -83.15772323109827, 1.5532171411082238, -46.02595886618699, -94.6213666634031, -101.7403630106499, 14.51450790682764, -170.6155617093575, -98.47628709469511, -156.42530052464178, -71.51571699634408, -94.84292733851062, -45.89331896898625, -42.663335832534784, -69.53097684418914, -55.32620871904237, -67.68649636366163, -0.5971133562522322, -25.255705856251616, -89.525831251819, -181.03931309613097, -87.57916601378027, -43.556608329774065, -93.78178482951104, -92.29847391019089, -42.759519794382314, -73.51434763415672, 12.840711365759613, -64.25082583395219, -59.237753112648136, -77.63827230854517, -92.49038911486652, 0.9058497636492941, -111.53050079545143, 15.821167546374776, 12.441265712617344, -71.82269927168566, -116.47771461644268, -116.1452784951522, -40.328095760951, -157.67654526694108, -27.946148051234445, -103.76531295887011, -160.40452493288768, -22.09078861673128, 19.433877083617322, -25.78867058191631, -99.6345477759011, -0.698770235081756, -55.87168888120657, -218.51322380068132, -7.6130919384343665, -140.13910724814914, 1.2302667754198535, -54.11437987212791, -152.46525300684092, -32.4422792311313, -64.4909924165872, -140.90765142652174, -26.170420764487538, -62.214141302574085, -120.23294844194953, -206.04734606264552, -145.94469348924753, -12.306589418637994, -4.0293780495183675, -113.4465489441963, -110.75515878046508, -170.41008720631532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256785302179854, "mean_inference_ms": 1.568294530631605, "mean_action_processing_ms": 0.2538169582569734, "mean_env_wait_ms": 3.7338347071773317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011326074600219727, "StateBufferConnector_ms": 0.007406473159790039, "ViewRequirementAgentConnector_ms": 0.17939543724060059}, "num_episodes": 62, "episode_return_max": 19.433877083617322, "episode_return_min": -218.51322380068132, "episode_return_mean": -71.24173273457207, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.3101655486505, "num_env_steps_trained_throughput_per_sec": 349.3101655486505, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 11169.925, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11169.856, "sample_time_ms": 1336.554, "learn_time_ms": 9770.057, "learn_throughput": 409.414, "synch_weights_time_ms": 62.462}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "8adec_00000", "date": "2024-07-24_15-16-59", "timestamp": 1721814419, "time_this_iter_s": 11.463228702545166, "time_total_s": 886.8097114562988, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 886.8097114562988, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 19.688235294117646, "ram_util_percent": 37.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.006660995880765, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1468056620923259, "policy_loss": -0.008457540609136534, "vf_loss": 0.13762555126256, "vf_explained_var": 0.9998004083832105, "kl": 0.013751469752605817, "entropy": -0.37142884839947027, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 19.73871498537328, "episode_reward_min": -218.51322380068132, "episode_reward_mean": -74.80483203323237, "episode_len_mean": 63.99, "episode_media": {}, "episodes_timesteps_total": 6399, "policy_reward_min": {"policy_0": -218.51322380068132}, "policy_reward_max": {"policy_0": 19.73871498537328}, "policy_reward_mean": {"policy_0": -74.80483203323237}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9058497636492941, -111.53050079545143, 15.821167546374776, 12.441265712617344, -71.82269927168566, -116.47771461644268, -116.1452784951522, -40.328095760951, -157.67654526694108, -27.946148051234445, -103.76531295887011, -160.40452493288768, -22.09078861673128, 19.433877083617322, -25.78867058191631, -99.6345477759011, -0.698770235081756, -55.87168888120657, -218.51322380068132, -7.6130919384343665, -140.13910724814914, 1.2302667754198535, -54.11437987212791, -152.46525300684092, -32.4422792311313, -64.4909924165872, -140.90765142652174, -26.170420764487538, -62.214141302574085, -120.23294844194953, -206.04734606264552, -145.94469348924753, -12.306589418637994, -4.0293780495183675, -113.4465489441963, -110.75515878046508, -170.41008720631532, -32.37510820381291, -25.28206484574313, -148.27882631960608, -171.81675362080395, 19.73871498537328, 6.616629957981161, -16.44834341505327, -44.041192898263894, -134.13155554427007, -150.51981824599392, -12.794358728576825, -194.12065953703, -173.8994211093029, -120.50716603087542, -25.862939983886083, -47.60844103089296, -161.4906105358328, -29.578659228514788, -95.34703179735725, 1.215825884251316, -30.996201250659087, 16.77465080396773, -134.6150104220083, -64.38422722115514, -115.29952138008386, -31.68550541438629, -16.482406986809725, -53.88240549234682, -98.68181879521083, -90.34706164734207, 4.842788224344352, -109.91298664249223, -53.90975386670441, -173.84852909614506, -2.6002916551361164, -6.6205156510098275, -40.23326209791872, -161.5571786131643, -53.03610897610701, -6.361984767456795, -138.57901761435465, -25.696400112392375, -167.38783884937146, -187.18431645281672, -56.0104192787821, -160.8343304777829, -164.7978913891004, -160.4549652047012, -45.49595436706098, -0.5624079399154605, -72.8298419977438, -76.61278523925701, 13.931106039568357, 19.6799892479173, -88.72493955099118, -169.81674635718565, -4.840685409281105, -32.701621109839714, -13.606902334981978, -3.8787466657262586, -124.92760509726996, 9.517647559403168, -206.70726876625073], "episode_lengths": [49, 75, 31, 36, 66, 76, 77, 53, 85, 52, 73, 87, 57, 33, 50, 75, 47, 58, 98, 54, 80, 46, 57, 84, 60, 76, 81, 60, 59, 76, 96, 83, 48, 42, 74, 74, 89, 59, 58, 86, 86, 33, 42, 56, 61, 79, 82, 53, 92, 88, 80, 57, 55, 86, 48, 71, 42, 48, 32, 79, 61, 75, 49, 53, 59, 70, 69, 41, 74, 64, 87, 39, 41, 56, 85, 58, 45, 79, 52, 85, 89, 57, 88, 86, 85, 54, 44, 66, 68, 33, 34, 67, 86, 43, 48, 56, 50, 77, 40, 96], "policy_policy_0_reward": [0.9058497636492941, -111.53050079545143, 15.821167546374776, 12.441265712617344, -71.82269927168566, -116.47771461644268, -116.1452784951522, -40.328095760951, -157.67654526694108, -27.946148051234445, -103.76531295887011, -160.40452493288768, -22.09078861673128, 19.433877083617322, -25.78867058191631, -99.6345477759011, -0.698770235081756, -55.87168888120657, -218.51322380068132, -7.6130919384343665, -140.13910724814914, 1.2302667754198535, -54.11437987212791, -152.46525300684092, -32.4422792311313, -64.4909924165872, -140.90765142652174, -26.170420764487538, -62.214141302574085, -120.23294844194953, -206.04734606264552, -145.94469348924753, -12.306589418637994, -4.0293780495183675, -113.4465489441963, -110.75515878046508, -170.41008720631532, -32.37510820381291, -25.28206484574313, -148.27882631960608, -171.81675362080395, 19.73871498537328, 6.616629957981161, -16.44834341505327, -44.041192898263894, -134.13155554427007, -150.51981824599392, -12.794358728576825, -194.12065953703, -173.8994211093029, -120.50716603087542, -25.862939983886083, -47.60844103089296, -161.4906105358328, -29.578659228514788, -95.34703179735725, 1.215825884251316, -30.996201250659087, 16.77465080396773, -134.6150104220083, -64.38422722115514, -115.29952138008386, -31.68550541438629, -16.482406986809725, -53.88240549234682, -98.68181879521083, -90.34706164734207, 4.842788224344352, -109.91298664249223, -53.90975386670441, -173.84852909614506, -2.6002916551361164, -6.6205156510098275, -40.23326209791872, -161.5571786131643, -53.03610897610701, -6.361984767456795, -138.57901761435465, -25.696400112392375, -167.38783884937146, -187.18431645281672, -56.0104192787821, -160.8343304777829, -164.7978913891004, -160.4549652047012, -45.49595436706098, -0.5624079399154605, -72.8298419977438, -76.61278523925701, 13.931106039568357, 19.6799892479173, -88.72493955099118, -169.81674635718565, -4.840685409281105, -32.701621109839714, -13.606902334981978, -3.8787466657262586, -124.92760509726996, 9.517647559403168, -206.70726876625073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253776446285936, "mean_inference_ms": 1.567092276596359, "mean_action_processing_ms": 0.2537368518968697, "mean_env_wait_ms": 3.734317969936998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011710643768310547, "StateBufferConnector_ms": 0.0073893070220947266, "ViewRequirementAgentConnector_ms": 0.17937612533569336}, "num_episodes": 63, "episode_return_max": 19.73871498537328, "episode_return_min": -218.51322380068132, "episode_return_mean": -74.80483203323237, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.0584480665071, "num_env_steps_trained_throughput_per_sec": 334.0584480665071, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 11111.162, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11111.09, "sample_time_ms": 1336.826, "learn_time_ms": 9710.751, "learn_throughput": 411.915, "synch_weights_time_ms": 62.731}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "8adec_00000", "date": "2024-07-24_15-17-11", "timestamp": 1721814431, "time_this_iter_s": 11.9850013256073, "time_total_s": 898.7947127819061, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b958d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 898.7947127819061, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 19.194117647058828, "ram_util_percent": 37.923529411764704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.16003634879986, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.13086289861093975, "policy_loss": -0.008445630072674248, "vf_loss": 0.12197687533528855, "vf_explained_var": 0.9997831764320533, "kl": 0.013566535029773804, "entropy": -0.3595536493405234, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "env_runners": {"episode_reward_max": 21.574636812587038, "episode_reward_min": -211.86171724185812, "episode_reward_mean": -60.136354270603036, "episode_len_mean": 59.62, "episode_media": {}, "episodes_timesteps_total": 5962, "policy_reward_min": {"policy_0": -211.86171724185812}, "policy_reward_max": {"policy_0": 21.574636812587038}, "policy_reward_mean": {"policy_0": -60.136354270603036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.6002916551361164, -6.6205156510098275, -40.23326209791872, -161.5571786131643, -53.03610897610701, -6.361984767456795, -138.57901761435465, -25.696400112392375, -167.38783884937146, -187.18431645281672, -56.0104192787821, -160.8343304777829, -164.7978913891004, -160.4549652047012, -45.49595436706098, -0.5624079399154605, -72.8298419977438, -76.61278523925701, 13.931106039568357, 19.6799892479173, -88.72493955099118, -169.81674635718565, -4.840685409281105, -32.701621109839714, -13.606902334981978, -3.8787466657262586, -124.92760509726996, 9.517647559403168, -206.70726876625073, 18.27391615371507, -23.146825212544027, -211.86171724185812, -107.0989331185744, -144.22923292264682, -25.16590420370766, -67.57293942925553, 14.611577311805465, -69.83388266470946, -0.9416206929464337, -4.815016353406423, -45.552108739600385, -14.194773668618627, -26.293532369436058, -91.42248195213621, -59.60781092079108, -97.49215298200731, -202.43634318816942, -160.1034919490851, -65.82109522159176, 0.678498925991416, 15.127396759146773, 7.884661820458504, -128.9024622068326, -172.86076711761294, 12.016223324629758, 13.390469065518177, 0.71217351480465, 6.893837774869859, -41.4385614924107, -46.916466015248915, -7.636680307197446, 7.666394492246848, -1.216543951452941, -84.10379252192388, -88.67276916980248, -101.4957446020697, -170.745362984775, -17.75503716323277, -29.961196514809615, -88.60982537813645, -124.69741553954667, -159.1073056539185, -80.74240436270208, -3.838860687500025, -51.02210183917103, -36.15852954439042, -22.797424772322817, -91.01366646518973, -50.133463773511146, 15.202604398715375, -59.99616115922495, 6.109026523857353, -103.19815921671479, -123.12569114864807, 11.613585936575298, -62.9731790912902, -87.28246928450073, 12.18100359431697, 2.7372509302334658, 14.478467190312237, -133.78909868892956, -179.6316735361597, -5.136127726950466, 21.574636812587038, -56.68858280590501, -70.62528034893911, -51.32438098449163, -21.785152887908513, -13.756561761555565, -79.12710492531754], "episode_lengths": [39, 41, 56, 85, 58, 45, 79, 52, 85, 89, 57, 88, 86, 85, 54, 44, 66, 68, 33, 34, 67, 86, 43, 48, 56, 50, 77, 40, 96, 28, 49, 97, 77, 81, 60, 65, 34, 72, 40, 41, 58, 53, 55, 67, 59, 80, 94, 85, 62, 51, 34, 34, 78, 91, 32, 36, 43, 37, 54, 55, 53, 41, 41, 66, 68, 73, 86, 56, 57, 69, 81, 84, 65, 42, 64, 50, 58, 69, 59, 32, 58, 40, 74, 78, 35, 63, 69, 31, 39, 29, 79, 90, 50, 32, 60, 69, 57, 59, 46, 81], "policy_policy_0_reward": [-2.6002916551361164, -6.6205156510098275, -40.23326209791872, -161.5571786131643, -53.03610897610701, -6.361984767456795, -138.57901761435465, -25.696400112392375, -167.38783884937146, -187.18431645281672, -56.0104192787821, -160.8343304777829, -164.7978913891004, -160.4549652047012, -45.49595436706098, -0.5624079399154605, -72.8298419977438, -76.61278523925701, 13.931106039568357, 19.6799892479173, -88.72493955099118, -169.81674635718565, -4.840685409281105, -32.701621109839714, -13.606902334981978, -3.8787466657262586, -124.92760509726996, 9.517647559403168, -206.70726876625073, 18.27391615371507, -23.146825212544027, -211.86171724185812, -107.0989331185744, -144.22923292264682, -25.16590420370766, -67.57293942925553, 14.611577311805465, -69.83388266470946, -0.9416206929464337, -4.815016353406423, -45.552108739600385, -14.194773668618627, -26.293532369436058, -91.42248195213621, -59.60781092079108, -97.49215298200731, -202.43634318816942, -160.1034919490851, -65.82109522159176, 0.678498925991416, 15.127396759146773, 7.884661820458504, -128.9024622068326, -172.86076711761294, 12.016223324629758, 13.390469065518177, 0.71217351480465, 6.893837774869859, -41.4385614924107, -46.916466015248915, -7.636680307197446, 7.666394492246848, -1.216543951452941, -84.10379252192388, -88.67276916980248, -101.4957446020697, -170.745362984775, -17.75503716323277, -29.961196514809615, -88.60982537813645, -124.69741553954667, -159.1073056539185, -80.74240436270208, -3.838860687500025, -51.02210183917103, -36.15852954439042, -22.797424772322817, -91.01366646518973, -50.133463773511146, 15.202604398715375, -59.99616115922495, 6.109026523857353, -103.19815921671479, -123.12569114864807, 11.613585936575298, -62.9731790912902, -87.28246928450073, 12.18100359431697, 2.7372509302334658, 14.478467190312237, -133.78909868892956, -179.6316735361597, -5.136127726950466, 21.574636812587038, -56.68858280590501, -70.62528034893911, -51.32438098449163, -21.785152887908513, -13.756561761555565, -79.12710492531754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5254120394511222, "mean_inference_ms": 1.5669741620155855, "mean_action_processing_ms": 0.25373634224498876, "mean_env_wait_ms": 3.73798169940924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011408805847167969, "StateBufferConnector_ms": 0.00733184814453125, "ViewRequirementAgentConnector_ms": 0.17994403839111328}, "num_episodes": 71, "episode_return_max": 21.574636812587038, "episode_return_min": -211.86171724185812, "episode_return_mean": -60.136354270603036, "episodes_this_iter": 71}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.87282197978107, "num_env_steps_trained_throughput_per_sec": 315.87282197978107, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 11100.213, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11100.139, "sample_time_ms": 1337.023, "learn_time_ms": 9699.699, "learn_throughput": 412.384, "synch_weights_time_ms": 62.645}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "training_iteration": 77, "trial_id": "8adec_00000", "date": "2024-07-24_15-17-24", "timestamp": 1721814444, "time_this_iter_s": 12.67622709274292, "time_total_s": 911.470939874649, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 911.470939874649, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.116666666666667, "ram_util_percent": 37.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.75041107982397, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.16215085903386353, "policy_loss": -0.006519583460370389, "vf_loss": 0.15027600918741277, "vf_explained_var": 0.9997064258282383, "kl": 0.014682255014577095, "entropy": -0.3528649460078062, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 21.574636812587038, "episode_reward_min": -190.38678471238174, "episode_reward_mean": -54.44586932352124, "episode_len_mean": 59.06, "episode_media": {}, "episodes_timesteps_total": 5906, "policy_reward_min": {"policy_0": -190.38678471238174}, "policy_reward_max": {"policy_0": 21.574636812587038}, "policy_reward_mean": {"policy_0": -54.44586932352124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.75503716323277, -29.961196514809615, -88.60982537813645, -124.69741553954667, -159.1073056539185, -80.74240436270208, -3.838860687500025, -51.02210183917103, -36.15852954439042, -22.797424772322817, -91.01366646518973, -50.133463773511146, 15.202604398715375, -59.99616115922495, 6.109026523857353, -103.19815921671479, -123.12569114864807, 11.613585936575298, -62.9731790912902, -87.28246928450073, 12.18100359431697, 2.7372509302334658, 14.478467190312237, -133.78909868892956, -179.6316735361597, -5.136127726950466, 21.574636812587038, -56.68858280590501, -70.62528034893911, -51.32438098449163, -21.785152887908513, -13.756561761555565, -79.12710492531754, -71.6244977768732, 11.382559217949694, -3.3131226971176693, -170.5551574287039, -56.85919592349872, -78.17164420313489, -53.342492873751084, -71.03754409041977, -190.38678471238174, -141.38238933928122, -64.66481342633409, 3.9376895656051856, 12.602520435300821, -8.420086685123156, -150.35537942708712, -146.02366579216687, 2.5312171439455113, -11.083764841347485, 0.16837951958172281, 2.8515160300893063, -74.60051723785129, 6.891668204908022, -21.322902938069298, -173.68045593641267, -21.25565728859633, -0.7939096866152833, -71.4207033825237, -92.66285917893204, -159.42642435646, -75.34205974340513, -2.4718663254050384, -93.45580770758426, -108.88507621302921, -46.82430671656902, -73.94879941657871, -0.6951251202333915, -165.0933902442018, -92.72849576941037, -37.90264249429129, -65.0036124826308, -58.851377481909765, -68.80471483140101, -49.91080164852718, -12.554892356469702, -88.66925068680679, -81.70542118985709, 0.22363925025923348, -18.24335122508354, 17.912751348989666, -149.10243569142756, -41.64239579162145, 10.366339774930356, -15.839187628948782, -8.375149415832103, -9.082883515657747, -161.84187373285297, -5.899066834673285, 13.352173025596107, -64.60084225789696, -36.262177812818116, -98.71486399420269, -0.6965406989907943, -40.97467912965578, 9.530259737784961, -18.29426505771504, -115.8836351854677, -75.2724081088583], "episode_lengths": [56, 57, 69, 81, 84, 65, 42, 64, 50, 58, 69, 59, 32, 58, 40, 74, 78, 35, 63, 69, 31, 39, 29, 79, 90, 50, 32, 60, 69, 57, 59, 46, 81, 62, 40, 39, 86, 66, 79, 57, 65, 92, 82, 61, 43, 35, 46, 85, 85, 40, 44, 41, 35, 69, 42, 58, 88, 48, 38, 68, 69, 84, 64, 44, 72, 73, 55, 65, 47, 86, 71, 61, 62, 60, 68, 59, 53, 69, 65, 46, 56, 32, 82, 60, 40, 54, 47, 54, 85, 41, 40, 64, 55, 72, 48, 55, 45, 45, 75, 64], "policy_policy_0_reward": [-17.75503716323277, -29.961196514809615, -88.60982537813645, -124.69741553954667, -159.1073056539185, -80.74240436270208, -3.838860687500025, -51.02210183917103, -36.15852954439042, -22.797424772322817, -91.01366646518973, -50.133463773511146, 15.202604398715375, -59.99616115922495, 6.109026523857353, -103.19815921671479, -123.12569114864807, 11.613585936575298, -62.9731790912902, -87.28246928450073, 12.18100359431697, 2.7372509302334658, 14.478467190312237, -133.78909868892956, -179.6316735361597, -5.136127726950466, 21.574636812587038, -56.68858280590501, -70.62528034893911, -51.32438098449163, -21.785152887908513, -13.756561761555565, -79.12710492531754, -71.6244977768732, 11.382559217949694, -3.3131226971176693, -170.5551574287039, -56.85919592349872, -78.17164420313489, -53.342492873751084, -71.03754409041977, -190.38678471238174, -141.38238933928122, -64.66481342633409, 3.9376895656051856, 12.602520435300821, -8.420086685123156, -150.35537942708712, -146.02366579216687, 2.5312171439455113, -11.083764841347485, 0.16837951958172281, 2.8515160300893063, -74.60051723785129, 6.891668204908022, -21.322902938069298, -173.68045593641267, -21.25565728859633, -0.7939096866152833, -71.4207033825237, -92.66285917893204, -159.42642435646, -75.34205974340513, -2.4718663254050384, -93.45580770758426, -108.88507621302921, -46.82430671656902, -73.94879941657871, -0.6951251202333915, -165.0933902442018, -92.72849576941037, -37.90264249429129, -65.0036124826308, -58.851377481909765, -68.80471483140101, -49.91080164852718, -12.554892356469702, -88.66925068680679, -81.70542118985709, 0.22363925025923348, -18.24335122508354, 17.912751348989666, -149.10243569142756, -41.64239579162145, 10.366339774930356, -15.839187628948782, -8.375149415832103, -9.082883515657747, -161.84187373285297, -5.899066834673285, 13.352173025596107, -64.60084225789696, -36.262177812818116, -98.71486399420269, -0.6965406989907943, -40.97467912965578, 9.530259737784961, -18.29426505771504, -115.8836351854677, -75.2724081088583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525768745483552, "mean_inference_ms": 1.5671397192770573, "mean_action_processing_ms": 0.25391035841895365, "mean_env_wait_ms": 3.741166345688699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011798381805419922, "StateBufferConnector_ms": 0.007685422897338867, "ViewRequirementAgentConnector_ms": 0.1883535385131836}, "num_episodes": 67, "episode_return_max": 21.574636812587038, "episode_return_min": -190.38678471238174, "episode_return_mean": -54.44586932352124, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.6638043031905, "num_env_steps_trained_throughput_per_sec": 362.6638043031905, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 10994.717, "restore_workers_time_ms": 0.029, "training_step_time_ms": 10994.642, "sample_time_ms": 1340.067, "learn_time_ms": 9591.539, "learn_throughput": 417.034, "synch_weights_time_ms": 62.27}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 78, "trial_id": "8adec_00000", "date": "2024-07-24_15-17-35", "timestamp": 1721814455, "time_this_iter_s": 11.040937185287476, "time_total_s": 922.5118770599365, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 922.5118770599365, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 20.25, "ram_util_percent": 37.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.62391139616569, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1393701835651882, "policy_loss": -0.009954096234287136, "vf_loss": 0.1314056293029959, "vf_explained_var": 0.9997489079833031, "kl": 0.0142803156605321, "entropy": -0.345982962140503, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "env_runners": {"episode_reward_max": 17.912751348989666, "episode_reward_min": -179.5049406887513, "episode_reward_mean": -46.75919864958799, "episode_len_mean": 58.19, "episode_media": {}, "episodes_timesteps_total": 5819, "policy_reward_min": {"policy_0": -179.5049406887513}, "policy_reward_max": {"policy_0": 17.912751348989666}, "policy_reward_mean": {"policy_0": -46.75919864958799}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.72849576941037, -37.90264249429129, -65.0036124826308, -58.851377481909765, -68.80471483140101, -49.91080164852718, -12.554892356469702, -88.66925068680679, -81.70542118985709, 0.22363925025923348, -18.24335122508354, 17.912751348989666, -149.10243569142756, -41.64239579162145, 10.366339774930356, -15.839187628948782, -8.375149415832103, -9.082883515657747, -161.84187373285297, -5.899066834673285, 13.352173025596107, -64.60084225789696, -36.262177812818116, -98.71486399420269, -0.6965406989907943, -40.97467912965578, 9.530259737784961, -18.29426505771504, -115.8836351854677, -75.2724081088583, -75.37350916381646, -54.465859154633534, -37.42215868051583, -90.52308924577768, -14.232237363383245, -69.34945623474368, -48.59571694309752, -23.663883463483305, -54.07814252782589, -18.97520306137939, -19.87503401392816, -141.32782453189418, -67.47700435600287, -71.2339946925066, -49.45245033278261, 3.293478962349469, -2.9170768089434174, -33.525461140915596, -19.86854876565089, -49.26815732796973, -84.66223416227284, 9.14708066749115, -64.23388453718884, 9.08561804994708, -5.117365020472969, -59.39516582036022, -105.2475105344413, -8.495204231495165, -4.295156888290192, -1.41429672535703, -71.68968557119938, -44.12474879840345, -95.60328382174124, -9.20042232414264, -56.90981278680603, -176.86080681572827, -109.35762713844493, 11.831651371707647, -8.295626621613897, 14.33633689827327, -22.904493964228667, 4.398246671750468, -8.387950259002062, -88.86304327664594, -161.94073439971285, -9.865936578483717, -101.6893021592831, -147.40293748222936, 8.41489964574781, 13.807922678695162, -17.437354393232184, -79.8826481089338, -179.5049406887513, -55.556259954833, 7.433837917358415, -66.33626324527006, -31.264382109474127, -23.149494691759422, -5.89974417474121, -93.94099097869889, -32.46110971567736, -143.51382204909225, -47.429347026979634, -38.26224824570695, -32.14347527671939, 17.415818834547213, -81.56893644221222, -18.31063930591536, -10.330034124911263, -65.03922651151689], "episode_lengths": [71, 61, 62, 60, 68, 59, 53, 69, 65, 46, 56, 32, 82, 60, 40, 54, 47, 54, 85, 41, 40, 64, 55, 72, 48, 55, 45, 45, 75, 64, 77, 60, 61, 71, 42, 63, 59, 49, 57, 46, 50, 81, 62, 64, 59, 37, 47, 59, 51, 64, 67, 43, 70, 33, 46, 66, 82, 54, 44, 47, 67, 54, 76, 50, 59, 88, 73, 32, 44, 36, 57, 44, 49, 74, 88, 50, 72, 85, 34, 41, 54, 78, 91, 63, 38, 61, 54, 54, 52, 77, 50, 86, 63, 54, 53, 32, 77, 50, 53, 67], "policy_policy_0_reward": [-92.72849576941037, -37.90264249429129, -65.0036124826308, -58.851377481909765, -68.80471483140101, -49.91080164852718, -12.554892356469702, -88.66925068680679, -81.70542118985709, 0.22363925025923348, -18.24335122508354, 17.912751348989666, -149.10243569142756, -41.64239579162145, 10.366339774930356, -15.839187628948782, -8.375149415832103, -9.082883515657747, -161.84187373285297, -5.899066834673285, 13.352173025596107, -64.60084225789696, -36.262177812818116, -98.71486399420269, -0.6965406989907943, -40.97467912965578, 9.530259737784961, -18.29426505771504, -115.8836351854677, -75.2724081088583, -75.37350916381646, -54.465859154633534, -37.42215868051583, -90.52308924577768, -14.232237363383245, -69.34945623474368, -48.59571694309752, -23.663883463483305, -54.07814252782589, -18.97520306137939, -19.87503401392816, -141.32782453189418, -67.47700435600287, -71.2339946925066, -49.45245033278261, 3.293478962349469, -2.9170768089434174, -33.525461140915596, -19.86854876565089, -49.26815732796973, -84.66223416227284, 9.14708066749115, -64.23388453718884, 9.08561804994708, -5.117365020472969, -59.39516582036022, -105.2475105344413, -8.495204231495165, -4.295156888290192, -1.41429672535703, -71.68968557119938, -44.12474879840345, -95.60328382174124, -9.20042232414264, -56.90981278680603, -176.86080681572827, -109.35762713844493, 11.831651371707647, -8.295626621613897, 14.33633689827327, -22.904493964228667, 4.398246671750468, -8.387950259002062, -88.86304327664594, -161.94073439971285, -9.865936578483717, -101.6893021592831, -147.40293748222936, 8.41489964574781, 13.807922678695162, -17.437354393232184, -79.8826481089338, -179.5049406887513, -55.556259954833, 7.433837917358415, -66.33626324527006, -31.264382109474127, -23.149494691759422, -5.89974417474121, -93.94099097869889, -32.46110971567736, -143.51382204909225, -47.429347026979634, -38.26224824570695, -32.14347527671939, 17.415818834547213, -81.56893644221222, -18.31063930591536, -10.330034124911263, -65.03922651151689]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5257432803315081, "mean_inference_ms": 1.5673743544952623, "mean_action_processing_ms": 0.254019998510131, "mean_env_wait_ms": 3.743724506600913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01161336898803711, "StateBufferConnector_ms": 0.007752895355224609, "ViewRequirementAgentConnector_ms": 0.18788862228393555}, "num_episodes": 70, "episode_return_max": 17.912751348989666, "episode_return_min": -179.5049406887513, "episode_return_mean": -46.75919864958799, "episodes_this_iter": 70}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.5137067305777, "num_env_steps_trained_throughput_per_sec": 429.5137067305777, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 11078.879, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11078.804, "sample_time_ms": 1341.142, "learn_time_ms": 9674.438, "learn_throughput": 413.461, "synch_weights_time_ms": 62.458}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "training_iteration": 79, "trial_id": "8adec_00000", "date": "2024-07-24_15-17-44", "timestamp": 1721814464, "time_this_iter_s": 9.32490849494934, "time_total_s": 931.8367855548859, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8eb5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 931.8367855548859, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.49230769230769, "ram_util_percent": 37.87692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.58460524330537, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.16105191910319264, "policy_loss": -0.009249330183471708, "vf_loss": 0.1528544277496015, "vf_explained_var": 0.9997297617296378, "kl": 0.01374093021258892, "entropy": -0.3534129274232934, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 21.892138894419556, "episode_reward_min": -221.9361033227873, "episode_reward_mean": -62.32059687485403, "episode_len_mean": 61.92, "episode_media": {}, "episodes_timesteps_total": 6192, "policy_reward_min": {"policy_0": -221.9361033227873}, "policy_reward_max": {"policy_0": 21.892138894419556}, "policy_reward_mean": {"policy_0": -62.32059687485403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.295156888290192, -1.41429672535703, -71.68968557119938, -44.12474879840345, -95.60328382174124, -9.20042232414264, -56.90981278680603, -176.86080681572827, -109.35762713844493, 11.831651371707647, -8.295626621613897, 14.33633689827327, -22.904493964228667, 4.398246671750468, -8.387950259002062, -88.86304327664594, -161.94073439971285, -9.865936578483717, -101.6893021592831, -147.40293748222936, 8.41489964574781, 13.807922678695162, -17.437354393232184, -79.8826481089338, -179.5049406887513, -55.556259954833, 7.433837917358415, -66.33626324527006, -31.264382109474127, -23.149494691759422, -5.89974417474121, -93.94099097869889, -32.46110971567736, -143.51382204909225, -47.429347026979634, -38.26224824570695, -32.14347527671939, 17.415818834547213, -81.56893644221222, -18.31063930591536, -10.330034124911263, -65.03922651151689, -21.20273229082961, -165.6453481715999, 1.9480447721772425, 10.276709494925372, -139.95234672038987, -30.171492140762062, -56.52687641037742, -81.06165873625983, -77.49196763401753, -54.74174836899611, -11.541701272565911, -64.04851943027589, -51.44998323614124, -111.62232538182946, -35.8778425699883, -97.94180187614272, -114.70793948012152, -7.395877488653299, -29.803359615486972, 11.82849606488011, -32.091413893059844, -79.59924436815949, -12.59593239101062, -54.455976643859444, -36.69766728543329, -54.16032932519355, -174.64841700425038, -53.174212029908325, -74.5072962546883, -142.96084746441122, -1.6582227611743314, -71.23241772584086, 21.892138894419556, -38.85813190472748, -32.172022890970695, -138.14415844678445, -115.61223997807507, -3.2024700310159084, -84.00605276565976, -107.84650306325211, -190.6811773020968, 15.234458112198679, -79.60429202795162, -174.9027411720698, -121.88251907414904, 18.272506531816113, -221.9361033227873, -49.29601354172288, -199.90895553235427, -97.66378445024701, -93.33412967352226, -55.650984573451886, -91.44378811927713, -15.427050863383219, -64.43608369629139, -102.7429844950539, -142.71340000865482, -87.88288781323689], "episode_lengths": [44, 47, 67, 54, 76, 50, 59, 88, 73, 32, 44, 36, 57, 44, 49, 74, 88, 50, 72, 85, 34, 41, 54, 78, 91, 63, 38, 61, 54, 54, 52, 77, 50, 86, 63, 54, 53, 32, 77, 50, 53, 67, 56, 86, 39, 34, 79, 54, 60, 70, 67, 58, 46, 61, 59, 75, 50, 71, 80, 49, 53, 33, 50, 67, 55, 63, 52, 64, 88, 61, 72, 83, 46, 71, 27, 55, 52, 79, 75, 46, 80, 74, 91, 32, 67, 89, 80, 37, 100, 56, 96, 71, 79, 63, 72, 54, 65, 79, 83, 67], "policy_policy_0_reward": [-4.295156888290192, -1.41429672535703, -71.68968557119938, -44.12474879840345, -95.60328382174124, -9.20042232414264, -56.90981278680603, -176.86080681572827, -109.35762713844493, 11.831651371707647, -8.295626621613897, 14.33633689827327, -22.904493964228667, 4.398246671750468, -8.387950259002062, -88.86304327664594, -161.94073439971285, -9.865936578483717, -101.6893021592831, -147.40293748222936, 8.41489964574781, 13.807922678695162, -17.437354393232184, -79.8826481089338, -179.5049406887513, -55.556259954833, 7.433837917358415, -66.33626324527006, -31.264382109474127, -23.149494691759422, -5.89974417474121, -93.94099097869889, -32.46110971567736, -143.51382204909225, -47.429347026979634, -38.26224824570695, -32.14347527671939, 17.415818834547213, -81.56893644221222, -18.31063930591536, -10.330034124911263, -65.03922651151689, -21.20273229082961, -165.6453481715999, 1.9480447721772425, 10.276709494925372, -139.95234672038987, -30.171492140762062, -56.52687641037742, -81.06165873625983, -77.49196763401753, -54.74174836899611, -11.541701272565911, -64.04851943027589, -51.44998323614124, -111.62232538182946, -35.8778425699883, -97.94180187614272, -114.70793948012152, -7.395877488653299, -29.803359615486972, 11.82849606488011, -32.091413893059844, -79.59924436815949, -12.59593239101062, -54.455976643859444, -36.69766728543329, -54.16032932519355, -174.64841700425038, -53.174212029908325, -74.5072962546883, -142.96084746441122, -1.6582227611743314, -71.23241772584086, 21.892138894419556, -38.85813190472748, -32.172022890970695, -138.14415844678445, -115.61223997807507, -3.2024700310159084, -84.00605276565976, -107.84650306325211, -190.6811773020968, 15.234458112198679, -79.60429202795162, -174.9027411720698, -121.88251907414904, 18.272506531816113, -221.9361033227873, -49.29601354172288, -199.90895553235427, -97.66378445024701, -93.33412967352226, -55.650984573451886, -91.44378811927713, -15.427050863383219, -64.43608369629139, -102.7429844950539, -142.71340000865482, -87.88288781323689]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5257794640280986, "mean_inference_ms": 1.5659062076864274, "mean_action_processing_ms": 0.25365505277489464, "mean_env_wait_ms": 3.7419641627104214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011212825775146484, "StateBufferConnector_ms": 0.007344245910644531, "ViewRequirementAgentConnector_ms": 0.1765763759613037}, "num_episodes": 58, "episode_return_max": 21.892138894419556, "episode_return_min": -221.9361033227873, "episode_return_mean": -62.32059687485403, "episodes_this_iter": 58}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.288600730227, "num_env_steps_trained_throughput_per_sec": 306.288600730227, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 11347.661, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11347.589, "sample_time_ms": 1339.991, "learn_time_ms": 9952.988, "learn_throughput": 401.889, "synch_weights_time_ms": 53.859}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 80, "trial_id": "8adec_00000", "date": "2024-07-24_15-17-58", "timestamp": 1721814478, "time_this_iter_s": 13.069008111953735, "time_total_s": 944.9057936668396, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6bc65e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 944.9057936668396, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 18.347368421052632, "ram_util_percent": 37.815789473684205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.30623512417078, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.14161120127052224, "policy_loss": -0.005043627190752886, "vf_loss": 0.12848874621558934, "vf_explained_var": 0.9997560173273087, "kl": 0.014536980520642888, "entropy": -0.3447388716003237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": 21.892138894419556, "episode_reward_min": -221.9361033227873, "episode_reward_mean": -66.02897266050292, "episode_len_mean": 62.67, "episode_media": {}, "episodes_timesteps_total": 6267, "policy_reward_min": {"policy_0": -221.9361033227873}, "policy_reward_max": {"policy_0": 21.892138894419556}, "policy_reward_mean": {"policy_0": -66.02897266050292}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.64841700425038, -53.174212029908325, -74.5072962546883, -142.96084746441122, -1.6582227611743314, -71.23241772584086, 21.892138894419556, -38.85813190472748, -32.172022890970695, -138.14415844678445, -115.61223997807507, -3.2024700310159084, -84.00605276565976, -107.84650306325211, -190.6811773020968, 15.234458112198679, -79.60429202795162, -174.9027411720698, -121.88251907414904, 18.272506531816113, -221.9361033227873, -49.29601354172288, -199.90895553235427, -97.66378445024701, -93.33412967352226, -55.650984573451886, -91.44378811927713, -15.427050863383219, -64.43608369629139, -102.7429844950539, -142.71340000865482, -87.88288781323689, -176.4655735230798, 8.847981490385877, -21.95350908024751, -39.042885637160886, -30.130542788976285, -9.570111949039331, -20.48971894272505, -6.277622997703536, -146.21952944170582, -202.62245055967216, -89.80004326038086, 0.6394869568074677, 1.6106850741373382, -51.2366064505053, -37.92752472150682, -32.733436495522305, -80.19391586854788, -96.26481211578479, -40.6996342152432, -76.8360457424547, -30.479241872382396, -146.94908290560306, -32.95962192504303, -103.74889697684334, -193.1658268851022, -94.64670263867512, -94.82413354478619, -80.09664337460974, 13.444713197907825, -187.28987497511196, -85.82895792744557, -43.73647688850694, -22.080104405738116, -14.832450530581358, -65.77489010430887, -17.190540084423947, 2.572623012576357, -17.287683618093354, -13.89357413425114, -40.16785319259084, -111.34054292580583, -12.333807809791683, 0.9086870010962984, -98.87933145840988, -97.30414117987337, -13.063245283432115, 13.67679712655626, 12.581531623907974, 12.930640175258072, -73.09597551044466, -59.253161362382244, -40.70211813320088, -24.34346604383357, -111.88861639505434, -114.56372956805994, -17.32827711106057, -79.90107068796358, 14.364229408404398, -38.885006553971415, -39.870602738662896, -53.88195287656769, -113.11217075302856, -84.49527848700448, 8.140445169845597, -107.0459800773008, -26.95750390429723, -20.813442674332457, -138.00836052976848], "episode_lengths": [88, 61, 72, 83, 46, 71, 27, 55, 52, 79, 75, 46, 80, 74, 91, 32, 67, 89, 80, 37, 100, 56, 96, 71, 79, 63, 72, 54, 65, 79, 83, 67, 91, 43, 50, 52, 59, 51, 56, 50, 84, 93, 70, 41, 45, 54, 59, 54, 65, 70, 62, 67, 48, 87, 50, 72, 92, 71, 71, 66, 27, 92, 68, 62, 59, 56, 66, 53, 42, 50, 54, 51, 75, 47, 46, 72, 71, 52, 37, 32, 36, 70, 60, 52, 53, 75, 79, 49, 77, 33, 51, 55, 60, 75, 71, 38, 73, 58, 47, 80], "policy_policy_0_reward": [-174.64841700425038, -53.174212029908325, -74.5072962546883, -142.96084746441122, -1.6582227611743314, -71.23241772584086, 21.892138894419556, -38.85813190472748, -32.172022890970695, -138.14415844678445, -115.61223997807507, -3.2024700310159084, -84.00605276565976, -107.84650306325211, -190.6811773020968, 15.234458112198679, -79.60429202795162, -174.9027411720698, -121.88251907414904, 18.272506531816113, -221.9361033227873, -49.29601354172288, -199.90895553235427, -97.66378445024701, -93.33412967352226, -55.650984573451886, -91.44378811927713, -15.427050863383219, -64.43608369629139, -102.7429844950539, -142.71340000865482, -87.88288781323689, -176.4655735230798, 8.847981490385877, -21.95350908024751, -39.042885637160886, -30.130542788976285, -9.570111949039331, -20.48971894272505, -6.277622997703536, -146.21952944170582, -202.62245055967216, -89.80004326038086, 0.6394869568074677, 1.6106850741373382, -51.2366064505053, -37.92752472150682, -32.733436495522305, -80.19391586854788, -96.26481211578479, -40.6996342152432, -76.8360457424547, -30.479241872382396, -146.94908290560306, -32.95962192504303, -103.74889697684334, -193.1658268851022, -94.64670263867512, -94.82413354478619, -80.09664337460974, 13.444713197907825, -187.28987497511196, -85.82895792744557, -43.73647688850694, -22.080104405738116, -14.832450530581358, -65.77489010430887, -17.190540084423947, 2.572623012576357, -17.287683618093354, -13.89357413425114, -40.16785319259084, -111.34054292580583, -12.333807809791683, 0.9086870010962984, -98.87933145840988, -97.30414117987337, -13.063245283432115, 13.67679712655626, 12.581531623907974, 12.930640175258072, -73.09597551044466, -59.253161362382244, -40.70211813320088, -24.34346604383357, -111.88861639505434, -114.56372956805994, -17.32827711106057, -79.90107068796358, 14.364229408404398, -38.885006553971415, -39.870602738662896, -53.88195287656769, -113.11217075302856, -84.49527848700448, 8.140445169845597, -107.0459800773008, -26.95750390429723, -20.813442674332457, -138.00836052976848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5254392887452396, "mean_inference_ms": 1.5653565607424593, "mean_action_processing_ms": 0.2536862956263309, "mean_env_wait_ms": 3.741683538011784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011367559432983398, "StateBufferConnector_ms": 0.00754857063293457, "ViewRequirementAgentConnector_ms": 0.18314194679260254}, "num_episodes": 68, "episode_return_max": 21.892138894419556, "episode_return_min": -221.9361033227873, "episode_return_mean": -66.02897266050292, "episodes_this_iter": 68}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.95202214468054, "num_env_steps_trained_throughput_per_sec": 316.95202214468054, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 11350.866, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11350.795, "sample_time_ms": 1350.102, "learn_time_ms": 9946.325, "learn_throughput": 402.159, "synch_weights_time_ms": 53.617}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 81, "trial_id": "8adec_00000", "date": "2024-07-24_15-18-10", "timestamp": 1721814490, "time_this_iter_s": 12.631305694580078, "time_total_s": 957.5370993614197, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 957.5370993614197, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 19.15, "ram_util_percent": 37.86111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.74438657959302, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.14763309649812678, "policy_loss": -0.011036543389976335, "vf_loss": 0.14366723905938367, "vf_explained_var": 0.99975857163469, "kl": 0.011835354279173826, "entropy": -0.3019103993079625, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 23.007767365117527, "episode_reward_min": -191.00571770499843, "episode_reward_mean": -52.88261925651208, "episode_len_mean": 57.89, "episode_media": {}, "episodes_timesteps_total": 5789, "policy_reward_min": {"policy_0": -191.00571770499843}, "policy_reward_max": {"policy_0": 23.007767365117527}, "policy_reward_mean": {"policy_0": -52.88261925651208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.89357413425114, -40.16785319259084, -111.34054292580583, -12.333807809791683, 0.9086870010962984, -98.87933145840988, -97.30414117987337, -13.063245283432115, 13.67679712655626, 12.581531623907974, 12.930640175258072, -73.09597551044466, -59.253161362382244, -40.70211813320088, -24.34346604383357, -111.88861639505434, -114.56372956805994, -17.32827711106057, -79.90107068796358, 14.364229408404398, -38.885006553971415, -39.870602738662896, -53.88195287656769, -113.11217075302856, -84.49527848700448, 8.140445169845597, -107.0459800773008, -26.95750390429723, -20.813442674332457, -138.00836052976848, -135.40458427193207, -42.04718978765443, -61.440151658335715, -23.087288388476757, -13.225674232636457, 5.075812237227906, 18.400543091174583, -2.186477926973535, -0.8086337493492397, -32.77412554993401, 8.114132418355098, -150.7926635673453, -22.914399062335374, -129.54878803999696, -45.33012657840722, -82.44077972016554, -73.58026387988089, -32.81634475511448, -72.15094351163674, -136.73981116413563, 15.271308415551633, -46.77705677683077, 12.232981819834357, -112.71646434886368, -7.382489883987942, 23.007767365117527, -95.55484889425124, -94.18323045276107, -141.96155403128657, -149.1853086162202, -19.90138251038009, -191.00571770499843, -84.33736818073949, 10.820757451412591, -75.42414275893569, -58.03286153423005, -181.36650961532283, -44.31354620850944, -41.45360929678734, -70.87255094415788, 17.967149457559476, 7.646368621054371, -17.65993190316396, -131.60782083866334, -25.08972679218716, -132.37278211708093, -2.639181332684353, -99.64306406930862, -33.16620101993573, 3.3296813110752455, -127.47398530506177, -51.975149746477555, -3.825153804714204, 19.392562093577126, 2.419923136855229, -61.03241638928595, -106.5501830570795, -119.38449726680027, -184.13152912959882, 6.658301980317114, 3.607318667076714, 0.5286408080431388, -26.266493432263537, -56.83854934636736, -85.01000121821912, -62.07768185469052, -43.79330708838452, -109.93107799619105, -9.464173727550783, -12.518500601138769], "episode_lengths": [54, 51, 75, 47, 46, 72, 71, 52, 37, 32, 36, 70, 60, 52, 53, 75, 79, 49, 77, 33, 51, 55, 60, 75, 71, 38, 73, 58, 47, 80, 79, 60, 60, 51, 53, 34, 27, 45, 46, 56, 38, 83, 58, 77, 54, 68, 65, 50, 63, 80, 31, 56, 29, 74, 41, 28, 73, 81, 80, 84, 47, 92, 65, 39, 80, 60, 89, 57, 53, 67, 28, 35, 54, 79, 52, 79, 46, 71, 55, 43, 78, 61, 44, 28, 43, 67, 74, 75, 90, 45, 44, 40, 52, 58, 66, 61, 56, 74, 44, 45], "policy_policy_0_reward": [-13.89357413425114, -40.16785319259084, -111.34054292580583, -12.333807809791683, 0.9086870010962984, -98.87933145840988, -97.30414117987337, -13.063245283432115, 13.67679712655626, 12.581531623907974, 12.930640175258072, -73.09597551044466, -59.253161362382244, -40.70211813320088, -24.34346604383357, -111.88861639505434, -114.56372956805994, -17.32827711106057, -79.90107068796358, 14.364229408404398, -38.885006553971415, -39.870602738662896, -53.88195287656769, -113.11217075302856, -84.49527848700448, 8.140445169845597, -107.0459800773008, -26.95750390429723, -20.813442674332457, -138.00836052976848, -135.40458427193207, -42.04718978765443, -61.440151658335715, -23.087288388476757, -13.225674232636457, 5.075812237227906, 18.400543091174583, -2.186477926973535, -0.8086337493492397, -32.77412554993401, 8.114132418355098, -150.7926635673453, -22.914399062335374, -129.54878803999696, -45.33012657840722, -82.44077972016554, -73.58026387988089, -32.81634475511448, -72.15094351163674, -136.73981116413563, 15.271308415551633, -46.77705677683077, 12.232981819834357, -112.71646434886368, -7.382489883987942, 23.007767365117527, -95.55484889425124, -94.18323045276107, -141.96155403128657, -149.1853086162202, -19.90138251038009, -191.00571770499843, -84.33736818073949, 10.820757451412591, -75.42414275893569, -58.03286153423005, -181.36650961532283, -44.31354620850944, -41.45360929678734, -70.87255094415788, 17.967149457559476, 7.646368621054371, -17.65993190316396, -131.60782083866334, -25.08972679218716, -132.37278211708093, -2.639181332684353, -99.64306406930862, -33.16620101993573, 3.3296813110752455, -127.47398530506177, -51.975149746477555, -3.825153804714204, 19.392562093577126, 2.419923136855229, -61.03241638928595, -106.5501830570795, -119.38449726680027, -184.13152912959882, 6.658301980317114, 3.607318667076714, 0.5286408080431388, -26.266493432263537, -56.83854934636736, -85.01000121821912, -62.07768185469052, -43.79330708838452, -109.93107799619105, -9.464173727550783, -12.518500601138769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256731011506465, "mean_inference_ms": 1.565331147988859, "mean_action_processing_ms": 0.2539022770123343, "mean_env_wait_ms": 3.7470133828145564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011382341384887695, "StateBufferConnector_ms": 0.007539272308349609, "ViewRequirementAgentConnector_ms": 0.18303990364074707}, "num_episodes": 70, "episode_return_max": 23.007767365117527, "episode_return_min": -191.00571770499843, "episode_return_mean": -52.88261925651208, "episodes_this_iter": 70}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.22132754842966, "num_env_steps_trained_throughput_per_sec": 311.22132754842966, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 11514.748, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11514.674, "sample_time_ms": 1351.207, "learn_time_ms": 10108.475, "learn_throughput": 395.708, "synch_weights_time_ms": 54.241}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 82, "trial_id": "8adec_00000", "date": "2024-07-24_15-18-23", "timestamp": 1721814503, "time_this_iter_s": 12.864333868026733, "time_total_s": 970.4014332294464, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b9583a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 970.4014332294464, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.79444444444444, "ram_util_percent": 37.99444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.71153356532256, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.173965530016964, "policy_loss": -0.0061224410300686335, "vf_loss": 0.16234376097563655, "vf_explained_var": 0.999713346734643, "kl": 0.013872627329207472, "entropy": -0.36981741453831396, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "env_runners": {"episode_reward_max": 19.392562093577126, "episode_reward_min": -211.83913054811626, "episode_reward_mean": -56.46844281693662, "episode_len_mean": 59.71, "episode_media": {}, "episodes_timesteps_total": 5971, "policy_reward_min": {"policy_0": -211.83913054811626}, "policy_reward_max": {"policy_0": 19.392562093577126}, "policy_reward_mean": {"policy_0": -56.46844281693662}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.42414275893569, -58.03286153423005, -181.36650961532283, -44.31354620850944, -41.45360929678734, -70.87255094415788, 17.967149457559476, 7.646368621054371, -17.65993190316396, -131.60782083866334, -25.08972679218716, -132.37278211708093, -2.639181332684353, -99.64306406930862, -33.16620101993573, 3.3296813110752455, -127.47398530506177, -51.975149746477555, -3.825153804714204, 19.392562093577126, 2.419923136855229, -61.03241638928595, -106.5501830570795, -119.38449726680027, -184.13152912959882, 6.658301980317114, 3.607318667076714, 0.5286408080431388, -26.266493432263537, -56.83854934636736, -85.01000121821912, -62.07768185469052, -43.79330708838452, -109.93107799619105, -9.464173727550783, -12.518500601138769, -39.53032318997063, -13.28860999816018, -203.1691396229969, -89.44180258261817, -56.8854929732673, 5.577117987159571, -68.28237928708825, -27.990084880220284, 1.5525105459838142, -98.3033947126759, -93.59235131269702, -145.80123235272035, 0.36471751659296014, -90.45942516805306, -12.844197292453655, -64.22190577939283, 1.301744167667962, -211.83913054811626, -77.09814134917319, -171.3248114179595, -14.15580204247177, -2.7246530543951977, 8.512292397057434, 3.73657602660949, -26.90010926740167, -95.50432205517372, -5.872999279355363, -178.1563178473028, -201.9314919002485, -158.12281408263266, -35.16610102294769, -104.50945130081085, -0.5938792216232851, -14.039175452274158, -72.44920464115906, -44.45353111452639, 8.645960699641723, 1.2056354996003869, -66.10112815152615, -72.27049269894667, -48.17038835481982, -86.83142203284145, -133.12516865381707, 12.732109532995176, -113.26248763323986, 11.012591185739248, -19.545922173656347, -41.273380424771865, -31.488775050240882, 7.468240658632342, -75.4607433454226, -10.052550053481607, -73.52254653011238, 14.017493749904164, -99.24805163525802, 0.6354842353268564, -6.765346133650751, -23.510970093892332, -23.944159864568903, -158.46234653688188, -96.7439258282286, -68.1110226110848, -30.640009010583054, -114.05896201043004], "episode_lengths": [80, 60, 89, 57, 53, 67, 28, 35, 54, 79, 52, 79, 46, 71, 55, 43, 78, 61, 44, 28, 43, 67, 74, 75, 90, 45, 44, 40, 52, 58, 66, 61, 56, 74, 44, 45, 56, 52, 95, 69, 63, 40, 65, 51, 39, 73, 80, 80, 40, 70, 48, 62, 46, 97, 65, 88, 51, 49, 35, 39, 60, 85, 50, 92, 96, 88, 58, 72, 48, 45, 63, 55, 37, 47, 65, 66, 62, 76, 80, 36, 82, 33, 54, 56, 55, 35, 73, 45, 63, 36, 70, 39, 49, 57, 47, 89, 69, 68, 51, 73], "policy_policy_0_reward": [-75.42414275893569, -58.03286153423005, -181.36650961532283, -44.31354620850944, -41.45360929678734, -70.87255094415788, 17.967149457559476, 7.646368621054371, -17.65993190316396, -131.60782083866334, -25.08972679218716, -132.37278211708093, -2.639181332684353, -99.64306406930862, -33.16620101993573, 3.3296813110752455, -127.47398530506177, -51.975149746477555, -3.825153804714204, 19.392562093577126, 2.419923136855229, -61.03241638928595, -106.5501830570795, -119.38449726680027, -184.13152912959882, 6.658301980317114, 3.607318667076714, 0.5286408080431388, -26.266493432263537, -56.83854934636736, -85.01000121821912, -62.07768185469052, -43.79330708838452, -109.93107799619105, -9.464173727550783, -12.518500601138769, -39.53032318997063, -13.28860999816018, -203.1691396229969, -89.44180258261817, -56.8854929732673, 5.577117987159571, -68.28237928708825, -27.990084880220284, 1.5525105459838142, -98.3033947126759, -93.59235131269702, -145.80123235272035, 0.36471751659296014, -90.45942516805306, -12.844197292453655, -64.22190577939283, 1.301744167667962, -211.83913054811626, -77.09814134917319, -171.3248114179595, -14.15580204247177, -2.7246530543951977, 8.512292397057434, 3.73657602660949, -26.90010926740167, -95.50432205517372, -5.872999279355363, -178.1563178473028, -201.9314919002485, -158.12281408263266, -35.16610102294769, -104.50945130081085, -0.5938792216232851, -14.039175452274158, -72.44920464115906, -44.45353111452639, 8.645960699641723, 1.2056354996003869, -66.10112815152615, -72.27049269894667, -48.17038835481982, -86.83142203284145, -133.12516865381707, 12.732109532995176, -113.26248763323986, 11.012591185739248, -19.545922173656347, -41.273380424771865, -31.488775050240882, 7.468240658632342, -75.4607433454226, -10.052550053481607, -73.52254653011238, 14.017493749904164, -99.24805163525802, 0.6354842353268564, -6.765346133650751, -23.510970093892332, -23.944159864568903, -158.46234653688188, -96.7439258282286, -68.1110226110848, -30.640009010583054, -114.05896201043004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256678793698912, "mean_inference_ms": 1.5648016948239984, "mean_action_processing_ms": 0.25374017041697333, "mean_env_wait_ms": 3.747936209836652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011316776275634766, "StateBufferConnector_ms": 0.007603883743286133, "ViewRequirementAgentConnector_ms": 0.18130159378051758}, "num_episodes": 64, "episode_return_max": 19.392562093577126, "episode_return_min": -211.83913054811626, "episode_return_mean": -56.46844281693662, "episodes_this_iter": 64}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.26592571546684, "num_env_steps_trained_throughput_per_sec": 312.26592571546684, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 11683.237, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11683.162, "sample_time_ms": 1353.313, "learn_time_ms": 10274.318, "learn_throughput": 389.32, "synch_weights_time_ms": 54.76}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "training_iteration": 83, "trial_id": "8adec_00000", "date": "2024-07-24_15-18-36", "timestamp": 1721814516, "time_this_iter_s": 12.821489334106445, "time_total_s": 983.2229225635529, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8e8ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 983.2229225635529, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 20.511111111111113, "ram_util_percent": 38.011111111111106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.422246946394445, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.12999356428723938, "policy_loss": -0.006194204652759557, "vf_loss": 0.11978424453991465, "vf_explained_var": 0.9997759291902184, "kl": 0.012893579786365687, "entropy": -0.33487734996403257, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 21.64310063153222, "episode_reward_min": -206.74467859899698, "episode_reward_mean": -53.127180431609624, "episode_len_mean": 58.82, "episode_media": {}, "episodes_timesteps_total": 5882, "policy_reward_min": {"policy_0": -206.74467859899698}, "policy_reward_max": {"policy_0": 21.64310063153222}, "policy_reward_mean": {"policy_0": -53.127180431609624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.44920464115906, -44.45353111452639, 8.645960699641723, 1.2056354996003869, -66.10112815152615, -72.27049269894667, -48.17038835481982, -86.83142203284145, -133.12516865381707, 12.732109532995176, -113.26248763323986, 11.012591185739248, -19.545922173656347, -41.273380424771865, -31.488775050240882, 7.468240658632342, -75.4607433454226, -10.052550053481607, -73.52254653011238, 14.017493749904164, -99.24805163525802, 0.6354842353268564, -6.765346133650751, -23.510970093892332, -23.944159864568903, -158.46234653688188, -96.7439258282286, -68.1110226110848, -30.640009010583054, -114.05896201043004, -12.461807635067492, -50.77252122241128, -108.97554329019952, 14.579132957749852, -56.80450164182007, -2.806043210207362, -11.878485095688044, -185.1696218346425, -49.65581190434046, -73.77631758725872, -48.830965561195534, -65.77016958603323, -21.27410919655495, -110.23002050707704, -94.20716492536302, -13.00048403668226, -22.761025079599843, -100.45351833313023, -73.38928880657322, -150.65799809817696, -206.74467859899698, -18.288626814483703, -41.11211047154601, -114.33475023682583, -14.547653106913838, -42.40745712605443, -105.06767237196657, 4.131351542709979, -62.066321852101424, -14.850216453361769, -27.38900187849387, -16.979111921148444, -148.73210348299344, -138.06354943066071, 21.64310063153222, -5.681889277764135, 17.484654179474518, 11.329960611843077, 6.151710330315076, -181.77310375285666, -25.61693077654173, -76.22315120199882, -20.951588662861784, -64.91369779521789, -84.9584799331785, -1.386368360528995, -105.74352549897849, -49.20741533198095, -97.63443407917187, -5.499136974181386, -111.20271204099801, -85.6720423648856, -135.9356191906598, -42.80327721212714, -87.47984935211569, -63.30087724239673, -2.2398397004389357, -77.13014365423598, -45.82589554731796, 11.198916981393992, -128.7258683151294, -33.84299246574487, -4.0327672822155645, -11.118117880135873, -29.073022121624366, 10.871802122985883, -31.718715098610648, -13.67302972582059, -28.632382216152525, -100.87812914422666], "episode_lengths": [63, 55, 37, 47, 65, 66, 62, 76, 80, 36, 82, 33, 54, 56, 55, 35, 73, 45, 63, 36, 70, 39, 49, 57, 47, 89, 69, 68, 51, 73, 54, 61, 74, 37, 65, 51, 41, 91, 56, 62, 59, 62, 53, 73, 69, 54, 58, 71, 64, 82, 96, 49, 52, 75, 52, 54, 74, 42, 60, 48, 48, 50, 85, 79, 31, 45, 28, 36, 35, 93, 56, 65, 48, 62, 69, 46, 80, 59, 70, 48, 74, 66, 80, 63, 67, 63, 47, 69, 60, 39, 79, 62, 44, 53, 53, 35, 54, 51, 48, 72], "policy_policy_0_reward": [-72.44920464115906, -44.45353111452639, 8.645960699641723, 1.2056354996003869, -66.10112815152615, -72.27049269894667, -48.17038835481982, -86.83142203284145, -133.12516865381707, 12.732109532995176, -113.26248763323986, 11.012591185739248, -19.545922173656347, -41.273380424771865, -31.488775050240882, 7.468240658632342, -75.4607433454226, -10.052550053481607, -73.52254653011238, 14.017493749904164, -99.24805163525802, 0.6354842353268564, -6.765346133650751, -23.510970093892332, -23.944159864568903, -158.46234653688188, -96.7439258282286, -68.1110226110848, -30.640009010583054, -114.05896201043004, -12.461807635067492, -50.77252122241128, -108.97554329019952, 14.579132957749852, -56.80450164182007, -2.806043210207362, -11.878485095688044, -185.1696218346425, -49.65581190434046, -73.77631758725872, -48.830965561195534, -65.77016958603323, -21.27410919655495, -110.23002050707704, -94.20716492536302, -13.00048403668226, -22.761025079599843, -100.45351833313023, -73.38928880657322, -150.65799809817696, -206.74467859899698, -18.288626814483703, -41.11211047154601, -114.33475023682583, -14.547653106913838, -42.40745712605443, -105.06767237196657, 4.131351542709979, -62.066321852101424, -14.850216453361769, -27.38900187849387, -16.979111921148444, -148.73210348299344, -138.06354943066071, 21.64310063153222, -5.681889277764135, 17.484654179474518, 11.329960611843077, 6.151710330315076, -181.77310375285666, -25.61693077654173, -76.22315120199882, -20.951588662861784, -64.91369779521789, -84.9584799331785, -1.386368360528995, -105.74352549897849, -49.20741533198095, -97.63443407917187, -5.499136974181386, -111.20271204099801, -85.6720423648856, -135.9356191906598, -42.80327721212714, -87.47984935211569, -63.30087724239673, -2.2398397004389357, -77.13014365423598, -45.82589554731796, 11.198916981393992, -128.7258683151294, -33.84299246574487, -4.0327672822155645, -11.118117880135873, -29.073022121624366, 10.871802122985883, -31.718715098610648, -13.67302972582059, -28.632382216152525, -100.87812914422666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5259252800222305, "mean_inference_ms": 1.564951298037148, "mean_action_processing_ms": 0.2537788787575049, "mean_env_wait_ms": 3.7499227983494223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011487722396850586, "StateBufferConnector_ms": 0.007645130157470703, "ViewRequirementAgentConnector_ms": 0.18376660346984863}, "num_episodes": 70, "episode_return_max": 21.64310063153222, "episode_return_min": -206.74467859899698, "episode_return_mean": -53.127180431609624, "episodes_this_iter": 70}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.1554146921794, "num_env_steps_trained_throughput_per_sec": 306.1554146921794, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 12083.814, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12083.739, "sample_time_ms": 1360.384, "learn_time_ms": 10667.394, "learn_throughput": 374.974, "synch_weights_time_ms": 55.193}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 84, "trial_id": "8adec_00000", "date": "2024-07-24_15-18-49", "timestamp": 1721814529, "time_this_iter_s": 13.07709002494812, "time_total_s": 996.300012588501, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ead40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 996.300012588501, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 18.952631578947365, "ram_util_percent": 37.815789473684205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.944441031912966, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.18354015031363816, "policy_loss": -0.003749483699599902, "vf_loss": 0.16804176110308616, "vf_explained_var": 0.999636819648246, "kl": 0.015619117929357699, "entropy": -0.34335150227804356, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": 21.64310063153222, "episode_reward_min": -221.08085414681847, "episode_reward_mean": -64.96296465887049, "episode_len_mean": 61.81, "episode_media": {}, "episodes_timesteps_total": 6181, "policy_reward_min": {"policy_0": -221.08085414681847}, "policy_reward_max": {"policy_0": 21.64310063153222}, "policy_reward_mean": {"policy_0": -64.96296465887049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.850216453361769, -27.38900187849387, -16.979111921148444, -148.73210348299344, -138.06354943066071, 21.64310063153222, -5.681889277764135, 17.484654179474518, 11.329960611843077, 6.151710330315076, -181.77310375285666, -25.61693077654173, -76.22315120199882, -20.951588662861784, -64.91369779521789, -84.9584799331785, -1.386368360528995, -105.74352549897849, -49.20741533198095, -97.63443407917187, -5.499136974181386, -111.20271204099801, -85.6720423648856, -135.9356191906598, -42.80327721212714, -87.47984935211569, -63.30087724239673, -2.2398397004389357, -77.13014365423598, -45.82589554731796, 11.198916981393992, -128.7258683151294, -33.84299246574487, -4.0327672822155645, -11.118117880135873, -29.073022121624366, 10.871802122985883, -31.718715098610648, -13.67302972582059, -28.632382216152525, -100.87812914422666, -73.725472836196, -161.89609976248357, -29.23776205875373, -147.15875433290248, -221.08085414681847, 5.578992047363614, -21.037878081329826, -86.73568032487992, 6.2741596277091585, -82.03892765535707, -80.66290412844494, 16.290839944774806, -163.7766312709425, -128.12061280917607, -14.253549348085835, -22.39697943402767, 3.095597192804269, -1.415393562580659, -137.75311737856163, 8.224199453064067, -167.2170144481961, -113.71848599679473, -85.79325176142358, -107.0586041173668, -15.29357492648587, -18.01321882999684, -121.97686138082119, -38.901927898457664, -71.83795693607061, 18.132626102616783, -84.16015213130152, -101.29472049784768, -135.64995012832858, -108.87437277003396, -51.474815745206705, -122.11144166343503, -11.575488809441746, -123.85124474642133, -200.57903007641104, -160.59698993411644, -79.50628976381029, -174.93829349918028, -60.034598629138856, -65.45746004752968, -27.944890701571936, -24.583573202003716, -26.94989937252256, -2.7306940048655175, -89.93886064944756, -64.97132123100869, -117.93008418733352, -139.23924300655025, -119.72403318418618, -127.84465963620613, -93.25487188832962, -2.485374763964877, -69.49288494445905, 7.16159432906426, -42.54888143442967], "episode_lengths": [48, 48, 50, 85, 79, 31, 45, 28, 36, 35, 93, 56, 65, 48, 62, 69, 46, 80, 59, 70, 48, 74, 66, 80, 63, 67, 63, 47, 69, 60, 39, 79, 62, 44, 53, 53, 35, 54, 51, 48, 72, 64, 85, 53, 81, 99, 37, 52, 70, 40, 68, 68, 32, 87, 81, 45, 55, 47, 49, 79, 33, 89, 74, 77, 73, 52, 53, 77, 58, 64, 27, 68, 71, 79, 73, 56, 77, 51, 77, 94, 85, 65, 88, 62, 67, 51, 52, 59, 45, 67, 64, 75, 83, 76, 79, 77, 41, 66, 41, 63], "policy_policy_0_reward": [-14.850216453361769, -27.38900187849387, -16.979111921148444, -148.73210348299344, -138.06354943066071, 21.64310063153222, -5.681889277764135, 17.484654179474518, 11.329960611843077, 6.151710330315076, -181.77310375285666, -25.61693077654173, -76.22315120199882, -20.951588662861784, -64.91369779521789, -84.9584799331785, -1.386368360528995, -105.74352549897849, -49.20741533198095, -97.63443407917187, -5.499136974181386, -111.20271204099801, -85.6720423648856, -135.9356191906598, -42.80327721212714, -87.47984935211569, -63.30087724239673, -2.2398397004389357, -77.13014365423598, -45.82589554731796, 11.198916981393992, -128.7258683151294, -33.84299246574487, -4.0327672822155645, -11.118117880135873, -29.073022121624366, 10.871802122985883, -31.718715098610648, -13.67302972582059, -28.632382216152525, -100.87812914422666, -73.725472836196, -161.89609976248357, -29.23776205875373, -147.15875433290248, -221.08085414681847, 5.578992047363614, -21.037878081329826, -86.73568032487992, 6.2741596277091585, -82.03892765535707, -80.66290412844494, 16.290839944774806, -163.7766312709425, -128.12061280917607, -14.253549348085835, -22.39697943402767, 3.095597192804269, -1.415393562580659, -137.75311737856163, 8.224199453064067, -167.2170144481961, -113.71848599679473, -85.79325176142358, -107.0586041173668, -15.29357492648587, -18.01321882999684, -121.97686138082119, -38.901927898457664, -71.83795693607061, 18.132626102616783, -84.16015213130152, -101.29472049784768, -135.64995012832858, -108.87437277003396, -51.474815745206705, -122.11144166343503, -11.575488809441746, -123.85124474642133, -200.57903007641104, -160.59698993411644, -79.50628976381029, -174.93829349918028, -60.034598629138856, -65.45746004752968, -27.944890701571936, -24.583573202003716, -26.94989937252256, -2.7306940048655175, -89.93886064944756, -64.97132123100869, -117.93008418733352, -139.23924300655025, -119.72403318418618, -127.84465963620613, -93.25487188832962, -2.485374763964877, -69.49288494445905, 7.16159432906426, -42.54888143442967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256670669615298, "mean_inference_ms": 1.5644241451172887, "mean_action_processing_ms": 0.2536177269929667, "mean_env_wait_ms": 3.748905481629526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011322498321533203, "StateBufferConnector_ms": 0.007519721984863281, "ViewRequirementAgentConnector_ms": 0.18188929557800293}, "num_episodes": 59, "episode_return_max": 21.64310063153222, "episode_return_min": -221.08085414681847, "episode_return_mean": -64.96296465887049, "episodes_this_iter": 59}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.00454789349084, "num_env_steps_trained_throughput_per_sec": 350.00454789349084, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 12081.542, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12081.466, "sample_time_ms": 1359.209, "learn_time_ms": 10666.237, "learn_throughput": 375.015, "synch_weights_time_ms": 55.251}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 85, "trial_id": "8adec_00000", "date": "2024-07-24_15-19-01", "timestamp": 1721814541, "time_this_iter_s": 11.438580989837646, "time_total_s": 1007.7385935783386, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ebeb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1007.7385935783386, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 19.775, "ram_util_percent": 37.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.50442578941583, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.13664908025142117, "policy_loss": -0.0033594734927949806, "vf_loss": 0.12448236203053967, "vf_explained_var": 0.9997633680701256, "kl": 0.012470418079707763, "entropy": -0.28998923672673604, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 22.458193691800492, "episode_reward_min": -201.10779896515416, "episode_reward_mean": -64.88093480348836, "episode_len_mean": 62.47, "episode_media": {}, "episodes_timesteps_total": 6247, "policy_reward_min": {"policy_0": -201.10779896515416}, "policy_reward_max": {"policy_0": 22.458193691800492}, "policy_reward_mean": {"policy_0": -64.88093480348836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.901927898457664, -71.83795693607061, 18.132626102616783, -84.16015213130152, -101.29472049784768, -135.64995012832858, -108.87437277003396, -51.474815745206705, -122.11144166343503, -11.575488809441746, -123.85124474642133, -200.57903007641104, -160.59698993411644, -79.50628976381029, -174.93829349918028, -60.034598629138856, -65.45746004752968, -27.944890701571936, -24.583573202003716, -26.94989937252256, -2.7306940048655175, -89.93886064944756, -64.97132123100869, -117.93008418733352, -139.23924300655025, -119.72403318418618, -127.84465963620613, -93.25487188832962, -2.485374763964877, -69.49288494445905, 7.16159432906426, -42.54888143442967, -90.56242627420953, -14.418506799115963, -0.5027114087514213, -18.102987049084813, -27.511472449944026, -82.76079106326486, -29.256324604127617, -26.102630047295058, -20.447644580273895, -65.87053815555721, -201.10779896515416, -46.33437795689774, 10.42895560547117, -41.554696048473915, -23.77203350734344, 10.464397055232153, -122.82577664098443, 11.730138016021687, -3.9109971088766353, -58.7844154034091, -153.09236025251968, -85.61929241580484, -90.76811428831385, -18.310338485145245, -4.457236352737389, -111.6879121048761, -93.87201794651428, -4.03450175570223, -80.97781908970462, -88.09462521727967, -59.21931286149733, -49.70809067549557, -173.92048312026316, -153.87673979037586, -10.302217686709474, -91.44248726806829, -68.0685877474411, -47.8514734897495, -82.21373849309363, -64.07723258647228, -8.52105725544123, 1.3783658903449645, -80.4427231476661, 12.06525433082329, 4.643305864573922, -65.9804809205627, -24.25228830887907, -58.50414858875815, -48.121431383491206, -121.74099858074852, -112.08665086716377, -100.56215945688832, -48.439966219580946, -153.92538756942758, -10.67144559649497, -51.40373356866432, -139.18064268421782, -121.11585425023178, -34.43610209777282, -57.76156942399309, -81.59022786907525, -17.31675484254664, -30.663272295501244, -39.4412628996606, -82.83101041519629, -114.01266212841092, 22.458193691800492, -37.64976569027195], "episode_lengths": [58, 64, 27, 68, 71, 79, 73, 56, 77, 51, 77, 94, 85, 65, 88, 62, 67, 51, 52, 59, 45, 67, 64, 75, 83, 76, 79, 77, 41, 66, 41, 63, 77, 49, 37, 56, 57, 66, 56, 52, 49, 67, 95, 54, 37, 58, 58, 40, 76, 32, 46, 61, 83, 69, 75, 52, 44, 74, 69, 39, 70, 70, 59, 56, 88, 87, 41, 69, 75, 63, 66, 65, 47, 49, 66, 36, 47, 72, 57, 64, 55, 76, 75, 74, 58, 87, 54, 57, 79, 76, 54, 59, 70, 54, 58, 59, 70, 75, 28, 53], "policy_policy_0_reward": [-38.901927898457664, -71.83795693607061, 18.132626102616783, -84.16015213130152, -101.29472049784768, -135.64995012832858, -108.87437277003396, -51.474815745206705, -122.11144166343503, -11.575488809441746, -123.85124474642133, -200.57903007641104, -160.59698993411644, -79.50628976381029, -174.93829349918028, -60.034598629138856, -65.45746004752968, -27.944890701571936, -24.583573202003716, -26.94989937252256, -2.7306940048655175, -89.93886064944756, -64.97132123100869, -117.93008418733352, -139.23924300655025, -119.72403318418618, -127.84465963620613, -93.25487188832962, -2.485374763964877, -69.49288494445905, 7.16159432906426, -42.54888143442967, -90.56242627420953, -14.418506799115963, -0.5027114087514213, -18.102987049084813, -27.511472449944026, -82.76079106326486, -29.256324604127617, -26.102630047295058, -20.447644580273895, -65.87053815555721, -201.10779896515416, -46.33437795689774, 10.42895560547117, -41.554696048473915, -23.77203350734344, 10.464397055232153, -122.82577664098443, 11.730138016021687, -3.9109971088766353, -58.7844154034091, -153.09236025251968, -85.61929241580484, -90.76811428831385, -18.310338485145245, -4.457236352737389, -111.6879121048761, -93.87201794651428, -4.03450175570223, -80.97781908970462, -88.09462521727967, -59.21931286149733, -49.70809067549557, -173.92048312026316, -153.87673979037586, -10.302217686709474, -91.44248726806829, -68.0685877474411, -47.8514734897495, -82.21373849309363, -64.07723258647228, -8.52105725544123, 1.3783658903449645, -80.4427231476661, 12.06525433082329, 4.643305864573922, -65.9804809205627, -24.25228830887907, -58.50414858875815, -48.121431383491206, -121.74099858074852, -112.08665086716377, -100.56215945688832, -48.439966219580946, -153.92538756942758, -10.67144559649497, -51.40373356866432, -139.18064268421782, -121.11585425023178, -34.43610209777282, -57.76156942399309, -81.59022786907525, -17.31675484254664, -30.663272295501244, -39.4412628996606, -82.83101041519629, -114.01266212841092, 22.458193691800492, -37.64976569027195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526123151444084, "mean_inference_ms": 1.5642371342028514, "mean_action_processing_ms": 0.25373587871415443, "mean_env_wait_ms": 3.751807884974935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01116943359375, "StateBufferConnector_ms": 0.007636547088623047, "ViewRequirementAgentConnector_ms": 0.18094921112060547}, "num_episodes": 68, "episode_return_max": 22.458193691800492, "episode_return_min": -201.10779896515416, "episode_return_mean": -64.88093480348836, "episodes_this_iter": 68}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.55377456024297, "num_env_steps_trained_throughput_per_sec": 304.55377456024297, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 12197.544, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12197.468, "sample_time_ms": 1357.411, "learn_time_ms": 10785.116, "learn_throughput": 370.882, "synch_weights_time_ms": 54.161}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 86, "trial_id": "8adec_00000", "date": "2024-07-24_15-19-14", "timestamp": 1721814554, "time_this_iter_s": 13.143882036209106, "time_total_s": 1020.8824756145477, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b958280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1020.8824756145477, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 18.34210526315789, "ram_util_percent": 37.82105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.28343212654193, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.12361986955802422, "policy_loss": -0.006147302950072723, "vf_loss": 0.11005112535009781, "vf_explained_var": 0.99977837074548, "kl": 0.016077838270363524, "entropy": -0.3437234825377042, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": 22.458193691800492, "episode_reward_min": -169.0672510921845, "episode_reward_mean": -59.547345078023255, "episode_len_mean": 60.94, "episode_media": {}, "episodes_timesteps_total": 6094, "policy_reward_min": {"policy_0": -169.0672510921845}, "policy_reward_max": {"policy_0": 22.458193691800492}, "policy_reward_mean": {"policy_0": -59.547345078023255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.302217686709474, -91.44248726806829, -68.0685877474411, -47.8514734897495, -82.21373849309363, -64.07723258647228, -8.52105725544123, 1.3783658903449645, -80.4427231476661, 12.06525433082329, 4.643305864573922, -65.9804809205627, -24.25228830887907, -58.50414858875815, -48.121431383491206, -121.74099858074852, -112.08665086716377, -100.56215945688832, -48.439966219580946, -153.92538756942758, -10.67144559649497, -51.40373356866432, -139.18064268421782, -121.11585425023178, -34.43610209777282, -57.76156942399309, -81.59022786907525, -17.31675484254664, -30.663272295501244, -39.4412628996606, -82.83101041519629, -114.01266212841092, 22.458193691800492, -37.64976569027195, -19.88859113658702, -70.8506568385429, -4.480485581637411, -13.805217282573576, -2.566486698727225, -115.7161819349945, -29.268257092700907, 4.592209829081696, -27.336624103083764, -128.2898945124254, -80.48527045059538, -18.18570113714771, -147.94143366591902, -32.05358810135982, -1.7800927812737957, -90.85856241068025, -169.0672510921845, -28.81573485769097, -95.4708753213718, -94.60205088579718, -25.013194516625468, -137.862624157468, 6.53053435539277, -68.19672619248952, -5.130998969306962, 6.053329306443414, -124.9070468531521, -32.90107834513956, -1.1329118455511529, -26.071484283996586, -103.98007924033836, -161.48202771328948, -70.53162176240461, -124.16469732432884, -74.52047867832934, -26.344888557983786, 5.196274603074548, -78.93945581652662, -36.9171932631694, -88.78134500542046, -15.643581865921723, -63.92302040923221, -58.76426887906552, -126.18867990068847, -105.78341261143892, -85.34347616859127, -37.310232368550295, -146.2625224498605, -61.36630388334256, -57.96559461604009, -167.2847218785907, -35.74163100100143, -70.78137723304505, 10.242218384250474, -37.88136230229604, 7.995855320363872, -100.52572846970493, -5.406463596418352, -32.25378477119969, -45.9321139229412, -73.19634529643639, -30.630321199464948, -82.05165251516291, 4.529655301328508, -84.4733773788055, -152.76159021901012], "episode_lengths": [41, 69, 75, 63, 66, 65, 47, 49, 66, 36, 47, 72, 57, 64, 55, 76, 75, 74, 58, 87, 54, 57, 79, 76, 54, 59, 70, 54, 58, 59, 70, 75, 28, 53, 55, 66, 45, 42, 41, 74, 59, 38, 49, 78, 64, 45, 84, 59, 37, 72, 90, 56, 70, 69, 48, 84, 35, 64, 43, 34, 76, 59, 37, 49, 72, 84, 64, 78, 70, 59, 41, 64, 55, 67, 55, 61, 67, 78, 75, 71, 61, 81, 61, 65, 88, 51, 67, 37, 56, 40, 73, 48, 55, 63, 69, 51, 67, 42, 65, 83], "policy_policy_0_reward": [-10.302217686709474, -91.44248726806829, -68.0685877474411, -47.8514734897495, -82.21373849309363, -64.07723258647228, -8.52105725544123, 1.3783658903449645, -80.4427231476661, 12.06525433082329, 4.643305864573922, -65.9804809205627, -24.25228830887907, -58.50414858875815, -48.121431383491206, -121.74099858074852, -112.08665086716377, -100.56215945688832, -48.439966219580946, -153.92538756942758, -10.67144559649497, -51.40373356866432, -139.18064268421782, -121.11585425023178, -34.43610209777282, -57.76156942399309, -81.59022786907525, -17.31675484254664, -30.663272295501244, -39.4412628996606, -82.83101041519629, -114.01266212841092, 22.458193691800492, -37.64976569027195, -19.88859113658702, -70.8506568385429, -4.480485581637411, -13.805217282573576, -2.566486698727225, -115.7161819349945, -29.268257092700907, 4.592209829081696, -27.336624103083764, -128.2898945124254, -80.48527045059538, -18.18570113714771, -147.94143366591902, -32.05358810135982, -1.7800927812737957, -90.85856241068025, -169.0672510921845, -28.81573485769097, -95.4708753213718, -94.60205088579718, -25.013194516625468, -137.862624157468, 6.53053435539277, -68.19672619248952, -5.130998969306962, 6.053329306443414, -124.9070468531521, -32.90107834513956, -1.1329118455511529, -26.071484283996586, -103.98007924033836, -161.48202771328948, -70.53162176240461, -124.16469732432884, -74.52047867832934, -26.344888557983786, 5.196274603074548, -78.93945581652662, -36.9171932631694, -88.78134500542046, -15.643581865921723, -63.92302040923221, -58.76426887906552, -126.18867990068847, -105.78341261143892, -85.34347616859127, -37.310232368550295, -146.2625224498605, -61.36630388334256, -57.96559461604009, -167.2847218785907, -35.74163100100143, -70.78137723304505, 10.242218384250474, -37.88136230229604, 7.995855320363872, -100.52572846970493, -5.406463596418352, -32.25378477119969, -45.9321139229412, -73.19634529643639, -30.630321199464948, -82.05165251516291, 4.529655301328508, -84.4733773788055, -152.76159021901012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258648343537681, "mean_inference_ms": 1.5634978350009436, "mean_action_processing_ms": 0.25378021879978485, "mean_env_wait_ms": 3.753285411818449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011083602905273438, "StateBufferConnector_ms": 0.0072727203369140625, "ViewRequirementAgentConnector_ms": 0.1754436492919922}, "num_episodes": 66, "episode_return_max": 22.458193691800492, "episode_return_min": -169.0672510921845, "episode_return_mean": -59.547345078023255, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.7179883401633, "num_env_steps_trained_throughput_per_sec": 316.7179883401633, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 12194.165, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12194.09, "sample_time_ms": 1358.453, "learn_time_ms": 10781.237, "learn_throughput": 371.015, "synch_weights_time_ms": 53.612}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 87, "trial_id": "8adec_00000", "date": "2024-07-24_15-19-27", "timestamp": 1721814567, "time_this_iter_s": 12.640014171600342, "time_total_s": 1033.522489786148, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b959360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1033.522489786148, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 19.033333333333335, "ram_util_percent": 37.844444444444434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.243160120149454, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.15495141788123873, "policy_loss": -0.0023851625058644763, "vf_loss": 0.14257690303881343, "vf_explained_var": 0.9997286591057976, "kl": 0.011489272130468938, "entropy": -0.31267894539438806, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 17.139748408022125, "episode_reward_min": -167.2847218785907, "episode_reward_mean": -57.03969887287316, "episode_len_mean": 60.82, "episode_media": {}, "episodes_timesteps_total": 6082, "policy_reward_min": {"policy_0": -167.2847218785907}, "policy_reward_max": {"policy_0": 17.139748408022125}, "policy_reward_mean": {"policy_0": -57.03969887287316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-124.16469732432884, -74.52047867832934, -26.344888557983786, 5.196274603074548, -78.93945581652662, -36.9171932631694, -88.78134500542046, -15.643581865921723, -63.92302040923221, -58.76426887906552, -126.18867990068847, -105.78341261143892, -85.34347616859127, -37.310232368550295, -146.2625224498605, -61.36630388334256, -57.96559461604009, -167.2847218785907, -35.74163100100143, -70.78137723304505, 10.242218384250474, -37.88136230229604, 7.995855320363872, -100.52572846970493, -5.406463596418352, -32.25378477119969, -45.9321139229412, -73.19634529643639, -30.630321199464948, -82.05165251516291, 4.529655301328508, -84.4733773788055, -152.76159021901012, 1.7953316234048777, -38.829777099859584, 3.1979297137709066, -24.649528136347243, -18.50057102252185, -78.62504243924694, -102.16871776088377, -11.20592536802026, -3.519786017824365, -139.89294278673273, 17.139748408022125, -119.73135934677077, -56.91253573941333, -3.3807451184728707, -86.02640850814504, -73.18192466179894, -119.70459590977364, -30.50808930497929, -40.64615054991507, -96.97218288988424, 5.056979571048593, -58.20918303259557, 10.785596242160825, -125.8362811754799, -60.08609834638082, -131.532228769502, -88.973111661341, 10.53789674240203, -122.6882648468943, -41.179034165336276, -48.282297497529306, -117.38988922462428, -84.93466820346869, -85.09654952630612, -57.05694607522949, 6.480053957467339, -65.52320411668563, -35.11689934307384, -43.19785973937101, -10.731079469862438, -101.34267667156739, -67.24206335318007, -7.118118613780247, -107.68018976627928, -102.10983656508908, -65.2204537633113, -76.24432972062579, -75.8842224655468, -119.93953078724738, -79.91550106009056, 10.492952313316529, -71.10110642620951, -60.943937374097494, -27.3793444759664, -97.28168243559462, -9.625300247636261, -20.21313751251444, -21.954630959052075, -63.75962243312358, -20.050851816814582, -84.62382904562364, -36.94179794624625, -33.43230734903112, -60.28420120426272, -18.099680235783783, -15.28567342469963, -26.316854377713934], "episode_lengths": [78, 70, 59, 41, 64, 55, 67, 55, 61, 67, 78, 75, 71, 61, 81, 61, 65, 88, 51, 67, 37, 56, 40, 73, 48, 55, 63, 69, 51, 67, 42, 65, 83, 43, 56, 40, 47, 55, 65, 72, 41, 39, 81, 36, 77, 59, 52, 68, 64, 77, 54, 54, 80, 39, 60, 43, 77, 63, 81, 77, 34, 76, 53, 55, 75, 70, 71, 65, 38, 61, 60, 61, 52, 74, 63, 46, 73, 73, 62, 64, 64, 75, 65, 36, 75, 60, 52, 70, 50, 54, 56, 76, 48, 74, 62, 53, 62, 59, 53, 48], "policy_policy_0_reward": [-124.16469732432884, -74.52047867832934, -26.344888557983786, 5.196274603074548, -78.93945581652662, -36.9171932631694, -88.78134500542046, -15.643581865921723, -63.92302040923221, -58.76426887906552, -126.18867990068847, -105.78341261143892, -85.34347616859127, -37.310232368550295, -146.2625224498605, -61.36630388334256, -57.96559461604009, -167.2847218785907, -35.74163100100143, -70.78137723304505, 10.242218384250474, -37.88136230229604, 7.995855320363872, -100.52572846970493, -5.406463596418352, -32.25378477119969, -45.9321139229412, -73.19634529643639, -30.630321199464948, -82.05165251516291, 4.529655301328508, -84.4733773788055, -152.76159021901012, 1.7953316234048777, -38.829777099859584, 3.1979297137709066, -24.649528136347243, -18.50057102252185, -78.62504243924694, -102.16871776088377, -11.20592536802026, -3.519786017824365, -139.89294278673273, 17.139748408022125, -119.73135934677077, -56.91253573941333, -3.3807451184728707, -86.02640850814504, -73.18192466179894, -119.70459590977364, -30.50808930497929, -40.64615054991507, -96.97218288988424, 5.056979571048593, -58.20918303259557, 10.785596242160825, -125.8362811754799, -60.08609834638082, -131.532228769502, -88.973111661341, 10.53789674240203, -122.6882648468943, -41.179034165336276, -48.282297497529306, -117.38988922462428, -84.93466820346869, -85.09654952630612, -57.05694607522949, 6.480053957467339, -65.52320411668563, -35.11689934307384, -43.19785973937101, -10.731079469862438, -101.34267667156739, -67.24206335318007, -7.118118613780247, -107.68018976627928, -102.10983656508908, -65.2204537633113, -76.24432972062579, -75.8842224655468, -119.93953078724738, -79.91550106009056, 10.492952313316529, -71.10110642620951, -60.943937374097494, -27.3793444759664, -97.28168243559462, -9.625300247636261, -20.21313751251444, -21.954630959052075, -63.75962243312358, -20.050851816814582, -84.62382904562364, -36.94179794624625, -33.43230734903112, -60.28420120426272, -18.099680235783783, -15.28567342469963, -26.316854377713934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256979932957405, "mean_inference_ms": 1.56250590039962, "mean_action_processing_ms": 0.25366052915265525, "mean_env_wait_ms": 3.7532228904233484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011524677276611328, "StateBufferConnector_ms": 0.007361173629760742, "ViewRequirementAgentConnector_ms": 0.17853713035583496}, "num_episodes": 67, "episode_return_max": 17.139748408022125, "episode_return_min": -167.2847218785907, "episode_return_mean": -57.03969887287316, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.0541978314966, "num_env_steps_trained_throughput_per_sec": 499.0541978314966, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 11892.731, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11892.656, "sample_time_ms": 1352.679, "learn_time_ms": 10486.726, "learn_throughput": 381.435, "synch_weights_time_ms": 52.452}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 88, "trial_id": "8adec_00000", "date": "2024-07-24_15-19-35", "timestamp": 1721814575, "time_this_iter_s": 8.025501012802124, "time_total_s": 1041.5479907989502, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b95a4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1041.5479907989502, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 22.59166666666667, "ram_util_percent": 37.93333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.97489292869965, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.13116914646040337, "policy_loss": -0.005033230237313546, "vf_loss": 0.11960875472674767, "vf_explained_var": 0.9997904684394598, "kl": 0.012732823673286533, "entropy": -0.3701637321617454, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "env_runners": {"episode_reward_max": 14.074720759959334, "episode_reward_min": -205.37485449118358, "episode_reward_mean": -63.22403948654243, "episode_len_mean": 62.46, "episode_media": {}, "episodes_timesteps_total": 6246, "policy_reward_min": {"policy_0": -205.37485449118358}, "policy_reward_max": {"policy_0": 14.074720759959334}, "policy_reward_mean": {"policy_0": -63.22403948654243}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.282297497529306, -117.38988922462428, -84.93466820346869, -85.09654952630612, -57.05694607522949, 6.480053957467339, -65.52320411668563, -35.11689934307384, -43.19785973937101, -10.731079469862438, -101.34267667156739, -67.24206335318007, -7.118118613780247, -107.68018976627928, -102.10983656508908, -65.2204537633113, -76.24432972062579, -75.8842224655468, -119.93953078724738, -79.91550106009056, 10.492952313316529, -71.10110642620951, -60.943937374097494, -27.3793444759664, -97.28168243559462, -9.625300247636261, -20.21313751251444, -21.954630959052075, -63.75962243312358, -20.050851816814582, -84.62382904562364, -36.94179794624625, -33.43230734903112, -60.28420120426272, -18.099680235783783, -15.28567342469963, -26.316854377713934, -42.418130190759555, -93.60295576517287, -92.29794375302194, -28.17551221816569, -19.013282351370105, 4.079762188126763, -92.88146170083664, -77.74298117967487, -36.02105132087709, -137.16825424157074, 10.166138730119489, -38.024665139244405, -16.02545579917703, -0.8856581775848147, -54.12757398342489, -80.88639362392017, -205.37485449118358, -118.42526661571104, -67.2568308597507, -189.17000296735685, -182.48743439092698, -26.010879972935307, -7.006637420113276, -2.939605667384825, -106.77393487011608, -51.368292575459094, -17.54560088497017, -29.738721438626605, 7.266778131397844, -100.13911316235908, -61.344190073746624, -54.65870833349942, -56.59470437077857, -73.46614080932488, -150.9827635970755, -82.87569064975285, -145.2519083731126, 7.5908064080385715, -17.184855400458435, -22.344437824233246, -106.4396205363584, 9.61970793042613, -26.225935748349976, -184.55107766647896, -62.07378742477587, -65.28709425214572, -128.37871078634385, -33.06323323192023, -109.25828150695065, -82.74612440009805, -64.70787038929541, -126.2996710914443, -145.54312925725156, -90.99325457910562, -62.753020912621494, 14.074720759959334, -68.57842415291539, -78.24434111435912, -99.85240606237296, -148.09720620314022, -88.62323914903368, -38.22896868964723, 13.30269550243003], "episode_lengths": [55, 75, 70, 71, 65, 38, 61, 60, 61, 52, 74, 63, 46, 73, 73, 62, 64, 64, 75, 65, 36, 75, 60, 52, 70, 50, 54, 56, 76, 48, 74, 62, 53, 62, 59, 53, 48, 63, 70, 81, 59, 58, 48, 70, 68, 53, 82, 36, 55, 55, 37, 57, 65, 97, 76, 64, 90, 90, 60, 46, 40, 72, 56, 50, 56, 33, 71, 59, 62, 59, 63, 83, 69, 83, 38, 50, 60, 74, 33, 50, 93, 66, 60, 83, 54, 83, 68, 65, 78, 82, 69, 64, 30, 63, 77, 72, 82, 76, 53, 32], "policy_policy_0_reward": [-48.282297497529306, -117.38988922462428, -84.93466820346869, -85.09654952630612, -57.05694607522949, 6.480053957467339, -65.52320411668563, -35.11689934307384, -43.19785973937101, -10.731079469862438, -101.34267667156739, -67.24206335318007, -7.118118613780247, -107.68018976627928, -102.10983656508908, -65.2204537633113, -76.24432972062579, -75.8842224655468, -119.93953078724738, -79.91550106009056, 10.492952313316529, -71.10110642620951, -60.943937374097494, -27.3793444759664, -97.28168243559462, -9.625300247636261, -20.21313751251444, -21.954630959052075, -63.75962243312358, -20.050851816814582, -84.62382904562364, -36.94179794624625, -33.43230734903112, -60.28420120426272, -18.099680235783783, -15.28567342469963, -26.316854377713934, -42.418130190759555, -93.60295576517287, -92.29794375302194, -28.17551221816569, -19.013282351370105, 4.079762188126763, -92.88146170083664, -77.74298117967487, -36.02105132087709, -137.16825424157074, 10.166138730119489, -38.024665139244405, -16.02545579917703, -0.8856581775848147, -54.12757398342489, -80.88639362392017, -205.37485449118358, -118.42526661571104, -67.2568308597507, -189.17000296735685, -182.48743439092698, -26.010879972935307, -7.006637420113276, -2.939605667384825, -106.77393487011608, -51.368292575459094, -17.54560088497017, -29.738721438626605, 7.266778131397844, -100.13911316235908, -61.344190073746624, -54.65870833349942, -56.59470437077857, -73.46614080932488, -150.9827635970755, -82.87569064975285, -145.2519083731126, 7.5908064080385715, -17.184855400458435, -22.344437824233246, -106.4396205363584, 9.61970793042613, -26.225935748349976, -184.55107766647896, -62.07378742477587, -65.28709425214572, -128.37871078634385, -33.06323323192023, -109.25828150695065, -82.74612440009805, -64.70787038929541, -126.2996710914443, -145.54312925725156, -90.99325457910562, -62.753020912621494, 14.074720759959334, -68.57842415291539, -78.24434111435912, -99.85240606237296, -148.09720620314022, -88.62323914903368, -38.22896868964723, 13.30269550243003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266954510876635, "mean_inference_ms": 1.5627799285806565, "mean_action_processing_ms": 0.25364246951393743, "mean_env_wait_ms": 3.755883637896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011672496795654297, "StateBufferConnector_ms": 0.007672786712646484, "ViewRequirementAgentConnector_ms": 0.18112945556640625}, "num_episodes": 63, "episode_return_max": 14.074720759959334, "episode_return_min": -205.37485449118358, "episode_return_mean": -63.22403948654243, "episodes_this_iter": 63}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.2680126296394, "num_env_steps_trained_throughput_per_sec": 451.2680126296394, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 11847.836, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11847.761, "sample_time_ms": 1364.117, "learn_time_ms": 10431.026, "learn_throughput": 383.471, "synch_weights_time_ms": 51.797}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "training_iteration": 89, "trial_id": "8adec_00000", "date": "2024-07-24_15-19-44", "timestamp": 1721814584, "time_this_iter_s": 8.875060319900513, "time_total_s": 1050.4230511188507, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1050.4230511188507, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 24.541666666666668, "ram_util_percent": 37.81666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.865174700816475, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.12898263376700925, "policy_loss": -0.006770314105475943, "vf_loss": 0.11874316284277787, "vf_explained_var": 0.9997900386030475, "kl": 0.013752204024907223, "entropy": -0.3085677642627464, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 20.327784100427078, "episode_reward_min": -184.55107766647896, "episode_reward_mean": -65.69274645633358, "episode_len_mean": 62.42, "episode_media": {}, "episodes_timesteps_total": 6242, "policy_reward_min": {"policy_0": -184.55107766647896}, "policy_reward_max": {"policy_0": 20.327784100427078}, "policy_reward_mean": {"policy_0": -65.69274645633358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.266778131397844, -100.13911316235908, -61.344190073746624, -54.65870833349942, -56.59470437077857, -73.46614080932488, -150.9827635970755, -82.87569064975285, -145.2519083731126, 7.5908064080385715, -17.184855400458435, -22.344437824233246, -106.4396205363584, 9.61970793042613, -26.225935748349976, -184.55107766647896, -62.07378742477587, -65.28709425214572, -128.37871078634385, -33.06323323192023, -109.25828150695065, -82.74612440009805, -64.70787038929541, -126.2996710914443, -145.54312925725156, -90.99325457910562, -62.753020912621494, 14.074720759959334, -68.57842415291539, -78.24434111435912, -99.85240606237296, -148.09720620314022, -88.62323914903368, -38.22896868964723, 13.30269550243003, -136.55100055141526, -9.167328395919569, -123.62924110189972, -8.659945397272292, -19.606834864327304, -25.049304939409435, -45.89157943000323, -111.64847374691381, -145.9960974232994, -88.44706259037756, -98.70446957830747, -165.80262401715794, 0.4124202127341925, -65.52281908244454, -113.3386373101701, 0.5141660354804505, 20.327784100427078, 13.778274780935238, -64.18590930488398, -80.64936694810226, -1.8747149728401737, -77.03517881535869, -89.09547213342401, -74.39441482996816, -67.3599424663322, -26.647730258443932, -20.472186010948157, 0.872848904935388, -5.245550995046662, 13.893471541756904, -130.26075174827704, -128.74441843177655, -23.796172242455064, -147.83040327246482, -5.304917330212618, -132.22347072394058, -122.37087973080804, -93.03508727500373, -122.99086397210216, -16.712890190296438, -113.92845646040342, -78.41099216492059, 0.9509608165486267, -37.87745765455113, -48.21569433452016, -122.38376011649731, 3.850114745869484, -3.641280109194128, -124.55643886990707, -19.75490809388903, -20.34983560228704, -11.454626426371792, -104.17375084815802, -80.88264310896933, -77.51265552794494, -99.90830506786142, -34.98277585162634, 13.946034710383467, -155.66108441268386, -33.8815073081023, -147.2426667925997, -40.611946961608474, -90.05826253552559, 11.889417023703443, -93.0421491602098], "episode_lengths": [33, 71, 59, 62, 59, 63, 83, 69, 83, 38, 50, 60, 74, 33, 50, 93, 66, 60, 83, 54, 83, 68, 65, 78, 82, 69, 64, 30, 63, 77, 72, 82, 76, 53, 32, 80, 43, 76, 50, 59, 46, 55, 75, 81, 76, 71, 86, 45, 63, 75, 47, 32, 38, 68, 65, 40, 65, 69, 78, 62, 55, 57, 45, 50, 40, 78, 78, 48, 84, 50, 82, 75, 69, 77, 46, 75, 64, 42, 52, 57, 77, 41, 43, 81, 48, 56, 53, 73, 71, 68, 70, 53, 30, 86, 62, 84, 63, 68, 34, 75], "policy_policy_0_reward": [7.266778131397844, -100.13911316235908, -61.344190073746624, -54.65870833349942, -56.59470437077857, -73.46614080932488, -150.9827635970755, -82.87569064975285, -145.2519083731126, 7.5908064080385715, -17.184855400458435, -22.344437824233246, -106.4396205363584, 9.61970793042613, -26.225935748349976, -184.55107766647896, -62.07378742477587, -65.28709425214572, -128.37871078634385, -33.06323323192023, -109.25828150695065, -82.74612440009805, -64.70787038929541, -126.2996710914443, -145.54312925725156, -90.99325457910562, -62.753020912621494, 14.074720759959334, -68.57842415291539, -78.24434111435912, -99.85240606237296, -148.09720620314022, -88.62323914903368, -38.22896868964723, 13.30269550243003, -136.55100055141526, -9.167328395919569, -123.62924110189972, -8.659945397272292, -19.606834864327304, -25.049304939409435, -45.89157943000323, -111.64847374691381, -145.9960974232994, -88.44706259037756, -98.70446957830747, -165.80262401715794, 0.4124202127341925, -65.52281908244454, -113.3386373101701, 0.5141660354804505, 20.327784100427078, 13.778274780935238, -64.18590930488398, -80.64936694810226, -1.8747149728401737, -77.03517881535869, -89.09547213342401, -74.39441482996816, -67.3599424663322, -26.647730258443932, -20.472186010948157, 0.872848904935388, -5.245550995046662, 13.893471541756904, -130.26075174827704, -128.74441843177655, -23.796172242455064, -147.83040327246482, -5.304917330212618, -132.22347072394058, -122.37087973080804, -93.03508727500373, -122.99086397210216, -16.712890190296438, -113.92845646040342, -78.41099216492059, 0.9509608165486267, -37.87745765455113, -48.21569433452016, -122.38376011649731, 3.850114745869484, -3.641280109194128, -124.55643886990707, -19.75490809388903, -20.34983560228704, -11.454626426371792, -104.17375084815802, -80.88264310896933, -77.51265552794494, -99.90830506786142, -34.98277585162634, 13.946034710383467, -155.66108441268386, -33.8815073081023, -147.2426667925997, -40.611946961608474, -90.05826253552559, 11.889417023703443, -93.0421491602098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271601736292401, "mean_inference_ms": 1.562624351102109, "mean_action_processing_ms": 0.2537702632628027, "mean_env_wait_ms": 3.7565874436836264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011686325073242188, "StateBufferConnector_ms": 0.007831335067749023, "ViewRequirementAgentConnector_ms": 0.1854534149169922}, "num_episodes": 65, "episode_return_max": 20.327784100427078, "episode_return_min": -184.55107766647896, "episode_return_mean": -65.69274645633358, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.12509635021087, "num_env_steps_trained_throughput_per_sec": 310.12509635021087, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 11831.681, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11831.604, "sample_time_ms": 1367.239, "learn_time_ms": 10411.596, "learn_throughput": 384.187, "synch_weights_time_ms": 51.91}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 90, "trial_id": "8adec_00000", "date": "2024-07-24_15-19-57", "timestamp": 1721814597, "time_this_iter_s": 12.908421516418457, "time_total_s": 1063.3314726352692, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8e9240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1063.3314726352692, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 18.931578947368422, "ram_util_percent": 37.90526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.0235571021835, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.16911652755419102, "policy_loss": -0.004106482336646877, "vf_loss": 0.15773194727953524, "vf_explained_var": 0.999694062024355, "kl": 0.012246344692660739, "entropy": -0.3091638834370921, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "env_runners": {"episode_reward_max": 17.340344785944783, "episode_reward_min": -155.66108441268386, "episode_reward_mean": -59.400813458947, "episode_len_mean": 60.52, "episode_media": {}, "episodes_timesteps_total": 6052, "policy_reward_min": {"policy_0": -155.66108441268386}, "policy_reward_max": {"policy_0": 17.340344785944783}, "policy_reward_mean": {"policy_0": -59.400813458947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.872848904935388, -5.245550995046662, 13.893471541756904, -130.26075174827704, -128.74441843177655, -23.796172242455064, -147.83040327246482, -5.304917330212618, -132.22347072394058, -122.37087973080804, -93.03508727500373, -122.99086397210216, -16.712890190296438, -113.92845646040342, -78.41099216492059, 0.9509608165486267, -37.87745765455113, -48.21569433452016, -122.38376011649731, 3.850114745869484, -3.641280109194128, -124.55643886990707, -19.75490809388903, -20.34983560228704, -11.454626426371792, -104.17375084815802, -80.88264310896933, -77.51265552794494, -99.90830506786142, -34.98277585162634, 13.946034710383467, -155.66108441268386, -33.8815073081023, -147.2426667925997, -40.611946961608474, -90.05826253552559, 11.889417023703443, -93.0421491602098, -144.36116798726002, 1.2249252663816395, -8.680272866492329, -115.09431187857207, 7.583214183161499, -32.87438073976042, -108.61589885368728, -91.60997391533368, -25.18781453348368, -8.076859329718163, -136.1242937887785, -0.8440939038259356, -55.17747483273319, -17.770015913306246, -67.30351982193362, -103.92327513463948, -102.06970663203938, 17.340344785944783, -10.962554730565753, -86.2345769863788, 1.719268706677592, -9.605602607427095, -69.41677491027755, -72.74152708584691, -143.40629232078896, -142.9112943822742, -19.113620569460917, -46.47540509383997, 5.556168822997364, -25.738846148026635, -118.0675717394315, -141.28447078034685, -30.556926416623995, -65.96614250517538, -70.54645896676666, -86.2674326996654, -72.3162814313279, -26.468476938473206, -15.71091260725823, -44.19960241133208, -45.46655493956956, -41.44074918619044, -40.29969351626676, -129.95122967843182, -71.69245439124191, 15.910741819320137, -15.70267381966186, -48.760621400390995, 13.82854645370904, -56.47433761334904, 2.835961308824317, -149.2139534187009, -140.59168677846048, -107.64122206811157, -33.111354601691545, -22.529547415574463, -154.67554687334209, 4.9782437703951565, -80.2140877551539, -39.278075320800255, -5.004207837804064, -91.66317735750089], "episode_lengths": [45, 50, 40, 78, 78, 48, 84, 50, 82, 75, 69, 77, 46, 75, 64, 42, 52, 57, 77, 41, 43, 81, 48, 56, 53, 73, 71, 68, 70, 53, 30, 86, 62, 84, 63, 68, 34, 75, 82, 39, 47, 78, 41, 55, 72, 69, 56, 52, 83, 38, 59, 43, 76, 73, 72, 37, 42, 68, 46, 45, 65, 67, 82, 82, 53, 54, 38, 59, 75, 80, 49, 61, 63, 71, 69, 54, 46, 57, 61, 57, 55, 82, 65, 36, 54, 56, 36, 62, 36, 82, 81, 75, 58, 45, 82, 41, 65, 56, 50, 71], "policy_policy_0_reward": [0.872848904935388, -5.245550995046662, 13.893471541756904, -130.26075174827704, -128.74441843177655, -23.796172242455064, -147.83040327246482, -5.304917330212618, -132.22347072394058, -122.37087973080804, -93.03508727500373, -122.99086397210216, -16.712890190296438, -113.92845646040342, -78.41099216492059, 0.9509608165486267, -37.87745765455113, -48.21569433452016, -122.38376011649731, 3.850114745869484, -3.641280109194128, -124.55643886990707, -19.75490809388903, -20.34983560228704, -11.454626426371792, -104.17375084815802, -80.88264310896933, -77.51265552794494, -99.90830506786142, -34.98277585162634, 13.946034710383467, -155.66108441268386, -33.8815073081023, -147.2426667925997, -40.611946961608474, -90.05826253552559, 11.889417023703443, -93.0421491602098, -144.36116798726002, 1.2249252663816395, -8.680272866492329, -115.09431187857207, 7.583214183161499, -32.87438073976042, -108.61589885368728, -91.60997391533368, -25.18781453348368, -8.076859329718163, -136.1242937887785, -0.8440939038259356, -55.17747483273319, -17.770015913306246, -67.30351982193362, -103.92327513463948, -102.06970663203938, 17.340344785944783, -10.962554730565753, -86.2345769863788, 1.719268706677592, -9.605602607427095, -69.41677491027755, -72.74152708584691, -143.40629232078896, -142.9112943822742, -19.113620569460917, -46.47540509383997, 5.556168822997364, -25.738846148026635, -118.0675717394315, -141.28447078034685, -30.556926416623995, -65.96614250517538, -70.54645896676666, -86.2674326996654, -72.3162814313279, -26.468476938473206, -15.71091260725823, -44.19960241133208, -45.46655493956956, -41.44074918619044, -40.29969351626676, -129.95122967843182, -71.69245439124191, 15.910741819320137, -15.70267381966186, -48.760621400390995, 13.82854645370904, -56.47433761334904, 2.835961308824317, -149.2139534187009, -140.59168677846048, -107.64122206811157, -33.111354601691545, -22.529547415574463, -154.67554687334209, 4.9782437703951565, -80.2140877551539, -39.278075320800255, -5.004207837804064, -91.66317735750089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5270975138973601, "mean_inference_ms": 1.5626252092569204, "mean_action_processing_ms": 0.25394026859465574, "mean_env_wait_ms": 3.759677420619845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011897087097167969, "StateBufferConnector_ms": 0.0077152252197265625, "ViewRequirementAgentConnector_ms": 0.18721652030944824}, "num_episodes": 62, "episode_return_max": 17.340344785944783, "episode_return_min": -155.66108441268386, "episode_return_mean": -59.400813458947, "episodes_this_iter": 62}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.72323036338247, "num_env_steps_trained_throughput_per_sec": 317.72323036338247, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 11828.619, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11828.538, "sample_time_ms": 1367.102, "learn_time_ms": 10407.779, "learn_throughput": 384.328, "synch_weights_time_ms": 52.711}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "training_iteration": 91, "trial_id": "8adec_00000", "date": "2024-07-24_15-20-09", "timestamp": 1721814609, "time_this_iter_s": 12.600103855133057, "time_total_s": 1075.9315764904022, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ea440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1075.9315764904022, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 20.405555555555555, "ram_util_percent": 37.916666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.350306418538096, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.13879624478674182, "policy_loss": -0.002818405566116174, "vf_loss": 0.12411994842113927, "vf_explained_var": 0.9997927321741978, "kl": 0.014030004354268991, "entropy": -0.32893223738841093, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 19.164154000326096, "episode_reward_min": -192.60210709704057, "episode_reward_mean": -59.411753844463256, "episode_len_mean": 60.34, "episode_media": {}, "episodes_timesteps_total": 6034, "policy_reward_min": {"policy_0": -192.60210709704057}, "policy_reward_max": {"policy_0": 19.164154000326096}, "policy_reward_mean": {"policy_0": -59.411753844463256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.556926416623995, -65.96614250517538, -70.54645896676666, -86.2674326996654, -72.3162814313279, -26.468476938473206, -15.71091260725823, -44.19960241133208, -45.46655493956956, -41.44074918619044, -40.29969351626676, -129.95122967843182, -71.69245439124191, 15.910741819320137, -15.70267381966186, -48.760621400390995, 13.82854645370904, -56.47433761334904, 2.835961308824317, -149.2139534187009, -140.59168677846048, -107.64122206811157, -33.111354601691545, -22.529547415574463, -154.67554687334209, 4.9782437703951565, -80.2140877551539, -39.278075320800255, -5.004207837804064, -91.66317735750089, -51.061435033840795, -71.76366308232011, -95.70372841281488, -116.52216053536623, -140.38651145167782, -64.99269334340296, -31.23082647706541, -142.18289595000343, -95.8784059997943, -11.368551205935598, 13.160743513408766, -73.25441935115767, 4.743515701512486, -37.12299073894692, -16.89289189054637, -107.37899808057654, -91.50323433038363, -112.23959544289967, -85.19312512637802, -86.02964617383147, -108.3065879915248, 9.362492015764506, -157.93606658185817, -15.489157801468602, 12.531712698024526, -70.30187368162032, -130.3791608421826, -49.214262180346616, 14.487564872582174, -166.37163479912968, -48.76377797202579, 18.05716093642083, -102.13993910402849, 2.5864644964335897, -89.54446300403042, -78.01856170467173, -148.56478265209873, -25.65525700499995, -62.370291911484635, 11.171786278974006, 1.502043566682594, 19.164154000326096, -192.60210709704057, -12.735206944778945, -110.5359667736945, -11.475105214535535, -2.0146062789507666, -2.982914824471478, -96.0422816346975, -44.68770906037473, 9.990572385155241, -136.95347307433028, -72.77805795010214, -56.436186593467326, -59.60413665736245, -83.97765392042751, -72.49778139859043, -126.61331630122137, 15.807841383422042, -18.54849459764657, -165.11663000181952, 9.46311295884659, -112.22654209624662, 7.553164529791544, -6.20460879225625, -89.26315109031515, -78.6504062794079, -84.63054526283791, -7.387926195732998, -114.84140128833326], "episode_lengths": [49, 61, 63, 71, 69, 54, 46, 57, 61, 57, 55, 82, 65, 36, 54, 56, 36, 62, 36, 82, 81, 75, 58, 45, 82, 41, 65, 56, 50, 71, 56, 69, 70, 75, 83, 64, 50, 83, 80, 51, 33, 71, 36, 54, 46, 73, 77, 76, 66, 66, 74, 38, 86, 53, 34, 66, 80, 55, 29, 85, 57, 30, 72, 49, 69, 65, 86, 57, 61, 40, 45, 37, 91, 57, 75, 48, 38, 39, 69, 58, 40, 81, 65, 65, 64, 67, 63, 80, 30, 49, 89, 44, 76, 33, 53, 69, 67, 77, 49, 75], "policy_policy_0_reward": [-30.556926416623995, -65.96614250517538, -70.54645896676666, -86.2674326996654, -72.3162814313279, -26.468476938473206, -15.71091260725823, -44.19960241133208, -45.46655493956956, -41.44074918619044, -40.29969351626676, -129.95122967843182, -71.69245439124191, 15.910741819320137, -15.70267381966186, -48.760621400390995, 13.82854645370904, -56.47433761334904, 2.835961308824317, -149.2139534187009, -140.59168677846048, -107.64122206811157, -33.111354601691545, -22.529547415574463, -154.67554687334209, 4.9782437703951565, -80.2140877551539, -39.278075320800255, -5.004207837804064, -91.66317735750089, -51.061435033840795, -71.76366308232011, -95.70372841281488, -116.52216053536623, -140.38651145167782, -64.99269334340296, -31.23082647706541, -142.18289595000343, -95.8784059997943, -11.368551205935598, 13.160743513408766, -73.25441935115767, 4.743515701512486, -37.12299073894692, -16.89289189054637, -107.37899808057654, -91.50323433038363, -112.23959544289967, -85.19312512637802, -86.02964617383147, -108.3065879915248, 9.362492015764506, -157.93606658185817, -15.489157801468602, 12.531712698024526, -70.30187368162032, -130.3791608421826, -49.214262180346616, 14.487564872582174, -166.37163479912968, -48.76377797202579, 18.05716093642083, -102.13993910402849, 2.5864644964335897, -89.54446300403042, -78.01856170467173, -148.56478265209873, -25.65525700499995, -62.370291911484635, 11.171786278974006, 1.502043566682594, 19.164154000326096, -192.60210709704057, -12.735206944778945, -110.5359667736945, -11.475105214535535, -2.0146062789507666, -2.982914824471478, -96.0422816346975, -44.68770906037473, 9.990572385155241, -136.95347307433028, -72.77805795010214, -56.436186593467326, -59.60413665736245, -83.97765392042751, -72.49778139859043, -126.61331630122137, 15.807841383422042, -18.54849459764657, -165.11663000181952, 9.46311295884659, -112.22654209624662, 7.553164529791544, -6.20460879225625, -89.26315109031515, -78.6504062794079, -84.63054526283791, -7.387926195732998, -114.84140128833326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5276488079967918, "mean_inference_ms": 1.5633700362732794, "mean_action_processing_ms": 0.2538535916582165, "mean_env_wait_ms": 3.7630479890347472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011865854263305664, "StateBufferConnector_ms": 0.007593393325805664, "ViewRequirementAgentConnector_ms": 0.18291592597961426}, "num_episodes": 70, "episode_return_max": 19.164154000326096, "episode_return_min": -192.60210709704057, "episode_return_mean": -59.411753844463256, "episodes_this_iter": 70}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.58966980563514, "num_env_steps_trained_throughput_per_sec": 325.58966980563514, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 11771.899, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11771.822, "sample_time_ms": 1369.423, "learn_time_ms": 10348.333, "learn_throughput": 386.536, "synch_weights_time_ms": 53.056}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 92, "trial_id": "8adec_00000", "date": "2024-07-24_15-20-22", "timestamp": 1721814622, "time_this_iter_s": 12.29599928855896, "time_total_s": 1088.2275757789612, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8ca170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1088.2275757789612, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 21.288235294117644, "ram_util_percent": 37.84117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.80087290207545, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.15392862604688465, "policy_loss": -0.004205915149456511, "vf_loss": 0.14240013963232437, "vf_explained_var": 0.9997504775722822, "kl": 0.012098305457281336, "entropy": -0.3484865631830568, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": 19.164154000326096, "episode_reward_min": -219.41188883431613, "episode_reward_mean": -62.308286544876275, "episode_len_mean": 61.22, "episode_media": {}, "episodes_timesteps_total": 6122, "policy_reward_min": {"policy_0": -219.41188883431613}, "policy_reward_max": {"policy_0": 19.164154000326096}, "policy_reward_mean": {"policy_0": -62.308286544876275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.01856170467173, -148.56478265209873, -25.65525700499995, -62.370291911484635, 11.171786278974006, 1.502043566682594, 19.164154000326096, -192.60210709704057, -12.735206944778945, -110.5359667736945, -11.475105214535535, -2.0146062789507666, -2.982914824471478, -96.0422816346975, -44.68770906037473, 9.990572385155241, -136.95347307433028, -72.77805795010214, -56.436186593467326, -59.60413665736245, -83.97765392042751, -72.49778139859043, -126.61331630122137, 15.807841383422042, -18.54849459764657, -165.11663000181952, 9.46311295884659, -112.22654209624662, 7.553164529791544, -6.20460879225625, -89.26315109031515, -78.6504062794079, -84.63054526283791, -7.387926195732998, -114.84140128833326, -0.5834416482177329, -81.18357217731439, -219.41188883431613, -164.63192384115294, -130.2413896708776, -37.25466409610574, -81.53062860272783, -71.58871627348124, -97.91370538782861, -103.10467658438537, -122.36816014895521, -49.323587810538825, -83.52652278388166, -71.5089863347281, -10.583573722963601, -54.42165416362514, 18.906869490877078, -55.004946679361915, 2.8004930291174954, -102.40130364018627, -7.985379709065783, -85.50702878950892, -15.91355116545101, -99.7548320451423, -143.6875195847699, -44.47477062001221, -2.0632741207729812, -101.40376965011947, -18.251132765110377, -0.7263538333195314, -41.53396104883099, -12.049754909380288, -23.371470115394473, -85.17120514099331, -45.12977410092593, -23.702338154504176, -160.40994517071096, -42.160134373120314, -209.77510737635671, -131.03112010351163, -25.0954266789849, -49.58172132288842, -10.980948080139965, -179.2818046995852, -100.500365620143, -27.35344159105959, -142.27347212734568, -27.345771824966942, 16.34387750709666, 14.450366992306762, -159.17578714819135, -44.089088374336505, -14.054110859767857, -46.49837469556131, -157.07097430710678, 10.659002753074244, 9.390260751849048, -75.76067848174604, -57.089867866758176, -21.65726398160536, -73.41551337501339, -65.50893083940113, -8.493944271653818, -15.154793905688546, -173.54905228365735], "episode_lengths": [65, 86, 57, 61, 40, 45, 37, 91, 57, 75, 48, 38, 39, 69, 58, 40, 81, 65, 65, 64, 67, 63, 80, 30, 49, 89, 44, 76, 33, 53, 69, 67, 77, 49, 75, 47, 66, 99, 90, 80, 50, 67, 63, 72, 73, 79, 62, 67, 65, 49, 59, 31, 66, 48, 74, 51, 66, 45, 71, 81, 58, 38, 77, 51, 38, 57, 45, 56, 68, 61, 58, 85, 54, 96, 79, 59, 61, 47, 89, 71, 52, 81, 56, 29, 30, 86, 60, 47, 56, 83, 36, 35, 65, 62, 53, 64, 64, 53, 52, 87], "policy_policy_0_reward": [-78.01856170467173, -148.56478265209873, -25.65525700499995, -62.370291911484635, 11.171786278974006, 1.502043566682594, 19.164154000326096, -192.60210709704057, -12.735206944778945, -110.5359667736945, -11.475105214535535, -2.0146062789507666, -2.982914824471478, -96.0422816346975, -44.68770906037473, 9.990572385155241, -136.95347307433028, -72.77805795010214, -56.436186593467326, -59.60413665736245, -83.97765392042751, -72.49778139859043, -126.61331630122137, 15.807841383422042, -18.54849459764657, -165.11663000181952, 9.46311295884659, -112.22654209624662, 7.553164529791544, -6.20460879225625, -89.26315109031515, -78.6504062794079, -84.63054526283791, -7.387926195732998, -114.84140128833326, -0.5834416482177329, -81.18357217731439, -219.41188883431613, -164.63192384115294, -130.2413896708776, -37.25466409610574, -81.53062860272783, -71.58871627348124, -97.91370538782861, -103.10467658438537, -122.36816014895521, -49.323587810538825, -83.52652278388166, -71.5089863347281, -10.583573722963601, -54.42165416362514, 18.906869490877078, -55.004946679361915, 2.8004930291174954, -102.40130364018627, -7.985379709065783, -85.50702878950892, -15.91355116545101, -99.7548320451423, -143.6875195847699, -44.47477062001221, -2.0632741207729812, -101.40376965011947, -18.251132765110377, -0.7263538333195314, -41.53396104883099, -12.049754909380288, -23.371470115394473, -85.17120514099331, -45.12977410092593, -23.702338154504176, -160.40994517071096, -42.160134373120314, -209.77510737635671, -131.03112010351163, -25.0954266789849, -49.58172132288842, -10.980948080139965, -179.2818046995852, -100.500365620143, -27.35344159105959, -142.27347212734568, -27.345771824966942, 16.34387750709666, 14.450366992306762, -159.17578714819135, -44.089088374336505, -14.054110859767857, -46.49837469556131, -157.07097430710678, 10.659002753074244, 9.390260751849048, -75.76067848174604, -57.089867866758176, -21.65726398160536, -73.41551337501339, -65.50893083940113, -8.493944271653818, -15.154793905688546, -173.54905228365735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5276250598720316, "mean_inference_ms": 1.5632155574386895, "mean_action_processing_ms": 0.254058314433207, "mean_env_wait_ms": 3.7651770891844705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011218786239624023, "StateBufferConnector_ms": 0.007399320602416992, "ViewRequirementAgentConnector_ms": 0.17868304252624512}, "num_episodes": 65, "episode_return_max": 19.164154000326096, "episode_return_min": -219.41188883431613, "episode_return_mean": -62.308286544876275, "episodes_this_iter": 65}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.68826225446213, "num_env_steps_trained_throughput_per_sec": 337.68826225446213, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 11675.464, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11675.39, "sample_time_ms": 1366.627, "learn_time_ms": 10255.164, "learn_throughput": 390.047, "synch_weights_time_ms": 52.592}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 93, "trial_id": "8adec_00000", "date": "2024-07-24_15-20-33", "timestamp": 1721814633, "time_this_iter_s": 11.858242750167847, "time_total_s": 1100.085818529129, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b958430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1100.085818529129, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 19.57058823529412, "ram_util_percent": 37.976470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.379990083972615, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.13123853297778018, "policy_loss": -0.0015859310602536424, "vf_loss": 0.11687524777759488, "vf_explained_var": 0.9997930014505982, "kl": 0.012170558476388276, "entropy": -0.3626525134469072, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 22.272890951990995, "episode_reward_min": -209.77510737635671, "episode_reward_mean": -55.97079059511537, "episode_len_mean": 59.53, "episode_media": {}, "episodes_timesteps_total": 5953, "policy_reward_min": {"policy_0": -209.77510737635671}, "policy_reward_max": {"policy_0": 22.272890951990995}, "policy_reward_mean": {"policy_0": -55.97079059511537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.049754909380288, -23.371470115394473, -85.17120514099331, -45.12977410092593, -23.702338154504176, -160.40994517071096, -42.160134373120314, -209.77510737635671, -131.03112010351163, -25.0954266789849, -49.58172132288842, -10.980948080139965, -179.2818046995852, -100.500365620143, -27.35344159105959, -142.27347212734568, -27.345771824966942, 16.34387750709666, 14.450366992306762, -159.17578714819135, -44.089088374336505, -14.054110859767857, -46.49837469556131, -157.07097430710678, 10.659002753074244, 9.390260751849048, -75.76067848174604, -57.089867866758176, -21.65726398160536, -73.41551337501339, -65.50893083940113, -8.493944271653818, -15.154793905688546, -173.54905228365735, 12.132935032814379, -1.987155401863592, 11.473921915785029, -84.66368983838144, -78.4679234470399, -50.56847366446623, -83.66732069641529, -56.246423939515005, -33.00096721456482, -77.45406357961448, 12.713123583930862, -44.78196555392585, -29.751165693917258, -20.955387440951093, -102.79845154499246, -49.94925504312632, -98.67723561753972, -64.78769340040598, 8.706851822886625, -15.399807522513127, -150.9087565630997, 7.609400998803874, -60.68258030061506, -43.77668395087113, -12.308873614138841, 6.312531756186884, -182.64676574106042, -21.35691794239204, 20.330212011014215, -151.64045197248672, -83.2713343787686, -99.3773235209999, -13.152492532831944, -85.01436623448042, -3.3931729348343485, -25.609260184997094, -126.30449625681568, -18.49948241712317, -79.14297659554948, -5.370384817239595, -96.71243334351561, -119.84925557746081, -6.271749016322195, -100.53214467282233, -27.80413997651865, -1.6281142320693216, -97.94390855776884, 15.852327244460987, 5.26548618207876, -97.89218316584136, -162.86212884872762, -89.10778948324041, -59.05787878970051, -54.488462773484606, -0.5804489345133423, 13.30716231289827, -85.16929720303499, -56.178417098276014, -78.35172254567884, -132.3156946575108, 22.272890951990995, -154.68446034980852, -46.170242840080356, 17.7332886940336, -67.85226865752487, -3.834477960812773], "episode_lengths": [45, 56, 68, 61, 58, 85, 54, 96, 79, 59, 61, 47, 89, 71, 52, 81, 56, 29, 30, 86, 60, 47, 56, 83, 36, 35, 65, 62, 53, 64, 64, 53, 52, 87, 34, 43, 42, 68, 71, 56, 66, 64, 57, 68, 41, 63, 61, 58, 72, 58, 73, 61, 39, 50, 85, 44, 62, 62, 47, 40, 88, 50, 29, 85, 66, 76, 47, 72, 40, 54, 79, 53, 65, 43, 72, 78, 40, 74, 53, 52, 80, 32, 41, 72, 89, 69, 59, 58, 46, 37, 72, 61, 65, 83, 27, 87, 55, 32, 65, 42], "policy_policy_0_reward": [-12.049754909380288, -23.371470115394473, -85.17120514099331, -45.12977410092593, -23.702338154504176, -160.40994517071096, -42.160134373120314, -209.77510737635671, -131.03112010351163, -25.0954266789849, -49.58172132288842, -10.980948080139965, -179.2818046995852, -100.500365620143, -27.35344159105959, -142.27347212734568, -27.345771824966942, 16.34387750709666, 14.450366992306762, -159.17578714819135, -44.089088374336505, -14.054110859767857, -46.49837469556131, -157.07097430710678, 10.659002753074244, 9.390260751849048, -75.76067848174604, -57.089867866758176, -21.65726398160536, -73.41551337501339, -65.50893083940113, -8.493944271653818, -15.154793905688546, -173.54905228365735, 12.132935032814379, -1.987155401863592, 11.473921915785029, -84.66368983838144, -78.4679234470399, -50.56847366446623, -83.66732069641529, -56.246423939515005, -33.00096721456482, -77.45406357961448, 12.713123583930862, -44.78196555392585, -29.751165693917258, -20.955387440951093, -102.79845154499246, -49.94925504312632, -98.67723561753972, -64.78769340040598, 8.706851822886625, -15.399807522513127, -150.9087565630997, 7.609400998803874, -60.68258030061506, -43.77668395087113, -12.308873614138841, 6.312531756186884, -182.64676574106042, -21.35691794239204, 20.330212011014215, -151.64045197248672, -83.2713343787686, -99.3773235209999, -13.152492532831944, -85.01436623448042, -3.3931729348343485, -25.609260184997094, -126.30449625681568, -18.49948241712317, -79.14297659554948, -5.370384817239595, -96.71243334351561, -119.84925557746081, -6.271749016322195, -100.53214467282233, -27.80413997651865, -1.6281142320693216, -97.94390855776884, 15.852327244460987, 5.26548618207876, -97.89218316584136, -162.86212884872762, -89.10778948324041, -59.05787878970051, -54.488462773484606, -0.5804489345133423, 13.30716231289827, -85.16929720303499, -56.178417098276014, -78.35172254567884, -132.3156946575108, 22.272890951990995, -154.68446034980852, -46.170242840080356, 17.7332886940336, -67.85226865752487, -3.834477960812773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5276011853366367, "mean_inference_ms": 1.5624140799850808, "mean_action_processing_ms": 0.25388400203785516, "mean_env_wait_ms": 3.765284201035239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011612415313720703, "StateBufferConnector_ms": 0.007491350173950195, "ViewRequirementAgentConnector_ms": 0.17939114570617676}, "num_episodes": 66, "episode_return_max": 22.272890951990995, "episode_return_min": -209.77510737635671, "episode_return_mean": -55.97079059511537, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.4768440349941, "num_env_steps_trained_throughput_per_sec": 309.4768440349941, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 11661.442, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11661.367, "sample_time_ms": 1364.118, "learn_time_ms": 10243.859, "learn_throughput": 390.478, "synch_weights_time_ms": 52.301}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 94, "trial_id": "8adec_00000", "date": "2024-07-24_15-20-46", "timestamp": 1721814646, "time_this_iter_s": 12.936787605285645, "time_total_s": 1113.0226061344147, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b95b7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1113.0226061344147, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 19.96315789473684, "ram_util_percent": 37.88421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.31590463221073, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.14130402183994495, "policy_loss": -0.0030218328368694833, "vf_loss": 0.12620911319584896, "vf_explained_var": 0.9997957831869523, "kl": 0.014454371626834472, "entropy": -0.34816899688060704, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": 22.272890951990995, "episode_reward_min": -197.1784998724622, "episode_reward_mean": -60.34751372246858, "episode_len_mean": 60.62, "episode_media": {}, "episodes_timesteps_total": 6062, "policy_reward_min": {"policy_0": -197.1784998724622}, "policy_reward_max": {"policy_0": 22.272890951990995}, "policy_reward_mean": {"policy_0": -60.34751372246858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.2713343787686, -99.3773235209999, -13.152492532831944, -85.01436623448042, -3.3931729348343485, -25.609260184997094, -126.30449625681568, -18.49948241712317, -79.14297659554948, -5.370384817239595, -96.71243334351561, -119.84925557746081, -6.271749016322195, -100.53214467282233, -27.80413997651865, -1.6281142320693216, -97.94390855776884, 15.852327244460987, 5.26548618207876, -97.89218316584136, -162.86212884872762, -89.10778948324041, -59.05787878970051, -54.488462773484606, -0.5804489345133423, 13.30716231289827, -85.16929720303499, -56.178417098276014, -78.35172254567884, -132.3156946575108, 22.272890951990995, -154.68446034980852, -46.170242840080356, 17.7332886940336, -67.85226865752487, -3.834477960812773, -98.04095715791678, -135.60291469623186, -114.5527423697792, -31.97799220637382, 5.620729244314338, 12.287602556920554, -65.16468366598872, -105.86214402949011, -162.87898081597368, -17.25825047431949, 4.5936865375068, -123.70580189561856, -78.99501051547279, -166.2367461064856, -63.788107099551254, -83.52325372466132, -132.32093149550724, -13.155166801003295, -29.158527436385604, -139.16096159185653, -91.2553841336621, -84.62140044015099, -162.27171350706084, -88.97360796829831, -95.72528386221276, -4.021764185671735, -47.04148453223868, -100.547215294586, -49.10352896898453, -89.85064382126392, -6.363777596650042, -41.61441774993231, -194.41630080211357, -142.71375348704035, 15.276232152561096, 4.2818071392623125, -64.88660478171714, -55.12212490945681, 12.544500998178743, -48.065682956246626, -38.23692715514707, -6.50288335357893, -45.674585294000444, 5.528166155167376, -60.94545592287702, -32.60553744578948, 4.33985281716461, 3.268384250405354, -8.585768387329852, -88.05362185926059, -31.21839925717812, -197.1784998724622, -81.41403688152317, -74.42078383963955, -151.47506126513, -29.816477934837135, -162.3785949488792, -36.75539859438609, 10.658092755103002, 10.889588501779505, -54.260613807188165, -12.411656352468363, -15.18544235093378, -64.95105657981891], "episode_lengths": [66, 76, 47, 72, 40, 54, 79, 53, 65, 43, 72, 78, 40, 74, 53, 52, 80, 32, 41, 72, 89, 69, 59, 58, 46, 37, 72, 61, 65, 83, 27, 87, 55, 32, 65, 42, 71, 82, 75, 57, 39, 35, 68, 77, 88, 51, 44, 78, 65, 85, 61, 67, 79, 41, 49, 83, 69, 68, 85, 68, 71, 43, 56, 71, 58, 73, 52, 53, 92, 82, 36, 49, 64, 66, 37, 61, 59, 48, 63, 34, 66, 49, 42, 40, 43, 66, 61, 91, 69, 68, 83, 49, 87, 52, 41, 34, 62, 54, 56, 60], "policy_policy_0_reward": [-83.2713343787686, -99.3773235209999, -13.152492532831944, -85.01436623448042, -3.3931729348343485, -25.609260184997094, -126.30449625681568, -18.49948241712317, -79.14297659554948, -5.370384817239595, -96.71243334351561, -119.84925557746081, -6.271749016322195, -100.53214467282233, -27.80413997651865, -1.6281142320693216, -97.94390855776884, 15.852327244460987, 5.26548618207876, -97.89218316584136, -162.86212884872762, -89.10778948324041, -59.05787878970051, -54.488462773484606, -0.5804489345133423, 13.30716231289827, -85.16929720303499, -56.178417098276014, -78.35172254567884, -132.3156946575108, 22.272890951990995, -154.68446034980852, -46.170242840080356, 17.7332886940336, -67.85226865752487, -3.834477960812773, -98.04095715791678, -135.60291469623186, -114.5527423697792, -31.97799220637382, 5.620729244314338, 12.287602556920554, -65.16468366598872, -105.86214402949011, -162.87898081597368, -17.25825047431949, 4.5936865375068, -123.70580189561856, -78.99501051547279, -166.2367461064856, -63.788107099551254, -83.52325372466132, -132.32093149550724, -13.155166801003295, -29.158527436385604, -139.16096159185653, -91.2553841336621, -84.62140044015099, -162.27171350706084, -88.97360796829831, -95.72528386221276, -4.021764185671735, -47.04148453223868, -100.547215294586, -49.10352896898453, -89.85064382126392, -6.363777596650042, -41.61441774993231, -194.41630080211357, -142.71375348704035, 15.276232152561096, 4.2818071392623125, -64.88660478171714, -55.12212490945681, 12.544500998178743, -48.065682956246626, -38.23692715514707, -6.50288335357893, -45.674585294000444, 5.528166155167376, -60.94545592287702, -32.60553744578948, 4.33985281716461, 3.268384250405354, -8.585768387329852, -88.05362185926059, -31.21839925717812, -197.1784998724622, -81.41403688152317, -74.42078383963955, -151.47506126513, -29.816477934837135, -162.3785949488792, -36.75539859438609, 10.658092755103002, 10.889588501779505, -54.260613807188165, -12.411656352468363, -15.18544235093378, -64.95105657981891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527253640238757, "mean_inference_ms": 1.561902422197485, "mean_action_processing_ms": 0.2537649098936389, "mean_env_wait_ms": 3.765727552248975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01131129264831543, "StateBufferConnector_ms": 0.007464885711669922, "ViewRequirementAgentConnector_ms": 0.18137407302856445}, "num_episodes": 64, "episode_return_max": 22.272890951990995, "episode_return_min": -197.1784998724622, "episode_return_mean": -60.34751372246858, "episodes_this_iter": 64}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.94914112419514, "num_env_steps_trained_throughput_per_sec": 303.94914112419514, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 11834.609, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11834.534, "sample_time_ms": 1365.441, "learn_time_ms": 10415.447, "learn_throughput": 384.045, "synch_weights_time_ms": 52.533}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 95, "trial_id": "8adec_00000", "date": "2024-07-24_15-21-00", "timestamp": 1721814660, "time_this_iter_s": 13.173663854598999, "time_total_s": 1126.1962699890137, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b95ba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1126.1962699890137, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 18.983333333333334, "ram_util_percent": 37.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.13006111731132, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.13189515971510749, "policy_loss": -0.008421343931695446, "vf_loss": 0.12506341872503982, "vf_explained_var": 0.9997966760769487, "kl": 0.012090903616251581, "entropy": -0.3011044813708092, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 23.27262126527623, "episode_reward_min": -211.91411436210896, "episode_reward_mean": -58.0500554461003, "episode_len_mean": 59.93, "episode_media": {}, "episodes_timesteps_total": 5993, "policy_reward_min": {"policy_0": -211.91411436210896}, "policy_reward_max": {"policy_0": 23.27262126527623}, "policy_reward_mean": {"policy_0": -58.0500554461003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.61441774993231, -194.41630080211357, -142.71375348704035, 15.276232152561096, 4.2818071392623125, -64.88660478171714, -55.12212490945681, 12.544500998178743, -48.065682956246626, -38.23692715514707, -6.50288335357893, -45.674585294000444, 5.528166155167376, -60.94545592287702, -32.60553744578948, 4.33985281716461, 3.268384250405354, -8.585768387329852, -88.05362185926059, -31.21839925717812, -197.1784998724622, -81.41403688152317, -74.42078383963955, -151.47506126513, -29.816477934837135, -162.3785949488792, -36.75539859438609, 10.658092755103002, 10.889588501779505, -54.260613807188165, -12.411656352468363, -15.18544235093378, -64.95105657981891, 12.210734630797202, -109.98978865824965, 23.27262126527623, -26.131992810071036, -114.99191223593597, -95.84316823310579, -92.64784332192556, -39.09499145480539, -11.518615249075658, -57.47620394094425, -81.19173897617686, -82.67126822280437, 14.370034491924564, -93.7896259358534, -95.6334522380247, -100.62130585663694, -3.2192628977261086, -211.91411436210896, -161.8972573753552, -1.6492136539172166, -14.055615742393442, -135.0889742847199, -129.83750350281363, -68.34382279831011, -62.32009901448581, -68.94000247289856, -12.187759022468166, -66.53312278964005, -92.69922790419437, -128.47605628336746, -90.59013855220765, -203.46526384391314, -3.756524945695875, -180.52952909058314, -87.19987260034719, 0.9407976308668335, -146.4988640314036, 10.603684052834803, -18.788765380294123, -16.30004731201283, -77.6728954290337, 2.1427848336135153, -26.866049758914016, -65.2466252394081, -7.352948857448121, -187.92894684661005, -86.62258488069146, -35.61906920244353, -115.93886697127468, -15.214500847275746, 13.913355031376266, -1.045272299922957, -39.05714278514955, -20.534782818682395, 6.310275764638133, -29.040977583689795, -6.683360900925793, -76.07800370839067, -71.88637463410012, -83.60189179909088, -61.51813822929931, -86.84158118098185, -135.65618752564941, -37.077399604645855, -29.326505563537776, -1.8119619303715824, -12.15175770004181], "episode_lengths": [53, 92, 82, 36, 49, 64, 66, 37, 61, 59, 48, 63, 34, 66, 49, 42, 40, 43, 66, 61, 91, 69, 68, 83, 49, 87, 52, 41, 34, 62, 54, 56, 60, 30, 75, 27, 51, 79, 74, 70, 53, 44, 62, 67, 68, 32, 71, 73, 72, 39, 98, 87, 48, 49, 80, 79, 67, 65, 61, 41, 68, 69, 82, 69, 94, 44, 89, 72, 40, 83, 36, 59, 55, 70, 45, 54, 60, 52, 93, 69, 55, 74, 52, 27, 38, 63, 49, 36, 57, 49, 63, 68, 66, 61, 72, 83, 51, 57, 42, 48], "policy_policy_0_reward": [-41.61441774993231, -194.41630080211357, -142.71375348704035, 15.276232152561096, 4.2818071392623125, -64.88660478171714, -55.12212490945681, 12.544500998178743, -48.065682956246626, -38.23692715514707, -6.50288335357893, -45.674585294000444, 5.528166155167376, -60.94545592287702, -32.60553744578948, 4.33985281716461, 3.268384250405354, -8.585768387329852, -88.05362185926059, -31.21839925717812, -197.1784998724622, -81.41403688152317, -74.42078383963955, -151.47506126513, -29.816477934837135, -162.3785949488792, -36.75539859438609, 10.658092755103002, 10.889588501779505, -54.260613807188165, -12.411656352468363, -15.18544235093378, -64.95105657981891, 12.210734630797202, -109.98978865824965, 23.27262126527623, -26.131992810071036, -114.99191223593597, -95.84316823310579, -92.64784332192556, -39.09499145480539, -11.518615249075658, -57.47620394094425, -81.19173897617686, -82.67126822280437, 14.370034491924564, -93.7896259358534, -95.6334522380247, -100.62130585663694, -3.2192628977261086, -211.91411436210896, -161.8972573753552, -1.6492136539172166, -14.055615742393442, -135.0889742847199, -129.83750350281363, -68.34382279831011, -62.32009901448581, -68.94000247289856, -12.187759022468166, -66.53312278964005, -92.69922790419437, -128.47605628336746, -90.59013855220765, -203.46526384391314, -3.756524945695875, -180.52952909058314, -87.19987260034719, 0.9407976308668335, -146.4988640314036, 10.603684052834803, -18.788765380294123, -16.30004731201283, -77.6728954290337, 2.1427848336135153, -26.866049758914016, -65.2466252394081, -7.352948857448121, -187.92894684661005, -86.62258488069146, -35.61906920244353, -115.93886697127468, -15.214500847275746, 13.913355031376266, -1.045272299922957, -39.05714278514955, -20.534782818682395, 6.310275764638133, -29.040977583689795, -6.683360900925793, -76.07800370839067, -71.88637463410012, -83.60189179909088, -61.51813822929931, -86.84158118098185, -135.65618752564941, -37.077399604645855, -29.326505563537776, -1.8119619303715824, -12.15175770004181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5269280955633835, "mean_inference_ms": 1.5615418141311463, "mean_action_processing_ms": 0.25390902799607834, "mean_env_wait_ms": 3.766889955028579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010897159576416016, "StateBufferConnector_ms": 0.007365226745605469, "ViewRequirementAgentConnector_ms": 0.1777327060699463}, "num_episodes": 67, "episode_return_max": 23.27262126527623, "episode_return_min": -211.91411436210896, "episode_return_mean": -58.0500554461003, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.8904775655255, "num_env_steps_trained_throughput_per_sec": 311.8904775655255, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 11803.714, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11803.639, "sample_time_ms": 1365.639, "learn_time_ms": 10385.011, "learn_throughput": 385.17, "synch_weights_time_ms": 51.859}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 96, "trial_id": "8adec_00000", "date": "2024-07-24_15-21-13", "timestamp": 1721814673, "time_this_iter_s": 12.83535385131836, "time_total_s": 1139.031623840332, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b9593f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1139.031623840332, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 20.068421052631578, "ram_util_percent": 38.01578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.86372487097979, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.12080715688643977, "policy_loss": -0.007927310197555926, "vf_loss": 0.11314236701000482, "vf_explained_var": 0.9997745268667738, "kl": 0.012201081820179193, "entropy": -0.3238503869390115, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "env_runners": {"episode_reward_max": 13.913355031376266, "episode_reward_min": -187.92894684661005, "episode_reward_mean": -53.022066690852874, "episode_len_mean": 58.93, "episode_media": {}, "episodes_timesteps_total": 5893, "policy_reward_min": {"policy_0": -187.92894684661005}, "policy_reward_max": {"policy_0": 13.913355031376266}, "policy_reward_mean": {"policy_0": -53.022066690852874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-87.19987260034719, 0.9407976308668335, -146.4988640314036, 10.603684052834803, -18.788765380294123, -16.30004731201283, -77.6728954290337, 2.1427848336135153, -26.866049758914016, -65.2466252394081, -7.352948857448121, -187.92894684661005, -86.62258488069146, -35.61906920244353, -115.93886697127468, -15.214500847275746, 13.913355031376266, -1.045272299922957, -39.05714278514955, -20.534782818682395, 6.310275764638133, -29.040977583689795, -6.683360900925793, -76.07800370839067, -71.88637463410012, -83.60189179909088, -61.51813822929931, -86.84158118098185, -135.65618752564941, -37.077399604645855, -29.326505563537776, -1.8119619303715824, -12.15175770004181, -36.28748859329223, -66.12260685379772, -71.45326042764736, -5.571212855406107, -40.15566993738295, -107.67257838688028, -116.2861112306792, 0.17172629455883803, -105.01116748589328, -112.22743132272781, -27.624820894797324, -32.48523325253437, 9.065100183174279, -66.36236689145429, -14.244203302233307, -18.98674380448201, -138.6820515069792, 3.2233190187358725, -61.0859415758259, -71.41080992926244, -45.058640924133634, -16.789875224207485, -14.23142641047116, -1.3792597178850838, -5.993013480032496, -14.77301329226415, -129.5608713624811, 13.055841363520667, 8.633856348623153, 12.529677058320878, -117.32607147417023, 8.974840412183768, -34.64375234215843, -92.60596674000648, -102.72933410505584, -98.17183637916114, 2.3513601097424504, -9.546015553866125, -70.62546131717428, -110.99333686360848, -3.134668494751043, -3.1237975245941847, -69.45167337375378, -158.13221950333326, -98.22958578916484, -158.1445486304444, -97.13823826682966, -63.25853498682838, -164.03143388531035, -24.3834962467753, -85.60940537058512, -87.67343995400987, -75.33690573435955, -111.64785955728476, -82.67326871601416, 1.8438972431722793, -8.975271779689221, -84.1553892110003, -74.0934128541684, -40.30205187890553, -13.094301526397862, -62.56598112426756, -62.88145588130329, -5.50575658907233, -125.36885136248482, 11.057675391797734, -112.45436252153073], "episode_lengths": [72, 40, 83, 36, 59, 55, 70, 45, 54, 60, 52, 93, 69, 55, 74, 52, 27, 38, 63, 49, 36, 57, 49, 63, 68, 66, 61, 72, 83, 51, 57, 42, 48, 51, 62, 68, 43, 58, 72, 76, 41, 74, 74, 57, 61, 35, 66, 53, 48, 80, 47, 59, 63, 54, 55, 48, 51, 40, 43, 79, 38, 37, 32, 80, 43, 51, 69, 74, 74, 44, 42, 68, 77, 48, 46, 62, 86, 71, 86, 70, 63, 88, 50, 68, 67, 66, 73, 69, 46, 41, 68, 65, 61, 54, 64, 60, 46, 80, 35, 74], "policy_policy_0_reward": [-87.19987260034719, 0.9407976308668335, -146.4988640314036, 10.603684052834803, -18.788765380294123, -16.30004731201283, -77.6728954290337, 2.1427848336135153, -26.866049758914016, -65.2466252394081, -7.352948857448121, -187.92894684661005, -86.62258488069146, -35.61906920244353, -115.93886697127468, -15.214500847275746, 13.913355031376266, -1.045272299922957, -39.05714278514955, -20.534782818682395, 6.310275764638133, -29.040977583689795, -6.683360900925793, -76.07800370839067, -71.88637463410012, -83.60189179909088, -61.51813822929931, -86.84158118098185, -135.65618752564941, -37.077399604645855, -29.326505563537776, -1.8119619303715824, -12.15175770004181, -36.28748859329223, -66.12260685379772, -71.45326042764736, -5.571212855406107, -40.15566993738295, -107.67257838688028, -116.2861112306792, 0.17172629455883803, -105.01116748589328, -112.22743132272781, -27.624820894797324, -32.48523325253437, 9.065100183174279, -66.36236689145429, -14.244203302233307, -18.98674380448201, -138.6820515069792, 3.2233190187358725, -61.0859415758259, -71.41080992926244, -45.058640924133634, -16.789875224207485, -14.23142641047116, -1.3792597178850838, -5.993013480032496, -14.77301329226415, -129.5608713624811, 13.055841363520667, 8.633856348623153, 12.529677058320878, -117.32607147417023, 8.974840412183768, -34.64375234215843, -92.60596674000648, -102.72933410505584, -98.17183637916114, 2.3513601097424504, -9.546015553866125, -70.62546131717428, -110.99333686360848, -3.134668494751043, -3.1237975245941847, -69.45167337375378, -158.13221950333326, -98.22958578916484, -158.1445486304444, -97.13823826682966, -63.25853498682838, -164.03143388531035, -24.3834962467753, -85.60940537058512, -87.67343995400987, -75.33690573435955, -111.64785955728476, -82.67326871601416, 1.8438972431722793, -8.975271779689221, -84.1553892110003, -74.0934128541684, -40.30205187890553, -13.094301526397862, -62.56598112426756, -62.88145588130329, -5.50575658907233, -125.36885136248482, 11.057675391797734, -112.45436252153073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5273517027435691, "mean_inference_ms": 1.5614282780323165, "mean_action_processing_ms": 0.2539350236260792, "mean_env_wait_ms": 3.7684213233496346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011597394943237305, "StateBufferConnector_ms": 0.007583141326904297, "ViewRequirementAgentConnector_ms": 0.1849682331085205}, "num_episodes": 67, "episode_return_max": 13.913355031376266, "episode_return_min": -187.92894684661005, "episode_return_mean": -53.022066690852874, "episodes_this_iter": 67}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.30585975950044, "num_env_steps_trained_throughput_per_sec": 310.30585975950044, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 11829.811, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11829.738, "sample_time_ms": 1365.03, "learn_time_ms": 10410.953, "learn_throughput": 384.211, "synch_weights_time_ms": 52.61}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "training_iteration": 97, "trial_id": "8adec_00000", "date": "2024-07-24_15-21-26", "timestamp": 1721814686, "time_this_iter_s": 12.901533842086792, "time_total_s": 1151.9331576824188, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b95a3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1151.9331576824188, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 19.544444444444444, "ram_util_percent": 37.90555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.64074221054713, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.12193011685594683, "policy_loss": -0.007339600276221366, "vf_loss": 0.1127307870813335, "vf_explained_var": 0.9998023984332879, "kl": 0.012847661427652686, "entropy": -0.35306717126319803, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 16.19575020970523, "episode_reward_min": -219.27764009224768, "episode_reward_mean": -59.73165740020292, "episode_len_mean": 61.04, "episode_media": {}, "episodes_timesteps_total": 6104, "policy_reward_min": {"policy_0": -219.27764009224768}, "policy_reward_max": {"policy_0": 16.19575020970523}, "policy_reward_mean": {"policy_0": -59.73165740020292}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.3513601097424504, -9.546015553866125, -70.62546131717428, -110.99333686360848, -3.134668494751043, -3.1237975245941847, -69.45167337375378, -158.13221950333326, -98.22958578916484, -158.1445486304444, -97.13823826682966, -63.25853498682838, -164.03143388531035, -24.3834962467753, -85.60940537058512, -87.67343995400987, -75.33690573435955, -111.64785955728476, -82.67326871601416, 1.8438972431722793, -8.975271779689221, -84.1553892110003, -74.0934128541684, -40.30205187890553, -13.094301526397862, -62.56598112426756, -62.88145588130329, -5.50575658907233, -125.36885136248482, 11.057675391797734, -112.45436252153073, -107.64108180933016, 9.206526237834344, 2.7300716914491723, -32.66823396247592, -44.67288116059358, -80.50459183226607, -55.23683574997766, -54.12686987462631, -110.6185966124212, -108.61034731036841, -126.86297421380611, 8.46254071588154, 16.19575020970523, -60.246176311077356, 7.86799138913146, -88.90393557023168, -70.3192751650203, -15.330477316621245, -39.81662984979216, -33.59752064311655, -66.84053517951001, -53.50177232044152, -61.65805494028322, -88.64926859911655, 15.65173425091604, -74.36635419644792, -83.88688850630896, -134.29781445722017, 1.410942284680227, -14.672102951586766, -104.61928572757256, -178.77522806457714, 14.014244763897123, -8.881202899875591, -27.21545977617506, 5.5104019955278, -76.21416883125741, -153.16082215550762, -62.061746314408474, -101.58529126210543, -187.63232669984663, -219.27764009224768, -13.719613125464138, -59.557762805174384, -13.513383405404374, -163.69443672702425, -5.319391787178288, -105.67481328391797, -8.779549125951538, -10.686020742914119, -115.22200992835693, -37.16629735689014, -63.92263983144837, -31.369342017626987, -90.22865112716269, -80.38619846522528, -48.86469410326827, -70.87285013513612, 9.510650548608453, 13.797632994372101, 5.559058342094897, -3.6831788765886913, -46.659042463348364, -91.56945797369072, -22.768591200588357, -29.214431552612922, -87.36208252911709, -34.380574596199494, -74.73809017509224], "episode_lengths": [44, 42, 68, 77, 48, 46, 62, 86, 71, 86, 70, 63, 88, 50, 68, 67, 66, 73, 69, 46, 41, 68, 65, 61, 54, 64, 60, 46, 80, 35, 74, 72, 35, 35, 59, 64, 70, 63, 58, 76, 74, 78, 41, 39, 63, 44, 68, 63, 44, 55, 51, 65, 64, 67, 70, 36, 64, 68, 78, 47, 54, 73, 89, 38, 46, 53, 45, 65, 83, 59, 72, 90, 97, 52, 60, 49, 89, 48, 74, 45, 48, 78, 52, 76, 57, 69, 67, 55, 63, 44, 41, 45, 46, 64, 68, 56, 55, 68, 58, 64], "policy_policy_0_reward": [2.3513601097424504, -9.546015553866125, -70.62546131717428, -110.99333686360848, -3.134668494751043, -3.1237975245941847, -69.45167337375378, -158.13221950333326, -98.22958578916484, -158.1445486304444, -97.13823826682966, -63.25853498682838, -164.03143388531035, -24.3834962467753, -85.60940537058512, -87.67343995400987, -75.33690573435955, -111.64785955728476, -82.67326871601416, 1.8438972431722793, -8.975271779689221, -84.1553892110003, -74.0934128541684, -40.30205187890553, -13.094301526397862, -62.56598112426756, -62.88145588130329, -5.50575658907233, -125.36885136248482, 11.057675391797734, -112.45436252153073, -107.64108180933016, 9.206526237834344, 2.7300716914491723, -32.66823396247592, -44.67288116059358, -80.50459183226607, -55.23683574997766, -54.12686987462631, -110.6185966124212, -108.61034731036841, -126.86297421380611, 8.46254071588154, 16.19575020970523, -60.246176311077356, 7.86799138913146, -88.90393557023168, -70.3192751650203, -15.330477316621245, -39.81662984979216, -33.59752064311655, -66.84053517951001, -53.50177232044152, -61.65805494028322, -88.64926859911655, 15.65173425091604, -74.36635419644792, -83.88688850630896, -134.29781445722017, 1.410942284680227, -14.672102951586766, -104.61928572757256, -178.77522806457714, 14.014244763897123, -8.881202899875591, -27.21545977617506, 5.5104019955278, -76.21416883125741, -153.16082215550762, -62.061746314408474, -101.58529126210543, -187.63232669984663, -219.27764009224768, -13.719613125464138, -59.557762805174384, -13.513383405404374, -163.69443672702425, -5.319391787178288, -105.67481328391797, -8.779549125951538, -10.686020742914119, -115.22200992835693, -37.16629735689014, -63.92263983144837, -31.369342017626987, -90.22865112716269, -80.38619846522528, -48.86469410326827, -70.87285013513612, 9.510650548608453, 13.797632994372101, 5.559058342094897, -3.6831788765886913, -46.659042463348364, -91.56945797369072, -22.768591200588357, -29.214431552612922, -87.36208252911709, -34.380574596199494, -74.73809017509224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527632256369801, "mean_inference_ms": 1.56111408695127, "mean_action_processing_ms": 0.2537890644406586, "mean_env_wait_ms": 3.768257889306964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010924100875854492, "StateBufferConnector_ms": 0.0075266361236572266, "ViewRequirementAgentConnector_ms": 0.18277931213378906}, "num_episodes": 69, "episode_return_max": 16.19575020970523, "episode_return_min": -219.27764009224768, "episode_return_mean": -59.73165740020292, "episodes_this_iter": 69}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.712530530088, "num_env_steps_trained_throughput_per_sec": 305.712530530088, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 12336.713, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12336.641, "sample_time_ms": 1374.989, "learn_time_ms": 10906.583, "learn_throughput": 366.751, "synch_weights_time_ms": 53.909}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 98, "trial_id": "8adec_00000", "date": "2024-07-24_15-21-39", "timestamp": 1721814699, "time_this_iter_s": 13.095098495483398, "time_total_s": 1165.0282561779022, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8c9870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1165.0282561779022, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 18.81578947368421, "ram_util_percent": 38.015789473684215}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.236771478752296, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.1467779408757148, "policy_loss": -0.008160769478611959, "vf_loss": 0.1385327370216449, "vf_explained_var": 0.9998084045946598, "kl": 0.013299888577754852, "entropy": -0.29398357837150496, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": 20.668002555390373, "episode_reward_min": -219.27764009224768, "episode_reward_mean": -64.38672328475478, "episode_len_mean": 61.82, "episode_media": {}, "episodes_timesteps_total": 6182, "policy_reward_min": {"policy_0": -219.27764009224768}, "policy_reward_max": {"policy_0": 20.668002555390373}, "policy_reward_mean": {"policy_0": -64.38672328475478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.672102951586766, -104.61928572757256, -178.77522806457714, 14.014244763897123, -8.881202899875591, -27.21545977617506, 5.5104019955278, -76.21416883125741, -153.16082215550762, -62.061746314408474, -101.58529126210543, -187.63232669984663, -219.27764009224768, -13.719613125464138, -59.557762805174384, -13.513383405404374, -163.69443672702425, -5.319391787178288, -105.67481328391797, -8.779549125951538, -10.686020742914119, -115.22200992835693, -37.16629735689014, -63.92263983144837, -31.369342017626987, -90.22865112716269, -80.38619846522528, -48.86469410326827, -70.87285013513612, 9.510650548608453, 13.797632994372101, 5.559058342094897, -3.6831788765886913, -46.659042463348364, -91.56945797369072, -22.768591200588357, -29.214431552612922, -87.36208252911709, -34.380574596199494, -74.73809017509224, 10.855290531517614, -7.897803163376437, -136.4497410960871, -172.33983289401755, -42.89005017232383, -215.31291601467046, -9.482413703128248, -91.50892904194285, -73.41610543878996, -21.585113674717128, -18.87661377724301, -70.04428856251772, -142.46442848308996, -21.513863356554683, -115.45091554598469, -76.02025496709284, -25.761363080502214, 7.401039349464034, -157.38896786367616, -134.88474907796166, -153.73947378116867, 6.941368958135225, -84.33677522930763, -134.3566234187045, -1.4883714670330432, -13.910687507924793, -37.68089822291507, -165.45526143375517, -187.1269505382654, -45.90789009147785, -30.620745832279592, -143.8743772343729, -0.183396508865463, 7.766338397494017, 1.6949620292396272, -49.582799735163114, -84.51153171614669, 20.668002555390373, -89.16282560834311, -108.81407208017663, -14.78607063312159, -46.19795374949182, -23.828106926187864, -24.963366354705574, -70.21299960841105, -110.93568751355839, -9.430755925084194, -184.01999876574544, -37.330423821655984, -23.18416208049919, -132.45076381696717, -10.78585452982641, -138.56407987256125, -72.18261094016191, -94.40972715987921, -23.21521276641657, -114.5671965948624, -49.81122079043279, -4.354242684361434, -49.671475977170196], "episode_lengths": [54, 73, 89, 38, 46, 53, 45, 65, 83, 59, 72, 90, 97, 52, 60, 49, 89, 48, 74, 45, 48, 78, 52, 76, 57, 69, 67, 55, 63, 44, 41, 45, 46, 64, 68, 56, 55, 68, 58, 64, 35, 46, 79, 89, 56, 96, 48, 74, 69, 59, 53, 69, 81, 60, 76, 65, 50, 36, 85, 80, 84, 35, 68, 79, 43, 42, 52, 89, 91, 54, 49, 81, 38, 37, 39, 56, 66, 32, 69, 74, 54, 55, 49, 59, 63, 75, 53, 93, 62, 58, 79, 42, 85, 65, 70, 46, 75, 57, 42, 61], "policy_policy_0_reward": [-14.672102951586766, -104.61928572757256, -178.77522806457714, 14.014244763897123, -8.881202899875591, -27.21545977617506, 5.5104019955278, -76.21416883125741, -153.16082215550762, -62.061746314408474, -101.58529126210543, -187.63232669984663, -219.27764009224768, -13.719613125464138, -59.557762805174384, -13.513383405404374, -163.69443672702425, -5.319391787178288, -105.67481328391797, -8.779549125951538, -10.686020742914119, -115.22200992835693, -37.16629735689014, -63.92263983144837, -31.369342017626987, -90.22865112716269, -80.38619846522528, -48.86469410326827, -70.87285013513612, 9.510650548608453, 13.797632994372101, 5.559058342094897, -3.6831788765886913, -46.659042463348364, -91.56945797369072, -22.768591200588357, -29.214431552612922, -87.36208252911709, -34.380574596199494, -74.73809017509224, 10.855290531517614, -7.897803163376437, -136.4497410960871, -172.33983289401755, -42.89005017232383, -215.31291601467046, -9.482413703128248, -91.50892904194285, -73.41610543878996, -21.585113674717128, -18.87661377724301, -70.04428856251772, -142.46442848308996, -21.513863356554683, -115.45091554598469, -76.02025496709284, -25.761363080502214, 7.401039349464034, -157.38896786367616, -134.88474907796166, -153.73947378116867, 6.941368958135225, -84.33677522930763, -134.3566234187045, -1.4883714670330432, -13.910687507924793, -37.68089822291507, -165.45526143375517, -187.1269505382654, -45.90789009147785, -30.620745832279592, -143.8743772343729, -0.183396508865463, 7.766338397494017, 1.6949620292396272, -49.582799735163114, -84.51153171614669, 20.668002555390373, -89.16282560834311, -108.81407208017663, -14.78607063312159, -46.19795374949182, -23.828106926187864, -24.963366354705574, -70.21299960841105, -110.93568751355839, -9.430755925084194, -184.01999876574544, -37.330423821655984, -23.18416208049919, -132.45076381696717, -10.78585452982641, -138.56407987256125, -72.18261094016191, -94.40972715987921, -23.21521276641657, -114.5671965948624, -49.81122079043279, -4.354242684361434, -49.671475977170196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5273476540345897, "mean_inference_ms": 1.5605484549437287, "mean_action_processing_ms": 0.25361585856316, "mean_env_wait_ms": 3.765567512929804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011055231094360352, "StateBufferConnector_ms": 0.007355451583862305, "ViewRequirementAgentConnector_ms": 0.18029117584228516}, "num_episodes": 60, "episode_return_max": 20.668002555390373, "episode_return_min": -219.27764009224768, "episode_return_mean": -64.38672328475478, "episodes_this_iter": 60}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.8243015811027, "num_env_steps_trained_throughput_per_sec": 313.8243015811027, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 12724.921, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12724.848, "sample_time_ms": 1360.774, "learn_time_ms": 11308.397, "learn_throughput": 353.719, "synch_weights_time_ms": 54.514}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 99, "trial_id": "8adec_00000", "date": "2024-07-24_15-21-52", "timestamp": 1721814712, "time_this_iter_s": 12.757700204849243, "time_total_s": 1177.7859563827515, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b9593f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1177.7859563827515, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 20.56111111111111, "ram_util_percent": 37.92777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.56555595745643, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.12467665187286911, "policy_loss": -0.006237839499954134, "vf_loss": 0.11375631743188326, "vf_explained_var": 0.9997898318494359, "kl": 0.013308723045793159, "entropy": -0.36830904591285313, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 20.668002555390373, "episode_reward_min": -212.3012887459213, "episode_reward_mean": -65.74530329528358, "episode_len_mean": 61.98, "episode_media": {}, "episodes_timesteps_total": 6198, "policy_reward_min": {"policy_0": -212.3012887459213}, "policy_reward_max": {"policy_0": 20.668002555390373}, "policy_reward_mean": {"policy_0": -65.74530329528358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.68089822291507, -165.45526143375517, -187.1269505382654, -45.90789009147785, -30.620745832279592, -143.8743772343729, -0.183396508865463, 7.766338397494017, 1.6949620292396272, -49.582799735163114, -84.51153171614669, 20.668002555390373, -89.16282560834311, -108.81407208017663, -14.78607063312159, -46.19795374949182, -23.828106926187864, -24.963366354705574, -70.21299960841105, -110.93568751355839, -9.430755925084194, -184.01999876574544, -37.330423821655984, -23.18416208049919, -132.45076381696717, -10.78585452982641, -138.56407987256125, -72.18261094016191, -94.40972715987921, -23.21521276641657, -114.5671965948624, -49.81122079043279, -4.354242684361434, -49.671475977170196, -204.53363120459505, -0.7938408773830032, 7.283153461433518, -174.73901178432183, 7.592291704496665, -101.6475735463735, -192.4548294038168, -15.916930317465258, -50.903358111143746, -4.576974256286992, 13.440186818541399, -101.72844283129335, -12.197671197354426, -54.2341642773788, -107.48807665686383, -129.60995012522866, -109.109801467216, -164.36722674479552, -137.66261615719753, -14.055040750234937, 10.552289154488456, -188.7104319635273, -26.963122211291953, 4.533547118713656, 15.769856390957374, -44.15428502496958, -73.83269894963986, -26.949686439135675, -35.16959757500655, -74.09150597586485, -102.09921980473226, -156.76631390878865, -19.21576424215141, -45.157850137186436, -109.20987596223631, -55.5814412106496, -42.04641429310431, -28.88801090522089, -20.452687306200676, 10.58628578893757, 9.326041491640005, -62.58798103525224, -212.3012887459213, -11.201256895285656, -70.99446781309777, -125.88694517487286, -17.17867546094134, -47.46045474173256, -83.89382704906423, -22.275543195184206, 16.812415935176606, -76.68371873030321, 4.179337928305145, 2.256900885601567, -57.765563205284195, -164.46302941836592, -101.46782284987403, -159.2817694045082, -25.294933625904775, -76.18360257760027, -78.0206423637091, -79.51762807107806, -83.53050233530006, -96.22214995675341, -116.61867388638893, -135.03075752083507], "episode_lengths": [52, 89, 91, 54, 49, 81, 38, 37, 39, 56, 66, 32, 69, 74, 54, 55, 49, 59, 63, 75, 53, 93, 62, 58, 79, 42, 85, 65, 70, 46, 75, 57, 42, 61, 94, 37, 45, 90, 38, 76, 94, 56, 61, 52, 31, 72, 52, 59, 74, 81, 74, 88, 79, 47, 37, 94, 53, 36, 38, 61, 64, 58, 52, 63, 75, 85, 51, 54, 75, 66, 55, 59, 53, 43, 33, 60, 96, 53, 67, 77, 46, 56, 69, 46, 35, 70, 46, 38, 58, 86, 71, 85, 57, 66, 75, 67, 70, 72, 75, 82], "policy_policy_0_reward": [-37.68089822291507, -165.45526143375517, -187.1269505382654, -45.90789009147785, -30.620745832279592, -143.8743772343729, -0.183396508865463, 7.766338397494017, 1.6949620292396272, -49.582799735163114, -84.51153171614669, 20.668002555390373, -89.16282560834311, -108.81407208017663, -14.78607063312159, -46.19795374949182, -23.828106926187864, -24.963366354705574, -70.21299960841105, -110.93568751355839, -9.430755925084194, -184.01999876574544, -37.330423821655984, -23.18416208049919, -132.45076381696717, -10.78585452982641, -138.56407987256125, -72.18261094016191, -94.40972715987921, -23.21521276641657, -114.5671965948624, -49.81122079043279, -4.354242684361434, -49.671475977170196, -204.53363120459505, -0.7938408773830032, 7.283153461433518, -174.73901178432183, 7.592291704496665, -101.6475735463735, -192.4548294038168, -15.916930317465258, -50.903358111143746, -4.576974256286992, 13.440186818541399, -101.72844283129335, -12.197671197354426, -54.2341642773788, -107.48807665686383, -129.60995012522866, -109.109801467216, -164.36722674479552, -137.66261615719753, -14.055040750234937, 10.552289154488456, -188.7104319635273, -26.963122211291953, 4.533547118713656, 15.769856390957374, -44.15428502496958, -73.83269894963986, -26.949686439135675, -35.16959757500655, -74.09150597586485, -102.09921980473226, -156.76631390878865, -19.21576424215141, -45.157850137186436, -109.20987596223631, -55.5814412106496, -42.04641429310431, -28.88801090522089, -20.452687306200676, 10.58628578893757, 9.326041491640005, -62.58798103525224, -212.3012887459213, -11.201256895285656, -70.99446781309777, -125.88694517487286, -17.17867546094134, -47.46045474173256, -83.89382704906423, -22.275543195184206, 16.812415935176606, -76.68371873030321, 4.179337928305145, 2.256900885601567, -57.765563205284195, -164.46302941836592, -101.46782284987403, -159.2817694045082, -25.294933625904775, -76.18360257760027, -78.0206423637091, -79.51762807107806, -83.53050233530006, -96.22214995675341, -116.61867388638893, -135.03075752083507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271937180935735, "mean_inference_ms": 1.5602165163625037, "mean_action_processing_ms": 0.253594496436034, "mean_env_wait_ms": 3.768775979049098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011409997940063477, "StateBufferConnector_ms": 0.0075037479400634766, "ViewRequirementAgentConnector_ms": 0.18392443656921387}, "num_episodes": 66, "episode_return_max": 20.668002555390373, "episode_return_min": -212.3012887459213, "episode_return_mean": -65.74530329528358, "episodes_this_iter": 66}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.2678738008595, "num_env_steps_trained_throughput_per_sec": 306.2678738008595, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 12741.164, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12741.094, "sample_time_ms": 1360.895, "learn_time_ms": 11324.169, "learn_throughput": 353.227, "synch_weights_time_ms": 54.888}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 100, "trial_id": "8adec_00000", "date": "2024-07-24_15-22-05", "timestamp": 1721814725, "time_this_iter_s": 13.073243856430054, "time_total_s": 1190.8592002391815, "pid": 1453290, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x797e6b8cac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-0.61, 0.61, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1190.8592002391815, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 20.58888888888889, "ram_util_percent": 37.83888888888888}}
