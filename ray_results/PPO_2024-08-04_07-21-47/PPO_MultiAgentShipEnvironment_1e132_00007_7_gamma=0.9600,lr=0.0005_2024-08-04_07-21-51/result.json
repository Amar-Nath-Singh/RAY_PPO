{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9468006217852235, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.543613851070404, "policy_loss": -0.005302638425200712, "vf_loss": 9.547769963741302, "vf_explained_var": 0.03214160067339738, "kl": 0.006446245321080823, "entropy": 1.4269262644151846, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -12.369849607785778, "episode_reward_min": -1306.641898763942, "episode_reward_mean": -649.5528566579252, "episode_len_mean": 113.92592592592592, "episode_media": {}, "episodes_timesteps_total": 3076, "policy_reward_min": {"policy_0": -1306.641898763942}, "policy_reward_max": {"policy_0": -12.369849607785778}, "policy_reward_mean": {"policy_0": -649.5528566579252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.369849607785778, -599.1090734834614, -859.6498333262966, -306.34009668097605, -141.9125421721364, -230.5739234233964, -1109.2612298987087, -319.90475233390487, -250.70042392222848, -123.05151077968752, -1304.7288703613694, -1086.284960804862, -1045.1885492568865, -24.36357442598024, -1009.8025356551284, -1027.4549728019051, -636.5837611627704, -1205.9780436589867, -995.9999906554376, -197.87528008983736, -892.2334565053873, -919.1551924393035, -1306.641898763942, -512.7069424712204, -126.14912844755054, -224.4625802684374, -1069.4441563663947], "episode_lengths": [35, 110, 150, 93, 83, 66, 150, 82, 83, 81, 150, 150, 150, 44, 150, 150, 150, 150, 150, 67, 150, 150, 150, 110, 54, 68, 150], "policy_policy_0_reward": [-12.369849607785778, -599.1090734834614, -859.6498333262966, -306.34009668097605, -141.9125421721364, -230.5739234233964, -1109.2612298987087, -319.90475233390487, -250.70042392222848, -123.05151077968752, -1304.7288703613694, -1086.284960804862, -1045.1885492568865, -24.36357442598024, -1009.8025356551284, -1027.4549728019051, -636.5837611627704, -1205.9780436589867, -995.9999906554376, -197.87528008983736, -892.2334565053873, -919.1551924393035, -1306.641898763942, -512.7069424712204, -126.14912844755054, -224.4625802684374, -1069.4441563663947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.571323666035792, "mean_inference_ms": 1.7046874060883386, "mean_action_processing_ms": 0.27947015413756293, "mean_env_wait_ms": 3.461771021792324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011348724365234375, "StateBufferConnector_ms": 0.008083272863317418, "ViewRequirementAgentConnector_ms": 0.19597300776728876}, "num_episodes": 27, "episode_return_max": -12.369849607785778, "episode_return_min": -1306.641898763942, "episode_return_mean": -649.5528566579252, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.2010635145919, "num_env_steps_trained_throughput_per_sec": 313.2010635145919, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12771.359, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12771.294, "sample_time_ms": 1225.163, "learn_time_ms": 11469.037, "learn_throughput": 348.765, "synch_weights_time_ms": 75.924}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1e132_00007", "date": "2024-08-04_08-38-34", "timestamp": 1722740914, "time_this_iter_s": 12.783147096633911, "time_total_s": 12.783147096633911, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575f130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.783147096633911, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.310526315789474, "ram_util_percent": 28.189473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.630689282529056, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.467097281416256, "policy_loss": -0.008095696209541833, "vf_loss": 9.473274328311284, "vf_explained_var": 0.12951518589009842, "kl": 0.010304780349209373, "entropy": 1.4227809603015582, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -12.369849607785778, "episode_reward_min": -1375.2272756958691, "episode_reward_mean": -720.2013249978664, "episode_len_mean": 123.37735849056604, "episode_media": {}, "episodes_timesteps_total": 6539, "policy_reward_min": {"policy_0": -1375.2272756958691}, "policy_reward_max": {"policy_0": -12.369849607785778}, "policy_reward_mean": {"policy_0": -720.2013249978664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.369849607785778, -599.1090734834614, -859.6498333262966, -306.34009668097605, -141.9125421721364, -230.5739234233964, -1109.2612298987087, -319.90475233390487, -250.70042392222848, -123.05151077968752, -1304.7288703613694, -1086.284960804862, -1045.1885492568865, -24.36357442598024, -1009.8025356551284, -1027.4549728019051, -636.5837611627704, -1205.9780436589867, -995.9999906554376, -197.87528008983736, -892.2334565053873, -919.1551924393035, -1306.641898763942, -512.7069424712204, -126.14912844755054, -224.4625802684374, -1069.4441563663947, -1101.8053046105708, -863.8387195571762, -811.8222565449588, -702.5998804884687, -82.88811194861088, -1174.2815412022312, -1153.3554303360313, -1074.166931295743, -737.5273375907715, -1215.868950904207, -1004.794621468318, -1121.5736281534814, -86.92157587807472, -885.544054453811, -895.5910062871521, -1375.2272756958691, -864.8408449253474, -669.8119009812023, -879.5491448097051, -44.56436812936961, -488.93412349881123, -987.570715702631, -797.6173639033716, -321.4647710417507, -288.82035411504086, -1001.7628816002277], "episode_lengths": [35, 110, 150, 93, 83, 66, 150, 82, 83, 81, 150, 150, 150, 44, 150, 150, 150, 150, 150, 67, 150, 150, 150, 110, 54, 68, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 47, 131, 150, 150, 87, 78, 150], "policy_policy_0_reward": [-12.369849607785778, -599.1090734834614, -859.6498333262966, -306.34009668097605, -141.9125421721364, -230.5739234233964, -1109.2612298987087, -319.90475233390487, -250.70042392222848, -123.05151077968752, -1304.7288703613694, -1086.284960804862, -1045.1885492568865, -24.36357442598024, -1009.8025356551284, -1027.4549728019051, -636.5837611627704, -1205.9780436589867, -995.9999906554376, -197.87528008983736, -892.2334565053873, -919.1551924393035, -1306.641898763942, -512.7069424712204, -126.14912844755054, -224.4625802684374, -1069.4441563663947, -1101.8053046105708, -863.8387195571762, -811.8222565449588, -702.5998804884687, -82.88811194861088, -1174.2815412022312, -1153.3554303360313, -1074.166931295743, -737.5273375907715, -1215.868950904207, -1004.794621468318, -1121.5736281534814, -86.92157587807472, -885.544054453811, -895.5910062871521, -1375.2272756958691, -864.8408449253474, -669.8119009812023, -879.5491448097051, -44.56436812936961, -488.93412349881123, -987.570715702631, -797.6173639033716, -321.4647710417507, -288.82035411504086, -1001.7628816002277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5681182815678024, "mean_inference_ms": 1.6991642826648103, "mean_action_processing_ms": 0.2796136403472327, "mean_env_wait_ms": 3.46104504240532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013446807861328125, "StateBufferConnector_ms": 0.008379288439480763, "ViewRequirementAgentConnector_ms": 0.19148340765035377}, "num_episodes": 26, "episode_return_max": -12.369849607785778, "episode_return_min": -1375.2272756958691, "episode_return_mean": -720.2013249978664, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.1380411695416, "num_env_steps_trained_throughput_per_sec": 310.1380411695416, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12834.428, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12834.353, "sample_time_ms": 1169.39, "learn_time_ms": 11593.178, "learn_throughput": 345.03, "synch_weights_time_ms": 70.804}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1e132_00007", "date": "2024-08-04_08-38-47", "timestamp": 1722740927, "time_this_iter_s": 12.910056591033936, "time_total_s": 25.693203687667847, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447af010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.693203687667847, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.194444444444443, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0672395119753975, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.515530175964038, "policy_loss": -0.01224240001271634, "vf_loss": 9.525495551029842, "vf_explained_var": 0.12076341801633438, "kl": 0.012106912282221554, "entropy": 1.4434564538300036, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -12.369849607785778, "episode_reward_min": -1375.2272756958691, "episode_reward_mean": -708.5037769061436, "episode_len_mean": 125.17647058823529, "episode_media": {}, "episodes_timesteps_total": 10640, "policy_reward_min": {"policy_0": -1375.2272756958691}, "policy_reward_max": {"policy_0": -12.369849607785778}, "policy_reward_mean": {"policy_0": -708.5037769061436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.369849607785778, -599.1090734834614, -859.6498333262966, -306.34009668097605, -141.9125421721364, -230.5739234233964, -1109.2612298987087, -319.90475233390487, -250.70042392222848, -123.05151077968752, -1304.7288703613694, -1086.284960804862, -1045.1885492568865, -24.36357442598024, -1009.8025356551284, -1027.4549728019051, -636.5837611627704, -1205.9780436589867, -995.9999906554376, -197.87528008983736, -892.2334565053873, -919.1551924393035, -1306.641898763942, -512.7069424712204, -126.14912844755054, -224.4625802684374, -1069.4441563663947, -1101.8053046105708, -863.8387195571762, -811.8222565449588, -702.5998804884687, -82.88811194861088, -1174.2815412022312, -1153.3554303360313, -1074.166931295743, -737.5273375907715, -1215.868950904207, -1004.794621468318, -1121.5736281534814, -86.92157587807472, -885.544054453811, -895.5910062871521, -1375.2272756958691, -864.8408449253474, -669.8119009812023, -879.5491448097051, -44.56436812936961, -488.93412349881123, -987.570715702631, -797.6173639033716, -321.4647710417507, -288.82035411504086, -1001.7628816002277, -1115.2924714312287, -644.3874825283265, -652.0452638543982, -571.9480736157752, -1002.2685880527599, -473.6277499773791, -801.023861043184, -891.6539324800406, -1074.1543712649964, -1026.1985890821327, -123.74424270290362, -252.50913461659346, -407.48572847855434, -831.3455726137113, -1148.5557493715614, -1085.2950278483147, -1111.155849320731, -194.06710321253308, -420.07251292243376, -880.4339848265563, -1101.2457142346966, -236.06833042371758, -196.06805430587022, -1002.7256787795086, -332.3390588856378, -481.2483697969073, -479.2298939091482, -472.8631728351763, -182.81131888865153, -1255.3095870419295, -1219.8461106612094, -385.130233128719], "episode_lengths": [35, 110, 150, 93, 83, 66, 150, 82, 83, 81, 150, 150, 150, 44, 150, 150, 150, 150, 150, 67, 150, 150, 150, 110, 54, 68, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 47, 131, 150, 150, 87, 78, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 53, 101, 91, 150, 150, 150, 150, 72, 107, 150, 150, 85, 84, 150, 89, 117, 113, 150, 93, 150, 150, 122], "policy_policy_0_reward": [-12.369849607785778, -599.1090734834614, -859.6498333262966, -306.34009668097605, -141.9125421721364, -230.5739234233964, -1109.2612298987087, -319.90475233390487, -250.70042392222848, -123.05151077968752, -1304.7288703613694, -1086.284960804862, -1045.1885492568865, -24.36357442598024, -1009.8025356551284, -1027.4549728019051, -636.5837611627704, -1205.9780436589867, -995.9999906554376, -197.87528008983736, -892.2334565053873, -919.1551924393035, -1306.641898763942, -512.7069424712204, -126.14912844755054, -224.4625802684374, -1069.4441563663947, -1101.8053046105708, -863.8387195571762, -811.8222565449588, -702.5998804884687, -82.88811194861088, -1174.2815412022312, -1153.3554303360313, -1074.166931295743, -737.5273375907715, -1215.868950904207, -1004.794621468318, -1121.5736281534814, -86.92157587807472, -885.544054453811, -895.5910062871521, -1375.2272756958691, -864.8408449253474, -669.8119009812023, -879.5491448097051, -44.56436812936961, -488.93412349881123, -987.570715702631, -797.6173639033716, -321.4647710417507, -288.82035411504086, -1001.7628816002277, -1115.2924714312287, -644.3874825283265, -652.0452638543982, -571.9480736157752, -1002.2685880527599, -473.6277499773791, -801.023861043184, -891.6539324800406, -1074.1543712649964, -1026.1985890821327, -123.74424270290362, -252.50913461659346, -407.48572847855434, -831.3455726137113, -1148.5557493715614, -1085.2950278483147, -1111.155849320731, -194.06710321253308, -420.07251292243376, -880.4339848265563, -1101.2457142346966, -236.06833042371758, -196.06805430587022, -1002.7256787795086, -332.3390588856378, -481.2483697969073, -479.2298939091482, -472.8631728351763, -182.81131888865153, -1255.3095870419295, -1219.8461106612094, -385.130233128719]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5669233722403354, "mean_inference_ms": 1.695316063796873, "mean_action_processing_ms": 0.27993976086167105, "mean_env_wait_ms": 3.4605792240293676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013484393849092372, "StateBufferConnector_ms": 0.008588678696576287, "ViewRequirementAgentConnector_ms": 0.19814799813663259}, "num_episodes": 32, "episode_return_max": -12.369849607785778, "episode_return_min": -1375.2272756958691, "episode_return_mean": -708.5037769061436, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.6574808633882, "num_env_steps_trained_throughput_per_sec": 310.6574808633882, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12848.262, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12848.189, "sample_time_ms": 1154.583, "learn_time_ms": 11623.525, "learn_throughput": 344.13, "synch_weights_time_ms": 69.154}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1e132_00007", "date": "2024-08-04_08-39-00", "timestamp": 1722740940, "time_this_iter_s": 12.887571334838867, "time_total_s": 38.580775022506714, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a65f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.580775022506714, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.116666666666667, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.92943684005489, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.311111321051916, "policy_loss": -0.012890266629013544, "vf_loss": 9.321839632590612, "vf_explained_var": 0.260989034983019, "kl": 0.011522457655913362, "entropy": 1.4255986439685027, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -42.06374772223042, "episode_reward_min": -1375.2272756958691, "episode_reward_mean": -698.5726486370486, "episode_len_mean": 123.69, "episode_media": {}, "episodes_timesteps_total": 12369, "policy_reward_min": {"policy_0": -1375.2272756958691}, "policy_reward_max": {"policy_0": -42.06374772223042}, "policy_reward_mean": {"policy_0": -698.5726486370486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-197.87528008983736, -892.2334565053873, -919.1551924393035, -1306.641898763942, -512.7069424712204, -126.14912844755054, -224.4625802684374, -1069.4441563663947, -1101.8053046105708, -863.8387195571762, -811.8222565449588, -702.5998804884687, -82.88811194861088, -1174.2815412022312, -1153.3554303360313, -1074.166931295743, -737.5273375907715, -1215.868950904207, -1004.794621468318, -1121.5736281534814, -86.92157587807472, -885.544054453811, -895.5910062871521, -1375.2272756958691, -864.8408449253474, -669.8119009812023, -879.5491448097051, -44.56436812936961, -488.93412349881123, -987.570715702631, -797.6173639033716, -321.4647710417507, -288.82035411504086, -1001.7628816002277, -1115.2924714312287, -644.3874825283265, -652.0452638543982, -571.9480736157752, -1002.2685880527599, -473.6277499773791, -801.023861043184, -891.6539324800406, -1074.1543712649964, -1026.1985890821327, -123.74424270290362, -252.50913461659346, -407.48572847855434, -831.3455726137113, -1148.5557493715614, -1085.2950278483147, -1111.155849320731, -194.06710321253308, -420.07251292243376, -880.4339848265563, -1101.2457142346966, -236.06833042371758, -196.06805430587022, -1002.7256787795086, -332.3390588856378, -481.2483697969073, -479.2298939091482, -472.8631728351763, -182.81131888865153, -1255.3095870419295, -1219.8461106612094, -385.130233128719, -1169.8662161989364, -246.81297706453813, -1115.5458324284016, -81.86710938026445, -1113.8857783305746, -974.6364886326497, -265.23658644892083, -87.19568433394798, -960.1153004484022, -735.9245110365589, -245.42616009022754, -1330.9892235636112, -294.08126971813425, -1136.0662369943807, -818.4837596660776, -912.9863794898806, -359.12391367213166, -292.65158096249405, -42.06374772223042, -1358.1248152633002, -950.4338362647376, -134.32754223403867, -943.4389958618835, -716.4337381919834, -660.3683306119531, -132.0252339785013, -1075.117819855843, -129.94179786907893, -966.7979925267738, -966.718443361468, -902.4393709753781, -151.00600626151663, -480.7437119160603, -172.82592973967715], "episode_lengths": [67, 150, 150, 150, 110, 54, 68, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 47, 131, 150, 150, 87, 78, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 53, 101, 91, 150, 150, 150, 150, 72, 107, 150, 150, 85, 84, 150, 89, 117, 113, 150, 93, 150, 150, 122, 150, 72, 150, 49, 150, 150, 108, 49, 150, 141, 98, 150, 101, 150, 147, 150, 82, 75, 44, 150, 150, 59, 150, 150, 124, 50, 150, 49, 150, 150, 150, 75, 102, 81], "policy_policy_0_reward": [-197.87528008983736, -892.2334565053873, -919.1551924393035, -1306.641898763942, -512.7069424712204, -126.14912844755054, -224.4625802684374, -1069.4441563663947, -1101.8053046105708, -863.8387195571762, -811.8222565449588, -702.5998804884687, -82.88811194861088, -1174.2815412022312, -1153.3554303360313, -1074.166931295743, -737.5273375907715, -1215.868950904207, -1004.794621468318, -1121.5736281534814, -86.92157587807472, -885.544054453811, -895.5910062871521, -1375.2272756958691, -864.8408449253474, -669.8119009812023, -879.5491448097051, -44.56436812936961, -488.93412349881123, -987.570715702631, -797.6173639033716, -321.4647710417507, -288.82035411504086, -1001.7628816002277, -1115.2924714312287, -644.3874825283265, -652.0452638543982, -571.9480736157752, -1002.2685880527599, -473.6277499773791, -801.023861043184, -891.6539324800406, -1074.1543712649964, -1026.1985890821327, -123.74424270290362, -252.50913461659346, -407.48572847855434, -831.3455726137113, -1148.5557493715614, -1085.2950278483147, -1111.155849320731, -194.06710321253308, -420.07251292243376, -880.4339848265563, -1101.2457142346966, -236.06833042371758, -196.06805430587022, -1002.7256787795086, -332.3390588856378, -481.2483697969073, -479.2298939091482, -472.8631728351763, -182.81131888865153, -1255.3095870419295, -1219.8461106612094, -385.130233128719, -1169.8662161989364, -246.81297706453813, -1115.5458324284016, -81.86710938026445, -1113.8857783305746, -974.6364886326497, -265.23658644892083, -87.19568433394798, -960.1153004484022, -735.9245110365589, -245.42616009022754, -1330.9892235636112, -294.08126971813425, -1136.0662369943807, -818.4837596660776, -912.9863794898806, -359.12391367213166, -292.65158096249405, -42.06374772223042, -1358.1248152633002, -950.4338362647376, -134.32754223403867, -943.4389958618835, -716.4337381919834, -660.3683306119531, -132.0252339785013, -1075.117819855843, -129.94179786907893, -966.7979925267738, -966.718443361468, -902.4393709753781, -151.00600626151663, -480.7437119160603, -172.82592973967715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5654376557548724, "mean_inference_ms": 1.6892344333502245, "mean_action_processing_ms": 0.28058276876996063, "mean_env_wait_ms": 3.4579808868099007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022093534469604492, "StateBufferConnector_ms": 0.00872802734375, "ViewRequirementAgentConnector_ms": 0.19887590408325195}, "num_episodes": 34, "episode_return_max": -42.06374772223042, "episode_return_min": -1375.2272756958691, "episode_return_mean": -698.5726486370486, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.15889229966905, "num_env_steps_trained_throughput_per_sec": 305.15889229966905, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12913.18, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12913.111, "sample_time_ms": 1171.165, "learn_time_ms": 11669.943, "learn_throughput": 342.761, "synch_weights_time_ms": 71.091}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1e132_00007", "date": "2024-08-04_08-39-13", "timestamp": 1722740953, "time_this_iter_s": 13.120857000350952, "time_total_s": 51.701632022857666, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.701632022857666, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.778947368421054, "ram_util_percent": 28.289473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.2694927030553425, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.270631362994513, "policy_loss": -0.01183496622252278, "vf_loss": 9.27993856370449, "vf_explained_var": 0.3325730537374814, "kl": 0.013379334539361788, "entropy": 1.4810902692377568, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -13.55800419932001, "episode_reward_min": -1374.3650409592133, "episode_reward_mean": -685.6693857838774, "episode_len_mean": 123.18, "episode_media": {}, "episodes_timesteps_total": 12318, "policy_reward_min": {"policy_0": -1374.3650409592133}, "policy_reward_max": {"policy_0": -13.55800419932001}, "policy_reward_mean": {"policy_0": -685.6693857838774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-987.570715702631, -797.6173639033716, -321.4647710417507, -288.82035411504086, -1001.7628816002277, -1115.2924714312287, -644.3874825283265, -652.0452638543982, -571.9480736157752, -1002.2685880527599, -473.6277499773791, -801.023861043184, -891.6539324800406, -1074.1543712649964, -1026.1985890821327, -123.74424270290362, -252.50913461659346, -407.48572847855434, -831.3455726137113, -1148.5557493715614, -1085.2950278483147, -1111.155849320731, -194.06710321253308, -420.07251292243376, -880.4339848265563, -1101.2457142346966, -236.06833042371758, -196.06805430587022, -1002.7256787795086, -332.3390588856378, -481.2483697969073, -479.2298939091482, -472.8631728351763, -182.81131888865153, -1255.3095870419295, -1219.8461106612094, -385.130233128719, -1169.8662161989364, -246.81297706453813, -1115.5458324284016, -81.86710938026445, -1113.8857783305746, -974.6364886326497, -265.23658644892083, -87.19568433394798, -960.1153004484022, -735.9245110365589, -245.42616009022754, -1330.9892235636112, -294.08126971813425, -1136.0662369943807, -818.4837596660776, -912.9863794898806, -359.12391367213166, -292.65158096249405, -42.06374772223042, -1358.1248152633002, -950.4338362647376, -134.32754223403867, -943.4389958618835, -716.4337381919834, -660.3683306119531, -132.0252339785013, -1075.117819855843, -129.94179786907893, -966.7979925267738, -966.718443361468, -902.4393709753781, -151.00600626151663, -480.7437119160603, -172.82592973967715, -1216.355540905834, -224.0975947127496, -257.65458205356543, -282.03205602127855, -1024.9642824823727, -405.43193602393575, -772.7862140474076, -186.81307035017358, -261.4031681783409, -1085.4033431889177, -249.87425582860786, -307.5690083442244, -13.55800419932001, -1006.9620953080715, -1374.3650409592133, -685.4129936034868, -341.1802112238672, -1079.2840831048004, -854.4738167980775, -1028.0718154534338, -1231.259577712161, -1046.6965367451812, -461.3630628143601, -1008.7654538930159, -1218.4424441374297, -461.64633047978367, -953.1842600961546, -1003.2117397972828, -1151.5868403318304], "episode_lengths": [150, 150, 87, 78, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 53, 101, 91, 150, 150, 150, 150, 72, 107, 150, 150, 85, 84, 150, 89, 117, 113, 150, 93, 150, 150, 122, 150, 72, 150, 49, 150, 150, 108, 49, 150, 141, 98, 150, 101, 150, 147, 150, 82, 75, 44, 150, 150, 59, 150, 150, 124, 50, 150, 49, 150, 150, 150, 75, 102, 81, 150, 88, 83, 77, 150, 105, 150, 68, 88, 150, 100, 150, 41, 150, 150, 150, 85, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-987.570715702631, -797.6173639033716, -321.4647710417507, -288.82035411504086, -1001.7628816002277, -1115.2924714312287, -644.3874825283265, -652.0452638543982, -571.9480736157752, -1002.2685880527599, -473.6277499773791, -801.023861043184, -891.6539324800406, -1074.1543712649964, -1026.1985890821327, -123.74424270290362, -252.50913461659346, -407.48572847855434, -831.3455726137113, -1148.5557493715614, -1085.2950278483147, -1111.155849320731, -194.06710321253308, -420.07251292243376, -880.4339848265563, -1101.2457142346966, -236.06833042371758, -196.06805430587022, -1002.7256787795086, -332.3390588856378, -481.2483697969073, -479.2298939091482, -472.8631728351763, -182.81131888865153, -1255.3095870419295, -1219.8461106612094, -385.130233128719, -1169.8662161989364, -246.81297706453813, -1115.5458324284016, -81.86710938026445, -1113.8857783305746, -974.6364886326497, -265.23658644892083, -87.19568433394798, -960.1153004484022, -735.9245110365589, -245.42616009022754, -1330.9892235636112, -294.08126971813425, -1136.0662369943807, -818.4837596660776, -912.9863794898806, -359.12391367213166, -292.65158096249405, -42.06374772223042, -1358.1248152633002, -950.4338362647376, -134.32754223403867, -943.4389958618835, -716.4337381919834, -660.3683306119531, -132.0252339785013, -1075.117819855843, -129.94179786907893, -966.7979925267738, -966.718443361468, -902.4393709753781, -151.00600626151663, -480.7437119160603, -172.82592973967715, -1216.355540905834, -224.0975947127496, -257.65458205356543, -282.03205602127855, -1024.9642824823727, -405.43193602393575, -772.7862140474076, -186.81307035017358, -261.4031681783409, -1085.4033431889177, -249.87425582860786, -307.5690083442244, -13.55800419932001, -1006.9620953080715, -1374.3650409592133, -685.4129936034868, -341.1802112238672, -1079.2840831048004, -854.4738167980775, -1028.0718154534338, -1231.259577712161, -1046.6965367451812, -461.3630628143601, -1008.7654538930159, -1218.4424441374297, -461.64633047978367, -953.1842600961546, -1003.2117397972828, -1151.5868403318304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5641455223364787, "mean_inference_ms": 1.6886827015594505, "mean_action_processing_ms": 0.28059526282569003, "mean_env_wait_ms": 3.4570114117456585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021640777587890625, "StateBufferConnector_ms": 0.00875544548034668, "ViewRequirementAgentConnector_ms": 0.1997208595275879}, "num_episodes": 29, "episode_return_max": -13.55800419932001, "episode_return_min": -1374.3650409592133, "episode_return_mean": -685.6693857838774, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.02394588355446, "num_env_steps_trained_throughput_per_sec": 320.02394588355446, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12830.36, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12830.285, "sample_time_ms": 1158.13, "learn_time_ms": 11600.578, "learn_throughput": 344.81, "synch_weights_time_ms": 70.696}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1e132_00007", "date": "2024-08-04_08-39-26", "timestamp": 1722740966, "time_this_iter_s": 12.51075029373169, "time_total_s": 64.21238231658936, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a75b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.21238231658936, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.21666666666666, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.967556819257637, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.20857648551464, "policy_loss": -0.009922078470117413, "vf_loss": 9.215868150691191, "vf_explained_var": 0.3463115479176243, "kl": 0.01386786751988136, "entropy": 1.4315575095514457, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -13.55800419932001, "episode_reward_min": -1374.3650409592133, "episode_reward_mean": -732.4082832411544, "episode_len_mean": 125.34, "episode_media": {}, "episodes_timesteps_total": 12534, "policy_reward_min": {"policy_0": -1374.3650409592133}, "policy_reward_max": {"policy_0": -13.55800419932001}, "policy_reward_mean": {"policy_0": -732.4082832411544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-472.8631728351763, -182.81131888865153, -1255.3095870419295, -1219.8461106612094, -385.130233128719, -1169.8662161989364, -246.81297706453813, -1115.5458324284016, -81.86710938026445, -1113.8857783305746, -974.6364886326497, -265.23658644892083, -87.19568433394798, -960.1153004484022, -735.9245110365589, -245.42616009022754, -1330.9892235636112, -294.08126971813425, -1136.0662369943807, -818.4837596660776, -912.9863794898806, -359.12391367213166, -292.65158096249405, -42.06374772223042, -1358.1248152633002, -950.4338362647376, -134.32754223403867, -943.4389958618835, -716.4337381919834, -660.3683306119531, -132.0252339785013, -1075.117819855843, -129.94179786907893, -966.7979925267738, -966.718443361468, -902.4393709753781, -151.00600626151663, -480.7437119160603, -172.82592973967715, -1216.355540905834, -224.0975947127496, -257.65458205356543, -282.03205602127855, -1024.9642824823727, -405.43193602393575, -772.7862140474076, -186.81307035017358, -261.4031681783409, -1085.4033431889177, -249.87425582860786, -307.5690083442244, -13.55800419932001, -1006.9620953080715, -1374.3650409592133, -685.4129936034868, -341.1802112238672, -1079.2840831048004, -854.4738167980775, -1028.0718154534338, -1231.259577712161, -1046.6965367451812, -461.3630628143601, -1008.7654538930159, -1218.4424441374297, -461.64633047978367, -953.1842600961546, -1003.2117397972828, -1151.5868403318304, -339.25630183150315, -108.71494990533208, -1090.5589414369808, -986.8308314434408, -743.7746804855356, -886.6581962216046, -460.05660774481316, -1335.6467883763505, -401.3845781734559, -1097.0138586208175, -979.0484090367597, -1021.8410482252071, -536.1667711573999, -1126.6561617929765, -1232.7916210359172, -1120.8881859571045, -1098.5499316561452, -1011.6658140221815, -194.36386572665154, -773.2042728173143, -34.93994066750533, -901.7775582690683, -124.39837251328949, -122.1385783008419, -1351.214733895654, -941.8274774895672, -1134.8095611245153, -1139.3920970267195, -999.7172250414025, -1134.9860706787613, -956.3803205339775, -1220.6624704615356], "episode_lengths": [150, 93, 150, 150, 122, 150, 72, 150, 49, 150, 150, 108, 49, 150, 141, 98, 150, 101, 150, 147, 150, 82, 75, 44, 150, 150, 59, 150, 150, 124, 50, 150, 49, 150, 150, 150, 75, 102, 81, 150, 88, 83, 77, 150, 105, 150, 68, 88, 150, 100, 150, 41, 150, 150, 150, 85, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 84, 67, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 43, 150, 62, 56, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-472.8631728351763, -182.81131888865153, -1255.3095870419295, -1219.8461106612094, -385.130233128719, -1169.8662161989364, -246.81297706453813, -1115.5458324284016, -81.86710938026445, -1113.8857783305746, -974.6364886326497, -265.23658644892083, -87.19568433394798, -960.1153004484022, -735.9245110365589, -245.42616009022754, -1330.9892235636112, -294.08126971813425, -1136.0662369943807, -818.4837596660776, -912.9863794898806, -359.12391367213166, -292.65158096249405, -42.06374772223042, -1358.1248152633002, -950.4338362647376, -134.32754223403867, -943.4389958618835, -716.4337381919834, -660.3683306119531, -132.0252339785013, -1075.117819855843, -129.94179786907893, -966.7979925267738, -966.718443361468, -902.4393709753781, -151.00600626151663, -480.7437119160603, -172.82592973967715, -1216.355540905834, -224.0975947127496, -257.65458205356543, -282.03205602127855, -1024.9642824823727, -405.43193602393575, -772.7862140474076, -186.81307035017358, -261.4031681783409, -1085.4033431889177, -249.87425582860786, -307.5690083442244, -13.55800419932001, -1006.9620953080715, -1374.3650409592133, -685.4129936034868, -341.1802112238672, -1079.2840831048004, -854.4738167980775, -1028.0718154534338, -1231.259577712161, -1046.6965367451812, -461.3630628143601, -1008.7654538930159, -1218.4424441374297, -461.64633047978367, -953.1842600961546, -1003.2117397972828, -1151.5868403318304, -339.25630183150315, -108.71494990533208, -1090.5589414369808, -986.8308314434408, -743.7746804855356, -886.6581962216046, -460.05660774481316, -1335.6467883763505, -401.3845781734559, -1097.0138586208175, -979.0484090367597, -1021.8410482252071, -536.1667711573999, -1126.6561617929765, -1232.7916210359172, -1120.8881859571045, -1098.5499316561452, -1011.6658140221815, -194.36386572665154, -773.2042728173143, -34.93994066750533, -901.7775582690683, -124.39837251328949, -122.1385783008419, -1351.214733895654, -941.8274774895672, -1134.8095611245153, -1139.3920970267195, -999.7172250414025, -1134.9860706787613, -956.3803205339775, -1220.6624704615356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630036445701688, "mean_inference_ms": 1.6918070218727603, "mean_action_processing_ms": 0.2810028844259117, "mean_env_wait_ms": 3.4630076827108343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021746158599853516, "StateBufferConnector_ms": 0.008800983428955078, "ViewRequirementAgentConnector_ms": 0.1930680274963379}, "num_episodes": 32, "episode_return_max": -13.55800419932001, "episode_return_min": -1374.3650409592133, "episode_return_mean": -732.4082832411544, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.91978838165676, "num_env_steps_trained_throughput_per_sec": 303.91978838165676, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12885.53, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12885.457, "sample_time_ms": 1150.329, "learn_time_ms": 11664.105, "learn_throughput": 342.932, "synch_weights_time_ms": 70.159}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1e132_00007", "date": "2024-08-04_08-39-39", "timestamp": 1722740979, "time_this_iter_s": 13.174341917037964, "time_total_s": 77.38672423362732, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a7490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.38672423362732, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.69473684210526, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.963573849697907, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.00577517747879, "policy_loss": -0.0064253360658767635, "vf_loss": 9.00997966726621, "vf_explained_var": 0.4643448603029052, "kl": 0.01175008734938577, "entropy": 1.2915423815449079, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -13.55800419932001, "episode_reward_min": -1374.3650409592133, "episode_reward_mean": -751.677531799643, "episode_len_mean": 129.53, "episode_media": {}, "episodes_timesteps_total": 12953, "policy_reward_min": {"policy_0": -1374.3650409592133}, "policy_reward_max": {"policy_0": -13.55800419932001}, "policy_reward_mean": {"policy_0": -751.677531799643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-966.7979925267738, -966.718443361468, -902.4393709753781, -151.00600626151663, -480.7437119160603, -172.82592973967715, -1216.355540905834, -224.0975947127496, -257.65458205356543, -282.03205602127855, -1024.9642824823727, -405.43193602393575, -772.7862140474076, -186.81307035017358, -261.4031681783409, -1085.4033431889177, -249.87425582860786, -307.5690083442244, -13.55800419932001, -1006.9620953080715, -1374.3650409592133, -685.4129936034868, -341.1802112238672, -1079.2840831048004, -854.4738167980775, -1028.0718154534338, -1231.259577712161, -1046.6965367451812, -461.3630628143601, -1008.7654538930159, -1218.4424441374297, -461.64633047978367, -953.1842600961546, -1003.2117397972828, -1151.5868403318304, -339.25630183150315, -108.71494990533208, -1090.5589414369808, -986.8308314434408, -743.7746804855356, -886.6581962216046, -460.05660774481316, -1335.6467883763505, -401.3845781734559, -1097.0138586208175, -979.0484090367597, -1021.8410482252071, -536.1667711573999, -1126.6561617929765, -1232.7916210359172, -1120.8881859571045, -1098.5499316561452, -1011.6658140221815, -194.36386572665154, -773.2042728173143, -34.93994066750533, -901.7775582690683, -124.39837251328949, -122.1385783008419, -1351.214733895654, -941.8274774895672, -1134.8095611245153, -1139.3920970267195, -999.7172250414025, -1134.9860706787613, -956.3803205339775, -1220.6624704615356, -1317.489221085385, -142.46658425496054, -1253.0834072449643, -1339.4446497628567, -688.9949765079249, -207.3675526656718, -513.6683573441885, -546.2359752342765, -49.05747321960877, -796.7777871778658, -419.60910577039385, -96.48857676365034, -1168.177286122052, -747.1535437327013, -927.5825717886486, -657.795630164283, -802.4600092422355, -78.07966843125938, -832.4208277590507, -567.5543000908599, -724.681173448308, -911.8726812992483, -829.4041133234758, -366.6225463717783, -411.4847784196691, -1032.1332884567844, -792.7590799124947, -919.3267219481352, -1006.6412470075505, -1101.794958243492, -1236.2903865738663, -1132.702533054726, -108.43513229584438], "episode_lengths": [150, 150, 150, 75, 102, 81, 150, 88, 83, 77, 150, 105, 150, 68, 88, 150, 100, 150, 41, 150, 150, 150, 85, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 84, 67, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 43, 150, 62, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 95, 127, 150, 37, 150, 97, 52, 150, 150, 150, 150, 150, 54, 143, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 59], "policy_policy_0_reward": [-966.7979925267738, -966.718443361468, -902.4393709753781, -151.00600626151663, -480.7437119160603, -172.82592973967715, -1216.355540905834, -224.0975947127496, -257.65458205356543, -282.03205602127855, -1024.9642824823727, -405.43193602393575, -772.7862140474076, -186.81307035017358, -261.4031681783409, -1085.4033431889177, -249.87425582860786, -307.5690083442244, -13.55800419932001, -1006.9620953080715, -1374.3650409592133, -685.4129936034868, -341.1802112238672, -1079.2840831048004, -854.4738167980775, -1028.0718154534338, -1231.259577712161, -1046.6965367451812, -461.3630628143601, -1008.7654538930159, -1218.4424441374297, -461.64633047978367, -953.1842600961546, -1003.2117397972828, -1151.5868403318304, -339.25630183150315, -108.71494990533208, -1090.5589414369808, -986.8308314434408, -743.7746804855356, -886.6581962216046, -460.05660774481316, -1335.6467883763505, -401.3845781734559, -1097.0138586208175, -979.0484090367597, -1021.8410482252071, -536.1667711573999, -1126.6561617929765, -1232.7916210359172, -1120.8881859571045, -1098.5499316561452, -1011.6658140221815, -194.36386572665154, -773.2042728173143, -34.93994066750533, -901.7775582690683, -124.39837251328949, -122.1385783008419, -1351.214733895654, -941.8274774895672, -1134.8095611245153, -1139.3920970267195, -999.7172250414025, -1134.9860706787613, -956.3803205339775, -1220.6624704615356, -1317.489221085385, -142.46658425496054, -1253.0834072449643, -1339.4446497628567, -688.9949765079249, -207.3675526656718, -513.6683573441885, -546.2359752342765, -49.05747321960877, -796.7777871778658, -419.60910577039385, -96.48857676365034, -1168.177286122052, -747.1535437327013, -927.5825717886486, -657.795630164283, -802.4600092422355, -78.07966843125938, -832.4208277590507, -567.5543000908599, -724.681173448308, -911.8726812992483, -829.4041133234758, -366.6225463717783, -411.4847784196691, -1032.1332884567844, -792.7590799124947, -919.3267219481352, -1006.6412470075505, -1101.794958243492, -1236.2903865738663, -1132.702533054726, -108.43513229584438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5617157383643456, "mean_inference_ms": 1.6905967058854012, "mean_action_processing_ms": 0.28042099845960683, "mean_env_wait_ms": 3.458546077059733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013633966445922852, "StateBufferConnector_ms": 0.008499622344970703, "ViewRequirementAgentConnector_ms": 0.1881699562072754}, "num_episodes": 33, "episode_return_max": -13.55800419932001, "episode_return_min": -1374.3650409592133, "episode_return_mean": -751.677531799643, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.684655830129, "num_env_steps_trained_throughput_per_sec": 302.684655830129, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12932.609, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12932.536, "sample_time_ms": 1165.54, "learn_time_ms": 11696.552, "learn_throughput": 341.981, "synch_weights_time_ms": 69.594}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1e132_00007", "date": "2024-08-04_08-39-52", "timestamp": 1722740992, "time_this_iter_s": 13.22756314277649, "time_total_s": 90.61428737640381, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a5d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.61428737640381, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.994444444444447, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.900373637427887, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 8.537313759326935, "policy_loss": -0.017142316883837338, "vf_loss": 8.550934666891893, "vf_explained_var": 0.5945920269315441, "kl": 0.018268664064529132, "entropy": 1.3232601145903269, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -16.670087529733035, "episode_reward_min": -1394.694234482595, "episode_reward_mean": -757.6662678834872, "episode_len_mean": 132.49, "episode_media": {}, "episodes_timesteps_total": 13249, "policy_reward_min": {"policy_0": -1394.694234482595}, "policy_reward_max": {"policy_0": -16.670087529733035}, "policy_reward_mean": {"policy_0": -757.6662678834872}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-461.3630628143601, -1008.7654538930159, -1218.4424441374297, -461.64633047978367, -953.1842600961546, -1003.2117397972828, -1151.5868403318304, -339.25630183150315, -108.71494990533208, -1090.5589414369808, -986.8308314434408, -743.7746804855356, -886.6581962216046, -460.05660774481316, -1335.6467883763505, -401.3845781734559, -1097.0138586208175, -979.0484090367597, -1021.8410482252071, -536.1667711573999, -1126.6561617929765, -1232.7916210359172, -1120.8881859571045, -1098.5499316561452, -1011.6658140221815, -194.36386572665154, -773.2042728173143, -34.93994066750533, -901.7775582690683, -124.39837251328949, -122.1385783008419, -1351.214733895654, -941.8274774895672, -1134.8095611245153, -1139.3920970267195, -999.7172250414025, -1134.9860706787613, -956.3803205339775, -1220.6624704615356, -1317.489221085385, -142.46658425496054, -1253.0834072449643, -1339.4446497628567, -688.9949765079249, -207.3675526656718, -513.6683573441885, -546.2359752342765, -49.05747321960877, -796.7777871778658, -419.60910577039385, -96.48857676365034, -1168.177286122052, -747.1535437327013, -927.5825717886486, -657.795630164283, -802.4600092422355, -78.07966843125938, -832.4208277590507, -567.5543000908599, -724.681173448308, -911.8726812992483, -829.4041133234758, -366.6225463717783, -411.4847784196691, -1032.1332884567844, -792.7590799124947, -919.3267219481352, -1006.6412470075505, -1101.794958243492, -1236.2903865738663, -1132.702533054726, -108.43513229584438, -1394.694234482595, -532.1754203786791, -58.43942210202275, -615.5205992876976, -192.4046687264031, -816.1872023759182, -661.995128191856, -602.4699119014712, -16.670087529733035, -367.5586799633459, -93.16214952264639, -852.8236429097133, -386.4762703295919, -1189.1827694678884, -1214.4661465121578, -781.1312215637222, -1125.3453939510962, -638.4807420250382, -668.8240650456817, -1136.6614195906466, -1047.0437407855648, -775.1897240263037, -799.1022247298266, -347.6263502479354, -771.869162222262, -261.3512704876509, -908.5834790066407, -919.6191630462235], "episode_lengths": [111, 150, 150, 150, 150, 150, 150, 84, 67, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 43, 150, 62, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 95, 127, 150, 37, 150, 97, 52, 150, 150, 150, 150, 150, 54, 143, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 52, 129, 80, 150, 150, 132, 36, 118, 68, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150], "policy_policy_0_reward": [-461.3630628143601, -1008.7654538930159, -1218.4424441374297, -461.64633047978367, -953.1842600961546, -1003.2117397972828, -1151.5868403318304, -339.25630183150315, -108.71494990533208, -1090.5589414369808, -986.8308314434408, -743.7746804855356, -886.6581962216046, -460.05660774481316, -1335.6467883763505, -401.3845781734559, -1097.0138586208175, -979.0484090367597, -1021.8410482252071, -536.1667711573999, -1126.6561617929765, -1232.7916210359172, -1120.8881859571045, -1098.5499316561452, -1011.6658140221815, -194.36386572665154, -773.2042728173143, -34.93994066750533, -901.7775582690683, -124.39837251328949, -122.1385783008419, -1351.214733895654, -941.8274774895672, -1134.8095611245153, -1139.3920970267195, -999.7172250414025, -1134.9860706787613, -956.3803205339775, -1220.6624704615356, -1317.489221085385, -142.46658425496054, -1253.0834072449643, -1339.4446497628567, -688.9949765079249, -207.3675526656718, -513.6683573441885, -546.2359752342765, -49.05747321960877, -796.7777871778658, -419.60910577039385, -96.48857676365034, -1168.177286122052, -747.1535437327013, -927.5825717886486, -657.795630164283, -802.4600092422355, -78.07966843125938, -832.4208277590507, -567.5543000908599, -724.681173448308, -911.8726812992483, -829.4041133234758, -366.6225463717783, -411.4847784196691, -1032.1332884567844, -792.7590799124947, -919.3267219481352, -1006.6412470075505, -1101.794958243492, -1236.2903865738663, -1132.702533054726, -108.43513229584438, -1394.694234482595, -532.1754203786791, -58.43942210202275, -615.5205992876976, -192.4046687264031, -816.1872023759182, -661.995128191856, -602.4699119014712, -16.670087529733035, -367.5586799633459, -93.16214952264639, -852.8236429097133, -386.4762703295919, -1189.1827694678884, -1214.4661465121578, -781.1312215637222, -1125.3453939510962, -638.4807420250382, -668.8240650456817, -1136.6614195906466, -1047.0437407855648, -775.1897240263037, -799.1022247298266, -347.6263502479354, -771.869162222262, -261.3512704876509, -908.5834790066407, -919.6191630462235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616896971889839, "mean_inference_ms": 1.6903393411482701, "mean_action_processing_ms": 0.2802325798798104, "mean_env_wait_ms": 3.45944448727486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013403177261352539, "StateBufferConnector_ms": 0.008284807205200195, "ViewRequirementAgentConnector_ms": 0.18752384185791016}, "num_episodes": 28, "episode_return_max": -16.670087529733035, "episode_return_min": -1394.694234482595, "episode_return_mean": -757.6662678834872, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.28513571450947, "num_env_steps_trained_throughput_per_sec": 303.28513571450947, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12964.648, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12964.576, "sample_time_ms": 1159.973, "learn_time_ms": 11735.449, "learn_throughput": 340.848, "synch_weights_time_ms": 68.318}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1e132_00007", "date": "2024-08-04_08-40-06", "timestamp": 1722741006, "time_this_iter_s": 13.200552463531494, "time_total_s": 103.8148398399353, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.8148398399353, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.842105263157894, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.610187641034525, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 8.382271342476209, "policy_loss": -0.01149881566137386, "vf_loss": 8.390569081405799, "vf_explained_var": 0.6391071875269214, "kl": 0.016667436426996574, "entropy": 1.3241212083647649, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -16.670087529733035, "episode_reward_min": -1454.4191606006812, "episode_reward_mean": -694.3593696773487, "episode_len_mean": 127.65, "episode_media": {}, "episodes_timesteps_total": 12765, "policy_reward_min": {"policy_0": -1454.4191606006812}, "policy_reward_max": {"policy_0": -16.670087529733035}, "policy_reward_mean": {"policy_0": -694.3593696773487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.1385783008419, -1351.214733895654, -941.8274774895672, -1134.8095611245153, -1139.3920970267195, -999.7172250414025, -1134.9860706787613, -956.3803205339775, -1220.6624704615356, -1317.489221085385, -142.46658425496054, -1253.0834072449643, -1339.4446497628567, -688.9949765079249, -207.3675526656718, -513.6683573441885, -546.2359752342765, -49.05747321960877, -796.7777871778658, -419.60910577039385, -96.48857676365034, -1168.177286122052, -747.1535437327013, -927.5825717886486, -657.795630164283, -802.4600092422355, -78.07966843125938, -832.4208277590507, -567.5543000908599, -724.681173448308, -911.8726812992483, -829.4041133234758, -366.6225463717783, -411.4847784196691, -1032.1332884567844, -792.7590799124947, -919.3267219481352, -1006.6412470075505, -1101.794958243492, -1236.2903865738663, -1132.702533054726, -108.43513229584438, -1394.694234482595, -532.1754203786791, -58.43942210202275, -615.5205992876976, -192.4046687264031, -816.1872023759182, -661.995128191856, -602.4699119014712, -16.670087529733035, -367.5586799633459, -93.16214952264639, -852.8236429097133, -386.4762703295919, -1189.1827694678884, -1214.4661465121578, -781.1312215637222, -1125.3453939510962, -638.4807420250382, -668.8240650456817, -1136.6614195906466, -1047.0437407855648, -775.1897240263037, -799.1022247298266, -347.6263502479354, -771.869162222262, -261.3512704876509, -908.5834790066407, -919.6191630462235, -950.9196830824272, -372.89877477760723, -29.05884830578471, -1454.4191606006812, -171.5429235724626, -673.9505646804204, -139.8859509508975, -215.84034125489785, -716.1389703151864, -1205.1238094922664, -683.0715225151051, -458.0837441074342, -400.1414985888181, -351.93821518070604, -172.12486729191238, -640.8239365694076, -692.3835116433252, -1265.751106224322, -60.15239186065361, -1039.571028337473, -1130.607538389572, -552.9193110745164, -200.7075690231109, -1085.3140972398219, -219.21795241565653, -180.40779117314293, -569.4393871253046, -1124.9915351117445, -356.89245365561186, -419.3795134931119], "episode_lengths": [56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 95, 127, 150, 37, 150, 97, 52, 150, 150, 150, 150, 150, 54, 143, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 52, 129, 80, 150, 150, 132, 36, 118, 68, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 118, 38, 150, 80, 150, 73, 66, 150, 150, 125, 150, 95, 108, 82, 140, 150, 150, 51, 150, 150, 150, 73, 150, 84, 65, 150, 150, 150, 90], "policy_policy_0_reward": [-122.1385783008419, -1351.214733895654, -941.8274774895672, -1134.8095611245153, -1139.3920970267195, -999.7172250414025, -1134.9860706787613, -956.3803205339775, -1220.6624704615356, -1317.489221085385, -142.46658425496054, -1253.0834072449643, -1339.4446497628567, -688.9949765079249, -207.3675526656718, -513.6683573441885, -546.2359752342765, -49.05747321960877, -796.7777871778658, -419.60910577039385, -96.48857676365034, -1168.177286122052, -747.1535437327013, -927.5825717886486, -657.795630164283, -802.4600092422355, -78.07966843125938, -832.4208277590507, -567.5543000908599, -724.681173448308, -911.8726812992483, -829.4041133234758, -366.6225463717783, -411.4847784196691, -1032.1332884567844, -792.7590799124947, -919.3267219481352, -1006.6412470075505, -1101.794958243492, -1236.2903865738663, -1132.702533054726, -108.43513229584438, -1394.694234482595, -532.1754203786791, -58.43942210202275, -615.5205992876976, -192.4046687264031, -816.1872023759182, -661.995128191856, -602.4699119014712, -16.670087529733035, -367.5586799633459, -93.16214952264639, -852.8236429097133, -386.4762703295919, -1189.1827694678884, -1214.4661465121578, -781.1312215637222, -1125.3453939510962, -638.4807420250382, -668.8240650456817, -1136.6614195906466, -1047.0437407855648, -775.1897240263037, -799.1022247298266, -347.6263502479354, -771.869162222262, -261.3512704876509, -908.5834790066407, -919.6191630462235, -950.9196830824272, -372.89877477760723, -29.05884830578471, -1454.4191606006812, -171.5429235724626, -673.9505646804204, -139.8859509508975, -215.84034125489785, -716.1389703151864, -1205.1238094922664, -683.0715225151051, -458.0837441074342, -400.1414985888181, -351.93821518070604, -172.12486729191238, -640.8239365694076, -692.3835116433252, -1265.751106224322, -60.15239186065361, -1039.571028337473, -1130.607538389572, -552.9193110745164, -200.7075690231109, -1085.3140972398219, -219.21795241565653, -180.40779117314293, -569.4393871253046, -1124.9915351117445, -356.89245365561186, -419.3795134931119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5608479856413718, "mean_inference_ms": 1.6888447665734654, "mean_action_processing_ms": 0.2795123635045991, "mean_env_wait_ms": 3.456094906433193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013835668563842773, "StateBufferConnector_ms": 0.008181095123291016, "ViewRequirementAgentConnector_ms": 0.19098615646362305}, "num_episodes": 30, "episode_return_max": -16.670087529733035, "episode_return_min": -1454.4191606006812, "episode_return_mean": -694.3593696773487, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.5827291689789, "num_env_steps_trained_throughput_per_sec": 313.5827291689789, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12941.445, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12941.37, "sample_time_ms": 1154.234, "learn_time_ms": 11718.64, "learn_throughput": 341.337, "synch_weights_time_ms": 67.668}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1e132_00007", "date": "2024-08-04_08-40-18", "timestamp": 1722741018, "time_this_iter_s": 12.768184185028076, "time_total_s": 116.58302402496338, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575dfc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.58302402496338, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.86842105263158, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.23454969599843, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 8.386550663908322, "policy_loss": -0.010510549627845952, "vf_loss": 8.394174077113469, "vf_explained_var": 0.6301071740686893, "kl": 0.015104201319869996, "entropy": 1.3373137125124535, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -16.670087529733035, "episode_reward_min": -1454.4191606006812, "episode_reward_mean": -698.3571327443881, "episode_len_mean": 130.88, "episode_media": {}, "episodes_timesteps_total": 13088, "policy_reward_min": {"policy_0": -1454.4191606006812}, "policy_reward_max": {"policy_0": -16.670087529733035}, "policy_reward_mean": {"policy_0": -698.3571327443881}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-829.4041133234758, -366.6225463717783, -411.4847784196691, -1032.1332884567844, -792.7590799124947, -919.3267219481352, -1006.6412470075505, -1101.794958243492, -1236.2903865738663, -1132.702533054726, -108.43513229584438, -1394.694234482595, -532.1754203786791, -58.43942210202275, -615.5205992876976, -192.4046687264031, -816.1872023759182, -661.995128191856, -602.4699119014712, -16.670087529733035, -367.5586799633459, -93.16214952264639, -852.8236429097133, -386.4762703295919, -1189.1827694678884, -1214.4661465121578, -781.1312215637222, -1125.3453939510962, -638.4807420250382, -668.8240650456817, -1136.6614195906466, -1047.0437407855648, -775.1897240263037, -799.1022247298266, -347.6263502479354, -771.869162222262, -261.3512704876509, -908.5834790066407, -919.6191630462235, -950.9196830824272, -372.89877477760723, -29.05884830578471, -1454.4191606006812, -171.5429235724626, -673.9505646804204, -139.8859509508975, -215.84034125489785, -716.1389703151864, -1205.1238094922664, -683.0715225151051, -458.0837441074342, -400.1414985888181, -351.93821518070604, -172.12486729191238, -640.8239365694076, -692.3835116433252, -1265.751106224322, -60.15239186065361, -1039.571028337473, -1130.607538389572, -552.9193110745164, -200.7075690231109, -1085.3140972398219, -219.21795241565653, -180.40779117314293, -569.4393871253046, -1124.9915351117445, -356.89245365561186, -419.3795134931119, -1309.4219020696364, -965.9020312427341, -539.510621103497, -752.4868108950989, -95.6086397804909, -513.6817196610884, -521.4167656904124, -1353.971391502011, -83.8480901438196, -953.3740625566443, -1031.3549139306401, -946.3450036442907, -587.1975830435495, -1345.374046941866, -643.2551342442183, -491.83944822665245, -590.8150001637841, -1065.102135477493, -741.987917887472, -938.6385661345928, -1003.9511288892103, -362.4673494351872, -755.5369823541957, -1074.3094996381687, -1138.9461763107988, -598.4334600016053, -103.1986745744541, -1185.1125269685203, -675.109355648068, -824.7569877511021, -996.4122744560223], "episode_lengths": [150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 52, 129, 80, 150, 150, 132, 36, 118, 68, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 118, 38, 150, 80, 150, 73, 66, 150, 150, 125, 150, 95, 108, 82, 140, 150, 150, 51, 150, 150, 150, 73, 150, 84, 65, 150, 150, 150, 90, 150, 150, 150, 150, 46, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 67, 150, 150, 150, 150], "policy_policy_0_reward": [-829.4041133234758, -366.6225463717783, -411.4847784196691, -1032.1332884567844, -792.7590799124947, -919.3267219481352, -1006.6412470075505, -1101.794958243492, -1236.2903865738663, -1132.702533054726, -108.43513229584438, -1394.694234482595, -532.1754203786791, -58.43942210202275, -615.5205992876976, -192.4046687264031, -816.1872023759182, -661.995128191856, -602.4699119014712, -16.670087529733035, -367.5586799633459, -93.16214952264639, -852.8236429097133, -386.4762703295919, -1189.1827694678884, -1214.4661465121578, -781.1312215637222, -1125.3453939510962, -638.4807420250382, -668.8240650456817, -1136.6614195906466, -1047.0437407855648, -775.1897240263037, -799.1022247298266, -347.6263502479354, -771.869162222262, -261.3512704876509, -908.5834790066407, -919.6191630462235, -950.9196830824272, -372.89877477760723, -29.05884830578471, -1454.4191606006812, -171.5429235724626, -673.9505646804204, -139.8859509508975, -215.84034125489785, -716.1389703151864, -1205.1238094922664, -683.0715225151051, -458.0837441074342, -400.1414985888181, -351.93821518070604, -172.12486729191238, -640.8239365694076, -692.3835116433252, -1265.751106224322, -60.15239186065361, -1039.571028337473, -1130.607538389572, -552.9193110745164, -200.7075690231109, -1085.3140972398219, -219.21795241565653, -180.40779117314293, -569.4393871253046, -1124.9915351117445, -356.89245365561186, -419.3795134931119, -1309.4219020696364, -965.9020312427341, -539.510621103497, -752.4868108950989, -95.6086397804909, -513.6817196610884, -521.4167656904124, -1353.971391502011, -83.8480901438196, -953.3740625566443, -1031.3549139306401, -946.3450036442907, -587.1975830435495, -1345.374046941866, -643.2551342442183, -491.83944822665245, -590.8150001637841, -1065.102135477493, -741.987917887472, -938.6385661345928, -1003.9511288892103, -362.4673494351872, -755.5369823541957, -1074.3094996381687, -1138.9461763107988, -598.4334600016053, -103.1986745744541, -1185.1125269685203, -675.109355648068, -824.7569877511021, -996.4122744560223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5600351251375077, "mean_inference_ms": 1.6860860899807628, "mean_action_processing_ms": 0.27893599196320223, "mean_env_wait_ms": 3.4495411208282754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013085603713989258, "StateBufferConnector_ms": 0.008196353912353516, "ViewRequirementAgentConnector_ms": 0.19152593612670898}, "num_episodes": 31, "episode_return_max": -16.670087529733035, "episode_return_min": -1454.4191606006812, "episode_return_mean": -698.3571327443881, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.1463856966735, "num_env_steps_trained_throughput_per_sec": 325.1463856966735, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12877.517, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12877.443, "sample_time_ms": 1150.672, "learn_time_ms": 11658.228, "learn_throughput": 343.105, "synch_weights_time_ms": 67.72}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1e132_00007", "date": "2024-08-04_08-40-31", "timestamp": 1722741031, "time_this_iter_s": 12.314502239227295, "time_total_s": 128.89752626419067, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447aecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.89752626419067, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.5, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.165555522342522, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 8.31336311896642, "policy_loss": -0.010496750161595021, "vf_loss": 8.321067130565643, "vf_explained_var": 0.7342525121445457, "kl": 0.014624265413416045, "entropy": 1.3209485887239376, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": 1.2002144200938403, "episode_reward_min": -1454.4191606006812, "episode_reward_mean": -693.3096442629975, "episode_len_mean": 131.37, "episode_media": {}, "episodes_timesteps_total": 13137, "policy_reward_min": {"policy_0": -1454.4191606006812}, "policy_reward_max": {"policy_0": 1.2002144200938403}, "policy_reward_mean": {"policy_0": -693.3096442629975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-668.8240650456817, -1136.6614195906466, -1047.0437407855648, -775.1897240263037, -799.1022247298266, -347.6263502479354, -771.869162222262, -261.3512704876509, -908.5834790066407, -919.6191630462235, -950.9196830824272, -372.89877477760723, -29.05884830578471, -1454.4191606006812, -171.5429235724626, -673.9505646804204, -139.8859509508975, -215.84034125489785, -716.1389703151864, -1205.1238094922664, -683.0715225151051, -458.0837441074342, -400.1414985888181, -351.93821518070604, -172.12486729191238, -640.8239365694076, -692.3835116433252, -1265.751106224322, -60.15239186065361, -1039.571028337473, -1130.607538389572, -552.9193110745164, -200.7075690231109, -1085.3140972398219, -219.21795241565653, -180.40779117314293, -569.4393871253046, -1124.9915351117445, -356.89245365561186, -419.3795134931119, -1309.4219020696364, -965.9020312427341, -539.510621103497, -752.4868108950989, -95.6086397804909, -513.6817196610884, -521.4167656904124, -1353.971391502011, -83.8480901438196, -953.3740625566443, -1031.3549139306401, -946.3450036442907, -587.1975830435495, -1345.374046941866, -643.2551342442183, -491.83944822665245, -590.8150001637841, -1065.102135477493, -741.987917887472, -938.6385661345928, -1003.9511288892103, -362.4673494351872, -755.5369823541957, -1074.3094996381687, -1138.9461763107988, -598.4334600016053, -103.1986745744541, -1185.1125269685203, -675.109355648068, -824.7569877511021, -996.4122744560223, -1011.2742629544489, -927.4439448552972, -77.70208034776708, -545.7130716611846, -89.57653982199285, -879.653268627904, -36.29034234855978, -1066.7494380263993, -469.9124021488596, -764.1996660668085, -189.47590758834818, -1278.1589950828113, -779.1889904741003, -1081.290749660564, -475.2789195181837, -1009.0344363087047, -854.109709336408, -873.4899984800579, -1035.093260462058, -1323.9261776597978, -313.9538797457342, -854.8208829950136, -777.6310152809691, -1195.7127720795047, -607.6447594922626, 1.2002144200938403, -387.2085704925185, -485.31090475736084, -583.3848968367743], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 118, 38, 150, 80, 150, 73, 66, 150, 150, 125, 150, 95, 108, 82, 140, 150, 150, 51, 150, 150, 150, 73, 150, 84, 65, 150, 150, 150, 90, 150, 150, 150, 150, 46, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 68, 150, 43, 150, 46, 150, 128, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150], "policy_policy_0_reward": [-668.8240650456817, -1136.6614195906466, -1047.0437407855648, -775.1897240263037, -799.1022247298266, -347.6263502479354, -771.869162222262, -261.3512704876509, -908.5834790066407, -919.6191630462235, -950.9196830824272, -372.89877477760723, -29.05884830578471, -1454.4191606006812, -171.5429235724626, -673.9505646804204, -139.8859509508975, -215.84034125489785, -716.1389703151864, -1205.1238094922664, -683.0715225151051, -458.0837441074342, -400.1414985888181, -351.93821518070604, -172.12486729191238, -640.8239365694076, -692.3835116433252, -1265.751106224322, -60.15239186065361, -1039.571028337473, -1130.607538389572, -552.9193110745164, -200.7075690231109, -1085.3140972398219, -219.21795241565653, -180.40779117314293, -569.4393871253046, -1124.9915351117445, -356.89245365561186, -419.3795134931119, -1309.4219020696364, -965.9020312427341, -539.510621103497, -752.4868108950989, -95.6086397804909, -513.6817196610884, -521.4167656904124, -1353.971391502011, -83.8480901438196, -953.3740625566443, -1031.3549139306401, -946.3450036442907, -587.1975830435495, -1345.374046941866, -643.2551342442183, -491.83944822665245, -590.8150001637841, -1065.102135477493, -741.987917887472, -938.6385661345928, -1003.9511288892103, -362.4673494351872, -755.5369823541957, -1074.3094996381687, -1138.9461763107988, -598.4334600016053, -103.1986745744541, -1185.1125269685203, -675.109355648068, -824.7569877511021, -996.4122744560223, -1011.2742629544489, -927.4439448552972, -77.70208034776708, -545.7130716611846, -89.57653982199285, -879.653268627904, -36.29034234855978, -1066.7494380263993, -469.9124021488596, -764.1996660668085, -189.47590758834818, -1278.1589950828113, -779.1889904741003, -1081.290749660564, -475.2789195181837, -1009.0344363087047, -854.109709336408, -873.4899984800579, -1035.093260462058, -1323.9261776597978, -313.9538797457342, -854.8208829950136, -777.6310152809691, -1195.7127720795047, -607.6447594922626, 1.2002144200938403, -387.2085704925185, -485.31090475736084, -583.3848968367743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588397499015684, "mean_inference_ms": 1.6860364199289635, "mean_action_processing_ms": 0.27872274462917057, "mean_env_wait_ms": 3.453066348457966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013076305389404297, "StateBufferConnector_ms": 0.00825047492980957, "ViewRequirementAgentConnector_ms": 0.1913294792175293}, "num_episodes": 29, "episode_return_max": 1.2002144200938403, "episode_return_min": -1454.4191606006812, "episode_return_mean": -693.3096442629975, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.2193357970734, "num_env_steps_trained_throughput_per_sec": 311.2193357970734, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12885.65, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12885.575, "sample_time_ms": 1138.575, "learn_time_ms": 11679.472, "learn_throughput": 342.481, "synch_weights_time_ms": 66.749}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1e132_00007", "date": "2024-08-04_08-40-44", "timestamp": 1722741044, "time_this_iter_s": 12.865882158279419, "time_total_s": 141.7634084224701, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456d090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.7634084224701, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.12777777777778, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.510106942554316, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 7.925199523568153, "policy_loss": -0.01590308986584811, "vf_loss": 7.937151351571083, "vf_explained_var": 0.798835078937312, "kl": 0.020406227794167838, "entropy": 1.2996238718430202, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 1.2002144200938403, "episode_reward_min": -1353.971391502011, "episode_reward_mean": -696.6521317866273, "episode_len_mean": 133.42, "episode_media": {}, "episodes_timesteps_total": 13342, "policy_reward_min": {"policy_0": -1353.971391502011}, "policy_reward_max": {"policy_0": 1.2002144200938403}, "policy_reward_mean": {"policy_0": -696.6521317866273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.7075690231109, -1085.3140972398219, -219.21795241565653, -180.40779117314293, -569.4393871253046, -1124.9915351117445, -356.89245365561186, -419.3795134931119, -1309.4219020696364, -965.9020312427341, -539.510621103497, -752.4868108950989, -95.6086397804909, -513.6817196610884, -521.4167656904124, -1353.971391502011, -83.8480901438196, -953.3740625566443, -1031.3549139306401, -946.3450036442907, -587.1975830435495, -1345.374046941866, -643.2551342442183, -491.83944822665245, -590.8150001637841, -1065.102135477493, -741.987917887472, -938.6385661345928, -1003.9511288892103, -362.4673494351872, -755.5369823541957, -1074.3094996381687, -1138.9461763107988, -598.4334600016053, -103.1986745744541, -1185.1125269685203, -675.109355648068, -824.7569877511021, -996.4122744560223, -1011.2742629544489, -927.4439448552972, -77.70208034776708, -545.7130716611846, -89.57653982199285, -879.653268627904, -36.29034234855978, -1066.7494380263993, -469.9124021488596, -764.1996660668085, -189.47590758834818, -1278.1589950828113, -779.1889904741003, -1081.290749660564, -475.2789195181837, -1009.0344363087047, -854.109709336408, -873.4899984800579, -1035.093260462058, -1323.9261776597978, -313.9538797457342, -854.8208829950136, -777.6310152809691, -1195.7127720795047, -607.6447594922626, 1.2002144200938403, -387.2085704925185, -485.31090475736084, -583.3848968367743, -607.4365440892744, -765.2095760207071, -963.1205768369791, -123.62453717802806, -368.47755637990315, -495.4183402380056, -1305.346141943645, -225.80633910943163, -677.2796226975817, -568.4667180850369, -1156.4658224268173, -1080.8554700779146, -137.45737656882673, -256.18993613480103, -828.913519184415, -22.103336956561634, -1084.9413363463534, -710.8009086352547, -444.7726163232982, -967.3107097036146, -834.5209096545329, -592.6954914461703, -743.3517432511978, -1317.1506327456118, -1252.4171270647757, -877.108225542693, -402.56598969089725, -838.2514841863789, -398.07430554674556, -82.20095869700441, -293.1818872183965, -925.9513103867421], "episode_lengths": [73, 150, 84, 65, 150, 150, 150, 90, 150, 150, 150, 150, 46, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 68, 150, 43, 150, 46, 150, 128, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 150, 87, 97, 150, 150, 73, 150, 150, 150, 150, 61, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 82, 150], "policy_policy_0_reward": [-200.7075690231109, -1085.3140972398219, -219.21795241565653, -180.40779117314293, -569.4393871253046, -1124.9915351117445, -356.89245365561186, -419.3795134931119, -1309.4219020696364, -965.9020312427341, -539.510621103497, -752.4868108950989, -95.6086397804909, -513.6817196610884, -521.4167656904124, -1353.971391502011, -83.8480901438196, -953.3740625566443, -1031.3549139306401, -946.3450036442907, -587.1975830435495, -1345.374046941866, -643.2551342442183, -491.83944822665245, -590.8150001637841, -1065.102135477493, -741.987917887472, -938.6385661345928, -1003.9511288892103, -362.4673494351872, -755.5369823541957, -1074.3094996381687, -1138.9461763107988, -598.4334600016053, -103.1986745744541, -1185.1125269685203, -675.109355648068, -824.7569877511021, -996.4122744560223, -1011.2742629544489, -927.4439448552972, -77.70208034776708, -545.7130716611846, -89.57653982199285, -879.653268627904, -36.29034234855978, -1066.7494380263993, -469.9124021488596, -764.1996660668085, -189.47590758834818, -1278.1589950828113, -779.1889904741003, -1081.290749660564, -475.2789195181837, -1009.0344363087047, -854.109709336408, -873.4899984800579, -1035.093260462058, -1323.9261776597978, -313.9538797457342, -854.8208829950136, -777.6310152809691, -1195.7127720795047, -607.6447594922626, 1.2002144200938403, -387.2085704925185, -485.31090475736084, -583.3848968367743, -607.4365440892744, -765.2095760207071, -963.1205768369791, -123.62453717802806, -368.47755637990315, -495.4183402380056, -1305.346141943645, -225.80633910943163, -677.2796226975817, -568.4667180850369, -1156.4658224268173, -1080.8554700779146, -137.45737656882673, -256.18993613480103, -828.913519184415, -22.103336956561634, -1084.9413363463534, -710.8009086352547, -444.7726163232982, -967.3107097036146, -834.5209096545329, -592.6954914461703, -743.3517432511978, -1317.1506327456118, -1252.4171270647757, -877.108225542693, -402.56598969089725, -838.2514841863789, -398.07430554674556, -82.20095869700441, -293.1818872183965, -925.9513103867421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5586726701085624, "mean_inference_ms": 1.6837586923158845, "mean_action_processing_ms": 0.2781829009215542, "mean_env_wait_ms": 3.4512176714378757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011992454528808594, "StateBufferConnector_ms": 0.008406877517700195, "ViewRequirementAgentConnector_ms": 0.1903088092803955}, "num_episodes": 32, "episode_return_max": 1.2002144200938403, "episode_return_min": -1353.971391502011, "episode_return_mean": -696.6521317866273, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.5015387552641, "num_env_steps_trained_throughput_per_sec": 310.5015387552641, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12884.14, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12884.064, "sample_time_ms": 1136.532, "learn_time_ms": 11679.444, "learn_throughput": 342.482, "synch_weights_time_ms": 67.313}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1e132_00007", "date": "2024-08-04_08-40-57", "timestamp": 1722741057, "time_this_iter_s": 12.894574403762817, "time_total_s": 154.6579828262329, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456dc60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.6579828262329, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.742105263157892, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.61897244850795, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 7.934975029031436, "policy_loss": -0.011364322809095028, "vf_loss": 7.941452778875828, "vf_explained_var": 0.7534426208585501, "kl": 0.016717520793463343, "entropy": 1.2868365439896783, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": 1.2002144200938403, "episode_reward_min": -1323.9261776597978, "episode_reward_mean": -692.448787934055, "episode_len_mean": 135.52, "episode_media": {}, "episodes_timesteps_total": 13552, "policy_reward_min": {"policy_0": -1323.9261776597978}, "policy_reward_max": {"policy_0": 1.2002144200938403}, "policy_reward_mean": {"policy_0": -692.448787934055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938.6385661345928, -1003.9511288892103, -362.4673494351872, -755.5369823541957, -1074.3094996381687, -1138.9461763107988, -598.4334600016053, -103.1986745744541, -1185.1125269685203, -675.109355648068, -824.7569877511021, -996.4122744560223, -1011.2742629544489, -927.4439448552972, -77.70208034776708, -545.7130716611846, -89.57653982199285, -879.653268627904, -36.29034234855978, -1066.7494380263993, -469.9124021488596, -764.1996660668085, -189.47590758834818, -1278.1589950828113, -779.1889904741003, -1081.290749660564, -475.2789195181837, -1009.0344363087047, -854.109709336408, -873.4899984800579, -1035.093260462058, -1323.9261776597978, -313.9538797457342, -854.8208829950136, -777.6310152809691, -1195.7127720795047, -607.6447594922626, 1.2002144200938403, -387.2085704925185, -485.31090475736084, -583.3848968367743, -607.4365440892744, -765.2095760207071, -963.1205768369791, -123.62453717802806, -368.47755637990315, -495.4183402380056, -1305.346141943645, -225.80633910943163, -677.2796226975817, -568.4667180850369, -1156.4658224268173, -1080.8554700779146, -137.45737656882673, -256.18993613480103, -828.913519184415, -22.103336956561634, -1084.9413363463534, -710.8009086352547, -444.7726163232982, -967.3107097036146, -834.5209096545329, -592.6954914461703, -743.3517432511978, -1317.1506327456118, -1252.4171270647757, -877.108225542693, -402.56598969089725, -838.2514841863789, -398.07430554674556, -82.20095869700441, -293.1818872183965, -925.9513103867421, -1302.2058805436404, -803.8167331184396, -526.7921559842299, -648.7894588905189, -392.7905786439832, -704.3547556648476, -181.09478947905146, -526.88161937762, -1018.256340760193, -1006.2882673594988, -315.83964029157113, -1007.9173611702349, -1091.534867153455, -102.78458018853284, -150.64953682957145, -358.02574280492695, -903.2426809839194, -556.4518657010021, -239.20148978986467, -581.1629277493563, -648.5113701937121, -802.6334561033531, -710.7147174820552, -1029.3523041870872, -1161.471171718562, -832.6431710227498, -665.1016689936909], "episode_lengths": [150, 150, 106, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 68, 150, 43, 150, 46, 150, 128, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 150, 87, 97, 150, 150, 73, 150, 150, 150, 150, 61, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 82, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 60, 75, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-938.6385661345928, -1003.9511288892103, -362.4673494351872, -755.5369823541957, -1074.3094996381687, -1138.9461763107988, -598.4334600016053, -103.1986745744541, -1185.1125269685203, -675.109355648068, -824.7569877511021, -996.4122744560223, -1011.2742629544489, -927.4439448552972, -77.70208034776708, -545.7130716611846, -89.57653982199285, -879.653268627904, -36.29034234855978, -1066.7494380263993, -469.9124021488596, -764.1996660668085, -189.47590758834818, -1278.1589950828113, -779.1889904741003, -1081.290749660564, -475.2789195181837, -1009.0344363087047, -854.109709336408, -873.4899984800579, -1035.093260462058, -1323.9261776597978, -313.9538797457342, -854.8208829950136, -777.6310152809691, -1195.7127720795047, -607.6447594922626, 1.2002144200938403, -387.2085704925185, -485.31090475736084, -583.3848968367743, -607.4365440892744, -765.2095760207071, -963.1205768369791, -123.62453717802806, -368.47755637990315, -495.4183402380056, -1305.346141943645, -225.80633910943163, -677.2796226975817, -568.4667180850369, -1156.4658224268173, -1080.8554700779146, -137.45737656882673, -256.18993613480103, -828.913519184415, -22.103336956561634, -1084.9413363463534, -710.8009086352547, -444.7726163232982, -967.3107097036146, -834.5209096545329, -592.6954914461703, -743.3517432511978, -1317.1506327456118, -1252.4171270647757, -877.108225542693, -402.56598969089725, -838.2514841863789, -398.07430554674556, -82.20095869700441, -293.1818872183965, -925.9513103867421, -1302.2058805436404, -803.8167331184396, -526.7921559842299, -648.7894588905189, -392.7905786439832, -704.3547556648476, -181.09478947905146, -526.88161937762, -1018.256340760193, -1006.2882673594988, -315.83964029157113, -1007.9173611702349, -1091.534867153455, -102.78458018853284, -150.64953682957145, -358.02574280492695, -903.2426809839194, -556.4518657010021, -239.20148978986467, -581.1629277493563, -648.5113701937121, -802.6334561033531, -710.7147174820552, -1029.3523041870872, -1161.471171718562, -832.6431710227498, -665.1016689936909]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581570245787689, "mean_inference_ms": 1.6822585010052118, "mean_action_processing_ms": 0.277925176145397, "mean_env_wait_ms": 3.4502886122871024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012145757675170898, "StateBufferConnector_ms": 0.00830841064453125, "ViewRequirementAgentConnector_ms": 0.19070649147033691}, "num_episodes": 27, "episode_return_max": 1.2002144200938403, "episode_return_min": -1323.9261776597978, "episode_return_mean": -692.448787934055, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.5153086583529, "num_env_steps_trained_throughput_per_sec": 296.5153086583529, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12945.551, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12945.475, "sample_time_ms": 1135.17, "learn_time_ms": 11740.819, "learn_throughput": 340.692, "synch_weights_time_ms": 68.719}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1e132_00007", "date": "2024-08-04_08-41-10", "timestamp": 1722741070, "time_this_iter_s": 13.503711462020874, "time_total_s": 168.16169428825378, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575d990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.16169428825378, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.773684210526316, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.448386716345944, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 7.9975042973955475, "policy_loss": -0.011308658765240882, "vf_loss": 8.004473437865576, "vf_explained_var": 0.769595459724466, "kl": 0.014884863450364112, "entropy": 1.259233236623307, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 1.2002144200938403, "episode_reward_min": -1323.9261776597978, "episode_reward_mean": -691.1432738293073, "episode_len_mean": 136.44, "episode_media": {}, "episodes_timesteps_total": 13644, "policy_reward_min": {"policy_0": -1323.9261776597978}, "policy_reward_max": {"policy_0": 1.2002144200938403}, "policy_reward_mean": {"policy_0": -691.1432738293073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1035.093260462058, -1323.9261776597978, -313.9538797457342, -854.8208829950136, -777.6310152809691, -1195.7127720795047, -607.6447594922626, 1.2002144200938403, -387.2085704925185, -485.31090475736084, -583.3848968367743, -607.4365440892744, -765.2095760207071, -963.1205768369791, -123.62453717802806, -368.47755637990315, -495.4183402380056, -1305.346141943645, -225.80633910943163, -677.2796226975817, -568.4667180850369, -1156.4658224268173, -1080.8554700779146, -137.45737656882673, -256.18993613480103, -828.913519184415, -22.103336956561634, -1084.9413363463534, -710.8009086352547, -444.7726163232982, -967.3107097036146, -834.5209096545329, -592.6954914461703, -743.3517432511978, -1317.1506327456118, -1252.4171270647757, -877.108225542693, -402.56598969089725, -838.2514841863789, -398.07430554674556, -82.20095869700441, -293.1818872183965, -925.9513103867421, -1302.2058805436404, -803.8167331184396, -526.7921559842299, -648.7894588905189, -392.7905786439832, -704.3547556648476, -181.09478947905146, -526.88161937762, -1018.256340760193, -1006.2882673594988, -315.83964029157113, -1007.9173611702349, -1091.534867153455, -102.78458018853284, -150.64953682957145, -358.02574280492695, -903.2426809839194, -556.4518657010021, -239.20148978986467, -581.1629277493563, -648.5113701937121, -802.6334561033531, -710.7147174820552, -1029.3523041870872, -1161.471171718562, -832.6431710227498, -665.1016689936909, -1217.0596385069064, -1020.370184104788, -519.6107344868597, -822.9507294418393, -928.7133058335351, -644.4508693215848, -43.74827158167558, -1162.88734531601, -562.8600377369701, -79.05071656618615, -892.9791818055321, -851.7020722810594, -1080.7735339416715, -665.1646360707962, -1173.3435959858077, -619.7315995456032, -588.5396009178796, -1270.6809101474046, -645.4188457239861, -1045.3323830705967, -55.2203133991709, -449.42861425924224, -237.7011558132852, -1250.8038567494414, -900.8995158235041, -972.3153132781149, -68.98234555119706, -735.399649809279, -844.365305158922, -584.3800327667134], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 150, 87, 97, 150, 150, 73, 150, 150, 150, 150, 61, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 82, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 60, 75, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 112, 150, 150, 150, 56, 150, 150, 150], "policy_policy_0_reward": [-1035.093260462058, -1323.9261776597978, -313.9538797457342, -854.8208829950136, -777.6310152809691, -1195.7127720795047, -607.6447594922626, 1.2002144200938403, -387.2085704925185, -485.31090475736084, -583.3848968367743, -607.4365440892744, -765.2095760207071, -963.1205768369791, -123.62453717802806, -368.47755637990315, -495.4183402380056, -1305.346141943645, -225.80633910943163, -677.2796226975817, -568.4667180850369, -1156.4658224268173, -1080.8554700779146, -137.45737656882673, -256.18993613480103, -828.913519184415, -22.103336956561634, -1084.9413363463534, -710.8009086352547, -444.7726163232982, -967.3107097036146, -834.5209096545329, -592.6954914461703, -743.3517432511978, -1317.1506327456118, -1252.4171270647757, -877.108225542693, -402.56598969089725, -838.2514841863789, -398.07430554674556, -82.20095869700441, -293.1818872183965, -925.9513103867421, -1302.2058805436404, -803.8167331184396, -526.7921559842299, -648.7894588905189, -392.7905786439832, -704.3547556648476, -181.09478947905146, -526.88161937762, -1018.256340760193, -1006.2882673594988, -315.83964029157113, -1007.9173611702349, -1091.534867153455, -102.78458018853284, -150.64953682957145, -358.02574280492695, -903.2426809839194, -556.4518657010021, -239.20148978986467, -581.1629277493563, -648.5113701937121, -802.6334561033531, -710.7147174820552, -1029.3523041870872, -1161.471171718562, -832.6431710227498, -665.1016689936909, -1217.0596385069064, -1020.370184104788, -519.6107344868597, -822.9507294418393, -928.7133058335351, -644.4508693215848, -43.74827158167558, -1162.88734531601, -562.8600377369701, -79.05071656618615, -892.9791818055321, -851.7020722810594, -1080.7735339416715, -665.1646360707962, -1173.3435959858077, -619.7315995456032, -588.5396009178796, -1270.6809101474046, -645.4188457239861, -1045.3323830705967, -55.2203133991709, -449.42861425924224, -237.7011558132852, -1250.8038567494414, -900.8995158235041, -972.3153132781149, -68.98234555119706, -735.399649809279, -844.365305158922, -584.3800327667134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579595954673178, "mean_inference_ms": 1.6801103971706834, "mean_action_processing_ms": 0.2774021760409749, "mean_env_wait_ms": 3.446591505968545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011990547180175781, "StateBufferConnector_ms": 0.008142948150634766, "ViewRequirementAgentConnector_ms": 0.1906442642211914}, "num_episodes": 30, "episode_return_max": 1.2002144200938403, "episode_return_min": -1323.9261776597978, "episode_return_mean": -691.1432738293073, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.59895025360896, "num_env_steps_trained_throughput_per_sec": 311.59895025360896, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12918.46, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12918.383, "sample_time_ms": 1123.768, "learn_time_ms": 11727.025, "learn_throughput": 341.092, "synch_weights_time_ms": 66.833}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1e132_00007", "date": "2024-08-04_08-41-23", "timestamp": 1722741083, "time_this_iter_s": 12.849770545959473, "time_total_s": 181.01146483421326, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 181.01146483421326, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.05, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.96635711739461, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 7.922469533979893, "policy_loss": -0.008872883294437391, "vf_loss": 7.927635851502418, "vf_explained_var": 0.8204804452136158, "kl": 0.0128139005824778, "entropy": 1.3758258911470571, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -10.87627731947039, "episode_reward_min": -1317.1506327456118, "episode_reward_mean": -718.276603360786, "episode_len_mean": 137.56, "episode_media": {}, "episodes_timesteps_total": 13756, "policy_reward_min": {"policy_0": -1317.1506327456118}, "policy_reward_max": {"policy_0": -10.87627731947039}, "policy_reward_mean": {"policy_0": -718.276603360786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-444.7726163232982, -967.3107097036146, -834.5209096545329, -592.6954914461703, -743.3517432511978, -1317.1506327456118, -1252.4171270647757, -877.108225542693, -402.56598969089725, -838.2514841863789, -398.07430554674556, -82.20095869700441, -293.1818872183965, -925.9513103867421, -1302.2058805436404, -803.8167331184396, -526.7921559842299, -648.7894588905189, -392.7905786439832, -704.3547556648476, -181.09478947905146, -526.88161937762, -1018.256340760193, -1006.2882673594988, -315.83964029157113, -1007.9173611702349, -1091.534867153455, -102.78458018853284, -150.64953682957145, -358.02574280492695, -903.2426809839194, -556.4518657010021, -239.20148978986467, -581.1629277493563, -648.5113701937121, -802.6334561033531, -710.7147174820552, -1029.3523041870872, -1161.471171718562, -832.6431710227498, -665.1016689936909, -1217.0596385069064, -1020.370184104788, -519.6107344868597, -822.9507294418393, -928.7133058335351, -644.4508693215848, -43.74827158167558, -1162.88734531601, -562.8600377369701, -79.05071656618615, -892.9791818055321, -851.7020722810594, -1080.7735339416715, -665.1646360707962, -1173.3435959858077, -619.7315995456032, -588.5396009178796, -1270.6809101474046, -645.4188457239861, -1045.3323830705967, -55.2203133991709, -449.42861425924224, -237.7011558132852, -1250.8038567494414, -900.8995158235041, -972.3153132781149, -68.98234555119706, -735.399649809279, -844.365305158922, -584.3800327667134, -892.4540074520215, -1038.7093274050894, -402.8533342318602, -636.7890322767302, -1109.116431498538, -731.8158648085652, -950.0596742972687, -917.1666139812015, -10.87627731947039, -1160.9693089202601, -413.32564902560364, -1162.5028547400007, -949.5069369468448, -25.788221103096994, -1203.500757378496, -683.1699826619225, -1010.4139805684282, -716.8305058701243, -630.3378084687204, -23.56416591354987, -707.0201482783846, -1096.8652720868206, -793.6950273098798, -984.1619461386782, -948.3003416148538, -776.6745538728941, -637.9392457498993, -163.75994825427628, -876.5662992658218], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 82, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 60, 75, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 112, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 63, 150], "policy_policy_0_reward": [-444.7726163232982, -967.3107097036146, -834.5209096545329, -592.6954914461703, -743.3517432511978, -1317.1506327456118, -1252.4171270647757, -877.108225542693, -402.56598969089725, -838.2514841863789, -398.07430554674556, -82.20095869700441, -293.1818872183965, -925.9513103867421, -1302.2058805436404, -803.8167331184396, -526.7921559842299, -648.7894588905189, -392.7905786439832, -704.3547556648476, -181.09478947905146, -526.88161937762, -1018.256340760193, -1006.2882673594988, -315.83964029157113, -1007.9173611702349, -1091.534867153455, -102.78458018853284, -150.64953682957145, -358.02574280492695, -903.2426809839194, -556.4518657010021, -239.20148978986467, -581.1629277493563, -648.5113701937121, -802.6334561033531, -710.7147174820552, -1029.3523041870872, -1161.471171718562, -832.6431710227498, -665.1016689936909, -1217.0596385069064, -1020.370184104788, -519.6107344868597, -822.9507294418393, -928.7133058335351, -644.4508693215848, -43.74827158167558, -1162.88734531601, -562.8600377369701, -79.05071656618615, -892.9791818055321, -851.7020722810594, -1080.7735339416715, -665.1646360707962, -1173.3435959858077, -619.7315995456032, -588.5396009178796, -1270.6809101474046, -645.4188457239861, -1045.3323830705967, -55.2203133991709, -449.42861425924224, -237.7011558132852, -1250.8038567494414, -900.8995158235041, -972.3153132781149, -68.98234555119706, -735.399649809279, -844.365305158922, -584.3800327667134, -892.4540074520215, -1038.7093274050894, -402.8533342318602, -636.7890322767302, -1109.116431498538, -731.8158648085652, -950.0596742972687, -917.1666139812015, -10.87627731947039, -1160.9693089202601, -413.32564902560364, -1162.5028547400007, -949.5069369468448, -25.788221103096994, -1203.500757378496, -683.1699826619225, -1010.4139805684282, -716.8305058701243, -630.3378084687204, -23.56416591354987, -707.0201482783846, -1096.8652720868206, -793.6950273098798, -984.1619461386782, -948.3003416148538, -776.6745538728941, -637.9392457498993, -163.75994825427628, -876.5662992658218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575141349187824, "mean_inference_ms": 1.6768018976380015, "mean_action_processing_ms": 0.2770486185044505, "mean_env_wait_ms": 3.4451863389129667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01206064224243164, "StateBufferConnector_ms": 0.008159875869750977, "ViewRequirementAgentConnector_ms": 0.20115137100219727}, "num_episodes": 29, "episode_return_max": -10.87627731947039, "episode_return_min": -1317.1506327456118, "episode_return_mean": -718.276603360786, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.0801083163397, "num_env_steps_trained_throughput_per_sec": 299.0801083163397, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13005.989, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13005.91, "sample_time_ms": 1139.253, "learn_time_ms": 11799.926, "learn_throughput": 338.985, "synch_weights_time_ms": 65.961}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1e132_00007", "date": "2024-08-04_08-41-37", "timestamp": 1722741097, "time_this_iter_s": 13.38582706451416, "time_total_s": 194.39729189872742, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a72e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.39729189872742, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.475, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.45224183301131, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 7.413635585208734, "policy_loss": -0.00768144862280072, "vf_loss": 7.416182333230973, "vf_explained_var": 0.8491710562879841, "kl": 0.017533240133889207, "entropy": 1.2526596618195376, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -10.87627731947039, "episode_reward_min": -1361.8061474045828, "episode_reward_mean": -720.5755112758742, "episode_len_mean": 135.24, "episode_media": {}, "episodes_timesteps_total": 13524, "policy_reward_min": {"policy_0": -1361.8061474045828}, "policy_reward_max": {"policy_0": -10.87627731947039}, "policy_reward_mean": {"policy_0": -720.5755112758742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-556.4518657010021, -239.20148978986467, -581.1629277493563, -648.5113701937121, -802.6334561033531, -710.7147174820552, -1029.3523041870872, -1161.471171718562, -832.6431710227498, -665.1016689936909, -1217.0596385069064, -1020.370184104788, -519.6107344868597, -822.9507294418393, -928.7133058335351, -644.4508693215848, -43.74827158167558, -1162.88734531601, -562.8600377369701, -79.05071656618615, -892.9791818055321, -851.7020722810594, -1080.7735339416715, -665.1646360707962, -1173.3435959858077, -619.7315995456032, -588.5396009178796, -1270.6809101474046, -645.4188457239861, -1045.3323830705967, -55.2203133991709, -449.42861425924224, -237.7011558132852, -1250.8038567494414, -900.8995158235041, -972.3153132781149, -68.98234555119706, -735.399649809279, -844.365305158922, -584.3800327667134, -892.4540074520215, -1038.7093274050894, -402.8533342318602, -636.7890322767302, -1109.116431498538, -731.8158648085652, -950.0596742972687, -917.1666139812015, -10.87627731947039, -1160.9693089202601, -413.32564902560364, -1162.5028547400007, -949.5069369468448, -25.788221103096994, -1203.500757378496, -683.1699826619225, -1010.4139805684282, -716.8305058701243, -630.3378084687204, -23.56416591354987, -707.0201482783846, -1096.8652720868206, -793.6950273098798, -984.1619461386782, -948.3003416148538, -776.6745538728941, -637.9392457498993, -163.75994825427628, -876.5662992658218, -633.2182627358227, -603.6685164255719, -568.5566333472173, -628.6736078304112, -119.42734978134484, -811.8850279588356, -1048.236572120832, -228.0806114488675, -1296.4756465176802, -1099.0539739620394, -561.2821180613558, -59.06757100865693, -561.6262217000256, -1256.8365890560808, -546.7488747241689, -782.3049393370911, -751.6967312870087, -1215.6931419268174, -109.69346485280433, -87.08217856979164, -789.9084431277539, -229.95253179806645, -978.6166941082848, -90.47044853545434, -677.4591304304254, -1356.9792051983366, -323.83970428750575, -807.4260934102703, -665.0953189628838, -989.8474222951546, -1361.8061474045828], "episode_lengths": [150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 112, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 83, 150, 150, 88, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 73, 71, 150, 81, 150, 64, 150, 150, 84, 150, 150, 150, 150], "policy_policy_0_reward": [-556.4518657010021, -239.20148978986467, -581.1629277493563, -648.5113701937121, -802.6334561033531, -710.7147174820552, -1029.3523041870872, -1161.471171718562, -832.6431710227498, -665.1016689936909, -1217.0596385069064, -1020.370184104788, -519.6107344868597, -822.9507294418393, -928.7133058335351, -644.4508693215848, -43.74827158167558, -1162.88734531601, -562.8600377369701, -79.05071656618615, -892.9791818055321, -851.7020722810594, -1080.7735339416715, -665.1646360707962, -1173.3435959858077, -619.7315995456032, -588.5396009178796, -1270.6809101474046, -645.4188457239861, -1045.3323830705967, -55.2203133991709, -449.42861425924224, -237.7011558132852, -1250.8038567494414, -900.8995158235041, -972.3153132781149, -68.98234555119706, -735.399649809279, -844.365305158922, -584.3800327667134, -892.4540074520215, -1038.7093274050894, -402.8533342318602, -636.7890322767302, -1109.116431498538, -731.8158648085652, -950.0596742972687, -917.1666139812015, -10.87627731947039, -1160.9693089202601, -413.32564902560364, -1162.5028547400007, -949.5069369468448, -25.788221103096994, -1203.500757378496, -683.1699826619225, -1010.4139805684282, -716.8305058701243, -630.3378084687204, -23.56416591354987, -707.0201482783846, -1096.8652720868206, -793.6950273098798, -984.1619461386782, -948.3003416148538, -776.6745538728941, -637.9392457498993, -163.75994825427628, -876.5662992658218, -633.2182627358227, -603.6685164255719, -568.5566333472173, -628.6736078304112, -119.42734978134484, -811.8850279588356, -1048.236572120832, -228.0806114488675, -1296.4756465176802, -1099.0539739620394, -561.2821180613558, -59.06757100865693, -561.6262217000256, -1256.8365890560808, -546.7488747241689, -782.3049393370911, -751.6967312870087, -1215.6931419268174, -109.69346485280433, -87.08217856979164, -789.9084431277539, -229.95253179806645, -978.6166941082848, -90.47044853545434, -677.4591304304254, -1356.9792051983366, -323.83970428750575, -807.4260934102703, -665.0953189628838, -989.8474222951546, -1361.8061474045828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573801478252365, "mean_inference_ms": 1.6770119180218246, "mean_action_processing_ms": 0.27704041564124204, "mean_env_wait_ms": 3.4513057105363094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011869192123413086, "StateBufferConnector_ms": 0.007921218872070312, "ViewRequirementAgentConnector_ms": 0.20261549949645996}, "num_episodes": 31, "episode_return_max": -10.87627731947039, "episode_return_min": -1361.8061474045828, "episode_return_mean": -720.5755112758742, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.19886042516066, "num_env_steps_trained_throughput_per_sec": 323.19886042516066, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12927.48, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12927.398, "sample_time_ms": 1137.904, "learn_time_ms": 11723.672, "learn_throughput": 341.19, "synch_weights_time_ms": 65.049}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1e132_00007", "date": "2024-08-04_08-41-49", "timestamp": 1722741109, "time_this_iter_s": 12.388880491256714, "time_total_s": 206.78617238998413, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456cdc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.78617238998413, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.370588235294118, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.79637575348218, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 7.153444927434126, "policy_loss": -0.01098960009306514, "vf_loss": 7.160193342963854, "vf_explained_var": 0.8824895633384585, "kl": 0.014601003633712632, "entropy": 1.3911681368947029, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -10.87627731947039, "episode_reward_min": -1361.8061474045828, "episode_reward_mean": -707.4396381422706, "episode_len_mean": 133.83, "episode_media": {}, "episodes_timesteps_total": 13383, "policy_reward_min": {"policy_0": -1361.8061474045828}, "policy_reward_max": {"policy_0": -10.87627731947039}, "policy_reward_mean": {"policy_0": -707.4396381422706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1045.3323830705967, -55.2203133991709, -449.42861425924224, -237.7011558132852, -1250.8038567494414, -900.8995158235041, -972.3153132781149, -68.98234555119706, -735.399649809279, -844.365305158922, -584.3800327667134, -892.4540074520215, -1038.7093274050894, -402.8533342318602, -636.7890322767302, -1109.116431498538, -731.8158648085652, -950.0596742972687, -917.1666139812015, -10.87627731947039, -1160.9693089202601, -413.32564902560364, -1162.5028547400007, -949.5069369468448, -25.788221103096994, -1203.500757378496, -683.1699826619225, -1010.4139805684282, -716.8305058701243, -630.3378084687204, -23.56416591354987, -707.0201482783846, -1096.8652720868206, -793.6950273098798, -984.1619461386782, -948.3003416148538, -776.6745538728941, -637.9392457498993, -163.75994825427628, -876.5662992658218, -633.2182627358227, -603.6685164255719, -568.5566333472173, -628.6736078304112, -119.42734978134484, -811.8850279588356, -1048.236572120832, -228.0806114488675, -1296.4756465176802, -1099.0539739620394, -561.2821180613558, -59.06757100865693, -561.6262217000256, -1256.8365890560808, -546.7488747241689, -782.3049393370911, -751.6967312870087, -1215.6931419268174, -109.69346485280433, -87.08217856979164, -789.9084431277539, -229.95253179806645, -978.6166941082848, -90.47044853545434, -677.4591304304254, -1356.9792051983366, -323.83970428750575, -807.4260934102703, -665.0953189628838, -989.8474222951546, -1361.8061474045828, -1110.7880114447858, -1122.5385190660286, -1181.581908618878, -853.250663394861, -1246.3839407338057, -1126.4207617767947, -447.5329955251673, -467.8798213040691, -880.9458690087889, -29.018574973165887, -1058.9890556198088, -84.87718457679154, -988.0040523888674, -450.48018917288357, -908.263433092148, -300.9550161434713, -635.193827354488, -1092.5562262817534, -573.7292104885432, -863.231272411562, -571.3857802568333, -514.2115095552274, -40.2974874333291, -1310.4466477155345, -369.0414758299334, -469.39537731195446, -1171.9417748912647, -360.99749082317936, -473.35456170322493], "episode_lengths": [150, 44, 150, 112, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 83, 150, 150, 88, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 73, 71, 150, 81, 150, 64, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 45, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1045.3323830705967, -55.2203133991709, -449.42861425924224, -237.7011558132852, -1250.8038567494414, -900.8995158235041, -972.3153132781149, -68.98234555119706, -735.399649809279, -844.365305158922, -584.3800327667134, -892.4540074520215, -1038.7093274050894, -402.8533342318602, -636.7890322767302, -1109.116431498538, -731.8158648085652, -950.0596742972687, -917.1666139812015, -10.87627731947039, -1160.9693089202601, -413.32564902560364, -1162.5028547400007, -949.5069369468448, -25.788221103096994, -1203.500757378496, -683.1699826619225, -1010.4139805684282, -716.8305058701243, -630.3378084687204, -23.56416591354987, -707.0201482783846, -1096.8652720868206, -793.6950273098798, -984.1619461386782, -948.3003416148538, -776.6745538728941, -637.9392457498993, -163.75994825427628, -876.5662992658218, -633.2182627358227, -603.6685164255719, -568.5566333472173, -628.6736078304112, -119.42734978134484, -811.8850279588356, -1048.236572120832, -228.0806114488675, -1296.4756465176802, -1099.0539739620394, -561.2821180613558, -59.06757100865693, -561.6262217000256, -1256.8365890560808, -546.7488747241689, -782.3049393370911, -751.6967312870087, -1215.6931419268174, -109.69346485280433, -87.08217856979164, -789.9084431277539, -229.95253179806645, -978.6166941082848, -90.47044853545434, -677.4591304304254, -1356.9792051983366, -323.83970428750575, -807.4260934102703, -665.0953189628838, -989.8474222951546, -1361.8061474045828, -1110.7880114447858, -1122.5385190660286, -1181.581908618878, -853.250663394861, -1246.3839407338057, -1126.4207617767947, -447.5329955251673, -467.8798213040691, -880.9458690087889, -29.018574973165887, -1058.9890556198088, -84.87718457679154, -988.0040523888674, -450.48018917288357, -908.263433092148, -300.9550161434713, -635.193827354488, -1092.5562262817534, -573.7292104885432, -863.231272411562, -571.3857802568333, -514.2115095552274, -40.2974874333291, -1310.4466477155345, -369.0414758299334, -469.39537731195446, -1171.9417748912647, -360.99749082317936, -473.35456170322493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575105056515023, "mean_inference_ms": 1.6754085338651779, "mean_action_processing_ms": 0.2768387800803028, "mean_env_wait_ms": 3.4512559378862244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0122528076171875, "StateBufferConnector_ms": 0.008033037185668945, "ViewRequirementAgentConnector_ms": 0.2036452293395996}, "num_episodes": 29, "episode_return_max": -10.87627731947039, "episode_return_min": -1361.8061474045828, "episode_return_mean": -707.4396381422706, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.61187883853637, "num_env_steps_trained_throughput_per_sec": 324.61187883853637, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12838.214, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12838.132, "sample_time_ms": 1126.914, "learn_time_ms": 11646.514, "learn_throughput": 343.45, "synch_weights_time_ms": 63.931}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1e132_00007", "date": "2024-08-04_08-42-01", "timestamp": 1722741121, "time_this_iter_s": 12.337471008300781, "time_total_s": 219.1236433982849, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456d120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.1236433982849, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.1, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.1090845366319, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 6.211558806399505, "policy_loss": -0.019404257720937797, "vf_loss": 6.2258579030632974, "vf_explained_var": 0.912906687396268, "kl": 0.017390173155066215, "entropy": 1.1189380291849376, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -23.56416591354987, "episode_reward_min": -1361.8061474045828, "episode_reward_mean": -694.6815570274488, "episode_len_mean": 135.72, "episode_media": {}, "episodes_timesteps_total": 13572, "policy_reward_min": {"policy_0": -1361.8061474045828}, "policy_reward_max": {"policy_0": -23.56416591354987}, "policy_reward_mean": {"policy_0": -694.6815570274488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-683.1699826619225, -1010.4139805684282, -716.8305058701243, -630.3378084687204, -23.56416591354987, -707.0201482783846, -1096.8652720868206, -793.6950273098798, -984.1619461386782, -948.3003416148538, -776.6745538728941, -637.9392457498993, -163.75994825427628, -876.5662992658218, -633.2182627358227, -603.6685164255719, -568.5566333472173, -628.6736078304112, -119.42734978134484, -811.8850279588356, -1048.236572120832, -228.0806114488675, -1296.4756465176802, -1099.0539739620394, -561.2821180613558, -59.06757100865693, -561.6262217000256, -1256.8365890560808, -546.7488747241689, -782.3049393370911, -751.6967312870087, -1215.6931419268174, -109.69346485280433, -87.08217856979164, -789.9084431277539, -229.95253179806645, -978.6166941082848, -90.47044853545434, -677.4591304304254, -1356.9792051983366, -323.83970428750575, -807.4260934102703, -665.0953189628838, -989.8474222951546, -1361.8061474045828, -1110.7880114447858, -1122.5385190660286, -1181.581908618878, -853.250663394861, -1246.3839407338057, -1126.4207617767947, -447.5329955251673, -467.8798213040691, -880.9458690087889, -29.018574973165887, -1058.9890556198088, -84.87718457679154, -988.0040523888674, -450.48018917288357, -908.263433092148, -300.9550161434713, -635.193827354488, -1092.5562262817534, -573.7292104885432, -863.231272411562, -571.3857802568333, -514.2115095552274, -40.2974874333291, -1310.4466477155345, -369.0414758299334, -469.39537731195446, -1171.9417748912647, -360.99749082317936, -473.35456170322493, -637.9971526240555, -451.6808043333249, -787.1486391947916, -1245.1783408368103, -1277.3109013519431, -540.1403384042762, -342.3079301107424, -612.0734049357382, -1164.6536451578363, -311.8882129793013, -1018.5510111500967, -142.31915310738668, -82.02759832740855, -1128.3146713137687, -403.3502256736428, -1157.3363622153338, -125.61836483069042, -590.735731468227, -1228.7727746167336, -514.8665720925816, -952.8331251694067, -336.6615079283716, -248.79712033317915, -1022.8459665989113, -444.51477281122493, -706.5303380165356], "episode_lengths": [150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 83, 150, 150, 88, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 73, 71, 150, 81, 150, 64, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 45, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 70, 150, 150, 150, 79, 150, 150, 150, 150, 150, 108, 150, 150, 150], "policy_policy_0_reward": [-683.1699826619225, -1010.4139805684282, -716.8305058701243, -630.3378084687204, -23.56416591354987, -707.0201482783846, -1096.8652720868206, -793.6950273098798, -984.1619461386782, -948.3003416148538, -776.6745538728941, -637.9392457498993, -163.75994825427628, -876.5662992658218, -633.2182627358227, -603.6685164255719, -568.5566333472173, -628.6736078304112, -119.42734978134484, -811.8850279588356, -1048.236572120832, -228.0806114488675, -1296.4756465176802, -1099.0539739620394, -561.2821180613558, -59.06757100865693, -561.6262217000256, -1256.8365890560808, -546.7488747241689, -782.3049393370911, -751.6967312870087, -1215.6931419268174, -109.69346485280433, -87.08217856979164, -789.9084431277539, -229.95253179806645, -978.6166941082848, -90.47044853545434, -677.4591304304254, -1356.9792051983366, -323.83970428750575, -807.4260934102703, -665.0953189628838, -989.8474222951546, -1361.8061474045828, -1110.7880114447858, -1122.5385190660286, -1181.581908618878, -853.250663394861, -1246.3839407338057, -1126.4207617767947, -447.5329955251673, -467.8798213040691, -880.9458690087889, -29.018574973165887, -1058.9890556198088, -84.87718457679154, -988.0040523888674, -450.48018917288357, -908.263433092148, -300.9550161434713, -635.193827354488, -1092.5562262817534, -573.7292104885432, -863.231272411562, -571.3857802568333, -514.2115095552274, -40.2974874333291, -1310.4466477155345, -369.0414758299334, -469.39537731195446, -1171.9417748912647, -360.99749082317936, -473.35456170322493, -637.9971526240555, -451.6808043333249, -787.1486391947916, -1245.1783408368103, -1277.3109013519431, -540.1403384042762, -342.3079301107424, -612.0734049357382, -1164.6536451578363, -311.8882129793013, -1018.5510111500967, -142.31915310738668, -82.02759832740855, -1128.3146713137687, -403.3502256736428, -1157.3363622153338, -125.61836483069042, -590.735731468227, -1228.7727746167336, -514.8665720925816, -952.8331251694067, -336.6615079283716, -248.79712033317915, -1022.8459665989113, -444.51477281122493, -706.5303380165356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566000073893709, "mean_inference_ms": 1.6767978001800015, "mean_action_processing_ms": 0.27703031677813944, "mean_env_wait_ms": 3.455097846662417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01239919662475586, "StateBufferConnector_ms": 0.008275985717773438, "ViewRequirementAgentConnector_ms": 0.20646429061889648}, "num_episodes": 26, "episode_return_max": -23.56416591354987, "episode_return_min": -1361.8061474045828, "episode_return_mean": -694.6815570274488, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.37993181756457, "num_env_steps_trained_throughput_per_sec": 310.37993181756457, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12808.066, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12807.984, "sample_time_ms": 1134.254, "learn_time_ms": 11609.625, "learn_throughput": 344.542, "synch_weights_time_ms": 63.332}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1e132_00007", "date": "2024-08-04_08-42-14", "timestamp": 1722741134, "time_this_iter_s": 12.899839639663696, "time_total_s": 232.0234830379486, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456e7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.0234830379486, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.47222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 61.5675470183293, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 7.027819742262364, "policy_loss": -0.0067145675163677275, "vf_loss": 7.030367129544417, "vf_explained_var": 0.8975704829518993, "kl": 0.01438873836453545, "entropy": 1.4943544040123622, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -29.018574973165887, "episode_reward_min": -1421.626053661035, "episode_reward_mean": -683.649737540211, "episode_len_mean": 135.84, "episode_media": {}, "episodes_timesteps_total": 13584, "policy_reward_min": {"policy_0": -1421.626053661035}, "policy_reward_max": {"policy_0": -29.018574973165887}, "policy_reward_mean": {"policy_0": -683.649737540211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-789.9084431277539, -229.95253179806645, -978.6166941082848, -90.47044853545434, -677.4591304304254, -1356.9792051983366, -323.83970428750575, -807.4260934102703, -665.0953189628838, -989.8474222951546, -1361.8061474045828, -1110.7880114447858, -1122.5385190660286, -1181.581908618878, -853.250663394861, -1246.3839407338057, -1126.4207617767947, -447.5329955251673, -467.8798213040691, -880.9458690087889, -29.018574973165887, -1058.9890556198088, -84.87718457679154, -988.0040523888674, -450.48018917288357, -908.263433092148, -300.9550161434713, -635.193827354488, -1092.5562262817534, -573.7292104885432, -863.231272411562, -571.3857802568333, -514.2115095552274, -40.2974874333291, -1310.4466477155345, -369.0414758299334, -469.39537731195446, -1171.9417748912647, -360.99749082317936, -473.35456170322493, -637.9971526240555, -451.6808043333249, -787.1486391947916, -1245.1783408368103, -1277.3109013519431, -540.1403384042762, -342.3079301107424, -612.0734049357382, -1164.6536451578363, -311.8882129793013, -1018.5510111500967, -142.31915310738668, -82.02759832740855, -1128.3146713137687, -403.3502256736428, -1157.3363622153338, -125.61836483069042, -590.735731468227, -1228.7727746167336, -514.8665720925816, -952.8331251694067, -336.6615079283716, -248.79712033317915, -1022.8459665989113, -444.51477281122493, -706.5303380165356, -1375.919843186772, -708.3482224199943, -430.09539467025775, -624.750147992631, -125.65859578527562, -408.7769924546398, -498.14426736454186, -156.11746870364598, -460.75359003938365, -446.79732305424756, -828.3526847240225, -434.02272223970033, -475.03618001541054, -1421.626053661035, -796.7576420648376, -182.97868749522505, -535.9405483113609, -1220.8013243228047, -103.85796888358367, -688.903959565215, -714.1185234718281, -600.7640078289651, -1086.3531680956432, -162.8919626053537, -58.01345030086355, -779.3143505362682, -43.04382614506001, -1045.5929013701086, -997.4555982843426, -1213.44239963131, -1060.557504455556, -423.0193585161669, -1045.6764486086706, -761.5421931781998], "episode_lengths": [150, 81, 150, 64, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 45, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 70, 150, 150, 150, 79, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 59, 150, 150, 150, 150, 65, 50, 150, 60, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-789.9084431277539, -229.95253179806645, -978.6166941082848, -90.47044853545434, -677.4591304304254, -1356.9792051983366, -323.83970428750575, -807.4260934102703, -665.0953189628838, -989.8474222951546, -1361.8061474045828, -1110.7880114447858, -1122.5385190660286, -1181.581908618878, -853.250663394861, -1246.3839407338057, -1126.4207617767947, -447.5329955251673, -467.8798213040691, -880.9458690087889, -29.018574973165887, -1058.9890556198088, -84.87718457679154, -988.0040523888674, -450.48018917288357, -908.263433092148, -300.9550161434713, -635.193827354488, -1092.5562262817534, -573.7292104885432, -863.231272411562, -571.3857802568333, -514.2115095552274, -40.2974874333291, -1310.4466477155345, -369.0414758299334, -469.39537731195446, -1171.9417748912647, -360.99749082317936, -473.35456170322493, -637.9971526240555, -451.6808043333249, -787.1486391947916, -1245.1783408368103, -1277.3109013519431, -540.1403384042762, -342.3079301107424, -612.0734049357382, -1164.6536451578363, -311.8882129793013, -1018.5510111500967, -142.31915310738668, -82.02759832740855, -1128.3146713137687, -403.3502256736428, -1157.3363622153338, -125.61836483069042, -590.735731468227, -1228.7727746167336, -514.8665720925816, -952.8331251694067, -336.6615079283716, -248.79712033317915, -1022.8459665989113, -444.51477281122493, -706.5303380165356, -1375.919843186772, -708.3482224199943, -430.09539467025775, -624.750147992631, -125.65859578527562, -408.7769924546398, -498.14426736454186, -156.11746870364598, -460.75359003938365, -446.79732305424756, -828.3526847240225, -434.02272223970033, -475.03618001541054, -1421.626053661035, -796.7576420648376, -182.97868749522505, -535.9405483113609, -1220.8013243228047, -103.85796888358367, -688.903959565215, -714.1185234718281, -600.7640078289651, -1086.3531680956432, -162.8919626053537, -58.01345030086355, -779.3143505362682, -43.04382614506001, -1045.5929013701086, -997.4555982843426, -1213.44239963131, -1060.557504455556, -423.0193585161669, -1045.6764486086706, -761.5421931781998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577863910882632, "mean_inference_ms": 1.6764606444603765, "mean_action_processing_ms": 0.27687195897204825, "mean_env_wait_ms": 3.4574549001358825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012804031372070312, "StateBufferConnector_ms": 0.008306264877319336, "ViewRequirementAgentConnector_ms": 0.1971426010131836}, "num_episodes": 34, "episode_return_max": -29.018574973165887, "episode_return_min": -1421.626053661035, "episode_return_mean": -683.649737540211, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.33784596012265, "num_env_steps_trained_throughput_per_sec": 304.33784596012265, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12846.814, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12846.735, "sample_time_ms": 1136.549, "learn_time_ms": 11645.276, "learn_throughput": 343.487, "synch_weights_time_ms": 64.103}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1e132_00007", "date": "2024-08-04_08-42-28", "timestamp": 1722741148, "time_this_iter_s": 13.15544319152832, "time_total_s": 245.17892622947693, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a5d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.17892622947693, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.784210526315793, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 86.16357852518559, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 6.406351894636949, "policy_loss": -0.009448845194613871, "vf_loss": 6.411311913530032, "vf_explained_var": 0.8934941006203493, "kl": 0.01541207331192711, "entropy": 1.3480091366296014, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -23.38493693264942, "episode_reward_min": -1421.626053661035, "episode_reward_mean": -671.0931542785013, "episode_len_mean": 136.94, "episode_media": {}, "episodes_timesteps_total": 13694, "policy_reward_min": {"policy_0": -1421.626053661035}, "policy_reward_max": {"policy_0": -23.38493693264942}, "policy_reward_mean": {"policy_0": -671.0931542785013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-863.231272411562, -571.3857802568333, -514.2115095552274, -40.2974874333291, -1310.4466477155345, -369.0414758299334, -469.39537731195446, -1171.9417748912647, -360.99749082317936, -473.35456170322493, -637.9971526240555, -451.6808043333249, -787.1486391947916, -1245.1783408368103, -1277.3109013519431, -540.1403384042762, -342.3079301107424, -612.0734049357382, -1164.6536451578363, -311.8882129793013, -1018.5510111500967, -142.31915310738668, -82.02759832740855, -1128.3146713137687, -403.3502256736428, -1157.3363622153338, -125.61836483069042, -590.735731468227, -1228.7727746167336, -514.8665720925816, -952.8331251694067, -336.6615079283716, -248.79712033317915, -1022.8459665989113, -444.51477281122493, -706.5303380165356, -1375.919843186772, -708.3482224199943, -430.09539467025775, -624.750147992631, -125.65859578527562, -408.7769924546398, -498.14426736454186, -156.11746870364598, -460.75359003938365, -446.79732305424756, -828.3526847240225, -434.02272223970033, -475.03618001541054, -1421.626053661035, -796.7576420648376, -182.97868749522505, -535.9405483113609, -1220.8013243228047, -103.85796888358367, -688.903959565215, -714.1185234718281, -600.7640078289651, -1086.3531680956432, -162.8919626053537, -58.01345030086355, -779.3143505362682, -43.04382614506001, -1045.5929013701086, -997.4555982843426, -1213.44239963131, -1060.557504455556, -423.0193585161669, -1045.6764486086706, -761.5421931781998, -476.2307255498263, -278.46203782898493, -384.176482216687, -1315.4599893640186, -545.2407436799231, -1315.4533433170523, -490.9813339292831, -900.2389210599883, -468.30349808263566, -661.1775998865508, -508.59316925994483, -987.4145063464451, -186.68966338065482, -611.2266309265065, -512.0812449764747, -1168.4137044909726, -542.015864378738, -1217.3786592788385, -23.38493693264942, -117.89640423661744, -1199.8849745889274, -1370.7242583830525, -1301.2961051849443, -331.10047001182136, -1369.30543712294, -266.2423672333631, -944.147009096634, -872.1659185733987, -885.181701165278, -324.2643738696899], "episode_lengths": [150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 70, 150, 150, 150, 79, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 59, 150, 150, 150, 150, 65, 50, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 42, 66, 150, 150, 150, 150, 150, 126, 150, 150, 150, 97], "policy_policy_0_reward": [-863.231272411562, -571.3857802568333, -514.2115095552274, -40.2974874333291, -1310.4466477155345, -369.0414758299334, -469.39537731195446, -1171.9417748912647, -360.99749082317936, -473.35456170322493, -637.9971526240555, -451.6808043333249, -787.1486391947916, -1245.1783408368103, -1277.3109013519431, -540.1403384042762, -342.3079301107424, -612.0734049357382, -1164.6536451578363, -311.8882129793013, -1018.5510111500967, -142.31915310738668, -82.02759832740855, -1128.3146713137687, -403.3502256736428, -1157.3363622153338, -125.61836483069042, -590.735731468227, -1228.7727746167336, -514.8665720925816, -952.8331251694067, -336.6615079283716, -248.79712033317915, -1022.8459665989113, -444.51477281122493, -706.5303380165356, -1375.919843186772, -708.3482224199943, -430.09539467025775, -624.750147992631, -125.65859578527562, -408.7769924546398, -498.14426736454186, -156.11746870364598, -460.75359003938365, -446.79732305424756, -828.3526847240225, -434.02272223970033, -475.03618001541054, -1421.626053661035, -796.7576420648376, -182.97868749522505, -535.9405483113609, -1220.8013243228047, -103.85796888358367, -688.903959565215, -714.1185234718281, -600.7640078289651, -1086.3531680956432, -162.8919626053537, -58.01345030086355, -779.3143505362682, -43.04382614506001, -1045.5929013701086, -997.4555982843426, -1213.44239963131, -1060.557504455556, -423.0193585161669, -1045.6764486086706, -761.5421931781998, -476.2307255498263, -278.46203782898493, -384.176482216687, -1315.4599893640186, -545.2407436799231, -1315.4533433170523, -490.9813339292831, -900.2389210599883, -468.30349808263566, -661.1775998865508, -508.59316925994483, -987.4145063464451, -186.68966338065482, -611.2266309265065, -512.0812449764747, -1168.4137044909726, -542.015864378738, -1217.3786592788385, -23.38493693264942, -117.89640423661744, -1199.8849745889274, -1370.7242583830525, -1301.2961051849443, -331.10047001182136, -1369.30543712294, -266.2423672333631, -944.147009096634, -872.1659185733987, -885.181701165278, -324.2643738696899]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575553515077695, "mean_inference_ms": 1.6762312251642009, "mean_action_processing_ms": 0.27664649398784, "mean_env_wait_ms": 3.457638080385971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01592111587524414, "StateBufferConnector_ms": 0.00884103775024414, "ViewRequirementAgentConnector_ms": 0.1964857578277588}, "num_episodes": 30, "episode_return_max": -23.38493693264942, "episode_return_min": -1421.626053661035, "episode_return_mean": -671.0931542785013, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.92907554999516, "num_env_steps_trained_throughput_per_sec": 332.92907554999516, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12818.056, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12817.977, "sample_time_ms": 1135.383, "learn_time_ms": 11618.244, "learn_throughput": 344.286, "synch_weights_time_ms": 63.538}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1e132_00007", "date": "2024-08-04_08-42-40", "timestamp": 1722741160, "time_this_iter_s": 12.027009725570679, "time_total_s": 257.2059359550476, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ae4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.2059359550476, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.50588235294118, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.69393595258394, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 6.374423762659232, "policy_loss": -0.012653155968291686, "vf_loss": 6.382786989460389, "vf_explained_var": 0.9234671941027045, "kl": 0.01468060782439885, "entropy": 1.1425177184864879, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -23.38493693264942, "episode_reward_min": -1421.626053661035, "episode_reward_mean": -644.3718507356277, "episode_len_mean": 133.72, "episode_media": {}, "episodes_timesteps_total": 13372, "policy_reward_min": {"policy_0": -1421.626053661035}, "policy_reward_max": {"policy_0": -23.38493693264942}, "policy_reward_mean": {"policy_0": -644.3718507356277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-952.8331251694067, -336.6615079283716, -248.79712033317915, -1022.8459665989113, -444.51477281122493, -706.5303380165356, -1375.919843186772, -708.3482224199943, -430.09539467025775, -624.750147992631, -125.65859578527562, -408.7769924546398, -498.14426736454186, -156.11746870364598, -460.75359003938365, -446.79732305424756, -828.3526847240225, -434.02272223970033, -475.03618001541054, -1421.626053661035, -796.7576420648376, -182.97868749522505, -535.9405483113609, -1220.8013243228047, -103.85796888358367, -688.903959565215, -714.1185234718281, -600.7640078289651, -1086.3531680956432, -162.8919626053537, -58.01345030086355, -779.3143505362682, -43.04382614506001, -1045.5929013701086, -997.4555982843426, -1213.44239963131, -1060.557504455556, -423.0193585161669, -1045.6764486086706, -761.5421931781998, -476.2307255498263, -278.46203782898493, -384.176482216687, -1315.4599893640186, -545.2407436799231, -1315.4533433170523, -490.9813339292831, -900.2389210599883, -468.30349808263566, -661.1775998865508, -508.59316925994483, -987.4145063464451, -186.68966338065482, -611.2266309265065, -512.0812449764747, -1168.4137044909726, -542.015864378738, -1217.3786592788385, -23.38493693264942, -117.89640423661744, -1199.8849745889274, -1370.7242583830525, -1301.2961051849443, -331.10047001182136, -1369.30543712294, -266.2423672333631, -944.147009096634, -872.1659185733987, -885.181701165278, -324.2643738696899, -478.15662653175485, -1027.9913648179827, -784.7215383922153, -619.5725749368805, -902.4607059406243, -87.00675844774662, -551.2174648725777, -655.2123240261368, -1384.1530744724068, -259.51846525539077, -87.10467267640372, -588.7896245551888, -993.8927202886848, -390.8698580899533, -748.7462730978892, -582.3895798523401, -1192.8172037596871, -794.5045862533887, -96.37119343372814, -1097.964336996009, -502.9300669572082, -954.240527415339, -55.60776828174077, -437.3506308638057, -519.5337832346805, -591.0335060548608, -374.4700350334342, -36.98242384981093, -225.54624519503898, -213.2889247864815], "episode_lengths": [150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 59, 150, 150, 150, 150, 65, 50, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 42, 66, 150, 150, 150, 150, 150, 126, 150, 150, 150, 97, 150, 150, 150, 150, 150, 77, 150, 150, 150, 119, 69, 115, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 61, 150, 150, 150, 108, 56, 106, 95], "policy_policy_0_reward": [-952.8331251694067, -336.6615079283716, -248.79712033317915, -1022.8459665989113, -444.51477281122493, -706.5303380165356, -1375.919843186772, -708.3482224199943, -430.09539467025775, -624.750147992631, -125.65859578527562, -408.7769924546398, -498.14426736454186, -156.11746870364598, -460.75359003938365, -446.79732305424756, -828.3526847240225, -434.02272223970033, -475.03618001541054, -1421.626053661035, -796.7576420648376, -182.97868749522505, -535.9405483113609, -1220.8013243228047, -103.85796888358367, -688.903959565215, -714.1185234718281, -600.7640078289651, -1086.3531680956432, -162.8919626053537, -58.01345030086355, -779.3143505362682, -43.04382614506001, -1045.5929013701086, -997.4555982843426, -1213.44239963131, -1060.557504455556, -423.0193585161669, -1045.6764486086706, -761.5421931781998, -476.2307255498263, -278.46203782898493, -384.176482216687, -1315.4599893640186, -545.2407436799231, -1315.4533433170523, -490.9813339292831, -900.2389210599883, -468.30349808263566, -661.1775998865508, -508.59316925994483, -987.4145063464451, -186.68966338065482, -611.2266309265065, -512.0812449764747, -1168.4137044909726, -542.015864378738, -1217.3786592788385, -23.38493693264942, -117.89640423661744, -1199.8849745889274, -1370.7242583830525, -1301.2961051849443, -331.10047001182136, -1369.30543712294, -266.2423672333631, -944.147009096634, -872.1659185733987, -885.181701165278, -324.2643738696899, -478.15662653175485, -1027.9913648179827, -784.7215383922153, -619.5725749368805, -902.4607059406243, -87.00675844774662, -551.2174648725777, -655.2123240261368, -1384.1530744724068, -259.51846525539077, -87.10467267640372, -588.7896245551888, -993.8927202886848, -390.8698580899533, -748.7462730978892, -582.3895798523401, -1192.8172037596871, -794.5045862533887, -96.37119343372814, -1097.964336996009, -502.9300669572082, -954.240527415339, -55.60776828174077, -437.3506308638057, -519.5337832346805, -591.0335060548608, -374.4700350334342, -36.98242384981093, -225.54624519503898, -213.2889247864815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572954143295721, "mean_inference_ms": 1.6762234469487758, "mean_action_processing_ms": 0.27667073756889854, "mean_env_wait_ms": 3.458795602733872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015644311904907227, "StateBufferConnector_ms": 0.008659124374389648, "ViewRequirementAgentConnector_ms": 0.1945512294769287}, "num_episodes": 30, "episode_return_max": -23.38493693264942, "episode_return_min": -1421.626053661035, "episode_return_mean": -644.3718507356277, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.59758452192256, "num_env_steps_trained_throughput_per_sec": 307.59758452192256, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12833.189, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12833.11, "sample_time_ms": 1135.091, "learn_time_ms": 11634.969, "learn_throughput": 343.791, "synch_weights_time_ms": 62.24}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1e132_00007", "date": "2024-08-04_08-42-53", "timestamp": 1722741173, "time_this_iter_s": 13.01606822013855, "time_total_s": 270.22200417518616, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456e680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.22200417518616, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.857894736842105, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 86.49317589302858, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 6.247973548869292, "policy_loss": -0.01054866193056417, "vf_loss": 6.254542024930318, "vf_explained_var": 0.914370734989643, "kl": 0.013661198344955968, "entropy": 1.1817659735058745, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -23.38493693264942, "episode_reward_min": -1483.540182717846, "episode_reward_mean": -678.2885595290668, "episode_len_mean": 134.95, "episode_media": {}, "episodes_timesteps_total": 13495, "policy_reward_min": {"policy_0": -1483.540182717846}, "policy_reward_max": {"policy_0": -23.38493693264942}, "policy_reward_mean": {"policy_0": -678.2885595290668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-162.8919626053537, -58.01345030086355, -779.3143505362682, -43.04382614506001, -1045.5929013701086, -997.4555982843426, -1213.44239963131, -1060.557504455556, -423.0193585161669, -1045.6764486086706, -761.5421931781998, -476.2307255498263, -278.46203782898493, -384.176482216687, -1315.4599893640186, -545.2407436799231, -1315.4533433170523, -490.9813339292831, -900.2389210599883, -468.30349808263566, -661.1775998865508, -508.59316925994483, -987.4145063464451, -186.68966338065482, -611.2266309265065, -512.0812449764747, -1168.4137044909726, -542.015864378738, -1217.3786592788385, -23.38493693264942, -117.89640423661744, -1199.8849745889274, -1370.7242583830525, -1301.2961051849443, -331.10047001182136, -1369.30543712294, -266.2423672333631, -944.147009096634, -872.1659185733987, -885.181701165278, -324.2643738696899, -478.15662653175485, -1027.9913648179827, -784.7215383922153, -619.5725749368805, -902.4607059406243, -87.00675844774662, -551.2174648725777, -655.2123240261368, -1384.1530744724068, -259.51846525539077, -87.10467267640372, -588.7896245551888, -993.8927202886848, -390.8698580899533, -748.7462730978892, -582.3895798523401, -1192.8172037596871, -794.5045862533887, -96.37119343372814, -1097.964336996009, -502.9300669572082, -954.240527415339, -55.60776828174077, -437.3506308638057, -519.5337832346805, -591.0335060548608, -374.4700350334342, -36.98242384981093, -225.54624519503898, -213.2889247864815, -491.63445448361887, -599.038169056255, -521.9057098992062, -415.14752472407133, -1286.2236327681926, -1483.540182717846, -813.5517743746209, -753.657214812976, -1107.8559542431913, -1392.1139474111926, -603.5269519931201, -1270.4758724903686, -87.02990235146454, -711.751324545309, -1405.733728372627, -405.92097985412704, -671.5904159449514, -339.79144817192304, -1253.1203878535075, -967.2965787893293, -313.3203010198592, -161.1636219962747, -1176.921686443921, -528.9400341232156, -483.9164369541198, -556.468583348443, -634.7373102589363, -508.6735962204842, -483.6813013294202], "episode_lengths": [65, 50, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 42, 66, 150, 150, 150, 150, 150, 126, 150, 150, 150, 97, 150, 150, 150, 150, 150, 77, 150, 150, 150, 119, 69, 115, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 61, 150, 150, 150, 108, 56, 106, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 122, 150, 150, 150, 150, 124, 92, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-162.8919626053537, -58.01345030086355, -779.3143505362682, -43.04382614506001, -1045.5929013701086, -997.4555982843426, -1213.44239963131, -1060.557504455556, -423.0193585161669, -1045.6764486086706, -761.5421931781998, -476.2307255498263, -278.46203782898493, -384.176482216687, -1315.4599893640186, -545.2407436799231, -1315.4533433170523, -490.9813339292831, -900.2389210599883, -468.30349808263566, -661.1775998865508, -508.59316925994483, -987.4145063464451, -186.68966338065482, -611.2266309265065, -512.0812449764747, -1168.4137044909726, -542.015864378738, -1217.3786592788385, -23.38493693264942, -117.89640423661744, -1199.8849745889274, -1370.7242583830525, -1301.2961051849443, -331.10047001182136, -1369.30543712294, -266.2423672333631, -944.147009096634, -872.1659185733987, -885.181701165278, -324.2643738696899, -478.15662653175485, -1027.9913648179827, -784.7215383922153, -619.5725749368805, -902.4607059406243, -87.00675844774662, -551.2174648725777, -655.2123240261368, -1384.1530744724068, -259.51846525539077, -87.10467267640372, -588.7896245551888, -993.8927202886848, -390.8698580899533, -748.7462730978892, -582.3895798523401, -1192.8172037596871, -794.5045862533887, -96.37119343372814, -1097.964336996009, -502.9300669572082, -954.240527415339, -55.60776828174077, -437.3506308638057, -519.5337832346805, -591.0335060548608, -374.4700350334342, -36.98242384981093, -225.54624519503898, -213.2889247864815, -491.63445448361887, -599.038169056255, -521.9057098992062, -415.14752472407133, -1286.2236327681926, -1483.540182717846, -813.5517743746209, -753.657214812976, -1107.8559542431913, -1392.1139474111926, -603.5269519931201, -1270.4758724903686, -87.02990235146454, -711.751324545309, -1405.733728372627, -405.92097985412704, -671.5904159449514, -339.79144817192304, -1253.1203878535075, -967.2965787893293, -313.3203010198592, -161.1636219962747, -1176.921686443921, -528.9400341232156, -483.9164369541198, -556.468583348443, -634.7373102589363, -508.6735962204842, -483.6813013294202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567698122377628, "mean_inference_ms": 1.6757376327519944, "mean_action_processing_ms": 0.27642271556452463, "mean_env_wait_ms": 3.4587628110595934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01548314094543457, "StateBufferConnector_ms": 0.008593320846557617, "ViewRequirementAgentConnector_ms": 0.19331669807434082}, "num_episodes": 29, "episode_return_max": -23.38493693264942, "episode_return_min": -1483.540182717846, "episode_return_mean": -678.2885595290668, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.861730401662, "num_env_steps_trained_throughput_per_sec": 308.861730401662, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12840.029, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12839.95, "sample_time_ms": 1138.786, "learn_time_ms": 11637.904, "learn_throughput": 343.705, "synch_weights_time_ms": 62.438}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1e132_00007", "date": "2024-08-04_08-43-06", "timestamp": 1722741186, "time_this_iter_s": 12.962494134902954, "time_total_s": 283.1844983100891, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456c700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.1844983100891, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.12222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.2089816292127, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 6.336159267028173, "policy_loss": -0.013928794086677954, "vf_loss": 6.343489990135034, "vf_explained_var": 0.9400059409439564, "kl": 0.022377108332511875, "entropy": 1.150584108196199, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -32.199942741604055, "episode_reward_min": -1483.540182717846, "episode_reward_mean": -647.2395905995156, "episode_len_mean": 132.09, "episode_media": {}, "episodes_timesteps_total": 13209, "policy_reward_min": {"policy_0": -1483.540182717846}, "policy_reward_max": {"policy_0": -32.199942741604055}, "policy_reward_mean": {"policy_0": -647.2395905995156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.89640423661744, -1199.8849745889274, -1370.7242583830525, -1301.2961051849443, -331.10047001182136, -1369.30543712294, -266.2423672333631, -944.147009096634, -872.1659185733987, -885.181701165278, -324.2643738696899, -478.15662653175485, -1027.9913648179827, -784.7215383922153, -619.5725749368805, -902.4607059406243, -87.00675844774662, -551.2174648725777, -655.2123240261368, -1384.1530744724068, -259.51846525539077, -87.10467267640372, -588.7896245551888, -993.8927202886848, -390.8698580899533, -748.7462730978892, -582.3895798523401, -1192.8172037596871, -794.5045862533887, -96.37119343372814, -1097.964336996009, -502.9300669572082, -954.240527415339, -55.60776828174077, -437.3506308638057, -519.5337832346805, -591.0335060548608, -374.4700350334342, -36.98242384981093, -225.54624519503898, -213.2889247864815, -491.63445448361887, -599.038169056255, -521.9057098992062, -415.14752472407133, -1286.2236327681926, -1483.540182717846, -813.5517743746209, -753.657214812976, -1107.8559542431913, -1392.1139474111926, -603.5269519931201, -1270.4758724903686, -87.02990235146454, -711.751324545309, -1405.733728372627, -405.92097985412704, -671.5904159449514, -339.79144817192304, -1253.1203878535075, -967.2965787893293, -313.3203010198592, -161.1636219962747, -1176.921686443921, -528.9400341232156, -483.9164369541198, -556.468583348443, -634.7373102589363, -508.6735962204842, -483.6813013294202, -36.06463612315544, -1160.889057182912, -464.3917154312375, -403.3811521112809, -32.199942741604055, -152.98072972976158, -768.0645236938183, -525.9865860893466, -1123.6217369825658, -1276.921449451277, -1142.7140814707238, -182.3702060185695, -36.57003406640022, -97.71581963183513, -150.20682664333825, -726.5694957373317, -682.3643485723007, -1192.924224155624, -418.3607533993622, -1081.3369214153586, -890.5413922741451, -861.1392122924268, -668.610354556158, -377.6787674086048, -47.57049521058599, -808.8836728371987, -129.12081345247353, -492.30531007169145, -754.2577696163482, -392.83412719549887], "episode_lengths": [66, 150, 150, 150, 150, 150, 126, 150, 150, 150, 97, 150, 150, 150, 150, 150, 77, 150, 150, 150, 119, 69, 115, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 61, 150, 150, 150, 108, 56, 106, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 122, 150, 150, 150, 150, 124, 92, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 53, 58, 150, 150, 150, 150, 150, 78, 50, 76, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 83, 150, 150, 150], "policy_policy_0_reward": [-117.89640423661744, -1199.8849745889274, -1370.7242583830525, -1301.2961051849443, -331.10047001182136, -1369.30543712294, -266.2423672333631, -944.147009096634, -872.1659185733987, -885.181701165278, -324.2643738696899, -478.15662653175485, -1027.9913648179827, -784.7215383922153, -619.5725749368805, -902.4607059406243, -87.00675844774662, -551.2174648725777, -655.2123240261368, -1384.1530744724068, -259.51846525539077, -87.10467267640372, -588.7896245551888, -993.8927202886848, -390.8698580899533, -748.7462730978892, -582.3895798523401, -1192.8172037596871, -794.5045862533887, -96.37119343372814, -1097.964336996009, -502.9300669572082, -954.240527415339, -55.60776828174077, -437.3506308638057, -519.5337832346805, -591.0335060548608, -374.4700350334342, -36.98242384981093, -225.54624519503898, -213.2889247864815, -491.63445448361887, -599.038169056255, -521.9057098992062, -415.14752472407133, -1286.2236327681926, -1483.540182717846, -813.5517743746209, -753.657214812976, -1107.8559542431913, -1392.1139474111926, -603.5269519931201, -1270.4758724903686, -87.02990235146454, -711.751324545309, -1405.733728372627, -405.92097985412704, -671.5904159449514, -339.79144817192304, -1253.1203878535075, -967.2965787893293, -313.3203010198592, -161.1636219962747, -1176.921686443921, -528.9400341232156, -483.9164369541198, -556.468583348443, -634.7373102589363, -508.6735962204842, -483.6813013294202, -36.06463612315544, -1160.889057182912, -464.3917154312375, -403.3811521112809, -32.199942741604055, -152.98072972976158, -768.0645236938183, -525.9865860893466, -1123.6217369825658, -1276.921449451277, -1142.7140814707238, -182.3702060185695, -36.57003406640022, -97.71581963183513, -150.20682664333825, -726.5694957373317, -682.3643485723007, -1192.924224155624, -418.3607533993622, -1081.3369214153586, -890.5413922741451, -861.1392122924268, -668.610354556158, -377.6787674086048, -47.57049521058599, -808.8836728371987, -129.12081345247353, -492.30531007169145, -754.2577696163482, -392.83412719549887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559709378795451, "mean_inference_ms": 1.6749757918344834, "mean_action_processing_ms": 0.2761915893929831, "mean_env_wait_ms": 3.456847557931311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012394428253173828, "StateBufferConnector_ms": 0.007936477661132812, "ViewRequirementAgentConnector_ms": 0.1935417652130127}, "num_episodes": 30, "episode_return_max": -32.199942741604055, "episode_return_min": -1483.540182717846, "episode_return_mean": -647.2395905995156, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.8165681753757, "num_env_steps_trained_throughput_per_sec": 310.8165681753757, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12777.958, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12777.88, "sample_time_ms": 1140.951, "learn_time_ms": 11575.295, "learn_throughput": 345.564, "synch_weights_time_ms": 60.811}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1e132_00007", "date": "2024-08-04_08-43-19", "timestamp": 1722741199, "time_this_iter_s": 12.88141655921936, "time_total_s": 296.0659148693085, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.0659148693085, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.70526315789474, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.73363491296769, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 6.275220690170924, "policy_loss": -0.010354443499818445, "vf_loss": 6.279923581580321, "vf_explained_var": 0.8955786742890874, "kl": 0.012822806439332184, "entropy": 1.1870007604981463, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -32.199942741604055, "episode_reward_min": -1483.540182717846, "episode_reward_mean": -621.9275181778594, "episode_len_mean": 132.11, "episode_media": {}, "episodes_timesteps_total": 13211, "policy_reward_min": {"policy_0": -1483.540182717846}, "policy_reward_max": {"policy_0": -32.199942741604055}, "policy_reward_mean": {"policy_0": -621.9275181778594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.37119343372814, -1097.964336996009, -502.9300669572082, -954.240527415339, -55.60776828174077, -437.3506308638057, -519.5337832346805, -591.0335060548608, -374.4700350334342, -36.98242384981093, -225.54624519503898, -213.2889247864815, -491.63445448361887, -599.038169056255, -521.9057098992062, -415.14752472407133, -1286.2236327681926, -1483.540182717846, -813.5517743746209, -753.657214812976, -1107.8559542431913, -1392.1139474111926, -603.5269519931201, -1270.4758724903686, -87.02990235146454, -711.751324545309, -1405.733728372627, -405.92097985412704, -671.5904159449514, -339.79144817192304, -1253.1203878535075, -967.2965787893293, -313.3203010198592, -161.1636219962747, -1176.921686443921, -528.9400341232156, -483.9164369541198, -556.468583348443, -634.7373102589363, -508.6735962204842, -483.6813013294202, -36.06463612315544, -1160.889057182912, -464.3917154312375, -403.3811521112809, -32.199942741604055, -152.98072972976158, -768.0645236938183, -525.9865860893466, -1123.6217369825658, -1276.921449451277, -1142.7140814707238, -182.3702060185695, -36.57003406640022, -97.71581963183513, -150.20682664333825, -726.5694957373317, -682.3643485723007, -1192.924224155624, -418.3607533993622, -1081.3369214153586, -890.5413922741451, -861.1392122924268, -668.610354556158, -377.6787674086048, -47.57049521058599, -808.8836728371987, -129.12081345247353, -492.30531007169145, -754.2577696163482, -392.83412719549887, -588.8598487635918, -653.4424506987881, -1223.1950191667813, -927.4685600209382, -1212.714891265628, -753.3643921853374, -196.00178488482737, -746.2467354539571, -486.4206800269596, -501.39783278780817, -363.3691959091874, -1308.8756403085792, -291.78828772655953, -536.5119980757589, -241.46084233432003, -836.3296312697444, -488.40150727295924, -452.8151950923685, -617.2764807941344, -506.50639619392945, -747.2125195790785, -407.4289118157079, -1237.4879311596396, -127.27468910724969, -798.104630481529, -512.8300262959607, -899.3765088788562, -150.8728895945826, -767.0917164235385], "episode_lengths": [49, 150, 150, 150, 61, 150, 150, 150, 108, 56, 106, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 122, 150, 150, 150, 150, 124, 92, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 53, 58, 150, 150, 150, 150, 150, 78, 50, 76, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 126, 102, 150, 150, 150, 125, 150, 104, 150, 115, 150, 107, 149, 150, 150, 150, 137, 150, 73, 150, 150, 150, 83, 150], "policy_policy_0_reward": [-96.37119343372814, -1097.964336996009, -502.9300669572082, -954.240527415339, -55.60776828174077, -437.3506308638057, -519.5337832346805, -591.0335060548608, -374.4700350334342, -36.98242384981093, -225.54624519503898, -213.2889247864815, -491.63445448361887, -599.038169056255, -521.9057098992062, -415.14752472407133, -1286.2236327681926, -1483.540182717846, -813.5517743746209, -753.657214812976, -1107.8559542431913, -1392.1139474111926, -603.5269519931201, -1270.4758724903686, -87.02990235146454, -711.751324545309, -1405.733728372627, -405.92097985412704, -671.5904159449514, -339.79144817192304, -1253.1203878535075, -967.2965787893293, -313.3203010198592, -161.1636219962747, -1176.921686443921, -528.9400341232156, -483.9164369541198, -556.468583348443, -634.7373102589363, -508.6735962204842, -483.6813013294202, -36.06463612315544, -1160.889057182912, -464.3917154312375, -403.3811521112809, -32.199942741604055, -152.98072972976158, -768.0645236938183, -525.9865860893466, -1123.6217369825658, -1276.921449451277, -1142.7140814707238, -182.3702060185695, -36.57003406640022, -97.71581963183513, -150.20682664333825, -726.5694957373317, -682.3643485723007, -1192.924224155624, -418.3607533993622, -1081.3369214153586, -890.5413922741451, -861.1392122924268, -668.610354556158, -377.6787674086048, -47.57049521058599, -808.8836728371987, -129.12081345247353, -492.30531007169145, -754.2577696163482, -392.83412719549887, -588.8598487635918, -653.4424506987881, -1223.1950191667813, -927.4685600209382, -1212.714891265628, -753.3643921853374, -196.00178488482737, -746.2467354539571, -486.4206800269596, -501.39783278780817, -363.3691959091874, -1308.8756403085792, -291.78828772655953, -536.5119980757589, -241.46084233432003, -836.3296312697444, -488.40150727295924, -452.8151950923685, -617.2764807941344, -506.50639619392945, -747.2125195790785, -407.4289118157079, -1237.4879311596396, -127.27468910724969, -798.104630481529, -512.8300262959607, -899.3765088788562, -150.8728895945826, -767.0917164235385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558867779773484, "mean_inference_ms": 1.6735932568906262, "mean_action_processing_ms": 0.2761608904495285, "mean_env_wait_ms": 3.4586848002235833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016350984573364258, "StateBufferConnector_ms": 0.008050203323364258, "ViewRequirementAgentConnector_ms": 0.19444847106933594}, "num_episodes": 29, "episode_return_max": -32.199942741604055, "episode_return_min": -1483.540182717846, "episode_return_mean": -621.9275181778594, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.003004494665, "num_env_steps_trained_throughput_per_sec": 311.003004494665, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12780.418, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12780.339, "sample_time_ms": 1151.304, "learn_time_ms": 11565.95, "learn_throughput": 345.843, "synch_weights_time_ms": 62.265}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1e132_00007", "date": "2024-08-04_08-43-32", "timestamp": 1722741212, "time_this_iter_s": 12.87502932548523, "time_total_s": 308.9409441947937, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.9409441947937, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.03333333333333, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.69119674166043, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.3052796691656114, "policy_loss": -0.010224860228481703, "vf_loss": 5.309296482553084, "vf_explained_var": 0.945286563038826, "kl": 0.014012340089842257, "entropy": 0.9751756611590584, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -32.199942741604055, "episode_reward_min": -1449.2826037024995, "episode_reward_mean": -613.989631453195, "episode_len_mean": 133.48, "episode_media": {}, "episodes_timesteps_total": 13348, "policy_reward_min": {"policy_0": -1449.2826037024995}, "policy_reward_max": {"policy_0": -32.199942741604055}, "policy_reward_mean": {"policy_0": -613.989631453195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313.3203010198592, -161.1636219962747, -1176.921686443921, -528.9400341232156, -483.9164369541198, -556.468583348443, -634.7373102589363, -508.6735962204842, -483.6813013294202, -36.06463612315544, -1160.889057182912, -464.3917154312375, -403.3811521112809, -32.199942741604055, -152.98072972976158, -768.0645236938183, -525.9865860893466, -1123.6217369825658, -1276.921449451277, -1142.7140814707238, -182.3702060185695, -36.57003406640022, -97.71581963183513, -150.20682664333825, -726.5694957373317, -682.3643485723007, -1192.924224155624, -418.3607533993622, -1081.3369214153586, -890.5413922741451, -861.1392122924268, -668.610354556158, -377.6787674086048, -47.57049521058599, -808.8836728371987, -129.12081345247353, -492.30531007169145, -754.2577696163482, -392.83412719549887, -588.8598487635918, -653.4424506987881, -1223.1950191667813, -927.4685600209382, -1212.714891265628, -753.3643921853374, -196.00178488482737, -746.2467354539571, -486.4206800269596, -501.39783278780817, -363.3691959091874, -1308.8756403085792, -291.78828772655953, -536.5119980757589, -241.46084233432003, -836.3296312697444, -488.40150727295924, -452.8151950923685, -617.2764807941344, -506.50639619392945, -747.2125195790785, -407.4289118157079, -1237.4879311596396, -127.27468910724969, -798.104630481529, -512.8300262959607, -899.3765088788562, -150.8728895945826, -767.0917164235385, -184.94460928953112, -658.7614847041934, -353.85782773435733, -411.3360632267755, -535.7600334336843, -690.6979616076183, -175.4138604586753, -1050.0790654397047, -778.866291257423, -71.84226891384333, -832.8401348295814, -618.8223660210532, -187.5519588751156, -740.3744193675814, -942.7341697611675, -429.07121135861576, -455.2038432181646, -411.1049024094838, -646.6808698441474, -1248.4564086462526, -740.9535911148574, -998.0389108642279, -605.7259520231306, -639.8861660334487, -755.9122545996827, -919.2517014692656, -1213.0002449412682, -56.80155122528413, -1449.2826037024995, -730.8838406095747, -869.6819875949125, -488.61836991846974], "episode_lengths": [124, 92, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 53, 58, 150, 150, 150, 150, 150, 78, 50, 76, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 126, 102, 150, 150, 150, 125, 150, 104, 150, 115, 150, 107, 149, 150, 150, 150, 137, 150, 73, 150, 150, 150, 83, 150, 90, 150, 124, 150, 150, 150, 65, 150, 150, 66, 150, 150, 101, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 145, 150, 60, 150, 150, 150, 150], "policy_policy_0_reward": [-313.3203010198592, -161.1636219962747, -1176.921686443921, -528.9400341232156, -483.9164369541198, -556.468583348443, -634.7373102589363, -508.6735962204842, -483.6813013294202, -36.06463612315544, -1160.889057182912, -464.3917154312375, -403.3811521112809, -32.199942741604055, -152.98072972976158, -768.0645236938183, -525.9865860893466, -1123.6217369825658, -1276.921449451277, -1142.7140814707238, -182.3702060185695, -36.57003406640022, -97.71581963183513, -150.20682664333825, -726.5694957373317, -682.3643485723007, -1192.924224155624, -418.3607533993622, -1081.3369214153586, -890.5413922741451, -861.1392122924268, -668.610354556158, -377.6787674086048, -47.57049521058599, -808.8836728371987, -129.12081345247353, -492.30531007169145, -754.2577696163482, -392.83412719549887, -588.8598487635918, -653.4424506987881, -1223.1950191667813, -927.4685600209382, -1212.714891265628, -753.3643921853374, -196.00178488482737, -746.2467354539571, -486.4206800269596, -501.39783278780817, -363.3691959091874, -1308.8756403085792, -291.78828772655953, -536.5119980757589, -241.46084233432003, -836.3296312697444, -488.40150727295924, -452.8151950923685, -617.2764807941344, -506.50639619392945, -747.2125195790785, -407.4289118157079, -1237.4879311596396, -127.27468910724969, -798.104630481529, -512.8300262959607, -899.3765088788562, -150.8728895945826, -767.0917164235385, -184.94460928953112, -658.7614847041934, -353.85782773435733, -411.3360632267755, -535.7600334336843, -690.6979616076183, -175.4138604586753, -1050.0790654397047, -778.866291257423, -71.84226891384333, -832.8401348295814, -618.8223660210532, -187.5519588751156, -740.3744193675814, -942.7341697611675, -429.07121135861576, -455.2038432181646, -411.1049024094838, -646.6808698441474, -1248.4564086462526, -740.9535911148574, -998.0389108642279, -605.7259520231306, -639.8861660334487, -755.9122545996827, -919.2517014692656, -1213.0002449412682, -56.80155122528413, -1449.2826037024995, -730.8838406095747, -869.6819875949125, -488.61836991846974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559661975177037, "mean_inference_ms": 1.6739086773172824, "mean_action_processing_ms": 0.2759775180168852, "mean_env_wait_ms": 3.4579421873004694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016258716583251953, "StateBufferConnector_ms": 0.007911443710327148, "ViewRequirementAgentConnector_ms": 0.19115662574768066}, "num_episodes": 32, "episode_return_max": -32.199942741604055, "episode_return_min": -1449.2826037024995, "episode_return_mean": -613.989631453195, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.41050045346856, "num_env_steps_trained_throughput_per_sec": 309.41050045346856, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12735.765, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12735.688, "sample_time_ms": 1136.796, "learn_time_ms": 11535.493, "learn_throughput": 346.756, "synch_weights_time_ms": 62.594}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "1e132_00007", "date": "2024-08-04_08-43-45", "timestamp": 1722741225, "time_this_iter_s": 12.940445184707642, "time_total_s": 321.88138937950134, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.88138937950134, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.133333333333333, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.68206753532091, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.955903706451257, "policy_loss": -0.007461293713519505, "vf_loss": 5.9579590131839115, "vf_explained_var": 0.9446862793217102, "kl": 0.012308044745926384, "entropy": 1.326209823290507, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -47.57049521058599, "episode_reward_min": -1449.2826037024995, "episode_reward_mean": -644.1914169620444, "episode_len_mean": 135.49, "episode_media": {}, "episodes_timesteps_total": 13549, "policy_reward_min": {"policy_0": -1449.2826037024995}, "policy_reward_max": {"policy_0": -47.57049521058599}, "policy_reward_mean": {"policy_0": -644.1914169620444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-418.3607533993622, -1081.3369214153586, -890.5413922741451, -861.1392122924268, -668.610354556158, -377.6787674086048, -47.57049521058599, -808.8836728371987, -129.12081345247353, -492.30531007169145, -754.2577696163482, -392.83412719549887, -588.8598487635918, -653.4424506987881, -1223.1950191667813, -927.4685600209382, -1212.714891265628, -753.3643921853374, -196.00178488482737, -746.2467354539571, -486.4206800269596, -501.39783278780817, -363.3691959091874, -1308.8756403085792, -291.78828772655953, -536.5119980757589, -241.46084233432003, -836.3296312697444, -488.40150727295924, -452.8151950923685, -617.2764807941344, -506.50639619392945, -747.2125195790785, -407.4289118157079, -1237.4879311596396, -127.27468910724969, -798.104630481529, -512.8300262959607, -899.3765088788562, -150.8728895945826, -767.0917164235385, -184.94460928953112, -658.7614847041934, -353.85782773435733, -411.3360632267755, -535.7600334336843, -690.6979616076183, -175.4138604586753, -1050.0790654397047, -778.866291257423, -71.84226891384333, -832.8401348295814, -618.8223660210532, -187.5519588751156, -740.3744193675814, -942.7341697611675, -429.07121135861576, -455.2038432181646, -411.1049024094838, -646.6808698441474, -1248.4564086462526, -740.9535911148574, -998.0389108642279, -605.7259520231306, -639.8861660334487, -755.9122545996827, -919.2517014692656, -1213.0002449412682, -56.80155122528413, -1449.2826037024995, -730.8838406095747, -869.6819875949125, -488.61836991846974, -1150.3970475817964, -84.50217555640008, -516.6639458490141, -114.62003271718399, -1316.0401580876915, -67.17260036209632, -353.8303232417114, -753.1355965079889, -624.7640761010852, -1398.4274913528775, -1058.9792110735302, -1305.9730721744916, -1168.9292410541264, -479.20111001999646, -57.40035273618512, -643.3068013883302, -751.6195447411274, -792.8299196130552, -380.41103201592233, -65.12732524174307, -101.59719804589577, -839.2963828855359, -591.1305604993004, -598.6147167582927, -1061.7611463127869, -438.0731548106592, -1310.133771683885], "episode_lengths": [150, 150, 150, 150, 150, 150, 59, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 126, 102, 150, 150, 150, 125, 150, 104, 150, 115, 150, 107, 149, 150, 150, 150, 137, 150, 73, 150, 150, 150, 83, 150, 90, 150, 124, 150, 150, 150, 65, 150, 150, 66, 150, 150, 101, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 145, 150, 60, 150, 150, 150, 150, 150, 69, 150, 81, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 140, 62, 68, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-418.3607533993622, -1081.3369214153586, -890.5413922741451, -861.1392122924268, -668.610354556158, -377.6787674086048, -47.57049521058599, -808.8836728371987, -129.12081345247353, -492.30531007169145, -754.2577696163482, -392.83412719549887, -588.8598487635918, -653.4424506987881, -1223.1950191667813, -927.4685600209382, -1212.714891265628, -753.3643921853374, -196.00178488482737, -746.2467354539571, -486.4206800269596, -501.39783278780817, -363.3691959091874, -1308.8756403085792, -291.78828772655953, -536.5119980757589, -241.46084233432003, -836.3296312697444, -488.40150727295924, -452.8151950923685, -617.2764807941344, -506.50639619392945, -747.2125195790785, -407.4289118157079, -1237.4879311596396, -127.27468910724969, -798.104630481529, -512.8300262959607, -899.3765088788562, -150.8728895945826, -767.0917164235385, -184.94460928953112, -658.7614847041934, -353.85782773435733, -411.3360632267755, -535.7600334336843, -690.6979616076183, -175.4138604586753, -1050.0790654397047, -778.866291257423, -71.84226891384333, -832.8401348295814, -618.8223660210532, -187.5519588751156, -740.3744193675814, -942.7341697611675, -429.07121135861576, -455.2038432181646, -411.1049024094838, -646.6808698441474, -1248.4564086462526, -740.9535911148574, -998.0389108642279, -605.7259520231306, -639.8861660334487, -755.9122545996827, -919.2517014692656, -1213.0002449412682, -56.80155122528413, -1449.2826037024995, -730.8838406095747, -869.6819875949125, -488.61836991846974, -1150.3970475817964, -84.50217555640008, -516.6639458490141, -114.62003271718399, -1316.0401580876915, -67.17260036209632, -353.8303232417114, -753.1355965079889, -624.7640761010852, -1398.4274913528775, -1058.9792110735302, -1305.9730721744916, -1168.9292410541264, -479.20111001999646, -57.40035273618512, -643.3068013883302, -751.6195447411274, -792.8299196130552, -380.41103201592233, -65.12732524174307, -101.59719804589577, -839.2963828855359, -591.1305604993004, -598.6147167582927, -1061.7611463127869, -438.0731548106592, -1310.133771683885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560794077075752, "mean_inference_ms": 1.6742102624066015, "mean_action_processing_ms": 0.2759083269748837, "mean_env_wait_ms": 3.457792450164194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01619720458984375, "StateBufferConnector_ms": 0.00821542739868164, "ViewRequirementAgentConnector_ms": 0.19187259674072266}, "num_episodes": 27, "episode_return_max": -47.57049521058599, "episode_return_min": -1449.2826037024995, "episode_return_mean": -644.1914169620444, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.0299581508371, "num_env_steps_trained_throughput_per_sec": 310.0299581508371, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12788.334, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12788.261, "sample_time_ms": 1142.068, "learn_time_ms": 11582.13, "learn_throughput": 345.36, "synch_weights_time_ms": 63.263}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "1e132_00007", "date": "2024-08-04_08-43-58", "timestamp": 1722741238, "time_this_iter_s": 12.913912773132324, "time_total_s": 334.79530215263367, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.79530215263367, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.689473684210526, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.30130444169045, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.846489508946736, "policy_loss": -0.006993081959080882, "vf_loss": 5.84831512371699, "vf_explained_var": 0.9595455288266143, "kl": 0.011721802835624386, "entropy": 1.0735670089100797, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -29.64060842304661, "episode_reward_min": -1449.2826037024995, "episode_reward_mean": -623.9686038068339, "episode_len_mean": 130.95, "episode_media": {}, "episodes_timesteps_total": 13095, "policy_reward_min": {"policy_0": -1449.2826037024995}, "policy_reward_max": {"policy_0": -29.64060842304661}, "policy_reward_mean": {"policy_0": -623.9686038068339}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-407.4289118157079, -1237.4879311596396, -127.27468910724969, -798.104630481529, -512.8300262959607, -899.3765088788562, -150.8728895945826, -767.0917164235385, -184.94460928953112, -658.7614847041934, -353.85782773435733, -411.3360632267755, -535.7600334336843, -690.6979616076183, -175.4138604586753, -1050.0790654397047, -778.866291257423, -71.84226891384333, -832.8401348295814, -618.8223660210532, -187.5519588751156, -740.3744193675814, -942.7341697611675, -429.07121135861576, -455.2038432181646, -411.1049024094838, -646.6808698441474, -1248.4564086462526, -740.9535911148574, -998.0389108642279, -605.7259520231306, -639.8861660334487, -755.9122545996827, -919.2517014692656, -1213.0002449412682, -56.80155122528413, -1449.2826037024995, -730.8838406095747, -869.6819875949125, -488.61836991846974, -1150.3970475817964, -84.50217555640008, -516.6639458490141, -114.62003271718399, -1316.0401580876915, -67.17260036209632, -353.8303232417114, -753.1355965079889, -624.7640761010852, -1398.4274913528775, -1058.9792110735302, -1305.9730721744916, -1168.9292410541264, -479.20111001999646, -57.40035273618512, -643.3068013883302, -751.6195447411274, -792.8299196130552, -380.41103201592233, -65.12732524174307, -101.59719804589577, -839.2963828855359, -591.1305604993004, -598.6147167582927, -1061.7611463127869, -438.0731548106592, -1310.133771683885, -648.625503532819, -400.2647933046724, -69.07372644135717, -414.9912097705495, -575.7333176974478, -81.661053705973, -1080.3480691767666, -472.88119603385684, -151.908853426901, -401.4597714697462, -1124.4345615575555, -940.1593004664117, -84.6702839386488, -569.9637584977165, -57.48599557695676, -576.4736431120741, -700.4670261388532, -29.64060842304661, -1366.2133503280204, -1037.107261035227, -39.80042816520759, -877.9787202630743, -488.4110817521983, -765.1832578395508, -71.27313907742743, -670.2365550928321, -1182.7952257270322, -712.8356651985671, -582.2803367643317, -1144.2931142883788, -506.4906531974118, -711.6747173110867, -43.20198570832903], "episode_lengths": [137, 150, 73, 150, 150, 150, 83, 150, 90, 150, 124, 150, 150, 150, 65, 150, 150, 66, 150, 150, 101, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 145, 150, 60, 150, 150, 150, 150, 150, 69, 150, 81, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 140, 62, 68, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 64, 150, 150, 93, 150, 150, 150, 73, 150, 49, 150, 150, 38, 150, 150, 45, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 44], "policy_policy_0_reward": [-407.4289118157079, -1237.4879311596396, -127.27468910724969, -798.104630481529, -512.8300262959607, -899.3765088788562, -150.8728895945826, -767.0917164235385, -184.94460928953112, -658.7614847041934, -353.85782773435733, -411.3360632267755, -535.7600334336843, -690.6979616076183, -175.4138604586753, -1050.0790654397047, -778.866291257423, -71.84226891384333, -832.8401348295814, -618.8223660210532, -187.5519588751156, -740.3744193675814, -942.7341697611675, -429.07121135861576, -455.2038432181646, -411.1049024094838, -646.6808698441474, -1248.4564086462526, -740.9535911148574, -998.0389108642279, -605.7259520231306, -639.8861660334487, -755.9122545996827, -919.2517014692656, -1213.0002449412682, -56.80155122528413, -1449.2826037024995, -730.8838406095747, -869.6819875949125, -488.61836991846974, -1150.3970475817964, -84.50217555640008, -516.6639458490141, -114.62003271718399, -1316.0401580876915, -67.17260036209632, -353.8303232417114, -753.1355965079889, -624.7640761010852, -1398.4274913528775, -1058.9792110735302, -1305.9730721744916, -1168.9292410541264, -479.20111001999646, -57.40035273618512, -643.3068013883302, -751.6195447411274, -792.8299196130552, -380.41103201592233, -65.12732524174307, -101.59719804589577, -839.2963828855359, -591.1305604993004, -598.6147167582927, -1061.7611463127869, -438.0731548106592, -1310.133771683885, -648.625503532819, -400.2647933046724, -69.07372644135717, -414.9912097705495, -575.7333176974478, -81.661053705973, -1080.3480691767666, -472.88119603385684, -151.908853426901, -401.4597714697462, -1124.4345615575555, -940.1593004664117, -84.6702839386488, -569.9637584977165, -57.48599557695676, -576.4736431120741, -700.4670261388532, -29.64060842304661, -1366.2133503280204, -1037.107261035227, -39.80042816520759, -877.9787202630743, -488.4110817521983, -765.1832578395508, -71.27313907742743, -670.2365550928321, -1182.7952257270322, -712.8356651985671, -582.2803367643317, -1144.2931142883788, -506.4906531974118, -711.6747173110867, -43.20198570832903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564401396180114, "mean_inference_ms": 1.674935428463993, "mean_action_processing_ms": 0.27588552433735564, "mean_env_wait_ms": 3.4574558957692467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011954784393310547, "StateBufferConnector_ms": 0.00805974006652832, "ViewRequirementAgentConnector_ms": 0.18879938125610352}, "num_episodes": 33, "episode_return_max": -29.64060842304661, "episode_return_min": -1449.2826037024995, "episode_return_mean": -623.9686038068339, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.4288423352135, "num_env_steps_trained_throughput_per_sec": 315.4288423352135, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12824.208, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12824.134, "sample_time_ms": 1157.107, "learn_time_ms": 11601.831, "learn_throughput": 344.773, "synch_weights_time_ms": 64.397}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "1e132_00007", "date": "2024-08-04_08-44-10", "timestamp": 1722741250, "time_this_iter_s": 12.693450212478638, "time_total_s": 347.4887523651123, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.4887523651123, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.144444444444442, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.55605370799701, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.671730727454027, "policy_loss": -0.008136254077544435, "vf_loss": 5.674249286949634, "vf_explained_var": 0.9695565863202016, "kl": 0.012761929990453306, "entropy": 1.2517369982476036, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -29.64060842304661, "episode_reward_min": -1449.2826037024995, "episode_reward_mean": -641.1544667664948, "episode_len_mean": 132.02, "episode_media": {}, "episodes_timesteps_total": 13202, "policy_reward_min": {"policy_0": -1449.2826037024995}, "policy_reward_max": {"policy_0": -29.64060842304661}, "policy_reward_mean": {"policy_0": -641.1544667664948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-998.0389108642279, -605.7259520231306, -639.8861660334487, -755.9122545996827, -919.2517014692656, -1213.0002449412682, -56.80155122528413, -1449.2826037024995, -730.8838406095747, -869.6819875949125, -488.61836991846974, -1150.3970475817964, -84.50217555640008, -516.6639458490141, -114.62003271718399, -1316.0401580876915, -67.17260036209632, -353.8303232417114, -753.1355965079889, -624.7640761010852, -1398.4274913528775, -1058.9792110735302, -1305.9730721744916, -1168.9292410541264, -479.20111001999646, -57.40035273618512, -643.3068013883302, -751.6195447411274, -792.8299196130552, -380.41103201592233, -65.12732524174307, -101.59719804589577, -839.2963828855359, -591.1305604993004, -598.6147167582927, -1061.7611463127869, -438.0731548106592, -1310.133771683885, -648.625503532819, -400.2647933046724, -69.07372644135717, -414.9912097705495, -575.7333176974478, -81.661053705973, -1080.3480691767666, -472.88119603385684, -151.908853426901, -401.4597714697462, -1124.4345615575555, -940.1593004664117, -84.6702839386488, -569.9637584977165, -57.48599557695676, -576.4736431120741, -700.4670261388532, -29.64060842304661, -1366.2133503280204, -1037.107261035227, -39.80042816520759, -877.9787202630743, -488.4110817521983, -765.1832578395508, -71.27313907742743, -670.2365550928321, -1182.7952257270322, -712.8356651985671, -582.2803367643317, -1144.2931142883788, -506.4906531974118, -711.6747173110867, -43.20198570832903, -1050.0444098333553, -981.6529391610886, -444.62758469707467, -1260.8735885292597, -193.5308742838789, -740.6200834724849, -224.32727986257345, -149.25615769978714, -720.046776183203, -641.3678801841303, -33.06449586672452, -831.3936860202125, -996.5601580264674, -1065.3182568708244, -733.4623695658557, -1056.1871782959854, -379.20984916008325, -641.6551462073584, -472.3067585158256, -524.3721103647908, -580.128143638343, -673.118083879016, -1270.9389933731388, -426.8668515391223, -1150.2496125914001, -270.14449938298566, -548.120139974923, -668.2170915965318, -56.74594245854401], "episode_lengths": [150, 150, 150, 150, 145, 150, 60, 150, 150, 150, 150, 150, 69, 150, 81, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 140, 62, 68, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 64, 150, 150, 93, 150, 150, 150, 73, 150, 49, 150, 150, 38, 150, 150, 45, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 105, 150, 109, 91, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 56], "policy_policy_0_reward": [-998.0389108642279, -605.7259520231306, -639.8861660334487, -755.9122545996827, -919.2517014692656, -1213.0002449412682, -56.80155122528413, -1449.2826037024995, -730.8838406095747, -869.6819875949125, -488.61836991846974, -1150.3970475817964, -84.50217555640008, -516.6639458490141, -114.62003271718399, -1316.0401580876915, -67.17260036209632, -353.8303232417114, -753.1355965079889, -624.7640761010852, -1398.4274913528775, -1058.9792110735302, -1305.9730721744916, -1168.9292410541264, -479.20111001999646, -57.40035273618512, -643.3068013883302, -751.6195447411274, -792.8299196130552, -380.41103201592233, -65.12732524174307, -101.59719804589577, -839.2963828855359, -591.1305604993004, -598.6147167582927, -1061.7611463127869, -438.0731548106592, -1310.133771683885, -648.625503532819, -400.2647933046724, -69.07372644135717, -414.9912097705495, -575.7333176974478, -81.661053705973, -1080.3480691767666, -472.88119603385684, -151.908853426901, -401.4597714697462, -1124.4345615575555, -940.1593004664117, -84.6702839386488, -569.9637584977165, -57.48599557695676, -576.4736431120741, -700.4670261388532, -29.64060842304661, -1366.2133503280204, -1037.107261035227, -39.80042816520759, -877.9787202630743, -488.4110817521983, -765.1832578395508, -71.27313907742743, -670.2365550928321, -1182.7952257270322, -712.8356651985671, -582.2803367643317, -1144.2931142883788, -506.4906531974118, -711.6747173110867, -43.20198570832903, -1050.0444098333553, -981.6529391610886, -444.62758469707467, -1260.8735885292597, -193.5308742838789, -740.6200834724849, -224.32727986257345, -149.25615769978714, -720.046776183203, -641.3678801841303, -33.06449586672452, -831.3936860202125, -996.5601580264674, -1065.3182568708244, -733.4623695658557, -1056.1871782959854, -379.20984916008325, -641.6551462073584, -472.3067585158256, -524.3721103647908, -580.128143638343, -673.118083879016, -1270.9389933731388, -426.8668515391223, -1150.2496125914001, -270.14449938298566, -548.120139974923, -668.2170915965318, -56.74594245854401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561048378472203, "mean_inference_ms": 1.6751942796713368, "mean_action_processing_ms": 0.2759906521117278, "mean_env_wait_ms": 3.455656764028729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012013912200927734, "StateBufferConnector_ms": 0.008176088333129883, "ViewRequirementAgentConnector_ms": 0.18995046615600586}, "num_episodes": 29, "episode_return_max": -29.64060842304661, "episode_return_min": -1449.2826037024995, "episode_return_mean": -641.1544667664948, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.37734598127656, "num_env_steps_trained_throughput_per_sec": 304.37734598127656, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12849.624, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12849.548, "sample_time_ms": 1146.107, "learn_time_ms": 11638.249, "learn_throughput": 343.694, "synch_weights_time_ms": 64.392}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "1e132_00007", "date": "2024-08-04_08-44-23", "timestamp": 1722741263, "time_this_iter_s": 13.153701782226562, "time_total_s": 360.64245414733887, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456de10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 360.64245414733887, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.022222222222226, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.64222629666328, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 6.133291359245777, "policy_loss": -0.007331052447261755, "vf_loss": 6.135108547906081, "vf_explained_var": 0.9626495109250148, "kl": 0.012577832038368797, "entropy": 1.4615673897167047, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -28.09891407644234, "episode_reward_min": -1366.2133503280204, "episode_reward_mean": -633.6659796949322, "episode_len_mean": 130.75, "episode_media": {}, "episodes_timesteps_total": 13075, "policy_reward_min": {"policy_0": -1366.2133503280204}, "policy_reward_max": {"policy_0": -28.09891407644234}, "policy_reward_mean": {"policy_0": -633.6659796949322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.59719804589577, -839.2963828855359, -591.1305604993004, -598.6147167582927, -1061.7611463127869, -438.0731548106592, -1310.133771683885, -648.625503532819, -400.2647933046724, -69.07372644135717, -414.9912097705495, -575.7333176974478, -81.661053705973, -1080.3480691767666, -472.88119603385684, -151.908853426901, -401.4597714697462, -1124.4345615575555, -940.1593004664117, -84.6702839386488, -569.9637584977165, -57.48599557695676, -576.4736431120741, -700.4670261388532, -29.64060842304661, -1366.2133503280204, -1037.107261035227, -39.80042816520759, -877.9787202630743, -488.4110817521983, -765.1832578395508, -71.27313907742743, -670.2365550928321, -1182.7952257270322, -712.8356651985671, -582.2803367643317, -1144.2931142883788, -506.4906531974118, -711.6747173110867, -43.20198570832903, -1050.0444098333553, -981.6529391610886, -444.62758469707467, -1260.8735885292597, -193.5308742838789, -740.6200834724849, -224.32727986257345, -149.25615769978714, -720.046776183203, -641.3678801841303, -33.06449586672452, -831.3936860202125, -996.5601580264674, -1065.3182568708244, -733.4623695658557, -1056.1871782959854, -379.20984916008325, -641.6551462073584, -472.3067585158256, -524.3721103647908, -580.128143638343, -673.118083879016, -1270.9389933731388, -426.8668515391223, -1150.2496125914001, -270.14449938298566, -548.120139974923, -668.2170915965318, -56.74594245854401, -87.2453851985022, -370.9522303862968, -1013.3904102036043, -461.30838694693097, -1112.724623041811, -1047.0229380069704, -1238.2533923407345, -478.5289305802075, -564.1428453889176, -1232.637235952873, -500.5571757943105, -377.81705838334875, -203.27858265731072, -63.97957981204058, -462.8195767458399, -1017.876358466127, -28.09891407644234, -1005.5971554995477, -1318.0254609283377, -1162.6213509875056, -1040.0125768675261, -1076.1121547181106, -58.746402108960716, -785.3370157538054, -1286.3609734777642, -318.80863480884443, -863.9933107584914, -313.26417588327695, -1312.8085952224883, -151.60179240787033, -107.64270983706784], "episode_lengths": [68, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 64, 150, 150, 93, 150, 150, 150, 73, 150, 49, 150, 150, 38, 150, 150, 45, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 105, 150, 109, 91, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 56, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 100, 60, 150, 150, 47, 150, 150, 150, 150, 150, 67, 150, 150, 86, 150, 150, 150, 79, 76], "policy_policy_0_reward": [-101.59719804589577, -839.2963828855359, -591.1305604993004, -598.6147167582927, -1061.7611463127869, -438.0731548106592, -1310.133771683885, -648.625503532819, -400.2647933046724, -69.07372644135717, -414.9912097705495, -575.7333176974478, -81.661053705973, -1080.3480691767666, -472.88119603385684, -151.908853426901, -401.4597714697462, -1124.4345615575555, -940.1593004664117, -84.6702839386488, -569.9637584977165, -57.48599557695676, -576.4736431120741, -700.4670261388532, -29.64060842304661, -1366.2133503280204, -1037.107261035227, -39.80042816520759, -877.9787202630743, -488.4110817521983, -765.1832578395508, -71.27313907742743, -670.2365550928321, -1182.7952257270322, -712.8356651985671, -582.2803367643317, -1144.2931142883788, -506.4906531974118, -711.6747173110867, -43.20198570832903, -1050.0444098333553, -981.6529391610886, -444.62758469707467, -1260.8735885292597, -193.5308742838789, -740.6200834724849, -224.32727986257345, -149.25615769978714, -720.046776183203, -641.3678801841303, -33.06449586672452, -831.3936860202125, -996.5601580264674, -1065.3182568708244, -733.4623695658557, -1056.1871782959854, -379.20984916008325, -641.6551462073584, -472.3067585158256, -524.3721103647908, -580.128143638343, -673.118083879016, -1270.9389933731388, -426.8668515391223, -1150.2496125914001, -270.14449938298566, -548.120139974923, -668.2170915965318, -56.74594245854401, -87.2453851985022, -370.9522303862968, -1013.3904102036043, -461.30838694693097, -1112.724623041811, -1047.0229380069704, -1238.2533923407345, -478.5289305802075, -564.1428453889176, -1232.637235952873, -500.5571757943105, -377.81705838334875, -203.27858265731072, -63.97957981204058, -462.8195767458399, -1017.876358466127, -28.09891407644234, -1005.5971554995477, -1318.0254609283377, -1162.6213509875056, -1040.0125768675261, -1076.1121547181106, -58.746402108960716, -785.3370157538054, -1286.3609734777642, -318.80863480884443, -863.9933107584914, -313.26417588327695, -1312.8085952224883, -151.60179240787033, -107.64270983706784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556337758003011, "mean_inference_ms": 1.676561323985263, "mean_action_processing_ms": 0.27589287700611503, "mean_env_wait_ms": 3.455290780610424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011884212493896484, "StateBufferConnector_ms": 0.008298397064208984, "ViewRequirementAgentConnector_ms": 0.19130587577819824}, "num_episodes": 31, "episode_return_max": -28.09891407644234, "episode_return_min": -1366.2133503280204, "episode_return_mean": -633.6659796949322, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.329969871641, "num_env_steps_trained_throughput_per_sec": 308.329969871641, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12832.606, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12832.531, "sample_time_ms": 1150.837, "learn_time_ms": 11616.576, "learn_throughput": 344.336, "synch_weights_time_ms": 64.345}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "1e132_00007", "date": "2024-08-04_08-44-37", "timestamp": 1722741277, "time_this_iter_s": 12.986409664154053, "time_total_s": 373.6288638114929, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456ff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 373.6288638114929, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.794736842105266, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.66393881638845, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.618422634651264, "policy_loss": -0.011381329832753787, "vf_loss": 5.624415660152833, "vf_explained_var": 0.9541336515297493, "kl": 0.012228728213009828, "entropy": 1.1461311309908828, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -4.577287142546416, "episode_reward_min": -1547.4143274679234, "episode_reward_mean": -644.7352642016874, "episode_len_mean": 130.79, "episode_media": {}, "episodes_timesteps_total": 13079, "policy_reward_min": {"policy_0": -1547.4143274679234}, "policy_reward_max": {"policy_0": -4.577287142546416}, "policy_reward_mean": {"policy_0": -644.7352642016874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-670.2365550928321, -1182.7952257270322, -712.8356651985671, -582.2803367643317, -1144.2931142883788, -506.4906531974118, -711.6747173110867, -43.20198570832903, -1050.0444098333553, -981.6529391610886, -444.62758469707467, -1260.8735885292597, -193.5308742838789, -740.6200834724849, -224.32727986257345, -149.25615769978714, -720.046776183203, -641.3678801841303, -33.06449586672452, -831.3936860202125, -996.5601580264674, -1065.3182568708244, -733.4623695658557, -1056.1871782959854, -379.20984916008325, -641.6551462073584, -472.3067585158256, -524.3721103647908, -580.128143638343, -673.118083879016, -1270.9389933731388, -426.8668515391223, -1150.2496125914001, -270.14449938298566, -548.120139974923, -668.2170915965318, -56.74594245854401, -87.2453851985022, -370.9522303862968, -1013.3904102036043, -461.30838694693097, -1112.724623041811, -1047.0229380069704, -1238.2533923407345, -478.5289305802075, -564.1428453889176, -1232.637235952873, -500.5571757943105, -377.81705838334875, -203.27858265731072, -63.97957981204058, -462.8195767458399, -1017.876358466127, -28.09891407644234, -1005.5971554995477, -1318.0254609283377, -1162.6213509875056, -1040.0125768675261, -1076.1121547181106, -58.746402108960716, -785.3370157538054, -1286.3609734777642, -318.80863480884443, -863.9933107584914, -313.26417588327695, -1312.8085952224883, -151.60179240787033, -107.64270983706784, -415.94628860220234, -698.5181678515543, -203.30450016978014, -468.3838981922796, -1473.7725928378097, -1304.1391396300378, -187.75279796689622, -852.2250342531254, -1016.0750863126059, -832.4223883261826, -588.216859229801, -405.4047790473826, -917.0305924737861, -1365.167253720532, -688.5890877319717, -1150.3915690703725, -442.7880046520491, -396.75556837990155, -1547.4143274679234, -390.07239918644984, -161.7136592946127, -337.9582707585088, -201.76113973720234, -220.84327360964997, -18.64890918068602, -114.84087366930028, -1278.6035796909398, -83.20999985229152, -31.55602893410329, -4.577287142546416, -268.2816405041321, -1007.3802949273256], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 105, 150, 109, 91, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 56, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 100, 60, 150, 150, 47, 150, 150, 150, 150, 150, 67, 150, 150, 86, 150, 150, 150, 79, 76, 150, 150, 97, 150, 150, 150, 109, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 134, 150, 150, 93, 150, 91, 82, 45, 78, 150, 69, 50, 35, 122, 150], "policy_policy_0_reward": [-670.2365550928321, -1182.7952257270322, -712.8356651985671, -582.2803367643317, -1144.2931142883788, -506.4906531974118, -711.6747173110867, -43.20198570832903, -1050.0444098333553, -981.6529391610886, -444.62758469707467, -1260.8735885292597, -193.5308742838789, -740.6200834724849, -224.32727986257345, -149.25615769978714, -720.046776183203, -641.3678801841303, -33.06449586672452, -831.3936860202125, -996.5601580264674, -1065.3182568708244, -733.4623695658557, -1056.1871782959854, -379.20984916008325, -641.6551462073584, -472.3067585158256, -524.3721103647908, -580.128143638343, -673.118083879016, -1270.9389933731388, -426.8668515391223, -1150.2496125914001, -270.14449938298566, -548.120139974923, -668.2170915965318, -56.74594245854401, -87.2453851985022, -370.9522303862968, -1013.3904102036043, -461.30838694693097, -1112.724623041811, -1047.0229380069704, -1238.2533923407345, -478.5289305802075, -564.1428453889176, -1232.637235952873, -500.5571757943105, -377.81705838334875, -203.27858265731072, -63.97957981204058, -462.8195767458399, -1017.876358466127, -28.09891407644234, -1005.5971554995477, -1318.0254609283377, -1162.6213509875056, -1040.0125768675261, -1076.1121547181106, -58.746402108960716, -785.3370157538054, -1286.3609734777642, -318.80863480884443, -863.9933107584914, -313.26417588327695, -1312.8085952224883, -151.60179240787033, -107.64270983706784, -415.94628860220234, -698.5181678515543, -203.30450016978014, -468.3838981922796, -1473.7725928378097, -1304.1391396300378, -187.75279796689622, -852.2250342531254, -1016.0750863126059, -832.4223883261826, -588.216859229801, -405.4047790473826, -917.0305924737861, -1365.167253720532, -688.5890877319717, -1150.3915690703725, -442.7880046520491, -396.75556837990155, -1547.4143274679234, -390.07239918644984, -161.7136592946127, -337.9582707585088, -201.76113973720234, -220.84327360964997, -18.64890918068602, -114.84087366930028, -1278.6035796909398, -83.20999985229152, -31.55602893410329, -4.577287142546416, -268.2816405041321, -1007.3802949273256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558113489491536, "mean_inference_ms": 1.6762890747628276, "mean_action_processing_ms": 0.27593626270664784, "mean_env_wait_ms": 3.450985774843456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012069940567016602, "StateBufferConnector_ms": 0.008101701736450195, "ViewRequirementAgentConnector_ms": 0.19234824180603027}, "num_episodes": 32, "episode_return_max": -4.577287142546416, "episode_return_min": -1547.4143274679234, "episode_return_mean": -644.7352642016874, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.1710529754326, "num_env_steps_trained_throughput_per_sec": 306.1710529754326, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12937.608, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12937.533, "sample_time_ms": 1165.498, "learn_time_ms": 11706.914, "learn_throughput": 341.678, "synch_weights_time_ms": 64.352}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "1e132_00007", "date": "2024-08-04_08-44-50", "timestamp": 1722741290, "time_this_iter_s": 13.077023983001709, "time_total_s": 386.70588779449463, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456fe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.70588779449463, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.900000000000006, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.02898012598357, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.215120559930801, "policy_loss": -0.014629005776563038, "vf_loss": 5.223023833582799, "vf_explained_var": 0.9698058212175965, "kl": 0.015237171537084275, "entropy": 1.3100240021323164, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -4.577287142546416, "episode_reward_min": -1547.4143274679234, "episode_reward_mean": -602.4079067824099, "episode_len_mean": 126.07, "episode_media": {}, "episodes_timesteps_total": 12607, "policy_reward_min": {"policy_0": -1547.4143274679234}, "policy_reward_max": {"policy_0": -4.577287142546416}, "policy_reward_mean": {"policy_0": -602.4079067824099}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-270.14449938298566, -548.120139974923, -668.2170915965318, -56.74594245854401, -87.2453851985022, -370.9522303862968, -1013.3904102036043, -461.30838694693097, -1112.724623041811, -1047.0229380069704, -1238.2533923407345, -478.5289305802075, -564.1428453889176, -1232.637235952873, -500.5571757943105, -377.81705838334875, -203.27858265731072, -63.97957981204058, -462.8195767458399, -1017.876358466127, -28.09891407644234, -1005.5971554995477, -1318.0254609283377, -1162.6213509875056, -1040.0125768675261, -1076.1121547181106, -58.746402108960716, -785.3370157538054, -1286.3609734777642, -318.80863480884443, -863.9933107584914, -313.26417588327695, -1312.8085952224883, -151.60179240787033, -107.64270983706784, -415.94628860220234, -698.5181678515543, -203.30450016978014, -468.3838981922796, -1473.7725928378097, -1304.1391396300378, -187.75279796689622, -852.2250342531254, -1016.0750863126059, -832.4223883261826, -588.216859229801, -405.4047790473826, -917.0305924737861, -1365.167253720532, -688.5890877319717, -1150.3915690703725, -442.7880046520491, -396.75556837990155, -1547.4143274679234, -390.07239918644984, -161.7136592946127, -337.9582707585088, -201.76113973720234, -220.84327360964997, -18.64890918068602, -114.84087366930028, -1278.6035796909398, -83.20999985229152, -31.55602893410329, -4.577287142546416, -268.2816405041321, -1007.3802949273256, -509.5171399295671, -250.56827615424783, -630.9310155933669, -252.05669889092172, -400.6664494837349, -513.7237016279198, -1072.3616695284895, -378.5332160776201, -487.9396765344917, -15.907414840197001, -602.4259327438537, -1028.3605327207008, -598.2887303813275, -1173.8300288802882, -1346.9906420001278, -139.3661194166215, -51.27679970690051, -618.3797302451009, -577.8149754340927, -1306.6657678971912, -515.6113092705187, -493.08592585123426, -87.40884738044254, -467.93171203122694, -648.3161792173411, -23.79420173093697, -129.77124548077467, -1042.3078067980575, -1204.2085079984913, -510.2985677744517, -25.45606543601823, -170.10512998125841, -1288.3517621446817], "episode_lengths": [128, 150, 150, 56, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 100, 60, 150, 150, 47, 150, 150, 150, 150, 150, 67, 150, 150, 86, 150, 150, 150, 79, 76, 150, 150, 97, 150, 150, 150, 109, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 134, 150, 150, 93, 150, 91, 82, 45, 78, 150, 69, 50, 35, 122, 150, 150, 115, 150, 114, 150, 150, 150, 139, 150, 41, 150, 150, 150, 150, 150, 69, 57, 150, 117, 150, 150, 150, 64, 150, 150, 42, 70, 150, 150, 150, 47, 102, 150], "policy_policy_0_reward": [-270.14449938298566, -548.120139974923, -668.2170915965318, -56.74594245854401, -87.2453851985022, -370.9522303862968, -1013.3904102036043, -461.30838694693097, -1112.724623041811, -1047.0229380069704, -1238.2533923407345, -478.5289305802075, -564.1428453889176, -1232.637235952873, -500.5571757943105, -377.81705838334875, -203.27858265731072, -63.97957981204058, -462.8195767458399, -1017.876358466127, -28.09891407644234, -1005.5971554995477, -1318.0254609283377, -1162.6213509875056, -1040.0125768675261, -1076.1121547181106, -58.746402108960716, -785.3370157538054, -1286.3609734777642, -318.80863480884443, -863.9933107584914, -313.26417588327695, -1312.8085952224883, -151.60179240787033, -107.64270983706784, -415.94628860220234, -698.5181678515543, -203.30450016978014, -468.3838981922796, -1473.7725928378097, -1304.1391396300378, -187.75279796689622, -852.2250342531254, -1016.0750863126059, -832.4223883261826, -588.216859229801, -405.4047790473826, -917.0305924737861, -1365.167253720532, -688.5890877319717, -1150.3915690703725, -442.7880046520491, -396.75556837990155, -1547.4143274679234, -390.07239918644984, -161.7136592946127, -337.9582707585088, -201.76113973720234, -220.84327360964997, -18.64890918068602, -114.84087366930028, -1278.6035796909398, -83.20999985229152, -31.55602893410329, -4.577287142546416, -268.2816405041321, -1007.3802949273256, -509.5171399295671, -250.56827615424783, -630.9310155933669, -252.05669889092172, -400.6664494837349, -513.7237016279198, -1072.3616695284895, -378.5332160776201, -487.9396765344917, -15.907414840197001, -602.4259327438537, -1028.3605327207008, -598.2887303813275, -1173.8300288802882, -1346.9906420001278, -139.3661194166215, -51.27679970690051, -618.3797302451009, -577.8149754340927, -1306.6657678971912, -515.6113092705187, -493.08592585123426, -87.40884738044254, -467.93171203122694, -648.3161792173411, -23.79420173093697, -129.77124548077467, -1042.3078067980575, -1204.2085079984913, -510.2985677744517, -25.45606543601823, -170.10512998125841, -1288.3517621446817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560588954479972, "mean_inference_ms": 1.7004219379430867, "mean_action_processing_ms": 0.2759562065752653, "mean_env_wait_ms": 3.4499738654070438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011898279190063477, "StateBufferConnector_ms": 0.007959127426147461, "ViewRequirementAgentConnector_ms": 0.1919693946838379}, "num_episodes": 33, "episode_return_max": -4.577287142546416, "episode_return_min": -1547.4143274679234, "episode_return_mean": -602.4079067824099, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.6155651360095, "num_env_steps_trained_throughput_per_sec": 441.6155651360095, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12542.973, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12542.898, "sample_time_ms": 1206.777, "learn_time_ms": 11271.934, "learn_throughput": 354.864, "synch_weights_time_ms": 63.418}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "1e132_00007", "date": "2024-08-04_08-44-59", "timestamp": 1722741299, "time_this_iter_s": 9.071254968643188, "time_total_s": 395.7771427631378, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456df30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 395.7771427631378, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.316666666666663, "ram_util_percent": 28.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.8187162578106, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.56915922164917, "policy_loss": -0.0071380616500391625, "vf_loss": 5.570769064128399, "vf_explained_var": 0.9624265390758713, "kl": 0.012532657313537782, "entropy": 1.114917153896143, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -4.577287142546416, "episode_reward_min": -1556.3934047907276, "episode_reward_mean": -582.4212065909696, "episode_len_mean": 125.49, "episode_media": {}, "episodes_timesteps_total": 12549, "policy_reward_min": {"policy_0": -1556.3934047907276}, "policy_reward_max": {"policy_0": -4.577287142546416}, "policy_reward_mean": {"policy_0": -582.4212065909696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1312.8085952224883, -151.60179240787033, -107.64270983706784, -415.94628860220234, -698.5181678515543, -203.30450016978014, -468.3838981922796, -1473.7725928378097, -1304.1391396300378, -187.75279796689622, -852.2250342531254, -1016.0750863126059, -832.4223883261826, -588.216859229801, -405.4047790473826, -917.0305924737861, -1365.167253720532, -688.5890877319717, -1150.3915690703725, -442.7880046520491, -396.75556837990155, -1547.4143274679234, -390.07239918644984, -161.7136592946127, -337.9582707585088, -201.76113973720234, -220.84327360964997, -18.64890918068602, -114.84087366930028, -1278.6035796909398, -83.20999985229152, -31.55602893410329, -4.577287142546416, -268.2816405041321, -1007.3802949273256, -509.5171399295671, -250.56827615424783, -630.9310155933669, -252.05669889092172, -400.6664494837349, -513.7237016279198, -1072.3616695284895, -378.5332160776201, -487.9396765344917, -15.907414840197001, -602.4259327438537, -1028.3605327207008, -598.2887303813275, -1173.8300288802882, -1346.9906420001278, -139.3661194166215, -51.27679970690051, -618.3797302451009, -577.8149754340927, -1306.6657678971912, -515.6113092705187, -493.08592585123426, -87.40884738044254, -467.93171203122694, -648.3161792173411, -23.79420173093697, -129.77124548077467, -1042.3078067980575, -1204.2085079984913, -510.2985677744517, -25.45606543601823, -170.10512998125841, -1288.3517621446817, -575.7315146157628, -640.8349112973935, -471.5369398700858, -683.1372373867844, -1063.289463637641, -482.99491148798427, -1556.3934047907276, -666.2237686056958, -680.3222335184398, -459.572964399709, -920.4178495113579, -1366.5840810101038, -962.0362273903811, -67.62230966555785, -670.243143975188, -187.86666582671072, -550.3448020892743, -181.66087815997412, -573.276430586686, -1199.8434317011727, -1455.0545688996206, -51.576702935521446, -475.1979208720433, -221.39967905755432, -13.761389776005934, -765.4498270612835, -235.8315237692147, -74.80109893341093, -248.93614414977068, -601.5746668120698, -138.13555605330254, -792.4182421969778], "episode_lengths": [150, 79, 76, 150, 150, 97, 150, 150, 150, 109, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 134, 150, 150, 93, 150, 91, 82, 45, 78, 150, 69, 50, 35, 122, 150, 150, 115, 150, 114, 150, 150, 150, 139, 150, 41, 150, 150, 150, 150, 150, 69, 57, 150, 117, 150, 150, 150, 64, 150, 150, 42, 70, 150, 150, 150, 47, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 101, 150, 92, 150, 150, 150, 57, 150, 108, 32, 150, 107, 65, 115, 150, 88, 150], "policy_policy_0_reward": [-1312.8085952224883, -151.60179240787033, -107.64270983706784, -415.94628860220234, -698.5181678515543, -203.30450016978014, -468.3838981922796, -1473.7725928378097, -1304.1391396300378, -187.75279796689622, -852.2250342531254, -1016.0750863126059, -832.4223883261826, -588.216859229801, -405.4047790473826, -917.0305924737861, -1365.167253720532, -688.5890877319717, -1150.3915690703725, -442.7880046520491, -396.75556837990155, -1547.4143274679234, -390.07239918644984, -161.7136592946127, -337.9582707585088, -201.76113973720234, -220.84327360964997, -18.64890918068602, -114.84087366930028, -1278.6035796909398, -83.20999985229152, -31.55602893410329, -4.577287142546416, -268.2816405041321, -1007.3802949273256, -509.5171399295671, -250.56827615424783, -630.9310155933669, -252.05669889092172, -400.6664494837349, -513.7237016279198, -1072.3616695284895, -378.5332160776201, -487.9396765344917, -15.907414840197001, -602.4259327438537, -1028.3605327207008, -598.2887303813275, -1173.8300288802882, -1346.9906420001278, -139.3661194166215, -51.27679970690051, -618.3797302451009, -577.8149754340927, -1306.6657678971912, -515.6113092705187, -493.08592585123426, -87.40884738044254, -467.93171203122694, -648.3161792173411, -23.79420173093697, -129.77124548077467, -1042.3078067980575, -1204.2085079984913, -510.2985677744517, -25.45606543601823, -170.10512998125841, -1288.3517621446817, -575.7315146157628, -640.8349112973935, -471.5369398700858, -683.1372373867844, -1063.289463637641, -482.99491148798427, -1556.3934047907276, -666.2237686056958, -680.3222335184398, -459.572964399709, -920.4178495113579, -1366.5840810101038, -962.0362273903811, -67.62230966555785, -670.243143975188, -187.86666582671072, -550.3448020892743, -181.66087815997412, -573.276430586686, -1199.8434317011727, -1455.0545688996206, -51.576702935521446, -475.1979208720433, -221.39967905755432, -13.761389776005934, -765.4498270612835, -235.8315237692147, -74.80109893341093, -248.93614414977068, -601.5746668120698, -138.13555605330254, -792.4182421969778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561913207089062, "mean_inference_ms": 1.7213413555073396, "mean_action_processing_ms": 0.2759572226819576, "mean_env_wait_ms": 3.4507154458868015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012012481689453125, "StateBufferConnector_ms": 0.007987260818481445, "ViewRequirementAgentConnector_ms": 0.19562482833862305}, "num_episodes": 32, "episode_return_max": -4.577287142546416, "episode_return_min": -1556.3934047907276, "episode_return_mean": -582.4212065909696, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.7607967691722, "num_env_steps_trained_throughput_per_sec": 305.7607967691722, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12556.107, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12556.034, "sample_time_ms": 1216.91, "learn_time_ms": 11276.372, "learn_throughput": 354.724, "synch_weights_time_ms": 61.988}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "1e132_00007", "date": "2024-08-04_08-45-12", "timestamp": 1722741312, "time_this_iter_s": 13.094192028045654, "time_total_s": 408.8713347911835, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456ecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 408.8713347911835, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.847368421052632, "ram_util_percent": 28.326315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 204.09845594565073, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.484289105733236, "policy_loss": -0.006996540172258392, "vf_loss": 5.485648882637421, "vf_explained_var": 0.9604584990690151, "kl": 0.012820416761769593, "entropy": 1.3241593020036817, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -4.577287142546416, "episode_reward_min": -1556.3934047907276, "episode_reward_mean": -599.0683332645547, "episode_len_mean": 128.02, "episode_media": {}, "episodes_timesteps_total": 12802, "policy_reward_min": {"policy_0": -1556.3934047907276}, "policy_reward_max": {"policy_0": -4.577287142546416}, "policy_reward_mean": {"policy_0": -599.0683332645547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.20999985229152, -31.55602893410329, -4.577287142546416, -268.2816405041321, -1007.3802949273256, -509.5171399295671, -250.56827615424783, -630.9310155933669, -252.05669889092172, -400.6664494837349, -513.7237016279198, -1072.3616695284895, -378.5332160776201, -487.9396765344917, -15.907414840197001, -602.4259327438537, -1028.3605327207008, -598.2887303813275, -1173.8300288802882, -1346.9906420001278, -139.3661194166215, -51.27679970690051, -618.3797302451009, -577.8149754340927, -1306.6657678971912, -515.6113092705187, -493.08592585123426, -87.40884738044254, -467.93171203122694, -648.3161792173411, -23.79420173093697, -129.77124548077467, -1042.3078067980575, -1204.2085079984913, -510.2985677744517, -25.45606543601823, -170.10512998125841, -1288.3517621446817, -575.7315146157628, -640.8349112973935, -471.5369398700858, -683.1372373867844, -1063.289463637641, -482.99491148798427, -1556.3934047907276, -666.2237686056958, -680.3222335184398, -459.572964399709, -920.4178495113579, -1366.5840810101038, -962.0362273903811, -67.62230966555785, -670.243143975188, -187.86666582671072, -550.3448020892743, -181.66087815997412, -573.276430586686, -1199.8434317011727, -1455.0545688996206, -51.576702935521446, -475.1979208720433, -221.39967905755432, -13.761389776005934, -765.4498270612835, -235.8315237692147, -74.80109893341093, -248.93614414977068, -601.5746668120698, -138.13555605330254, -792.4182421969778, -196.20815506506793, -1193.7023259536352, -144.06991639327768, -708.306461773331, -619.2126340559612, -722.8046607940369, -714.9851589823185, -961.7702455888973, -65.09879855279334, -859.7270726769381, -898.3743636140515, -1101.41556075362, -1097.0570767295537, -500.54893090667764, -510.686583978613, -473.08953238591187, -1060.7960223454115, -129.4919361903826, -551.3073099319827, -632.9503888604281, -450.4505525150286, -725.7447861892479, -1095.8770868915847, -959.410352327596, -248.33346860107, -684.5313097114429, -479.58468973832885, -497.50772922474385, -1206.9177635636206, -1425.5449315739038], "episode_lengths": [69, 50, 35, 122, 150, 150, 115, 150, 114, 150, 150, 150, 139, 150, 41, 150, 150, 150, 150, 150, 69, 57, 150, 117, 150, 150, 150, 64, 150, 150, 42, 70, 150, 150, 150, 47, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 101, 150, 92, 150, 150, 150, 57, 150, 108, 32, 150, 107, 65, 115, 150, 88, 150, 89, 150, 86, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 108, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150], "policy_policy_0_reward": [-83.20999985229152, -31.55602893410329, -4.577287142546416, -268.2816405041321, -1007.3802949273256, -509.5171399295671, -250.56827615424783, -630.9310155933669, -252.05669889092172, -400.6664494837349, -513.7237016279198, -1072.3616695284895, -378.5332160776201, -487.9396765344917, -15.907414840197001, -602.4259327438537, -1028.3605327207008, -598.2887303813275, -1173.8300288802882, -1346.9906420001278, -139.3661194166215, -51.27679970690051, -618.3797302451009, -577.8149754340927, -1306.6657678971912, -515.6113092705187, -493.08592585123426, -87.40884738044254, -467.93171203122694, -648.3161792173411, -23.79420173093697, -129.77124548077467, -1042.3078067980575, -1204.2085079984913, -510.2985677744517, -25.45606543601823, -170.10512998125841, -1288.3517621446817, -575.7315146157628, -640.8349112973935, -471.5369398700858, -683.1372373867844, -1063.289463637641, -482.99491148798427, -1556.3934047907276, -666.2237686056958, -680.3222335184398, -459.572964399709, -920.4178495113579, -1366.5840810101038, -962.0362273903811, -67.62230966555785, -670.243143975188, -187.86666582671072, -550.3448020892743, -181.66087815997412, -573.276430586686, -1199.8434317011727, -1455.0545688996206, -51.576702935521446, -475.1979208720433, -221.39967905755432, -13.761389776005934, -765.4498270612835, -235.8315237692147, -74.80109893341093, -248.93614414977068, -601.5746668120698, -138.13555605330254, -792.4182421969778, -196.20815506506793, -1193.7023259536352, -144.06991639327768, -708.306461773331, -619.2126340559612, -722.8046607940369, -714.9851589823185, -961.7702455888973, -65.09879855279334, -859.7270726769381, -898.3743636140515, -1101.41556075362, -1097.0570767295537, -500.54893090667764, -510.686583978613, -473.08953238591187, -1060.7960223454115, -129.4919361903826, -551.3073099319827, -632.9503888604281, -450.4505525150286, -725.7447861892479, -1095.8770868915847, -959.410352327596, -248.33346860107, -684.5313097114429, -479.58468973832885, -497.50772922474385, -1206.9177635636206, -1425.5449315739038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559884799796008, "mean_inference_ms": 1.7413196076231854, "mean_action_processing_ms": 0.2759431468009502, "mean_env_wait_ms": 3.450992873285943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011849403381347656, "StateBufferConnector_ms": 0.007984638214111328, "ViewRequirementAgentConnector_ms": 0.19605636596679688}, "num_episodes": 30, "episode_return_max": -4.577287142546416, "episode_return_min": -1556.3934047907276, "episode_return_mean": -599.0683332645547, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.5259065807973, "num_env_steps_trained_throughput_per_sec": 309.5259065807973, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12561.473, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12561.4, "sample_time_ms": 1216.852, "learn_time_ms": 11282.445, "learn_throughput": 354.533, "synch_weights_time_ms": 61.296}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "1e132_00007", "date": "2024-08-04_08-45-25", "timestamp": 1722741325, "time_this_iter_s": 12.93411636352539, "time_total_s": 421.80545115470886, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a5900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 421.80545115470886, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.794736842105262, "ram_util_percent": 28.30526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.1524659792582, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.170662608494362, "policy_loss": -0.006994550420010152, "vf_loss": 5.1726306428511934, "vf_explained_var": 0.9623191558445493, "kl": 0.01145130893382888, "entropy": 1.2657648558417955, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -13.761389776005934, "episode_reward_min": -1556.3934047907276, "episode_reward_mean": -616.2301512709545, "episode_len_mean": 130.83, "episode_media": {}, "episodes_timesteps_total": 13083, "policy_reward_min": {"policy_0": -1556.3934047907276}, "policy_reward_max": {"policy_0": -13.761389776005934}, "policy_reward_mean": {"policy_0": -616.2301512709545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.3161792173411, -23.79420173093697, -129.77124548077467, -1042.3078067980575, -1204.2085079984913, -510.2985677744517, -25.45606543601823, -170.10512998125841, -1288.3517621446817, -575.7315146157628, -640.8349112973935, -471.5369398700858, -683.1372373867844, -1063.289463637641, -482.99491148798427, -1556.3934047907276, -666.2237686056958, -680.3222335184398, -459.572964399709, -920.4178495113579, -1366.5840810101038, -962.0362273903811, -67.62230966555785, -670.243143975188, -187.86666582671072, -550.3448020892743, -181.66087815997412, -573.276430586686, -1199.8434317011727, -1455.0545688996206, -51.576702935521446, -475.1979208720433, -221.39967905755432, -13.761389776005934, -765.4498270612835, -235.8315237692147, -74.80109893341093, -248.93614414977068, -601.5746668120698, -138.13555605330254, -792.4182421969778, -196.20815506506793, -1193.7023259536352, -144.06991639327768, -708.306461773331, -619.2126340559612, -722.8046607940369, -714.9851589823185, -961.7702455888973, -65.09879855279334, -859.7270726769381, -898.3743636140515, -1101.41556075362, -1097.0570767295537, -500.54893090667764, -510.686583978613, -473.08953238591187, -1060.7960223454115, -129.4919361903826, -551.3073099319827, -632.9503888604281, -450.4505525150286, -725.7447861892479, -1095.8770868915847, -959.410352327596, -248.33346860107, -684.5313097114429, -479.58468973832885, -497.50772922474385, -1206.9177635636206, -1425.5449315739038, -402.6333914741071, -73.74810548434161, -467.1802789274011, -579.7685512886073, -1080.1240327761864, -551.7767970777356, -834.5518953385255, -1052.2354153092317, -556.4230129134025, -497.25124833872576, -671.5175676418257, -1397.8351310589364, -545.739934672134, -548.8999970487279, -95.77454462037954, -84.07358809316791, -42.52253189336269, -582.1268865940285, -887.9817997078676, -413.52323011121325, -153.68396572618178, -1365.5591532534097, -499.8932068851323, -583.3426711641376, -934.8115943754055, -427.9763565627882, -509.1361337908867, -681.6102874631227, -109.12805502960902], "episode_lengths": [150, 42, 70, 150, 150, 150, 47, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 101, 150, 92, 150, 150, 150, 57, 150, 108, 32, 150, 107, 65, 115, 150, 88, 150, 89, 150, 86, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 108, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 51, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 64, 47, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 78], "policy_policy_0_reward": [-648.3161792173411, -23.79420173093697, -129.77124548077467, -1042.3078067980575, -1204.2085079984913, -510.2985677744517, -25.45606543601823, -170.10512998125841, -1288.3517621446817, -575.7315146157628, -640.8349112973935, -471.5369398700858, -683.1372373867844, -1063.289463637641, -482.99491148798427, -1556.3934047907276, -666.2237686056958, -680.3222335184398, -459.572964399709, -920.4178495113579, -1366.5840810101038, -962.0362273903811, -67.62230966555785, -670.243143975188, -187.86666582671072, -550.3448020892743, -181.66087815997412, -573.276430586686, -1199.8434317011727, -1455.0545688996206, -51.576702935521446, -475.1979208720433, -221.39967905755432, -13.761389776005934, -765.4498270612835, -235.8315237692147, -74.80109893341093, -248.93614414977068, -601.5746668120698, -138.13555605330254, -792.4182421969778, -196.20815506506793, -1193.7023259536352, -144.06991639327768, -708.306461773331, -619.2126340559612, -722.8046607940369, -714.9851589823185, -961.7702455888973, -65.09879855279334, -859.7270726769381, -898.3743636140515, -1101.41556075362, -1097.0570767295537, -500.54893090667764, -510.686583978613, -473.08953238591187, -1060.7960223454115, -129.4919361903826, -551.3073099319827, -632.9503888604281, -450.4505525150286, -725.7447861892479, -1095.8770868915847, -959.410352327596, -248.33346860107, -684.5313097114429, -479.58468973832885, -497.50772922474385, -1206.9177635636206, -1425.5449315739038, -402.6333914741071, -73.74810548434161, -467.1802789274011, -579.7685512886073, -1080.1240327761864, -551.7767970777356, -834.5518953385255, -1052.2354153092317, -556.4230129134025, -497.25124833872576, -671.5175676418257, -1397.8351310589364, -545.739934672134, -548.8999970487279, -95.77454462037954, -84.07358809316791, -42.52253189336269, -582.1268865940285, -887.9817997078676, -413.52323011121325, -153.68396572618178, -1365.5591532534097, -499.8932068851323, -583.3426711641376, -934.8115943754055, -427.9763565627882, -509.1361337908867, -681.6102874631227, -109.12805502960902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559590876697456, "mean_inference_ms": 1.744376487396012, "mean_action_processing_ms": 0.27569450897917736, "mean_env_wait_ms": 3.4504611517187227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011687278747558594, "StateBufferConnector_ms": 0.007887840270996094, "ViewRequirementAgentConnector_ms": 0.1934797763824463}, "num_episodes": 29, "episode_return_max": -13.761389776005934, "episode_return_min": -1556.3934047907276, "episode_return_mean": -616.2301512709545, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.33548313039546, "num_env_steps_trained_throughput_per_sec": 304.33548313039546, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12589.651, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12589.579, "sample_time_ms": 1203.292, "learn_time_ms": 11325.41, "learn_throughput": 353.188, "synch_weights_time_ms": 60.057}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "1e132_00007", "date": "2024-08-04_08-45-38", "timestamp": 1722741338, "time_this_iter_s": 13.155997514724731, "time_total_s": 434.9614486694336, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 434.9614486694336, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.0, "ram_util_percent": 28.322222222222226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.4968212087949, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.5574287384748455, "policy_loss": -0.00953023755864706, "vf_loss": 5.5614672082165875, "vf_explained_var": 0.9503260158002377, "kl": 0.012445159735489182, "entropy": 1.0854370271476605, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -13.761389776005934, "episode_reward_min": -1425.5449315739038, "episode_reward_mean": -572.4635448262799, "episode_len_mean": 132.12, "episode_media": {}, "episodes_timesteps_total": 13212, "policy_reward_min": {"policy_0": -1425.5449315739038}, "policy_reward_max": {"policy_0": -13.761389776005934}, "policy_reward_mean": {"policy_0": -572.4635448262799}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-475.1979208720433, -221.39967905755432, -13.761389776005934, -765.4498270612835, -235.8315237692147, -74.80109893341093, -248.93614414977068, -601.5746668120698, -138.13555605330254, -792.4182421969778, -196.20815506506793, -1193.7023259536352, -144.06991639327768, -708.306461773331, -619.2126340559612, -722.8046607940369, -714.9851589823185, -961.7702455888973, -65.09879855279334, -859.7270726769381, -898.3743636140515, -1101.41556075362, -1097.0570767295537, -500.54893090667764, -510.686583978613, -473.08953238591187, -1060.7960223454115, -129.4919361903826, -551.3073099319827, -632.9503888604281, -450.4505525150286, -725.7447861892479, -1095.8770868915847, -959.410352327596, -248.33346860107, -684.5313097114429, -479.58468973832885, -497.50772922474385, -1206.9177635636206, -1425.5449315739038, -402.6333914741071, -73.74810548434161, -467.1802789274011, -579.7685512886073, -1080.1240327761864, -551.7767970777356, -834.5518953385255, -1052.2354153092317, -556.4230129134025, -497.25124833872576, -671.5175676418257, -1397.8351310589364, -545.739934672134, -548.8999970487279, -95.77454462037954, -84.07358809316791, -42.52253189336269, -582.1268865940285, -887.9817997078676, -413.52323011121325, -153.68396572618178, -1365.5591532534097, -499.8932068851323, -583.3426711641376, -934.8115943754055, -427.9763565627882, -509.1361337908867, -681.6102874631227, -109.12805502960902, -442.68287604546055, -511.733862233126, -1408.9146121716549, -424.96679743052084, -555.5225381884102, -856.769803689178, -158.99456711632146, -201.8925969055264, -486.0064577919931, -538.9095364989042, -473.62974875665725, -990.5973807596456, -668.7702875348975, -173.85635167711925, -955.0284883306194, -312.96261998843113, -778.4799319887053, -570.5954244527683, -188.58194894257306, -421.1946123781094, -435.22112303189425, -97.24656970348092, -1179.896588719296, -650.3871267338545, -229.6004408561003, -460.20771454659797, -116.20718397124891, -386.1249328382067, -357.3933752376047, -667.6456056237616, -432.49215931366285], "episode_lengths": [150, 108, 32, 150, 107, 65, 115, 150, 88, 150, 89, 150, 86, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 108, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 51, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 64, 47, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 101, 101, 150, 150, 150, 150, 150, 96, 150, 129, 150, 150, 87, 150, 150, 70, 150, 150, 88, 150, 81, 95, 150, 150, 150], "policy_policy_0_reward": [-475.1979208720433, -221.39967905755432, -13.761389776005934, -765.4498270612835, -235.8315237692147, -74.80109893341093, -248.93614414977068, -601.5746668120698, -138.13555605330254, -792.4182421969778, -196.20815506506793, -1193.7023259536352, -144.06991639327768, -708.306461773331, -619.2126340559612, -722.8046607940369, -714.9851589823185, -961.7702455888973, -65.09879855279334, -859.7270726769381, -898.3743636140515, -1101.41556075362, -1097.0570767295537, -500.54893090667764, -510.686583978613, -473.08953238591187, -1060.7960223454115, -129.4919361903826, -551.3073099319827, -632.9503888604281, -450.4505525150286, -725.7447861892479, -1095.8770868915847, -959.410352327596, -248.33346860107, -684.5313097114429, -479.58468973832885, -497.50772922474385, -1206.9177635636206, -1425.5449315739038, -402.6333914741071, -73.74810548434161, -467.1802789274011, -579.7685512886073, -1080.1240327761864, -551.7767970777356, -834.5518953385255, -1052.2354153092317, -556.4230129134025, -497.25124833872576, -671.5175676418257, -1397.8351310589364, -545.739934672134, -548.8999970487279, -95.77454462037954, -84.07358809316791, -42.52253189336269, -582.1268865940285, -887.9817997078676, -413.52323011121325, -153.68396572618178, -1365.5591532534097, -499.8932068851323, -583.3426711641376, -934.8115943754055, -427.9763565627882, -509.1361337908867, -681.6102874631227, -109.12805502960902, -442.68287604546055, -511.733862233126, -1408.9146121716549, -424.96679743052084, -555.5225381884102, -856.769803689178, -158.99456711632146, -201.8925969055264, -486.0064577919931, -538.9095364989042, -473.62974875665725, -990.5973807596456, -668.7702875348975, -173.85635167711925, -955.0284883306194, -312.96261998843113, -778.4799319887053, -570.5954244527683, -188.58194894257306, -421.1946123781094, -435.22112303189425, -97.24656970348092, -1179.896588719296, -650.3871267338545, -229.6004408561003, -460.20771454659797, -116.20718397124891, -386.1249328382067, -357.3933752376047, -667.6456056237616, -432.49215931366285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565737918468788, "mean_inference_ms": 1.7435704455088388, "mean_action_processing_ms": 0.2759484818280495, "mean_env_wait_ms": 3.45045453880281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011415719985961914, "StateBufferConnector_ms": 0.007787466049194336, "ViewRequirementAgentConnector_ms": 0.18879127502441406}, "num_episodes": 31, "episode_return_max": -13.761389776005934, "episode_return_min": -1425.5449315739038, "episode_return_mean": -572.4635448262799, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.0968006446887, "num_env_steps_trained_throughput_per_sec": 321.0968006446887, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12542.6, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12542.529, "sample_time_ms": 1201.51, "learn_time_ms": 11279.322, "learn_throughput": 354.631, "synch_weights_time_ms": 60.877}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "1e132_00007", "date": "2024-08-04_08-45-51", "timestamp": 1722741351, "time_this_iter_s": 12.469327211380005, "time_total_s": 447.4307758808136, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ae4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 447.4307758808136, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.33333333333333, "ram_util_percent": 28.31666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.0375350892544, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.6045210249722, "policy_loss": -0.008154548120122248, "vf_loss": 5.607581642766793, "vf_explained_var": 0.958157579600811, "kl": 0.011552764425141542, "entropy": 1.0480749066919088, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -42.52253189336269, "episode_reward_min": -1425.5449315739038, "episode_reward_mean": -562.9070599204446, "episode_len_mean": 134.13, "episode_media": {}, "episodes_timesteps_total": 13413, "policy_reward_min": {"policy_0": -1425.5449315739038}, "policy_reward_max": {"policy_0": -42.52253189336269}, "policy_reward_mean": {"policy_0": -562.9070599204446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.4919361903826, -551.3073099319827, -632.9503888604281, -450.4505525150286, -725.7447861892479, -1095.8770868915847, -959.410352327596, -248.33346860107, -684.5313097114429, -479.58468973832885, -497.50772922474385, -1206.9177635636206, -1425.5449315739038, -402.6333914741071, -73.74810548434161, -467.1802789274011, -579.7685512886073, -1080.1240327761864, -551.7767970777356, -834.5518953385255, -1052.2354153092317, -556.4230129134025, -497.25124833872576, -671.5175676418257, -1397.8351310589364, -545.739934672134, -548.8999970487279, -95.77454462037954, -84.07358809316791, -42.52253189336269, -582.1268865940285, -887.9817997078676, -413.52323011121325, -153.68396572618178, -1365.5591532534097, -499.8932068851323, -583.3426711641376, -934.8115943754055, -427.9763565627882, -509.1361337908867, -681.6102874631227, -109.12805502960902, -442.68287604546055, -511.733862233126, -1408.9146121716549, -424.96679743052084, -555.5225381884102, -856.769803689178, -158.99456711632146, -201.8925969055264, -486.0064577919931, -538.9095364989042, -473.62974875665725, -990.5973807596456, -668.7702875348975, -173.85635167711925, -955.0284883306194, -312.96261998843113, -778.4799319887053, -570.5954244527683, -188.58194894257306, -421.1946123781094, -435.22112303189425, -97.24656970348092, -1179.896588719296, -650.3871267338545, -229.6004408561003, -460.20771454659797, -116.20718397124891, -386.1249328382067, -357.3933752376047, -667.6456056237616, -432.49215931366285, -565.1555535697015, -593.4450266403041, -230.31482672058502, -1202.2120782723055, -481.0214373276155, -272.29755709581514, -1222.5248504039369, -425.56046776259984, -1329.1770140904825, -337.25269418047895, -514.1466621117088, -1108.1882615418822, -111.2406701461305, -984.4225828426158, -73.44768269036041, -113.56986608202212, -188.47500547536086, -399.636085620995, -326.0052203164644, -332.1623885868976, -475.55054848846856, -67.40869422795839, -579.5774250832883, -993.3052462105321, -656.024828900985, -362.6632414661293, -494.9251427925544], "episode_lengths": [77, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 51, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 64, 47, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 101, 101, 150, 150, 150, 150, 150, 96, 150, 129, 150, 150, 87, 150, 150, 70, 150, 150, 88, 150, 81, 95, 150, 150, 150, 148, 150, 148, 150, 150, 150, 150, 150, 150, 146, 150, 150, 58, 150, 70, 45, 104, 150, 150, 128, 150, 66, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-129.4919361903826, -551.3073099319827, -632.9503888604281, -450.4505525150286, -725.7447861892479, -1095.8770868915847, -959.410352327596, -248.33346860107, -684.5313097114429, -479.58468973832885, -497.50772922474385, -1206.9177635636206, -1425.5449315739038, -402.6333914741071, -73.74810548434161, -467.1802789274011, -579.7685512886073, -1080.1240327761864, -551.7767970777356, -834.5518953385255, -1052.2354153092317, -556.4230129134025, -497.25124833872576, -671.5175676418257, -1397.8351310589364, -545.739934672134, -548.8999970487279, -95.77454462037954, -84.07358809316791, -42.52253189336269, -582.1268865940285, -887.9817997078676, -413.52323011121325, -153.68396572618178, -1365.5591532534097, -499.8932068851323, -583.3426711641376, -934.8115943754055, -427.9763565627882, -509.1361337908867, -681.6102874631227, -109.12805502960902, -442.68287604546055, -511.733862233126, -1408.9146121716549, -424.96679743052084, -555.5225381884102, -856.769803689178, -158.99456711632146, -201.8925969055264, -486.0064577919931, -538.9095364989042, -473.62974875665725, -990.5973807596456, -668.7702875348975, -173.85635167711925, -955.0284883306194, -312.96261998843113, -778.4799319887053, -570.5954244527683, -188.58194894257306, -421.1946123781094, -435.22112303189425, -97.24656970348092, -1179.896588719296, -650.3871267338545, -229.6004408561003, -460.20771454659797, -116.20718397124891, -386.1249328382067, -357.3933752376047, -667.6456056237616, -432.49215931366285, -565.1555535697015, -593.4450266403041, -230.31482672058502, -1202.2120782723055, -481.0214373276155, -272.29755709581514, -1222.5248504039369, -425.56046776259984, -1329.1770140904825, -337.25269418047895, -514.1466621117088, -1108.1882615418822, -111.2406701461305, -984.4225828426158, -73.44768269036041, -113.56986608202212, -188.47500547536086, -399.636085620995, -326.0052203164644, -332.1623885868976, -475.55054848846856, -67.40869422795839, -579.5774250832883, -993.3052462105321, -656.024828900985, -362.6632414661293, -494.9251427925544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560864218517406, "mean_inference_ms": 1.7422722915025053, "mean_action_processing_ms": 0.27583485423327625, "mean_env_wait_ms": 3.4480394040126527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011719465255737305, "StateBufferConnector_ms": 0.007857084274291992, "ViewRequirementAgentConnector_ms": 0.19060611724853516}, "num_episodes": 27, "episode_return_max": -42.52253189336269, "episode_return_min": -1425.5449315739038, "episode_return_mean": -562.9070599204446, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.87589557256445, "num_env_steps_trained_throughput_per_sec": 320.87589557256445, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12498.99, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12498.919, "sample_time_ms": 1198.297, "learn_time_ms": 11238.948, "learn_throughput": 355.905, "synch_weights_time_ms": 60.85}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "1e132_00007", "date": "2024-08-04_08-46-03", "timestamp": 1722741363, "time_this_iter_s": 12.477507591247559, "time_total_s": 459.90828347206116, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d314588d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 459.90828347206116, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.105555555555558, "ram_util_percent": 28.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.41722813049952, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.32000885133942, "policy_loss": -0.010311010894171583, "vf_loss": 5.325349958737691, "vf_explained_var": 0.9740511228640875, "kl": 0.011414590566467606, "entropy": 1.6666628398001193, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -42.52253189336269, "episode_reward_min": -1469.0230778550435, "episode_reward_mean": -538.3622778050611, "episode_len_mean": 135.2, "episode_media": {}, "episodes_timesteps_total": 13520, "policy_reward_min": {"policy_0": -1469.0230778550435}, "policy_reward_max": {"policy_0": -42.52253189336269}, "policy_reward_mean": {"policy_0": -538.3622778050611}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-548.8999970487279, -95.77454462037954, -84.07358809316791, -42.52253189336269, -582.1268865940285, -887.9817997078676, -413.52323011121325, -153.68396572618178, -1365.5591532534097, -499.8932068851323, -583.3426711641376, -934.8115943754055, -427.9763565627882, -509.1361337908867, -681.6102874631227, -109.12805502960902, -442.68287604546055, -511.733862233126, -1408.9146121716549, -424.96679743052084, -555.5225381884102, -856.769803689178, -158.99456711632146, -201.8925969055264, -486.0064577919931, -538.9095364989042, -473.62974875665725, -990.5973807596456, -668.7702875348975, -173.85635167711925, -955.0284883306194, -312.96261998843113, -778.4799319887053, -570.5954244527683, -188.58194894257306, -421.1946123781094, -435.22112303189425, -97.24656970348092, -1179.896588719296, -650.3871267338545, -229.6004408561003, -460.20771454659797, -116.20718397124891, -386.1249328382067, -357.3933752376047, -667.6456056237616, -432.49215931366285, -565.1555535697015, -593.4450266403041, -230.31482672058502, -1202.2120782723055, -481.0214373276155, -272.29755709581514, -1222.5248504039369, -425.56046776259984, -1329.1770140904825, -337.25269418047895, -514.1466621117088, -1108.1882615418822, -111.2406701461305, -984.4225828426158, -73.44768269036041, -113.56986608202212, -188.47500547536086, -399.636085620995, -326.0052203164644, -332.1623885868976, -475.55054848846856, -67.40869422795839, -579.5774250832883, -993.3052462105321, -656.024828900985, -362.6632414661293, -494.9251427925544, -1232.2989694234598, -341.68835219874654, -381.7178943177673, -352.39972368088394, -408.1871560555467, -694.8492993996969, -535.7045145514935, -110.39208702001459, -641.9470175154751, -439.3749643718915, -685.153637869285, -1258.1932737264303, -286.78440305606966, -817.4328642711498, -335.9148654421537, -318.9763198514476, -1469.0230778550435, -636.0045914027831, -373.6482963662843, -483.54057418406126, -1091.8794804013953, -430.0049744395276, -1039.4433045372582, -482.1021662031387, -346.0007961360007, -151.29685180517217], "episode_lengths": [150, 66, 64, 47, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 101, 101, 150, 150, 150, 150, 150, 96, 150, 129, 150, 150, 87, 150, 150, 70, 150, 150, 88, 150, 81, 95, 150, 150, 150, 148, 150, 148, 150, 150, 150, 150, 150, 150, 146, 150, 150, 58, 150, 70, 45, 104, 150, 150, 128, 150, 66, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 111], "policy_policy_0_reward": [-548.8999970487279, -95.77454462037954, -84.07358809316791, -42.52253189336269, -582.1268865940285, -887.9817997078676, -413.52323011121325, -153.68396572618178, -1365.5591532534097, -499.8932068851323, -583.3426711641376, -934.8115943754055, -427.9763565627882, -509.1361337908867, -681.6102874631227, -109.12805502960902, -442.68287604546055, -511.733862233126, -1408.9146121716549, -424.96679743052084, -555.5225381884102, -856.769803689178, -158.99456711632146, -201.8925969055264, -486.0064577919931, -538.9095364989042, -473.62974875665725, -990.5973807596456, -668.7702875348975, -173.85635167711925, -955.0284883306194, -312.96261998843113, -778.4799319887053, -570.5954244527683, -188.58194894257306, -421.1946123781094, -435.22112303189425, -97.24656970348092, -1179.896588719296, -650.3871267338545, -229.6004408561003, -460.20771454659797, -116.20718397124891, -386.1249328382067, -357.3933752376047, -667.6456056237616, -432.49215931366285, -565.1555535697015, -593.4450266403041, -230.31482672058502, -1202.2120782723055, -481.0214373276155, -272.29755709581514, -1222.5248504039369, -425.56046776259984, -1329.1770140904825, -337.25269418047895, -514.1466621117088, -1108.1882615418822, -111.2406701461305, -984.4225828426158, -73.44768269036041, -113.56986608202212, -188.47500547536086, -399.636085620995, -326.0052203164644, -332.1623885868976, -475.55054848846856, -67.40869422795839, -579.5774250832883, -993.3052462105321, -656.024828900985, -362.6632414661293, -494.9251427925544, -1232.2989694234598, -341.68835219874654, -381.7178943177673, -352.39972368088394, -408.1871560555467, -694.8492993996969, -535.7045145514935, -110.39208702001459, -641.9470175154751, -439.3749643718915, -685.153637869285, -1258.1932737264303, -286.78440305606966, -817.4328642711498, -335.9148654421537, -318.9763198514476, -1469.0230778550435, -636.0045914027831, -373.6482963662843, -483.54057418406126, -1091.8794804013953, -430.0049744395276, -1039.4433045372582, -482.1021662031387, -346.0007961360007, -151.29685180517217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559291567254548, "mean_inference_ms": 1.739709625134595, "mean_action_processing_ms": 0.2757548635902279, "mean_env_wait_ms": 3.4455471535572038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011605262756347656, "StateBufferConnector_ms": 0.007861137390136719, "ViewRequirementAgentConnector_ms": 0.19106602668762207}, "num_episodes": 26, "episode_return_max": -42.52253189336269, "episode_return_min": -1469.0230778550435, "episode_return_mean": -538.3622778050611, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.1288789581728, "num_env_steps_trained_throughput_per_sec": 314.1288789581728, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12504.238, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12504.167, "sample_time_ms": 1176.669, "learn_time_ms": 11265.662, "learn_throughput": 355.061, "synch_weights_time_ms": 61.011}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "1e132_00007", "date": "2024-08-04_08-46-16", "timestamp": 1722741376, "time_this_iter_s": 12.745585918426514, "time_total_s": 472.65386939048767, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31575fb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 472.65386939048767, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.016666666666666, "ram_util_percent": 28.388888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 214.00462050636608, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.41566354756554, "policy_loss": -0.00920437983343921, "vf_loss": 5.418799402564764, "vf_explained_var": 0.9721006955951452, "kl": 0.01385073953497345, "entropy": 1.642882350832224, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -67.40869422795839, "episode_reward_min": -1469.0230778550435, "episode_reward_mean": -588.0061722012795, "episode_len_mean": 137.71, "episode_media": {}, "episodes_timesteps_total": 13771, "policy_reward_min": {"policy_0": -1469.0230778550435}, "policy_reward_max": {"policy_0": -67.40869422795839}, "policy_reward_mean": {"policy_0": -588.0061722012795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.85635167711925, -955.0284883306194, -312.96261998843113, -778.4799319887053, -570.5954244527683, -188.58194894257306, -421.1946123781094, -435.22112303189425, -97.24656970348092, -1179.896588719296, -650.3871267338545, -229.6004408561003, -460.20771454659797, -116.20718397124891, -386.1249328382067, -357.3933752376047, -667.6456056237616, -432.49215931366285, -565.1555535697015, -593.4450266403041, -230.31482672058502, -1202.2120782723055, -481.0214373276155, -272.29755709581514, -1222.5248504039369, -425.56046776259984, -1329.1770140904825, -337.25269418047895, -514.1466621117088, -1108.1882615418822, -111.2406701461305, -984.4225828426158, -73.44768269036041, -113.56986608202212, -188.47500547536086, -399.636085620995, -326.0052203164644, -332.1623885868976, -475.55054848846856, -67.40869422795839, -579.5774250832883, -993.3052462105321, -656.024828900985, -362.6632414661293, -494.9251427925544, -1232.2989694234598, -341.68835219874654, -381.7178943177673, -352.39972368088394, -408.1871560555467, -694.8492993996969, -535.7045145514935, -110.39208702001459, -641.9470175154751, -439.3749643718915, -685.153637869285, -1258.1932737264303, -286.78440305606966, -817.4328642711498, -335.9148654421537, -318.9763198514476, -1469.0230778550435, -636.0045914027831, -373.6482963662843, -483.54057418406126, -1091.8794804013953, -430.0049744395276, -1039.4433045372582, -482.1021662031387, -346.0007961360007, -151.29685180517217, -1188.4557538869933, -1176.62539660736, -744.2589775110456, -409.49621261797233, -533.506281397321, -902.150167634207, -557.981808929995, -418.11709905269123, -1043.4440741422777, -343.0950181402776, -1191.0884504058943, -1025.913137865373, -732.1378176310764, -1211.7975269127053, -170.199498910272, -558.7879640315934, -378.11679134328347, -1333.5235967025326, -539.0174257643702, -957.8587292478245, -865.5157744148402, -500.9070355432843, -600.9477566041909, -309.7172339586039, -341.6210866586353, -1232.4219459634855, -710.7365079439855, -183.01008699068552, -443.37535025078046], "episode_lengths": [96, 150, 129, 150, 150, 87, 150, 150, 70, 150, 150, 88, 150, 81, 95, 150, 150, 150, 148, 150, 148, 150, 150, 150, 150, 150, 150, 146, 150, 150, 58, 150, 70, 45, 104, 150, 150, 128, 150, 66, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 122, 150, 150, 150, 150, 150, 115, 150, 150, 146, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 86, 150], "policy_policy_0_reward": [-173.85635167711925, -955.0284883306194, -312.96261998843113, -778.4799319887053, -570.5954244527683, -188.58194894257306, -421.1946123781094, -435.22112303189425, -97.24656970348092, -1179.896588719296, -650.3871267338545, -229.6004408561003, -460.20771454659797, -116.20718397124891, -386.1249328382067, -357.3933752376047, -667.6456056237616, -432.49215931366285, -565.1555535697015, -593.4450266403041, -230.31482672058502, -1202.2120782723055, -481.0214373276155, -272.29755709581514, -1222.5248504039369, -425.56046776259984, -1329.1770140904825, -337.25269418047895, -514.1466621117088, -1108.1882615418822, -111.2406701461305, -984.4225828426158, -73.44768269036041, -113.56986608202212, -188.47500547536086, -399.636085620995, -326.0052203164644, -332.1623885868976, -475.55054848846856, -67.40869422795839, -579.5774250832883, -993.3052462105321, -656.024828900985, -362.6632414661293, -494.9251427925544, -1232.2989694234598, -341.68835219874654, -381.7178943177673, -352.39972368088394, -408.1871560555467, -694.8492993996969, -535.7045145514935, -110.39208702001459, -641.9470175154751, -439.3749643718915, -685.153637869285, -1258.1932737264303, -286.78440305606966, -817.4328642711498, -335.9148654421537, -318.9763198514476, -1469.0230778550435, -636.0045914027831, -373.6482963662843, -483.54057418406126, -1091.8794804013953, -430.0049744395276, -1039.4433045372582, -482.1021662031387, -346.0007961360007, -151.29685180517217, -1188.4557538869933, -1176.62539660736, -744.2589775110456, -409.49621261797233, -533.506281397321, -902.150167634207, -557.981808929995, -418.11709905269123, -1043.4440741422777, -343.0950181402776, -1191.0884504058943, -1025.913137865373, -732.1378176310764, -1211.7975269127053, -170.199498910272, -558.7879640315934, -378.11679134328347, -1333.5235967025326, -539.0174257643702, -957.8587292478245, -865.5157744148402, -500.9070355432843, -600.9477566041909, -309.7172339586039, -341.6210866586353, -1232.4219459634855, -710.7365079439855, -183.01008699068552, -443.37535025078046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558946303764299, "mean_inference_ms": 1.7370959937323593, "mean_action_processing_ms": 0.27558446733505604, "mean_env_wait_ms": 3.4445927650311585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934280395507812, "StateBufferConnector_ms": 0.007932662963867188, "ViewRequirementAgentConnector_ms": 0.1935410499572754}, "num_episodes": 29, "episode_return_max": -67.40869422795839, "episode_return_min": -1469.0230778550435, "episode_return_mean": -588.0061722012795, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.5962535893025, "num_env_steps_trained_throughput_per_sec": 307.5962535893025, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12490.486, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12490.414, "sample_time_ms": 1193.119, "learn_time_ms": 11233.234, "learn_throughput": 356.086, "synch_weights_time_ms": 63.234}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "1e132_00007", "date": "2024-08-04_08-46-29", "timestamp": 1722741389, "time_this_iter_s": 13.016048908233643, "time_total_s": 485.6699182987213, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456ff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 485.6699182987213, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.66315789473684, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.7526521285375, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.4938655016322935, "policy_loss": -0.011480853013927117, "vf_loss": 5.499835522969564, "vf_explained_var": 0.9722367332006494, "kl": 0.01253628770452148, "entropy": 1.3048505153506995, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -21.995126877439475, "episode_reward_min": -1469.0230778550435, "episode_reward_mean": -629.9313792921495, "episode_len_mean": 138.95, "episode_media": {}, "episodes_timesteps_total": 13895, "policy_reward_min": {"policy_0": -1469.0230778550435}, "policy_reward_max": {"policy_0": -21.995126877439475}, "policy_reward_mean": {"policy_0": -629.9313792921495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73.44768269036041, -113.56986608202212, -188.47500547536086, -399.636085620995, -326.0052203164644, -332.1623885868976, -475.55054848846856, -67.40869422795839, -579.5774250832883, -993.3052462105321, -656.024828900985, -362.6632414661293, -494.9251427925544, -1232.2989694234598, -341.68835219874654, -381.7178943177673, -352.39972368088394, -408.1871560555467, -694.8492993996969, -535.7045145514935, -110.39208702001459, -641.9470175154751, -439.3749643718915, -685.153637869285, -1258.1932737264303, -286.78440305606966, -817.4328642711498, -335.9148654421537, -318.9763198514476, -1469.0230778550435, -636.0045914027831, -373.6482963662843, -483.54057418406126, -1091.8794804013953, -430.0049744395276, -1039.4433045372582, -482.1021662031387, -346.0007961360007, -151.29685180517217, -1188.4557538869933, -1176.62539660736, -744.2589775110456, -409.49621261797233, -533.506281397321, -902.150167634207, -557.981808929995, -418.11709905269123, -1043.4440741422777, -343.0950181402776, -1191.0884504058943, -1025.913137865373, -732.1378176310764, -1211.7975269127053, -170.199498910272, -558.7879640315934, -378.11679134328347, -1333.5235967025326, -539.0174257643702, -957.8587292478245, -865.5157744148402, -500.9070355432843, -600.9477566041909, -309.7172339586039, -341.6210866586353, -1232.4219459634855, -710.7365079439855, -183.01008699068552, -443.37535025078046, -361.5828749718919, -1111.4530996773726, -360.149215917252, -21.995126877439475, -1118.2082686175281, -735.9178574584087, -383.4363077327622, -1322.1802446348445, -1085.487469331695, -88.68406736054449, -836.644909731154, -935.6009588257558, -701.2504016858597, -499.16505118121137, -559.5921717959432, -1318.9101608882813, -995.0501130123658, -537.8044233811371, -835.4732104974996, -414.9757914458828, -453.3819238433716, -517.6314262428864, -498.70219851634846, -458.4010956976834, -36.069108950194995, -807.8804542419351, -86.3127959086154, -1337.1181759234948, -692.616404376583, -1177.1984778160222, -1296.9272839013863, -396.80151968385167], "episode_lengths": [70, 45, 104, 150, 150, 128, 150, 66, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 122, 150, 150, 150, 150, 150, 115, 150, 150, 146, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 86, 150, 144, 150, 150, 45, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 54, 150, 79, 150, 143, 150, 150, 150], "policy_policy_0_reward": [-73.44768269036041, -113.56986608202212, -188.47500547536086, -399.636085620995, -326.0052203164644, -332.1623885868976, -475.55054848846856, -67.40869422795839, -579.5774250832883, -993.3052462105321, -656.024828900985, -362.6632414661293, -494.9251427925544, -1232.2989694234598, -341.68835219874654, -381.7178943177673, -352.39972368088394, -408.1871560555467, -694.8492993996969, -535.7045145514935, -110.39208702001459, -641.9470175154751, -439.3749643718915, -685.153637869285, -1258.1932737264303, -286.78440305606966, -817.4328642711498, -335.9148654421537, -318.9763198514476, -1469.0230778550435, -636.0045914027831, -373.6482963662843, -483.54057418406126, -1091.8794804013953, -430.0049744395276, -1039.4433045372582, -482.1021662031387, -346.0007961360007, -151.29685180517217, -1188.4557538869933, -1176.62539660736, -744.2589775110456, -409.49621261797233, -533.506281397321, -902.150167634207, -557.981808929995, -418.11709905269123, -1043.4440741422777, -343.0950181402776, -1191.0884504058943, -1025.913137865373, -732.1378176310764, -1211.7975269127053, -170.199498910272, -558.7879640315934, -378.11679134328347, -1333.5235967025326, -539.0174257643702, -957.8587292478245, -865.5157744148402, -500.9070355432843, -600.9477566041909, -309.7172339586039, -341.6210866586353, -1232.4219459634855, -710.7365079439855, -183.01008699068552, -443.37535025078046, -361.5828749718919, -1111.4530996773726, -360.149215917252, -21.995126877439475, -1118.2082686175281, -735.9178574584087, -383.4363077327622, -1322.1802446348445, -1085.487469331695, -88.68406736054449, -836.644909731154, -935.6009588257558, -701.2504016858597, -499.16505118121137, -559.5921717959432, -1318.9101608882813, -995.0501130123658, -537.8044233811371, -835.4732104974996, -414.9757914458828, -453.3819238433716, -517.6314262428864, -498.70219851634846, -458.4010956976834, -36.069108950194995, -807.8804542419351, -86.3127959086154, -1337.1181759234948, -692.616404376583, -1177.1984778160222, -1296.9272839013863, -396.80151968385167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558622885446917, "mean_inference_ms": 1.733765461987594, "mean_action_processing_ms": 0.27533538847993805, "mean_env_wait_ms": 3.4444182040639095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012275934219360352, "StateBufferConnector_ms": 0.008120298385620117, "ViewRequirementAgentConnector_ms": 0.19701266288757324}, "num_episodes": 32, "episode_return_max": -21.995126877439475, "episode_return_min": -1469.0230778550435, "episode_return_mean": -629.9313792921495, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.0309091865982, "num_env_steps_trained_throughput_per_sec": 310.0309091865982, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12483.369, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12483.294, "sample_time_ms": 1185.452, "learn_time_ms": 11234.585, "learn_throughput": 356.043, "synch_weights_time_ms": 62.434}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "1e132_00007", "date": "2024-08-04_08-46-42", "timestamp": 1722741402, "time_this_iter_s": 12.914463996887207, "time_total_s": 498.5843822956085, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 498.5843822956085, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.933333333333334, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.5286218126615, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.163438799977302, "policy_loss": -0.012460082862526178, "vf_loss": 5.17018359452486, "vf_explained_var": 0.9822452417264382, "kl": 0.013064308096075668, "entropy": 1.6364724135647217, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -16.748288761644268, "episode_reward_min": -1470.619714368311, "episode_reward_mean": -646.9231743426648, "episode_len_mean": 138.58, "episode_media": {}, "episodes_timesteps_total": 13858, "policy_reward_min": {"policy_0": -1470.619714368311}, "policy_reward_max": {"policy_0": -16.748288761644268}, "policy_reward_mean": {"policy_0": -646.9231743426648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-636.0045914027831, -373.6482963662843, -483.54057418406126, -1091.8794804013953, -430.0049744395276, -1039.4433045372582, -482.1021662031387, -346.0007961360007, -151.29685180517217, -1188.4557538869933, -1176.62539660736, -744.2589775110456, -409.49621261797233, -533.506281397321, -902.150167634207, -557.981808929995, -418.11709905269123, -1043.4440741422777, -343.0950181402776, -1191.0884504058943, -1025.913137865373, -732.1378176310764, -1211.7975269127053, -170.199498910272, -558.7879640315934, -378.11679134328347, -1333.5235967025326, -539.0174257643702, -957.8587292478245, -865.5157744148402, -500.9070355432843, -600.9477566041909, -309.7172339586039, -341.6210866586353, -1232.4219459634855, -710.7365079439855, -183.01008699068552, -443.37535025078046, -361.5828749718919, -1111.4530996773726, -360.149215917252, -21.995126877439475, -1118.2082686175281, -735.9178574584087, -383.4363077327622, -1322.1802446348445, -1085.487469331695, -88.68406736054449, -836.644909731154, -935.6009588257558, -701.2504016858597, -499.16505118121137, -559.5921717959432, -1318.9101608882813, -995.0501130123658, -537.8044233811371, -835.4732104974996, -414.9757914458828, -453.3819238433716, -517.6314262428864, -498.70219851634846, -458.4010956976834, -36.069108950194995, -807.8804542419351, -86.3127959086154, -1337.1181759234948, -692.616404376583, -1177.1984778160222, -1296.9272839013863, -396.80151968385167, -515.2386727962971, -1009.5059168321047, -349.3769492713993, -52.73173752381282, -268.5472418445348, -123.17424451968564, -421.8021798527736, -850.784765046548, -326.3988718082411, -1221.8318512190158, -639.3109631178941, -649.1928242972064, -270.7159886483353, -183.02557227245418, -1114.1403644926982, -648.2027486656945, -16.748288761644268, -579.4056278485035, -805.140094112106, -1470.619714368311, -324.89357713207215, -61.471109778112385, -433.6610336287623, -354.8633601051568, -657.4279700999778, -1281.2694368254924, -352.2216396761271, -551.7302539462621, -847.4205646441901, -691.1157384646725], "episode_lengths": [150, 147, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 122, 150, 150, 150, 150, 150, 115, 150, 150, 146, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 86, 150, 144, 150, 150, 45, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 54, 150, 79, 150, 143, 150, 150, 150, 150, 150, 150, 53, 150, 73, 150, 150, 150, 150, 150, 150, 112, 94, 150, 150, 45, 150, 150, 150, 150, 66, 150, 143, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-636.0045914027831, -373.6482963662843, -483.54057418406126, -1091.8794804013953, -430.0049744395276, -1039.4433045372582, -482.1021662031387, -346.0007961360007, -151.29685180517217, -1188.4557538869933, -1176.62539660736, -744.2589775110456, -409.49621261797233, -533.506281397321, -902.150167634207, -557.981808929995, -418.11709905269123, -1043.4440741422777, -343.0950181402776, -1191.0884504058943, -1025.913137865373, -732.1378176310764, -1211.7975269127053, -170.199498910272, -558.7879640315934, -378.11679134328347, -1333.5235967025326, -539.0174257643702, -957.8587292478245, -865.5157744148402, -500.9070355432843, -600.9477566041909, -309.7172339586039, -341.6210866586353, -1232.4219459634855, -710.7365079439855, -183.01008699068552, -443.37535025078046, -361.5828749718919, -1111.4530996773726, -360.149215917252, -21.995126877439475, -1118.2082686175281, -735.9178574584087, -383.4363077327622, -1322.1802446348445, -1085.487469331695, -88.68406736054449, -836.644909731154, -935.6009588257558, -701.2504016858597, -499.16505118121137, -559.5921717959432, -1318.9101608882813, -995.0501130123658, -537.8044233811371, -835.4732104974996, -414.9757914458828, -453.3819238433716, -517.6314262428864, -498.70219851634846, -458.4010956976834, -36.069108950194995, -807.8804542419351, -86.3127959086154, -1337.1181759234948, -692.616404376583, -1177.1984778160222, -1296.9272839013863, -396.80151968385167, -515.2386727962971, -1009.5059168321047, -349.3769492713993, -52.73173752381282, -268.5472418445348, -123.17424451968564, -421.8021798527736, -850.784765046548, -326.3988718082411, -1221.8318512190158, -639.3109631178941, -649.1928242972064, -270.7159886483353, -183.02557227245418, -1114.1403644926982, -648.2027486656945, -16.748288761644268, -579.4056278485035, -805.140094112106, -1470.619714368311, -324.89357713207215, -61.471109778112385, -433.6610336287623, -354.8633601051568, -657.4279700999778, -1281.2694368254924, -352.2216396761271, -551.7302539462621, -847.4205646441901, -691.1157384646725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565797004310337, "mean_inference_ms": 1.7321533228161354, "mean_action_processing_ms": 0.27537866246653553, "mean_env_wait_ms": 3.4429925173098566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01244044303894043, "StateBufferConnector_ms": 0.008074283599853516, "ViewRequirementAgentConnector_ms": 0.21175336837768555}, "num_episodes": 30, "episode_return_max": -16.748288761644268, "episode_return_min": -1470.619714368311, "episode_return_mean": -646.9231743426648, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.8941080548044, "num_env_steps_trained_throughput_per_sec": 315.8941080548044, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12443.156, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12443.081, "sample_time_ms": 1171.559, "learn_time_ms": 11207.314, "learn_throughput": 356.91, "synch_weights_time_ms": 63.385}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "1e132_00007", "date": "2024-08-04_08-46-55", "timestamp": 1722741415, "time_this_iter_s": 12.675089359283447, "time_total_s": 511.25947165489197, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456e4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 511.25947165489197, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.03333333333333, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.91093775431315, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.126160840193431, "policy_loss": -0.010574123526263671, "vf_loss": 5.1302623120447, "vf_explained_var": 0.9755217341706157, "kl": 0.014657778201702413, "entropy": 1.2333026291181644, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -11.266498098923575, "episode_reward_min": -1470.619714368311, "episode_reward_mean": -616.5548191145102, "episode_len_mean": 132.78, "episode_media": {}, "episodes_timesteps_total": 13278, "policy_reward_min": {"policy_0": -1470.619714368311}, "policy_reward_max": {"policy_0": -11.266498098923575}, "policy_reward_mean": {"policy_0": -616.5548191145102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.9070355432843, -600.9477566041909, -309.7172339586039, -341.6210866586353, -1232.4219459634855, -710.7365079439855, -183.01008699068552, -443.37535025078046, -361.5828749718919, -1111.4530996773726, -360.149215917252, -21.995126877439475, -1118.2082686175281, -735.9178574584087, -383.4363077327622, -1322.1802446348445, -1085.487469331695, -88.68406736054449, -836.644909731154, -935.6009588257558, -701.2504016858597, -499.16505118121137, -559.5921717959432, -1318.9101608882813, -995.0501130123658, -537.8044233811371, -835.4732104974996, -414.9757914458828, -453.3819238433716, -517.6314262428864, -498.70219851634846, -458.4010956976834, -36.069108950194995, -807.8804542419351, -86.3127959086154, -1337.1181759234948, -692.616404376583, -1177.1984778160222, -1296.9272839013863, -396.80151968385167, -515.2386727962971, -1009.5059168321047, -349.3769492713993, -52.73173752381282, -268.5472418445348, -123.17424451968564, -421.8021798527736, -850.784765046548, -326.3988718082411, -1221.8318512190158, -639.3109631178941, -649.1928242972064, -270.7159886483353, -183.02557227245418, -1114.1403644926982, -648.2027486656945, -16.748288761644268, -579.4056278485035, -805.140094112106, -1470.619714368311, -324.89357713207215, -61.471109778112385, -433.6610336287623, -354.8633601051568, -657.4279700999778, -1281.2694368254924, -352.2216396761271, -551.7302539462621, -847.4205646441901, -691.1157384646725, -1394.818651695331, -912.3290954891253, -108.9646139973047, -939.2766538763846, -1026.2682802395361, -163.8811541979218, -262.876956739137, -139.19638374790776, -78.39881436372757, -489.18975140943314, -1394.4148274976246, -229.0134491052207, -1406.5802677948127, -253.65351191378556, -319.9119566361801, -1344.1954397901318, -690.9908627918882, -167.72126641050343, -110.2860952952105, -394.75798663745087, -242.25685005116122, -609.5121287861017, -933.2875111012954, -423.8717053521047, -1296.598022808556, -858.9494565563167, -11.266498098923575, -1010.130841048502, -90.60315797407577, -974.9708244044364], "episode_lengths": [150, 150, 150, 83, 150, 150, 86, 150, 144, 150, 150, 45, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 54, 150, 79, 150, 143, 150, 150, 150, 150, 150, 150, 53, 150, 73, 150, 150, 150, 150, 150, 150, 112, 94, 150, 150, 45, 150, 150, 150, 150, 66, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 95, 129, 66, 67, 150, 150, 103, 150, 150, 150, 150, 150, 94, 77, 150, 115, 150, 150, 150, 150, 150, 30, 150, 69, 150], "policy_policy_0_reward": [-500.9070355432843, -600.9477566041909, -309.7172339586039, -341.6210866586353, -1232.4219459634855, -710.7365079439855, -183.01008699068552, -443.37535025078046, -361.5828749718919, -1111.4530996773726, -360.149215917252, -21.995126877439475, -1118.2082686175281, -735.9178574584087, -383.4363077327622, -1322.1802446348445, -1085.487469331695, -88.68406736054449, -836.644909731154, -935.6009588257558, -701.2504016858597, -499.16505118121137, -559.5921717959432, -1318.9101608882813, -995.0501130123658, -537.8044233811371, -835.4732104974996, -414.9757914458828, -453.3819238433716, -517.6314262428864, -498.70219851634846, -458.4010956976834, -36.069108950194995, -807.8804542419351, -86.3127959086154, -1337.1181759234948, -692.616404376583, -1177.1984778160222, -1296.9272839013863, -396.80151968385167, -515.2386727962971, -1009.5059168321047, -349.3769492713993, -52.73173752381282, -268.5472418445348, -123.17424451968564, -421.8021798527736, -850.784765046548, -326.3988718082411, -1221.8318512190158, -639.3109631178941, -649.1928242972064, -270.7159886483353, -183.02557227245418, -1114.1403644926982, -648.2027486656945, -16.748288761644268, -579.4056278485035, -805.140094112106, -1470.619714368311, -324.89357713207215, -61.471109778112385, -433.6610336287623, -354.8633601051568, -657.4279700999778, -1281.2694368254924, -352.2216396761271, -551.7302539462621, -847.4205646441901, -691.1157384646725, -1394.818651695331, -912.3290954891253, -108.9646139973047, -939.2766538763846, -1026.2682802395361, -163.8811541979218, -262.876956739137, -139.19638374790776, -78.39881436372757, -489.18975140943314, -1394.4148274976246, -229.0134491052207, -1406.5802677948127, -253.65351191378556, -319.9119566361801, -1344.1954397901318, -690.9908627918882, -167.72126641050343, -110.2860952952105, -394.75798663745087, -242.25685005116122, -609.5121287861017, -933.2875111012954, -423.8717053521047, -1296.598022808556, -858.9494565563167, -11.266498098923575, -1010.130841048502, -90.60315797407577, -974.9708244044364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556419047522846, "mean_inference_ms": 1.7304976843937276, "mean_action_processing_ms": 0.27536846327840203, "mean_env_wait_ms": 3.442566640149204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012348651885986328, "StateBufferConnector_ms": 0.012176752090454102, "ViewRequirementAgentConnector_ms": 0.22424626350402832}, "num_episodes": 30, "episode_return_max": -11.266498098923575, "episode_return_min": -1470.619714368311, "episode_return_mean": -616.5548191145102, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.63988799859794, "num_env_steps_trained_throughput_per_sec": 301.63988799859794, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12863.476, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12863.4, "sample_time_ms": 1144.986, "learn_time_ms": 11652.36, "learn_throughput": 343.278, "synch_weights_time_ms": 65.221}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "1e132_00007", "date": "2024-08-04_08-47-08", "timestamp": 1722741428, "time_this_iter_s": 13.274011135101318, "time_total_s": 524.5334827899933, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d314589d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 524.5334827899933, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.642105263157895, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 208.20288131833075, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.357577146093051, "policy_loss": -0.00976758116739802, "vf_loss": 5.361806845416625, "vf_explained_var": 0.972637526380519, "kl": 0.012576633198447533, "entropy": 1.2159126906345288, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -5.554979100796235, "episode_reward_min": -1506.6400006358401, "episode_reward_mean": -581.7252226759123, "episode_len_mean": 126.86, "episode_media": {}, "episodes_timesteps_total": 12686, "policy_reward_min": {"policy_0": -1506.6400006358401}, "policy_reward_max": {"policy_0": -5.554979100796235}, "policy_reward_mean": {"policy_0": -581.7252226759123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1337.1181759234948, -692.616404376583, -1177.1984778160222, -1296.9272839013863, -396.80151968385167, -515.2386727962971, -1009.5059168321047, -349.3769492713993, -52.73173752381282, -268.5472418445348, -123.17424451968564, -421.8021798527736, -850.784765046548, -326.3988718082411, -1221.8318512190158, -639.3109631178941, -649.1928242972064, -270.7159886483353, -183.02557227245418, -1114.1403644926982, -648.2027486656945, -16.748288761644268, -579.4056278485035, -805.140094112106, -1470.619714368311, -324.89357713207215, -61.471109778112385, -433.6610336287623, -354.8633601051568, -657.4279700999778, -1281.2694368254924, -352.2216396761271, -551.7302539462621, -847.4205646441901, -691.1157384646725, -1394.818651695331, -912.3290954891253, -108.9646139973047, -939.2766538763846, -1026.2682802395361, -163.8811541979218, -262.876956739137, -139.19638374790776, -78.39881436372757, -489.18975140943314, -1394.4148274976246, -229.0134491052207, -1406.5802677948127, -253.65351191378556, -319.9119566361801, -1344.1954397901318, -690.9908627918882, -167.72126641050343, -110.2860952952105, -394.75798663745087, -242.25685005116122, -609.5121287861017, -933.2875111012954, -423.8717053521047, -1296.598022808556, -858.9494565563167, -11.266498098923575, -1010.130841048502, -90.60315797407577, -974.9708244044364, -366.3933377352196, -86.85748545413529, -997.8037606351868, -406.7368803466972, -218.41514502626066, -627.7272100838568, -80.59706726964357, -43.18352086262577, -60.236257232558344, -679.0208506041852, -337.3847889139122, -1308.3801400307177, -761.7116738652824, -5.554979100796235, -19.89983826664007, -1506.6400006358401, -49.54331038047458, -909.9554644953909, -1042.914419744981, -17.0472483701053, -678.6956314222673, -408.52329048264454, -1004.3782657087326, -309.2088328697998, -405.17650501690883, -1205.5546044694518, -210.92586803284405, -882.3401763230871, -884.2856419861291, -263.03503816994765, -608.6332973805776, -26.96144706935321, -568.2745685936513, -307.81859008041783, -631.9029518193754], "episode_lengths": [150, 143, 150, 150, 150, 150, 150, 150, 53, 150, 73, 150, 150, 150, 150, 150, 150, 112, 94, 150, 150, 45, 150, 150, 150, 150, 66, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 95, 129, 66, 67, 150, 150, 103, 150, 150, 150, 150, 150, 94, 77, 150, 115, 150, 150, 150, 150, 150, 30, 150, 69, 150, 150, 69, 150, 150, 71, 150, 70, 60, 61, 150, 135, 150, 150, 31, 42, 150, 55, 150, 150, 35, 150, 150, 150, 150, 150, 150, 86, 150, 150, 116, 150, 46, 150, 127, 150], "policy_policy_0_reward": [-1337.1181759234948, -692.616404376583, -1177.1984778160222, -1296.9272839013863, -396.80151968385167, -515.2386727962971, -1009.5059168321047, -349.3769492713993, -52.73173752381282, -268.5472418445348, -123.17424451968564, -421.8021798527736, -850.784765046548, -326.3988718082411, -1221.8318512190158, -639.3109631178941, -649.1928242972064, -270.7159886483353, -183.02557227245418, -1114.1403644926982, -648.2027486656945, -16.748288761644268, -579.4056278485035, -805.140094112106, -1470.619714368311, -324.89357713207215, -61.471109778112385, -433.6610336287623, -354.8633601051568, -657.4279700999778, -1281.2694368254924, -352.2216396761271, -551.7302539462621, -847.4205646441901, -691.1157384646725, -1394.818651695331, -912.3290954891253, -108.9646139973047, -939.2766538763846, -1026.2682802395361, -163.8811541979218, -262.876956739137, -139.19638374790776, -78.39881436372757, -489.18975140943314, -1394.4148274976246, -229.0134491052207, -1406.5802677948127, -253.65351191378556, -319.9119566361801, -1344.1954397901318, -690.9908627918882, -167.72126641050343, -110.2860952952105, -394.75798663745087, -242.25685005116122, -609.5121287861017, -933.2875111012954, -423.8717053521047, -1296.598022808556, -858.9494565563167, -11.266498098923575, -1010.130841048502, -90.60315797407577, -974.9708244044364, -366.3933377352196, -86.85748545413529, -997.8037606351868, -406.7368803466972, -218.41514502626066, -627.7272100838568, -80.59706726964357, -43.18352086262577, -60.236257232558344, -679.0208506041852, -337.3847889139122, -1308.3801400307177, -761.7116738652824, -5.554979100796235, -19.89983826664007, -1506.6400006358401, -49.54331038047458, -909.9554644953909, -1042.914419744981, -17.0472483701053, -678.6956314222673, -408.52329048264454, -1004.3782657087326, -309.2088328697998, -405.17650501690883, -1205.5546044694518, -210.92586803284405, -882.3401763230871, -884.2856419861291, -263.03503816994765, -608.6332973805776, -26.96144706935321, -568.2745685936513, -307.81859008041783, -631.9029518193754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556669001751066, "mean_inference_ms": 1.7293110992926466, "mean_action_processing_ms": 0.2754808786613734, "mean_env_wait_ms": 3.440476947274239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012541532516479492, "StateBufferConnector_ms": 0.01201009750366211, "ViewRequirementAgentConnector_ms": 0.21998095512390137}, "num_episodes": 35, "episode_return_max": -5.554979100796235, "episode_return_min": -1506.6400006358401, "episode_return_mean": -581.7252226759123, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.0695997977646, "num_env_steps_trained_throughput_per_sec": 300.0695997977646, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12888.288, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12888.212, "sample_time_ms": 1129.739, "learn_time_ms": 11692.438, "learn_throughput": 342.101, "synch_weights_time_ms": 65.201}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "1e132_00007", "date": "2024-08-04_08-47-21", "timestamp": 1722741441, "time_this_iter_s": 13.343249559402466, "time_total_s": 537.8767323493958, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31458a680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 537.8767323493958, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.557894736842105, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.03002601265908, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.488739940524101, "policy_loss": -0.006862553824612405, "vf_loss": 5.4898703669508295, "vf_explained_var": 0.9681074691936373, "kl": 0.013013276347131422, "entropy": 1.2384852052976687, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -5.554979100796235, "episode_reward_min": -1506.6400006358401, "episode_reward_mean": -551.8824004460739, "episode_len_mean": 126.42, "episode_media": {}, "episodes_timesteps_total": 12642, "policy_reward_min": {"policy_0": -1506.6400006358401}, "policy_reward_max": {"policy_0": -5.554979100796235}, "policy_reward_mean": {"policy_0": -551.8824004460739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-352.2216396761271, -551.7302539462621, -847.4205646441901, -691.1157384646725, -1394.818651695331, -912.3290954891253, -108.9646139973047, -939.2766538763846, -1026.2682802395361, -163.8811541979218, -262.876956739137, -139.19638374790776, -78.39881436372757, -489.18975140943314, -1394.4148274976246, -229.0134491052207, -1406.5802677948127, -253.65351191378556, -319.9119566361801, -1344.1954397901318, -690.9908627918882, -167.72126641050343, -110.2860952952105, -394.75798663745087, -242.25685005116122, -609.5121287861017, -933.2875111012954, -423.8717053521047, -1296.598022808556, -858.9494565563167, -11.266498098923575, -1010.130841048502, -90.60315797407577, -974.9708244044364, -366.3933377352196, -86.85748545413529, -997.8037606351868, -406.7368803466972, -218.41514502626066, -627.7272100838568, -80.59706726964357, -43.18352086262577, -60.236257232558344, -679.0208506041852, -337.3847889139122, -1308.3801400307177, -761.7116738652824, -5.554979100796235, -19.89983826664007, -1506.6400006358401, -49.54331038047458, -909.9554644953909, -1042.914419744981, -17.0472483701053, -678.6956314222673, -408.52329048264454, -1004.3782657087326, -309.2088328697998, -405.17650501690883, -1205.5546044694518, -210.92586803284405, -882.3401763230871, -884.2856419861291, -263.03503816994765, -608.6332973805776, -26.96144706935321, -568.2745685936513, -307.81859008041783, -631.9029518193754, -818.5444852031709, -484.3669357190998, -343.93700140905037, -310.8401898094149, -365.8270773898073, -67.19302539391025, -390.67676360867785, -750.4175339323815, -965.6351525613914, -810.0091491460366, -1184.1862683556346, -34.546565987079745, -411.5532408873528, -555.7991318231327, -622.2113909420575, -471.976967883162, -545.5876988584389, -660.0551221199855, -460.7572365673962, -524.7731938106074, -922.1387748904463, -111.71750614194724, -295.3384527058395, -30.959547425486683, -613.8538375539831, -975.5339504022926, -1249.65858965793, -490.8391056139084, -619.2630825761665, -113.8803467159453, -343.7834184946126], "episode_lengths": [150, 150, 150, 150, 150, 150, 58, 150, 150, 95, 129, 66, 67, 150, 150, 103, 150, 150, 150, 150, 150, 94, 77, 150, 115, 150, 150, 150, 150, 150, 30, 150, 69, 150, 150, 69, 150, 150, 71, 150, 70, 60, 61, 150, 135, 150, 150, 31, 42, 150, 55, 150, 150, 35, 150, 150, 150, 150, 150, 150, 86, 150, 150, 116, 150, 46, 150, 127, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 50, 128, 150, 115, 150, 150, 150, 149, 150, 150, 67, 133, 47, 150, 150, 150, 150, 150, 79, 150], "policy_policy_0_reward": [-352.2216396761271, -551.7302539462621, -847.4205646441901, -691.1157384646725, -1394.818651695331, -912.3290954891253, -108.9646139973047, -939.2766538763846, -1026.2682802395361, -163.8811541979218, -262.876956739137, -139.19638374790776, -78.39881436372757, -489.18975140943314, -1394.4148274976246, -229.0134491052207, -1406.5802677948127, -253.65351191378556, -319.9119566361801, -1344.1954397901318, -690.9908627918882, -167.72126641050343, -110.2860952952105, -394.75798663745087, -242.25685005116122, -609.5121287861017, -933.2875111012954, -423.8717053521047, -1296.598022808556, -858.9494565563167, -11.266498098923575, -1010.130841048502, -90.60315797407577, -974.9708244044364, -366.3933377352196, -86.85748545413529, -997.8037606351868, -406.7368803466972, -218.41514502626066, -627.7272100838568, -80.59706726964357, -43.18352086262577, -60.236257232558344, -679.0208506041852, -337.3847889139122, -1308.3801400307177, -761.7116738652824, -5.554979100796235, -19.89983826664007, -1506.6400006358401, -49.54331038047458, -909.9554644953909, -1042.914419744981, -17.0472483701053, -678.6956314222673, -408.52329048264454, -1004.3782657087326, -309.2088328697998, -405.17650501690883, -1205.5546044694518, -210.92586803284405, -882.3401763230871, -884.2856419861291, -263.03503816994765, -608.6332973805776, -26.96144706935321, -568.2745685936513, -307.81859008041783, -631.9029518193754, -818.5444852031709, -484.3669357190998, -343.93700140905037, -310.8401898094149, -365.8270773898073, -67.19302539391025, -390.67676360867785, -750.4175339323815, -965.6351525613914, -810.0091491460366, -1184.1862683556346, -34.546565987079745, -411.5532408873528, -555.7991318231327, -622.2113909420575, -471.976967883162, -545.5876988584389, -660.0551221199855, -460.7572365673962, -524.7731938106074, -922.1387748904463, -111.71750614194724, -295.3384527058395, -30.959547425486683, -613.8538375539831, -975.5339504022926, -1249.65858965793, -490.8391056139084, -619.2630825761665, -113.8803467159453, -343.7834184946126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567730689019776, "mean_inference_ms": 1.728575486166694, "mean_action_processing_ms": 0.2753418383034671, "mean_env_wait_ms": 3.4407567147345244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012571096420288086, "StateBufferConnector_ms": 0.012082338333129883, "ViewRequirementAgentConnector_ms": 0.20477509498596191}, "num_episodes": 31, "episode_return_max": -5.554979100796235, "episode_return_min": -1506.6400006358401, "episode_return_mean": -551.8824004460739, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.0070766730208, "num_env_steps_trained_throughput_per_sec": 308.0070766730208, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12894.66, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12894.585, "sample_time_ms": 1126.332, "learn_time_ms": 11700.15, "learn_throughput": 341.876, "synch_weights_time_ms": 67.313}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "1e132_00007", "date": "2024-08-04_08-47-34", "timestamp": 1722741454, "time_this_iter_s": 12.998286724090576, "time_total_s": 550.8750190734863, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456c790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 550.8750190734863, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.805263157894736, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.14519138733547, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.177124874542157, "policy_loss": -0.013828408643894364, "vf_loss": 5.184531438350677, "vf_explained_var": 0.9786958969508608, "kl": 0.014606971998182417, "entropy": 1.5128328547502556, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -5.554979100796235, "episode_reward_min": -1545.358530903216, "episode_reward_mean": -512.9671923834848, "episode_len_mean": 123.14, "episode_media": {}, "episodes_timesteps_total": 12314, "policy_reward_min": {"policy_0": -1545.358530903216}, "policy_reward_max": {"policy_0": -5.554979100796235}, "policy_reward_mean": {"policy_0": -512.9671923834848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.85748545413529, -997.8037606351868, -406.7368803466972, -218.41514502626066, -627.7272100838568, -80.59706726964357, -43.18352086262577, -60.236257232558344, -679.0208506041852, -337.3847889139122, -1308.3801400307177, -761.7116738652824, -5.554979100796235, -19.89983826664007, -1506.6400006358401, -49.54331038047458, -909.9554644953909, -1042.914419744981, -17.0472483701053, -678.6956314222673, -408.52329048264454, -1004.3782657087326, -309.2088328697998, -405.17650501690883, -1205.5546044694518, -210.92586803284405, -882.3401763230871, -884.2856419861291, -263.03503816994765, -608.6332973805776, -26.96144706935321, -568.2745685936513, -307.81859008041783, -631.9029518193754, -818.5444852031709, -484.3669357190998, -343.93700140905037, -310.8401898094149, -365.8270773898073, -67.19302539391025, -390.67676360867785, -750.4175339323815, -965.6351525613914, -810.0091491460366, -1184.1862683556346, -34.546565987079745, -411.5532408873528, -555.7991318231327, -622.2113909420575, -471.976967883162, -545.5876988584389, -660.0551221199855, -460.7572365673962, -524.7731938106074, -922.1387748904463, -111.71750614194724, -295.3384527058395, -30.959547425486683, -613.8538375539831, -975.5339504022926, -1249.65858965793, -490.8391056139084, -619.2630825761665, -113.8803467159453, -343.7834184946126, -1545.358530903216, -101.3451105374692, -812.0756415364432, -437.0069797835864, -376.86853323144294, -94.13407254421726, -31.546558332805738, -1106.1920323891277, -361.06177938715643, -33.9667161436146, -570.8505544287391, -505.8198711987384, -163.57567346209603, -622.4815557754436, -855.4395827845391, -139.44088251156793, -1108.1684491673875, -770.3353975356795, -61.45371898970491, -1279.7310561043998, -305.97835843058454, -181.28355692004752, -497.08303518866944, -1030.6473590239573, -185.87028024367584, -28.935269577152592, -25.876014572050238, -327.7484839963149, -467.636026378133, -1086.1352225881003, -15.70949974266323, -380.1335539152645, -1132.514534880834, -198.38925671640908, -354.74059509642615], "episode_lengths": [69, 150, 150, 71, 150, 70, 60, 61, 150, 135, 150, 150, 31, 42, 150, 55, 150, 150, 35, 150, 150, 150, 150, 150, 150, 86, 150, 150, 116, 150, 46, 150, 127, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 50, 128, 150, 115, 150, 150, 150, 149, 150, 150, 67, 133, 47, 150, 150, 150, 150, 150, 79, 150, 150, 74, 150, 150, 150, 74, 53, 150, 135, 47, 150, 150, 80, 150, 150, 85, 150, 150, 54, 150, 107, 105, 150, 150, 80, 48, 43, 150, 150, 150, 40, 150, 150, 150, 150], "policy_policy_0_reward": [-86.85748545413529, -997.8037606351868, -406.7368803466972, -218.41514502626066, -627.7272100838568, -80.59706726964357, -43.18352086262577, -60.236257232558344, -679.0208506041852, -337.3847889139122, -1308.3801400307177, -761.7116738652824, -5.554979100796235, -19.89983826664007, -1506.6400006358401, -49.54331038047458, -909.9554644953909, -1042.914419744981, -17.0472483701053, -678.6956314222673, -408.52329048264454, -1004.3782657087326, -309.2088328697998, -405.17650501690883, -1205.5546044694518, -210.92586803284405, -882.3401763230871, -884.2856419861291, -263.03503816994765, -608.6332973805776, -26.96144706935321, -568.2745685936513, -307.81859008041783, -631.9029518193754, -818.5444852031709, -484.3669357190998, -343.93700140905037, -310.8401898094149, -365.8270773898073, -67.19302539391025, -390.67676360867785, -750.4175339323815, -965.6351525613914, -810.0091491460366, -1184.1862683556346, -34.546565987079745, -411.5532408873528, -555.7991318231327, -622.2113909420575, -471.976967883162, -545.5876988584389, -660.0551221199855, -460.7572365673962, -524.7731938106074, -922.1387748904463, -111.71750614194724, -295.3384527058395, -30.959547425486683, -613.8538375539831, -975.5339504022926, -1249.65858965793, -490.8391056139084, -619.2630825761665, -113.8803467159453, -343.7834184946126, -1545.358530903216, -101.3451105374692, -812.0756415364432, -437.0069797835864, -376.86853323144294, -94.13407254421726, -31.546558332805738, -1106.1920323891277, -361.06177938715643, -33.9667161436146, -570.8505544287391, -505.8198711987384, -163.57567346209603, -622.4815557754436, -855.4395827845391, -139.44088251156793, -1108.1684491673875, -770.3353975356795, -61.45371898970491, -1279.7310561043998, -305.97835843058454, -181.28355692004752, -497.08303518866944, -1030.6473590239573, -185.87028024367584, -28.935269577152592, -25.876014572050238, -327.7484839963149, -467.636026378133, -1086.1352225881003, -15.70949974266323, -380.1335539152645, -1132.514534880834, -198.38925671640908, -354.74059509642615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568091720006862, "mean_inference_ms": 1.727388640042537, "mean_action_processing_ms": 0.27531396348419185, "mean_env_wait_ms": 3.438241154716576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012771129608154297, "StateBufferConnector_ms": 0.007927656173706055, "ViewRequirementAgentConnector_ms": 0.19267773628234863}, "num_episodes": 35, "episode_return_max": -5.554979100796235, "episode_return_min": -1545.358530903216, "episode_return_mean": -512.9671923834848, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.3358205891976, "num_env_steps_trained_throughput_per_sec": 316.3358205891976, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12844.8, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12844.726, "sample_time_ms": 1128.68, "learn_time_ms": 11648.386, "learn_throughput": 343.395, "synch_weights_time_ms": 66.876}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "1e132_00007", "date": "2024-08-04_08-47-47", "timestamp": 1722741467, "time_this_iter_s": 12.656963586807251, "time_total_s": 563.5319826602936, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456ea70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 563.5319826602936, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.833333333333332, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.617493524154, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.387147165834904, "policy_loss": -0.011104340005840641, "vf_loss": 5.392242717991272, "vf_explained_var": 0.9786923199271162, "kl": 0.013670867550308755, "entropy": 1.4310956549520293, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -15.70949974266323, "episode_reward_min": -1545.358530903216, "episode_reward_mean": -526.873059586282, "episode_len_mean": 125.01, "episode_media": {}, "episodes_timesteps_total": 12501, "policy_reward_min": {"policy_0": -1545.358530903216}, "policy_reward_max": {"policy_0": -15.70949974266323}, "policy_reward_mean": {"policy_0": -526.873059586282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-568.2745685936513, -307.81859008041783, -631.9029518193754, -818.5444852031709, -484.3669357190998, -343.93700140905037, -310.8401898094149, -365.8270773898073, -67.19302539391025, -390.67676360867785, -750.4175339323815, -965.6351525613914, -810.0091491460366, -1184.1862683556346, -34.546565987079745, -411.5532408873528, -555.7991318231327, -622.2113909420575, -471.976967883162, -545.5876988584389, -660.0551221199855, -460.7572365673962, -524.7731938106074, -922.1387748904463, -111.71750614194724, -295.3384527058395, -30.959547425486683, -613.8538375539831, -975.5339504022926, -1249.65858965793, -490.8391056139084, -619.2630825761665, -113.8803467159453, -343.7834184946126, -1545.358530903216, -101.3451105374692, -812.0756415364432, -437.0069797835864, -376.86853323144294, -94.13407254421726, -31.546558332805738, -1106.1920323891277, -361.06177938715643, -33.9667161436146, -570.8505544287391, -505.8198711987384, -163.57567346209603, -622.4815557754436, -855.4395827845391, -139.44088251156793, -1108.1684491673875, -770.3353975356795, -61.45371898970491, -1279.7310561043998, -305.97835843058454, -181.28355692004752, -497.08303518866944, -1030.6473590239573, -185.87028024367584, -28.935269577152592, -25.876014572050238, -327.7484839963149, -467.636026378133, -1086.1352225881003, -15.70949974266323, -380.1335539152645, -1132.514534880834, -198.38925671640908, -354.74059509642615, -775.5715106396821, -127.87576774605205, -64.7813425019239, -580.0328629915437, -990.9465074856837, -986.8974416251782, -392.9769450807381, -123.37211717473531, -916.4705094595222, -179.5403714115383, -279.45046958042474, -1287.1913252813922, -869.5058978259509, -534.2239997306264, -27.338688797359378, -1128.2924686593342, -1247.5126125845893, -978.4854361269847, -25.549383831143945, -1284.3684729729243, -357.29709323276194, -334.51181995250033, -1120.5732799903471, -156.5226644241182, -473.0271753998463, -690.7389661687646, -24.096347949606315, -138.7863815166669, -245.4784901907568, -89.48443426828175, -1007.0145759297832], "episode_lengths": [150, 127, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 50, 128, 150, 115, 150, 150, 150, 149, 150, 150, 67, 133, 47, 150, 150, 150, 150, 150, 79, 150, 150, 74, 150, 150, 150, 74, 53, 150, 135, 47, 150, 150, 80, 150, 150, 85, 150, 150, 54, 150, 107, 105, 150, 150, 80, 48, 43, 150, 150, 150, 40, 150, 150, 150, 150, 150, 79, 70, 150, 150, 150, 150, 82, 150, 87, 128, 150, 150, 150, 45, 150, 150, 150, 49, 150, 134, 134, 150, 92, 133, 150, 42, 90, 135, 64, 150], "policy_policy_0_reward": [-568.2745685936513, -307.81859008041783, -631.9029518193754, -818.5444852031709, -484.3669357190998, -343.93700140905037, -310.8401898094149, -365.8270773898073, -67.19302539391025, -390.67676360867785, -750.4175339323815, -965.6351525613914, -810.0091491460366, -1184.1862683556346, -34.546565987079745, -411.5532408873528, -555.7991318231327, -622.2113909420575, -471.976967883162, -545.5876988584389, -660.0551221199855, -460.7572365673962, -524.7731938106074, -922.1387748904463, -111.71750614194724, -295.3384527058395, -30.959547425486683, -613.8538375539831, -975.5339504022926, -1249.65858965793, -490.8391056139084, -619.2630825761665, -113.8803467159453, -343.7834184946126, -1545.358530903216, -101.3451105374692, -812.0756415364432, -437.0069797835864, -376.86853323144294, -94.13407254421726, -31.546558332805738, -1106.1920323891277, -361.06177938715643, -33.9667161436146, -570.8505544287391, -505.8198711987384, -163.57567346209603, -622.4815557754436, -855.4395827845391, -139.44088251156793, -1108.1684491673875, -770.3353975356795, -61.45371898970491, -1279.7310561043998, -305.97835843058454, -181.28355692004752, -497.08303518866944, -1030.6473590239573, -185.87028024367584, -28.935269577152592, -25.876014572050238, -327.7484839963149, -467.636026378133, -1086.1352225881003, -15.70949974266323, -380.1335539152645, -1132.514534880834, -198.38925671640908, -354.74059509642615, -775.5715106396821, -127.87576774605205, -64.7813425019239, -580.0328629915437, -990.9465074856837, -986.8974416251782, -392.9769450807381, -123.37211717473531, -916.4705094595222, -179.5403714115383, -279.45046958042474, -1287.1913252813922, -869.5058978259509, -534.2239997306264, -27.338688797359378, -1128.2924686593342, -1247.5126125845893, -978.4854361269847, -25.549383831143945, -1284.3684729729243, -357.29709323276194, -334.51181995250033, -1120.5732799903471, -156.5226644241182, -473.0271753998463, -690.7389661687646, -24.096347949606315, -138.7863815166669, -245.4784901907568, -89.48443426828175, -1007.0145759297832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565649815923899, "mean_inference_ms": 1.7254972851049586, "mean_action_processing_ms": 0.27509225486511507, "mean_env_wait_ms": 3.434627120650473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012375593185424805, "StateBufferConnector_ms": 0.007964134216308594, "ViewRequirementAgentConnector_ms": 0.19343209266662598}, "num_episodes": 31, "episode_return_max": -15.70949974266323, "episode_return_min": -1545.358530903216, "episode_return_mean": -526.873059586282, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.9758340803637, "num_env_steps_trained_throughput_per_sec": 308.9758340803637, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12893.669, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12893.596, "sample_time_ms": 1127.462, "learn_time_ms": 11698.954, "learn_throughput": 341.911, "synch_weights_time_ms": 66.388}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "1e132_00007", "date": "2024-08-04_08-48-00", "timestamp": 1722741480, "time_this_iter_s": 12.956968545913696, "time_total_s": 576.4889512062073, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 576.4889512062073, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.06111111111111, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 253.22962245146434, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.066008275498946, "policy_loss": -0.0047664138304147246, "vf_loss": 5.064406847457091, "vf_explained_var": 0.9792386976381143, "kl": 0.014531678668231508, "entropy": 1.7140707816928624, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -10.535526087975157, "episode_reward_min": -1545.358530903216, "episode_reward_mean": -550.0649200639849, "episode_len_mean": 124.09, "episode_media": {}, "episodes_timesteps_total": 12409, "policy_reward_min": {"policy_0": -1545.358530903216}, "policy_reward_max": {"policy_0": -10.535526087975157}, "policy_reward_mean": {"policy_0": -550.0649200639849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1249.65858965793, -490.8391056139084, -619.2630825761665, -113.8803467159453, -343.7834184946126, -1545.358530903216, -101.3451105374692, -812.0756415364432, -437.0069797835864, -376.86853323144294, -94.13407254421726, -31.546558332805738, -1106.1920323891277, -361.06177938715643, -33.9667161436146, -570.8505544287391, -505.8198711987384, -163.57567346209603, -622.4815557754436, -855.4395827845391, -139.44088251156793, -1108.1684491673875, -770.3353975356795, -61.45371898970491, -1279.7310561043998, -305.97835843058454, -181.28355692004752, -497.08303518866944, -1030.6473590239573, -185.87028024367584, -28.935269577152592, -25.876014572050238, -327.7484839963149, -467.636026378133, -1086.1352225881003, -15.70949974266323, -380.1335539152645, -1132.514534880834, -198.38925671640908, -354.74059509642615, -775.5715106396821, -127.87576774605205, -64.7813425019239, -580.0328629915437, -990.9465074856837, -986.8974416251782, -392.9769450807381, -123.37211717473531, -916.4705094595222, -179.5403714115383, -279.45046958042474, -1287.1913252813922, -869.5058978259509, -534.2239997306264, -27.338688797359378, -1128.2924686593342, -1247.5126125845893, -978.4854361269847, -25.549383831143945, -1284.3684729729243, -357.29709323276194, -334.51181995250033, -1120.5732799903471, -156.5226644241182, -473.0271753998463, -690.7389661687646, -24.096347949606315, -138.7863815166669, -245.4784901907568, -89.48443426828175, -1007.0145759297832, -381.86084863586444, -153.70088406199528, -1009.6167493969631, -272.5445013841434, -819.5321471201083, -1184.0524567941018, -105.23593246719372, -764.300439773708, -117.16986586201537, -10.535526087975157, -1085.153960992377, -27.97496853422254, -474.719106536257, -1023.9942744717443, -792.969777917406, -902.6459091137291, -250.64232508470522, -1068.379077153772, -455.9677726079219, -999.9267784245839, -510.5412476832348, -760.8393635163933, -460.60280028225066, -979.4144606806581, -745.0990224314914, -643.4287755487696, -316.6582402517664, -314.80013252835175, -923.3110134477963], "episode_lengths": [150, 150, 150, 79, 150, 150, 74, 150, 150, 150, 74, 53, 150, 135, 47, 150, 150, 80, 150, 150, 85, 150, 150, 54, 150, 107, 105, 150, 150, 80, 48, 43, 150, 150, 150, 40, 150, 150, 150, 150, 150, 79, 70, 150, 150, 150, 150, 82, 150, 87, 128, 150, 150, 150, 45, 150, 150, 150, 49, 150, 134, 134, 150, 92, 133, 150, 42, 90, 135, 64, 150, 150, 88, 150, 119, 150, 150, 66, 150, 73, 35, 150, 49, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150], "policy_policy_0_reward": [-1249.65858965793, -490.8391056139084, -619.2630825761665, -113.8803467159453, -343.7834184946126, -1545.358530903216, -101.3451105374692, -812.0756415364432, -437.0069797835864, -376.86853323144294, -94.13407254421726, -31.546558332805738, -1106.1920323891277, -361.06177938715643, -33.9667161436146, -570.8505544287391, -505.8198711987384, -163.57567346209603, -622.4815557754436, -855.4395827845391, -139.44088251156793, -1108.1684491673875, -770.3353975356795, -61.45371898970491, -1279.7310561043998, -305.97835843058454, -181.28355692004752, -497.08303518866944, -1030.6473590239573, -185.87028024367584, -28.935269577152592, -25.876014572050238, -327.7484839963149, -467.636026378133, -1086.1352225881003, -15.70949974266323, -380.1335539152645, -1132.514534880834, -198.38925671640908, -354.74059509642615, -775.5715106396821, -127.87576774605205, -64.7813425019239, -580.0328629915437, -990.9465074856837, -986.8974416251782, -392.9769450807381, -123.37211717473531, -916.4705094595222, -179.5403714115383, -279.45046958042474, -1287.1913252813922, -869.5058978259509, -534.2239997306264, -27.338688797359378, -1128.2924686593342, -1247.5126125845893, -978.4854361269847, -25.549383831143945, -1284.3684729729243, -357.29709323276194, -334.51181995250033, -1120.5732799903471, -156.5226644241182, -473.0271753998463, -690.7389661687646, -24.096347949606315, -138.7863815166669, -245.4784901907568, -89.48443426828175, -1007.0145759297832, -381.86084863586444, -153.70088406199528, -1009.6167493969631, -272.5445013841434, -819.5321471201083, -1184.0524567941018, -105.23593246719372, -764.300439773708, -117.16986586201537, -10.535526087975157, -1085.153960992377, -27.97496853422254, -474.719106536257, -1023.9942744717443, -792.969777917406, -902.6459091137291, -250.64232508470522, -1068.379077153772, -455.9677726079219, -999.9267784245839, -510.5412476832348, -760.8393635163933, -460.60280028225066, -979.4144606806581, -745.0990224314914, -643.4287755487696, -316.6582402517664, -314.80013252835175, -923.3110134477963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556362129358783, "mean_inference_ms": 1.7235258211314226, "mean_action_processing_ms": 0.2748384283150856, "mean_env_wait_ms": 3.433095978268533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012011289596557617, "StateBufferConnector_ms": 0.007978439331054688, "ViewRequirementAgentConnector_ms": 0.1935868263244629}, "num_episodes": 29, "episode_return_max": -10.535526087975157, "episode_return_min": -1545.358530903216, "episode_return_mean": -550.0649200639849, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.7451311345054, "num_env_steps_trained_throughput_per_sec": 319.7451311345054, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12898.078, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12898.003, "sample_time_ms": 1135.016, "learn_time_ms": 11696.116, "learn_throughput": 341.994, "synch_weights_time_ms": 66.082}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "1e132_00007", "date": "2024-08-04_08-48-13", "timestamp": 1722741493, "time_this_iter_s": 12.521846771240234, "time_total_s": 589.0107979774475, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31458a050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 589.0107979774475, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.038888888888884, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 199.09315544565519, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.845277094344298, "policy_loss": -0.011483707206692392, "vf_loss": 5.850092646231254, "vf_explained_var": 0.9662253394102057, "kl": 0.015146777437307014, "entropy": 1.4788357066611448, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -10.535526087975157, "episode_reward_min": -1566.2179946185213, "episode_reward_mean": -598.7488556500562, "episode_len_mean": 130.04, "episode_media": {}, "episodes_timesteps_total": 13004, "policy_reward_min": {"policy_0": -1566.2179946185213}, "policy_reward_max": {"policy_0": -10.535526087975157}, "policy_reward_mean": {"policy_0": -598.7488556500562}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.87028024367584, -28.935269577152592, -25.876014572050238, -327.7484839963149, -467.636026378133, -1086.1352225881003, -15.70949974266323, -380.1335539152645, -1132.514534880834, -198.38925671640908, -354.74059509642615, -775.5715106396821, -127.87576774605205, -64.7813425019239, -580.0328629915437, -990.9465074856837, -986.8974416251782, -392.9769450807381, -123.37211717473531, -916.4705094595222, -179.5403714115383, -279.45046958042474, -1287.1913252813922, -869.5058978259509, -534.2239997306264, -27.338688797359378, -1128.2924686593342, -1247.5126125845893, -978.4854361269847, -25.549383831143945, -1284.3684729729243, -357.29709323276194, -334.51181995250033, -1120.5732799903471, -156.5226644241182, -473.0271753998463, -690.7389661687646, -24.096347949606315, -138.7863815166669, -245.4784901907568, -89.48443426828175, -1007.0145759297832, -381.86084863586444, -153.70088406199528, -1009.6167493969631, -272.5445013841434, -819.5321471201083, -1184.0524567941018, -105.23593246719372, -764.300439773708, -117.16986586201537, -10.535526087975157, -1085.153960992377, -27.97496853422254, -474.719106536257, -1023.9942744717443, -792.969777917406, -902.6459091137291, -250.64232508470522, -1068.379077153772, -455.9677726079219, -999.9267784245839, -510.5412476832348, -760.8393635163933, -460.60280028225066, -979.4144606806581, -745.0990224314914, -643.4287755487696, -316.6582402517664, -314.80013252835175, -923.3110134477963, -654.0894350189308, -465.40499149727356, -1160.5432355095263, -853.4956735222394, -372.1265930101976, -1013.2702105818039, -960.1174156114203, -1099.5492048697192, -1053.0159558982875, -335.97024954307665, -1177.7859466881462, -449.54670963553417, -808.6203042969267, -694.9741391991155, -393.89881432522856, -950.1281601810986, -1131.048991918197, -1090.2236891411278, -301.7165450096391, -486.69897643411565, -569.0325045103455, -526.6391678977024, -974.8364546786933, -467.2513537505089, -1566.2179946185213, -342.0013555957036, -198.7658473544732, -554.6106480931103, -26.08253958567078], "episode_lengths": [80, 48, 43, 150, 150, 150, 40, 150, 150, 150, 150, 150, 79, 70, 150, 150, 150, 150, 82, 150, 87, 128, 150, 150, 150, 45, 150, 150, 150, 49, 150, 134, 134, 150, 92, 133, 150, 42, 90, 135, 64, 150, 150, 88, 150, 119, 150, 150, 66, 150, 73, 35, 150, 49, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 135, 124, 46], "policy_policy_0_reward": [-185.87028024367584, -28.935269577152592, -25.876014572050238, -327.7484839963149, -467.636026378133, -1086.1352225881003, -15.70949974266323, -380.1335539152645, -1132.514534880834, -198.38925671640908, -354.74059509642615, -775.5715106396821, -127.87576774605205, -64.7813425019239, -580.0328629915437, -990.9465074856837, -986.8974416251782, -392.9769450807381, -123.37211717473531, -916.4705094595222, -179.5403714115383, -279.45046958042474, -1287.1913252813922, -869.5058978259509, -534.2239997306264, -27.338688797359378, -1128.2924686593342, -1247.5126125845893, -978.4854361269847, -25.549383831143945, -1284.3684729729243, -357.29709323276194, -334.51181995250033, -1120.5732799903471, -156.5226644241182, -473.0271753998463, -690.7389661687646, -24.096347949606315, -138.7863815166669, -245.4784901907568, -89.48443426828175, -1007.0145759297832, -381.86084863586444, -153.70088406199528, -1009.6167493969631, -272.5445013841434, -819.5321471201083, -1184.0524567941018, -105.23593246719372, -764.300439773708, -117.16986586201537, -10.535526087975157, -1085.153960992377, -27.97496853422254, -474.719106536257, -1023.9942744717443, -792.969777917406, -902.6459091137291, -250.64232508470522, -1068.379077153772, -455.9677726079219, -999.9267784245839, -510.5412476832348, -760.8393635163933, -460.60280028225066, -979.4144606806581, -745.0990224314914, -643.4287755487696, -316.6582402517664, -314.80013252835175, -923.3110134477963, -654.0894350189308, -465.40499149727356, -1160.5432355095263, -853.4956735222394, -372.1265930101976, -1013.2702105818039, -960.1174156114203, -1099.5492048697192, -1053.0159558982875, -335.97024954307665, -1177.7859466881462, -449.54670963553417, -808.6203042969267, -694.9741391991155, -393.89881432522856, -950.1281601810986, -1131.048991918197, -1090.2236891411278, -301.7165450096391, -486.69897643411565, -569.0325045103455, -526.6391678977024, -974.8364546786933, -467.2513537505089, -1566.2179946185213, -342.0013555957036, -198.7658473544732, -554.6106480931103, -26.08253958567078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564123387621137, "mean_inference_ms": 1.7223031349704179, "mean_action_processing_ms": 0.2750307475669432, "mean_env_wait_ms": 3.4312056463703486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012088537216186523, "StateBufferConnector_ms": 0.007950067520141602, "ViewRequirementAgentConnector_ms": 0.19400858879089355}, "num_episodes": 29, "episode_return_max": -10.535526087975157, "episode_return_min": -1566.2179946185213, "episode_return_mean": -598.7488556500562, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.9767868996131, "num_env_steps_trained_throughput_per_sec": 318.9767868996131, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12878.725, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12878.651, "sample_time_ms": 1133.783, "learn_time_ms": 11677.291, "learn_throughput": 342.545, "synch_weights_time_ms": 66.785}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "1e132_00007", "date": "2024-08-04_08-48-25", "timestamp": 1722741505, "time_this_iter_s": 12.554147958755493, "time_total_s": 601.564945936203, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d314589b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 601.564945936203, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.95555555555556, "ram_util_percent": 28.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 237.6597980717818, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.111042301605145, "policy_loss": -0.006847831827568976, "vf_loss": 5.111930432915687, "vf_explained_var": 0.9727677389358481, "kl": 0.013558740139039098, "entropy": 1.417101863026619, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -10.535526087975157, "episode_reward_min": -1566.2179946185213, "episode_reward_mean": -604.1292035510662, "episode_len_mean": 133.85, "episode_media": {}, "episodes_timesteps_total": 13385, "policy_reward_min": {"policy_0": -1566.2179946185213}, "policy_reward_max": {"policy_0": -10.535526087975157}, "policy_reward_mean": {"policy_0": -604.1292035510662}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-357.29709323276194, -334.51181995250033, -1120.5732799903471, -156.5226644241182, -473.0271753998463, -690.7389661687646, -24.096347949606315, -138.7863815166669, -245.4784901907568, -89.48443426828175, -1007.0145759297832, -381.86084863586444, -153.70088406199528, -1009.6167493969631, -272.5445013841434, -819.5321471201083, -1184.0524567941018, -105.23593246719372, -764.300439773708, -117.16986586201537, -10.535526087975157, -1085.153960992377, -27.97496853422254, -474.719106536257, -1023.9942744717443, -792.969777917406, -902.6459091137291, -250.64232508470522, -1068.379077153772, -455.9677726079219, -999.9267784245839, -510.5412476832348, -760.8393635163933, -460.60280028225066, -979.4144606806581, -745.0990224314914, -643.4287755487696, -316.6582402517664, -314.80013252835175, -923.3110134477963, -654.0894350189308, -465.40499149727356, -1160.5432355095263, -853.4956735222394, -372.1265930101976, -1013.2702105818039, -960.1174156114203, -1099.5492048697192, -1053.0159558982875, -335.97024954307665, -1177.7859466881462, -449.54670963553417, -808.6203042969267, -694.9741391991155, -393.89881432522856, -950.1281601810986, -1131.048991918197, -1090.2236891411278, -301.7165450096391, -486.69897643411565, -569.0325045103455, -526.6391678977024, -974.8364546786933, -467.2513537505089, -1566.2179946185213, -342.0013555957036, -198.7658473544732, -554.6106480931103, -26.08253958567078, -366.2903996828584, -496.38343862178476, -626.7674992560861, -492.1110132387959, -107.99597159219161, -541.2643049960227, -381.7849127640319, -941.3345370327858, -1063.3620104838333, -317.7909406095878, -130.38698905208906, -345.1475228095494, -285.4164095171422, -681.7431705969615, -216.22564520143902, -1229.637123628782, -97.12943507367436, -1157.1200036940168, -443.28503352341176, -1048.39977670832, -729.835315031123, -803.7221679410977, -37.812188539849934, -1080.4058843163623, -227.18813384243074, -374.4853775151408, -228.0241500174407, -383.96103409541973, -662.7862418275754, -1186.4813863816473, -857.8296417239027], "episode_lengths": [134, 134, 150, 92, 133, 150, 42, 90, 135, 64, 150, 150, 88, 150, 119, 150, 150, 66, 150, 73, 35, 150, 49, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 135, 124, 46, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 96, 150, 150, 150, 131, 150, 50, 150, 150, 150, 150, 150, 52, 150, 79, 150, 102, 150, 124, 150, 150], "policy_policy_0_reward": [-357.29709323276194, -334.51181995250033, -1120.5732799903471, -156.5226644241182, -473.0271753998463, -690.7389661687646, -24.096347949606315, -138.7863815166669, -245.4784901907568, -89.48443426828175, -1007.0145759297832, -381.86084863586444, -153.70088406199528, -1009.6167493969631, -272.5445013841434, -819.5321471201083, -1184.0524567941018, -105.23593246719372, -764.300439773708, -117.16986586201537, -10.535526087975157, -1085.153960992377, -27.97496853422254, -474.719106536257, -1023.9942744717443, -792.969777917406, -902.6459091137291, -250.64232508470522, -1068.379077153772, -455.9677726079219, -999.9267784245839, -510.5412476832348, -760.8393635163933, -460.60280028225066, -979.4144606806581, -745.0990224314914, -643.4287755487696, -316.6582402517664, -314.80013252835175, -923.3110134477963, -654.0894350189308, -465.40499149727356, -1160.5432355095263, -853.4956735222394, -372.1265930101976, -1013.2702105818039, -960.1174156114203, -1099.5492048697192, -1053.0159558982875, -335.97024954307665, -1177.7859466881462, -449.54670963553417, -808.6203042969267, -694.9741391991155, -393.89881432522856, -950.1281601810986, -1131.048991918197, -1090.2236891411278, -301.7165450096391, -486.69897643411565, -569.0325045103455, -526.6391678977024, -974.8364546786933, -467.2513537505089, -1566.2179946185213, -342.0013555957036, -198.7658473544732, -554.6106480931103, -26.08253958567078, -366.2903996828584, -496.38343862178476, -626.7674992560861, -492.1110132387959, -107.99597159219161, -541.2643049960227, -381.7849127640319, -941.3345370327858, -1063.3620104838333, -317.7909406095878, -130.38698905208906, -345.1475228095494, -285.4164095171422, -681.7431705969615, -216.22564520143902, -1229.637123628782, -97.12943507367436, -1157.1200036940168, -443.28503352341176, -1048.39977670832, -729.835315031123, -803.7221679410977, -37.812188539849934, -1080.4058843163623, -227.18813384243074, -374.4853775151408, -228.0241500174407, -383.96103409541973, -662.7862418275754, -1186.4813863816473, -857.8296417239027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563466694937474, "mean_inference_ms": 1.721278333507569, "mean_action_processing_ms": 0.27504914902760075, "mean_env_wait_ms": 3.42799671967618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012041330337524414, "StateBufferConnector_ms": 0.007944345474243164, "ViewRequirementAgentConnector_ms": 0.19427895545959473}, "num_episodes": 31, "episode_return_max": -10.535526087975157, "episode_return_min": -1566.2179946185213, "episode_return_mean": -604.1292035510662, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.8081258356143, "num_env_steps_trained_throughput_per_sec": 384.8081258356143, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12617.798, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12617.725, "sample_time_ms": 1123.194, "learn_time_ms": 11428.133, "learn_throughput": 350.013, "synch_weights_time_ms": 65.605}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "1e132_00007", "date": "2024-08-04_08-48-36", "timestamp": 1722741516, "time_this_iter_s": 10.407165050506592, "time_total_s": 611.9721109867096, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3145885e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 611.9721109867096, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 19.61333333333333, "ram_util_percent": 28.393333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.68746374249457, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.600973996768395, "policy_loss": -0.004975144833345742, "vf_loss": 5.6002372642358145, "vf_explained_var": 0.9724962372953693, "kl": 0.01298732150195671, "entropy": 1.324036758641402, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -16.006643568024835, "episode_reward_min": -1566.2179946185213, "episode_reward_mean": -599.1516050727247, "episode_len_mean": 130.84, "episode_media": {}, "episodes_timesteps_total": 13084, "policy_reward_min": {"policy_0": -1566.2179946185213}, "policy_reward_max": {"policy_0": -16.006643568024835}, "policy_reward_mean": {"policy_0": -599.1516050727247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-460.60280028225066, -979.4144606806581, -745.0990224314914, -643.4287755487696, -316.6582402517664, -314.80013252835175, -923.3110134477963, -654.0894350189308, -465.40499149727356, -1160.5432355095263, -853.4956735222394, -372.1265930101976, -1013.2702105818039, -960.1174156114203, -1099.5492048697192, -1053.0159558982875, -335.97024954307665, -1177.7859466881462, -449.54670963553417, -808.6203042969267, -694.9741391991155, -393.89881432522856, -950.1281601810986, -1131.048991918197, -1090.2236891411278, -301.7165450096391, -486.69897643411565, -569.0325045103455, -526.6391678977024, -974.8364546786933, -467.2513537505089, -1566.2179946185213, -342.0013555957036, -198.7658473544732, -554.6106480931103, -26.08253958567078, -366.2903996828584, -496.38343862178476, -626.7674992560861, -492.1110132387959, -107.99597159219161, -541.2643049960227, -381.7849127640319, -941.3345370327858, -1063.3620104838333, -317.7909406095878, -130.38698905208906, -345.1475228095494, -285.4164095171422, -681.7431705969615, -216.22564520143902, -1229.637123628782, -97.12943507367436, -1157.1200036940168, -443.28503352341176, -1048.39977670832, -729.835315031123, -803.7221679410977, -37.812188539849934, -1080.4058843163623, -227.18813384243074, -374.4853775151408, -228.0241500174407, -383.96103409541973, -662.7862418275754, -1186.4813863816473, -857.8296417239027, -408.9545507263469, -196.14833238087564, -895.3018598571601, -1043.61659383179, -932.4797185785721, -83.05042815093879, -787.278745455228, -826.5550117255632, -16.006643568024835, -39.06043375930983, -221.01839434636744, -300.435820922558, -857.5872222675364, -95.96027896800797, -636.2856445720895, -995.2400180550746, -472.4865800113752, -398.7079236066013, -20.860644112977706, -1081.4434028051312, -1173.239598427251, -1007.3921907495721, -249.61206295166863, -130.63765262184452, -92.66239065177162, -1060.9628577123615, -616.4378755409856, -1024.5122191247597, -889.3878413069323, -496.775215024252, -140.53696373879006, -93.12537367565076, -28.314805582340423], "episode_lengths": [150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 135, 124, 46, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 96, 150, 150, 150, 131, 150, 50, 150, 150, 150, 150, 150, 52, 150, 79, 150, 102, 150, 124, 150, 150, 150, 104, 150, 150, 150, 67, 150, 150, 45, 54, 65, 106, 150, 73, 125, 150, 150, 150, 45, 150, 150, 150, 75, 88, 53, 150, 150, 150, 150, 150, 71, 60, 44], "policy_policy_0_reward": [-460.60280028225066, -979.4144606806581, -745.0990224314914, -643.4287755487696, -316.6582402517664, -314.80013252835175, -923.3110134477963, -654.0894350189308, -465.40499149727356, -1160.5432355095263, -853.4956735222394, -372.1265930101976, -1013.2702105818039, -960.1174156114203, -1099.5492048697192, -1053.0159558982875, -335.97024954307665, -1177.7859466881462, -449.54670963553417, -808.6203042969267, -694.9741391991155, -393.89881432522856, -950.1281601810986, -1131.048991918197, -1090.2236891411278, -301.7165450096391, -486.69897643411565, -569.0325045103455, -526.6391678977024, -974.8364546786933, -467.2513537505089, -1566.2179946185213, -342.0013555957036, -198.7658473544732, -554.6106480931103, -26.08253958567078, -366.2903996828584, -496.38343862178476, -626.7674992560861, -492.1110132387959, -107.99597159219161, -541.2643049960227, -381.7849127640319, -941.3345370327858, -1063.3620104838333, -317.7909406095878, -130.38698905208906, -345.1475228095494, -285.4164095171422, -681.7431705969615, -216.22564520143902, -1229.637123628782, -97.12943507367436, -1157.1200036940168, -443.28503352341176, -1048.39977670832, -729.835315031123, -803.7221679410977, -37.812188539849934, -1080.4058843163623, -227.18813384243074, -374.4853775151408, -228.0241500174407, -383.96103409541973, -662.7862418275754, -1186.4813863816473, -857.8296417239027, -408.9545507263469, -196.14833238087564, -895.3018598571601, -1043.61659383179, -932.4797185785721, -83.05042815093879, -787.278745455228, -826.5550117255632, -16.006643568024835, -39.06043375930983, -221.01839434636744, -300.435820922558, -857.5872222675364, -95.96027896800797, -636.2856445720895, -995.2400180550746, -472.4865800113752, -398.7079236066013, -20.860644112977706, -1081.4434028051312, -1173.239598427251, -1007.3921907495721, -249.61206295166863, -130.63765262184452, -92.66239065177162, -1060.9628577123615, -616.4378755409856, -1024.5122191247597, -889.3878413069323, -496.775215024252, -140.53696373879006, -93.12537367565076, -28.314805582340423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563883751388312, "mean_inference_ms": 1.7208035645974962, "mean_action_processing_ms": 0.2750117612568618, "mean_env_wait_ms": 3.4264476605411023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012479543685913086, "StateBufferConnector_ms": 0.007958173751831055, "ViewRequirementAgentConnector_ms": 0.1967768669128418}, "num_episodes": 33, "episode_return_max": -16.006643568024835, "episode_return_min": -1566.2179946185213, "episode_return_mean": -599.1516050727247, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.35314317484773, "num_env_steps_trained_throughput_per_sec": 373.35314317484773, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12398.975, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12398.903, "sample_time_ms": 1123.948, "learn_time_ms": 11208.451, "learn_throughput": 356.874, "synch_weights_time_ms": 65.708}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "1e132_00007", "date": "2024-08-04_08-48-46", "timestamp": 1722741526, "time_this_iter_s": 10.724787473678589, "time_total_s": 622.6968984603882, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d31456f5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 622.6968984603882, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.399999999999995, "ram_util_percent": 28.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 228.99309440453848, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0005000000000000002, "total_loss": 5.101659984638293, "policy_loss": -0.008418472795165144, "vf_loss": 5.1045156841476755, "vf_explained_var": 0.9851751647268733, "kl": 0.01268945558622369, "entropy": 1.4748299453407525, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -16.006643568024835, "episode_reward_min": -1442.3727646217833, "episode_reward_mean": -496.5835721324708, "episode_len_mean": 121.43, "episode_media": {}, "episodes_timesteps_total": 12143, "policy_reward_min": {"policy_0": -1442.3727646217833}, "policy_reward_max": {"policy_0": -16.006643568024835}, "policy_reward_mean": {"policy_0": -496.5835721324708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.0013555957036, -198.7658473544732, -554.6106480931103, -26.08253958567078, -366.2903996828584, -496.38343862178476, -626.7674992560861, -492.1110132387959, -107.99597159219161, -541.2643049960227, -381.7849127640319, -941.3345370327858, -1063.3620104838333, -317.7909406095878, -130.38698905208906, -345.1475228095494, -285.4164095171422, -681.7431705969615, -216.22564520143902, -1229.637123628782, -97.12943507367436, -1157.1200036940168, -443.28503352341176, -1048.39977670832, -729.835315031123, -803.7221679410977, -37.812188539849934, -1080.4058843163623, -227.18813384243074, -374.4853775151408, -228.0241500174407, -383.96103409541973, -662.7862418275754, -1186.4813863816473, -857.8296417239027, -408.9545507263469, -196.14833238087564, -895.3018598571601, -1043.61659383179, -932.4797185785721, -83.05042815093879, -787.278745455228, -826.5550117255632, -16.006643568024835, -39.06043375930983, -221.01839434636744, -300.435820922558, -857.5872222675364, -95.96027896800797, -636.2856445720895, -995.2400180550746, -472.4865800113752, -398.7079236066013, -20.860644112977706, -1081.4434028051312, -1173.239598427251, -1007.3921907495721, -249.61206295166863, -130.63765262184452, -92.66239065177162, -1060.9628577123615, -616.4378755409856, -1024.5122191247597, -889.3878413069323, -496.775215024252, -140.53696373879006, -93.12537367565076, -28.314805582340423, -702.0526810723768, -17.43664457476139, -379.8328262898297, -43.32452780768878, -1244.5039665266247, -506.8023379106406, -274.5659068245995, -86.97156391808934, -1347.40281653083, -94.83284684836744, -81.43711355140907, -233.01293202608505, -1442.3727646217833, -905.0857576080779, -61.4157695932821, -589.8483237133911, -820.7016701721252, -812.6084832258761, -150.96745628270395, -260.1526608627841, -418.29310772995814, -136.5968615410465, -295.8506742790465, -63.1768662847096, -407.63724948619574, -93.42088266179331, -350.6268725702663, -891.2557518287304, -67.5453279841936, -243.88053235360132, -225.24041159178967, -433.8602802204048], "episode_lengths": [150, 135, 124, 46, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 96, 150, 150, 150, 131, 150, 50, 150, 150, 150, 150, 150, 52, 150, 79, 150, 102, 150, 124, 150, 150, 150, 104, 150, 150, 150, 67, 150, 150, 45, 54, 65, 106, 150, 73, 125, 150, 150, 150, 45, 150, 150, 150, 75, 88, 53, 150, 150, 150, 150, 150, 71, 60, 44, 150, 39, 150, 47, 150, 150, 150, 71, 150, 60, 69, 150, 150, 150, 64, 150, 150, 150, 82, 150, 150, 88, 150, 66, 150, 80, 150, 150, 53, 81, 131, 150], "policy_policy_0_reward": [-342.0013555957036, -198.7658473544732, -554.6106480931103, -26.08253958567078, -366.2903996828584, -496.38343862178476, -626.7674992560861, -492.1110132387959, -107.99597159219161, -541.2643049960227, -381.7849127640319, -941.3345370327858, -1063.3620104838333, -317.7909406095878, -130.38698905208906, -345.1475228095494, -285.4164095171422, -681.7431705969615, -216.22564520143902, -1229.637123628782, -97.12943507367436, -1157.1200036940168, -443.28503352341176, -1048.39977670832, -729.835315031123, -803.7221679410977, -37.812188539849934, -1080.4058843163623, -227.18813384243074, -374.4853775151408, -228.0241500174407, -383.96103409541973, -662.7862418275754, -1186.4813863816473, -857.8296417239027, -408.9545507263469, -196.14833238087564, -895.3018598571601, -1043.61659383179, -932.4797185785721, -83.05042815093879, -787.278745455228, -826.5550117255632, -16.006643568024835, -39.06043375930983, -221.01839434636744, -300.435820922558, -857.5872222675364, -95.96027896800797, -636.2856445720895, -995.2400180550746, -472.4865800113752, -398.7079236066013, -20.860644112977706, -1081.4434028051312, -1173.239598427251, -1007.3921907495721, -249.61206295166863, -130.63765262184452, -92.66239065177162, -1060.9628577123615, -616.4378755409856, -1024.5122191247597, -889.3878413069323, -496.775215024252, -140.53696373879006, -93.12537367565076, -28.314805582340423, -702.0526810723768, -17.43664457476139, -379.8328262898297, -43.32452780768878, -1244.5039665266247, -506.8023379106406, -274.5659068245995, -86.97156391808934, -1347.40281653083, -94.83284684836744, -81.43711355140907, -233.01293202608505, -1442.3727646217833, -905.0857576080779, -61.4157695932821, -589.8483237133911, -820.7016701721252, -812.6084832258761, -150.96745628270395, -260.1526608627841, -418.29310772995814, -136.5968615410465, -295.8506742790465, -63.1768662847096, -407.63724948619574, -93.42088266179331, -350.6268725702663, -891.2557518287304, -67.5453279841936, -243.88053235360132, -225.24041159178967, -433.8602802204048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556241660241926, "mean_inference_ms": 1.7197446553153086, "mean_action_processing_ms": 0.2749026010314899, "mean_env_wait_ms": 3.4275695990085837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012412548065185547, "StateBufferConnector_ms": 0.008063077926635742, "ViewRequirementAgentConnector_ms": 0.19455647468566895}, "num_episodes": 32, "episode_return_max": -16.006643568024835, "episode_return_min": -1442.3727646217833, "episode_return_mean": -496.5835721324708, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.68594880934376, "num_env_steps_trained_throughput_per_sec": 491.68594880934376, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 11946.256, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11946.181, "sample_time_ms": 1123.308, "learn_time_ms": 10756.82, "learn_throughput": 371.857, "synch_weights_time_ms": 65.26}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "training_iteration": 50, "trial_id": "1e132_00007", "date": "2024-08-04_08-48-55", "timestamp": 1722741535, "time_this_iter_s": 8.14702820777893, "time_total_s": 630.8439266681671, "pid": 613908, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3157a6e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 630.8439266681671, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.57272727272727, "ram_util_percent": 28.390909090909087}}
