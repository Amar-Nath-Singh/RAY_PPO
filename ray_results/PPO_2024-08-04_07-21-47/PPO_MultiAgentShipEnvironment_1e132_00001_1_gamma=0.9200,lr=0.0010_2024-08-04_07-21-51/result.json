{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7579610392761726, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.249853804210822, "policy_loss": -0.0056576831976902515, "vf_loss": 9.25363240391016, "vf_explained_var": 0.020099013609190784, "kl": 0.010104598929888197, "entropy": 1.4187070081631343, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -11.438259457292986, "episode_reward_min": -1327.860002992333, "episode_reward_mean": -715.3988450526049, "episode_len_mean": 119.22222222222223, "episode_media": {}, "episodes_timesteps_total": 3219, "policy_reward_min": {"policy_0": -1327.860002992333}, "policy_reward_max": {"policy_0": -11.438259457292986}, "policy_reward_mean": {"policy_0": -715.3988450526049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.16973409735725, -1111.8040738507937, -385.6844467948571, -160.3444865322858, -140.38551198072463, -1150.3806502378056, -1167.17092220062, -1149.294526926402, -1079.4947649870992, -64.97713752829301, -595.0232428517497, -1156.2631650281307, -1118.3528260802923, -1034.45535161726, -1047.7023324449567, -1172.597997282236, -1022.0661978201649, -892.3419493515124, -394.2759026510796, -11.438259457292986, -596.8706645093829, -263.4407048748865, -426.45143837592036, -611.1986548376908, -14.216769642427536, -1133.5071014667774, -1327.860002992333], "episode_lengths": [59, 150, 89, 66, 71, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 124, 33, 150, 75, 99, 118, 42, 150, 150], "policy_policy_0_reward": [-88.16973409735725, -1111.8040738507937, -385.6844467948571, -160.3444865322858, -140.38551198072463, -1150.3806502378056, -1167.17092220062, -1149.294526926402, -1079.4947649870992, -64.97713752829301, -595.0232428517497, -1156.2631650281307, -1118.3528260802923, -1034.45535161726, -1047.7023324449567, -1172.597997282236, -1022.0661978201649, -892.3419493515124, -394.2759026510796, -11.438259457292986, -596.8706645093829, -263.4407048748865, -426.45143837592036, -611.1986548376908, -14.216769642427536, -1133.5071014667774, -1327.860002992333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5686759896531546, "mean_inference_ms": 1.6570081022369638, "mean_action_processing_ms": 0.2756781561534306, "mean_env_wait_ms": 3.3993514845755923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01148029609962746, "StateBufferConnector_ms": 0.00820159912109375, "ViewRequirementAgentConnector_ms": 0.1808078200728805}, "num_episodes": 27, "episode_return_max": -11.438259457292986, "episode_return_min": -1327.860002992333, "episode_return_mean": -715.3988450526049, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.9363626982087, "num_env_steps_trained_throughput_per_sec": 313.9363626982087, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12741.446, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12741.375, "sample_time_ms": 1092.731, "learn_time_ms": 11581.824, "learn_throughput": 345.369, "synch_weights_time_ms": 66.059}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1e132_00001", "date": "2024-08-04_07-33-08", "timestamp": 1722736988, "time_this_iter_s": 12.75278639793396, "time_total_s": 12.75278639793396, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc0d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.75278639793396, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.21578947368421, "ram_util_percent": 27.99473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.585612262785435, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.017603729665279, "policy_loss": -0.008293477474944666, "vf_loss": 8.023561539252599, "vf_explained_var": 0.3321166122953097, "kl": 0.012368069085035434, "entropy": 1.3794319135447344, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -11.438259457292986, "episode_reward_min": -1327.860002992333, "episode_reward_mean": -625.4185991721175, "episode_len_mean": 112.8135593220339, "episode_media": {}, "episodes_timesteps_total": 6656, "policy_reward_min": {"policy_0": -1327.860002992333}, "policy_reward_max": {"policy_0": -11.438259457292986}, "policy_reward_mean": {"policy_0": -625.4185991721175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.16973409735725, -1111.8040738507937, -385.6844467948571, -160.3444865322858, -140.38551198072463, -1150.3806502378056, -1167.17092220062, -1149.294526926402, -1079.4947649870992, -64.97713752829301, -595.0232428517497, -1156.2631650281307, -1118.3528260802923, -1034.45535161726, -1047.7023324449567, -1172.597997282236, -1022.0661978201649, -892.3419493515124, -394.2759026510796, -11.438259457292986, -596.8706645093829, -263.4407048748865, -426.45143837592036, -611.1986548376908, -14.216769642427536, -1133.5071014667774, -1327.860002992333, -903.407183728068, -979.2902495628996, -11.546949571458637, -750.4009646346988, -45.38027885074041, -878.9697721875586, -320.4249138766615, -225.47726386848942, -703.03020559963, -973.7028084196397, -1120.5945375631013, -757.5571698701187, -1235.8701905916375, -171.16090158064353, -1146.14442442463, -245.3866135685102, -92.15505282275815, -1283.6303797127648, -1123.885327035579, -40.16572749093255, -1058.616310735987, -111.45839013035702, -194.4115595572835, -771.6684344008478, -760.6332395945896, -170.87161342033994, -131.6354090644949, -238.8042441321403, -682.3445268572034, -79.28460881511401, -88.19424324278746, -287.8250398229445], "episode_lengths": [59, 150, 89, 66, 71, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 124, 33, 150, 75, 99, 118, 42, 150, 150, 150, 150, 37, 150, 39, 150, 104, 72, 150, 150, 150, 150, 150, 67, 150, 93, 45, 150, 150, 41, 150, 53, 77, 150, 150, 61, 60, 90, 150, 48, 67, 83], "policy_policy_0_reward": [-88.16973409735725, -1111.8040738507937, -385.6844467948571, -160.3444865322858, -140.38551198072463, -1150.3806502378056, -1167.17092220062, -1149.294526926402, -1079.4947649870992, -64.97713752829301, -595.0232428517497, -1156.2631650281307, -1118.3528260802923, -1034.45535161726, -1047.7023324449567, -1172.597997282236, -1022.0661978201649, -892.3419493515124, -394.2759026510796, -11.438259457292986, -596.8706645093829, -263.4407048748865, -426.45143837592036, -611.1986548376908, -14.216769642427536, -1133.5071014667774, -1327.860002992333, -903.407183728068, -979.2902495628996, -11.546949571458637, -750.4009646346988, -45.38027885074041, -878.9697721875586, -320.4249138766615, -225.47726386848942, -703.03020559963, -973.7028084196397, -1120.5945375631013, -757.5571698701187, -1235.8701905916375, -171.16090158064353, -1146.14442442463, -245.3866135685102, -92.15505282275815, -1283.6303797127648, -1123.885327035579, -40.16572749093255, -1058.616310735987, -111.45839013035702, -194.4115595572835, -771.6684344008478, -760.6332395945896, -170.87161342033994, -131.6354090644949, -238.8042441321403, -682.3445268572034, -79.28460881511401, -88.19424324278746, -287.8250398229445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.568195836515161, "mean_inference_ms": 1.6544871402742396, "mean_action_processing_ms": 0.2767976996604561, "mean_env_wait_ms": 3.3862874672787067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013909097445213188, "StateBufferConnector_ms": 0.00840647745940645, "ViewRequirementAgentConnector_ms": 0.1871981863248146}, "num_episodes": 32, "episode_return_max": -11.438259457292986, "episode_return_min": -1327.860002992333, "episode_return_mean": -625.4185991721175, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.35191492399485, "num_env_steps_trained_throughput_per_sec": 386.35191492399485, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11547.356, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11547.289, "sample_time_ms": 1086.848, "learn_time_ms": 10383.186, "learn_throughput": 385.238, "synch_weights_time_ms": 76.452}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1e132_00001", "date": "2024-08-04_07-33-19", "timestamp": 1722736999, "time_this_iter_s": 10.365613222122192, "time_total_s": 23.118399620056152, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a6a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.118399620056152, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.85714285714286, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.90873967284958, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.2523699320852755, "policy_loss": -0.004917445334528262, "vf_loss": 6.2550751775503155, "vf_explained_var": 0.6385585595543186, "kl": 0.011752143230175234, "entropy": 1.3820168272902569, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -11.438259457292986, "episode_reward_min": -1465.6816798682512, "episode_reward_mean": -672.8979060225719, "episode_len_mean": 117.77777777777777, "episode_media": {}, "episodes_timesteps_total": 10600, "policy_reward_min": {"policy_0": -1465.6816798682512}, "policy_reward_max": {"policy_0": -11.438259457292986}, "policy_reward_mean": {"policy_0": -672.8979060225719}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.16973409735725, -1111.8040738507937, -385.6844467948571, -160.3444865322858, -140.38551198072463, -1150.3806502378056, -1167.17092220062, -1149.294526926402, -1079.4947649870992, -64.97713752829301, -595.0232428517497, -1156.2631650281307, -1118.3528260802923, -1034.45535161726, -1047.7023324449567, -1172.597997282236, -1022.0661978201649, -892.3419493515124, -394.2759026510796, -11.438259457292986, -596.8706645093829, -263.4407048748865, -426.45143837592036, -611.1986548376908, -14.216769642427536, -1133.5071014667774, -1327.860002992333, -903.407183728068, -979.2902495628996, -11.546949571458637, -750.4009646346988, -45.38027885074041, -878.9697721875586, -320.4249138766615, -225.47726386848942, -703.03020559963, -973.7028084196397, -1120.5945375631013, -757.5571698701187, -1235.8701905916375, -171.16090158064353, -1146.14442442463, -245.3866135685102, -92.15505282275815, -1283.6303797127648, -1123.885327035579, -40.16572749093255, -1058.616310735987, -111.45839013035702, -194.4115595572835, -771.6684344008478, -760.6332395945896, -170.87161342033994, -131.6354090644949, -238.8042441321403, -682.3445268572034, -79.28460881511401, -88.19424324278746, -287.8250398229445, -939.5142388650623, -444.5440440805309, -964.3731983299901, -1144.514850388469, -604.2642346822614, -104.32898271038333, -223.49402231129926, -1098.1619860153248, -361.8341924828599, -1038.3456534723928, -1109.4255280871691, -832.5558703862755, -83.10511002902749, -1231.9304541664465, -1037.886846605041, -446.6095628831365, -173.47223715759762, -15.943345360686951, -1380.646714104107, -833.5024253955207, -361.2215157364673, -871.8738333173358, -419.65136384595723, -463.3871124931906, -1255.0811082069642, -1465.6816798682512, -1006.9198088780327, -1293.8851588797377, -407.7130359090931, -947.3014786878646, -1099.944597540045], "episode_lengths": [59, 150, 89, 66, 71, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 124, 33, 150, 75, 99, 118, 42, 150, 150, 150, 150, 37, 150, 39, 150, 104, 72, 150, 150, 150, 150, 150, 67, 150, 93, 45, 150, 150, 41, 150, 53, 77, 150, 150, 61, 60, 90, 150, 48, 67, 83, 150, 109, 150, 150, 146, 58, 88, 150, 150, 150, 150, 150, 77, 150, 150, 114, 57, 39, 150, 150, 99, 150, 96, 114, 150, 150, 150, 150, 97, 150, 150], "policy_policy_0_reward": [-88.16973409735725, -1111.8040738507937, -385.6844467948571, -160.3444865322858, -140.38551198072463, -1150.3806502378056, -1167.17092220062, -1149.294526926402, -1079.4947649870992, -64.97713752829301, -595.0232428517497, -1156.2631650281307, -1118.3528260802923, -1034.45535161726, -1047.7023324449567, -1172.597997282236, -1022.0661978201649, -892.3419493515124, -394.2759026510796, -11.438259457292986, -596.8706645093829, -263.4407048748865, -426.45143837592036, -611.1986548376908, -14.216769642427536, -1133.5071014667774, -1327.860002992333, -903.407183728068, -979.2902495628996, -11.546949571458637, -750.4009646346988, -45.38027885074041, -878.9697721875586, -320.4249138766615, -225.47726386848942, -703.03020559963, -973.7028084196397, -1120.5945375631013, -757.5571698701187, -1235.8701905916375, -171.16090158064353, -1146.14442442463, -245.3866135685102, -92.15505282275815, -1283.6303797127648, -1123.885327035579, -40.16572749093255, -1058.616310735987, -111.45839013035702, -194.4115595572835, -771.6684344008478, -760.6332395945896, -170.87161342033994, -131.6354090644949, -238.8042441321403, -682.3445268572034, -79.28460881511401, -88.19424324278746, -287.8250398229445, -939.5142388650623, -444.5440440805309, -964.3731983299901, -1144.514850388469, -604.2642346822614, -104.32898271038333, -223.49402231129926, -1098.1619860153248, -361.8341924828599, -1038.3456534723928, -1109.4255280871691, -832.5558703862755, -83.10511002902749, -1231.9304541664465, -1037.886846605041, -446.6095628831365, -173.47223715759762, -15.943345360686951, -1380.646714104107, -833.5024253955207, -361.2215157364673, -871.8738333173358, -419.65136384595723, -463.3871124931906, -1255.0811082069642, -1465.6816798682512, -1006.9198088780327, -1293.8851588797377, -407.7130359090931, -947.3014786878646, -1099.944597540045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5664212181024908, "mean_inference_ms": 1.6526710700603848, "mean_action_processing_ms": 0.2768756989531751, "mean_env_wait_ms": 3.3807424443651843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013448927137586806, "StateBufferConnector_ms": 0.00852664311726888, "ViewRequirementAgentConnector_ms": 0.18939971923828125}, "num_episodes": 31, "episode_return_max": -11.438259457292986, "episode_return_min": -1465.6816798682512, "episode_return_mean": -672.8979060225719, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.2825964812144, "num_env_steps_trained_throughput_per_sec": 305.2825964812144, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12065.78, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12065.709, "sample_time_ms": 1098.241, "learn_time_ms": 10895.742, "learn_throughput": 367.116, "synch_weights_time_ms": 70.831}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1e132_00001", "date": "2024-08-04_07-33-32", "timestamp": 1722737012, "time_this_iter_s": 13.11668872833252, "time_total_s": 36.23508834838867, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bde10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.23508834838867, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.38421052631579, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87.137767029802, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.181904436399539, "policy_loss": -0.013676397523280077, "vf_loss": 4.192503059655428, "vf_explained_var": 0.8374745274583498, "kl": 0.016056851113171438, "entropy": 1.3358374562114477, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -11.546949571458637, "episode_reward_min": -1465.6816798682512, "episode_reward_mean": -640.1909240046975, "episode_len_mean": 116.17, "episode_media": {}, "episodes_timesteps_total": 11617, "policy_reward_min": {"policy_0": -1465.6816798682512}, "policy_reward_max": {"policy_0": -11.546949571458637}, "policy_reward_mean": {"policy_0": -640.1909240046975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.216769642427536, -1133.5071014667774, -1327.860002992333, -903.407183728068, -979.2902495628996, -11.546949571458637, -750.4009646346988, -45.38027885074041, -878.9697721875586, -320.4249138766615, -225.47726386848942, -703.03020559963, -973.7028084196397, -1120.5945375631013, -757.5571698701187, -1235.8701905916375, -171.16090158064353, -1146.14442442463, -245.3866135685102, -92.15505282275815, -1283.6303797127648, -1123.885327035579, -40.16572749093255, -1058.616310735987, -111.45839013035702, -194.4115595572835, -771.6684344008478, -760.6332395945896, -170.87161342033994, -131.6354090644949, -238.8042441321403, -682.3445268572034, -79.28460881511401, -88.19424324278746, -287.8250398229445, -939.5142388650623, -444.5440440805309, -964.3731983299901, -1144.514850388469, -604.2642346822614, -104.32898271038333, -223.49402231129926, -1098.1619860153248, -361.8341924828599, -1038.3456534723928, -1109.4255280871691, -832.5558703862755, -83.10511002902749, -1231.9304541664465, -1037.886846605041, -446.6095628831365, -173.47223715759762, -15.943345360686951, -1380.646714104107, -833.5024253955207, -361.2215157364673, -871.8738333173358, -419.65136384595723, -463.3871124931906, -1255.0811082069642, -1465.6816798682512, -1006.9198088780327, -1293.8851588797377, -407.7130359090931, -947.3014786878646, -1099.944597540045, -721.9730031576242, -319.9204084001897, -463.59061327480623, -1117.38459276692, -1078.6648329208228, -583.0629806748187, -1286.9671717186084, -132.8142496541062, -1181.878321845839, -1006.317445848755, -526.3235604375035, -166.53672845328683, -620.8912603589042, -477.9498285592967, -757.9888077270823, -1123.435282420714, -134.8654941080922, -185.29252416904376, -789.9288956333761, -481.80861642489896, -207.59716361465334, -468.61662883315495, -819.2092420619902, -1163.4233528000764, -816.4440810504113, -624.7635471345625, -55.93160294567499, -1113.1137070947782, -664.0029032455295, -99.60009254548528, -38.63397119827506, -853.3182837070378, -98.04828684536587, -118.16831912541393], "episode_lengths": [42, 150, 150, 150, 150, 37, 150, 39, 150, 104, 72, 150, 150, 150, 150, 150, 67, 150, 93, 45, 150, 150, 41, 150, 53, 77, 150, 150, 61, 60, 90, 150, 48, 67, 83, 150, 109, 150, 150, 146, 58, 88, 150, 150, 150, 150, 150, 77, 150, 150, 114, 57, 39, 150, 150, 99, 150, 96, 114, 150, 150, 150, 150, 97, 150, 150, 150, 84, 108, 150, 150, 125, 150, 74, 150, 150, 109, 57, 144, 105, 150, 150, 74, 89, 150, 105, 62, 150, 150, 150, 150, 115, 40, 150, 142, 63, 38, 150, 62, 48], "policy_policy_0_reward": [-14.216769642427536, -1133.5071014667774, -1327.860002992333, -903.407183728068, -979.2902495628996, -11.546949571458637, -750.4009646346988, -45.38027885074041, -878.9697721875586, -320.4249138766615, -225.47726386848942, -703.03020559963, -973.7028084196397, -1120.5945375631013, -757.5571698701187, -1235.8701905916375, -171.16090158064353, -1146.14442442463, -245.3866135685102, -92.15505282275815, -1283.6303797127648, -1123.885327035579, -40.16572749093255, -1058.616310735987, -111.45839013035702, -194.4115595572835, -771.6684344008478, -760.6332395945896, -170.87161342033994, -131.6354090644949, -238.8042441321403, -682.3445268572034, -79.28460881511401, -88.19424324278746, -287.8250398229445, -939.5142388650623, -444.5440440805309, -964.3731983299901, -1144.514850388469, -604.2642346822614, -104.32898271038333, -223.49402231129926, -1098.1619860153248, -361.8341924828599, -1038.3456534723928, -1109.4255280871691, -832.5558703862755, -83.10511002902749, -1231.9304541664465, -1037.886846605041, -446.6095628831365, -173.47223715759762, -15.943345360686951, -1380.646714104107, -833.5024253955207, -361.2215157364673, -871.8738333173358, -419.65136384595723, -463.3871124931906, -1255.0811082069642, -1465.6816798682512, -1006.9198088780327, -1293.8851588797377, -407.7130359090931, -947.3014786878646, -1099.944597540045, -721.9730031576242, -319.9204084001897, -463.59061327480623, -1117.38459276692, -1078.6648329208228, -583.0629806748187, -1286.9671717186084, -132.8142496541062, -1181.878321845839, -1006.317445848755, -526.3235604375035, -166.53672845328683, -620.8912603589042, -477.9498285592967, -757.9888077270823, -1123.435282420714, -134.8654941080922, -185.29252416904376, -789.9288956333761, -481.80861642489896, -207.59716361465334, -468.61662883315495, -819.2092420619902, -1163.4233528000764, -816.4440810504113, -624.7635471345625, -55.93160294567499, -1113.1137070947782, -664.0029032455295, -99.60009254548528, -38.63397119827506, -853.3182837070378, -98.04828684536587, -118.16831912541393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5640174179601636, "mean_inference_ms": 1.6561526619212341, "mean_action_processing_ms": 0.277691062617249, "mean_env_wait_ms": 3.381518397546015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013828039169311523, "StateBufferConnector_ms": 0.008562564849853516, "ViewRequirementAgentConnector_ms": 0.18999457359313965}, "num_episodes": 34, "episode_return_max": -11.546949571458637, "episode_return_min": -1465.6816798682512, "episode_return_mean": -640.1909240046975, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.7848324984308, "num_env_steps_trained_throughput_per_sec": 305.7848324984308, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12319.611, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12319.543, "sample_time_ms": 1133.647, "learn_time_ms": 11118.137, "learn_throughput": 359.773, "synch_weights_time_ms": 66.895}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1e132_00001", "date": "2024-08-04_07-33-45", "timestamp": 1722737025, "time_this_iter_s": 13.094603061676025, "time_total_s": 49.3296914100647, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bf5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.3296914100647, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.573684210526316, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 94.90890728036563, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.518621254712343, "policy_loss": -0.015875514241633935, "vf_loss": 4.530982717871666, "vf_explained_var": 0.8427299420659741, "kl": 0.018231950543137525, "entropy": 1.323522019262115, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -15.943345360686951, "episode_reward_min": -1465.6816798682512, "episode_reward_mean": -653.3367092604036, "episode_len_mean": 120.77, "episode_media": {}, "episodes_timesteps_total": 12077, "policy_reward_min": {"policy_0": -1465.6816798682512}, "policy_reward_max": {"policy_0": -15.943345360686951}, "policy_reward_mean": {"policy_0": -653.3367092604036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131.6354090644949, -238.8042441321403, -682.3445268572034, -79.28460881511401, -88.19424324278746, -287.8250398229445, -939.5142388650623, -444.5440440805309, -964.3731983299901, -1144.514850388469, -604.2642346822614, -104.32898271038333, -223.49402231129926, -1098.1619860153248, -361.8341924828599, -1038.3456534723928, -1109.4255280871691, -832.5558703862755, -83.10511002902749, -1231.9304541664465, -1037.886846605041, -446.6095628831365, -173.47223715759762, -15.943345360686951, -1380.646714104107, -833.5024253955207, -361.2215157364673, -871.8738333173358, -419.65136384595723, -463.3871124931906, -1255.0811082069642, -1465.6816798682512, -1006.9198088780327, -1293.8851588797377, -407.7130359090931, -947.3014786878646, -1099.944597540045, -721.9730031576242, -319.9204084001897, -463.59061327480623, -1117.38459276692, -1078.6648329208228, -583.0629806748187, -1286.9671717186084, -132.8142496541062, -1181.878321845839, -1006.317445848755, -526.3235604375035, -166.53672845328683, -620.8912603589042, -477.9498285592967, -757.9888077270823, -1123.435282420714, -134.8654941080922, -185.29252416904376, -789.9288956333761, -481.80861642489896, -207.59716361465334, -468.61662883315495, -819.2092420619902, -1163.4233528000764, -816.4440810504113, -624.7635471345625, -55.93160294567499, -1113.1137070947782, -664.0029032455295, -99.60009254548528, -38.63397119827506, -853.3182837070378, -98.04828684536587, -118.16831912541393, -1009.2995134148406, -690.0911805737077, -235.69106884768664, -429.36578819094564, -954.2066356615454, -848.0233241219025, -705.7739989713805, -935.6686184183687, -953.2988592074893, -840.4788360293699, -1277.6507665505396, -1153.3007921252959, -579.4938753881723, -891.7054575472247, -830.7541021630875, -842.7947933239549, -939.2320654747458, -33.75178794615926, -282.0978565308052, -108.01011684481911, -1038.7331294217076, -708.1838909409621, -157.0386495964473, -277.3115392208737, -57.20548351914655, -1241.2508004386698, -1265.994434211998, -227.13112940166522, -352.46436838854896], "episode_lengths": [60, 90, 150, 48, 67, 83, 150, 109, 150, 150, 146, 58, 88, 150, 150, 150, 150, 150, 77, 150, 150, 114, 57, 39, 150, 150, 99, 150, 96, 114, 150, 150, 150, 150, 97, 150, 150, 150, 84, 108, 150, 150, 125, 150, 74, 150, 150, 109, 57, 144, 105, 150, 150, 74, 89, 150, 105, 62, 150, 150, 150, 150, 115, 40, 150, 142, 63, 38, 150, 62, 48, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 43, 114, 68, 150, 150, 69, 96, 59, 150, 150, 93, 146], "policy_policy_0_reward": [-131.6354090644949, -238.8042441321403, -682.3445268572034, -79.28460881511401, -88.19424324278746, -287.8250398229445, -939.5142388650623, -444.5440440805309, -964.3731983299901, -1144.514850388469, -604.2642346822614, -104.32898271038333, -223.49402231129926, -1098.1619860153248, -361.8341924828599, -1038.3456534723928, -1109.4255280871691, -832.5558703862755, -83.10511002902749, -1231.9304541664465, -1037.886846605041, -446.6095628831365, -173.47223715759762, -15.943345360686951, -1380.646714104107, -833.5024253955207, -361.2215157364673, -871.8738333173358, -419.65136384595723, -463.3871124931906, -1255.0811082069642, -1465.6816798682512, -1006.9198088780327, -1293.8851588797377, -407.7130359090931, -947.3014786878646, -1099.944597540045, -721.9730031576242, -319.9204084001897, -463.59061327480623, -1117.38459276692, -1078.6648329208228, -583.0629806748187, -1286.9671717186084, -132.8142496541062, -1181.878321845839, -1006.317445848755, -526.3235604375035, -166.53672845328683, -620.8912603589042, -477.9498285592967, -757.9888077270823, -1123.435282420714, -134.8654941080922, -185.29252416904376, -789.9288956333761, -481.80861642489896, -207.59716361465334, -468.61662883315495, -819.2092420619902, -1163.4233528000764, -816.4440810504113, -624.7635471345625, -55.93160294567499, -1113.1137070947782, -664.0029032455295, -99.60009254548528, -38.63397119827506, -853.3182837070378, -98.04828684536587, -118.16831912541393, -1009.2995134148406, -690.0911805737077, -235.69106884768664, -429.36578819094564, -954.2066356615454, -848.0233241219025, -705.7739989713805, -935.6686184183687, -953.2988592074893, -840.4788360293699, -1277.6507665505396, -1153.3007921252959, -579.4938753881723, -891.7054575472247, -830.7541021630875, -842.7947933239549, -939.2320654747458, -33.75178794615926, -282.0978565308052, -108.01011684481911, -1038.7331294217076, -708.1838909409621, -157.0386495964473, -277.3115392208737, -57.20548351914655, -1241.2508004386698, -1265.994434211998, -227.13112940166522, -352.46436838854896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5617293300839994, "mean_inference_ms": 1.658166385717537, "mean_action_processing_ms": 0.27793787250646856, "mean_env_wait_ms": 3.3870101761674225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01331019401550293, "StateBufferConnector_ms": 0.009213685989379883, "ViewRequirementAgentConnector_ms": 0.1921393871307373}, "num_episodes": 29, "episode_return_max": -15.943345360686951, "episode_return_min": -1465.6816798682512, "episode_return_mean": -653.3367092604036, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.20550554672235, "num_env_steps_trained_throughput_per_sec": 314.20550554672235, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12401.796, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12401.728, "sample_time_ms": 1125.779, "learn_time_ms": 11207.072, "learn_throughput": 356.917, "synch_weights_time_ms": 67.943}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1e132_00001", "date": "2024-08-04_07-33-58", "timestamp": 1722737038, "time_this_iter_s": 12.743400573730469, "time_total_s": 62.073091983795166, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544880d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.073091983795166, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.950000000000003, "ram_util_percent": 28.088888888888892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.48848609526952, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.904696927840511, "policy_loss": -0.017439785292663147, "vf_loss": 3.9184536029895147, "vf_explained_var": 0.9265208640446265, "kl": 0.019044246823068534, "entropy": 1.257460193708539, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -6.1928494558043665, "episode_reward_min": -1323.7738631363575, "episode_reward_mean": -679.39698750451, "episode_len_mean": 125.87, "episode_media": {}, "episodes_timesteps_total": 12587, "policy_reward_min": {"policy_0": -1323.7738631363575}, "policy_reward_max": {"policy_0": -6.1928494558043665}, "policy_reward_mean": {"policy_0": -679.39698750451}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.9198088780327, -1293.8851588797377, -407.7130359090931, -947.3014786878646, -1099.944597540045, -721.9730031576242, -319.9204084001897, -463.59061327480623, -1117.38459276692, -1078.6648329208228, -583.0629806748187, -1286.9671717186084, -132.8142496541062, -1181.878321845839, -1006.317445848755, -526.3235604375035, -166.53672845328683, -620.8912603589042, -477.9498285592967, -757.9888077270823, -1123.435282420714, -134.8654941080922, -185.29252416904376, -789.9288956333761, -481.80861642489896, -207.59716361465334, -468.61662883315495, -819.2092420619902, -1163.4233528000764, -816.4440810504113, -624.7635471345625, -55.93160294567499, -1113.1137070947782, -664.0029032455295, -99.60009254548528, -38.63397119827506, -853.3182837070378, -98.04828684536587, -118.16831912541393, -1009.2995134148406, -690.0911805737077, -235.69106884768664, -429.36578819094564, -954.2066356615454, -848.0233241219025, -705.7739989713805, -935.6686184183687, -953.2988592074893, -840.4788360293699, -1277.6507665505396, -1153.3007921252959, -579.4938753881723, -891.7054575472247, -830.7541021630875, -842.7947933239549, -939.2320654747458, -33.75178794615926, -282.0978565308052, -108.01011684481911, -1038.7331294217076, -708.1838909409621, -157.0386495964473, -277.3115392208737, -57.20548351914655, -1241.2508004386698, -1265.994434211998, -227.13112940166522, -352.46436838854896, -539.7875227838579, -661.2409616127821, -1058.6610269688429, -754.6128551413414, -67.0576346516987, -1121.1706101053464, -1029.872514685355, -831.3607558543307, -6.1928494558043665, -1108.3754229028375, -768.149521863824, -430.9836081505018, -109.17767044043705, -934.9533626052909, -1029.2435078369888, -797.0830346314053, -780.847926934862, -1227.3516070008018, -1323.7738631363575, -229.49024917989777, -499.19983192822866, -241.713750162302, -1175.0275409588985, -1111.978235544976, -213.8939088107403, -821.4988251124882, -652.146349218454, -822.5301173848321, -826.9411568423919, -1117.1350033876793, -317.5716835981044, -410.44309843541674], "episode_lengths": [150, 150, 97, 150, 150, 150, 84, 108, 150, 150, 125, 150, 74, 150, 150, 109, 57, 144, 105, 150, 150, 74, 89, 150, 105, 62, 150, 150, 150, 150, 115, 40, 150, 142, 63, 38, 150, 62, 48, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 43, 114, 68, 150, 150, 69, 96, 59, 150, 150, 93, 146, 121, 150, 150, 150, 41, 150, 150, 150, 36, 150, 150, 100, 79, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 99, 148, 150, 150, 150, 150, 87, 150], "policy_policy_0_reward": [-1006.9198088780327, -1293.8851588797377, -407.7130359090931, -947.3014786878646, -1099.944597540045, -721.9730031576242, -319.9204084001897, -463.59061327480623, -1117.38459276692, -1078.6648329208228, -583.0629806748187, -1286.9671717186084, -132.8142496541062, -1181.878321845839, -1006.317445848755, -526.3235604375035, -166.53672845328683, -620.8912603589042, -477.9498285592967, -757.9888077270823, -1123.435282420714, -134.8654941080922, -185.29252416904376, -789.9288956333761, -481.80861642489896, -207.59716361465334, -468.61662883315495, -819.2092420619902, -1163.4233528000764, -816.4440810504113, -624.7635471345625, -55.93160294567499, -1113.1137070947782, -664.0029032455295, -99.60009254548528, -38.63397119827506, -853.3182837070378, -98.04828684536587, -118.16831912541393, -1009.2995134148406, -690.0911805737077, -235.69106884768664, -429.36578819094564, -954.2066356615454, -848.0233241219025, -705.7739989713805, -935.6686184183687, -953.2988592074893, -840.4788360293699, -1277.6507665505396, -1153.3007921252959, -579.4938753881723, -891.7054575472247, -830.7541021630875, -842.7947933239549, -939.2320654747458, -33.75178794615926, -282.0978565308052, -108.01011684481911, -1038.7331294217076, -708.1838909409621, -157.0386495964473, -277.3115392208737, -57.20548351914655, -1241.2508004386698, -1265.994434211998, -227.13112940166522, -352.46436838854896, -539.7875227838579, -661.2409616127821, -1058.6610269688429, -754.6128551413414, -67.0576346516987, -1121.1706101053464, -1029.872514685355, -831.3607558543307, -6.1928494558043665, -1108.3754229028375, -768.149521863824, -430.9836081505018, -109.17767044043705, -934.9533626052909, -1029.2435078369888, -797.0830346314053, -780.847926934862, -1227.3516070008018, -1323.7738631363575, -229.49024917989777, -499.19983192822866, -241.713750162302, -1175.0275409588985, -1111.978235544976, -213.8939088107403, -821.4988251124882, -652.146349218454, -822.5301173848321, -826.9411568423919, -1117.1350033876793, -317.5716835981044, -410.44309843541674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5600733288556122, "mean_inference_ms": 1.66423722713567, "mean_action_processing_ms": 0.27926882998805896, "mean_env_wait_ms": 3.399797156417413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013052225112915039, "StateBufferConnector_ms": 0.009369373321533203, "ViewRequirementAgentConnector_ms": 0.19047212600708008}, "num_episodes": 32, "episode_return_max": -6.1928494558043665, "episode_return_min": -1323.7738631363575, "episode_return_mean": -679.39698750451, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.32605833678906, "num_env_steps_trained_throughput_per_sec": 306.32605833678906, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12511.162, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12511.092, "sample_time_ms": 1121.403, "learn_time_ms": 11321.15, "learn_throughput": 353.321, "synch_weights_time_ms": 67.626}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1e132_00001", "date": "2024-08-04_07-34-11", "timestamp": 1722737051, "time_this_iter_s": 13.070333480834961, "time_total_s": 75.14342546463013, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d854489120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.14342546463013, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.41578947368421, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.13393443425497, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.3718542055537304, "policy_loss": -0.011062708719691727, "vf_loss": 3.3797858856618404, "vf_explained_var": 0.9244528595358134, "kl": 0.016276614762136894, "entropy": 1.2429656852036715, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -6.1928494558043665, "episode_reward_min": -1352.399664989397, "episode_reward_mean": -654.4878637323164, "episode_len_mean": 127.52, "episode_media": {}, "episodes_timesteps_total": 12752, "policy_reward_min": {"policy_0": -1352.399664989397}, "policy_reward_max": {"policy_0": -6.1928494558043665}, "policy_reward_mean": {"policy_0": -654.4878637323164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-664.0029032455295, -99.60009254548528, -38.63397119827506, -853.3182837070378, -98.04828684536587, -118.16831912541393, -1009.2995134148406, -690.0911805737077, -235.69106884768664, -429.36578819094564, -954.2066356615454, -848.0233241219025, -705.7739989713805, -935.6686184183687, -953.2988592074893, -840.4788360293699, -1277.6507665505396, -1153.3007921252959, -579.4938753881723, -891.7054575472247, -830.7541021630875, -842.7947933239549, -939.2320654747458, -33.75178794615926, -282.0978565308052, -108.01011684481911, -1038.7331294217076, -708.1838909409621, -157.0386495964473, -277.3115392208737, -57.20548351914655, -1241.2508004386698, -1265.994434211998, -227.13112940166522, -352.46436838854896, -539.7875227838579, -661.2409616127821, -1058.6610269688429, -754.6128551413414, -67.0576346516987, -1121.1706101053464, -1029.872514685355, -831.3607558543307, -6.1928494558043665, -1108.3754229028375, -768.149521863824, -430.9836081505018, -109.17767044043705, -934.9533626052909, -1029.2435078369888, -797.0830346314053, -780.847926934862, -1227.3516070008018, -1323.7738631363575, -229.49024917989777, -499.19983192822866, -241.713750162302, -1175.0275409588985, -1111.978235544976, -213.8939088107403, -821.4988251124882, -652.146349218454, -822.5301173848321, -826.9411568423919, -1117.1350033876793, -317.5716835981044, -410.44309843541674, -355.4362846317036, -1210.735061640766, -695.7118457916096, -1089.4887773413022, -730.5131526084734, -620.0016663829979, -754.2887186801509, -77.26572223983783, -665.349172063668, -656.3240230516574, -807.7066602974315, -511.82754422104443, -532.5655988052787, -62.68049093591665, -233.96344304707853, -671.3156042987188, -370.4381283364984, -409.4979758971252, -342.3206451684828, -129.40642582522048, -1031.5424679648656, -47.73871870225425, -621.5021706517111, -93.63405817942129, -235.68637086514943, -1352.399664989397, -650.4535010080937, -869.8373673792021, -1050.808228848077, -964.6654157863786, -988.6173176703802, -854.9419704026411, -1002.8814530528633], "episode_lengths": [142, 63, 38, 150, 62, 48, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 43, 114, 68, 150, 150, 69, 96, 59, 150, 150, 93, 146, 121, 150, 150, 150, 41, 150, 150, 150, 36, 150, 150, 100, 79, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 99, 148, 150, 150, 150, 150, 87, 150, 102, 150, 150, 150, 150, 118, 150, 41, 150, 150, 150, 150, 150, 55, 142, 137, 128, 99, 150, 82, 150, 46, 150, 71, 82, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-664.0029032455295, -99.60009254548528, -38.63397119827506, -853.3182837070378, -98.04828684536587, -118.16831912541393, -1009.2995134148406, -690.0911805737077, -235.69106884768664, -429.36578819094564, -954.2066356615454, -848.0233241219025, -705.7739989713805, -935.6686184183687, -953.2988592074893, -840.4788360293699, -1277.6507665505396, -1153.3007921252959, -579.4938753881723, -891.7054575472247, -830.7541021630875, -842.7947933239549, -939.2320654747458, -33.75178794615926, -282.0978565308052, -108.01011684481911, -1038.7331294217076, -708.1838909409621, -157.0386495964473, -277.3115392208737, -57.20548351914655, -1241.2508004386698, -1265.994434211998, -227.13112940166522, -352.46436838854896, -539.7875227838579, -661.2409616127821, -1058.6610269688429, -754.6128551413414, -67.0576346516987, -1121.1706101053464, -1029.872514685355, -831.3607558543307, -6.1928494558043665, -1108.3754229028375, -768.149521863824, -430.9836081505018, -109.17767044043705, -934.9533626052909, -1029.2435078369888, -797.0830346314053, -780.847926934862, -1227.3516070008018, -1323.7738631363575, -229.49024917989777, -499.19983192822866, -241.713750162302, -1175.0275409588985, -1111.978235544976, -213.8939088107403, -821.4988251124882, -652.146349218454, -822.5301173848321, -826.9411568423919, -1117.1350033876793, -317.5716835981044, -410.44309843541674, -355.4362846317036, -1210.735061640766, -695.7118457916096, -1089.4887773413022, -730.5131526084734, -620.0016663829979, -754.2887186801509, -77.26572223983783, -665.349172063668, -656.3240230516574, -807.7066602974315, -511.82754422104443, -532.5655988052787, -62.68049093591665, -233.96344304707853, -671.3156042987188, -370.4381283364984, -409.4979758971252, -342.3206451684828, -129.40642582522048, -1031.5424679648656, -47.73871870225425, -621.5021706517111, -93.63405817942129, -235.68637086514943, -1352.399664989397, -650.4535010080937, -869.8373673792021, -1050.808228848077, -964.6654157863786, -988.6173176703802, -854.9419704026411, -1002.8814530528633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5600149714929971, "mean_inference_ms": 1.6657002310409112, "mean_action_processing_ms": 0.279810147129099, "mean_env_wait_ms": 3.401431722890907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012572526931762695, "StateBufferConnector_ms": 0.009176254272460938, "ViewRequirementAgentConnector_ms": 0.19312572479248047}, "num_episodes": 33, "episode_return_max": -6.1928494558043665, "episode_return_min": -1352.399664989397, "episode_return_mean": -654.4878637323164, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.59338344376897, "num_env_steps_trained_throughput_per_sec": 300.59338344376897, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12624.857, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12624.787, "sample_time_ms": 1138.802, "learn_time_ms": 11417.725, "learn_throughput": 350.333, "synch_weights_time_ms": 67.355}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1e132_00001", "date": "2024-08-04_07-34-24", "timestamp": 1722737064, "time_this_iter_s": 13.318350076675415, "time_total_s": 88.46177554130554, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996513f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.46177554130554, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.57894736842105, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.4915535847346, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.307461387167374, "policy_loss": -0.017435141789610496, "vf_loss": 3.319905668621262, "vf_explained_var": 0.9577138071879745, "kl": 0.025563385219894978, "entropy": 1.2181314693763852, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -6.1928494558043665, "episode_reward_min": -1459.5871744204462, "episode_reward_mean": -709.115536163444, "episode_len_mean": 133.14, "episode_media": {}, "episodes_timesteps_total": 13314, "policy_reward_min": {"policy_0": -1459.5871744204462}, "policy_reward_max": {"policy_0": -6.1928494558043665}, "policy_reward_mean": {"policy_0": -709.115536163444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1038.7331294217076, -708.1838909409621, -157.0386495964473, -277.3115392208737, -57.20548351914655, -1241.2508004386698, -1265.994434211998, -227.13112940166522, -352.46436838854896, -539.7875227838579, -661.2409616127821, -1058.6610269688429, -754.6128551413414, -67.0576346516987, -1121.1706101053464, -1029.872514685355, -831.3607558543307, -6.1928494558043665, -1108.3754229028375, -768.149521863824, -430.9836081505018, -109.17767044043705, -934.9533626052909, -1029.2435078369888, -797.0830346314053, -780.847926934862, -1227.3516070008018, -1323.7738631363575, -229.49024917989777, -499.19983192822866, -241.713750162302, -1175.0275409588985, -1111.978235544976, -213.8939088107403, -821.4988251124882, -652.146349218454, -822.5301173848321, -826.9411568423919, -1117.1350033876793, -317.5716835981044, -410.44309843541674, -355.4362846317036, -1210.735061640766, -695.7118457916096, -1089.4887773413022, -730.5131526084734, -620.0016663829979, -754.2887186801509, -77.26572223983783, -665.349172063668, -656.3240230516574, -807.7066602974315, -511.82754422104443, -532.5655988052787, -62.68049093591665, -233.96344304707853, -671.3156042987188, -370.4381283364984, -409.4979758971252, -342.3206451684828, -129.40642582522048, -1031.5424679648656, -47.73871870225425, -621.5021706517111, -93.63405817942129, -235.68637086514943, -1352.399664989397, -650.4535010080937, -869.8373673792021, -1050.808228848077, -964.6654157863786, -988.6173176703802, -854.9419704026411, -1002.8814530528633, -1057.8642824009144, -918.9372294220409, -1014.8375438694228, -643.95508897505, -1459.5871744204462, -648.1802584522479, -992.5192707054555, -1185.3331129456274, -1310.9182849286262, -830.4870487820363, -974.1762086687434, -868.9719623905315, -487.2947217204872, -687.7483757153597, -502.2837461149929, -750.4833329219657, -723.4595315762559, -504.31532835031607, -406.23013271094067, -248.22464203543447, -985.8361085992998, -920.8078096601628, -965.4177968723903, -296.43238335978066, -1396.10193134576, -1094.8252301676162], "episode_lengths": [150, 150, 69, 96, 59, 150, 150, 93, 146, 121, 150, 150, 150, 41, 150, 150, 150, 36, 150, 150, 100, 79, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 99, 148, 150, 150, 150, 150, 87, 150, 102, 150, 150, 150, 150, 118, 150, 41, 150, 150, 150, 150, 150, 55, 142, 137, 128, 99, 150, 82, 150, 46, 150, 71, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 69, 150, 150, 150, 119, 150, 150], "policy_policy_0_reward": [-1038.7331294217076, -708.1838909409621, -157.0386495964473, -277.3115392208737, -57.20548351914655, -1241.2508004386698, -1265.994434211998, -227.13112940166522, -352.46436838854896, -539.7875227838579, -661.2409616127821, -1058.6610269688429, -754.6128551413414, -67.0576346516987, -1121.1706101053464, -1029.872514685355, -831.3607558543307, -6.1928494558043665, -1108.3754229028375, -768.149521863824, -430.9836081505018, -109.17767044043705, -934.9533626052909, -1029.2435078369888, -797.0830346314053, -780.847926934862, -1227.3516070008018, -1323.7738631363575, -229.49024917989777, -499.19983192822866, -241.713750162302, -1175.0275409588985, -1111.978235544976, -213.8939088107403, -821.4988251124882, -652.146349218454, -822.5301173848321, -826.9411568423919, -1117.1350033876793, -317.5716835981044, -410.44309843541674, -355.4362846317036, -1210.735061640766, -695.7118457916096, -1089.4887773413022, -730.5131526084734, -620.0016663829979, -754.2887186801509, -77.26572223983783, -665.349172063668, -656.3240230516574, -807.7066602974315, -511.82754422104443, -532.5655988052787, -62.68049093591665, -233.96344304707853, -671.3156042987188, -370.4381283364984, -409.4979758971252, -342.3206451684828, -129.40642582522048, -1031.5424679648656, -47.73871870225425, -621.5021706517111, -93.63405817942129, -235.68637086514943, -1352.399664989397, -650.4535010080937, -869.8373673792021, -1050.808228848077, -964.6654157863786, -988.6173176703802, -854.9419704026411, -1002.8814530528633, -1057.8642824009144, -918.9372294220409, -1014.8375438694228, -643.95508897505, -1459.5871744204462, -648.1802584522479, -992.5192707054555, -1185.3331129456274, -1310.9182849286262, -830.4870487820363, -974.1762086687434, -868.9719623905315, -487.2947217204872, -687.7483757153597, -502.2837461149929, -750.4833329219657, -723.4595315762559, -504.31532835031607, -406.23013271094067, -248.22464203543447, -985.8361085992998, -920.8078096601628, -965.4177968723903, -296.43238335978066, -1396.10193134576, -1094.8252301676162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596457469115336, "mean_inference_ms": 1.66707645139693, "mean_action_processing_ms": 0.2794192692648144, "mean_env_wait_ms": 3.4038856083291904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012424707412719727, "StateBufferConnector_ms": 0.008482694625854492, "ViewRequirementAgentConnector_ms": 0.19368577003479004}, "num_episodes": 26, "episode_return_max": -6.1928494558043665, "episode_return_min": -1459.5871744204462, "episode_return_mean": -709.115536163444, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.003212136152, "num_env_steps_trained_throughput_per_sec": 313.003212136152, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12644.181, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12644.109, "sample_time_ms": 1131.841, "learn_time_ms": 11444.66, "learn_throughput": 349.508, "synch_weights_time_ms": 66.723}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1e132_00001", "date": "2024-08-04_07-34-37", "timestamp": 1722737077, "time_this_iter_s": 12.791901350021362, "time_total_s": 101.2536768913269, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bd480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.2536768913269, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.866666666666667, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.1328092555205, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.5542117667074007, "policy_loss": -0.008228920465141225, "vf_loss": 2.557797525326411, "vf_explained_var": 0.9639242051169277, "kl": 0.015880739169824666, "entropy": 1.2106754702826341, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -21.87548950558955, "episode_reward_min": -1462.131177696757, "episode_reward_mean": -705.894433724857, "episode_len_mean": 133.89, "episode_media": {}, "episodes_timesteps_total": 13389, "policy_reward_min": {"policy_0": -1462.131177696757}, "policy_reward_max": {"policy_0": -21.87548950558955}, "policy_reward_mean": {"policy_0": -705.894433724857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-499.19983192822866, -241.713750162302, -1175.0275409588985, -1111.978235544976, -213.8939088107403, -821.4988251124882, -652.146349218454, -822.5301173848321, -826.9411568423919, -1117.1350033876793, -317.5716835981044, -410.44309843541674, -355.4362846317036, -1210.735061640766, -695.7118457916096, -1089.4887773413022, -730.5131526084734, -620.0016663829979, -754.2887186801509, -77.26572223983783, -665.349172063668, -656.3240230516574, -807.7066602974315, -511.82754422104443, -532.5655988052787, -62.68049093591665, -233.96344304707853, -671.3156042987188, -370.4381283364984, -409.4979758971252, -342.3206451684828, -129.40642582522048, -1031.5424679648656, -47.73871870225425, -621.5021706517111, -93.63405817942129, -235.68637086514943, -1352.399664989397, -650.4535010080937, -869.8373673792021, -1050.808228848077, -964.6654157863786, -988.6173176703802, -854.9419704026411, -1002.8814530528633, -1057.8642824009144, -918.9372294220409, -1014.8375438694228, -643.95508897505, -1459.5871744204462, -648.1802584522479, -992.5192707054555, -1185.3331129456274, -1310.9182849286262, -830.4870487820363, -974.1762086687434, -868.9719623905315, -487.2947217204872, -687.7483757153597, -502.2837461149929, -750.4833329219657, -723.4595315762559, -504.31532835031607, -406.23013271094067, -248.22464203543447, -985.8361085992998, -920.8078096601628, -965.4177968723903, -296.43238335978066, -1396.10193134576, -1094.8252301676162, -335.6574105170326, -126.70810973677267, -1315.441727354185, -399.67983748886354, -736.8217761218639, -537.1200196442699, -343.79823271765196, -345.21635636041754, -1119.7299501687653, -959.9349873054857, -920.1839186884255, -776.6034964646964, -1462.131177696757, -665.1919710321544, -820.5588099171988, -647.7007767004326, -715.4433441461282, -1072.8272411420662, -21.87548950558955, -986.2889337122731, -911.145263637889, -765.0558948801039, -809.6184818530666, -336.89133702774456, -96.39325038156494, -124.7204278774449, -81.71842178150128, -1160.7964760060452, -1217.3365673574842], "episode_lengths": [150, 94, 150, 150, 99, 148, 150, 150, 150, 150, 87, 150, 102, 150, 150, 150, 150, 118, 150, 41, 150, 150, 150, 150, 150, 55, 142, 137, 128, 99, 150, 82, 150, 46, 150, 71, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 69, 150, 150, 150, 119, 150, 150, 150, 72, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 44, 150, 150, 150, 150, 89, 60, 72, 57, 150, 150], "policy_policy_0_reward": [-499.19983192822866, -241.713750162302, -1175.0275409588985, -1111.978235544976, -213.8939088107403, -821.4988251124882, -652.146349218454, -822.5301173848321, -826.9411568423919, -1117.1350033876793, -317.5716835981044, -410.44309843541674, -355.4362846317036, -1210.735061640766, -695.7118457916096, -1089.4887773413022, -730.5131526084734, -620.0016663829979, -754.2887186801509, -77.26572223983783, -665.349172063668, -656.3240230516574, -807.7066602974315, -511.82754422104443, -532.5655988052787, -62.68049093591665, -233.96344304707853, -671.3156042987188, -370.4381283364984, -409.4979758971252, -342.3206451684828, -129.40642582522048, -1031.5424679648656, -47.73871870225425, -621.5021706517111, -93.63405817942129, -235.68637086514943, -1352.399664989397, -650.4535010080937, -869.8373673792021, -1050.808228848077, -964.6654157863786, -988.6173176703802, -854.9419704026411, -1002.8814530528633, -1057.8642824009144, -918.9372294220409, -1014.8375438694228, -643.95508897505, -1459.5871744204462, -648.1802584522479, -992.5192707054555, -1185.3331129456274, -1310.9182849286262, -830.4870487820363, -974.1762086687434, -868.9719623905315, -487.2947217204872, -687.7483757153597, -502.2837461149929, -750.4833329219657, -723.4595315762559, -504.31532835031607, -406.23013271094067, -248.22464203543447, -985.8361085992998, -920.8078096601628, -965.4177968723903, -296.43238335978066, -1396.10193134576, -1094.8252301676162, -335.6574105170326, -126.70810973677267, -1315.441727354185, -399.67983748886354, -736.8217761218639, -537.1200196442699, -343.79823271765196, -345.21635636041754, -1119.7299501687653, -959.9349873054857, -920.1839186884255, -776.6034964646964, -1462.131177696757, -665.1919710321544, -820.5588099171988, -647.7007767004326, -715.4433441461282, -1072.8272411420662, -21.87548950558955, -986.2889337122731, -911.145263637889, -765.0558948801039, -809.6184818530666, -336.89133702774456, -96.39325038156494, -124.7204278774449, -81.71842178150128, -1160.7964760060452, -1217.3365673574842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594867218832017, "mean_inference_ms": 1.668876106261972, "mean_action_processing_ms": 0.2793250591488244, "mean_env_wait_ms": 3.404658998038704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01212310791015625, "StateBufferConnector_ms": 0.008056402206420898, "ViewRequirementAgentConnector_ms": 0.19236087799072266}, "num_episodes": 29, "episode_return_max": -21.87548950558955, "episode_return_min": -1462.131177696757, "episode_return_mean": -705.894433724857, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.91659481986267, "num_env_steps_trained_throughput_per_sec": 306.91659481986267, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12687.368, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12687.298, "sample_time_ms": 1127.509, "learn_time_ms": 11492.413, "learn_throughput": 348.056, "synch_weights_time_ms": 66.506}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1e132_00001", "date": "2024-08-04_07-34-50", "timestamp": 1722737090, "time_this_iter_s": 13.04468059539795, "time_total_s": 114.29835748672485, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.29835748672485, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.811111111111114, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 207.4756289422512, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.166387385937075, "policy_loss": -0.012887053819819508, "vf_loss": 2.175134465160469, "vf_explained_var": 0.9821099760631721, "kl": 0.0142363299931579, "entropy": 1.30929457594951, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -21.87548950558955, "episode_reward_min": -1462.131177696757, "episode_reward_mean": -760.117739840613, "episode_len_mean": 135.2, "episode_media": {}, "episodes_timesteps_total": 13520, "policy_reward_min": {"policy_0": -1462.131177696757}, "policy_reward_max": {"policy_0": -21.87548950558955}, "policy_reward_mean": {"policy_0": -760.117739840613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-233.96344304707853, -671.3156042987188, -370.4381283364984, -409.4979758971252, -342.3206451684828, -129.40642582522048, -1031.5424679648656, -47.73871870225425, -621.5021706517111, -93.63405817942129, -235.68637086514943, -1352.399664989397, -650.4535010080937, -869.8373673792021, -1050.808228848077, -964.6654157863786, -988.6173176703802, -854.9419704026411, -1002.8814530528633, -1057.8642824009144, -918.9372294220409, -1014.8375438694228, -643.95508897505, -1459.5871744204462, -648.1802584522479, -992.5192707054555, -1185.3331129456274, -1310.9182849286262, -830.4870487820363, -974.1762086687434, -868.9719623905315, -487.2947217204872, -687.7483757153597, -502.2837461149929, -750.4833329219657, -723.4595315762559, -504.31532835031607, -406.23013271094067, -248.22464203543447, -985.8361085992998, -920.8078096601628, -965.4177968723903, -296.43238335978066, -1396.10193134576, -1094.8252301676162, -335.6574105170326, -126.70810973677267, -1315.441727354185, -399.67983748886354, -736.8217761218639, -537.1200196442699, -343.79823271765196, -345.21635636041754, -1119.7299501687653, -959.9349873054857, -920.1839186884255, -776.6034964646964, -1462.131177696757, -665.1919710321544, -820.5588099171988, -647.7007767004326, -715.4433441461282, -1072.8272411420662, -21.87548950558955, -986.2889337122731, -911.145263637889, -765.0558948801039, -809.6184818530666, -336.89133702774456, -96.39325038156494, -124.7204278774449, -81.71842178150128, -1160.7964760060452, -1217.3365673574842, -709.9795831938297, -918.1295138648522, -1073.278694154485, -983.6826532338301, -523.1054682685904, -70.41664951931644, -1035.2807037593632, -300.9408271685754, -179.08563342232011, -770.900230367351, -208.02835846707094, -984.6872930860296, -600.7778734986562, -1192.3712100107505, -1177.4836525849091, -971.7625386358397, -1241.7076233029518, -1139.4780626699226, -564.3552945328207, -1209.2409036793651, -939.4556123482017, -1065.9216608304089, -1200.6745512669893, -1081.7441218202955, -1029.3149861136815, -1230.501131851564], "episode_lengths": [142, 137, 128, 99, 150, 82, 150, 46, 150, 71, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 69, 150, 150, 150, 119, 150, 150, 150, 72, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 44, 150, 150, 150, 150, 89, 60, 72, 57, 150, 150, 150, 150, 150, 150, 150, 41, 150, 83, 79, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-233.96344304707853, -671.3156042987188, -370.4381283364984, -409.4979758971252, -342.3206451684828, -129.40642582522048, -1031.5424679648656, -47.73871870225425, -621.5021706517111, -93.63405817942129, -235.68637086514943, -1352.399664989397, -650.4535010080937, -869.8373673792021, -1050.808228848077, -964.6654157863786, -988.6173176703802, -854.9419704026411, -1002.8814530528633, -1057.8642824009144, -918.9372294220409, -1014.8375438694228, -643.95508897505, -1459.5871744204462, -648.1802584522479, -992.5192707054555, -1185.3331129456274, -1310.9182849286262, -830.4870487820363, -974.1762086687434, -868.9719623905315, -487.2947217204872, -687.7483757153597, -502.2837461149929, -750.4833329219657, -723.4595315762559, -504.31532835031607, -406.23013271094067, -248.22464203543447, -985.8361085992998, -920.8078096601628, -965.4177968723903, -296.43238335978066, -1396.10193134576, -1094.8252301676162, -335.6574105170326, -126.70810973677267, -1315.441727354185, -399.67983748886354, -736.8217761218639, -537.1200196442699, -343.79823271765196, -345.21635636041754, -1119.7299501687653, -959.9349873054857, -920.1839186884255, -776.6034964646964, -1462.131177696757, -665.1919710321544, -820.5588099171988, -647.7007767004326, -715.4433441461282, -1072.8272411420662, -21.87548950558955, -986.2889337122731, -911.145263637889, -765.0558948801039, -809.6184818530666, -336.89133702774456, -96.39325038156494, -124.7204278774449, -81.71842178150128, -1160.7964760060452, -1217.3365673574842, -709.9795831938297, -918.1295138648522, -1073.278694154485, -983.6826532338301, -523.1054682685904, -70.41664951931644, -1035.2807037593632, -300.9408271685754, -179.08563342232011, -770.900230367351, -208.02835846707094, -984.6872930860296, -600.7778734986562, -1192.3712100107505, -1177.4836525849091, -971.7625386358397, -1241.7076233029518, -1139.4780626699226, -564.3552945328207, -1209.2409036793651, -939.4556123482017, -1065.9216608304089, -1200.6745512669893, -1081.7441218202955, -1029.3149861136815, -1230.501131851564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591862400703017, "mean_inference_ms": 1.668661540337088, "mean_action_processing_ms": 0.2789446510284758, "mean_env_wait_ms": 3.4029829755471583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01195836067199707, "StateBufferConnector_ms": 0.007968902587890625, "ViewRequirementAgentConnector_ms": 0.19169068336486816}, "num_episodes": 26, "episode_return_max": -21.87548950558955, "episode_return_min": -1462.131177696757, "episode_return_mean": -760.117739840613, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.1258795763654, "num_env_steps_trained_throughput_per_sec": 320.1258795763654, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12668.141, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12668.071, "sample_time_ms": 1123.852, "learn_time_ms": 11477.938, "learn_throughput": 348.495, "synch_weights_time_ms": 65.425}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1e132_00001", "date": "2024-08-04_07-35-03", "timestamp": 1722737103, "time_this_iter_s": 12.507635354995728, "time_total_s": 126.80599284172058, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544896c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.80599284172058, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.855555555555554, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.41546433965365, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.287712090772887, "policy_loss": -0.0085063720185038, "vf_loss": 2.2928114905953407, "vf_explained_var": 0.98276581838727, "kl": 0.011738236054209983, "entropy": 1.144986637060841, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -21.87548950558955, "episode_reward_min": -1462.131177696757, "episode_reward_mean": -733.1039247831293, "episode_len_mean": 132.33, "episode_media": {}, "episodes_timesteps_total": 13233, "policy_reward_min": {"policy_0": -1462.131177696757}, "policy_reward_max": {"policy_0": -21.87548950558955}, "policy_reward_mean": {"policy_0": -733.1039247831293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-723.4595315762559, -504.31532835031607, -406.23013271094067, -248.22464203543447, -985.8361085992998, -920.8078096601628, -965.4177968723903, -296.43238335978066, -1396.10193134576, -1094.8252301676162, -335.6574105170326, -126.70810973677267, -1315.441727354185, -399.67983748886354, -736.8217761218639, -537.1200196442699, -343.79823271765196, -345.21635636041754, -1119.7299501687653, -959.9349873054857, -920.1839186884255, -776.6034964646964, -1462.131177696757, -665.1919710321544, -820.5588099171988, -647.7007767004326, -715.4433441461282, -1072.8272411420662, -21.87548950558955, -986.2889337122731, -911.145263637889, -765.0558948801039, -809.6184818530666, -336.89133702774456, -96.39325038156494, -124.7204278774449, -81.71842178150128, -1160.7964760060452, -1217.3365673574842, -709.9795831938297, -918.1295138648522, -1073.278694154485, -983.6826532338301, -523.1054682685904, -70.41664951931644, -1035.2807037593632, -300.9408271685754, -179.08563342232011, -770.900230367351, -208.02835846707094, -984.6872930860296, -600.7778734986562, -1192.3712100107505, -1177.4836525849091, -971.7625386358397, -1241.7076233029518, -1139.4780626699226, -564.3552945328207, -1209.2409036793651, -939.4556123482017, -1065.9216608304089, -1200.6745512669893, -1081.7441218202955, -1029.3149861136815, -1230.501131851564, -360.22566935920565, -1290.7754362995493, -1180.5822345196923, -150.84221686230813, -1132.9416684389726, -1149.371514437631, -1146.4475065200447, -824.1203799812904, -705.0847733534051, -984.4075347861822, -788.8699701253606, -515.0135659476491, -753.2686277391136, -566.3003895229718, -1098.0268109010199, -100.15006973258006, -1090.8648556150906, -227.12298791375775, -401.82914609229664, -530.7297619649571, -555.2726989331294, -600.322447445274, -618.7650409533722, -140.4402344943132, -80.39592097076104, -242.64754714295196, -1167.335247273491, -205.19617027763383, -930.2240519160513, -1211.8829797382116, -219.22270127053454, -913.686300064347, -235.84006148154174, -1211.7977194122757, -223.84282327215107], "episode_lengths": [150, 150, 105, 69, 150, 150, 150, 119, 150, 150, 150, 72, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 44, 150, 150, 150, 150, 89, 60, 72, 57, 150, 150, 150, 150, 150, 150, 150, 41, 150, 83, 79, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 139, 131, 150, 150, 150, 150, 150, 150, 65, 150, 69, 150, 150, 150, 150, 150, 72, 72, 98, 150, 88, 150, 150, 106, 150, 92, 150, 110], "policy_policy_0_reward": [-723.4595315762559, -504.31532835031607, -406.23013271094067, -248.22464203543447, -985.8361085992998, -920.8078096601628, -965.4177968723903, -296.43238335978066, -1396.10193134576, -1094.8252301676162, -335.6574105170326, -126.70810973677267, -1315.441727354185, -399.67983748886354, -736.8217761218639, -537.1200196442699, -343.79823271765196, -345.21635636041754, -1119.7299501687653, -959.9349873054857, -920.1839186884255, -776.6034964646964, -1462.131177696757, -665.1919710321544, -820.5588099171988, -647.7007767004326, -715.4433441461282, -1072.8272411420662, -21.87548950558955, -986.2889337122731, -911.145263637889, -765.0558948801039, -809.6184818530666, -336.89133702774456, -96.39325038156494, -124.7204278774449, -81.71842178150128, -1160.7964760060452, -1217.3365673574842, -709.9795831938297, -918.1295138648522, -1073.278694154485, -983.6826532338301, -523.1054682685904, -70.41664951931644, -1035.2807037593632, -300.9408271685754, -179.08563342232011, -770.900230367351, -208.02835846707094, -984.6872930860296, -600.7778734986562, -1192.3712100107505, -1177.4836525849091, -971.7625386358397, -1241.7076233029518, -1139.4780626699226, -564.3552945328207, -1209.2409036793651, -939.4556123482017, -1065.9216608304089, -1200.6745512669893, -1081.7441218202955, -1029.3149861136815, -1230.501131851564, -360.22566935920565, -1290.7754362995493, -1180.5822345196923, -150.84221686230813, -1132.9416684389726, -1149.371514437631, -1146.4475065200447, -824.1203799812904, -705.0847733534051, -984.4075347861822, -788.8699701253606, -515.0135659476491, -753.2686277391136, -566.3003895229718, -1098.0268109010199, -100.15006973258006, -1090.8648556150906, -227.12298791375775, -401.82914609229664, -530.7297619649571, -555.2726989331294, -600.322447445274, -618.7650409533722, -140.4402344943132, -80.39592097076104, -242.64754714295196, -1167.335247273491, -205.19617027763383, -930.2240519160513, -1211.8829797382116, -219.22270127053454, -913.686300064347, -235.84006148154174, -1211.7977194122757, -223.84282327215107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577587367852658, "mean_inference_ms": 1.6653464630873895, "mean_action_processing_ms": 0.27781998180511036, "mean_env_wait_ms": 3.3986517190954944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011873722076416016, "StateBufferConnector_ms": 0.008016586303710938, "ViewRequirementAgentConnector_ms": 0.1902780532836914}, "num_episodes": 35, "episode_return_max": -21.87548950558955, "episode_return_min": -1462.131177696757, "episode_return_mean": -733.1039247831293, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.56437269827956, "num_env_steps_trained_throughput_per_sec": 305.56437269827956, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12703.051, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12702.98, "sample_time_ms": 1126.543, "learn_time_ms": 11509.283, "learn_throughput": 347.546, "synch_weights_time_ms": 66.298}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1e132_00001", "date": "2024-08-04_07-35-16", "timestamp": 1722737116, "time_this_iter_s": 13.103068351745605, "time_total_s": 139.9090611934662, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bd480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.9090611934662, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.231578947368423, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.24359144866466, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.766531462284426, "policy_loss": -0.010027095668192487, "vf_loss": 1.7723265612497925, "vf_explained_var": 0.985974816357096, "kl": 0.01447328309019819, "entropy": 1.0998681709791223, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -13.376202116073285, "episode_reward_min": -1290.7754362995493, "episode_reward_mean": -691.0582574424491, "episode_len_mean": 131.35, "episode_media": {}, "episodes_timesteps_total": 13135, "policy_reward_min": {"policy_0": -1290.7754362995493}, "policy_reward_max": {"policy_0": -13.376202116073285}, "policy_reward_mean": {"policy_0": -691.0582574424491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-765.0558948801039, -809.6184818530666, -336.89133702774456, -96.39325038156494, -124.7204278774449, -81.71842178150128, -1160.7964760060452, -1217.3365673574842, -709.9795831938297, -918.1295138648522, -1073.278694154485, -983.6826532338301, -523.1054682685904, -70.41664951931644, -1035.2807037593632, -300.9408271685754, -179.08563342232011, -770.900230367351, -208.02835846707094, -984.6872930860296, -600.7778734986562, -1192.3712100107505, -1177.4836525849091, -971.7625386358397, -1241.7076233029518, -1139.4780626699226, -564.3552945328207, -1209.2409036793651, -939.4556123482017, -1065.9216608304089, -1200.6745512669893, -1081.7441218202955, -1029.3149861136815, -1230.501131851564, -360.22566935920565, -1290.7754362995493, -1180.5822345196923, -150.84221686230813, -1132.9416684389726, -1149.371514437631, -1146.4475065200447, -824.1203799812904, -705.0847733534051, -984.4075347861822, -788.8699701253606, -515.0135659476491, -753.2686277391136, -566.3003895229718, -1098.0268109010199, -100.15006973258006, -1090.8648556150906, -227.12298791375775, -401.82914609229664, -530.7297619649571, -555.2726989331294, -600.322447445274, -618.7650409533722, -140.4402344943132, -80.39592097076104, -242.64754714295196, -1167.335247273491, -205.19617027763383, -930.2240519160513, -1211.8829797382116, -219.22270127053454, -913.686300064347, -235.84006148154174, -1211.7977194122757, -223.84282327215107, -750.8356260181579, -844.3432230021182, -726.0200029397661, -689.5690667486139, -629.8909077493552, -1091.7458407281756, -199.746750256139, -871.0274694388631, -498.2356461068371, -65.99632285752847, -799.2072561624976, -756.8516813427149, -461.27313525892515, -296.85539115590933, -183.599869521682, -1059.7647980378454, -786.4124995185508, -667.660721415024, -593.1525296235739, -682.5772711643968, -677.9135828835057, -646.6742816129771, -1012.9528183278153, -654.2541194033419, -251.6729300055423, -231.32715310014896, -415.8423620020971, -1100.2498991335947, -456.0302192549557, -442.08341378213584, -13.376202116073285], "episode_lengths": [150, 150, 89, 60, 72, 57, 150, 150, 150, 150, 150, 150, 150, 41, 150, 83, 79, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 139, 131, 150, 150, 150, 150, 150, 150, 65, 150, 69, 150, 150, 150, 150, 150, 72, 72, 98, 150, 88, 150, 150, 106, 150, 92, 150, 110, 150, 150, 150, 150, 150, 150, 90, 150, 145, 60, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 123, 80, 73, 150, 150, 150, 150, 39], "policy_policy_0_reward": [-765.0558948801039, -809.6184818530666, -336.89133702774456, -96.39325038156494, -124.7204278774449, -81.71842178150128, -1160.7964760060452, -1217.3365673574842, -709.9795831938297, -918.1295138648522, -1073.278694154485, -983.6826532338301, -523.1054682685904, -70.41664951931644, -1035.2807037593632, -300.9408271685754, -179.08563342232011, -770.900230367351, -208.02835846707094, -984.6872930860296, -600.7778734986562, -1192.3712100107505, -1177.4836525849091, -971.7625386358397, -1241.7076233029518, -1139.4780626699226, -564.3552945328207, -1209.2409036793651, -939.4556123482017, -1065.9216608304089, -1200.6745512669893, -1081.7441218202955, -1029.3149861136815, -1230.501131851564, -360.22566935920565, -1290.7754362995493, -1180.5822345196923, -150.84221686230813, -1132.9416684389726, -1149.371514437631, -1146.4475065200447, -824.1203799812904, -705.0847733534051, -984.4075347861822, -788.8699701253606, -515.0135659476491, -753.2686277391136, -566.3003895229718, -1098.0268109010199, -100.15006973258006, -1090.8648556150906, -227.12298791375775, -401.82914609229664, -530.7297619649571, -555.2726989331294, -600.322447445274, -618.7650409533722, -140.4402344943132, -80.39592097076104, -242.64754714295196, -1167.335247273491, -205.19617027763383, -930.2240519160513, -1211.8829797382116, -219.22270127053454, -913.686300064347, -235.84006148154174, -1211.7977194122757, -223.84282327215107, -750.8356260181579, -844.3432230021182, -726.0200029397661, -689.5690667486139, -629.8909077493552, -1091.7458407281756, -199.746750256139, -871.0274694388631, -498.2356461068371, -65.99632285752847, -799.2072561624976, -756.8516813427149, -461.27313525892515, -296.85539115590933, -183.599869521682, -1059.7647980378454, -786.4124995185508, -667.660721415024, -593.1525296235739, -682.5772711643968, -677.9135828835057, -646.6742816129771, -1012.9528183278153, -654.2541194033419, -251.6729300055423, -231.32715310014896, -415.8423620020971, -1100.2498991335947, -456.0302192549557, -442.08341378213584, -13.376202116073285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559363032668184, "mean_inference_ms": 1.6620344415821853, "mean_action_processing_ms": 0.2772126951031627, "mean_env_wait_ms": 3.390097229243764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011763811111450195, "StateBufferConnector_ms": 0.008045673370361328, "ViewRequirementAgentConnector_ms": 0.1925663948059082}, "num_episodes": 31, "episode_return_max": -13.376202116073285, "episode_return_min": -1290.7754362995493, "episode_return_mean": -691.0582574424491, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6916018142671, "num_env_steps_trained_throughput_per_sec": 308.6916018142671, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12963.517, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12963.445, "sample_time_ms": 1127.701, "learn_time_ms": 11771.414, "learn_throughput": 339.806, "synch_weights_time_ms": 63.482}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1e132_00001", "date": "2024-08-04_07-35-29", "timestamp": 1722737129, "time_this_iter_s": 12.970775127410889, "time_total_s": 152.87983632087708, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448ab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.87983632087708, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.950000000000003, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 197.87917781472206, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.003137902667125, "policy_loss": -0.010187115032749716, "vf_loss": 2.0083866593427957, "vf_explained_var": 0.9846772154172262, "kl": 0.016828771667254248, "entropy": 1.1027266207461557, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -13.376202116073285, "episode_reward_min": -1290.7754362995493, "episode_reward_mean": -655.8405816318835, "episode_len_mean": 131.12, "episode_media": {}, "episodes_timesteps_total": 13112, "policy_reward_min": {"policy_0": -1290.7754362995493}, "policy_reward_max": {"policy_0": -13.376202116073285}, "policy_reward_mean": {"policy_0": -655.8405816318835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-939.4556123482017, -1065.9216608304089, -1200.6745512669893, -1081.7441218202955, -1029.3149861136815, -1230.501131851564, -360.22566935920565, -1290.7754362995493, -1180.5822345196923, -150.84221686230813, -1132.9416684389726, -1149.371514437631, -1146.4475065200447, -824.1203799812904, -705.0847733534051, -984.4075347861822, -788.8699701253606, -515.0135659476491, -753.2686277391136, -566.3003895229718, -1098.0268109010199, -100.15006973258006, -1090.8648556150906, -227.12298791375775, -401.82914609229664, -530.7297619649571, -555.2726989331294, -600.322447445274, -618.7650409533722, -140.4402344943132, -80.39592097076104, -242.64754714295196, -1167.335247273491, -205.19617027763383, -930.2240519160513, -1211.8829797382116, -219.22270127053454, -913.686300064347, -235.84006148154174, -1211.7977194122757, -223.84282327215107, -750.8356260181579, -844.3432230021182, -726.0200029397661, -689.5690667486139, -629.8909077493552, -1091.7458407281756, -199.746750256139, -871.0274694388631, -498.2356461068371, -65.99632285752847, -799.2072561624976, -756.8516813427149, -461.27313525892515, -296.85539115590933, -183.599869521682, -1059.7647980378454, -786.4124995185508, -667.660721415024, -593.1525296235739, -682.5772711643968, -677.9135828835057, -646.6742816129771, -1012.9528183278153, -654.2541194033419, -251.6729300055423, -231.32715310014896, -415.8423620020971, -1100.2498991335947, -456.0302192549557, -442.08341378213584, -13.376202116073285, -978.9147267922284, -242.31209658470604, -823.9990744195386, -699.5746873547384, -121.670562124313, -356.98720808945603, -617.1807986229268, -638.1571747294504, -702.9287904763876, -1002.3598849361631, -445.20482784175107, -671.0032142586477, -103.77400038521499, -531.2840782589756, -225.97536328928078, -164.6702767380527, -302.3227091092481, -1217.6011072864515, -553.3482763925543, -1169.3415273625485, -1083.5308079232664, -697.2357032894486, -1006.275214837468, -206.37054090010625, -428.2516722470699, -1042.5273322720866, -641.4913674011145, -251.16301960603647], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 139, 131, 150, 150, 150, 150, 150, 150, 65, 150, 69, 150, 150, 150, 150, 150, 72, 72, 98, 150, 88, 150, 150, 106, 150, 92, 150, 110, 150, 150, 150, 150, 150, 150, 90, 150, 145, 60, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 123, 80, 73, 150, 150, 150, 150, 39, 150, 71, 150, 150, 72, 89, 150, 150, 150, 150, 150, 150, 45, 121, 69, 71, 100, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 111], "policy_policy_0_reward": [-939.4556123482017, -1065.9216608304089, -1200.6745512669893, -1081.7441218202955, -1029.3149861136815, -1230.501131851564, -360.22566935920565, -1290.7754362995493, -1180.5822345196923, -150.84221686230813, -1132.9416684389726, -1149.371514437631, -1146.4475065200447, -824.1203799812904, -705.0847733534051, -984.4075347861822, -788.8699701253606, -515.0135659476491, -753.2686277391136, -566.3003895229718, -1098.0268109010199, -100.15006973258006, -1090.8648556150906, -227.12298791375775, -401.82914609229664, -530.7297619649571, -555.2726989331294, -600.322447445274, -618.7650409533722, -140.4402344943132, -80.39592097076104, -242.64754714295196, -1167.335247273491, -205.19617027763383, -930.2240519160513, -1211.8829797382116, -219.22270127053454, -913.686300064347, -235.84006148154174, -1211.7977194122757, -223.84282327215107, -750.8356260181579, -844.3432230021182, -726.0200029397661, -689.5690667486139, -629.8909077493552, -1091.7458407281756, -199.746750256139, -871.0274694388631, -498.2356461068371, -65.99632285752847, -799.2072561624976, -756.8516813427149, -461.27313525892515, -296.85539115590933, -183.599869521682, -1059.7647980378454, -786.4124995185508, -667.660721415024, -593.1525296235739, -682.5772711643968, -677.9135828835057, -646.6742816129771, -1012.9528183278153, -654.2541194033419, -251.6729300055423, -231.32715310014896, -415.8423620020971, -1100.2498991335947, -456.0302192549557, -442.08341378213584, -13.376202116073285, -978.9147267922284, -242.31209658470604, -823.9990744195386, -699.5746873547384, -121.670562124313, -356.98720808945603, -617.1807986229268, -638.1571747294504, -702.9287904763876, -1002.3598849361631, -445.20482784175107, -671.0032142586477, -103.77400038521499, -531.2840782589756, -225.97536328928078, -164.6702767380527, -302.3227091092481, -1217.6011072864515, -553.3482763925543, -1169.3415273625485, -1083.5308079232664, -697.2357032894486, -1006.275214837468, -206.37054090010625, -428.2516722470699, -1042.5273322720866, -641.4913674011145, -251.16301960603647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555567272675098, "mean_inference_ms": 1.6614680876934105, "mean_action_processing_ms": 0.2769999906801377, "mean_env_wait_ms": 3.3864678778499404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011754512786865234, "StateBufferConnector_ms": 0.00805044174194336, "ViewRequirementAgentConnector_ms": 0.19361376762390137}, "num_episodes": 28, "episode_return_max": -13.376202116073285, "episode_return_min": -1290.7754362995493, "episode_return_mean": -655.8405816318835, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.4662113764181, "num_env_steps_trained_throughput_per_sec": 313.4662113764181, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12929.311, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12929.238, "sample_time_ms": 1126.922, "learn_time_ms": 11738.272, "learn_throughput": 340.766, "synch_weights_time_ms": 63.23}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1e132_00001", "date": "2024-08-04_07-35-42", "timestamp": 1722737142, "time_this_iter_s": 12.77254605293274, "time_total_s": 165.65238237380981, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996513910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.65238237380981, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.457894736842103, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.8408035715421, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.8790600846831997, "policy_loss": -0.010806037899844039, "vf_loss": 1.8851945673425992, "vf_explained_var": 0.9764091638227304, "kl": 0.01601129508265634, "entropy": 1.3182940311729907, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -13.376202116073285, "episode_reward_min": -1308.6312476540097, "episode_reward_mean": -640.0614648789408, "episode_len_mean": 129.72, "episode_media": {}, "episodes_timesteps_total": 12972, "policy_reward_min": {"policy_0": -1308.6312476540097}, "policy_reward_max": {"policy_0": -13.376202116073285}, "policy_reward_mean": {"policy_0": -640.0614648789408}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-205.19617027763383, -930.2240519160513, -1211.8829797382116, -219.22270127053454, -913.686300064347, -235.84006148154174, -1211.7977194122757, -223.84282327215107, -750.8356260181579, -844.3432230021182, -726.0200029397661, -689.5690667486139, -629.8909077493552, -1091.7458407281756, -199.746750256139, -871.0274694388631, -498.2356461068371, -65.99632285752847, -799.2072561624976, -756.8516813427149, -461.27313525892515, -296.85539115590933, -183.599869521682, -1059.7647980378454, -786.4124995185508, -667.660721415024, -593.1525296235739, -682.5772711643968, -677.9135828835057, -646.6742816129771, -1012.9528183278153, -654.2541194033419, -251.6729300055423, -231.32715310014896, -415.8423620020971, -1100.2498991335947, -456.0302192549557, -442.08341378213584, -13.376202116073285, -978.9147267922284, -242.31209658470604, -823.9990744195386, -699.5746873547384, -121.670562124313, -356.98720808945603, -617.1807986229268, -638.1571747294504, -702.9287904763876, -1002.3598849361631, -445.20482784175107, -671.0032142586477, -103.77400038521499, -531.2840782589756, -225.97536328928078, -164.6702767380527, -302.3227091092481, -1217.6011072864515, -553.3482763925543, -1169.3415273625485, -1083.5308079232664, -697.2357032894486, -1006.275214837468, -206.37054090010625, -428.2516722470699, -1042.5273322720866, -641.4913674011145, -251.16301960603647, -1286.8356316222319, -887.6709088769666, -1007.7547202470242, -1065.2983853637531, -393.2125447277508, -670.7988496507678, -700.6916421374823, -573.1189810950675, -1037.2610358006764, -485.3411351323675, -1093.8442538099443, -387.4784757571045, -740.6547631042749, -81.04239561189519, -989.6555656771792, -990.9346387686842, -1139.54570013878, -1287.7452572200864, -1157.195874204966, -570.728733752548, -938.2343505778382, -482.74199032402197, -682.1928892071884, -107.85341677651489, -243.48923944868596, -1308.6312476540097, -242.70154829022195, -1055.273863908765, -53.68737343700607, -419.8010052384705, -288.56416143220986, -327.9093623708257, -673.9647048979211], "episode_lengths": [88, 150, 150, 106, 150, 92, 150, 110, 150, 150, 150, 150, 150, 150, 90, 150, 145, 60, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 123, 80, 73, 150, 150, 150, 150, 39, 150, 71, 150, 150, 72, 89, 150, 150, 150, 150, 150, 150, 45, 121, 69, 71, 100, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 129, 115, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 131, 47, 127, 150, 71, 150, 65, 104, 84, 83, 150], "policy_policy_0_reward": [-205.19617027763383, -930.2240519160513, -1211.8829797382116, -219.22270127053454, -913.686300064347, -235.84006148154174, -1211.7977194122757, -223.84282327215107, -750.8356260181579, -844.3432230021182, -726.0200029397661, -689.5690667486139, -629.8909077493552, -1091.7458407281756, -199.746750256139, -871.0274694388631, -498.2356461068371, -65.99632285752847, -799.2072561624976, -756.8516813427149, -461.27313525892515, -296.85539115590933, -183.599869521682, -1059.7647980378454, -786.4124995185508, -667.660721415024, -593.1525296235739, -682.5772711643968, -677.9135828835057, -646.6742816129771, -1012.9528183278153, -654.2541194033419, -251.6729300055423, -231.32715310014896, -415.8423620020971, -1100.2498991335947, -456.0302192549557, -442.08341378213584, -13.376202116073285, -978.9147267922284, -242.31209658470604, -823.9990744195386, -699.5746873547384, -121.670562124313, -356.98720808945603, -617.1807986229268, -638.1571747294504, -702.9287904763876, -1002.3598849361631, -445.20482784175107, -671.0032142586477, -103.77400038521499, -531.2840782589756, -225.97536328928078, -164.6702767380527, -302.3227091092481, -1217.6011072864515, -553.3482763925543, -1169.3415273625485, -1083.5308079232664, -697.2357032894486, -1006.275214837468, -206.37054090010625, -428.2516722470699, -1042.5273322720866, -641.4913674011145, -251.16301960603647, -1286.8356316222319, -887.6709088769666, -1007.7547202470242, -1065.2983853637531, -393.2125447277508, -670.7988496507678, -700.6916421374823, -573.1189810950675, -1037.2610358006764, -485.3411351323675, -1093.8442538099443, -387.4784757571045, -740.6547631042749, -81.04239561189519, -989.6555656771792, -990.9346387686842, -1139.54570013878, -1287.7452572200864, -1157.195874204966, -570.728733752548, -938.2343505778382, -482.74199032402197, -682.1928892071884, -107.85341677651489, -243.48923944868596, -1308.6312476540097, -242.70154829022195, -1055.273863908765, -53.68737343700607, -419.8010052384705, -288.56416143220986, -327.9093623708257, -673.9647048979211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551606156615722, "mean_inference_ms": 1.662018577920958, "mean_action_processing_ms": 0.2764685586056755, "mean_env_wait_ms": 3.3870315733767096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011909008026123047, "StateBufferConnector_ms": 0.008176326751708984, "ViewRequirementAgentConnector_ms": 0.19605159759521484}, "num_episodes": 33, "episode_return_max": -13.376202116073285, "episode_return_min": -1308.6312476540097, "episode_return_mean": -640.0614648789408, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.4374980383553, "num_env_steps_trained_throughput_per_sec": 313.4374980383553, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12897.374, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12897.299, "sample_time_ms": 1111.722, "learn_time_ms": 11721.146, "learn_throughput": 341.264, "synch_weights_time_ms": 63.617}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1e132_00001", "date": "2024-08-04_07-35-54", "timestamp": 1722737154, "time_this_iter_s": 12.774491310119629, "time_total_s": 178.42687368392944, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a6d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.42687368392944, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.650000000000002, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 197.58856322964033, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.6755403028801084, "policy_loss": -0.008031388463374848, "vf_loss": 1.6781240640208126, "vf_explained_var": 0.9891090504204233, "kl": 0.018555112819497784, "entropy": 1.1890864381566644, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -13.376202116073285, "episode_reward_min": -1395.943071435295, "episode_reward_mean": -656.9758304993696, "episode_len_mean": 126.47, "episode_media": {}, "episodes_timesteps_total": 12647, "policy_reward_min": {"policy_0": -1395.943071435295}, "policy_reward_max": {"policy_0": -13.376202116073285}, "policy_reward_mean": {"policy_0": -656.9758304993696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-415.8423620020971, -1100.2498991335947, -456.0302192549557, -442.08341378213584, -13.376202116073285, -978.9147267922284, -242.31209658470604, -823.9990744195386, -699.5746873547384, -121.670562124313, -356.98720808945603, -617.1807986229268, -638.1571747294504, -702.9287904763876, -1002.3598849361631, -445.20482784175107, -671.0032142586477, -103.77400038521499, -531.2840782589756, -225.97536328928078, -164.6702767380527, -302.3227091092481, -1217.6011072864515, -553.3482763925543, -1169.3415273625485, -1083.5308079232664, -697.2357032894486, -1006.275214837468, -206.37054090010625, -428.2516722470699, -1042.5273322720866, -641.4913674011145, -251.16301960603647, -1286.8356316222319, -887.6709088769666, -1007.7547202470242, -1065.2983853637531, -393.2125447277508, -670.7988496507678, -700.6916421374823, -573.1189810950675, -1037.2610358006764, -485.3411351323675, -1093.8442538099443, -387.4784757571045, -740.6547631042749, -81.04239561189519, -989.6555656771792, -990.9346387686842, -1139.54570013878, -1287.7452572200864, -1157.195874204966, -570.728733752548, -938.2343505778382, -482.74199032402197, -682.1928892071884, -107.85341677651489, -243.48923944868596, -1308.6312476540097, -242.70154829022195, -1055.273863908765, -53.68737343700607, -419.8010052384705, -288.56416143220986, -327.9093623708257, -673.9647048979211, -855.7924553690422, -1151.7921653215801, -531.8137584005079, -939.0823980107507, -694.1664173875695, -1130.9305873981334, -855.1646582964524, -340.9578405068127, -28.86545124073799, -835.9661653042458, -218.88795069754127, -1195.7810792456314, -348.0995251767991, -1104.623619459026, -1061.0939502805427, -937.0465069079246, -575.6245956217534, -1123.460464168114, -110.32828180014123, -50.30517905254964, -182.18168282447988, -466.44106080739436, -1023.8069436332555, -522.303693086088, -82.30419756085969, -74.81142337014721, -1395.943071435295, -1182.3288381946104, -35.0653813860669, -853.0410218324164, -164.61425924562081, -1101.4947904972673, -843.4537231999889, -955.1171271363097], "episode_lengths": [150, 150, 150, 150, 39, 150, 71, 150, 150, 72, 89, 150, 150, 150, 150, 150, 150, 45, 121, 69, 71, 100, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 129, 115, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 131, 47, 127, 150, 71, 150, 65, 104, 84, 83, 150, 150, 150, 125, 150, 150, 150, 150, 106, 41, 150, 66, 150, 94, 150, 150, 150, 150, 150, 62, 46, 82, 150, 150, 150, 61, 51, 150, 150, 56, 150, 74, 150, 150, 150], "policy_policy_0_reward": [-415.8423620020971, -1100.2498991335947, -456.0302192549557, -442.08341378213584, -13.376202116073285, -978.9147267922284, -242.31209658470604, -823.9990744195386, -699.5746873547384, -121.670562124313, -356.98720808945603, -617.1807986229268, -638.1571747294504, -702.9287904763876, -1002.3598849361631, -445.20482784175107, -671.0032142586477, -103.77400038521499, -531.2840782589756, -225.97536328928078, -164.6702767380527, -302.3227091092481, -1217.6011072864515, -553.3482763925543, -1169.3415273625485, -1083.5308079232664, -697.2357032894486, -1006.275214837468, -206.37054090010625, -428.2516722470699, -1042.5273322720866, -641.4913674011145, -251.16301960603647, -1286.8356316222319, -887.6709088769666, -1007.7547202470242, -1065.2983853637531, -393.2125447277508, -670.7988496507678, -700.6916421374823, -573.1189810950675, -1037.2610358006764, -485.3411351323675, -1093.8442538099443, -387.4784757571045, -740.6547631042749, -81.04239561189519, -989.6555656771792, -990.9346387686842, -1139.54570013878, -1287.7452572200864, -1157.195874204966, -570.728733752548, -938.2343505778382, -482.74199032402197, -682.1928892071884, -107.85341677651489, -243.48923944868596, -1308.6312476540097, -242.70154829022195, -1055.273863908765, -53.68737343700607, -419.8010052384705, -288.56416143220986, -327.9093623708257, -673.9647048979211, -855.7924553690422, -1151.7921653215801, -531.8137584005079, -939.0823980107507, -694.1664173875695, -1130.9305873981334, -855.1646582964524, -340.9578405068127, -28.86545124073799, -835.9661653042458, -218.88795069754127, -1195.7810792456314, -348.0995251767991, -1104.623619459026, -1061.0939502805427, -937.0465069079246, -575.6245956217534, -1123.460464168114, -110.32828180014123, -50.30517905254964, -182.18168282447988, -466.44106080739436, -1023.8069436332555, -522.303693086088, -82.30419756085969, -74.81142337014721, -1395.943071435295, -1182.3288381946104, -35.0653813860669, -853.0410218324164, -164.61425924562081, -1101.4947904972673, -843.4537231999889, -955.1171271363097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562250664460994, "mean_inference_ms": 1.6647369208579608, "mean_action_processing_ms": 0.27625000191919163, "mean_env_wait_ms": 3.393981089705772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012278079986572266, "StateBufferConnector_ms": 0.008078813552856445, "ViewRequirementAgentConnector_ms": 0.19476628303527832}, "num_episodes": 34, "episode_return_max": -13.376202116073285, "episode_return_min": -1395.943071435295, "episode_return_mean": -656.9758304993696, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6407671266757, "num_env_steps_trained_throughput_per_sec": 307.6407671266757, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12924.54, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12924.464, "sample_time_ms": 1122.007, "learn_time_ms": 11740.509, "learn_throughput": 340.701, "synch_weights_time_ms": 61.169}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1e132_00001", "date": "2024-08-04_07-36-07", "timestamp": 1722737167, "time_this_iter_s": 13.014275074005127, "time_total_s": 191.44114875793457, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 191.44114875793457, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.03888888888889, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 228.11890568733216, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7540963330616555, "policy_loss": -0.007970188753097318, "vf_loss": 1.7573919042944908, "vf_explained_var": 0.9896903414900105, "kl": 0.015988777793639514, "entropy": 1.2201402806987365, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -28.86545124073799, "episode_reward_min": -1395.943071435295, "episode_reward_mean": -710.9119012429786, "episode_len_mean": 130.39, "episode_media": {}, "episodes_timesteps_total": 13039, "policy_reward_min": {"policy_0": -1395.943071435295}, "policy_reward_max": {"policy_0": -28.86545124073799}, "policy_reward_mean": {"policy_0": -710.9119012429786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1042.5273322720866, -641.4913674011145, -251.16301960603647, -1286.8356316222319, -887.6709088769666, -1007.7547202470242, -1065.2983853637531, -393.2125447277508, -670.7988496507678, -700.6916421374823, -573.1189810950675, -1037.2610358006764, -485.3411351323675, -1093.8442538099443, -387.4784757571045, -740.6547631042749, -81.04239561189519, -989.6555656771792, -990.9346387686842, -1139.54570013878, -1287.7452572200864, -1157.195874204966, -570.728733752548, -938.2343505778382, -482.74199032402197, -682.1928892071884, -107.85341677651489, -243.48923944868596, -1308.6312476540097, -242.70154829022195, -1055.273863908765, -53.68737343700607, -419.8010052384705, -288.56416143220986, -327.9093623708257, -673.9647048979211, -855.7924553690422, -1151.7921653215801, -531.8137584005079, -939.0823980107507, -694.1664173875695, -1130.9305873981334, -855.1646582964524, -340.9578405068127, -28.86545124073799, -835.9661653042458, -218.88795069754127, -1195.7810792456314, -348.0995251767991, -1104.623619459026, -1061.0939502805427, -937.0465069079246, -575.6245956217534, -1123.460464168114, -110.32828180014123, -50.30517905254964, -182.18168282447988, -466.44106080739436, -1023.8069436332555, -522.303693086088, -82.30419756085969, -74.81142337014721, -1395.943071435295, -1182.3288381946104, -35.0653813860669, -853.0410218324164, -164.61425924562081, -1101.4947904972673, -843.4537231999889, -955.1171271363097, -946.0058410401995, -824.2570228766715, -1040.1175433233316, -975.2979195216645, -739.2345300151361, -144.38077320904983, -1098.1658154404377, -745.3173216304166, -879.2569411505481, -1029.9166400797826, -606.7119534751032, -653.5711292648734, -325.529672720604, -1198.4063254025666, -483.3235707536551, -1078.693530305179, -915.9915953431741, -54.711527861728655, -1104.0488787972708, -333.6819005179884, -987.3544823385525, -407.59708446892614, -1235.950069495726, -884.6259482534281, -463.32511888945356, -700.5755702625214, -266.2684112979909, -910.5081384779633, -789.7796381586387, -988.8586005271678], "episode_lengths": [150, 150, 111, 150, 150, 150, 150, 150, 150, 129, 115, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 131, 47, 127, 150, 71, 150, 65, 104, 84, 83, 150, 150, 150, 125, 150, 150, 150, 150, 106, 41, 150, 66, 150, 94, 150, 150, 150, 150, 150, 62, 46, 82, 150, 150, 150, 61, 51, 150, 150, 56, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 103, 150, 112, 150, 150, 150], "policy_policy_0_reward": [-1042.5273322720866, -641.4913674011145, -251.16301960603647, -1286.8356316222319, -887.6709088769666, -1007.7547202470242, -1065.2983853637531, -393.2125447277508, -670.7988496507678, -700.6916421374823, -573.1189810950675, -1037.2610358006764, -485.3411351323675, -1093.8442538099443, -387.4784757571045, -740.6547631042749, -81.04239561189519, -989.6555656771792, -990.9346387686842, -1139.54570013878, -1287.7452572200864, -1157.195874204966, -570.728733752548, -938.2343505778382, -482.74199032402197, -682.1928892071884, -107.85341677651489, -243.48923944868596, -1308.6312476540097, -242.70154829022195, -1055.273863908765, -53.68737343700607, -419.8010052384705, -288.56416143220986, -327.9093623708257, -673.9647048979211, -855.7924553690422, -1151.7921653215801, -531.8137584005079, -939.0823980107507, -694.1664173875695, -1130.9305873981334, -855.1646582964524, -340.9578405068127, -28.86545124073799, -835.9661653042458, -218.88795069754127, -1195.7810792456314, -348.0995251767991, -1104.623619459026, -1061.0939502805427, -937.0465069079246, -575.6245956217534, -1123.460464168114, -110.32828180014123, -50.30517905254964, -182.18168282447988, -466.44106080739436, -1023.8069436332555, -522.303693086088, -82.30419756085969, -74.81142337014721, -1395.943071435295, -1182.3288381946104, -35.0653813860669, -853.0410218324164, -164.61425924562081, -1101.4947904972673, -843.4537231999889, -955.1171271363097, -946.0058410401995, -824.2570228766715, -1040.1175433233316, -975.2979195216645, -739.2345300151361, -144.38077320904983, -1098.1658154404377, -745.3173216304166, -879.2569411505481, -1029.9166400797826, -606.7119534751032, -653.5711292648734, -325.529672720604, -1198.4063254025666, -483.3235707536551, -1078.693530305179, -915.9915953431741, -54.711527861728655, -1104.0488787972708, -333.6819005179884, -987.3544823385525, -407.59708446892614, -1235.950069495726, -884.6259482534281, -463.32511888945356, -700.5755702625214, -266.2684112979909, -910.5081384779633, -789.7796381586387, -988.8586005271678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566159357225349, "mean_inference_ms": 1.6661336854791557, "mean_action_processing_ms": 0.27603674959513497, "mean_env_wait_ms": 3.396178023572783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012530803680419922, "StateBufferConnector_ms": 0.008102655410766602, "ViewRequirementAgentConnector_ms": 0.19437146186828613}, "num_episodes": 30, "episode_return_max": -28.86545124073799, "episode_return_min": -1395.943071435295, "episode_return_mean": -710.9119012429786, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.2573899648339, "num_env_steps_trained_throughput_per_sec": 305.2573899648339, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12929.112, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12929.035, "sample_time_ms": 1121.503, "learn_time_ms": 11743.568, "learn_throughput": 340.612, "synch_weights_time_ms": 63.16}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1e132_00001", "date": "2024-08-04_07-36-21", "timestamp": 1722737181, "time_this_iter_s": 13.117790222167969, "time_total_s": 204.55893898010254, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996513eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.55893898010254, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.536842105263162, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 206.7997245669365, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.71409598775208, "policy_loss": -0.006555910592821116, "vf_loss": 1.716876155200104, "vf_explained_var": 0.9742951285714905, "kl": 0.012997447450743493, "entropy": 1.2348783129826189, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -28.86545124073799, "episode_reward_min": -1502.202986027581, "episode_reward_mean": -708.9918689113401, "episode_len_mean": 130.06, "episode_media": {}, "episodes_timesteps_total": 13006, "policy_reward_min": {"policy_0": -1502.202986027581}, "policy_reward_max": {"policy_0": -28.86545124073799}, "policy_reward_mean": {"policy_0": -708.9918689113401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-242.70154829022195, -1055.273863908765, -53.68737343700607, -419.8010052384705, -288.56416143220986, -327.9093623708257, -673.9647048979211, -855.7924553690422, -1151.7921653215801, -531.8137584005079, -939.0823980107507, -694.1664173875695, -1130.9305873981334, -855.1646582964524, -340.9578405068127, -28.86545124073799, -835.9661653042458, -218.88795069754127, -1195.7810792456314, -348.0995251767991, -1104.623619459026, -1061.0939502805427, -937.0465069079246, -575.6245956217534, -1123.460464168114, -110.32828180014123, -50.30517905254964, -182.18168282447988, -466.44106080739436, -1023.8069436332555, -522.303693086088, -82.30419756085969, -74.81142337014721, -1395.943071435295, -1182.3288381946104, -35.0653813860669, -853.0410218324164, -164.61425924562081, -1101.4947904972673, -843.4537231999889, -955.1171271363097, -946.0058410401995, -824.2570228766715, -1040.1175433233316, -975.2979195216645, -739.2345300151361, -144.38077320904983, -1098.1658154404377, -745.3173216304166, -879.2569411505481, -1029.9166400797826, -606.7119534751032, -653.5711292648734, -325.529672720604, -1198.4063254025666, -483.3235707536551, -1078.693530305179, -915.9915953431741, -54.711527861728655, -1104.0488787972708, -333.6819005179884, -987.3544823385525, -407.59708446892614, -1235.950069495726, -884.6259482534281, -463.32511888945356, -700.5755702625214, -266.2684112979909, -910.5081384779633, -789.7796381586387, -988.8586005271678, -412.44820845262143, -615.3930187365445, -1215.9229827454906, -336.68630294970376, -193.96475396679276, -1054.8326909116943, -497.1765698286336, -658.6584086817205, -542.2179569943647, -1058.4729625512273, -963.7895898097606, -1209.559239454058, -607.2476540225812, -1502.202986027581, -1025.1045848693732, -971.1251231406492, -709.0501974187995, -696.8494911328489, -955.2072563989478, -655.5728060686686, -858.0176025082623, -848.1896981908668, -300.4958257612585, -383.1824561686802, -1032.6540624802194, -269.4604686172957, -693.0905396405933, -690.4055323321531, -1096.1521429418037], "episode_lengths": [71, 150, 65, 104, 84, 83, 150, 150, 150, 125, 150, 150, 150, 150, 106, 41, 150, 66, 150, 94, 150, 150, 150, 150, 150, 62, 46, 82, 150, 150, 150, 61, 51, 150, 150, 56, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 103, 150, 112, 150, 150, 150, 98, 140, 150, 113, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 102, 97, 150, 73, 136, 150, 150], "policy_policy_0_reward": [-242.70154829022195, -1055.273863908765, -53.68737343700607, -419.8010052384705, -288.56416143220986, -327.9093623708257, -673.9647048979211, -855.7924553690422, -1151.7921653215801, -531.8137584005079, -939.0823980107507, -694.1664173875695, -1130.9305873981334, -855.1646582964524, -340.9578405068127, -28.86545124073799, -835.9661653042458, -218.88795069754127, -1195.7810792456314, -348.0995251767991, -1104.623619459026, -1061.0939502805427, -937.0465069079246, -575.6245956217534, -1123.460464168114, -110.32828180014123, -50.30517905254964, -182.18168282447988, -466.44106080739436, -1023.8069436332555, -522.303693086088, -82.30419756085969, -74.81142337014721, -1395.943071435295, -1182.3288381946104, -35.0653813860669, -853.0410218324164, -164.61425924562081, -1101.4947904972673, -843.4537231999889, -955.1171271363097, -946.0058410401995, -824.2570228766715, -1040.1175433233316, -975.2979195216645, -739.2345300151361, -144.38077320904983, -1098.1658154404377, -745.3173216304166, -879.2569411505481, -1029.9166400797826, -606.7119534751032, -653.5711292648734, -325.529672720604, -1198.4063254025666, -483.3235707536551, -1078.693530305179, -915.9915953431741, -54.711527861728655, -1104.0488787972708, -333.6819005179884, -987.3544823385525, -407.59708446892614, -1235.950069495726, -884.6259482534281, -463.32511888945356, -700.5755702625214, -266.2684112979909, -910.5081384779633, -789.7796381586387, -988.8586005271678, -412.44820845262143, -615.3930187365445, -1215.9229827454906, -336.68630294970376, -193.96475396679276, -1054.8326909116943, -497.1765698286336, -658.6584086817205, -542.2179569943647, -1058.4729625512273, -963.7895898097606, -1209.559239454058, -607.2476540225812, -1502.202986027581, -1025.1045848693732, -971.1251231406492, -709.0501974187995, -696.8494911328489, -955.2072563989478, -655.5728060686686, -858.0176025082623, -848.1896981908668, -300.4958257612585, -383.1824561686802, -1032.6540624802194, -269.4604686172957, -693.0905396405933, -690.4055323321531, -1096.1521429418037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567046666812474, "mean_inference_ms": 1.6656196330381225, "mean_action_processing_ms": 0.27588746592481406, "mean_env_wait_ms": 3.395629979829952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012340545654296875, "StateBufferConnector_ms": 0.008059263229370117, "ViewRequirementAgentConnector_ms": 0.1920919418334961}, "num_episodes": 29, "episode_return_max": -28.86545124073799, "episode_return_min": -1502.202986027581, "episode_return_mean": -708.9918689113401, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.29984992393963, "num_env_steps_trained_throughput_per_sec": 315.29984992393963, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12867.044, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12866.967, "sample_time_ms": 1105.992, "learn_time_ms": 11697.212, "learn_throughput": 341.962, "synch_weights_time_ms": 62.966}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1e132_00001", "date": "2024-08-04_07-36-33", "timestamp": 1722737193, "time_this_iter_s": 12.699289560317993, "time_total_s": 217.25822854042053, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a6d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.25822854042053, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.88888888888889, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.68668142755826, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.5904420622624458, "policy_loss": -0.009464131501348068, "vf_loss": 1.5958770566930374, "vf_explained_var": 0.9878631211817265, "kl": 0.013832060582656914, "entropy": 1.2047823725268245, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -35.0653813860669, "episode_reward_min": -1502.202986027581, "episode_reward_mean": -743.4181236644815, "episode_len_mean": 132.04, "episode_media": {}, "episodes_timesteps_total": 13204, "policy_reward_min": {"policy_0": -1502.202986027581}, "policy_reward_max": {"policy_0": -35.0653813860669}, "policy_reward_mean": {"policy_0": -743.4181236644815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-522.303693086088, -82.30419756085969, -74.81142337014721, -1395.943071435295, -1182.3288381946104, -35.0653813860669, -853.0410218324164, -164.61425924562081, -1101.4947904972673, -843.4537231999889, -955.1171271363097, -946.0058410401995, -824.2570228766715, -1040.1175433233316, -975.2979195216645, -739.2345300151361, -144.38077320904983, -1098.1658154404377, -745.3173216304166, -879.2569411505481, -1029.9166400797826, -606.7119534751032, -653.5711292648734, -325.529672720604, -1198.4063254025666, -483.3235707536551, -1078.693530305179, -915.9915953431741, -54.711527861728655, -1104.0488787972708, -333.6819005179884, -987.3544823385525, -407.59708446892614, -1235.950069495726, -884.6259482534281, -463.32511888945356, -700.5755702625214, -266.2684112979909, -910.5081384779633, -789.7796381586387, -988.8586005271678, -412.44820845262143, -615.3930187365445, -1215.9229827454906, -336.68630294970376, -193.96475396679276, -1054.8326909116943, -497.1765698286336, -658.6584086817205, -542.2179569943647, -1058.4729625512273, -963.7895898097606, -1209.559239454058, -607.2476540225812, -1502.202986027581, -1025.1045848693732, -971.1251231406492, -709.0501974187995, -696.8494911328489, -955.2072563989478, -655.5728060686686, -858.0176025082623, -848.1896981908668, -300.4958257612585, -383.1824561686802, -1032.6540624802194, -269.4604686172957, -693.0905396405933, -690.4055323321531, -1096.1521429418037, -1120.2565606102, -193.07151137389098, -972.4022836115695, -1177.5633066822832, -382.32277213522053, -226.8061812887184, -991.8472192990332, -580.8420015883544, -1023.7559981752511, -1103.3126641087022, -720.6348371200675, -942.5805766729181, -537.8236924913331, -849.3437751522326, -1419.7864572752553, -1089.105786704718, -1061.185432901807, -1120.3239739514631, -1118.2660839380221, -1029.9877231887358, -162.24576219169435, -1076.2074781584038, -928.6229870937657, -268.25657366804603, -915.6556844526766, -856.0762210090226, -150.15654497297226, -135.5203712046872, -46.324537113191745, -66.45523366629959], "episode_lengths": [150, 61, 51, 150, 150, 56, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 103, 150, 112, 150, 150, 150, 98, 140, 150, 113, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 102, 97, 150, 73, 136, 150, 150, 150, 81, 150, 150, 89, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 80, 150, 150, 64, 63, 49, 48], "policy_policy_0_reward": [-522.303693086088, -82.30419756085969, -74.81142337014721, -1395.943071435295, -1182.3288381946104, -35.0653813860669, -853.0410218324164, -164.61425924562081, -1101.4947904972673, -843.4537231999889, -955.1171271363097, -946.0058410401995, -824.2570228766715, -1040.1175433233316, -975.2979195216645, -739.2345300151361, -144.38077320904983, -1098.1658154404377, -745.3173216304166, -879.2569411505481, -1029.9166400797826, -606.7119534751032, -653.5711292648734, -325.529672720604, -1198.4063254025666, -483.3235707536551, -1078.693530305179, -915.9915953431741, -54.711527861728655, -1104.0488787972708, -333.6819005179884, -987.3544823385525, -407.59708446892614, -1235.950069495726, -884.6259482534281, -463.32511888945356, -700.5755702625214, -266.2684112979909, -910.5081384779633, -789.7796381586387, -988.8586005271678, -412.44820845262143, -615.3930187365445, -1215.9229827454906, -336.68630294970376, -193.96475396679276, -1054.8326909116943, -497.1765698286336, -658.6584086817205, -542.2179569943647, -1058.4729625512273, -963.7895898097606, -1209.559239454058, -607.2476540225812, -1502.202986027581, -1025.1045848693732, -971.1251231406492, -709.0501974187995, -696.8494911328489, -955.2072563989478, -655.5728060686686, -858.0176025082623, -848.1896981908668, -300.4958257612585, -383.1824561686802, -1032.6540624802194, -269.4604686172957, -693.0905396405933, -690.4055323321531, -1096.1521429418037, -1120.2565606102, -193.07151137389098, -972.4022836115695, -1177.5633066822832, -382.32277213522053, -226.8061812887184, -991.8472192990332, -580.8420015883544, -1023.7559981752511, -1103.3126641087022, -720.6348371200675, -942.5805766729181, -537.8236924913331, -849.3437751522326, -1419.7864572752553, -1089.105786704718, -1061.185432901807, -1120.3239739514631, -1118.2660839380221, -1029.9877231887358, -162.24576219169435, -1076.2074781584038, -928.6229870937657, -268.25657366804603, -915.6556844526766, -856.0762210090226, -150.15654497297226, -135.5203712046872, -46.324537113191745, -66.45523366629959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562596931781764, "mean_inference_ms": 1.6670505801676865, "mean_action_processing_ms": 0.2761371896489208, "mean_env_wait_ms": 3.3984305927108895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012445926666259766, "StateBufferConnector_ms": 0.007953405380249023, "ViewRequirementAgentConnector_ms": 0.18973493576049805}, "num_episodes": 30, "episode_return_max": -35.0653813860669, "episode_return_min": -1502.202986027581, "episode_return_mean": -743.4181236644815, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.1184465013553, "num_env_steps_trained_throughput_per_sec": 406.1184465013553, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12574.035, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12573.959, "sample_time_ms": 1128.579, "learn_time_ms": 11382.501, "learn_throughput": 351.417, "synch_weights_time_ms": 62.079}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1e132_00001", "date": "2024-08-04_07-36-43", "timestamp": 1722737203, "time_this_iter_s": 9.860978603363037, "time_total_s": 227.11920714378357, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448b880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.11920714378357, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.97142857142857, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.722300440073, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.9883368968963624, "policy_loss": -0.011489703196760577, "vf_loss": 1.9958559067298969, "vf_explained_var": 0.9800264138728381, "kl": 0.013611502351977844, "entropy": 1.1275479409843683, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -46.324537113191745, "episode_reward_min": -1502.202986027581, "episode_reward_mean": -678.1913213825692, "episode_len_mean": 128.44, "episode_media": {}, "episodes_timesteps_total": 12844, "policy_reward_min": {"policy_0": -1502.202986027581}, "policy_reward_max": {"policy_0": -46.324537113191745}, "policy_reward_mean": {"policy_0": -678.1913213825692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-463.32511888945356, -700.5755702625214, -266.2684112979909, -910.5081384779633, -789.7796381586387, -988.8586005271678, -412.44820845262143, -615.3930187365445, -1215.9229827454906, -336.68630294970376, -193.96475396679276, -1054.8326909116943, -497.1765698286336, -658.6584086817205, -542.2179569943647, -1058.4729625512273, -963.7895898097606, -1209.559239454058, -607.2476540225812, -1502.202986027581, -1025.1045848693732, -971.1251231406492, -709.0501974187995, -696.8494911328489, -955.2072563989478, -655.5728060686686, -858.0176025082623, -848.1896981908668, -300.4958257612585, -383.1824561686802, -1032.6540624802194, -269.4604686172957, -693.0905396405933, -690.4055323321531, -1096.1521429418037, -1120.2565606102, -193.07151137389098, -972.4022836115695, -1177.5633066822832, -382.32277213522053, -226.8061812887184, -991.8472192990332, -580.8420015883544, -1023.7559981752511, -1103.3126641087022, -720.6348371200675, -942.5805766729181, -537.8236924913331, -849.3437751522326, -1419.7864572752553, -1089.105786704718, -1061.185432901807, -1120.3239739514631, -1118.2660839380221, -1029.9877231887358, -162.24576219169435, -1076.2074781584038, -928.6229870937657, -268.25657366804603, -915.6556844526766, -856.0762210090226, -150.15654497297226, -135.5203712046872, -46.324537113191745, -66.45523366629959, -496.34138631708146, -1066.7660993428997, -177.21927100760587, -605.2506824946779, -1158.461138729647, -691.2833263085681, -554.2143657641283, -135.0909598311682, -1111.1552492189057, -249.0640968141903, -1092.540023306391, -292.7040368806737, -973.8281160285969, -309.77944041226056, -569.4703726132237, -793.8870804519225, -110.27456175420134, -1143.4524876119444, -97.89230095932777, -562.1688900358463, -873.542900557735, -649.2299279670892, -293.61992836595624, -626.8675134545086, -759.1243247708303, -82.26381093766037, -107.96524564968294, -467.82081352802743, -722.197170604819, -448.20314522931716, -156.0433577377535, -1040.607840330108, -445.33430732080615, -344.917967029668, -171.36317667221965], "episode_lengths": [103, 150, 112, 150, 150, 150, 98, 140, 150, 113, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 102, 97, 150, 73, 136, 150, 150, 150, 81, 150, 150, 89, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 80, 150, 150, 64, 63, 49, 48, 150, 150, 94, 150, 150, 150, 150, 73, 150, 101, 150, 87, 150, 90, 150, 150, 64, 150, 70, 150, 150, 150, 81, 150, 150, 66, 82, 112, 150, 94, 58, 150, 106, 150, 89], "policy_policy_0_reward": [-463.32511888945356, -700.5755702625214, -266.2684112979909, -910.5081384779633, -789.7796381586387, -988.8586005271678, -412.44820845262143, -615.3930187365445, -1215.9229827454906, -336.68630294970376, -193.96475396679276, -1054.8326909116943, -497.1765698286336, -658.6584086817205, -542.2179569943647, -1058.4729625512273, -963.7895898097606, -1209.559239454058, -607.2476540225812, -1502.202986027581, -1025.1045848693732, -971.1251231406492, -709.0501974187995, -696.8494911328489, -955.2072563989478, -655.5728060686686, -858.0176025082623, -848.1896981908668, -300.4958257612585, -383.1824561686802, -1032.6540624802194, -269.4604686172957, -693.0905396405933, -690.4055323321531, -1096.1521429418037, -1120.2565606102, -193.07151137389098, -972.4022836115695, -1177.5633066822832, -382.32277213522053, -226.8061812887184, -991.8472192990332, -580.8420015883544, -1023.7559981752511, -1103.3126641087022, -720.6348371200675, -942.5805766729181, -537.8236924913331, -849.3437751522326, -1419.7864572752553, -1089.105786704718, -1061.185432901807, -1120.3239739514631, -1118.2660839380221, -1029.9877231887358, -162.24576219169435, -1076.2074781584038, -928.6229870937657, -268.25657366804603, -915.6556844526766, -856.0762210090226, -150.15654497297226, -135.5203712046872, -46.324537113191745, -66.45523366629959, -496.34138631708146, -1066.7660993428997, -177.21927100760587, -605.2506824946779, -1158.461138729647, -691.2833263085681, -554.2143657641283, -135.0909598311682, -1111.1552492189057, -249.0640968141903, -1092.540023306391, -292.7040368806737, -973.8281160285969, -309.77944041226056, -569.4703726132237, -793.8870804519225, -110.27456175420134, -1143.4524876119444, -97.89230095932777, -562.1688900358463, -873.542900557735, -649.2299279670892, -293.61992836595624, -626.8675134545086, -759.1243247708303, -82.26381093766037, -107.96524564968294, -467.82081352802743, -722.197170604819, -448.20314522931716, -156.0433577377535, -1040.607840330108, -445.33430732080615, -344.917967029668, -171.36317667221965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560628630909811, "mean_inference_ms": 1.667990780127076, "mean_action_processing_ms": 0.27643392516897636, "mean_env_wait_ms": 3.3996662666551556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012199163436889648, "StateBufferConnector_ms": 0.008110761642456055, "ViewRequirementAgentConnector_ms": 0.19529080390930176}, "num_episodes": 35, "episode_return_max": -46.324537113191745, "episode_return_min": -1502.202986027581, "episode_return_mean": -678.1913213825692, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.4052550461354, "num_env_steps_trained_throughput_per_sec": 370.4052550461354, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12350.648, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12350.571, "sample_time_ms": 1130.718, "learn_time_ms": 11156.453, "learn_throughput": 358.537, "synch_weights_time_ms": 62.591}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1e132_00001", "date": "2024-08-04_07-36-54", "timestamp": 1722737214, "time_this_iter_s": 10.811883449554443, "time_total_s": 237.931090593338, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996513130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.931090593338, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.8375, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.97361707091332, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7607864698395133, "policy_loss": -0.01460288921710647, "vf_loss": 1.7710237151632706, "vf_explained_var": 0.9896125443279743, "kl": 0.014919463479494289, "entropy": 1.1019196004296343, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -7.788782778246059, "episode_reward_min": -1419.7864572752553, "episode_reward_mean": -604.8422056129791, "episode_len_mean": 122.85, "episode_media": {}, "episodes_timesteps_total": 12285, "policy_reward_min": {"policy_0": -1419.7864572752553}, "policy_reward_max": {"policy_0": -7.788782778246059}, "policy_reward_mean": {"policy_0": -604.8422056129791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-693.0905396405933, -690.4055323321531, -1096.1521429418037, -1120.2565606102, -193.07151137389098, -972.4022836115695, -1177.5633066822832, -382.32277213522053, -226.8061812887184, -991.8472192990332, -580.8420015883544, -1023.7559981752511, -1103.3126641087022, -720.6348371200675, -942.5805766729181, -537.8236924913331, -849.3437751522326, -1419.7864572752553, -1089.105786704718, -1061.185432901807, -1120.3239739514631, -1118.2660839380221, -1029.9877231887358, -162.24576219169435, -1076.2074781584038, -928.6229870937657, -268.25657366804603, -915.6556844526766, -856.0762210090226, -150.15654497297226, -135.5203712046872, -46.324537113191745, -66.45523366629959, -496.34138631708146, -1066.7660993428997, -177.21927100760587, -605.2506824946779, -1158.461138729647, -691.2833263085681, -554.2143657641283, -135.0909598311682, -1111.1552492189057, -249.0640968141903, -1092.540023306391, -292.7040368806737, -973.8281160285969, -309.77944041226056, -569.4703726132237, -793.8870804519225, -110.27456175420134, -1143.4524876119444, -97.89230095932777, -562.1688900358463, -873.542900557735, -649.2299279670892, -293.61992836595624, -626.8675134545086, -759.1243247708303, -82.26381093766037, -107.96524564968294, -467.82081352802743, -722.197170604819, -448.20314522931716, -156.0433577377535, -1040.607840330108, -445.33430732080615, -344.917967029668, -171.36317667221965, -553.5500326649205, -1101.4585856193642, -707.3369539075327, -783.5472211368755, -49.14435297733451, -145.51085830551438, -644.9959647914769, -261.4827891678419, -1017.9530708250763, -526.2840025890284, -82.30088942433628, -608.5586691578297, -1349.6659491013982, -704.5352123336012, -812.3142087684067, -232.28914641362815, -286.4898459248313, -131.8810759299503, -585.8502950521079, -1014.4084375551565, -58.00211700221592, -946.7805416485563, -125.15241786249996, -694.8657681093375, -138.37204882904535, -927.8035320919236, -91.03915314651094, -387.34822108803775, -42.90125902868734, -7.788782778246059, -669.0642485955286, -669.2111467165756], "episode_lengths": [136, 150, 150, 150, 81, 150, 150, 89, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 80, 150, 150, 64, 63, 49, 48, 150, 150, 94, 150, 150, 150, 150, 73, 150, 101, 150, 87, 150, 90, 150, 150, 64, 150, 70, 150, 150, 150, 81, 150, 150, 66, 82, 112, 150, 94, 58, 150, 106, 150, 89, 150, 150, 150, 150, 65, 82, 150, 100, 150, 134, 64, 150, 150, 150, 150, 100, 138, 72, 150, 150, 63, 150, 65, 150, 76, 150, 67, 150, 41, 38, 150, 150], "policy_policy_0_reward": [-693.0905396405933, -690.4055323321531, -1096.1521429418037, -1120.2565606102, -193.07151137389098, -972.4022836115695, -1177.5633066822832, -382.32277213522053, -226.8061812887184, -991.8472192990332, -580.8420015883544, -1023.7559981752511, -1103.3126641087022, -720.6348371200675, -942.5805766729181, -537.8236924913331, -849.3437751522326, -1419.7864572752553, -1089.105786704718, -1061.185432901807, -1120.3239739514631, -1118.2660839380221, -1029.9877231887358, -162.24576219169435, -1076.2074781584038, -928.6229870937657, -268.25657366804603, -915.6556844526766, -856.0762210090226, -150.15654497297226, -135.5203712046872, -46.324537113191745, -66.45523366629959, -496.34138631708146, -1066.7660993428997, -177.21927100760587, -605.2506824946779, -1158.461138729647, -691.2833263085681, -554.2143657641283, -135.0909598311682, -1111.1552492189057, -249.0640968141903, -1092.540023306391, -292.7040368806737, -973.8281160285969, -309.77944041226056, -569.4703726132237, -793.8870804519225, -110.27456175420134, -1143.4524876119444, -97.89230095932777, -562.1688900358463, -873.542900557735, -649.2299279670892, -293.61992836595624, -626.8675134545086, -759.1243247708303, -82.26381093766037, -107.96524564968294, -467.82081352802743, -722.197170604819, -448.20314522931716, -156.0433577377535, -1040.607840330108, -445.33430732080615, -344.917967029668, -171.36317667221965, -553.5500326649205, -1101.4585856193642, -707.3369539075327, -783.5472211368755, -49.14435297733451, -145.51085830551438, -644.9959647914769, -261.4827891678419, -1017.9530708250763, -526.2840025890284, -82.30088942433628, -608.5586691578297, -1349.6659491013982, -704.5352123336012, -812.3142087684067, -232.28914641362815, -286.4898459248313, -131.8810759299503, -585.8502950521079, -1014.4084375551565, -58.00211700221592, -946.7805416485563, -125.15241786249996, -694.8657681093375, -138.37204882904535, -927.8035320919236, -91.03915314651094, -387.34822108803775, -42.90125902868734, -7.788782778246059, -669.0642485955286, -669.2111467165756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562832866552195, "mean_inference_ms": 1.6696488529536035, "mean_action_processing_ms": 0.27663434664234415, "mean_env_wait_ms": 3.399773016817317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012380838394165039, "StateBufferConnector_ms": 0.008135318756103516, "ViewRequirementAgentConnector_ms": 0.1975879669189453}, "num_episodes": 32, "episode_return_max": -7.788782778246059, "episode_return_min": -1419.7864572752553, "episode_return_mean": -604.8422056129791, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.5540644835247, "num_env_steps_trained_throughput_per_sec": 307.5540644835247, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12401.724, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12401.648, "sample_time_ms": 1128.708, "learn_time_ms": 11207.838, "learn_throughput": 356.893, "synch_weights_time_ms": 64.29}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1e132_00001", "date": "2024-08-04_07-37-07", "timestamp": 1722737227, "time_this_iter_s": 13.017601013183594, "time_total_s": 250.9486916065216, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.9486916065216, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.694444444444443, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.24378553231557, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.931852475615839, "policy_loss": -0.008920348883596793, "vf_loss": 1.9357141403481364, "vf_explained_var": 0.9851193424935142, "kl": 0.01728352030631868, "entropy": 1.2636870767300328, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -7.788782778246059, "episode_reward_min": -1349.6659491013982, "episode_reward_mean": -553.6536575868453, "episode_len_mean": 121.53, "episode_media": {}, "episodes_timesteps_total": 12153, "policy_reward_min": {"policy_0": -1349.6659491013982}, "policy_reward_max": {"policy_0": -7.788782778246059}, "policy_reward_mean": {"policy_0": -553.6536575868453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1066.7660993428997, -177.21927100760587, -605.2506824946779, -1158.461138729647, -691.2833263085681, -554.2143657641283, -135.0909598311682, -1111.1552492189057, -249.0640968141903, -1092.540023306391, -292.7040368806737, -973.8281160285969, -309.77944041226056, -569.4703726132237, -793.8870804519225, -110.27456175420134, -1143.4524876119444, -97.89230095932777, -562.1688900358463, -873.542900557735, -649.2299279670892, -293.61992836595624, -626.8675134545086, -759.1243247708303, -82.26381093766037, -107.96524564968294, -467.82081352802743, -722.197170604819, -448.20314522931716, -156.0433577377535, -1040.607840330108, -445.33430732080615, -344.917967029668, -171.36317667221965, -553.5500326649205, -1101.4585856193642, -707.3369539075327, -783.5472211368755, -49.14435297733451, -145.51085830551438, -644.9959647914769, -261.4827891678419, -1017.9530708250763, -526.2840025890284, -82.30088942433628, -608.5586691578297, -1349.6659491013982, -704.5352123336012, -812.3142087684067, -232.28914641362815, -286.4898459248313, -131.8810759299503, -585.8502950521079, -1014.4084375551565, -58.00211700221592, -946.7805416485563, -125.15241786249996, -694.8657681093375, -138.37204882904535, -927.8035320919236, -91.03915314651094, -387.34822108803775, -42.90125902868734, -7.788782778246059, -669.0642485955286, -669.2111467165756, -663.6467453969768, -616.108853260468, -813.0682381165698, -58.40067720909991, -1080.2564449785546, -628.8503314601891, -1303.990018902052, -464.42472997914956, -563.6109670403036, -840.9186167402055, -110.81577072260876, -1016.7182743748103, -27.84774720259087, -124.12232688910551, -994.7501968393899, -791.7166488123281, -362.54472391082373, -818.6828289722703, -709.5070761767855, -926.4074356427461, -557.6608472986231, -734.3849801257901, -538.2448644973983, -1083.0870366933075, -1173.9411918689077, -257.2901226995407, -54.73545818330422, -94.23564918437556, -279.66664473279155, -144.78684698841863, -337.9525727006709, -666.8204244987179, -240.49270431198798, -1044.1870340079226], "episode_lengths": [150, 94, 150, 150, 150, 150, 73, 150, 101, 150, 87, 150, 90, 150, 150, 64, 150, 70, 150, 150, 150, 81, 150, 150, 66, 82, 112, 150, 94, 58, 150, 106, 150, 89, 150, 150, 150, 150, 65, 82, 150, 100, 150, 134, 64, 150, 150, 150, 150, 100, 138, 72, 150, 150, 63, 150, 65, 150, 76, 150, 67, 150, 41, 38, 150, 150, 150, 150, 150, 61, 150, 150, 150, 107, 150, 150, 74, 150, 47, 66, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 68, 81, 58, 95, 150, 104, 150], "policy_policy_0_reward": [-1066.7660993428997, -177.21927100760587, -605.2506824946779, -1158.461138729647, -691.2833263085681, -554.2143657641283, -135.0909598311682, -1111.1552492189057, -249.0640968141903, -1092.540023306391, -292.7040368806737, -973.8281160285969, -309.77944041226056, -569.4703726132237, -793.8870804519225, -110.27456175420134, -1143.4524876119444, -97.89230095932777, -562.1688900358463, -873.542900557735, -649.2299279670892, -293.61992836595624, -626.8675134545086, -759.1243247708303, -82.26381093766037, -107.96524564968294, -467.82081352802743, -722.197170604819, -448.20314522931716, -156.0433577377535, -1040.607840330108, -445.33430732080615, -344.917967029668, -171.36317667221965, -553.5500326649205, -1101.4585856193642, -707.3369539075327, -783.5472211368755, -49.14435297733451, -145.51085830551438, -644.9959647914769, -261.4827891678419, -1017.9530708250763, -526.2840025890284, -82.30088942433628, -608.5586691578297, -1349.6659491013982, -704.5352123336012, -812.3142087684067, -232.28914641362815, -286.4898459248313, -131.8810759299503, -585.8502950521079, -1014.4084375551565, -58.00211700221592, -946.7805416485563, -125.15241786249996, -694.8657681093375, -138.37204882904535, -927.8035320919236, -91.03915314651094, -387.34822108803775, -42.90125902868734, -7.788782778246059, -669.0642485955286, -669.2111467165756, -663.6467453969768, -616.108853260468, -813.0682381165698, -58.40067720909991, -1080.2564449785546, -628.8503314601891, -1303.990018902052, -464.42472997914956, -563.6109670403036, -840.9186167402055, -110.81577072260876, -1016.7182743748103, -27.84774720259087, -124.12232688910551, -994.7501968393899, -791.7166488123281, -362.54472391082373, -818.6828289722703, -709.5070761767855, -926.4074356427461, -557.6608472986231, -734.3849801257901, -538.2448644973983, -1083.0870366933075, -1173.9411918689077, -257.2901226995407, -54.73545818330422, -94.23564918437556, -279.66664473279155, -144.78684698841863, -337.9525727006709, -666.8204244987179, -240.49270431198798, -1044.1870340079226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570285519319903, "mean_inference_ms": 1.6707249710350118, "mean_action_processing_ms": 0.2766266327928781, "mean_env_wait_ms": 3.4013502195534397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011923074722290039, "StateBufferConnector_ms": 0.008079767227172852, "ViewRequirementAgentConnector_ms": 0.19705963134765625}, "num_episodes": 34, "episode_return_max": -7.788782778246059, "episode_return_min": -1349.6659491013982, "episode_return_mean": -553.6536575868453, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7785329643085, "num_env_steps_trained_throughput_per_sec": 303.7785329643085, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12409.419, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12409.344, "sample_time_ms": 1127.1, "learn_time_ms": 11218.278, "learn_throughput": 356.561, "synch_weights_time_ms": 63.144}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1e132_00001", "date": "2024-08-04_07-37-20", "timestamp": 1722737240, "time_this_iter_s": 13.180463075637817, "time_total_s": 264.1291546821594, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.1291546821594, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.53684210526316, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.72096032301585, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.8156199557706714, "policy_loss": -0.009846533899932789, "vf_loss": 1.8212541262619197, "vf_explained_var": 0.9836696901669105, "kl": 0.014424306202272436, "entropy": 1.149254630940656, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 3.7916380157289327, "episode_reward_min": -1349.6659491013982, "episode_reward_mean": -544.0852544258436, "episode_len_mean": 121.42, "episode_media": {}, "episodes_timesteps_total": 12142, "policy_reward_min": {"policy_0": -1349.6659491013982}, "policy_reward_max": {"policy_0": 3.7916380157289327}, "policy_reward_mean": {"policy_0": -544.0852544258436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-344.917967029668, -171.36317667221965, -553.5500326649205, -1101.4585856193642, -707.3369539075327, -783.5472211368755, -49.14435297733451, -145.51085830551438, -644.9959647914769, -261.4827891678419, -1017.9530708250763, -526.2840025890284, -82.30088942433628, -608.5586691578297, -1349.6659491013982, -704.5352123336012, -812.3142087684067, -232.28914641362815, -286.4898459248313, -131.8810759299503, -585.8502950521079, -1014.4084375551565, -58.00211700221592, -946.7805416485563, -125.15241786249996, -694.8657681093375, -138.37204882904535, -927.8035320919236, -91.03915314651094, -387.34822108803775, -42.90125902868734, -7.788782778246059, -669.0642485955286, -669.2111467165756, -663.6467453969768, -616.108853260468, -813.0682381165698, -58.40067720909991, -1080.2564449785546, -628.8503314601891, -1303.990018902052, -464.42472997914956, -563.6109670403036, -840.9186167402055, -110.81577072260876, -1016.7182743748103, -27.84774720259087, -124.12232688910551, -994.7501968393899, -791.7166488123281, -362.54472391082373, -818.6828289722703, -709.5070761767855, -926.4074356427461, -557.6608472986231, -734.3849801257901, -538.2448644973983, -1083.0870366933075, -1173.9411918689077, -257.2901226995407, -54.73545818330422, -94.23564918437556, -279.66664473279155, -144.78684698841863, -337.9525727006709, -666.8204244987179, -240.49270431198798, -1044.1870340079226, -814.5753048084883, -248.95315444482208, -957.4113550442672, -1011.8390003311891, -745.7065179260929, -211.83109849858047, -356.0086742958115, -441.591479683964, -393.5535864851826, -660.0436785350709, -299.84635807311054, -390.74618723214775, -785.2220835128303, -351.6959343538195, -978.8659092634075, -942.7390917866169, 3.7916380157289327, -393.022071914585, -283.7986889039144, -141.28065490794526, -767.1386901793585, -217.6053836532685, -745.499412343008, -105.34859972899584, -1077.7797919865184, -1292.684412657536, -883.5363988549503, -461.88643479125847, -775.5126953584585, -232.2391173091308, -275.0174494174737, -171.29489165424076], "episode_lengths": [150, 89, 150, 150, 150, 150, 65, 82, 150, 100, 150, 134, 64, 150, 150, 150, 150, 100, 138, 72, 150, 150, 63, 150, 65, 150, 76, 150, 67, 150, 41, 38, 150, 150, 150, 150, 150, 61, 150, 150, 150, 107, 150, 150, 74, 150, 47, 66, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 68, 81, 58, 95, 150, 104, 150, 150, 79, 150, 150, 150, 93, 150, 150, 150, 150, 91, 150, 150, 119, 150, 150, 31, 96, 88, 55, 150, 68, 150, 68, 150, 150, 150, 108, 150, 114, 78, 79], "policy_policy_0_reward": [-344.917967029668, -171.36317667221965, -553.5500326649205, -1101.4585856193642, -707.3369539075327, -783.5472211368755, -49.14435297733451, -145.51085830551438, -644.9959647914769, -261.4827891678419, -1017.9530708250763, -526.2840025890284, -82.30088942433628, -608.5586691578297, -1349.6659491013982, -704.5352123336012, -812.3142087684067, -232.28914641362815, -286.4898459248313, -131.8810759299503, -585.8502950521079, -1014.4084375551565, -58.00211700221592, -946.7805416485563, -125.15241786249996, -694.8657681093375, -138.37204882904535, -927.8035320919236, -91.03915314651094, -387.34822108803775, -42.90125902868734, -7.788782778246059, -669.0642485955286, -669.2111467165756, -663.6467453969768, -616.108853260468, -813.0682381165698, -58.40067720909991, -1080.2564449785546, -628.8503314601891, -1303.990018902052, -464.42472997914956, -563.6109670403036, -840.9186167402055, -110.81577072260876, -1016.7182743748103, -27.84774720259087, -124.12232688910551, -994.7501968393899, -791.7166488123281, -362.54472391082373, -818.6828289722703, -709.5070761767855, -926.4074356427461, -557.6608472986231, -734.3849801257901, -538.2448644973983, -1083.0870366933075, -1173.9411918689077, -257.2901226995407, -54.73545818330422, -94.23564918437556, -279.66664473279155, -144.78684698841863, -337.9525727006709, -666.8204244987179, -240.49270431198798, -1044.1870340079226, -814.5753048084883, -248.95315444482208, -957.4113550442672, -1011.8390003311891, -745.7065179260929, -211.83109849858047, -356.0086742958115, -441.591479683964, -393.5535864851826, -660.0436785350709, -299.84635807311054, -390.74618723214775, -785.2220835128303, -351.6959343538195, -978.8659092634075, -942.7390917866169, 3.7916380157289327, -393.022071914585, -283.7986889039144, -141.28065490794526, -767.1386901793585, -217.6053836532685, -745.499412343008, -105.34859972899584, -1077.7797919865184, -1292.684412657536, -883.5363988549503, -461.88643479125847, -775.5126953584585, -232.2391173091308, -275.0174494174737, -171.29489165424076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569447828139484, "mean_inference_ms": 1.6704304942221222, "mean_action_processing_ms": 0.27651306606261516, "mean_env_wait_ms": 3.399248838602595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01213979721069336, "StateBufferConnector_ms": 0.008046388626098633, "ViewRequirementAgentConnector_ms": 0.1911327838897705}, "num_episodes": 32, "episode_return_max": 3.7916380157289327, "episode_return_min": -1349.6659491013982, "episode_return_mean": -544.0852544258436, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.7415221137708, "num_env_steps_trained_throughput_per_sec": 310.7415221137708, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12400.871, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12400.797, "sample_time_ms": 1126.261, "learn_time_ms": 11210.845, "learn_throughput": 356.797, "synch_weights_time_ms": 62.87}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1e132_00001", "date": "2024-08-04_07-37-33", "timestamp": 1722737253, "time_this_iter_s": 12.884528875350952, "time_total_s": 277.0136835575104, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996513130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.0136835575104, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.805555555555557, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.65501507123312, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.595955270032088, "policy_loss": -0.011339302859657134, "vf_loss": 1.6025966765048603, "vf_explained_var": 0.9833787970244885, "kl": 0.016071785438968342, "entropy": 1.2364031905308366, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": 3.7916380157289327, "episode_reward_min": -1303.990018902052, "episode_reward_mean": -595.4150863739573, "episode_len_mean": 124.54, "episode_media": {}, "episodes_timesteps_total": 12454, "policy_reward_min": {"policy_0": -1303.990018902052}, "policy_reward_max": {"policy_0": 3.7916380157289327}, "policy_reward_mean": {"policy_0": -595.4150863739573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.788782778246059, -669.0642485955286, -669.2111467165756, -663.6467453969768, -616.108853260468, -813.0682381165698, -58.40067720909991, -1080.2564449785546, -628.8503314601891, -1303.990018902052, -464.42472997914956, -563.6109670403036, -840.9186167402055, -110.81577072260876, -1016.7182743748103, -27.84774720259087, -124.12232688910551, -994.7501968393899, -791.7166488123281, -362.54472391082373, -818.6828289722703, -709.5070761767855, -926.4074356427461, -557.6608472986231, -734.3849801257901, -538.2448644973983, -1083.0870366933075, -1173.9411918689077, -257.2901226995407, -54.73545818330422, -94.23564918437556, -279.66664473279155, -144.78684698841863, -337.9525727006709, -666.8204244987179, -240.49270431198798, -1044.1870340079226, -814.5753048084883, -248.95315444482208, -957.4113550442672, -1011.8390003311891, -745.7065179260929, -211.83109849858047, -356.0086742958115, -441.591479683964, -393.5535864851826, -660.0436785350709, -299.84635807311054, -390.74618723214775, -785.2220835128303, -351.6959343538195, -978.8659092634075, -942.7390917866169, 3.7916380157289327, -393.022071914585, -283.7986889039144, -141.28065490794526, -767.1386901793585, -217.6053836532685, -745.499412343008, -105.34859972899584, -1077.7797919865184, -1292.684412657536, -883.5363988549503, -461.88643479125847, -775.5126953584585, -232.2391173091308, -275.0174494174737, -171.29489165424076, -209.1846402933939, -395.9755019564354, -1143.6449353009548, -992.3952875277492, -957.7393897930165, -240.76779156239715, -157.76552946192183, -913.8761368347189, -189.91199297160185, -650.0357391373542, -242.6391037483651, -502.649840446949, -807.078647500748, -282.8431907706675, -220.00477217435136, -664.0037035557713, -950.1919651672198, -1266.7651487556068, -279.74779325694317, -952.6846110267134, -1185.3004885544624, -756.2485368852937, -636.9172457510286, -533.1738942101209, -779.081466324167, -618.2385622614738, -826.1175228218862, -301.83330547761227, -903.367903289644, -1062.2841424346711, -1038.6181697130273], "episode_lengths": [38, 150, 150, 150, 150, 150, 61, 150, 150, 150, 107, 150, 150, 74, 150, 47, 66, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 68, 81, 58, 95, 150, 104, 150, 150, 79, 150, 150, 150, 93, 150, 150, 150, 150, 91, 150, 150, 119, 150, 150, 31, 96, 88, 55, 150, 68, 150, 68, 150, 150, 150, 108, 150, 114, 78, 79, 66, 138, 150, 150, 150, 71, 74, 150, 84, 150, 102, 150, 150, 106, 89, 129, 150, 150, 80, 150, 150, 129, 150, 150, 146, 150, 150, 104, 150, 150, 150], "policy_policy_0_reward": [-7.788782778246059, -669.0642485955286, -669.2111467165756, -663.6467453969768, -616.108853260468, -813.0682381165698, -58.40067720909991, -1080.2564449785546, -628.8503314601891, -1303.990018902052, -464.42472997914956, -563.6109670403036, -840.9186167402055, -110.81577072260876, -1016.7182743748103, -27.84774720259087, -124.12232688910551, -994.7501968393899, -791.7166488123281, -362.54472391082373, -818.6828289722703, -709.5070761767855, -926.4074356427461, -557.6608472986231, -734.3849801257901, -538.2448644973983, -1083.0870366933075, -1173.9411918689077, -257.2901226995407, -54.73545818330422, -94.23564918437556, -279.66664473279155, -144.78684698841863, -337.9525727006709, -666.8204244987179, -240.49270431198798, -1044.1870340079226, -814.5753048084883, -248.95315444482208, -957.4113550442672, -1011.8390003311891, -745.7065179260929, -211.83109849858047, -356.0086742958115, -441.591479683964, -393.5535864851826, -660.0436785350709, -299.84635807311054, -390.74618723214775, -785.2220835128303, -351.6959343538195, -978.8659092634075, -942.7390917866169, 3.7916380157289327, -393.022071914585, -283.7986889039144, -141.28065490794526, -767.1386901793585, -217.6053836532685, -745.499412343008, -105.34859972899584, -1077.7797919865184, -1292.684412657536, -883.5363988549503, -461.88643479125847, -775.5126953584585, -232.2391173091308, -275.0174494174737, -171.29489165424076, -209.1846402933939, -395.9755019564354, -1143.6449353009548, -992.3952875277492, -957.7393897930165, -240.76779156239715, -157.76552946192183, -913.8761368347189, -189.91199297160185, -650.0357391373542, -242.6391037483651, -502.649840446949, -807.078647500748, -282.8431907706675, -220.00477217435136, -664.0037035557713, -950.1919651672198, -1266.7651487556068, -279.74779325694317, -952.6846110267134, -1185.3004885544624, -756.2485368852937, -636.9172457510286, -533.1738942101209, -779.081466324167, -618.2385622614738, -826.1175228218862, -301.83330547761227, -903.367903289644, -1062.2841424346711, -1038.6181697130273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568719001983726, "mean_inference_ms": 1.670305545767191, "mean_action_processing_ms": 0.27643566760780325, "mean_env_wait_ms": 3.3998014717016036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012053489685058594, "StateBufferConnector_ms": 0.007967948913574219, "ViewRequirementAgentConnector_ms": 0.1888272762298584}, "num_episodes": 31, "episode_return_max": 3.7916380157289327, "episode_return_min": -1303.990018902052, "episode_return_mean": -595.4150863739573, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.6371033606804, "num_env_steps_trained_throughput_per_sec": 409.6371033606804, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12101.29, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12101.218, "sample_time_ms": 1135.334, "learn_time_ms": 10902.449, "learn_throughput": 366.89, "synch_weights_time_ms": 62.61}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1e132_00001", "date": "2024-08-04_07-37-43", "timestamp": 1722737263, "time_this_iter_s": 9.779595851898193, "time_total_s": 286.79327940940857, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448bd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 286.79327940940857, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.04285714285714, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.24471598068874, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.8975256131961942, "policy_loss": -0.011205065960530192, "vf_loss": 1.9038871408129732, "vf_explained_var": 0.9854666631047925, "kl": 0.016525670872321523, "entropy": 1.1416080096115668, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 3.7916380157289327, "episode_reward_min": -1304.1798038720215, "episode_reward_mean": -582.2598420549691, "episode_len_mean": 122.45, "episode_media": {}, "episodes_timesteps_total": 12245, "policy_reward_min": {"policy_0": -1304.1798038720215}, "policy_reward_max": {"policy_0": 3.7916380157289327}, "policy_reward_mean": {"policy_0": -582.2598420549691}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-666.8204244987179, -240.49270431198798, -1044.1870340079226, -814.5753048084883, -248.95315444482208, -957.4113550442672, -1011.8390003311891, -745.7065179260929, -211.83109849858047, -356.0086742958115, -441.591479683964, -393.5535864851826, -660.0436785350709, -299.84635807311054, -390.74618723214775, -785.2220835128303, -351.6959343538195, -978.8659092634075, -942.7390917866169, 3.7916380157289327, -393.022071914585, -283.7986889039144, -141.28065490794526, -767.1386901793585, -217.6053836532685, -745.499412343008, -105.34859972899584, -1077.7797919865184, -1292.684412657536, -883.5363988549503, -461.88643479125847, -775.5126953584585, -232.2391173091308, -275.0174494174737, -171.29489165424076, -209.1846402933939, -395.9755019564354, -1143.6449353009548, -992.3952875277492, -957.7393897930165, -240.76779156239715, -157.76552946192183, -913.8761368347189, -189.91199297160185, -650.0357391373542, -242.6391037483651, -502.649840446949, -807.078647500748, -282.8431907706675, -220.00477217435136, -664.0037035557713, -950.1919651672198, -1266.7651487556068, -279.74779325694317, -952.6846110267134, -1185.3004885544624, -756.2485368852937, -636.9172457510286, -533.1738942101209, -779.081466324167, -618.2385622614738, -826.1175228218862, -301.83330547761227, -903.367903289644, -1062.2841424346711, -1038.6181697130273, -1054.9604254776052, -1235.1166146179858, -251.56672126876614, -726.0779005416371, -705.2405553679406, -950.119109318214, -147.85290187534608, -790.9181271859171, -1008.5249206733445, -218.33584187547171, -259.6454103757371, -1051.5815864236429, -151.58747934237388, -204.23878803123173, -859.7739934176685, -797.2252693741168, -101.22058571249838, -623.7108193089987, -96.08544353268738, -282.5416949464599, -87.1641105310209, -809.2275564172692, -999.7876345306177, -225.16025075479513, -119.2239533908215, -674.4869491127989, -378.7555418843473, -302.73577106087157, -184.49150894317683, -1304.1798038720215, -175.32744663550258, -57.579271077486325, -892.8044593464904, -475.666167566852], "episode_lengths": [150, 104, 150, 150, 79, 150, 150, 150, 93, 150, 150, 150, 150, 91, 150, 150, 119, 150, 150, 31, 96, 88, 55, 150, 68, 150, 68, 150, 150, 150, 108, 150, 114, 78, 79, 66, 138, 150, 150, 150, 71, 74, 150, 84, 150, 102, 150, 150, 106, 89, 129, 150, 150, 80, 150, 150, 129, 150, 150, 146, 150, 150, 104, 150, 150, 150, 150, 150, 114, 150, 150, 150, 57, 150, 150, 67, 74, 150, 86, 100, 150, 150, 81, 150, 51, 81, 73, 150, 150, 74, 70, 133, 104, 120, 115, 150, 102, 54, 150, 150], "policy_policy_0_reward": [-666.8204244987179, -240.49270431198798, -1044.1870340079226, -814.5753048084883, -248.95315444482208, -957.4113550442672, -1011.8390003311891, -745.7065179260929, -211.83109849858047, -356.0086742958115, -441.591479683964, -393.5535864851826, -660.0436785350709, -299.84635807311054, -390.74618723214775, -785.2220835128303, -351.6959343538195, -978.8659092634075, -942.7390917866169, 3.7916380157289327, -393.022071914585, -283.7986889039144, -141.28065490794526, -767.1386901793585, -217.6053836532685, -745.499412343008, -105.34859972899584, -1077.7797919865184, -1292.684412657536, -883.5363988549503, -461.88643479125847, -775.5126953584585, -232.2391173091308, -275.0174494174737, -171.29489165424076, -209.1846402933939, -395.9755019564354, -1143.6449353009548, -992.3952875277492, -957.7393897930165, -240.76779156239715, -157.76552946192183, -913.8761368347189, -189.91199297160185, -650.0357391373542, -242.6391037483651, -502.649840446949, -807.078647500748, -282.8431907706675, -220.00477217435136, -664.0037035557713, -950.1919651672198, -1266.7651487556068, -279.74779325694317, -952.6846110267134, -1185.3004885544624, -756.2485368852937, -636.9172457510286, -533.1738942101209, -779.081466324167, -618.2385622614738, -826.1175228218862, -301.83330547761227, -903.367903289644, -1062.2841424346711, -1038.6181697130273, -1054.9604254776052, -1235.1166146179858, -251.56672126876614, -726.0779005416371, -705.2405553679406, -950.119109318214, -147.85290187534608, -790.9181271859171, -1008.5249206733445, -218.33584187547171, -259.6454103757371, -1051.5815864236429, -151.58747934237388, -204.23878803123173, -859.7739934176685, -797.2252693741168, -101.22058571249838, -623.7108193089987, -96.08544353268738, -282.5416949464599, -87.1641105310209, -809.2275564172692, -999.7876345306177, -225.16025075479513, -119.2239533908215, -674.4869491127989, -378.7555418843473, -302.73577106087157, -184.49150894317683, -1304.1798038720215, -175.32744663550258, -57.579271077486325, -892.8044593464904, -475.666167566852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556941397506246, "mean_inference_ms": 1.6700611366008906, "mean_action_processing_ms": 0.2764429963499574, "mean_env_wait_ms": 3.3984173552643058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012342453002929688, "StateBufferConnector_ms": 0.008125066757202148, "ViewRequirementAgentConnector_ms": 0.19312000274658203}, "num_episodes": 34, "episode_return_max": 3.7916380157289327, "episode_return_min": -1304.1798038720215, "episode_return_mean": -582.2598420549691, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.0532852221049, "num_env_steps_trained_throughput_per_sec": 381.0532852221049, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11874.84, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11874.766, "sample_time_ms": 1134.205, "learn_time_ms": 10676.667, "learn_throughput": 374.649, "synch_weights_time_ms": 63.063}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1e132_00001", "date": "2024-08-04_07-37-54", "timestamp": 1722737274, "time_this_iter_s": 10.509305953979492, "time_total_s": 297.30258536338806, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bc670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.30258536338806, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.42, "ram_util_percent": 28.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.19879637360572, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7333037350947658, "policy_loss": -0.017951553725773315, "vf_loss": 1.745723125524819, "vf_explained_var": 0.9967978576819102, "kl": 0.018862989678170107, "entropy": 1.2673940096671383, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -39.7925705917647, "episode_reward_min": -1304.1798038720215, "episode_reward_mean": -580.0817152765305, "episode_len_mean": 124.49, "episode_media": {}, "episodes_timesteps_total": 12449, "policy_reward_min": {"policy_0": -1304.1798038720215}, "policy_reward_max": {"policy_0": -39.7925705917647}, "policy_reward_mean": {"policy_0": -580.0817152765305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-775.5126953584585, -232.2391173091308, -275.0174494174737, -171.29489165424076, -209.1846402933939, -395.9755019564354, -1143.6449353009548, -992.3952875277492, -957.7393897930165, -240.76779156239715, -157.76552946192183, -913.8761368347189, -189.91199297160185, -650.0357391373542, -242.6391037483651, -502.649840446949, -807.078647500748, -282.8431907706675, -220.00477217435136, -664.0037035557713, -950.1919651672198, -1266.7651487556068, -279.74779325694317, -952.6846110267134, -1185.3004885544624, -756.2485368852937, -636.9172457510286, -533.1738942101209, -779.081466324167, -618.2385622614738, -826.1175228218862, -301.83330547761227, -903.367903289644, -1062.2841424346711, -1038.6181697130273, -1054.9604254776052, -1235.1166146179858, -251.56672126876614, -726.0779005416371, -705.2405553679406, -950.119109318214, -147.85290187534608, -790.9181271859171, -1008.5249206733445, -218.33584187547171, -259.6454103757371, -1051.5815864236429, -151.58747934237388, -204.23878803123173, -859.7739934176685, -797.2252693741168, -101.22058571249838, -623.7108193089987, -96.08544353268738, -282.5416949464599, -87.1641105310209, -809.2275564172692, -999.7876345306177, -225.16025075479513, -119.2239533908215, -674.4869491127989, -378.7555418843473, -302.73577106087157, -184.49150894317683, -1304.1798038720215, -175.32744663550258, -57.579271077486325, -892.8044593464904, -475.666167566852, -755.6329349541563, -277.1626369182222, -288.9274266307662, -1165.5024864687618, -163.80893510065158, -597.3236052730153, -39.7925705917647, -558.7901528997695, -688.7503277132679, -133.5524734615554, -100.49177939432504, -502.45448385118016, -1141.1387464452582, -618.921530054771, -147.4607880964888, -641.1391438032632, -795.7387146891159, -524.9135844859511, -925.2682462203333, -283.16503442941473, -170.3280867312672, -1297.7528725382574, -169.4577316629417, -806.2698237200485, -163.44633624970967, -958.7294036718216, -356.43451870598113, -748.4594260579826, -1111.4864000436692, -849.109405526106, -708.6961947659524], "episode_lengths": [150, 114, 78, 79, 66, 138, 150, 150, 150, 71, 74, 150, 84, 150, 102, 150, 150, 106, 89, 129, 150, 150, 80, 150, 150, 129, 150, 150, 146, 150, 150, 104, 150, 150, 150, 150, 150, 114, 150, 150, 150, 57, 150, 150, 67, 74, 150, 86, 100, 150, 150, 81, 150, 51, 81, 73, 150, 150, 74, 70, 133, 104, 120, 115, 150, 102, 54, 150, 150, 150, 150, 132, 150, 74, 150, 50, 150, 150, 91, 71, 131, 150, 149, 95, 150, 150, 150, 150, 150, 91, 150, 79, 150, 91, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-775.5126953584585, -232.2391173091308, -275.0174494174737, -171.29489165424076, -209.1846402933939, -395.9755019564354, -1143.6449353009548, -992.3952875277492, -957.7393897930165, -240.76779156239715, -157.76552946192183, -913.8761368347189, -189.91199297160185, -650.0357391373542, -242.6391037483651, -502.649840446949, -807.078647500748, -282.8431907706675, -220.00477217435136, -664.0037035557713, -950.1919651672198, -1266.7651487556068, -279.74779325694317, -952.6846110267134, -1185.3004885544624, -756.2485368852937, -636.9172457510286, -533.1738942101209, -779.081466324167, -618.2385622614738, -826.1175228218862, -301.83330547761227, -903.367903289644, -1062.2841424346711, -1038.6181697130273, -1054.9604254776052, -1235.1166146179858, -251.56672126876614, -726.0779005416371, -705.2405553679406, -950.119109318214, -147.85290187534608, -790.9181271859171, -1008.5249206733445, -218.33584187547171, -259.6454103757371, -1051.5815864236429, -151.58747934237388, -204.23878803123173, -859.7739934176685, -797.2252693741168, -101.22058571249838, -623.7108193089987, -96.08544353268738, -282.5416949464599, -87.1641105310209, -809.2275564172692, -999.7876345306177, -225.16025075479513, -119.2239533908215, -674.4869491127989, -378.7555418843473, -302.73577106087157, -184.49150894317683, -1304.1798038720215, -175.32744663550258, -57.579271077486325, -892.8044593464904, -475.666167566852, -755.6329349541563, -277.1626369182222, -288.9274266307662, -1165.5024864687618, -163.80893510065158, -597.3236052730153, -39.7925705917647, -558.7901528997695, -688.7503277132679, -133.5524734615554, -100.49177939432504, -502.45448385118016, -1141.1387464452582, -618.921530054771, -147.4607880964888, -641.1391438032632, -795.7387146891159, -524.9135844859511, -925.2682462203333, -283.16503442941473, -170.3280867312672, -1297.7528725382574, -169.4577316629417, -806.2698237200485, -163.44633624970967, -958.7294036718216, -356.43451870598113, -748.4594260579826, -1111.4864000436692, -849.109405526106, -708.6961947659524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565531143381709, "mean_inference_ms": 1.6696549438728525, "mean_action_processing_ms": 0.27637381431359104, "mean_env_wait_ms": 3.399118859692449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011819124221801758, "StateBufferConnector_ms": 0.007944107055664062, "ViewRequirementAgentConnector_ms": 0.19159460067749023}, "num_episodes": 31, "episode_return_max": -39.7925705917647, "episode_return_min": -1304.1798038720215, "episode_return_mean": -580.0817152765305, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.4857028853798, "num_env_steps_trained_throughput_per_sec": 316.4857028853798, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 11838.502, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11838.429, "sample_time_ms": 1124.287, "learn_time_ms": 10649.179, "learn_throughput": 375.616, "synch_weights_time_ms": 64.144}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "1e132_00001", "date": "2024-08-04_07-38-06", "timestamp": 1722737286, "time_this_iter_s": 12.650819063186646, "time_total_s": 309.9534044265747, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448beb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.9534044265747, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.73888888888889, "ram_util_percent": 28.116666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.22883023023604, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.6818054172520835, "policy_loss": -0.007642499723685129, "vf_loss": 1.6850016167387367, "vf_explained_var": 0.9866749737411737, "kl": 0.015208845928706674, "entropy": 1.163552060474952, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -27.7282939108165, "episode_reward_min": -1412.3004238474655, "episode_reward_mean": -571.336795316522, "episode_len_mean": 124.64, "episode_media": {}, "episodes_timesteps_total": 12464, "policy_reward_min": {"policy_0": -1412.3004238474655}, "policy_reward_max": {"policy_0": -27.7282939108165}, "policy_reward_mean": {"policy_0": -571.336795316522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301.83330547761227, -903.367903289644, -1062.2841424346711, -1038.6181697130273, -1054.9604254776052, -1235.1166146179858, -251.56672126876614, -726.0779005416371, -705.2405553679406, -950.119109318214, -147.85290187534608, -790.9181271859171, -1008.5249206733445, -218.33584187547171, -259.6454103757371, -1051.5815864236429, -151.58747934237388, -204.23878803123173, -859.7739934176685, -797.2252693741168, -101.22058571249838, -623.7108193089987, -96.08544353268738, -282.5416949464599, -87.1641105310209, -809.2275564172692, -999.7876345306177, -225.16025075479513, -119.2239533908215, -674.4869491127989, -378.7555418843473, -302.73577106087157, -184.49150894317683, -1304.1798038720215, -175.32744663550258, -57.579271077486325, -892.8044593464904, -475.666167566852, -755.6329349541563, -277.1626369182222, -288.9274266307662, -1165.5024864687618, -163.80893510065158, -597.3236052730153, -39.7925705917647, -558.7901528997695, -688.7503277132679, -133.5524734615554, -100.49177939432504, -502.45448385118016, -1141.1387464452582, -618.921530054771, -147.4607880964888, -641.1391438032632, -795.7387146891159, -524.9135844859511, -925.2682462203333, -283.16503442941473, -170.3280867312672, -1297.7528725382574, -169.4577316629417, -806.2698237200485, -163.44633624970967, -958.7294036718216, -356.43451870598113, -748.4594260579826, -1111.4864000436692, -849.109405526106, -708.6961947659524, -1045.7997692669803, -488.6670520429534, -593.1309643433984, -49.45973648103752, -448.338647387836, -453.59837537103004, -66.72242558652039, -27.7282939108165, -173.03083997927612, -667.219486652367, -390.46543507086704, -342.6826028084445, -1137.419715224759, -1075.8508856979568, -525.4687180834612, -1368.7916097035743, -844.4071410905414, -906.1500684552326, -457.5025126038444, -193.9258926258584, -975.0871203639883, -403.89994909015843, -79.05266675970668, -583.023101692438, -1147.4478197071116, -568.6409633587364, -606.7205366961236, -239.2076506943233, -271.38056249538147, -1412.3004238474655, -391.4346286975575], "episode_lengths": [104, 150, 150, 150, 150, 150, 114, 150, 150, 150, 57, 150, 150, 67, 74, 150, 86, 100, 150, 150, 81, 150, 51, 81, 73, 150, 150, 74, 70, 133, 104, 120, 115, 150, 102, 54, 150, 150, 150, 150, 132, 150, 74, 150, 50, 150, 150, 91, 71, 131, 150, 149, 95, 150, 150, 150, 150, 150, 91, 150, 79, 150, 91, 150, 150, 150, 150, 150, 150, 150, 128, 150, 59, 150, 150, 68, 40, 106, 150, 150, 87, 150, 150, 125, 150, 145, 150, 150, 62, 150, 150, 44, 150, 150, 150, 150, 98, 110, 150, 128], "policy_policy_0_reward": [-301.83330547761227, -903.367903289644, -1062.2841424346711, -1038.6181697130273, -1054.9604254776052, -1235.1166146179858, -251.56672126876614, -726.0779005416371, -705.2405553679406, -950.119109318214, -147.85290187534608, -790.9181271859171, -1008.5249206733445, -218.33584187547171, -259.6454103757371, -1051.5815864236429, -151.58747934237388, -204.23878803123173, -859.7739934176685, -797.2252693741168, -101.22058571249838, -623.7108193089987, -96.08544353268738, -282.5416949464599, -87.1641105310209, -809.2275564172692, -999.7876345306177, -225.16025075479513, -119.2239533908215, -674.4869491127989, -378.7555418843473, -302.73577106087157, -184.49150894317683, -1304.1798038720215, -175.32744663550258, -57.579271077486325, -892.8044593464904, -475.666167566852, -755.6329349541563, -277.1626369182222, -288.9274266307662, -1165.5024864687618, -163.80893510065158, -597.3236052730153, -39.7925705917647, -558.7901528997695, -688.7503277132679, -133.5524734615554, -100.49177939432504, -502.45448385118016, -1141.1387464452582, -618.921530054771, -147.4607880964888, -641.1391438032632, -795.7387146891159, -524.9135844859511, -925.2682462203333, -283.16503442941473, -170.3280867312672, -1297.7528725382574, -169.4577316629417, -806.2698237200485, -163.44633624970967, -958.7294036718216, -356.43451870598113, -748.4594260579826, -1111.4864000436692, -849.109405526106, -708.6961947659524, -1045.7997692669803, -488.6670520429534, -593.1309643433984, -49.45973648103752, -448.338647387836, -453.59837537103004, -66.72242558652039, -27.7282939108165, -173.03083997927612, -667.219486652367, -390.46543507086704, -342.6826028084445, -1137.419715224759, -1075.8508856979568, -525.4687180834612, -1368.7916097035743, -844.4071410905414, -906.1500684552326, -457.5025126038444, -193.9258926258584, -975.0871203639883, -403.89994909015843, -79.05266675970668, -583.023101692438, -1147.4478197071116, -568.6409633587364, -606.7205366961236, -239.2076506943233, -271.38056249538147, -1412.3004238474655, -391.4346286975575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568038416049546, "mean_inference_ms": 1.669565841936855, "mean_action_processing_ms": 0.276346158884335, "mean_env_wait_ms": 3.3976614307837743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011693716049194336, "StateBufferConnector_ms": 0.008029460906982422, "ViewRequirementAgentConnector_ms": 0.19453668594360352}, "num_episodes": 31, "episode_return_max": -27.7282939108165, "episode_return_min": -1412.3004238474655, "episode_return_mean": -571.336795316522, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.6011091445792, "num_env_steps_trained_throughput_per_sec": 323.6011091445792, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 11764.222, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11764.15, "sample_time_ms": 1136.632, "learn_time_ms": 10564.639, "learn_throughput": 378.622, "synch_weights_time_ms": 62.084}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "1e132_00001", "date": "2024-08-04_07-38-19", "timestamp": 1722737299, "time_this_iter_s": 12.373147249221802, "time_total_s": 322.3265516757965, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.3265516757965, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.0, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.9082203010718, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.6413229953497648, "policy_loss": -0.009359981292315448, "vf_loss": 1.6449938366810481, "vf_explained_var": 0.981204763179024, "kl": 0.01929360797269813, "entropy": 0.9893777798861265, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -27.7282939108165, "episode_reward_min": -1412.3004238474655, "episode_reward_mean": -569.1012580501708, "episode_len_mean": 127.17, "episode_media": {}, "episodes_timesteps_total": 12717, "policy_reward_min": {"policy_0": -1412.3004238474655}, "policy_reward_max": {"policy_0": -27.7282939108165}, "policy_reward_mean": {"policy_0": -569.1012580501708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.49150894317683, -1304.1798038720215, -175.32744663550258, -57.579271077486325, -892.8044593464904, -475.666167566852, -755.6329349541563, -277.1626369182222, -288.9274266307662, -1165.5024864687618, -163.80893510065158, -597.3236052730153, -39.7925705917647, -558.7901528997695, -688.7503277132679, -133.5524734615554, -100.49177939432504, -502.45448385118016, -1141.1387464452582, -618.921530054771, -147.4607880964888, -641.1391438032632, -795.7387146891159, -524.9135844859511, -925.2682462203333, -283.16503442941473, -170.3280867312672, -1297.7528725382574, -169.4577316629417, -806.2698237200485, -163.44633624970967, -958.7294036718216, -356.43451870598113, -748.4594260579826, -1111.4864000436692, -849.109405526106, -708.6961947659524, -1045.7997692669803, -488.6670520429534, -593.1309643433984, -49.45973648103752, -448.338647387836, -453.59837537103004, -66.72242558652039, -27.7282939108165, -173.03083997927612, -667.219486652367, -390.46543507086704, -342.6826028084445, -1137.419715224759, -1075.8508856979568, -525.4687180834612, -1368.7916097035743, -844.4071410905414, -906.1500684552326, -457.5025126038444, -193.9258926258584, -975.0871203639883, -403.89994909015843, -79.05266675970668, -583.023101692438, -1147.4478197071116, -568.6409633587364, -606.7205366961236, -239.2076506943233, -271.38056249538147, -1412.3004238474655, -391.4346286975575, -1014.5963324747285, -102.04470795591061, -1060.3787616368388, -958.7864727698313, -558.1733340264026, -722.2362033823099, -253.5343985132393, -757.3002031038584, -35.94097352066518, -620.960285361993, -1030.6882063926344, -291.0563690962397, -776.0796632009043, -1012.5858436108425, -1129.8262285387038, -89.25827232230023, -116.10399299526621, -1055.7654298247876, -172.30186175430808, -827.3544060669951, -314.68570917712105, -169.27580588551888, -783.7731965346755, -453.03150855188795, -707.5193686387352, -145.1958474522384, -736.0015782985881, -581.2816137304756, -133.48267560708368, -519.3490706687084, -698.4108194933061, -368.43661004294273], "episode_lengths": [115, 150, 102, 54, 150, 150, 150, 150, 132, 150, 74, 150, 50, 150, 150, 91, 71, 131, 150, 149, 95, 150, 150, 150, 150, 150, 91, 150, 79, 150, 91, 150, 150, 150, 150, 150, 150, 150, 128, 150, 59, 150, 150, 68, 40, 106, 150, 150, 87, 150, 150, 125, 150, 145, 150, 150, 62, 150, 150, 44, 150, 150, 150, 150, 98, 110, 150, 128, 150, 50, 150, 150, 150, 150, 118, 150, 42, 116, 150, 124, 150, 150, 150, 54, 66, 150, 79, 150, 150, 133, 150, 150, 150, 92, 150, 130, 71, 150, 150, 117], "policy_policy_0_reward": [-184.49150894317683, -1304.1798038720215, -175.32744663550258, -57.579271077486325, -892.8044593464904, -475.666167566852, -755.6329349541563, -277.1626369182222, -288.9274266307662, -1165.5024864687618, -163.80893510065158, -597.3236052730153, -39.7925705917647, -558.7901528997695, -688.7503277132679, -133.5524734615554, -100.49177939432504, -502.45448385118016, -1141.1387464452582, -618.921530054771, -147.4607880964888, -641.1391438032632, -795.7387146891159, -524.9135844859511, -925.2682462203333, -283.16503442941473, -170.3280867312672, -1297.7528725382574, -169.4577316629417, -806.2698237200485, -163.44633624970967, -958.7294036718216, -356.43451870598113, -748.4594260579826, -1111.4864000436692, -849.109405526106, -708.6961947659524, -1045.7997692669803, -488.6670520429534, -593.1309643433984, -49.45973648103752, -448.338647387836, -453.59837537103004, -66.72242558652039, -27.7282939108165, -173.03083997927612, -667.219486652367, -390.46543507086704, -342.6826028084445, -1137.419715224759, -1075.8508856979568, -525.4687180834612, -1368.7916097035743, -844.4071410905414, -906.1500684552326, -457.5025126038444, -193.9258926258584, -975.0871203639883, -403.89994909015843, -79.05266675970668, -583.023101692438, -1147.4478197071116, -568.6409633587364, -606.7205366961236, -239.2076506943233, -271.38056249538147, -1412.3004238474655, -391.4346286975575, -1014.5963324747285, -102.04470795591061, -1060.3787616368388, -958.7864727698313, -558.1733340264026, -722.2362033823099, -253.5343985132393, -757.3002031038584, -35.94097352066518, -620.960285361993, -1030.6882063926344, -291.0563690962397, -776.0796632009043, -1012.5858436108425, -1129.8262285387038, -89.25827232230023, -116.10399299526621, -1055.7654298247876, -172.30186175430808, -827.3544060669951, -314.68570917712105, -169.27580588551888, -783.7731965346755, -453.03150855188795, -707.5193686387352, -145.1958474522384, -736.0015782985881, -581.2816137304756, -133.48267560708368, -519.3490706687084, -698.4108194933061, -368.43661004294273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565030010906401, "mean_inference_ms": 1.669433269676347, "mean_action_processing_ms": 0.27604534564764494, "mean_env_wait_ms": 3.3985526420844376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011493444442749023, "StateBufferConnector_ms": 0.007926702499389648, "ViewRequirementAgentConnector_ms": 0.19078397750854492}, "num_episodes": 32, "episode_return_max": -27.7282939108165, "episode_return_min": -1412.3004238474655, "episode_return_mean": -569.1012580501708, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.7454438538646, "num_env_steps_trained_throughput_per_sec": 336.7454438538646, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 11683.429, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11683.358, "sample_time_ms": 1136.088, "learn_time_ms": 10484.093, "learn_throughput": 381.53, "synch_weights_time_ms": 62.384}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "1e132_00001", "date": "2024-08-04_07-38-31", "timestamp": 1722737311, "time_this_iter_s": 11.890295028686523, "time_total_s": 334.21684670448303, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.21684670448303, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.288235294117644, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.56147100130718, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.5177511285990477, "policy_loss": -0.010954646853497252, "vf_loss": 1.5229794511571526, "vf_explained_var": 0.9930306322872638, "kl": 0.019447132986048624, "entropy": 1.0781453801939884, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -27.7282939108165, "episode_reward_min": -1412.3004238474655, "episode_reward_mean": -569.4114426536823, "episode_len_mean": 126.79, "episode_media": {}, "episodes_timesteps_total": 12679, "policy_reward_min": {"policy_0": -1412.3004238474655}, "policy_reward_max": {"policy_0": -27.7282939108165}, "policy_reward_mean": {"policy_0": -569.4114426536823}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-356.43451870598113, -748.4594260579826, -1111.4864000436692, -849.109405526106, -708.6961947659524, -1045.7997692669803, -488.6670520429534, -593.1309643433984, -49.45973648103752, -448.338647387836, -453.59837537103004, -66.72242558652039, -27.7282939108165, -173.03083997927612, -667.219486652367, -390.46543507086704, -342.6826028084445, -1137.419715224759, -1075.8508856979568, -525.4687180834612, -1368.7916097035743, -844.4071410905414, -906.1500684552326, -457.5025126038444, -193.9258926258584, -975.0871203639883, -403.89994909015843, -79.05266675970668, -583.023101692438, -1147.4478197071116, -568.6409633587364, -606.7205366961236, -239.2076506943233, -271.38056249538147, -1412.3004238474655, -391.4346286975575, -1014.5963324747285, -102.04470795591061, -1060.3787616368388, -958.7864727698313, -558.1733340264026, -722.2362033823099, -253.5343985132393, -757.3002031038584, -35.94097352066518, -620.960285361993, -1030.6882063926344, -291.0563690962397, -776.0796632009043, -1012.5858436108425, -1129.8262285387038, -89.25827232230023, -116.10399299526621, -1055.7654298247876, -172.30186175430808, -827.3544060669951, -314.68570917712105, -169.27580588551888, -783.7731965346755, -453.03150855188795, -707.5193686387352, -145.1958474522384, -736.0015782985881, -581.2816137304756, -133.48267560708368, -519.3490706687084, -698.4108194933061, -368.43661004294273, -863.7145131094082, -267.12695731282366, -792.914630133644, -603.775742501197, -1176.7452613110045, -486.5407341120385, -936.8592649325927, -316.5991687476956, -264.02251083384266, -406.46403086616385, -242.92140043862102, -982.4981213801074, -436.338262782957, -187.75653797799026, -725.6181901207601, -1122.7924451854012, -223.97286696033987, -46.44300472756856, -139.15627853329846, -912.1393355719844, -883.9215785899152, -198.66950580615136, -252.1201777683739, -142.29311902961973, -215.5203448443485, -360.63732064766094, -139.5892384959962, -837.6362396753664, -849.0308015536701, -1068.4606713460428, -249.62851091881427, -705.0802076333559], "episode_lengths": [150, 150, 150, 150, 150, 150, 128, 150, 59, 150, 150, 68, 40, 106, 150, 150, 87, 150, 150, 125, 150, 145, 150, 150, 62, 150, 150, 44, 150, 150, 150, 150, 98, 110, 150, 128, 150, 50, 150, 150, 150, 150, 118, 150, 42, 116, 150, 124, 150, 150, 150, 54, 66, 150, 79, 150, 150, 133, 150, 150, 150, 92, 150, 130, 71, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 109, 100, 140, 112, 150, 142, 91, 150, 150, 99, 68, 55, 150, 150, 78, 103, 78, 91, 100, 71, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-356.43451870598113, -748.4594260579826, -1111.4864000436692, -849.109405526106, -708.6961947659524, -1045.7997692669803, -488.6670520429534, -593.1309643433984, -49.45973648103752, -448.338647387836, -453.59837537103004, -66.72242558652039, -27.7282939108165, -173.03083997927612, -667.219486652367, -390.46543507086704, -342.6826028084445, -1137.419715224759, -1075.8508856979568, -525.4687180834612, -1368.7916097035743, -844.4071410905414, -906.1500684552326, -457.5025126038444, -193.9258926258584, -975.0871203639883, -403.89994909015843, -79.05266675970668, -583.023101692438, -1147.4478197071116, -568.6409633587364, -606.7205366961236, -239.2076506943233, -271.38056249538147, -1412.3004238474655, -391.4346286975575, -1014.5963324747285, -102.04470795591061, -1060.3787616368388, -958.7864727698313, -558.1733340264026, -722.2362033823099, -253.5343985132393, -757.3002031038584, -35.94097352066518, -620.960285361993, -1030.6882063926344, -291.0563690962397, -776.0796632009043, -1012.5858436108425, -1129.8262285387038, -89.25827232230023, -116.10399299526621, -1055.7654298247876, -172.30186175430808, -827.3544060669951, -314.68570917712105, -169.27580588551888, -783.7731965346755, -453.03150855188795, -707.5193686387352, -145.1958474522384, -736.0015782985881, -581.2816137304756, -133.48267560708368, -519.3490706687084, -698.4108194933061, -368.43661004294273, -863.7145131094082, -267.12695731282366, -792.914630133644, -603.775742501197, -1176.7452613110045, -486.5407341120385, -936.8592649325927, -316.5991687476956, -264.02251083384266, -406.46403086616385, -242.92140043862102, -982.4981213801074, -436.338262782957, -187.75653797799026, -725.6181901207601, -1122.7924451854012, -223.97286696033987, -46.44300472756856, -139.15627853329846, -912.1393355719844, -883.9215785899152, -198.66950580615136, -252.1201777683739, -142.29311902961973, -215.5203448443485, -360.63732064766094, -139.5892384959962, -837.6362396753664, -849.0308015536701, -1068.4606713460428, -249.62851091881427, -705.0802076333559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564952963280237, "mean_inference_ms": 1.6692230189711494, "mean_action_processing_ms": 0.2758575620015408, "mean_env_wait_ms": 3.395253561203092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011646747589111328, "StateBufferConnector_ms": 0.007992029190063477, "ViewRequirementAgentConnector_ms": 0.19302153587341309}, "num_episodes": 32, "episode_return_max": -27.7282939108165, "episode_return_min": -1412.3004238474655, "episode_return_mean": -569.4114426536823, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.3416592880862, "num_env_steps_trained_throughput_per_sec": 311.3416592880862, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 11983.257, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11983.187, "sample_time_ms": 1133.741, "learn_time_ms": 10785.295, "learn_throughput": 370.875, "synch_weights_time_ms": 63.36}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "1e132_00001", "date": "2024-08-04_07-38-44", "timestamp": 1722737324, "time_this_iter_s": 12.856602907180786, "time_total_s": 347.0734496116638, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996513d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.0734496116638, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.72222222222222, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.37012328306835, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.933794321740667, "policy_loss": -0.011858694988768547, "vf_loss": 1.9407506346081693, "vf_explained_var": 0.9832446880017718, "kl": 0.016708207527274983, "entropy": 1.100780750438571, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -35.94097352066518, "episode_reward_min": -1412.3004238474655, "episode_reward_mean": -573.3194656648827, "episode_len_mean": 125.32, "episode_media": {}, "episodes_timesteps_total": 12532, "policy_reward_min": {"policy_0": -1412.3004238474655}, "policy_reward_max": {"policy_0": -35.94097352066518}, "policy_reward_mean": {"policy_0": -573.3194656648827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271.38056249538147, -1412.3004238474655, -391.4346286975575, -1014.5963324747285, -102.04470795591061, -1060.3787616368388, -958.7864727698313, -558.1733340264026, -722.2362033823099, -253.5343985132393, -757.3002031038584, -35.94097352066518, -620.960285361993, -1030.6882063926344, -291.0563690962397, -776.0796632009043, -1012.5858436108425, -1129.8262285387038, -89.25827232230023, -116.10399299526621, -1055.7654298247876, -172.30186175430808, -827.3544060669951, -314.68570917712105, -169.27580588551888, -783.7731965346755, -453.03150855188795, -707.5193686387352, -145.1958474522384, -736.0015782985881, -581.2816137304756, -133.48267560708368, -519.3490706687084, -698.4108194933061, -368.43661004294273, -863.7145131094082, -267.12695731282366, -792.914630133644, -603.775742501197, -1176.7452613110045, -486.5407341120385, -936.8592649325927, -316.5991687476956, -264.02251083384266, -406.46403086616385, -242.92140043862102, -982.4981213801074, -436.338262782957, -187.75653797799026, -725.6181901207601, -1122.7924451854012, -223.97286696033987, -46.44300472756856, -139.15627853329846, -912.1393355719844, -883.9215785899152, -198.66950580615136, -252.1201777683739, -142.29311902961973, -215.5203448443485, -360.63732064766094, -139.5892384959962, -837.6362396753664, -849.0308015536701, -1068.4606713460428, -249.62851091881427, -705.0802076333559, -585.299525925424, -832.3632088786528, -841.0514694792032, -191.2331066387413, -204.94069106313563, -200.7998135622256, -171.40182654871188, -672.3978421220139, -539.364064685743, -992.5770090174078, -411.96961828398577, -433.80401196288796, -395.4078816045333, -102.22801456353815, -1246.89983958955, -285.8633431545444, -587.6508472505137, -738.6505432635598, -45.540857173791345, -302.82248492900095, -138.348116211792, -762.0328119772155, -1023.8645730328927, -1008.4262931052077, -1263.8756461825742, -445.97391305476907, -987.5748303669928, -55.78220524590963, -1239.1730773485945, -877.4668203982891, -852.4052767547814, -412.359587705334, -1174.8790758875562], "episode_lengths": [110, 150, 128, 150, 50, 150, 150, 150, 150, 118, 150, 42, 116, 150, 124, 150, 150, 150, 54, 66, 150, 79, 150, 150, 133, 150, 150, 150, 92, 150, 130, 71, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 109, 100, 140, 112, 150, 142, 91, 150, 150, 99, 68, 55, 150, 150, 78, 103, 78, 91, 100, 71, 150, 150, 150, 150, 150, 150, 150, 150, 79, 93, 66, 78, 150, 150, 150, 150, 119, 117, 57, 150, 113, 150, 150, 50, 83, 69, 150, 150, 150, 150, 150, 150, 50, 150, 150, 143, 148, 150], "policy_policy_0_reward": [-271.38056249538147, -1412.3004238474655, -391.4346286975575, -1014.5963324747285, -102.04470795591061, -1060.3787616368388, -958.7864727698313, -558.1733340264026, -722.2362033823099, -253.5343985132393, -757.3002031038584, -35.94097352066518, -620.960285361993, -1030.6882063926344, -291.0563690962397, -776.0796632009043, -1012.5858436108425, -1129.8262285387038, -89.25827232230023, -116.10399299526621, -1055.7654298247876, -172.30186175430808, -827.3544060669951, -314.68570917712105, -169.27580588551888, -783.7731965346755, -453.03150855188795, -707.5193686387352, -145.1958474522384, -736.0015782985881, -581.2816137304756, -133.48267560708368, -519.3490706687084, -698.4108194933061, -368.43661004294273, -863.7145131094082, -267.12695731282366, -792.914630133644, -603.775742501197, -1176.7452613110045, -486.5407341120385, -936.8592649325927, -316.5991687476956, -264.02251083384266, -406.46403086616385, -242.92140043862102, -982.4981213801074, -436.338262782957, -187.75653797799026, -725.6181901207601, -1122.7924451854012, -223.97286696033987, -46.44300472756856, -139.15627853329846, -912.1393355719844, -883.9215785899152, -198.66950580615136, -252.1201777683739, -142.29311902961973, -215.5203448443485, -360.63732064766094, -139.5892384959962, -837.6362396753664, -849.0308015536701, -1068.4606713460428, -249.62851091881427, -705.0802076333559, -585.299525925424, -832.3632088786528, -841.0514694792032, -191.2331066387413, -204.94069106313563, -200.7998135622256, -171.40182654871188, -672.3978421220139, -539.364064685743, -992.5770090174078, -411.96961828398577, -433.80401196288796, -395.4078816045333, -102.22801456353815, -1246.89983958955, -285.8633431545444, -587.6508472505137, -738.6505432635598, -45.540857173791345, -302.82248492900095, -138.348116211792, -762.0328119772155, -1023.8645730328927, -1008.4262931052077, -1263.8756461825742, -445.97391305476907, -987.5748303669928, -55.78220524590963, -1239.1730773485945, -877.4668203982891, -852.4052767547814, -412.359587705334, -1174.8790758875562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560291228390366, "mean_inference_ms": 1.6687779757747034, "mean_action_processing_ms": 0.2758414030391119, "mean_env_wait_ms": 3.392874912795748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011534452438354492, "StateBufferConnector_ms": 0.007955551147460938, "ViewRequirementAgentConnector_ms": 0.1891160011291504}, "num_episodes": 33, "episode_return_max": -35.94097352066518, "episode_return_min": -1412.3004238474655, "episode_return_mean": -573.3194656648827, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.5031765322659, "num_env_steps_trained_throughput_per_sec": 310.5031765322659, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12191.59, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12191.519, "sample_time_ms": 1137.499, "learn_time_ms": 10989.884, "learn_throughput": 363.971, "synch_weights_time_ms": 63.342}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "1e132_00001", "date": "2024-08-04_07-38-57", "timestamp": 1722737337, "time_this_iter_s": 12.89586353302002, "time_total_s": 359.96931314468384, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 359.96931314468384, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.373684210526314, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.7633687655131, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.5122813468178113, "policy_loss": -0.015156289197329897, "vf_loss": 1.5227141060555975, "vf_explained_var": 0.9903694842631618, "kl": 0.016136398564412992, "entropy": 1.1739271197468042, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -12.679313309202529, "episode_reward_min": -1263.8756461825742, "episode_reward_mean": -566.046119626971, "episode_len_mean": 124.1, "episode_media": {}, "episodes_timesteps_total": 12410, "policy_reward_min": {"policy_0": -1263.8756461825742}, "policy_reward_max": {"policy_0": -12.679313309202529}, "policy_reward_mean": {"policy_0": -566.046119626971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-133.48267560708368, -519.3490706687084, -698.4108194933061, -368.43661004294273, -863.7145131094082, -267.12695731282366, -792.914630133644, -603.775742501197, -1176.7452613110045, -486.5407341120385, -936.8592649325927, -316.5991687476956, -264.02251083384266, -406.46403086616385, -242.92140043862102, -982.4981213801074, -436.338262782957, -187.75653797799026, -725.6181901207601, -1122.7924451854012, -223.97286696033987, -46.44300472756856, -139.15627853329846, -912.1393355719844, -883.9215785899152, -198.66950580615136, -252.1201777683739, -142.29311902961973, -215.5203448443485, -360.63732064766094, -139.5892384959962, -837.6362396753664, -849.0308015536701, -1068.4606713460428, -249.62851091881427, -705.0802076333559, -585.299525925424, -832.3632088786528, -841.0514694792032, -191.2331066387413, -204.94069106313563, -200.7998135622256, -171.40182654871188, -672.3978421220139, -539.364064685743, -992.5770090174078, -411.96961828398577, -433.80401196288796, -395.4078816045333, -102.22801456353815, -1246.89983958955, -285.8633431545444, -587.6508472505137, -738.6505432635598, -45.540857173791345, -302.82248492900095, -138.348116211792, -762.0328119772155, -1023.8645730328927, -1008.4262931052077, -1263.8756461825742, -445.97391305476907, -987.5748303669928, -55.78220524590963, -1239.1730773485945, -877.4668203982891, -852.4052767547814, -412.359587705334, -1174.8790758875562, -517.0536152994358, -855.7942638921661, -540.9366907608475, -284.72171436491226, -501.239548393459, -963.6466338361136, -712.8927003721111, -951.978457367792, -120.74984552491921, -523.8109462217561, -238.39322674296153, -124.46805464663993, -1024.4848694194661, -76.44123933867182, -1223.7992023586862, -692.8876266141266, -763.6920075472926, -981.661111974151, -60.877447843659404, -63.82087170942957, -12.679313309202529, -377.19648512204043, -803.4457191577297, -153.30348399389533, -789.7817336420745, -54.27247512248236, -930.7342622824365, -833.9738935416653, -654.4121734333626, -901.0549524356715, -1089.3130197980736], "episode_lengths": [71, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 109, 100, 140, 112, 150, 142, 91, 150, 150, 99, 68, 55, 150, 150, 78, 103, 78, 91, 100, 71, 150, 150, 150, 150, 150, 150, 150, 150, 79, 93, 66, 78, 150, 150, 150, 150, 119, 117, 57, 150, 113, 150, 150, 50, 83, 69, 150, 150, 150, 150, 150, 150, 50, 150, 150, 143, 148, 150, 150, 150, 150, 82, 150, 150, 150, 150, 78, 105, 150, 75, 150, 57, 150, 150, 150, 150, 53, 66, 42, 119, 150, 89, 150, 54, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-133.48267560708368, -519.3490706687084, -698.4108194933061, -368.43661004294273, -863.7145131094082, -267.12695731282366, -792.914630133644, -603.775742501197, -1176.7452613110045, -486.5407341120385, -936.8592649325927, -316.5991687476956, -264.02251083384266, -406.46403086616385, -242.92140043862102, -982.4981213801074, -436.338262782957, -187.75653797799026, -725.6181901207601, -1122.7924451854012, -223.97286696033987, -46.44300472756856, -139.15627853329846, -912.1393355719844, -883.9215785899152, -198.66950580615136, -252.1201777683739, -142.29311902961973, -215.5203448443485, -360.63732064766094, -139.5892384959962, -837.6362396753664, -849.0308015536701, -1068.4606713460428, -249.62851091881427, -705.0802076333559, -585.299525925424, -832.3632088786528, -841.0514694792032, -191.2331066387413, -204.94069106313563, -200.7998135622256, -171.40182654871188, -672.3978421220139, -539.364064685743, -992.5770090174078, -411.96961828398577, -433.80401196288796, -395.4078816045333, -102.22801456353815, -1246.89983958955, -285.8633431545444, -587.6508472505137, -738.6505432635598, -45.540857173791345, -302.82248492900095, -138.348116211792, -762.0328119772155, -1023.8645730328927, -1008.4262931052077, -1263.8756461825742, -445.97391305476907, -987.5748303669928, -55.78220524590963, -1239.1730773485945, -877.4668203982891, -852.4052767547814, -412.359587705334, -1174.8790758875562, -517.0536152994358, -855.7942638921661, -540.9366907608475, -284.72171436491226, -501.239548393459, -963.6466338361136, -712.8927003721111, -951.978457367792, -120.74984552491921, -523.8109462217561, -238.39322674296153, -124.46805464663993, -1024.4848694194661, -76.44123933867182, -1223.7992023586862, -692.8876266141266, -763.6920075472926, -981.661111974151, -60.877447843659404, -63.82087170942957, -12.679313309202529, -377.19648512204043, -803.4457191577297, -153.30348399389533, -789.7817336420745, -54.27247512248236, -930.7342622824365, -833.9738935416653, -654.4121734333626, -901.0549524356715, -1089.3130197980736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560278890987553, "mean_inference_ms": 1.6691117010584748, "mean_action_processing_ms": 0.2757250859421027, "mean_env_wait_ms": 3.391582439284447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011762142181396484, "StateBufferConnector_ms": 0.008260726928710938, "ViewRequirementAgentConnector_ms": 0.18951725959777832}, "num_episodes": 31, "episode_return_max": -12.679313309202529, "episode_return_min": -1263.8756461825742, "episode_return_mean": -566.046119626971, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4792385917269, "num_env_steps_trained_throughput_per_sec": 307.4792385917269, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12191.907, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12191.835, "sample_time_ms": 1147.319, "learn_time_ms": 10981.099, "learn_throughput": 364.262, "synch_weights_time_ms": 62.615}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "1e132_00001", "date": "2024-08-04_07-39-10", "timestamp": 1722737350, "time_this_iter_s": 13.023526668548584, "time_total_s": 372.9928398132324, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bd630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.9928398132324, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.972222222222218, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.72190551559132, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.6841741571823756, "policy_loss": -0.00959782554806831, "vf_loss": 1.6882328743115067, "vf_explained_var": 0.987947256801029, "kl": 0.018884163295357848, "entropy": 1.2614688273519277, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -12.679313309202529, "episode_reward_min": -1372.1935816771193, "episode_reward_mean": -580.4021988316169, "episode_len_mean": 122.29, "episode_media": {}, "episodes_timesteps_total": 12229, "policy_reward_min": {"policy_0": -1372.1935816771193}, "policy_reward_max": {"policy_0": -12.679313309202529}, "policy_reward_mean": {"policy_0": -580.4021988316169}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-705.0802076333559, -585.299525925424, -832.3632088786528, -841.0514694792032, -191.2331066387413, -204.94069106313563, -200.7998135622256, -171.40182654871188, -672.3978421220139, -539.364064685743, -992.5770090174078, -411.96961828398577, -433.80401196288796, -395.4078816045333, -102.22801456353815, -1246.89983958955, -285.8633431545444, -587.6508472505137, -738.6505432635598, -45.540857173791345, -302.82248492900095, -138.348116211792, -762.0328119772155, -1023.8645730328927, -1008.4262931052077, -1263.8756461825742, -445.97391305476907, -987.5748303669928, -55.78220524590963, -1239.1730773485945, -877.4668203982891, -852.4052767547814, -412.359587705334, -1174.8790758875562, -517.0536152994358, -855.7942638921661, -540.9366907608475, -284.72171436491226, -501.239548393459, -963.6466338361136, -712.8927003721111, -951.978457367792, -120.74984552491921, -523.8109462217561, -238.39322674296153, -124.46805464663993, -1024.4848694194661, -76.44123933867182, -1223.7992023586862, -692.8876266141266, -763.6920075472926, -981.661111974151, -60.877447843659404, -63.82087170942957, -12.679313309202529, -377.19648512204043, -803.4457191577297, -153.30348399389533, -789.7817336420745, -54.27247512248236, -930.7342622824365, -833.9738935416653, -654.4121734333626, -901.0549524356715, -1089.3130197980736, -906.8423131599582, -251.26743835861964, -722.817547986509, -1105.0257029325755, -524.0698565014104, -144.59680707392152, -708.0005265534713, -1372.1935816771193, -51.68425245268439, -869.7099005050638, -35.08786478413726, -911.1410494203449, -865.5267261882747, -418.4136007296812, -509.01589134364804, -1026.8542698668382, -92.93302827158837, -808.7230018909337, -528.9954465785908, -271.1107913123651, -123.03418794395932, -296.41741234458937, -784.7273720531404, -863.0935223111106, -261.1493953706703, -1199.4645341252235, -112.2077983550332, -276.3184402637494, -568.111944455383, -21.792102962517948, -161.7286504964556, -1127.6990834882592, -1006.7266563967921, -167.8291664641031, -392.88399787331036], "episode_lengths": [150, 150, 150, 150, 79, 93, 66, 78, 150, 150, 150, 150, 119, 117, 57, 150, 113, 150, 150, 50, 83, 69, 150, 150, 150, 150, 150, 150, 50, 150, 150, 143, 148, 150, 150, 150, 150, 82, 150, 150, 150, 150, 78, 105, 150, 75, 150, 57, 150, 150, 150, 150, 53, 66, 42, 119, 150, 89, 150, 54, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 52, 150, 150, 53, 150, 53, 150, 150, 150, 150, 150, 81, 150, 121, 94, 83, 95, 150, 150, 76, 150, 76, 150, 123, 42, 76, 150, 150, 78, 96], "policy_policy_0_reward": [-705.0802076333559, -585.299525925424, -832.3632088786528, -841.0514694792032, -191.2331066387413, -204.94069106313563, -200.7998135622256, -171.40182654871188, -672.3978421220139, -539.364064685743, -992.5770090174078, -411.96961828398577, -433.80401196288796, -395.4078816045333, -102.22801456353815, -1246.89983958955, -285.8633431545444, -587.6508472505137, -738.6505432635598, -45.540857173791345, -302.82248492900095, -138.348116211792, -762.0328119772155, -1023.8645730328927, -1008.4262931052077, -1263.8756461825742, -445.97391305476907, -987.5748303669928, -55.78220524590963, -1239.1730773485945, -877.4668203982891, -852.4052767547814, -412.359587705334, -1174.8790758875562, -517.0536152994358, -855.7942638921661, -540.9366907608475, -284.72171436491226, -501.239548393459, -963.6466338361136, -712.8927003721111, -951.978457367792, -120.74984552491921, -523.8109462217561, -238.39322674296153, -124.46805464663993, -1024.4848694194661, -76.44123933867182, -1223.7992023586862, -692.8876266141266, -763.6920075472926, -981.661111974151, -60.877447843659404, -63.82087170942957, -12.679313309202529, -377.19648512204043, -803.4457191577297, -153.30348399389533, -789.7817336420745, -54.27247512248236, -930.7342622824365, -833.9738935416653, -654.4121734333626, -901.0549524356715, -1089.3130197980736, -906.8423131599582, -251.26743835861964, -722.817547986509, -1105.0257029325755, -524.0698565014104, -144.59680707392152, -708.0005265534713, -1372.1935816771193, -51.68425245268439, -869.7099005050638, -35.08786478413726, -911.1410494203449, -865.5267261882747, -418.4136007296812, -509.01589134364804, -1026.8542698668382, -92.93302827158837, -808.7230018909337, -528.9954465785908, -271.1107913123651, -123.03418794395932, -296.41741234458937, -784.7273720531404, -863.0935223111106, -261.1493953706703, -1199.4645341252235, -112.2077983550332, -276.3184402637494, -568.111944455383, -21.792102962517948, -161.7286504964556, -1127.6990834882592, -1006.7266563967921, -167.8291664641031, -392.88399787331036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559589056910956, "mean_inference_ms": 1.6941869721687595, "mean_action_processing_ms": 0.27571568190258156, "mean_env_wait_ms": 3.391666705559247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011949300765991211, "StateBufferConnector_ms": 0.00821375846862793, "ViewRequirementAgentConnector_ms": 0.1891469955444336}, "num_episodes": 35, "episode_return_max": -12.679313309202529, "episode_return_min": -1372.1935816771193, "episode_return_mean": -580.4021988316169, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.9617296871996, "num_env_steps_trained_throughput_per_sec": 303.9617296871996, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12191.113, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12191.041, "sample_time_ms": 1184.903, "learn_time_ms": 10942.41, "learn_throughput": 365.55, "synch_weights_time_ms": 62.929}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "1e132_00001", "date": "2024-08-04_07-39-23", "timestamp": 1722737363, "time_this_iter_s": 13.172757387161255, "time_total_s": 386.1655972003937, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.1655972003937, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.921052631578945, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 195.62899213234584, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.58781490350763, "policy_loss": -0.0077857825827474395, "vf_loss": 1.5907340900351603, "vf_explained_var": 0.9895276049772899, "kl": 0.016661522200471797, "entropy": 1.3186148947725693, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -12.679313309202529, "episode_reward_min": -1372.1935816771193, "episode_reward_mean": -612.3060612115165, "episode_len_mean": 124.43, "episode_media": {}, "episodes_timesteps_total": 12443, "policy_reward_min": {"policy_0": -1372.1935816771193}, "policy_reward_max": {"policy_0": -12.679313309202529}, "policy_reward_mean": {"policy_0": -612.3060612115165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1239.1730773485945, -877.4668203982891, -852.4052767547814, -412.359587705334, -1174.8790758875562, -517.0536152994358, -855.7942638921661, -540.9366907608475, -284.72171436491226, -501.239548393459, -963.6466338361136, -712.8927003721111, -951.978457367792, -120.74984552491921, -523.8109462217561, -238.39322674296153, -124.46805464663993, -1024.4848694194661, -76.44123933867182, -1223.7992023586862, -692.8876266141266, -763.6920075472926, -981.661111974151, -60.877447843659404, -63.82087170942957, -12.679313309202529, -377.19648512204043, -803.4457191577297, -153.30348399389533, -789.7817336420745, -54.27247512248236, -930.7342622824365, -833.9738935416653, -654.4121734333626, -901.0549524356715, -1089.3130197980736, -906.8423131599582, -251.26743835861964, -722.817547986509, -1105.0257029325755, -524.0698565014104, -144.59680707392152, -708.0005265534713, -1372.1935816771193, -51.68425245268439, -869.7099005050638, -35.08786478413726, -911.1410494203449, -865.5267261882747, -418.4136007296812, -509.01589134364804, -1026.8542698668382, -92.93302827158837, -808.7230018909337, -528.9954465785908, -271.1107913123651, -123.03418794395932, -296.41741234458937, -784.7273720531404, -863.0935223111106, -261.1493953706703, -1199.4645341252235, -112.2077983550332, -276.3184402637494, -568.111944455383, -21.792102962517948, -161.7286504964556, -1127.6990834882592, -1006.7266563967921, -167.8291664641031, -392.88399787331036, -337.5893493807394, -164.02224519727068, -230.86501262573023, -938.1044960356783, -1124.7207053148693, -628.2769557817596, -22.453926713757532, -315.3147914151819, -526.9556559074243, -505.4681624782526, -115.40704517760354, -1022.0311465743505, -456.0840075386357, -1021.9903670039563, -185.08085701792612, -935.4864957985618, -1001.5644100148187, -214.19177402254508, -1093.9722927242738, -961.6000896181218, -1139.5132102214536, -317.31854263870343, -960.0131767583979, -1129.503919749085, -125.32661933972147, -959.3791378231379, -701.8189649269381, -1134.433680608739, -1095.1237960902056], "episode_lengths": [150, 150, 143, 148, 150, 150, 150, 150, 82, 150, 150, 150, 150, 78, 105, 150, 75, 150, 57, 150, 150, 150, 150, 53, 66, 42, 119, 150, 89, 150, 54, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 52, 150, 150, 53, 150, 53, 150, 150, 150, 150, 150, 81, 150, 121, 94, 83, 95, 150, 150, 76, 150, 76, 150, 123, 42, 76, 150, 150, 78, 96, 108, 75, 150, 150, 150, 150, 46, 105, 139, 150, 49, 150, 150, 150, 93, 150, 150, 69, 150, 150, 150, 150, 150, 150, 76, 150, 128, 150, 150], "policy_policy_0_reward": [-1239.1730773485945, -877.4668203982891, -852.4052767547814, -412.359587705334, -1174.8790758875562, -517.0536152994358, -855.7942638921661, -540.9366907608475, -284.72171436491226, -501.239548393459, -963.6466338361136, -712.8927003721111, -951.978457367792, -120.74984552491921, -523.8109462217561, -238.39322674296153, -124.46805464663993, -1024.4848694194661, -76.44123933867182, -1223.7992023586862, -692.8876266141266, -763.6920075472926, -981.661111974151, -60.877447843659404, -63.82087170942957, -12.679313309202529, -377.19648512204043, -803.4457191577297, -153.30348399389533, -789.7817336420745, -54.27247512248236, -930.7342622824365, -833.9738935416653, -654.4121734333626, -901.0549524356715, -1089.3130197980736, -906.8423131599582, -251.26743835861964, -722.817547986509, -1105.0257029325755, -524.0698565014104, -144.59680707392152, -708.0005265534713, -1372.1935816771193, -51.68425245268439, -869.7099005050638, -35.08786478413726, -911.1410494203449, -865.5267261882747, -418.4136007296812, -509.01589134364804, -1026.8542698668382, -92.93302827158837, -808.7230018909337, -528.9954465785908, -271.1107913123651, -123.03418794395932, -296.41741234458937, -784.7273720531404, -863.0935223111106, -261.1493953706703, -1199.4645341252235, -112.2077983550332, -276.3184402637494, -568.111944455383, -21.792102962517948, -161.7286504964556, -1127.6990834882592, -1006.7266563967921, -167.8291664641031, -392.88399787331036, -337.5893493807394, -164.02224519727068, -230.86501262573023, -938.1044960356783, -1124.7207053148693, -628.2769557817596, -22.453926713757532, -315.3147914151819, -526.9556559074243, -505.4681624782526, -115.40704517760354, -1022.0311465743505, -456.0840075386357, -1021.9903670039563, -185.08085701792612, -935.4864957985618, -1001.5644100148187, -214.19177402254508, -1093.9722927242738, -961.6000896181218, -1139.5132102214536, -317.31854263870343, -960.0131767583979, -1129.503919749085, -125.32661933972147, -959.3791378231379, -701.8189649269381, -1134.433680608739, -1095.1237960902056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559362536382142, "mean_inference_ms": 1.7139188437987471, "mean_action_processing_ms": 0.27553309434476664, "mean_env_wait_ms": 3.3905363912978883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012124300003051758, "StateBufferConnector_ms": 0.008253097534179688, "ViewRequirementAgentConnector_ms": 0.19137001037597656}, "num_episodes": 29, "episode_return_max": -12.679313309202529, "episode_return_min": -1372.1935816771193, "episode_return_mean": -612.3060612115165, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.68429781997213, "num_env_steps_trained_throughput_per_sec": 308.68429781997213, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12199.693, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12199.617, "sample_time_ms": 1186.256, "learn_time_ms": 10949.19, "learn_throughput": 365.324, "synch_weights_time_ms": 63.367}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "1e132_00001", "date": "2024-08-04_07-39-36", "timestamp": 1722737376, "time_this_iter_s": 12.972877264022827, "time_total_s": 399.1384744644165, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d99680f2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 399.1384744644165, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.694736842105264, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.95197424093882, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.8790782568976283, "policy_loss": -0.00703146499581635, "vf_loss": 1.8810611526171366, "vf_explained_var": 0.9927844991286595, "kl": 0.017209191079382437, "entropy": 1.1419208047290643, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -21.792102962517948, "episode_reward_min": -1372.1935816771193, "episode_reward_mean": -558.8004555711273, "episode_len_mean": 120.75, "episode_media": {}, "episodes_timesteps_total": 12075, "policy_reward_min": {"policy_0": -1372.1935816771193}, "policy_reward_max": {"policy_0": -21.792102962517948}, "policy_reward_mean": {"policy_0": -558.8004555711273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-833.9738935416653, -654.4121734333626, -901.0549524356715, -1089.3130197980736, -906.8423131599582, -251.26743835861964, -722.817547986509, -1105.0257029325755, -524.0698565014104, -144.59680707392152, -708.0005265534713, -1372.1935816771193, -51.68425245268439, -869.7099005050638, -35.08786478413726, -911.1410494203449, -865.5267261882747, -418.4136007296812, -509.01589134364804, -1026.8542698668382, -92.93302827158837, -808.7230018909337, -528.9954465785908, -271.1107913123651, -123.03418794395932, -296.41741234458937, -784.7273720531404, -863.0935223111106, -261.1493953706703, -1199.4645341252235, -112.2077983550332, -276.3184402637494, -568.111944455383, -21.792102962517948, -161.7286504964556, -1127.6990834882592, -1006.7266563967921, -167.8291664641031, -392.88399787331036, -337.5893493807394, -164.02224519727068, -230.86501262573023, -938.1044960356783, -1124.7207053148693, -628.2769557817596, -22.453926713757532, -315.3147914151819, -526.9556559074243, -505.4681624782526, -115.40704517760354, -1022.0311465743505, -456.0840075386357, -1021.9903670039563, -185.08085701792612, -935.4864957985618, -1001.5644100148187, -214.19177402254508, -1093.9722927242738, -961.6000896181218, -1139.5132102214536, -317.31854263870343, -960.0131767583979, -1129.503919749085, -125.32661933972147, -959.3791378231379, -701.8189649269381, -1134.433680608739, -1095.1237960902056, -539.1544913559826, -361.4483293678643, -1211.5715117568254, -150.98249213435824, -962.0546731222893, -277.66613672079643, -619.9707905387065, -1235.9146830051034, -949.0969868645138, -376.2961832568412, -216.26458199035392, -344.86401159747726, -227.49652321587254, -97.53847777555991, -76.36659793348, -36.83889199378781, -784.8111557882096, -195.1813751786286, -1009.7754839522438, -66.48954080820309, -137.88421109446554, -449.55441201339, -764.1697137838144, -336.4696069301827, -131.23718506491107, -31.93754510010519, -463.5193579033878, -30.71361955990655, -292.82480469883814, -442.42802888701686, -512.3309937075289, -217.63442381345152], "episode_lengths": [150, 150, 150, 150, 150, 95, 150, 150, 150, 52, 150, 150, 53, 150, 53, 150, 150, 150, 150, 150, 81, 150, 121, 94, 83, 95, 150, 150, 76, 150, 76, 150, 123, 42, 76, 150, 150, 78, 96, 108, 75, 150, 150, 150, 150, 46, 105, 139, 150, 49, 150, 150, 150, 93, 150, 150, 69, 150, 150, 150, 150, 150, 150, 76, 150, 128, 150, 150, 150, 150, 150, 78, 150, 83, 150, 150, 150, 150, 87, 132, 103, 69, 67, 46, 150, 122, 150, 52, 77, 115, 150, 117, 53, 43, 150, 44, 150, 103, 150, 102], "policy_policy_0_reward": [-833.9738935416653, -654.4121734333626, -901.0549524356715, -1089.3130197980736, -906.8423131599582, -251.26743835861964, -722.817547986509, -1105.0257029325755, -524.0698565014104, -144.59680707392152, -708.0005265534713, -1372.1935816771193, -51.68425245268439, -869.7099005050638, -35.08786478413726, -911.1410494203449, -865.5267261882747, -418.4136007296812, -509.01589134364804, -1026.8542698668382, -92.93302827158837, -808.7230018909337, -528.9954465785908, -271.1107913123651, -123.03418794395932, -296.41741234458937, -784.7273720531404, -863.0935223111106, -261.1493953706703, -1199.4645341252235, -112.2077983550332, -276.3184402637494, -568.111944455383, -21.792102962517948, -161.7286504964556, -1127.6990834882592, -1006.7266563967921, -167.8291664641031, -392.88399787331036, -337.5893493807394, -164.02224519727068, -230.86501262573023, -938.1044960356783, -1124.7207053148693, -628.2769557817596, -22.453926713757532, -315.3147914151819, -526.9556559074243, -505.4681624782526, -115.40704517760354, -1022.0311465743505, -456.0840075386357, -1021.9903670039563, -185.08085701792612, -935.4864957985618, -1001.5644100148187, -214.19177402254508, -1093.9722927242738, -961.6000896181218, -1139.5132102214536, -317.31854263870343, -960.0131767583979, -1129.503919749085, -125.32661933972147, -959.3791378231379, -701.8189649269381, -1134.433680608739, -1095.1237960902056, -539.1544913559826, -361.4483293678643, -1211.5715117568254, -150.98249213435824, -962.0546731222893, -277.66613672079643, -619.9707905387065, -1235.9146830051034, -949.0969868645138, -376.2961832568412, -216.26458199035392, -344.86401159747726, -227.49652321587254, -97.53847777555991, -76.36659793348, -36.83889199378781, -784.8111557882096, -195.1813751786286, -1009.7754839522438, -66.48954080820309, -137.88421109446554, -449.55441201339, -764.1697137838144, -336.4696069301827, -131.23718506491107, -31.93754510010519, -463.5193579033878, -30.71361955990655, -292.82480469883814, -442.42802888701686, -512.3309937075289, -217.63442381345152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560689246343394, "mean_inference_ms": 1.7353252860332882, "mean_action_processing_ms": 0.2755400939958708, "mean_env_wait_ms": 3.3892115919028725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012352228164672852, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.19936776161193848}, "num_episodes": 32, "episode_return_max": -21.792102962517948, "episode_return_min": -1372.1935816771193, "episode_return_mean": -558.8004555711273, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.47649471365946, "num_env_steps_trained_throughput_per_sec": 308.47649471365946, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12519.914, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12519.837, "sample_time_ms": 1175.638, "learn_time_ms": 11278.292, "learn_throughput": 354.664, "synch_weights_time_ms": 65.105}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "1e132_00001", "date": "2024-08-04_07-39-49", "timestamp": 1722737389, "time_this_iter_s": 12.978736400604248, "time_total_s": 412.11721086502075, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d854489120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 412.11721086502075, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.688888888888886, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.42230141361554, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.4049529091765482, "policy_loss": -0.013612880179910766, "vf_loss": 1.4127550768045087, "vf_explained_var": 0.996088488958776, "kl": 0.0197681731318274, "entropy": 1.197381318298479, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -20.472875387309244, "episode_reward_min": -1235.9146830051034, "episode_reward_mean": -575.8536091933361, "episode_len_mean": 121.64, "episode_media": {}, "episodes_timesteps_total": 12164, "policy_reward_min": {"policy_0": -1235.9146830051034}, "policy_reward_max": {"policy_0": -20.472875387309244}, "policy_reward_mean": {"policy_0": -575.8536091933361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1127.6990834882592, -1006.7266563967921, -167.8291664641031, -392.88399787331036, -337.5893493807394, -164.02224519727068, -230.86501262573023, -938.1044960356783, -1124.7207053148693, -628.2769557817596, -22.453926713757532, -315.3147914151819, -526.9556559074243, -505.4681624782526, -115.40704517760354, -1022.0311465743505, -456.0840075386357, -1021.9903670039563, -185.08085701792612, -935.4864957985618, -1001.5644100148187, -214.19177402254508, -1093.9722927242738, -961.6000896181218, -1139.5132102214536, -317.31854263870343, -960.0131767583979, -1129.503919749085, -125.32661933972147, -959.3791378231379, -701.8189649269381, -1134.433680608739, -1095.1237960902056, -539.1544913559826, -361.4483293678643, -1211.5715117568254, -150.98249213435824, -962.0546731222893, -277.66613672079643, -619.9707905387065, -1235.9146830051034, -949.0969868645138, -376.2961832568412, -216.26458199035392, -344.86401159747726, -227.49652321587254, -97.53847777555991, -76.36659793348, -36.83889199378781, -784.8111557882096, -195.1813751786286, -1009.7754839522438, -66.48954080820309, -137.88421109446554, -449.55441201339, -764.1697137838144, -336.4696069301827, -131.23718506491107, -31.93754510010519, -463.5193579033878, -30.71361955990655, -292.82480469883814, -442.42802888701686, -512.3309937075289, -217.63442381345152, -856.657855457345, -415.9427581905791, -736.5749515922016, -1199.9425440082052, -95.76961517730962, -614.9624661481663, -20.472875387309244, -35.0077834383757, -458.3428619921546, -110.32502869545637, -1223.7274953317801, -895.1939938985457, -894.1342203618781, -478.5354044200398, -77.29602559233082, -232.83257658917117, -800.5640330707824, -1068.5617977850638, -95.08976471849277, -323.67505097166395, -735.492536004907, -1088.1958918111986, -50.49011292186468, -558.2984583248855, -1213.668291869784, -716.4979458584725, -1067.4530277177025, -742.5187190391912, -493.40893511780763, -1016.3825451725858, -240.5499725055511, -1116.881306716436, -1058.460211371055, -280.1266559897346, -964.0906464511708], "episode_lengths": [150, 150, 78, 96, 108, 75, 150, 150, 150, 150, 46, 105, 139, 150, 49, 150, 150, 150, 93, 150, 150, 69, 150, 150, 150, 150, 150, 150, 76, 150, 128, 150, 150, 150, 150, 150, 78, 150, 83, 150, 150, 150, 150, 87, 132, 103, 69, 67, 46, 150, 122, 150, 52, 77, 115, 150, 117, 53, 43, 150, 44, 150, 103, 150, 102, 150, 118, 150, 150, 67, 150, 41, 47, 150, 68, 150, 150, 150, 150, 67, 91, 150, 150, 69, 119, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 87, 150], "policy_policy_0_reward": [-1127.6990834882592, -1006.7266563967921, -167.8291664641031, -392.88399787331036, -337.5893493807394, -164.02224519727068, -230.86501262573023, -938.1044960356783, -1124.7207053148693, -628.2769557817596, -22.453926713757532, -315.3147914151819, -526.9556559074243, -505.4681624782526, -115.40704517760354, -1022.0311465743505, -456.0840075386357, -1021.9903670039563, -185.08085701792612, -935.4864957985618, -1001.5644100148187, -214.19177402254508, -1093.9722927242738, -961.6000896181218, -1139.5132102214536, -317.31854263870343, -960.0131767583979, -1129.503919749085, -125.32661933972147, -959.3791378231379, -701.8189649269381, -1134.433680608739, -1095.1237960902056, -539.1544913559826, -361.4483293678643, -1211.5715117568254, -150.98249213435824, -962.0546731222893, -277.66613672079643, -619.9707905387065, -1235.9146830051034, -949.0969868645138, -376.2961832568412, -216.26458199035392, -344.86401159747726, -227.49652321587254, -97.53847777555991, -76.36659793348, -36.83889199378781, -784.8111557882096, -195.1813751786286, -1009.7754839522438, -66.48954080820309, -137.88421109446554, -449.55441201339, -764.1697137838144, -336.4696069301827, -131.23718506491107, -31.93754510010519, -463.5193579033878, -30.71361955990655, -292.82480469883814, -442.42802888701686, -512.3309937075289, -217.63442381345152, -856.657855457345, -415.9427581905791, -736.5749515922016, -1199.9425440082052, -95.76961517730962, -614.9624661481663, -20.472875387309244, -35.0077834383757, -458.3428619921546, -110.32502869545637, -1223.7274953317801, -895.1939938985457, -894.1342203618781, -478.5354044200398, -77.29602559233082, -232.83257658917117, -800.5640330707824, -1068.5617977850638, -95.08976471849277, -323.67505097166395, -735.492536004907, -1088.1958918111986, -50.49011292186468, -558.2984583248855, -1213.668291869784, -716.4979458584725, -1067.4530277177025, -742.5187190391912, -493.40893511780763, -1016.3825451725858, -240.5499725055511, -1116.881306716436, -1058.460211371055, -280.1266559897346, -964.0906464511708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561940008257888, "mean_inference_ms": 1.736395964234406, "mean_action_processing_ms": 0.2753687035015708, "mean_env_wait_ms": 3.3890255431592045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012431621551513672, "StateBufferConnector_ms": 0.007941246032714844, "ViewRequirementAgentConnector_ms": 0.19928455352783203}, "num_episodes": 35, "episode_return_max": -20.472875387309244, "episode_return_min": -1235.9146830051034, "episode_return_mean": -575.8536091933361, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.859312438307, "num_env_steps_trained_throughput_per_sec": 296.859312438307, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12817.631, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12817.557, "sample_time_ms": 1177.75, "learn_time_ms": 11573.191, "learn_throughput": 345.626, "synch_weights_time_ms": 65.811}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "1e132_00001", "date": "2024-08-04_07-40-02", "timestamp": 1722737402, "time_this_iter_s": 13.489160776138306, "time_total_s": 425.60637164115906, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bd360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 425.60637164115906, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.673684210526314, "ram_util_percent": 28.110526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.72786747018498, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7312117227042714, "policy_loss": -0.0029554078180808576, "vf_loss": 1.7288990675782163, "vf_explained_var": 0.989230861949424, "kl": 0.017958512700746117, "entropy": 1.1948668643211324, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -20.472875387309244, "episode_reward_min": -1235.9146830051034, "episode_reward_mean": -536.1318842215301, "episode_len_mean": 118.7, "episode_media": {}, "episodes_timesteps_total": 11870, "policy_reward_min": {"policy_0": -1235.9146830051034}, "policy_reward_max": {"policy_0": -20.472875387309244}, "policy_reward_mean": {"policy_0": -536.1318842215301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1211.5715117568254, -150.98249213435824, -962.0546731222893, -277.66613672079643, -619.9707905387065, -1235.9146830051034, -949.0969868645138, -376.2961832568412, -216.26458199035392, -344.86401159747726, -227.49652321587254, -97.53847777555991, -76.36659793348, -36.83889199378781, -784.8111557882096, -195.1813751786286, -1009.7754839522438, -66.48954080820309, -137.88421109446554, -449.55441201339, -764.1697137838144, -336.4696069301827, -131.23718506491107, -31.93754510010519, -463.5193579033878, -30.71361955990655, -292.82480469883814, -442.42802888701686, -512.3309937075289, -217.63442381345152, -856.657855457345, -415.9427581905791, -736.5749515922016, -1199.9425440082052, -95.76961517730962, -614.9624661481663, -20.472875387309244, -35.0077834383757, -458.3428619921546, -110.32502869545637, -1223.7274953317801, -895.1939938985457, -894.1342203618781, -478.5354044200398, -77.29602559233082, -232.83257658917117, -800.5640330707824, -1068.5617977850638, -95.08976471849277, -323.67505097166395, -735.492536004907, -1088.1958918111986, -50.49011292186468, -558.2984583248855, -1213.668291869784, -716.4979458584725, -1067.4530277177025, -742.5187190391912, -493.40893511780763, -1016.3825451725858, -240.5499725055511, -1116.881306716436, -1058.460211371055, -280.1266559897346, -964.0906464511708, -500.44500387824405, -387.2595806951158, -985.9352736744265, -641.915130872485, -666.8482825820234, -1202.4473680524643, -902.6839471652406, -137.08060845308387, -889.135713617713, -1007.4390236189047, -829.3059708333374, -1229.6540775364222, -664.6528483531557, -803.5151308722498, -243.97918288907363, -191.35296109503125, -586.8496193593883, -70.89887754612666, -980.4771156657591, -611.0145298012488, -68.68151809813207, -77.6635836931925, -295.3036464286501, -246.97510170662716, -57.57590434855989, -168.65175647390626, -269.4496633764969, -393.84664164512276, -760.940804978514, -849.3576718549646, -131.20485495648944, -1189.7224976514435, -51.41001778992751, -747.0563650313862, -146.44978766865012], "episode_lengths": [150, 78, 150, 83, 150, 150, 150, 150, 87, 132, 103, 69, 67, 46, 150, 122, 150, 52, 77, 115, 150, 117, 53, 43, 150, 44, 150, 103, 150, 102, 150, 118, 150, 150, 67, 150, 41, 47, 150, 68, 150, 150, 150, 150, 67, 91, 150, 150, 69, 119, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 133, 150, 103, 83, 150, 65, 150, 150, 64, 61, 106, 103, 52, 84, 150, 89, 150, 150, 87, 150, 52, 140, 74], "policy_policy_0_reward": [-1211.5715117568254, -150.98249213435824, -962.0546731222893, -277.66613672079643, -619.9707905387065, -1235.9146830051034, -949.0969868645138, -376.2961832568412, -216.26458199035392, -344.86401159747726, -227.49652321587254, -97.53847777555991, -76.36659793348, -36.83889199378781, -784.8111557882096, -195.1813751786286, -1009.7754839522438, -66.48954080820309, -137.88421109446554, -449.55441201339, -764.1697137838144, -336.4696069301827, -131.23718506491107, -31.93754510010519, -463.5193579033878, -30.71361955990655, -292.82480469883814, -442.42802888701686, -512.3309937075289, -217.63442381345152, -856.657855457345, -415.9427581905791, -736.5749515922016, -1199.9425440082052, -95.76961517730962, -614.9624661481663, -20.472875387309244, -35.0077834383757, -458.3428619921546, -110.32502869545637, -1223.7274953317801, -895.1939938985457, -894.1342203618781, -478.5354044200398, -77.29602559233082, -232.83257658917117, -800.5640330707824, -1068.5617977850638, -95.08976471849277, -323.67505097166395, -735.492536004907, -1088.1958918111986, -50.49011292186468, -558.2984583248855, -1213.668291869784, -716.4979458584725, -1067.4530277177025, -742.5187190391912, -493.40893511780763, -1016.3825451725858, -240.5499725055511, -1116.881306716436, -1058.460211371055, -280.1266559897346, -964.0906464511708, -500.44500387824405, -387.2595806951158, -985.9352736744265, -641.915130872485, -666.8482825820234, -1202.4473680524643, -902.6839471652406, -137.08060845308387, -889.135713617713, -1007.4390236189047, -829.3059708333374, -1229.6540775364222, -664.6528483531557, -803.5151308722498, -243.97918288907363, -191.35296109503125, -586.8496193593883, -70.89887754612666, -980.4771156657591, -611.0145298012488, -68.68151809813207, -77.6635836931925, -295.3036464286501, -246.97510170662716, -57.57590434855989, -168.65175647390626, -269.4496633764969, -393.84664164512276, -760.940804978514, -849.3576718549646, -131.20485495648944, -1189.7224976514435, -51.41001778992751, -747.0563650313862, -146.44978766865012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563992328215349, "mean_inference_ms": 1.7343577085468551, "mean_action_processing_ms": 0.27534716109876933, "mean_env_wait_ms": 3.3894769726027905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012570858001708984, "StateBufferConnector_ms": 0.007984161376953125, "ViewRequirementAgentConnector_ms": 0.2083604335784912}, "num_episodes": 35, "episode_return_max": -20.472875387309244, "episode_return_min": -1235.9146830051034, "episode_return_mean": -536.1318842215301, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.13014203966304, "num_env_steps_trained_throughput_per_sec": 316.13014203966304, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12819.053, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12818.979, "sample_time_ms": 1178.217, "learn_time_ms": 11573.993, "learn_throughput": 345.602, "synch_weights_time_ms": 65.961}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "1e132_00001", "date": "2024-08-04_07-40-15", "timestamp": 1722737415, "time_this_iter_s": 12.66523814201355, "time_total_s": 438.2716097831726, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bd7e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 438.2716097831726, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.038888888888888, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.2319968064626, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7051411145677169, "policy_loss": -0.012574117895079931, "vf_loss": 1.7123765803252657, "vf_explained_var": 0.9931160877769192, "kl": 0.01813720504187586, "entropy": 1.025217304378748, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -20.472875387309244, "episode_reward_min": -1333.7138528195762, "episode_reward_mean": -556.0729478560587, "episode_len_mean": 120.43, "episode_media": {}, "episodes_timesteps_total": 12043, "policy_reward_min": {"policy_0": -1333.7138528195762}, "policy_reward_max": {"policy_0": -20.472875387309244}, "policy_reward_mean": {"policy_0": -556.0729478560587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-95.76961517730962, -614.9624661481663, -20.472875387309244, -35.0077834383757, -458.3428619921546, -110.32502869545637, -1223.7274953317801, -895.1939938985457, -894.1342203618781, -478.5354044200398, -77.29602559233082, -232.83257658917117, -800.5640330707824, -1068.5617977850638, -95.08976471849277, -323.67505097166395, -735.492536004907, -1088.1958918111986, -50.49011292186468, -558.2984583248855, -1213.668291869784, -716.4979458584725, -1067.4530277177025, -742.5187190391912, -493.40893511780763, -1016.3825451725858, -240.5499725055511, -1116.881306716436, -1058.460211371055, -280.1266559897346, -964.0906464511708, -500.44500387824405, -387.2595806951158, -985.9352736744265, -641.915130872485, -666.8482825820234, -1202.4473680524643, -902.6839471652406, -137.08060845308387, -889.135713617713, -1007.4390236189047, -829.3059708333374, -1229.6540775364222, -664.6528483531557, -803.5151308722498, -243.97918288907363, -191.35296109503125, -586.8496193593883, -70.89887754612666, -980.4771156657591, -611.0145298012488, -68.68151809813207, -77.6635836931925, -295.3036464286501, -246.97510170662716, -57.57590434855989, -168.65175647390626, -269.4496633764969, -393.84664164512276, -760.940804978514, -849.3576718549646, -131.20485495648944, -1189.7224976514435, -51.41001778992751, -747.0563650313862, -146.44978766865012, -808.1418851659934, -361.7855124157858, -1117.660897129508, -1333.7138528195762, -260.8017680593433, -281.3171889672711, -1021.4416667037863, -22.06943648832112, -828.7579530502785, -126.4308585654798, -640.9931982345306, -872.9923951987734, -41.79482039940256, -410.8652261274101, -930.5287571470489, -90.5188392140306, -69.17387551989319, -191.6211221175664, -441.21358268662317, -234.05317479672772, -1012.0306759300448, -645.1445465286819, -268.3640718813552, -54.42156741822267, -1037.924000727834, -1220.7293454406351, -188.63583842495342, -1039.835296936299, -230.93244881903797, -502.1203367704252, -604.302242406533, -443.0999488099483, -192.7648821324479, -326.9272598576759], "episode_lengths": [67, 150, 41, 47, 150, 68, 150, 150, 150, 150, 67, 91, 150, 150, 69, 119, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 133, 150, 103, 83, 150, 65, 150, 150, 64, 61, 106, 103, 52, 84, 150, 89, 150, 150, 87, 150, 52, 140, 74, 150, 88, 150, 150, 112, 98, 150, 42, 150, 68, 150, 150, 47, 150, 150, 72, 59, 108, 150, 100, 150, 150, 117, 52, 150, 150, 90, 150, 81, 150, 150, 142, 96, 112], "policy_policy_0_reward": [-95.76961517730962, -614.9624661481663, -20.472875387309244, -35.0077834383757, -458.3428619921546, -110.32502869545637, -1223.7274953317801, -895.1939938985457, -894.1342203618781, -478.5354044200398, -77.29602559233082, -232.83257658917117, -800.5640330707824, -1068.5617977850638, -95.08976471849277, -323.67505097166395, -735.492536004907, -1088.1958918111986, -50.49011292186468, -558.2984583248855, -1213.668291869784, -716.4979458584725, -1067.4530277177025, -742.5187190391912, -493.40893511780763, -1016.3825451725858, -240.5499725055511, -1116.881306716436, -1058.460211371055, -280.1266559897346, -964.0906464511708, -500.44500387824405, -387.2595806951158, -985.9352736744265, -641.915130872485, -666.8482825820234, -1202.4473680524643, -902.6839471652406, -137.08060845308387, -889.135713617713, -1007.4390236189047, -829.3059708333374, -1229.6540775364222, -664.6528483531557, -803.5151308722498, -243.97918288907363, -191.35296109503125, -586.8496193593883, -70.89887754612666, -980.4771156657591, -611.0145298012488, -68.68151809813207, -77.6635836931925, -295.3036464286501, -246.97510170662716, -57.57590434855989, -168.65175647390626, -269.4496633764969, -393.84664164512276, -760.940804978514, -849.3576718549646, -131.20485495648944, -1189.7224976514435, -51.41001778992751, -747.0563650313862, -146.44978766865012, -808.1418851659934, -361.7855124157858, -1117.660897129508, -1333.7138528195762, -260.8017680593433, -281.3171889672711, -1021.4416667037863, -22.06943648832112, -828.7579530502785, -126.4308585654798, -640.9931982345306, -872.9923951987734, -41.79482039940256, -410.8652261274101, -930.5287571470489, -90.5188392140306, -69.17387551989319, -191.6211221175664, -441.21358268662317, -234.05317479672772, -1012.0306759300448, -645.1445465286819, -268.3640718813552, -54.42156741822267, -1037.924000727834, -1220.7293454406351, -188.63583842495342, -1039.835296936299, -230.93244881903797, -502.1203367704252, -604.302242406533, -443.0999488099483, -192.7648821324479, -326.9272598576759]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559222600020921, "mean_inference_ms": 1.7314034727967391, "mean_action_processing_ms": 0.275344000417648, "mean_env_wait_ms": 3.3888584590506143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012538433074951172, "StateBufferConnector_ms": 0.008672714233398438, "ViewRequirementAgentConnector_ms": 0.20037031173706055}, "num_episodes": 34, "episode_return_max": -20.472875387309244, "episode_return_min": -1333.7138528195762, "episode_return_mean": -556.0729478560587, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.38017498697036, "num_env_steps_trained_throughput_per_sec": 307.38017498697036, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12884.283, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12884.209, "sample_time_ms": 1167.725, "learn_time_ms": 11650.053, "learn_throughput": 343.346, "synch_weights_time_ms": 65.624}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "1e132_00001", "date": "2024-08-04_07-40-28", "timestamp": 1722737428, "time_this_iter_s": 13.026230812072754, "time_total_s": 451.29784059524536, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d854489120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 451.29784059524536, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.478947368421053, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.12826115091642, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.626206411793828, "policy_loss": -0.009407409038006638, "vf_loss": 1.6294104997068644, "vf_explained_var": 0.9921338266382614, "kl": 0.021040188577277755, "entropy": 1.0873607978224755, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -15.698286732178211, "episode_reward_min": -1379.5878019061495, "episode_reward_mean": -519.1148973893974, "episode_len_mean": 119.06, "episode_media": {}, "episodes_timesteps_total": 11906, "policy_reward_min": {"policy_0": -1379.5878019061495}, "policy_reward_max": {"policy_0": -15.698286732178211}, "policy_reward_mean": {"policy_0": -519.1148973893974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.44500387824405, -387.2595806951158, -985.9352736744265, -641.915130872485, -666.8482825820234, -1202.4473680524643, -902.6839471652406, -137.08060845308387, -889.135713617713, -1007.4390236189047, -829.3059708333374, -1229.6540775364222, -664.6528483531557, -803.5151308722498, -243.97918288907363, -191.35296109503125, -586.8496193593883, -70.89887754612666, -980.4771156657591, -611.0145298012488, -68.68151809813207, -77.6635836931925, -295.3036464286501, -246.97510170662716, -57.57590434855989, -168.65175647390626, -269.4496633764969, -393.84664164512276, -760.940804978514, -849.3576718549646, -131.20485495648944, -1189.7224976514435, -51.41001778992751, -747.0563650313862, -146.44978766865012, -808.1418851659934, -361.7855124157858, -1117.660897129508, -1333.7138528195762, -260.8017680593433, -281.3171889672711, -1021.4416667037863, -22.06943648832112, -828.7579530502785, -126.4308585654798, -640.9931982345306, -872.9923951987734, -41.79482039940256, -410.8652261274101, -930.5287571470489, -90.5188392140306, -69.17387551989319, -191.6211221175664, -441.21358268662317, -234.05317479672772, -1012.0306759300448, -645.1445465286819, -268.3640718813552, -54.42156741822267, -1037.924000727834, -1220.7293454406351, -188.63583842495342, -1039.835296936299, -230.93244881903797, -502.1203367704252, -604.302242406533, -443.0999488099483, -192.7648821324479, -326.9272598576759, -79.03992525574054, -613.5820973125724, -276.76704787359097, -271.23862731916927, -940.1314954749332, -278.0511800953918, -226.5882937608514, -159.0416259049482, -257.30895232100096, -711.1500450816263, -309.19635095035187, -93.2619844632998, -867.6569119816312, -172.3940025399882, -532.0287544976948, -753.576423551868, -224.34784001778647, -67.26248997014724, -844.3901281855041, -882.0484379895152, -1379.5878019061495, -404.41142211334227, -15.698286732178211, -335.7048034255921, -839.360839519033, -873.664537685226, -207.01938496207623, -1227.5731892513277, -176.88441627525964, -394.3680517128324, -657.8658556541063], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 133, 150, 103, 83, 150, 65, 150, 150, 64, 61, 106, 103, 52, 84, 150, 89, 150, 150, 87, 150, 52, 140, 74, 150, 88, 150, 150, 112, 98, 150, 42, 150, 68, 150, 150, 47, 150, 150, 72, 59, 108, 150, 100, 150, 150, 117, 52, 150, 150, 90, 150, 81, 150, 150, 142, 96, 112, 51, 150, 150, 97, 150, 117, 92, 78, 112, 150, 114, 73, 150, 60, 150, 150, 93, 60, 150, 150, 150, 150, 47, 110, 150, 150, 85, 150, 91, 150, 124], "policy_policy_0_reward": [-500.44500387824405, -387.2595806951158, -985.9352736744265, -641.915130872485, -666.8482825820234, -1202.4473680524643, -902.6839471652406, -137.08060845308387, -889.135713617713, -1007.4390236189047, -829.3059708333374, -1229.6540775364222, -664.6528483531557, -803.5151308722498, -243.97918288907363, -191.35296109503125, -586.8496193593883, -70.89887754612666, -980.4771156657591, -611.0145298012488, -68.68151809813207, -77.6635836931925, -295.3036464286501, -246.97510170662716, -57.57590434855989, -168.65175647390626, -269.4496633764969, -393.84664164512276, -760.940804978514, -849.3576718549646, -131.20485495648944, -1189.7224976514435, -51.41001778992751, -747.0563650313862, -146.44978766865012, -808.1418851659934, -361.7855124157858, -1117.660897129508, -1333.7138528195762, -260.8017680593433, -281.3171889672711, -1021.4416667037863, -22.06943648832112, -828.7579530502785, -126.4308585654798, -640.9931982345306, -872.9923951987734, -41.79482039940256, -410.8652261274101, -930.5287571470489, -90.5188392140306, -69.17387551989319, -191.6211221175664, -441.21358268662317, -234.05317479672772, -1012.0306759300448, -645.1445465286819, -268.3640718813552, -54.42156741822267, -1037.924000727834, -1220.7293454406351, -188.63583842495342, -1039.835296936299, -230.93244881903797, -502.1203367704252, -604.302242406533, -443.0999488099483, -192.7648821324479, -326.9272598576759, -79.03992525574054, -613.5820973125724, -276.76704787359097, -271.23862731916927, -940.1314954749332, -278.0511800953918, -226.5882937608514, -159.0416259049482, -257.30895232100096, -711.1500450816263, -309.19635095035187, -93.2619844632998, -867.6569119816312, -172.3940025399882, -532.0287544976948, -753.576423551868, -224.34784001778647, -67.26248997014724, -844.3901281855041, -882.0484379895152, -1379.5878019061495, -404.41142211334227, -15.698286732178211, -335.7048034255921, -839.360839519033, -873.664537685226, -207.01938496207623, -1227.5731892513277, -176.88441627525964, -394.3680517128324, -657.8658556541063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559023880243464, "mean_inference_ms": 1.7301960036039232, "mean_action_processing_ms": 0.2753711413912686, "mean_env_wait_ms": 3.389470633056723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01250004768371582, "StateBufferConnector_ms": 0.008815526962280273, "ViewRequirementAgentConnector_ms": 0.20371484756469727}, "num_episodes": 31, "episode_return_max": -15.698286732178211, "episode_return_min": -1379.5878019061495, "episode_return_mean": -519.1148973893974, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.90049185031114, "num_env_steps_trained_throughput_per_sec": 313.90049185031114, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12970.731, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12970.657, "sample_time_ms": 1167.882, "learn_time_ms": 11736.493, "learn_throughput": 340.817, "synch_weights_time_ms": 65.476}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "1e132_00001", "date": "2024-08-04_07-40-41", "timestamp": 1722737441, "time_this_iter_s": 12.75642991065979, "time_total_s": 464.05427050590515, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448acb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 464.05427050590515, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.938888888888886, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.76367529233298, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.6509667131739358, "policy_loss": -0.008050627138679071, "vf_loss": 1.653815209772438, "vf_explained_var": 0.988223370971779, "kl": 0.011816751353050374, "entropy": 1.1540334150195122, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -1.8424809609232335, "episode_reward_min": -1379.5878019061495, "episode_reward_mean": -540.0416121960449, "episode_len_mean": 122.13, "episode_media": {}, "episodes_timesteps_total": 12213, "policy_reward_min": {"policy_0": -1379.5878019061495}, "policy_reward_max": {"policy_0": -1.8424809609232335}, "policy_reward_mean": {"policy_0": -540.0416121960449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1189.7224976514435, -51.41001778992751, -747.0563650313862, -146.44978766865012, -808.1418851659934, -361.7855124157858, -1117.660897129508, -1333.7138528195762, -260.8017680593433, -281.3171889672711, -1021.4416667037863, -22.06943648832112, -828.7579530502785, -126.4308585654798, -640.9931982345306, -872.9923951987734, -41.79482039940256, -410.8652261274101, -930.5287571470489, -90.5188392140306, -69.17387551989319, -191.6211221175664, -441.21358268662317, -234.05317479672772, -1012.0306759300448, -645.1445465286819, -268.3640718813552, -54.42156741822267, -1037.924000727834, -1220.7293454406351, -188.63583842495342, -1039.835296936299, -230.93244881903797, -502.1203367704252, -604.302242406533, -443.0999488099483, -192.7648821324479, -326.9272598576759, -79.03992525574054, -613.5820973125724, -276.76704787359097, -271.23862731916927, -940.1314954749332, -278.0511800953918, -226.5882937608514, -159.0416259049482, -257.30895232100096, -711.1500450816263, -309.19635095035187, -93.2619844632998, -867.6569119816312, -172.3940025399882, -532.0287544976948, -753.576423551868, -224.34784001778647, -67.26248997014724, -844.3901281855041, -882.0484379895152, -1379.5878019061495, -404.41142211334227, -15.698286732178211, -335.7048034255921, -839.360839519033, -873.664537685226, -207.01938496207623, -1227.5731892513277, -176.88441627525964, -394.3680517128324, -657.8658556541063, -502.4965642251502, -331.45037552320065, -642.772670472504, -158.34275329566054, -462.93310772491475, -135.461484835373, -611.3182637382316, -1299.2949701895122, -972.2947462336149, -95.77111260432363, -527.0764976179256, -1206.2512692902076, -863.4365312486083, -800.5077227885519, -614.2109409214862, -875.4308073914029, -470.0131637366636, -942.5062083037046, -581.7078512739279, -506.5550004962938, -356.49704657112983, -219.26979054914304, -461.3550684085202, -1005.5139770583049, -58.337753292730916, -473.45746082693074, -1053.3650961002559, -1207.0652219500048, -769.9934153544156, -738.6835218032882, -1.8424809609232335], "episode_lengths": [150, 52, 140, 74, 150, 88, 150, 150, 112, 98, 150, 42, 150, 68, 150, 150, 47, 150, 150, 72, 59, 108, 150, 100, 150, 150, 117, 52, 150, 150, 90, 150, 81, 150, 150, 142, 96, 112, 51, 150, 150, 97, 150, 117, 92, 78, 112, 150, 114, 73, 150, 60, 150, 150, 93, 60, 150, 150, 150, 150, 47, 110, 150, 150, 85, 150, 91, 150, 124, 150, 150, 150, 86, 150, 71, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 146, 150, 48, 150, 150, 150, 150, 136, 31], "policy_policy_0_reward": [-1189.7224976514435, -51.41001778992751, -747.0563650313862, -146.44978766865012, -808.1418851659934, -361.7855124157858, -1117.660897129508, -1333.7138528195762, -260.8017680593433, -281.3171889672711, -1021.4416667037863, -22.06943648832112, -828.7579530502785, -126.4308585654798, -640.9931982345306, -872.9923951987734, -41.79482039940256, -410.8652261274101, -930.5287571470489, -90.5188392140306, -69.17387551989319, -191.6211221175664, -441.21358268662317, -234.05317479672772, -1012.0306759300448, -645.1445465286819, -268.3640718813552, -54.42156741822267, -1037.924000727834, -1220.7293454406351, -188.63583842495342, -1039.835296936299, -230.93244881903797, -502.1203367704252, -604.302242406533, -443.0999488099483, -192.7648821324479, -326.9272598576759, -79.03992525574054, -613.5820973125724, -276.76704787359097, -271.23862731916927, -940.1314954749332, -278.0511800953918, -226.5882937608514, -159.0416259049482, -257.30895232100096, -711.1500450816263, -309.19635095035187, -93.2619844632998, -867.6569119816312, -172.3940025399882, -532.0287544976948, -753.576423551868, -224.34784001778647, -67.26248997014724, -844.3901281855041, -882.0484379895152, -1379.5878019061495, -404.41142211334227, -15.698286732178211, -335.7048034255921, -839.360839519033, -873.664537685226, -207.01938496207623, -1227.5731892513277, -176.88441627525964, -394.3680517128324, -657.8658556541063, -502.4965642251502, -331.45037552320065, -642.772670472504, -158.34275329566054, -462.93310772491475, -135.461484835373, -611.3182637382316, -1299.2949701895122, -972.2947462336149, -95.77111260432363, -527.0764976179256, -1206.2512692902076, -863.4365312486083, -800.5077227885519, -614.2109409214862, -875.4308073914029, -470.0131637366636, -942.5062083037046, -581.7078512739279, -506.5550004962938, -356.49704657112983, -219.26979054914304, -461.3550684085202, -1005.5139770583049, -58.337753292730916, -473.45746082693074, -1053.3650961002559, -1207.0652219500048, -769.9934153544156, -738.6835218032882, -1.8424809609232335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553089885843994, "mean_inference_ms": 1.7268983804167954, "mean_action_processing_ms": 0.2753666905814427, "mean_env_wait_ms": 3.3889202123781677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012696981430053711, "StateBufferConnector_ms": 0.008812665939331055, "ViewRequirementAgentConnector_ms": 0.19619107246398926}, "num_episodes": 31, "episode_return_max": -1.8424809609232335, "episode_return_min": -1379.5878019061495, "episode_return_mean": -540.0416121960449, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.101679001832, "num_env_steps_trained_throughput_per_sec": 306.101679001832, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12992.724, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12992.649, "sample_time_ms": 1151.5, "learn_time_ms": 11775.736, "learn_throughput": 339.682, "synch_weights_time_ms": 64.604}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "1e132_00001", "date": "2024-08-04_07-40-54", "timestamp": 1722737454, "time_this_iter_s": 13.078489780426025, "time_total_s": 477.1327602863312, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 477.1327602863312, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.43684210526316, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.98701607783636, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.6985866338635485, "policy_loss": -0.011443924707418774, "vf_loss": 1.702803535449008, "vf_explained_var": 0.9892280496036013, "kl": 0.016337076544550654, "entropy": 1.2465992980947098, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -1.8424809609232335, "episode_reward_min": -1379.5878019061495, "episode_reward_mean": -539.742601044532, "episode_len_mean": 124.98, "episode_media": {}, "episodes_timesteps_total": 12498, "policy_reward_min": {"policy_0": -1379.5878019061495}, "policy_reward_max": {"policy_0": -1.8424809609232335}, "policy_reward_mean": {"policy_0": -539.742601044532}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-326.9272598576759, -79.03992525574054, -613.5820973125724, -276.76704787359097, -271.23862731916927, -940.1314954749332, -278.0511800953918, -226.5882937608514, -159.0416259049482, -257.30895232100096, -711.1500450816263, -309.19635095035187, -93.2619844632998, -867.6569119816312, -172.3940025399882, -532.0287544976948, -753.576423551868, -224.34784001778647, -67.26248997014724, -844.3901281855041, -882.0484379895152, -1379.5878019061495, -404.41142211334227, -15.698286732178211, -335.7048034255921, -839.360839519033, -873.664537685226, -207.01938496207623, -1227.5731892513277, -176.88441627525964, -394.3680517128324, -657.8658556541063, -502.4965642251502, -331.45037552320065, -642.772670472504, -158.34275329566054, -462.93310772491475, -135.461484835373, -611.3182637382316, -1299.2949701895122, -972.2947462336149, -95.77111260432363, -527.0764976179256, -1206.2512692902076, -863.4365312486083, -800.5077227885519, -614.2109409214862, -875.4308073914029, -470.0131637366636, -942.5062083037046, -581.7078512739279, -506.5550004962938, -356.49704657112983, -219.26979054914304, -461.3550684085202, -1005.5139770583049, -58.337753292730916, -473.45746082693074, -1053.3650961002559, -1207.0652219500048, -769.9934153544156, -738.6835218032882, -1.8424809609232335, -924.5172047757235, -668.6946594272259, -208.0810966418517, -941.7869756722536, -214.83889456472355, -437.33901588857776, -418.8096658626267, -136.84567373426327, -507.60878575131784, -236.39813540150166, -429.47567092961094, -801.7965401636317, -731.5383273381806, -773.3916690597925, -574.3114462730977, -52.65557769026475, -433.43286425552736, -560.1097036529238, -413.0346508120325, -588.1219526452434, -321.34535507228134, -751.7105519039128, -602.3190399221335, -1167.0278168178515, -151.60278183302174, -103.04719831306072, -1016.74342707431, -1152.150631189087, -511.4753980648276, -998.4759294899975, -507.1715990490842, -130.87964083365407, -373.4651752659497, -69.50530998583767, -194.15136426134677, -1111.253064509921, -415.80597189722687], "episode_lengths": [112, 51, 150, 150, 97, 150, 117, 92, 78, 112, 150, 114, 73, 150, 60, 150, 150, 93, 60, 150, 150, 150, 150, 47, 110, 150, 150, 85, 150, 91, 150, 124, 150, 150, 150, 86, 150, 71, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 146, 150, 48, 150, 150, 150, 150, 136, 31, 150, 150, 97, 150, 93, 150, 150, 74, 128, 106, 150, 150, 150, 150, 150, 52, 104, 150, 150, 150, 115, 150, 150, 150, 81, 75, 150, 150, 150, 150, 136, 68, 110, 59, 80, 150, 95], "policy_policy_0_reward": [-326.9272598576759, -79.03992525574054, -613.5820973125724, -276.76704787359097, -271.23862731916927, -940.1314954749332, -278.0511800953918, -226.5882937608514, -159.0416259049482, -257.30895232100096, -711.1500450816263, -309.19635095035187, -93.2619844632998, -867.6569119816312, -172.3940025399882, -532.0287544976948, -753.576423551868, -224.34784001778647, -67.26248997014724, -844.3901281855041, -882.0484379895152, -1379.5878019061495, -404.41142211334227, -15.698286732178211, -335.7048034255921, -839.360839519033, -873.664537685226, -207.01938496207623, -1227.5731892513277, -176.88441627525964, -394.3680517128324, -657.8658556541063, -502.4965642251502, -331.45037552320065, -642.772670472504, -158.34275329566054, -462.93310772491475, -135.461484835373, -611.3182637382316, -1299.2949701895122, -972.2947462336149, -95.77111260432363, -527.0764976179256, -1206.2512692902076, -863.4365312486083, -800.5077227885519, -614.2109409214862, -875.4308073914029, -470.0131637366636, -942.5062083037046, -581.7078512739279, -506.5550004962938, -356.49704657112983, -219.26979054914304, -461.3550684085202, -1005.5139770583049, -58.337753292730916, -473.45746082693074, -1053.3650961002559, -1207.0652219500048, -769.9934153544156, -738.6835218032882, -1.8424809609232335, -924.5172047757235, -668.6946594272259, -208.0810966418517, -941.7869756722536, -214.83889456472355, -437.33901588857776, -418.8096658626267, -136.84567373426327, -507.60878575131784, -236.39813540150166, -429.47567092961094, -801.7965401636317, -731.5383273381806, -773.3916690597925, -574.3114462730977, -52.65557769026475, -433.43286425552736, -560.1097036529238, -413.0346508120325, -588.1219526452434, -321.34535507228134, -751.7105519039128, -602.3190399221335, -1167.0278168178515, -151.60278183302174, -103.04719831306072, -1016.74342707431, -1152.150631189087, -511.4753980648276, -998.4759294899975, -507.1715990490842, -130.87964083365407, -373.4651752659497, -69.50530998583767, -194.15136426134677, -1111.253064509921, -415.80597189722687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552454803809866, "mean_inference_ms": 1.7250745003987165, "mean_action_processing_ms": 0.2752665455253778, "mean_env_wait_ms": 3.388360079191483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012883663177490234, "StateBufferConnector_ms": 0.008125543594360352, "ViewRequirementAgentConnector_ms": 0.1955559253692627}, "num_episodes": 37, "episode_return_max": -1.8424809609232335, "episode_return_min": -1379.5878019061495, "episode_return_mean": -539.742601044532, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.1662792182717, "num_env_steps_trained_throughput_per_sec": 308.1662792182717, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 13002.493, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13002.419, "sample_time_ms": 1148.371, "learn_time_ms": 11789.585, "learn_throughput": 339.283, "synch_weights_time_ms": 63.664}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "1e132_00001", "date": "2024-08-04_07-41-07", "timestamp": 1722737467, "time_this_iter_s": 12.992881298065186, "time_total_s": 490.12564158439636, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a5870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 490.12564158439636, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.794444444444444, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.08743924299876, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.7864953856915236, "policy_loss": -0.013055473367179124, "vf_loss": 1.7921633039290705, "vf_explained_var": 0.9925735823189219, "kl": 0.01665129102936286, "entropy": 1.0552371385196844, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -1.8424809609232335, "episode_reward_min": -1299.2949701895122, "episode_reward_mean": -560.2781293408242, "episode_len_mean": 127.41, "episode_media": {}, "episodes_timesteps_total": 12741, "policy_reward_min": {"policy_0": -1299.2949701895122}, "policy_reward_max": {"policy_0": -1.8424809609232335}, "policy_reward_mean": {"policy_0": -560.2781293408242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.01938496207623, -1227.5731892513277, -176.88441627525964, -394.3680517128324, -657.8658556541063, -502.4965642251502, -331.45037552320065, -642.772670472504, -158.34275329566054, -462.93310772491475, -135.461484835373, -611.3182637382316, -1299.2949701895122, -972.2947462336149, -95.77111260432363, -527.0764976179256, -1206.2512692902076, -863.4365312486083, -800.5077227885519, -614.2109409214862, -875.4308073914029, -470.0131637366636, -942.5062083037046, -581.7078512739279, -506.5550004962938, -356.49704657112983, -219.26979054914304, -461.3550684085202, -1005.5139770583049, -58.337753292730916, -473.45746082693074, -1053.3650961002559, -1207.0652219500048, -769.9934153544156, -738.6835218032882, -1.8424809609232335, -924.5172047757235, -668.6946594272259, -208.0810966418517, -941.7869756722536, -214.83889456472355, -437.33901588857776, -418.8096658626267, -136.84567373426327, -507.60878575131784, -236.39813540150166, -429.47567092961094, -801.7965401636317, -731.5383273381806, -773.3916690597925, -574.3114462730977, -52.65557769026475, -433.43286425552736, -560.1097036529238, -413.0346508120325, -588.1219526452434, -321.34535507228134, -751.7105519039128, -602.3190399221335, -1167.0278168178515, -151.60278183302174, -103.04719831306072, -1016.74342707431, -1152.150631189087, -511.4753980648276, -998.4759294899975, -507.1715990490842, -130.87964083365407, -373.4651752659497, -69.50530998583767, -194.15136426134677, -1111.253064509921, -415.80597189722687, -515.1414107466262, -928.0876324033239, -832.093190545812, -90.67110259113107, -175.6287849428518, -587.2770041487682, -42.55928637032652, -734.6903736748327, -317.86447581097167, -48.604500344985496, -776.8434008491738, -63.07454534027733, -656.6332928022255, -859.0133838280263, -396.19254059929995, -915.7834504982889, -447.0655119531796, -170.00921786818003, -798.3126303884987, -498.01896153787163, -833.2800805133459, -1106.503119332525, -874.7346887919535, -1137.427284603086, -550.8324296288372, -108.64418910457074, -322.98390619706817], "episode_lengths": [85, 150, 91, 150, 124, 150, 150, 150, 86, 150, 71, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 146, 150, 48, 150, 150, 150, 150, 136, 31, 150, 150, 97, 150, 93, 150, 150, 74, 128, 106, 150, 150, 150, 150, 150, 52, 104, 150, 150, 150, 115, 150, 150, 150, 81, 75, 150, 150, 150, 150, 136, 68, 110, 59, 80, 150, 95, 150, 150, 150, 73, 79, 150, 43, 150, 127, 52, 144, 55, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 69, 123], "policy_policy_0_reward": [-207.01938496207623, -1227.5731892513277, -176.88441627525964, -394.3680517128324, -657.8658556541063, -502.4965642251502, -331.45037552320065, -642.772670472504, -158.34275329566054, -462.93310772491475, -135.461484835373, -611.3182637382316, -1299.2949701895122, -972.2947462336149, -95.77111260432363, -527.0764976179256, -1206.2512692902076, -863.4365312486083, -800.5077227885519, -614.2109409214862, -875.4308073914029, -470.0131637366636, -942.5062083037046, -581.7078512739279, -506.5550004962938, -356.49704657112983, -219.26979054914304, -461.3550684085202, -1005.5139770583049, -58.337753292730916, -473.45746082693074, -1053.3650961002559, -1207.0652219500048, -769.9934153544156, -738.6835218032882, -1.8424809609232335, -924.5172047757235, -668.6946594272259, -208.0810966418517, -941.7869756722536, -214.83889456472355, -437.33901588857776, -418.8096658626267, -136.84567373426327, -507.60878575131784, -236.39813540150166, -429.47567092961094, -801.7965401636317, -731.5383273381806, -773.3916690597925, -574.3114462730977, -52.65557769026475, -433.43286425552736, -560.1097036529238, -413.0346508120325, -588.1219526452434, -321.34535507228134, -751.7105519039128, -602.3190399221335, -1167.0278168178515, -151.60278183302174, -103.04719831306072, -1016.74342707431, -1152.150631189087, -511.4753980648276, -998.4759294899975, -507.1715990490842, -130.87964083365407, -373.4651752659497, -69.50530998583767, -194.15136426134677, -1111.253064509921, -415.80597189722687, -515.1414107466262, -928.0876324033239, -832.093190545812, -90.67110259113107, -175.6287849428518, -587.2770041487682, -42.55928637032652, -734.6903736748327, -317.86447581097167, -48.604500344985496, -776.8434008491738, -63.07454534027733, -656.6332928022255, -859.0133838280263, -396.19254059929995, -915.7834504982889, -447.0655119531796, -170.00921786818003, -798.3126303884987, -498.01896153787163, -833.2800805133459, -1106.503119332525, -874.7346887919535, -1137.427284603086, -550.8324296288372, -108.64418910457074, -322.98390619706817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550136091039597, "mean_inference_ms": 1.7234131112114313, "mean_action_processing_ms": 0.27525914994434364, "mean_env_wait_ms": 3.3887446853488563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012766122817993164, "StateBufferConnector_ms": 0.008020639419555664, "ViewRequirementAgentConnector_ms": 0.19353795051574707}, "num_episodes": 27, "episode_return_max": -1.8424809609232335, "episode_return_min": -1299.2949701895122, "episode_return_mean": -560.2781293408242, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.11184752974464, "num_env_steps_trained_throughput_per_sec": 366.11184752974464, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12794.155, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12794.08, "sample_time_ms": 1144.305, "learn_time_ms": 11586.166, "learn_throughput": 345.239, "synch_weights_time_ms": 62.818}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "1e132_00001", "date": "2024-08-04_07-41-18", "timestamp": 1722737478, "time_this_iter_s": 10.938213109970093, "time_total_s": 501.06385469436646, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 501.06385469436646, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.84375, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.72761902411779, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.8957848315748076, "policy_loss": -0.010290029310272075, "vf_loss": 1.9003210611641408, "vf_explained_var": 0.9653943297142784, "kl": 0.013041950018062723, "entropy": 1.1507587067782878, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -1.8424809609232335, "episode_reward_min": -1167.0278168178515, "episode_reward_mean": -537.0237299932589, "episode_len_mean": 124.81, "episode_media": {}, "episodes_timesteps_total": 12481, "policy_reward_min": {"policy_0": -1167.0278168178515}, "policy_reward_max": {"policy_0": -1.8424809609232335}, "policy_reward_mean": {"policy_0": -537.0237299932589}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-769.9934153544156, -738.6835218032882, -1.8424809609232335, -924.5172047757235, -668.6946594272259, -208.0810966418517, -941.7869756722536, -214.83889456472355, -437.33901588857776, -418.8096658626267, -136.84567373426327, -507.60878575131784, -236.39813540150166, -429.47567092961094, -801.7965401636317, -731.5383273381806, -773.3916690597925, -574.3114462730977, -52.65557769026475, -433.43286425552736, -560.1097036529238, -413.0346508120325, -588.1219526452434, -321.34535507228134, -751.7105519039128, -602.3190399221335, -1167.0278168178515, -151.60278183302174, -103.04719831306072, -1016.74342707431, -1152.150631189087, -511.4753980648276, -998.4759294899975, -507.1715990490842, -130.87964083365407, -373.4651752659497, -69.50530998583767, -194.15136426134677, -1111.253064509921, -415.80597189722687, -515.1414107466262, -928.0876324033239, -832.093190545812, -90.67110259113107, -175.6287849428518, -587.2770041487682, -42.55928637032652, -734.6903736748327, -317.86447581097167, -48.604500344985496, -776.8434008491738, -63.07454534027733, -656.6332928022255, -859.0133838280263, -396.19254059929995, -915.7834504982889, -447.0655119531796, -170.00921786818003, -798.3126303884987, -498.01896153787163, -833.2800805133459, -1106.503119332525, -874.7346887919535, -1137.427284603086, -550.8324296288372, -108.64418910457074, -322.98390619706817, -754.9167365071519, -720.4598044792839, -643.3956183495293, -796.2564826468375, -541.1147127181682, -635.0108908856363, -29.838075003532087, -263.8797749027995, -412.97344799377726, -719.1120865160709, -620.763938384562, -992.8242725351531, -366.2583188797486, -314.30920331307885, -483.81348801417545, -169.00347788317856, -750.4076147540749, -733.5545406640516, -669.3269484714444, -752.7109636437068, -219.50935890803032, -766.381981219345, -309.17691099586506, -33.97086256961444, -991.0418308292253, -506.1353150543865, -653.932549981008, -148.689549904062, -636.1512756502566, -415.72456058863906, -493.8977768767994, -223.63677003544595, -1004.7852806087068], "episode_lengths": [150, 136, 31, 150, 150, 97, 150, 93, 150, 150, 74, 128, 106, 150, 150, 150, 150, 150, 52, 104, 150, 150, 150, 115, 150, 150, 150, 81, 75, 150, 150, 150, 150, 136, 68, 110, 59, 80, 150, 95, 150, 150, 150, 73, 79, 150, 43, 150, 127, 52, 144, 55, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 69, 123, 143, 150, 150, 150, 150, 150, 47, 103, 121, 150, 150, 150, 96, 88, 105, 59, 150, 128, 150, 150, 69, 150, 111, 45, 150, 150, 150, 77, 150, 150, 150, 90, 150], "policy_policy_0_reward": [-769.9934153544156, -738.6835218032882, -1.8424809609232335, -924.5172047757235, -668.6946594272259, -208.0810966418517, -941.7869756722536, -214.83889456472355, -437.33901588857776, -418.8096658626267, -136.84567373426327, -507.60878575131784, -236.39813540150166, -429.47567092961094, -801.7965401636317, -731.5383273381806, -773.3916690597925, -574.3114462730977, -52.65557769026475, -433.43286425552736, -560.1097036529238, -413.0346508120325, -588.1219526452434, -321.34535507228134, -751.7105519039128, -602.3190399221335, -1167.0278168178515, -151.60278183302174, -103.04719831306072, -1016.74342707431, -1152.150631189087, -511.4753980648276, -998.4759294899975, -507.1715990490842, -130.87964083365407, -373.4651752659497, -69.50530998583767, -194.15136426134677, -1111.253064509921, -415.80597189722687, -515.1414107466262, -928.0876324033239, -832.093190545812, -90.67110259113107, -175.6287849428518, -587.2770041487682, -42.55928637032652, -734.6903736748327, -317.86447581097167, -48.604500344985496, -776.8434008491738, -63.07454534027733, -656.6332928022255, -859.0133838280263, -396.19254059929995, -915.7834504982889, -447.0655119531796, -170.00921786818003, -798.3126303884987, -498.01896153787163, -833.2800805133459, -1106.503119332525, -874.7346887919535, -1137.427284603086, -550.8324296288372, -108.64418910457074, -322.98390619706817, -754.9167365071519, -720.4598044792839, -643.3956183495293, -796.2564826468375, -541.1147127181682, -635.0108908856363, -29.838075003532087, -263.8797749027995, -412.97344799377726, -719.1120865160709, -620.763938384562, -992.8242725351531, -366.2583188797486, -314.30920331307885, -483.81348801417545, -169.00347788317856, -750.4076147540749, -733.5545406640516, -669.3269484714444, -752.7109636437068, -219.50935890803032, -766.381981219345, -309.17691099586506, -33.97086256961444, -991.0418308292253, -506.1353150543865, -653.932549981008, -148.689549904062, -636.1512756502566, -415.72456058863906, -493.8977768767994, -223.63677003544595, -1004.7852806087068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555182166793267, "mean_inference_ms": 1.7219447073726082, "mean_action_processing_ms": 0.27522822997707835, "mean_env_wait_ms": 3.388940426372666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012532472610473633, "StateBufferConnector_ms": 0.008100271224975586, "ViewRequirementAgentConnector_ms": 0.1951451301574707}, "num_episodes": 33, "episode_return_max": -1.8424809609232335, "episode_return_min": -1167.0278168178515, "episode_return_mean": -537.0237299932589, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 367.98215284312727, "num_env_steps_trained_throughput_per_sec": 367.98215284312727, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12565.209, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12565.135, "sample_time_ms": 1111.067, "learn_time_ms": 11390.735, "learn_throughput": 351.163, "synch_weights_time_ms": 62.535}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "1e132_00001", "date": "2024-08-04_07-41-29", "timestamp": 1722737489, "time_this_iter_s": 10.882497072219849, "time_total_s": 511.9463517665863, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996512d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 511.9463517665863, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 19.46, "ram_util_percent": 28.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.43402418891588, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.024051829241216, "policy_loss": -0.014252223609461604, "vf_loss": 2.031571425807973, "vf_explained_var": 0.9913007178654273, "kl": 0.015228939083014413, "entropy": 1.2038931756590803, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -29.838075003532087, "episode_reward_min": -1394.9295090444546, "episode_reward_mean": -524.1870537770325, "episode_len_mean": 123.31, "episode_media": {}, "episodes_timesteps_total": 12331, "policy_reward_min": {"policy_0": -1394.9295090444546}, "policy_reward_max": {"policy_0": -29.838075003532087}, "policy_reward_mean": {"policy_0": -524.1870537770325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1152.150631189087, -511.4753980648276, -998.4759294899975, -507.1715990490842, -130.87964083365407, -373.4651752659497, -69.50530998583767, -194.15136426134677, -1111.253064509921, -415.80597189722687, -515.1414107466262, -928.0876324033239, -832.093190545812, -90.67110259113107, -175.6287849428518, -587.2770041487682, -42.55928637032652, -734.6903736748327, -317.86447581097167, -48.604500344985496, -776.8434008491738, -63.07454534027733, -656.6332928022255, -859.0133838280263, -396.19254059929995, -915.7834504982889, -447.0655119531796, -170.00921786818003, -798.3126303884987, -498.01896153787163, -833.2800805133459, -1106.503119332525, -874.7346887919535, -1137.427284603086, -550.8324296288372, -108.64418910457074, -322.98390619706817, -754.9167365071519, -720.4598044792839, -643.3956183495293, -796.2564826468375, -541.1147127181682, -635.0108908856363, -29.838075003532087, -263.8797749027995, -412.97344799377726, -719.1120865160709, -620.763938384562, -992.8242725351531, -366.2583188797486, -314.30920331307885, -483.81348801417545, -169.00347788317856, -750.4076147540749, -733.5545406640516, -669.3269484714444, -752.7109636437068, -219.50935890803032, -766.381981219345, -309.17691099586506, -33.97086256961444, -991.0418308292253, -506.1353150543865, -653.932549981008, -148.689549904062, -636.1512756502566, -415.72456058863906, -493.8977768767994, -223.63677003544595, -1004.7852806087068, -994.6461466658035, -75.79159966191173, -331.3105169832306, -488.8455519054859, -1394.9295090444546, -1071.9559211303604, -185.49394321395442, -890.6663591855163, -61.00726076451521, -250.03602114396534, -335.8764924060897, -90.36104493731004, -384.2764391644147, -302.85705551230046, -403.1357105370038, -371.41939963565716, -40.58223417054857, -398.71741339925404, -568.2239286470262, -160.96677389996668, -867.952379517284, -1007.013783874946, -410.5468879325332, -568.9301032204827, -871.7039080276824, -62.89049827618557, -111.78855090999127, -324.8695995609621, -594.5149296554565, -772.1265149886298], "episode_lengths": [150, 150, 150, 136, 68, 110, 59, 80, 150, 95, 150, 150, 150, 73, 79, 150, 43, 150, 127, 52, 144, 55, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 69, 123, 143, 150, 150, 150, 150, 150, 47, 103, 121, 150, 150, 150, 96, 88, 105, 59, 150, 128, 150, 150, 69, 150, 111, 45, 150, 150, 150, 77, 150, 150, 150, 90, 150, 150, 65, 106, 150, 150, 150, 78, 150, 52, 98, 134, 64, 133, 123, 148, 150, 50, 136, 150, 75, 150, 150, 150, 150, 150, 61, 69, 150, 150, 150], "policy_policy_0_reward": [-1152.150631189087, -511.4753980648276, -998.4759294899975, -507.1715990490842, -130.87964083365407, -373.4651752659497, -69.50530998583767, -194.15136426134677, -1111.253064509921, -415.80597189722687, -515.1414107466262, -928.0876324033239, -832.093190545812, -90.67110259113107, -175.6287849428518, -587.2770041487682, -42.55928637032652, -734.6903736748327, -317.86447581097167, -48.604500344985496, -776.8434008491738, -63.07454534027733, -656.6332928022255, -859.0133838280263, -396.19254059929995, -915.7834504982889, -447.0655119531796, -170.00921786818003, -798.3126303884987, -498.01896153787163, -833.2800805133459, -1106.503119332525, -874.7346887919535, -1137.427284603086, -550.8324296288372, -108.64418910457074, -322.98390619706817, -754.9167365071519, -720.4598044792839, -643.3956183495293, -796.2564826468375, -541.1147127181682, -635.0108908856363, -29.838075003532087, -263.8797749027995, -412.97344799377726, -719.1120865160709, -620.763938384562, -992.8242725351531, -366.2583188797486, -314.30920331307885, -483.81348801417545, -169.00347788317856, -750.4076147540749, -733.5545406640516, -669.3269484714444, -752.7109636437068, -219.50935890803032, -766.381981219345, -309.17691099586506, -33.97086256961444, -991.0418308292253, -506.1353150543865, -653.932549981008, -148.689549904062, -636.1512756502566, -415.72456058863906, -493.8977768767994, -223.63677003544595, -1004.7852806087068, -994.6461466658035, -75.79159966191173, -331.3105169832306, -488.8455519054859, -1394.9295090444546, -1071.9559211303604, -185.49394321395442, -890.6663591855163, -61.00726076451521, -250.03602114396534, -335.8764924060897, -90.36104493731004, -384.2764391644147, -302.85705551230046, -403.1357105370038, -371.41939963565716, -40.58223417054857, -398.71741339925404, -568.2239286470262, -160.96677389996668, -867.952379517284, -1007.013783874946, -410.5468879325332, -568.9301032204827, -871.7039080276824, -62.89049827618557, -111.78855090999127, -324.8695995609621, -594.5149296554565, -772.1265149886298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552533379827502, "mean_inference_ms": 1.7194289438356136, "mean_action_processing_ms": 0.27496763026097076, "mean_env_wait_ms": 3.3885269599884698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012360811233520508, "StateBufferConnector_ms": 0.008052587509155273, "ViewRequirementAgentConnector_ms": 0.19517302513122559}, "num_episodes": 30, "episode_return_max": -29.838075003532087, "episode_return_min": -1394.9295090444546, "episode_return_mean": -524.1870537770325, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.6076968298331, "num_env_steps_trained_throughput_per_sec": 403.6076968298331, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12260.447, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12260.376, "sample_time_ms": 1110.425, "learn_time_ms": 11088.229, "learn_throughput": 360.743, "synch_weights_time_ms": 60.931}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "1e132_00001", "date": "2024-08-04_07-41-39", "timestamp": 1722737499, "time_this_iter_s": 9.922533750534058, "time_total_s": 521.8688855171204, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 521.8688855171204, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 19.419999999999998, "ram_util_percent": 28.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.1906048019727, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.8768857269858321, "policy_loss": -0.009812632180789175, "vf_loss": 1.879537207260728, "vf_explained_var": 0.9857310077175498, "kl": 0.016151626482314937, "entropy": 1.0707871820156774, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -27.523530314907084, "episode_reward_min": -1394.9295090444546, "episode_reward_mean": -493.8469114918418, "episode_len_mean": 121.96, "episode_media": {}, "episodes_timesteps_total": 12196, "policy_reward_min": {"policy_0": -1394.9295090444546}, "policy_reward_max": {"policy_0": -27.523530314907084}, "policy_reward_mean": {"policy_0": -493.8469114918418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.64418910457074, -322.98390619706817, -754.9167365071519, -720.4598044792839, -643.3956183495293, -796.2564826468375, -541.1147127181682, -635.0108908856363, -29.838075003532087, -263.8797749027995, -412.97344799377726, -719.1120865160709, -620.763938384562, -992.8242725351531, -366.2583188797486, -314.30920331307885, -483.81348801417545, -169.00347788317856, -750.4076147540749, -733.5545406640516, -669.3269484714444, -752.7109636437068, -219.50935890803032, -766.381981219345, -309.17691099586506, -33.97086256961444, -991.0418308292253, -506.1353150543865, -653.932549981008, -148.689549904062, -636.1512756502566, -415.72456058863906, -493.8977768767994, -223.63677003544595, -1004.7852806087068, -994.6461466658035, -75.79159966191173, -331.3105169832306, -488.8455519054859, -1394.9295090444546, -1071.9559211303604, -185.49394321395442, -890.6663591855163, -61.00726076451521, -250.03602114396534, -335.8764924060897, -90.36104493731004, -384.2764391644147, -302.85705551230046, -403.1357105370038, -371.41939963565716, -40.58223417054857, -398.71741339925404, -568.2239286470262, -160.96677389996668, -867.952379517284, -1007.013783874946, -410.5468879325332, -568.9301032204827, -871.7039080276824, -62.89049827618557, -111.78855090999127, -324.8695995609621, -594.5149296554565, -772.1265149886298, -798.8582293221677, -143.61596996586684, -470.9171058002269, -470.4873996559181, -789.9266660204967, -191.08593561576765, -385.10414607198356, -35.35922403209169, -617.5835820421354, -52.4287278356439, -993.8237537219853, -237.36499587947787, -452.7588653001891, -1066.5887866217936, -217.86461418659636, -109.99573769137788, -377.7433526975418, -663.5624413891218, -1131.8390036786836, -409.19489957598853, -783.1363616347132, -398.5145588783423, -510.01001508457074, -27.523530314907084, -1100.4564809589697, -571.2925958561001, -656.0787254596834, -85.20864957449963, -833.359956477398, -139.78983835633855, -380.0363147590591, -624.3584990857199, -416.1795716799589, -50.50148655409855, -594.1121343628565], "episode_lengths": [69, 123, 143, 150, 150, 150, 150, 150, 47, 103, 121, 150, 150, 150, 96, 88, 105, 59, 150, 128, 150, 150, 69, 150, 111, 45, 150, 150, 150, 77, 150, 150, 150, 90, 150, 150, 65, 106, 150, 150, 150, 78, 150, 52, 98, 134, 64, 133, 123, 148, 150, 50, 136, 150, 75, 150, 150, 150, 150, 150, 61, 69, 150, 150, 150, 150, 73, 150, 100, 143, 85, 146, 58, 150, 64, 150, 130, 150, 150, 68, 63, 150, 150, 150, 150, 150, 113, 150, 40, 150, 150, 150, 62, 150, 67, 113, 150, 150, 55, 150], "policy_policy_0_reward": [-108.64418910457074, -322.98390619706817, -754.9167365071519, -720.4598044792839, -643.3956183495293, -796.2564826468375, -541.1147127181682, -635.0108908856363, -29.838075003532087, -263.8797749027995, -412.97344799377726, -719.1120865160709, -620.763938384562, -992.8242725351531, -366.2583188797486, -314.30920331307885, -483.81348801417545, -169.00347788317856, -750.4076147540749, -733.5545406640516, -669.3269484714444, -752.7109636437068, -219.50935890803032, -766.381981219345, -309.17691099586506, -33.97086256961444, -991.0418308292253, -506.1353150543865, -653.932549981008, -148.689549904062, -636.1512756502566, -415.72456058863906, -493.8977768767994, -223.63677003544595, -1004.7852806087068, -994.6461466658035, -75.79159966191173, -331.3105169832306, -488.8455519054859, -1394.9295090444546, -1071.9559211303604, -185.49394321395442, -890.6663591855163, -61.00726076451521, -250.03602114396534, -335.8764924060897, -90.36104493731004, -384.2764391644147, -302.85705551230046, -403.1357105370038, -371.41939963565716, -40.58223417054857, -398.71741339925404, -568.2239286470262, -160.96677389996668, -867.952379517284, -1007.013783874946, -410.5468879325332, -568.9301032204827, -871.7039080276824, -62.89049827618557, -111.78855090999127, -324.8695995609621, -594.5149296554565, -772.1265149886298, -798.8582293221677, -143.61596996586684, -470.9171058002269, -470.4873996559181, -789.9266660204967, -191.08593561576765, -385.10414607198356, -35.35922403209169, -617.5835820421354, -52.4287278356439, -993.8237537219853, -237.36499587947787, -452.7588653001891, -1066.5887866217936, -217.86461418659636, -109.99573769137788, -377.7433526975418, -663.5624413891218, -1131.8390036786836, -409.19489957598853, -783.1363616347132, -398.5145588783423, -510.01001508457074, -27.523530314907084, -1100.4564809589697, -571.2925958561001, -656.0787254596834, -85.20864957449963, -833.359956477398, -139.78983835633855, -380.0363147590591, -624.3584990857199, -416.1795716799589, -50.50148655409855, -594.1121343628565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558760665539729, "mean_inference_ms": 1.719750697908503, "mean_action_processing_ms": 0.27505208265880726, "mean_env_wait_ms": 3.390652787700595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181758880615234, "StateBufferConnector_ms": 0.008165359497070312, "ViewRequirementAgentConnector_ms": 0.1975722312927246}, "num_episodes": 35, "episode_return_max": -27.523530314907084, "episode_return_min": -1394.9295090444546, "episode_return_mean": -493.8469114918418, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.0659354290874, "num_env_steps_trained_throughput_per_sec": 310.0659354290874, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12253.8, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12253.729, "sample_time_ms": 1109.87, "learn_time_ms": 11082.628, "learn_throughput": 360.925, "synch_weights_time_ms": 60.429}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "1e132_00001", "date": "2024-08-04_07-41-52", "timestamp": 1722737512, "time_this_iter_s": 12.913069486618042, "time_total_s": 534.7819550037384, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d854488430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 534.7819550037384, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.816666666666666, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.95287364423275, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.7536373579253752, "policy_loss": -0.014443543515759908, "vf_loss": 1.7612272210108737, "vf_explained_var": 0.9873252298682929, "kl": 0.015482343007897767, "entropy": 1.1337421574940285, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -27.523530314907084, "episode_reward_min": -1394.9295090444546, "episode_reward_mean": -492.3398584340176, "episode_len_mean": 120.58, "episode_media": {}, "episodes_timesteps_total": 12058, "policy_reward_min": {"policy_0": -1394.9295090444546}, "policy_reward_max": {"policy_0": -27.523530314907084}, "policy_reward_mean": {"policy_0": -492.3398584340176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-223.63677003544595, -1004.7852806087068, -994.6461466658035, -75.79159966191173, -331.3105169832306, -488.8455519054859, -1394.9295090444546, -1071.9559211303604, -185.49394321395442, -890.6663591855163, -61.00726076451521, -250.03602114396534, -335.8764924060897, -90.36104493731004, -384.2764391644147, -302.85705551230046, -403.1357105370038, -371.41939963565716, -40.58223417054857, -398.71741339925404, -568.2239286470262, -160.96677389996668, -867.952379517284, -1007.013783874946, -410.5468879325332, -568.9301032204827, -871.7039080276824, -62.89049827618557, -111.78855090999127, -324.8695995609621, -594.5149296554565, -772.1265149886298, -798.8582293221677, -143.61596996586684, -470.9171058002269, -470.4873996559181, -789.9266660204967, -191.08593561576765, -385.10414607198356, -35.35922403209169, -617.5835820421354, -52.4287278356439, -993.8237537219853, -237.36499587947787, -452.7588653001891, -1066.5887866217936, -217.86461418659636, -109.99573769137788, -377.7433526975418, -663.5624413891218, -1131.8390036786836, -409.19489957598853, -783.1363616347132, -398.5145588783423, -510.01001508457074, -27.523530314907084, -1100.4564809589697, -571.2925958561001, -656.0787254596834, -85.20864957449963, -833.359956477398, -139.78983835633855, -380.0363147590591, -624.3584990857199, -416.1795716799589, -50.50148655409855, -594.1121343628565, -458.0698088128925, -1238.768058730082, -51.60761106437961, -980.4430691828279, -829.9991162823515, -118.45155511528496, -680.7668524487997, -358.59829524557597, -140.38645924994603, -460.34077301214916, -468.27376555940157, -628.9861878568346, -47.89059379874033, -921.6649470219917, -895.6950694746123, -541.1381615935406, -632.5282313820165, -95.00210971836725, -112.09775393491469, -1062.6170137248812, -207.97445510378034, -474.01741939839275, -93.39594872613124, -320.0969289467056, -440.38698051678904, -880.0972842848231, -1050.9831624939034, -364.4076046259912, -364.385130897733, -114.8305502371719, -329.78367576911364, -100.20328172275902, -1361.5773027095292], "episode_lengths": [90, 150, 150, 65, 106, 150, 150, 150, 78, 150, 52, 98, 134, 64, 133, 123, 148, 150, 50, 136, 150, 75, 150, 150, 150, 150, 150, 61, 69, 150, 150, 150, 150, 73, 150, 100, 143, 85, 146, 58, 150, 64, 150, 130, 150, 150, 68, 63, 150, 150, 150, 150, 150, 113, 150, 40, 150, 150, 150, 62, 150, 67, 113, 150, 150, 55, 150, 144, 150, 48, 150, 150, 74, 150, 150, 75, 150, 150, 150, 48, 150, 150, 150, 123, 61, 70, 150, 83, 150, 72, 86, 150, 150, 150, 150, 150, 68, 93, 51, 150], "policy_policy_0_reward": [-223.63677003544595, -1004.7852806087068, -994.6461466658035, -75.79159966191173, -331.3105169832306, -488.8455519054859, -1394.9295090444546, -1071.9559211303604, -185.49394321395442, -890.6663591855163, -61.00726076451521, -250.03602114396534, -335.8764924060897, -90.36104493731004, -384.2764391644147, -302.85705551230046, -403.1357105370038, -371.41939963565716, -40.58223417054857, -398.71741339925404, -568.2239286470262, -160.96677389996668, -867.952379517284, -1007.013783874946, -410.5468879325332, -568.9301032204827, -871.7039080276824, -62.89049827618557, -111.78855090999127, -324.8695995609621, -594.5149296554565, -772.1265149886298, -798.8582293221677, -143.61596996586684, -470.9171058002269, -470.4873996559181, -789.9266660204967, -191.08593561576765, -385.10414607198356, -35.35922403209169, -617.5835820421354, -52.4287278356439, -993.8237537219853, -237.36499587947787, -452.7588653001891, -1066.5887866217936, -217.86461418659636, -109.99573769137788, -377.7433526975418, -663.5624413891218, -1131.8390036786836, -409.19489957598853, -783.1363616347132, -398.5145588783423, -510.01001508457074, -27.523530314907084, -1100.4564809589697, -571.2925958561001, -656.0787254596834, -85.20864957449963, -833.359956477398, -139.78983835633855, -380.0363147590591, -624.3584990857199, -416.1795716799589, -50.50148655409855, -594.1121343628565, -458.0698088128925, -1238.768058730082, -51.60761106437961, -980.4430691828279, -829.9991162823515, -118.45155511528496, -680.7668524487997, -358.59829524557597, -140.38645924994603, -460.34077301214916, -468.27376555940157, -628.9861878568346, -47.89059379874033, -921.6649470219917, -895.6950694746123, -541.1381615935406, -632.5282313820165, -95.00210971836725, -112.09775393491469, -1062.6170137248812, -207.97445510378034, -474.01741939839275, -93.39594872613124, -320.0969289467056, -440.38698051678904, -880.0972842848231, -1050.9831624939034, -364.4076046259912, -364.385130897733, -114.8305502371719, -329.78367576911364, -100.20328172275902, -1361.5773027095292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556262136188713, "mean_inference_ms": 1.7186567215208688, "mean_action_processing_ms": 0.2751498321603954, "mean_env_wait_ms": 3.3912308099755317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012086153030395508, "StateBufferConnector_ms": 0.008055686950683594, "ViewRequirementAgentConnector_ms": 0.19980454444885254}, "num_episodes": 33, "episode_return_max": -27.523530314907084, "episode_return_min": -1394.9295090444546, "episode_return_mean": -492.3398584340176, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.94544671450063, "num_env_steps_trained_throughput_per_sec": 315.94544671450063, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12172.402, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12172.331, "sample_time_ms": 1117.392, "learn_time_ms": 10994.575, "learn_throughput": 363.816, "synch_weights_time_ms": 59.56}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "1e132_00001", "date": "2024-08-04_07-42-05", "timestamp": 1722737525, "time_this_iter_s": 12.67163372039795, "time_total_s": 547.4535887241364, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544892d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 547.4535887241364, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.022222222222222, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.0134959856669, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.523297463481625, "policy_loss": -0.009528955597003612, "vf_loss": 1.525823210986952, "vf_explained_var": 0.9899967877815167, "kl": 0.015815017178708077, "entropy": 1.1355084062864382, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -13.559189046146093, "episode_reward_min": -1361.5773027095292, "episode_reward_mean": -487.13433078643817, "episode_len_mean": 118.36, "episode_media": {}, "episodes_timesteps_total": 11836, "policy_reward_min": {"policy_0": -1361.5773027095292}, "policy_reward_max": {"policy_0": -13.559189046146093}, "policy_reward_mean": {"policy_0": -487.13433078643817}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.08593561576765, -385.10414607198356, -35.35922403209169, -617.5835820421354, -52.4287278356439, -993.8237537219853, -237.36499587947787, -452.7588653001891, -1066.5887866217936, -217.86461418659636, -109.99573769137788, -377.7433526975418, -663.5624413891218, -1131.8390036786836, -409.19489957598853, -783.1363616347132, -398.5145588783423, -510.01001508457074, -27.523530314907084, -1100.4564809589697, -571.2925958561001, -656.0787254596834, -85.20864957449963, -833.359956477398, -139.78983835633855, -380.0363147590591, -624.3584990857199, -416.1795716799589, -50.50148655409855, -594.1121343628565, -458.0698088128925, -1238.768058730082, -51.60761106437961, -980.4430691828279, -829.9991162823515, -118.45155511528496, -680.7668524487997, -358.59829524557597, -140.38645924994603, -460.34077301214916, -468.27376555940157, -628.9861878568346, -47.89059379874033, -921.6649470219917, -895.6950694746123, -541.1381615935406, -632.5282313820165, -95.00210971836725, -112.09775393491469, -1062.6170137248812, -207.97445510378034, -474.01741939839275, -93.39594872613124, -320.0969289467056, -440.38698051678904, -880.0972842848231, -1050.9831624939034, -364.4076046259912, -364.385130897733, -114.8305502371719, -329.78367576911364, -100.20328172275902, -1361.5773027095292, -785.7099468901666, -359.57380608844556, -35.94207635497542, -412.0480627430007, -518.9498051010916, -318.55606957261483, -1227.9485195532118, -408.0661908904117, -714.5108258964895, -168.79589031605852, -1025.8693020716307, -107.61476268396174, -622.4922742788397, -460.2187980972842, -711.2462829692258, -1009.5564979651839, -738.9686107708834, -587.8522923094313, -151.74419428474948, -307.6812657939316, -526.0434617510051, -75.26426902798688, -65.14957048178663, -554.3669125567453, -500.2905008699175, -328.6479427801745, -1304.77174542215, -145.7606428723665, -316.2616991087331, -95.21101963765278, -298.9830792942274, -139.29414751652067, -13.559189046146093, -172.04354501115787, -866.561610639597, -541.500542170562, -1158.0557818054874], "episode_lengths": [85, 146, 58, 150, 64, 150, 130, 150, 150, 68, 63, 150, 150, 150, 150, 150, 113, 150, 40, 150, 150, 150, 62, 150, 67, 113, 150, 150, 55, 150, 144, 150, 48, 150, 150, 74, 150, 150, 75, 150, 150, 150, 48, 150, 150, 150, 123, 61, 70, 150, 83, 150, 72, 86, 150, 150, 150, 150, 150, 68, 93, 51, 150, 150, 150, 43, 150, 119, 103, 150, 92, 150, 87, 150, 81, 150, 150, 150, 150, 150, 139, 83, 100, 150, 56, 55, 150, 150, 133, 150, 76, 85, 69, 114, 74, 40, 61, 150, 116, 150], "policy_policy_0_reward": [-191.08593561576765, -385.10414607198356, -35.35922403209169, -617.5835820421354, -52.4287278356439, -993.8237537219853, -237.36499587947787, -452.7588653001891, -1066.5887866217936, -217.86461418659636, -109.99573769137788, -377.7433526975418, -663.5624413891218, -1131.8390036786836, -409.19489957598853, -783.1363616347132, -398.5145588783423, -510.01001508457074, -27.523530314907084, -1100.4564809589697, -571.2925958561001, -656.0787254596834, -85.20864957449963, -833.359956477398, -139.78983835633855, -380.0363147590591, -624.3584990857199, -416.1795716799589, -50.50148655409855, -594.1121343628565, -458.0698088128925, -1238.768058730082, -51.60761106437961, -980.4430691828279, -829.9991162823515, -118.45155511528496, -680.7668524487997, -358.59829524557597, -140.38645924994603, -460.34077301214916, -468.27376555940157, -628.9861878568346, -47.89059379874033, -921.6649470219917, -895.6950694746123, -541.1381615935406, -632.5282313820165, -95.00210971836725, -112.09775393491469, -1062.6170137248812, -207.97445510378034, -474.01741939839275, -93.39594872613124, -320.0969289467056, -440.38698051678904, -880.0972842848231, -1050.9831624939034, -364.4076046259912, -364.385130897733, -114.8305502371719, -329.78367576911364, -100.20328172275902, -1361.5773027095292, -785.7099468901666, -359.57380608844556, -35.94207635497542, -412.0480627430007, -518.9498051010916, -318.55606957261483, -1227.9485195532118, -408.0661908904117, -714.5108258964895, -168.79589031605852, -1025.8693020716307, -107.61476268396174, -622.4922742788397, -460.2187980972842, -711.2462829692258, -1009.5564979651839, -738.9686107708834, -587.8522923094313, -151.74419428474948, -307.6812657939316, -526.0434617510051, -75.26426902798688, -65.14957048178663, -554.3669125567453, -500.2905008699175, -328.6479427801745, -1304.77174542215, -145.7606428723665, -316.2616991087331, -95.21101963765278, -298.9830792942274, -139.29414751652067, -13.559189046146093, -172.04354501115787, -866.561610639597, -541.500542170562, -1158.0557818054874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558095529792971, "mean_inference_ms": 1.7181299361564428, "mean_action_processing_ms": 0.27549757478031195, "mean_env_wait_ms": 3.391921464347454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012125968933105469, "StateBufferConnector_ms": 0.00804448127746582, "ViewRequirementAgentConnector_ms": 0.19893503189086914}, "num_episodes": 37, "episode_return_max": -13.559189046146093, "episode_return_min": -1361.5773027095292, "episode_return_mean": -487.13433078643817, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.40638351869694, "num_env_steps_trained_throughput_per_sec": 440.40638351869694, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 11815.352, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11815.281, "sample_time_ms": 1116.756, "learn_time_ms": 10638.531, "learn_throughput": 375.992, "synch_weights_time_ms": 59.19}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "1e132_00001", "date": "2024-08-04_07-42-14", "timestamp": 1722737534, "time_this_iter_s": 9.094909191131592, "time_total_s": 556.548497915268, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 556.548497915268, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 20.453846153846158, "ram_util_percent": 28.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.87573142846426, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.59855964994058, "policy_loss": -0.006463586584141012, "vf_loss": 1.5970302905887366, "vf_explained_var": 0.99310500168552, "kl": 0.018040963971361686, "entropy": 1.2549210420499246, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -13.559189046146093, "episode_reward_min": -1405.0039763295804, "episode_reward_mean": -551.3348014121875, "episode_len_mean": 122.46, "episode_media": {}, "episodes_timesteps_total": 12246, "policy_reward_min": {"policy_0": -1405.0039763295804}, "policy_reward_max": {"policy_0": -13.559189046146093}, "policy_reward_mean": {"policy_0": -551.3348014121875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-458.0698088128925, -1238.768058730082, -51.60761106437961, -980.4430691828279, -829.9991162823515, -118.45155511528496, -680.7668524487997, -358.59829524557597, -140.38645924994603, -460.34077301214916, -468.27376555940157, -628.9861878568346, -47.89059379874033, -921.6649470219917, -895.6950694746123, -541.1381615935406, -632.5282313820165, -95.00210971836725, -112.09775393491469, -1062.6170137248812, -207.97445510378034, -474.01741939839275, -93.39594872613124, -320.0969289467056, -440.38698051678904, -880.0972842848231, -1050.9831624939034, -364.4076046259912, -364.385130897733, -114.8305502371719, -329.78367576911364, -100.20328172275902, -1361.5773027095292, -785.7099468901666, -359.57380608844556, -35.94207635497542, -412.0480627430007, -518.9498051010916, -318.55606957261483, -1227.9485195532118, -408.0661908904117, -714.5108258964895, -168.79589031605852, -1025.8693020716307, -107.61476268396174, -622.4922742788397, -460.2187980972842, -711.2462829692258, -1009.5564979651839, -738.9686107708834, -587.8522923094313, -151.74419428474948, -307.6812657939316, -526.0434617510051, -75.26426902798688, -65.14957048178663, -554.3669125567453, -500.2905008699175, -328.6479427801745, -1304.77174542215, -145.7606428723665, -316.2616991087331, -95.21101963765278, -298.9830792942274, -139.29414751652067, -13.559189046146093, -172.04354501115787, -866.561610639597, -541.500542170562, -1158.0557818054874, -1036.8177909214915, -111.32388220813795, -730.4389837829773, -528.1762956663947, -634.1128831468993, -841.1588760157232, -1374.1390345183563, -125.93635011547333, -977.5105688374883, -502.55378112842794, -589.090863502299, -318.4433206899165, -864.4160649201168, -1405.0039763295804, -283.1875377790301, -134.69524573395074, -958.3542109328333, -1273.246945020323, -498.46077650150386, -712.0525436970242, -32.18752885730221, -974.7613859739796, -146.55297825342006, -635.1524799670894, -518.7261923512411, -681.8929231886657, -1293.4620442309956, -899.8838502911706, -903.4026310253952, -547.7619023653251], "episode_lengths": [144, 150, 48, 150, 150, 74, 150, 150, 75, 150, 150, 150, 48, 150, 150, 150, 123, 61, 70, 150, 83, 150, 72, 86, 150, 150, 150, 150, 150, 68, 93, 51, 150, 150, 150, 43, 150, 119, 103, 150, 92, 150, 87, 150, 81, 150, 150, 150, 150, 150, 139, 83, 100, 150, 56, 55, 150, 150, 133, 150, 76, 85, 69, 114, 74, 40, 61, 150, 116, 150, 150, 73, 150, 150, 150, 150, 150, 71, 150, 150, 150, 97, 150, 150, 150, 87, 150, 150, 114, 150, 51, 150, 81, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-458.0698088128925, -1238.768058730082, -51.60761106437961, -980.4430691828279, -829.9991162823515, -118.45155511528496, -680.7668524487997, -358.59829524557597, -140.38645924994603, -460.34077301214916, -468.27376555940157, -628.9861878568346, -47.89059379874033, -921.6649470219917, -895.6950694746123, -541.1381615935406, -632.5282313820165, -95.00210971836725, -112.09775393491469, -1062.6170137248812, -207.97445510378034, -474.01741939839275, -93.39594872613124, -320.0969289467056, -440.38698051678904, -880.0972842848231, -1050.9831624939034, -364.4076046259912, -364.385130897733, -114.8305502371719, -329.78367576911364, -100.20328172275902, -1361.5773027095292, -785.7099468901666, -359.57380608844556, -35.94207635497542, -412.0480627430007, -518.9498051010916, -318.55606957261483, -1227.9485195532118, -408.0661908904117, -714.5108258964895, -168.79589031605852, -1025.8693020716307, -107.61476268396174, -622.4922742788397, -460.2187980972842, -711.2462829692258, -1009.5564979651839, -738.9686107708834, -587.8522923094313, -151.74419428474948, -307.6812657939316, -526.0434617510051, -75.26426902798688, -65.14957048178663, -554.3669125567453, -500.2905008699175, -328.6479427801745, -1304.77174542215, -145.7606428723665, -316.2616991087331, -95.21101963765278, -298.9830792942274, -139.29414751652067, -13.559189046146093, -172.04354501115787, -866.561610639597, -541.500542170562, -1158.0557818054874, -1036.8177909214915, -111.32388220813795, -730.4389837829773, -528.1762956663947, -634.1128831468993, -841.1588760157232, -1374.1390345183563, -125.93635011547333, -977.5105688374883, -502.55378112842794, -589.090863502299, -318.4433206899165, -864.4160649201168, -1405.0039763295804, -283.1875377790301, -134.69524573395074, -958.3542109328333, -1273.246945020323, -498.46077650150386, -712.0525436970242, -32.18752885730221, -974.7613859739796, -146.55297825342006, -635.1524799670894, -518.7261923512411, -681.8929231886657, -1293.4620442309956, -899.8838502911706, -903.4026310253952, -547.7619023653251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555651137727695, "mean_inference_ms": 1.7172699267936478, "mean_action_processing_ms": 0.2754539223475798, "mean_env_wait_ms": 3.3923047992737465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01197361946105957, "StateBufferConnector_ms": 0.007929801940917969, "ViewRequirementAgentConnector_ms": 0.20250606536865234}, "num_episodes": 30, "episode_return_max": -13.559189046146093, "episode_return_min": -1405.0039763295804, "episode_return_mean": -551.3348014121875, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.62629772013014, "num_env_steps_trained_throughput_per_sec": 303.62629772013014, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 11831.441, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11831.37, "sample_time_ms": 1129.55, "learn_time_ms": 10642.056, "learn_throughput": 375.867, "synch_weights_time_ms": 58.966}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "1e132_00001", "date": "2024-08-04_07-42-27", "timestamp": 1722737547, "time_this_iter_s": 13.187637329101562, "time_total_s": 569.7361352443695, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a5870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 569.7361352443695, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.705263157894738, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.43390530347824, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.7621867308703563, "policy_loss": -0.005914654747660582, "vf_loss": 1.7624732642744978, "vf_explained_var": 0.982831446826458, "kl": 0.012817987649395946, "entropy": 1.3997287787497044, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -13.559189046146093, "episode_reward_min": -1405.0039763295804, "episode_reward_mean": -588.0228809356119, "episode_len_mean": 125.47, "episode_media": {}, "episodes_timesteps_total": 12547, "policy_reward_min": {"policy_0": -1405.0039763295804}, "policy_reward_max": {"policy_0": -13.559189046146093}, "policy_reward_mean": {"policy_0": -588.0228809356119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.78367576911364, -100.20328172275902, -1361.5773027095292, -785.7099468901666, -359.57380608844556, -35.94207635497542, -412.0480627430007, -518.9498051010916, -318.55606957261483, -1227.9485195532118, -408.0661908904117, -714.5108258964895, -168.79589031605852, -1025.8693020716307, -107.61476268396174, -622.4922742788397, -460.2187980972842, -711.2462829692258, -1009.5564979651839, -738.9686107708834, -587.8522923094313, -151.74419428474948, -307.6812657939316, -526.0434617510051, -75.26426902798688, -65.14957048178663, -554.3669125567453, -500.2905008699175, -328.6479427801745, -1304.77174542215, -145.7606428723665, -316.2616991087331, -95.21101963765278, -298.9830792942274, -139.29414751652067, -13.559189046146093, -172.04354501115787, -866.561610639597, -541.500542170562, -1158.0557818054874, -1036.8177909214915, -111.32388220813795, -730.4389837829773, -528.1762956663947, -634.1128831468993, -841.1588760157232, -1374.1390345183563, -125.93635011547333, -977.5105688374883, -502.55378112842794, -589.090863502299, -318.4433206899165, -864.4160649201168, -1405.0039763295804, -283.1875377790301, -134.69524573395074, -958.3542109328333, -1273.246945020323, -498.46077650150386, -712.0525436970242, -32.18752885730221, -974.7613859739796, -146.55297825342006, -635.1524799670894, -518.7261923512411, -681.8929231886657, -1293.4620442309956, -899.8838502911706, -903.4026310253952, -547.7619023653251, -698.6274213743247, -752.0054708166119, -617.4527865832248, -246.52714458861738, -720.9962081718932, -690.7615874011386, -587.6197660740073, -1206.1884374403378, -323.1731257104039, -354.7705761585518, -884.4389704983594, -1168.430631302254, -527.1400448886245, -691.5106501649569, -554.1615154743016, -47.46635811652542, -1123.0729888099422, -1029.3457716033172, -169.42714263497976, -238.8711484222772, -55.16464631319164, -256.7248449098628, -1361.7133107697266, -952.0895098729277, -667.388619665374, -585.7392816775337, -680.8897484774321, -297.3528806636543, -760.6669198936908, -452.9913423054128], "episode_lengths": [93, 51, 150, 150, 150, 43, 150, 119, 103, 150, 92, 150, 87, 150, 81, 150, 150, 150, 150, 150, 139, 83, 100, 150, 56, 55, 150, 150, 133, 150, 76, 85, 69, 114, 74, 40, 61, 150, 116, 150, 150, 73, 150, 150, 150, 150, 150, 71, 150, 150, 150, 97, 150, 150, 150, 87, 150, 150, 114, 150, 51, 150, 81, 150, 150, 150, 150, 150, 150, 150, 144, 150, 136, 79, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 117, 55, 150, 150, 77, 95, 52, 90, 150, 150, 150, 150, 150, 136, 149, 150], "policy_policy_0_reward": [-329.78367576911364, -100.20328172275902, -1361.5773027095292, -785.7099468901666, -359.57380608844556, -35.94207635497542, -412.0480627430007, -518.9498051010916, -318.55606957261483, -1227.9485195532118, -408.0661908904117, -714.5108258964895, -168.79589031605852, -1025.8693020716307, -107.61476268396174, -622.4922742788397, -460.2187980972842, -711.2462829692258, -1009.5564979651839, -738.9686107708834, -587.8522923094313, -151.74419428474948, -307.6812657939316, -526.0434617510051, -75.26426902798688, -65.14957048178663, -554.3669125567453, -500.2905008699175, -328.6479427801745, -1304.77174542215, -145.7606428723665, -316.2616991087331, -95.21101963765278, -298.9830792942274, -139.29414751652067, -13.559189046146093, -172.04354501115787, -866.561610639597, -541.500542170562, -1158.0557818054874, -1036.8177909214915, -111.32388220813795, -730.4389837829773, -528.1762956663947, -634.1128831468993, -841.1588760157232, -1374.1390345183563, -125.93635011547333, -977.5105688374883, -502.55378112842794, -589.090863502299, -318.4433206899165, -864.4160649201168, -1405.0039763295804, -283.1875377790301, -134.69524573395074, -958.3542109328333, -1273.246945020323, -498.46077650150386, -712.0525436970242, -32.18752885730221, -974.7613859739796, -146.55297825342006, -635.1524799670894, -518.7261923512411, -681.8929231886657, -1293.4620442309956, -899.8838502911706, -903.4026310253952, -547.7619023653251, -698.6274213743247, -752.0054708166119, -617.4527865832248, -246.52714458861738, -720.9962081718932, -690.7615874011386, -587.6197660740073, -1206.1884374403378, -323.1731257104039, -354.7705761585518, -884.4389704983594, -1168.430631302254, -527.1400448886245, -691.5106501649569, -554.1615154743016, -47.46635811652542, -1123.0729888099422, -1029.3457716033172, -169.42714263497976, -238.8711484222772, -55.16464631319164, -256.7248449098628, -1361.7133107697266, -952.0895098729277, -667.388619665374, -585.7392816775337, -680.8897484774321, -297.3528806636543, -760.6669198936908, -452.9913423054128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559043526672596, "mean_inference_ms": 1.7167859302771253, "mean_action_processing_ms": 0.275386194476536, "mean_env_wait_ms": 3.393573597140373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011905908584594727, "StateBufferConnector_ms": 0.007985591888427734, "ViewRequirementAgentConnector_ms": 0.20218133926391602}, "num_episodes": 30, "episode_return_max": -13.559189046146093, "episode_return_min": -1405.0039763295804, "episode_return_mean": -588.0228809356119, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.8987624475309, "num_env_steps_trained_throughput_per_sec": 334.8987624475309, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 11751.544, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11751.469, "sample_time_ms": 1132.012, "learn_time_ms": 10559.755, "learn_throughput": 378.797, "synch_weights_time_ms": 58.903}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "1e132_00001", "date": "2024-08-04_07-42-39", "timestamp": 1722737559, "time_this_iter_s": 11.957574605941772, "time_total_s": 581.6937098503113, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 581.6937098503113, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.352941176470587, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.4544641862313, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.578486048616469, "policy_loss": -0.009622848692621725, "vf_loss": 1.5831579747920235, "vf_explained_var": 0.9884547604247927, "kl": 0.011267882347601742, "entropy": 1.1962365575134755, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -13.559189046146093, "episode_reward_min": -1405.0039763295804, "episode_reward_mean": -600.2304276155983, "episode_len_mean": 127.59, "episode_media": {}, "episodes_timesteps_total": 12759, "policy_reward_min": {"policy_0": -1405.0039763295804}, "policy_reward_max": {"policy_0": -13.559189046146093}, "policy_reward_mean": {"policy_0": -600.2304276155983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316.2616991087331, -95.21101963765278, -298.9830792942274, -139.29414751652067, -13.559189046146093, -172.04354501115787, -866.561610639597, -541.500542170562, -1158.0557818054874, -1036.8177909214915, -111.32388220813795, -730.4389837829773, -528.1762956663947, -634.1128831468993, -841.1588760157232, -1374.1390345183563, -125.93635011547333, -977.5105688374883, -502.55378112842794, -589.090863502299, -318.4433206899165, -864.4160649201168, -1405.0039763295804, -283.1875377790301, -134.69524573395074, -958.3542109328333, -1273.246945020323, -498.46077650150386, -712.0525436970242, -32.18752885730221, -974.7613859739796, -146.55297825342006, -635.1524799670894, -518.7261923512411, -681.8929231886657, -1293.4620442309956, -899.8838502911706, -903.4026310253952, -547.7619023653251, -698.6274213743247, -752.0054708166119, -617.4527865832248, -246.52714458861738, -720.9962081718932, -690.7615874011386, -587.6197660740073, -1206.1884374403378, -323.1731257104039, -354.7705761585518, -884.4389704983594, -1168.430631302254, -527.1400448886245, -691.5106501649569, -554.1615154743016, -47.46635811652542, -1123.0729888099422, -1029.3457716033172, -169.42714263497976, -238.8711484222772, -55.16464631319164, -256.7248449098628, -1361.7133107697266, -952.0895098729277, -667.388619665374, -585.7392816775337, -680.8897484774321, -297.3528806636543, -760.6669198936908, -452.9913423054128, -874.8021301896599, -457.83892114963754, -684.7587577823481, -647.6780874115717, -754.4358123327996, -313.34844174361956, -167.07998537088375, -1208.411867852548, -1297.4586514496516, -396.3648735968126, -773.2372299125343, -58.0732605287169, -405.3562675080151, -413.38883245840947, -341.34308892103485, -48.20229126854283, -1172.6179728265836, -595.3060720987139, -722.143014471906, -120.8947732423501, -662.1017186795693, -752.8837423394483, -80.78161618549397, -145.40864437125774, -851.5739681152896, -417.30808047660145, -790.0365366068902, -422.95270632411626, -120.91082911444906, -337.60092394604374, -1151.660350318251], "episode_lengths": [85, 69, 114, 74, 40, 61, 150, 116, 150, 150, 73, 150, 150, 150, 150, 150, 71, 150, 150, 150, 97, 150, 150, 150, 87, 150, 150, 114, 150, 51, 150, 81, 150, 150, 150, 150, 150, 150, 150, 144, 150, 136, 79, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 117, 55, 150, 150, 77, 95, 52, 90, 150, 150, 150, 150, 150, 136, 149, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 106, 150, 61, 150, 150, 120, 57, 150, 150, 150, 66, 150, 138, 64, 86, 150, 120, 150, 143, 66, 113, 150], "policy_policy_0_reward": [-316.2616991087331, -95.21101963765278, -298.9830792942274, -139.29414751652067, -13.559189046146093, -172.04354501115787, -866.561610639597, -541.500542170562, -1158.0557818054874, -1036.8177909214915, -111.32388220813795, -730.4389837829773, -528.1762956663947, -634.1128831468993, -841.1588760157232, -1374.1390345183563, -125.93635011547333, -977.5105688374883, -502.55378112842794, -589.090863502299, -318.4433206899165, -864.4160649201168, -1405.0039763295804, -283.1875377790301, -134.69524573395074, -958.3542109328333, -1273.246945020323, -498.46077650150386, -712.0525436970242, -32.18752885730221, -974.7613859739796, -146.55297825342006, -635.1524799670894, -518.7261923512411, -681.8929231886657, -1293.4620442309956, -899.8838502911706, -903.4026310253952, -547.7619023653251, -698.6274213743247, -752.0054708166119, -617.4527865832248, -246.52714458861738, -720.9962081718932, -690.7615874011386, -587.6197660740073, -1206.1884374403378, -323.1731257104039, -354.7705761585518, -884.4389704983594, -1168.430631302254, -527.1400448886245, -691.5106501649569, -554.1615154743016, -47.46635811652542, -1123.0729888099422, -1029.3457716033172, -169.42714263497976, -238.8711484222772, -55.16464631319164, -256.7248449098628, -1361.7133107697266, -952.0895098729277, -667.388619665374, -585.7392816775337, -680.8897484774321, -297.3528806636543, -760.6669198936908, -452.9913423054128, -874.8021301896599, -457.83892114963754, -684.7587577823481, -647.6780874115717, -754.4358123327996, -313.34844174361956, -167.07998537088375, -1208.411867852548, -1297.4586514496516, -396.3648735968126, -773.2372299125343, -58.0732605287169, -405.3562675080151, -413.38883245840947, -341.34308892103485, -48.20229126854283, -1172.6179728265836, -595.3060720987139, -722.143014471906, -120.8947732423501, -662.1017186795693, -752.8837423394483, -80.78161618549397, -145.40864437125774, -851.5739681152896, -417.30808047660145, -790.0365366068902, -422.95270632411626, -120.91082911444906, -337.60092394604374, -1151.660350318251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558074954305746, "mean_inference_ms": 1.7155129793407964, "mean_action_processing_ms": 0.27531847002697313, "mean_env_wait_ms": 3.395687706231014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012170553207397461, "StateBufferConnector_ms": 0.007942914962768555, "ViewRequirementAgentConnector_ms": 0.19735264778137207}, "num_episodes": 31, "episode_return_max": -13.559189046146093, "episode_return_min": -1405.0039763295804, "episode_return_mean": -600.2304276155983, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.53817841190215, "num_env_steps_trained_throughput_per_sec": 312.53817841190215, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 11724.632, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11724.558, "sample_time_ms": 1128.541, "learn_time_ms": 10536.125, "learn_throughput": 379.646, "synch_weights_time_ms": 59.096}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "1e132_00001", "date": "2024-08-04_07-42-52", "timestamp": 1722737572, "time_this_iter_s": 12.811980247497559, "time_total_s": 594.5056900978088, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bf9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 594.5056900978088, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.055555555555557, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.09105774958928, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.8571538573751847, "policy_loss": -0.012743925745598971, "vf_loss": 1.8622570290540656, "vf_explained_var": 0.9921309016024072, "kl": 0.0172055861900238, "entropy": 1.0175693636760115, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -43.77948028269109, "episode_reward_min": -1361.7133107697266, "episode_reward_mean": -564.9356060716608, "episode_len_mean": 128.52, "episode_media": {}, "episodes_timesteps_total": 12852, "policy_reward_min": {"policy_0": -1361.7133107697266}, "policy_reward_max": {"policy_0": -43.77948028269109}, "policy_reward_mean": {"policy_0": -564.9356060716608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.55297825342006, -635.1524799670894, -518.7261923512411, -681.8929231886657, -1293.4620442309956, -899.8838502911706, -903.4026310253952, -547.7619023653251, -698.6274213743247, -752.0054708166119, -617.4527865832248, -246.52714458861738, -720.9962081718932, -690.7615874011386, -587.6197660740073, -1206.1884374403378, -323.1731257104039, -354.7705761585518, -884.4389704983594, -1168.430631302254, -527.1400448886245, -691.5106501649569, -554.1615154743016, -47.46635811652542, -1123.0729888099422, -1029.3457716033172, -169.42714263497976, -238.8711484222772, -55.16464631319164, -256.7248449098628, -1361.7133107697266, -952.0895098729277, -667.388619665374, -585.7392816775337, -680.8897484774321, -297.3528806636543, -760.6669198936908, -452.9913423054128, -874.8021301896599, -457.83892114963754, -684.7587577823481, -647.6780874115717, -754.4358123327996, -313.34844174361956, -167.07998537088375, -1208.411867852548, -1297.4586514496516, -396.3648735968126, -773.2372299125343, -58.0732605287169, -405.3562675080151, -413.38883245840947, -341.34308892103485, -48.20229126854283, -1172.6179728265836, -595.3060720987139, -722.143014471906, -120.8947732423501, -662.1017186795693, -752.8837423394483, -80.78161618549397, -145.40864437125774, -851.5739681152896, -417.30808047660145, -790.0365366068902, -422.95270632411626, -120.91082911444906, -337.60092394604374, -1151.660350318251, -684.9823745398711, -708.6984658994644, -151.4746395449457, -436.3022206310394, -993.3678462910823, -102.72854531511472, -406.68442105158096, -215.12553543191882, -602.3359487133837, -423.1054847273289, -439.96745715362266, -396.90303525857877, -229.81529571990183, -215.10329523012587, -317.9405101844365, -416.4241671754546, -1000.3445040266104, -442.39548129016174, -1012.6420087541036, -47.915376092312584, -581.025593340918, -281.79977664804727, -135.84842849502695, -971.1972879848092, -43.77948028269109, -1073.3392852293066, -607.6956805141839, -438.2309188810058, -1030.603797004434, -442.09051652963177, -128.18992817447554], "episode_lengths": [81, 150, 150, 150, 150, 150, 150, 150, 144, 150, 136, 79, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 117, 55, 150, 150, 77, 95, 52, 90, 150, 150, 150, 150, 150, 136, 149, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 106, 150, 61, 150, 150, 120, 57, 150, 150, 150, 66, 150, 138, 64, 86, 150, 120, 150, 143, 66, 113, 150, 150, 150, 73, 150, 150, 57, 150, 150, 150, 126, 150, 150, 114, 92, 98, 136, 150, 106, 150, 51, 150, 99, 85, 150, 48, 150, 150, 150, 150, 141, 69], "policy_policy_0_reward": [-146.55297825342006, -635.1524799670894, -518.7261923512411, -681.8929231886657, -1293.4620442309956, -899.8838502911706, -903.4026310253952, -547.7619023653251, -698.6274213743247, -752.0054708166119, -617.4527865832248, -246.52714458861738, -720.9962081718932, -690.7615874011386, -587.6197660740073, -1206.1884374403378, -323.1731257104039, -354.7705761585518, -884.4389704983594, -1168.430631302254, -527.1400448886245, -691.5106501649569, -554.1615154743016, -47.46635811652542, -1123.0729888099422, -1029.3457716033172, -169.42714263497976, -238.8711484222772, -55.16464631319164, -256.7248449098628, -1361.7133107697266, -952.0895098729277, -667.388619665374, -585.7392816775337, -680.8897484774321, -297.3528806636543, -760.6669198936908, -452.9913423054128, -874.8021301896599, -457.83892114963754, -684.7587577823481, -647.6780874115717, -754.4358123327996, -313.34844174361956, -167.07998537088375, -1208.411867852548, -1297.4586514496516, -396.3648735968126, -773.2372299125343, -58.0732605287169, -405.3562675080151, -413.38883245840947, -341.34308892103485, -48.20229126854283, -1172.6179728265836, -595.3060720987139, -722.143014471906, -120.8947732423501, -662.1017186795693, -752.8837423394483, -80.78161618549397, -145.40864437125774, -851.5739681152896, -417.30808047660145, -790.0365366068902, -422.95270632411626, -120.91082911444906, -337.60092394604374, -1151.660350318251, -684.9823745398711, -708.6984658994644, -151.4746395449457, -436.3022206310394, -993.3678462910823, -102.72854531511472, -406.68442105158096, -215.12553543191882, -602.3359487133837, -423.1054847273289, -439.96745715362266, -396.90303525857877, -229.81529571990183, -215.10329523012587, -317.9405101844365, -416.4241671754546, -1000.3445040266104, -442.39548129016174, -1012.6420087541036, -47.915376092312584, -581.025593340918, -281.79977664804727, -135.84842849502695, -971.1972879848092, -43.77948028269109, -1073.3392852293066, -607.6956805141839, -438.2309188810058, -1030.603797004434, -442.09051652963177, -128.18992817447554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564441416510405, "mean_inference_ms": 1.7150582378959576, "mean_action_processing_ms": 0.27542379623846025, "mean_env_wait_ms": 3.396217930329026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012027740478515625, "StateBufferConnector_ms": 0.00797414779663086, "ViewRequirementAgentConnector_ms": 0.19196414947509766}, "num_episodes": 31, "episode_return_max": -43.77948028269109, "episode_return_min": -1361.7133107697266, "episode_return_mean": -564.9356060716608, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.9122499395527, "num_env_steps_trained_throughput_per_sec": 304.9122499395527, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 11738.484, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11738.408, "sample_time_ms": 1127.897, "learn_time_ms": 10550.365, "learn_throughput": 379.134, "synch_weights_time_ms": 59.353}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "1e132_00001", "date": "2024-08-04_07-43-05", "timestamp": 1722737585, "time_this_iter_s": 13.129700899124146, "time_total_s": 607.635390996933, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a8c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 607.635390996933, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.642105263157895, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.60103279749552, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.5516009234512846, "policy_loss": -0.011018438835647733, "vf_loss": 1.5557636496300498, "vf_explained_var": 0.9919309563934803, "kl": 0.015528362139836403, "entropy": 1.3204855174447099, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -21.058554149524255, "episode_reward_min": -1297.4586514496516, "episode_reward_mean": -521.6501325976761, "episode_len_mean": 123.58, "episode_media": {}, "episodes_timesteps_total": 12358, "policy_reward_min": {"policy_0": -1297.4586514496516}, "policy_reward_max": {"policy_0": -21.058554149524255}, "policy_reward_mean": {"policy_0": -521.6501325976761}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-760.6669198936908, -452.9913423054128, -874.8021301896599, -457.83892114963754, -684.7587577823481, -647.6780874115717, -754.4358123327996, -313.34844174361956, -167.07998537088375, -1208.411867852548, -1297.4586514496516, -396.3648735968126, -773.2372299125343, -58.0732605287169, -405.3562675080151, -413.38883245840947, -341.34308892103485, -48.20229126854283, -1172.6179728265836, -595.3060720987139, -722.143014471906, -120.8947732423501, -662.1017186795693, -752.8837423394483, -80.78161618549397, -145.40864437125774, -851.5739681152896, -417.30808047660145, -790.0365366068902, -422.95270632411626, -120.91082911444906, -337.60092394604374, -1151.660350318251, -684.9823745398711, -708.6984658994644, -151.4746395449457, -436.3022206310394, -993.3678462910823, -102.72854531511472, -406.68442105158096, -215.12553543191882, -602.3359487133837, -423.1054847273289, -439.96745715362266, -396.90303525857877, -229.81529571990183, -215.10329523012587, -317.9405101844365, -416.4241671754546, -1000.3445040266104, -442.39548129016174, -1012.6420087541036, -47.915376092312584, -581.025593340918, -281.79977664804727, -135.84842849502695, -971.1972879848092, -43.77948028269109, -1073.3392852293066, -607.6956805141839, -438.2309188810058, -1030.603797004434, -442.09051652963177, -128.18992817447554, -950.0896998367839, -171.99588123613285, -813.2609731625217, -399.6829689787974, -75.71171993889834, -447.6502401731764, -689.275784228922, -424.8058107095626, -1086.1782174803295, -1038.642481970591, -43.73667798106403, -146.77262217345768, -248.29325660326523, -644.2464078295144, -802.9462805662099, -107.6444835349529, -835.9940457356017, -1071.4177736152938, -341.39924229220946, -1032.9097505409195, -989.1367282706962, -314.66932129641293, -456.063512064609, -475.88719199560654, -46.37240531225805, -213.4405445634302, -451.84145866046066, -971.7592332482211, -21.058554149524255, -268.0473780303521, -365.0902971808124, -155.61241022884178, -1267.3344499813506, -855.6531672448416, -36.596783510895435, -526.1204885326716], "episode_lengths": [149, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 106, 150, 61, 150, 150, 120, 57, 150, 150, 150, 66, 150, 138, 64, 86, 150, 120, 150, 143, 66, 113, 150, 150, 150, 73, 150, 150, 57, 150, 150, 150, 126, 150, 150, 114, 92, 98, 136, 150, 106, 150, 51, 150, 99, 85, 150, 48, 150, 150, 150, 150, 141, 69, 150, 60, 150, 150, 64, 150, 150, 150, 150, 150, 60, 74, 100, 150, 150, 61, 150, 150, 150, 150, 150, 97, 118, 110, 54, 93, 150, 150, 41, 92, 143, 77, 150, 150, 47, 150], "policy_policy_0_reward": [-760.6669198936908, -452.9913423054128, -874.8021301896599, -457.83892114963754, -684.7587577823481, -647.6780874115717, -754.4358123327996, -313.34844174361956, -167.07998537088375, -1208.411867852548, -1297.4586514496516, -396.3648735968126, -773.2372299125343, -58.0732605287169, -405.3562675080151, -413.38883245840947, -341.34308892103485, -48.20229126854283, -1172.6179728265836, -595.3060720987139, -722.143014471906, -120.8947732423501, -662.1017186795693, -752.8837423394483, -80.78161618549397, -145.40864437125774, -851.5739681152896, -417.30808047660145, -790.0365366068902, -422.95270632411626, -120.91082911444906, -337.60092394604374, -1151.660350318251, -684.9823745398711, -708.6984658994644, -151.4746395449457, -436.3022206310394, -993.3678462910823, -102.72854531511472, -406.68442105158096, -215.12553543191882, -602.3359487133837, -423.1054847273289, -439.96745715362266, -396.90303525857877, -229.81529571990183, -215.10329523012587, -317.9405101844365, -416.4241671754546, -1000.3445040266104, -442.39548129016174, -1012.6420087541036, -47.915376092312584, -581.025593340918, -281.79977664804727, -135.84842849502695, -971.1972879848092, -43.77948028269109, -1073.3392852293066, -607.6956805141839, -438.2309188810058, -1030.603797004434, -442.09051652963177, -128.18992817447554, -950.0896998367839, -171.99588123613285, -813.2609731625217, -399.6829689787974, -75.71171993889834, -447.6502401731764, -689.275784228922, -424.8058107095626, -1086.1782174803295, -1038.642481970591, -43.73667798106403, -146.77262217345768, -248.29325660326523, -644.2464078295144, -802.9462805662099, -107.6444835349529, -835.9940457356017, -1071.4177736152938, -341.39924229220946, -1032.9097505409195, -989.1367282706962, -314.66932129641293, -456.063512064609, -475.88719199560654, -46.37240531225805, -213.4405445634302, -451.84145866046066, -971.7592332482211, -21.058554149524255, -268.0473780303521, -365.0902971808124, -155.61241022884178, -1267.3344499813506, -855.6531672448416, -36.596783510895435, -526.1204885326716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556380107888219, "mean_inference_ms": 1.7142882699116142, "mean_action_processing_ms": 0.2755434204758297, "mean_env_wait_ms": 3.3979092262625286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012524127960205078, "StateBufferConnector_ms": 0.008056640625, "ViewRequirementAgentConnector_ms": 0.1964550018310547}, "num_episodes": 36, "episode_return_max": -21.058554149524255, "episode_return_min": -1297.4586514496516, "episode_return_mean": -521.6501325976761, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.9510855188968, "num_env_steps_trained_throughput_per_sec": 312.9510855188968, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 11924.077, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11924.001, "sample_time_ms": 1125.961, "learn_time_ms": 10737.496, "learn_throughput": 372.526, "synch_weights_time_ms": 59.748}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "training_iteration": 50, "trial_id": "1e132_00001", "date": "2024-08-04_07-43-18", "timestamp": 1722737598, "time_this_iter_s": 12.792650699615479, "time_total_s": 620.4280416965485, "pid": 603862, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9964bc310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 620.4280416965485, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.738888888888887, "ram_util_percent": 28.2}}
