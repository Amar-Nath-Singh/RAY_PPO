{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9399292623624206, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.615347533424695, "policy_loss": -0.007848598453953552, "vf_loss": 9.6206427415212, "vf_explained_var": -9.014575431744257e-05, "kl": 0.013486138548675324, "entropy": 1.4385500165323417, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -68.01198016039719, "episode_reward_min": -1286.4592195130717, "episode_reward_mean": -842.3423401198488, "episode_len_mean": 138.82608695652175, "episode_media": {}, "episodes_timesteps_total": 3193, "policy_reward_min": {"policy_0": -1286.4592195130717}, "policy_reward_max": {"policy_0": -68.01198016039719}, "policy_reward_mean": {"policy_0": -842.3423401198488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-527.7490066432512, -68.01198016039719, -475.9516367275027, -1243.9230408447654, -667.9933450792453, -1286.4592195130717, -1217.1433981074756, -994.4970093176296, -809.1374967605635, -1089.0531578101745, -1248.3954143739468, -928.1811153121604, -717.1668442974559, -1138.1897770932967, -1082.395509556406, -880.4904595353531, -835.3408564439368, -750.7613096257851, -1062.6613677644477, -126.96124060089957, -1174.714498450233, -547.1200210011625, -501.57611773736147], "episode_lengths": [150, 55, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 121, 150], "policy_policy_0_reward": [-527.7490066432512, -68.01198016039719, -475.9516367275027, -1243.9230408447654, -667.9933450792453, -1286.4592195130717, -1217.1433981074756, -994.4970093176296, -809.1374967605635, -1089.0531578101745, -1248.3954143739468, -928.1811153121604, -717.1668442974559, -1138.1897770932967, -1082.395509556406, -880.4904595353531, -835.3408564439368, -750.7613096257851, -1062.6613677644477, -126.96124060089957, -1174.714498450233, -547.1200210011625, -501.57611773736147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5785752033841782, "mean_inference_ms": 1.686525847320001, "mean_action_processing_ms": 0.2808228776176966, "mean_env_wait_ms": 3.4134642545251115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011286528214164402, "StateBufferConnector_ms": 0.008060621178668478, "ViewRequirementAgentConnector_ms": 0.19751942676046622}, "num_episodes": 23, "episode_return_max": -68.01198016039719, "episode_return_min": -1286.4592195130717, "episode_return_mean": -842.3423401198488, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4278933100964, "num_env_steps_trained_throughput_per_sec": 307.4278933100964, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13011.191, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13011.128, "sample_time_ms": 1228.525, "learn_time_ms": 11709.98, "learn_throughput": 341.589, "synch_weights_time_ms": 71.794}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1e132_00002", "date": "2024-08-04_07-43-49", "timestamp": 1722737629, "time_this_iter_s": 13.022766590118408, "time_total_s": 13.022766590118408, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544895a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.022766590118408, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.11052631578947, "ram_util_percent": 28.08421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9598188239770631, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.743577459454537, "policy_loss": -0.007816790707875044, "vf_loss": 9.749278488755227, "vf_explained_var": 0.038701356885333854, "kl": 0.011299633005334424, "entropy": 1.441708103194833, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -9.951621106278468, "episode_reward_min": -1325.4686510725433, "episode_reward_mean": -867.6303072014697, "episode_len_mean": 138.54166666666666, "episode_media": {}, "episodes_timesteps_total": 6650, "policy_reward_min": {"policy_0": -1325.4686510725433}, "policy_reward_max": {"policy_0": -9.951621106278468}, "policy_reward_mean": {"policy_0": -867.6303072014697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-527.7490066432512, -68.01198016039719, -475.9516367275027, -1243.9230408447654, -667.9933450792453, -1286.4592195130717, -1217.1433981074756, -994.4970093176296, -809.1374967605635, -1089.0531578101745, -1248.3954143739468, -928.1811153121604, -717.1668442974559, -1138.1897770932967, -1082.395509556406, -880.4904595353531, -835.3408564439368, -750.7613096257851, -1062.6613677644477, -126.96124060089957, -1174.714498450233, -547.1200210011625, -501.57611773736147, -949.3379619824491, -894.2580503346524, -329.9331249207664, -1049.724811342001, -1172.0787927567376, -792.029901332162, -1222.3656707352498, -1290.6000668477625, -784.1475606184667, -477.16786266279337, -1325.4686510725433, -9.951621106278468, -395.6558149022826, -1159.6657811487264, -966.0337743324244, -942.4473582333892, -478.8056608884566, -1070.4429464060297, -1113.9859730729959, -995.8682218656887, -627.0357142447052, -1055.5077091339438, -1002.3725981528988, -1041.3741344563846, -1126.12116036423], "episode_lengths": [150, 55, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 121, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 111, 150, 34, 119, 150, 150, 150, 106, 150, 150, 150, 141, 150, 150, 150, 150], "policy_policy_0_reward": [-527.7490066432512, -68.01198016039719, -475.9516367275027, -1243.9230408447654, -667.9933450792453, -1286.4592195130717, -1217.1433981074756, -994.4970093176296, -809.1374967605635, -1089.0531578101745, -1248.3954143739468, -928.1811153121604, -717.1668442974559, -1138.1897770932967, -1082.395509556406, -880.4904595353531, -835.3408564439368, -750.7613096257851, -1062.6613677644477, -126.96124060089957, -1174.714498450233, -547.1200210011625, -501.57611773736147, -949.3379619824491, -894.2580503346524, -329.9331249207664, -1049.724811342001, -1172.0787927567376, -792.029901332162, -1222.3656707352498, -1290.6000668477625, -784.1475606184667, -477.16786266279337, -1325.4686510725433, -9.951621106278468, -395.6558149022826, -1159.6657811487264, -966.0337743324244, -942.4473582333892, -478.8056608884566, -1070.4429464060297, -1113.9859730729959, -995.8682218656887, -627.0357142447052, -1055.5077091339438, -1002.3725981528988, -1041.3741344563846, -1126.12116036423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5724473597179963, "mean_inference_ms": 1.6841288387814626, "mean_action_processing_ms": 0.2801795637018441, "mean_env_wait_ms": 3.426038695010925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014014045397440592, "StateBufferConnector_ms": 0.008328258991241455, "ViewRequirementAgentConnector_ms": 0.18979012966156006}, "num_episodes": 25, "episode_return_max": -9.951621106278468, "episode_return_min": -1325.4686510725433, "episode_return_mean": -867.6303072014697, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4169819007627, "num_env_steps_trained_throughput_per_sec": 307.4169819007627, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13011.425, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13011.352, "sample_time_ms": 1165.415, "learn_time_ms": 11779.388, "learn_throughput": 339.576, "synch_weights_time_ms": 65.757}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1e132_00002", "date": "2024-08-04_07-44-02", "timestamp": 1722737642, "time_this_iter_s": 13.024410247802734, "time_total_s": 26.047176837921143, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.047176837921143, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.63684210526316, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.323040756365905, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.901472178101539, "policy_loss": -0.00828142338480878, "vf_loss": 8.907292691369852, "vf_explained_var": 0.27950397493938606, "kl": 0.01303688932616751, "entropy": 1.464859170963367, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -9.951621106278468, "episode_reward_min": -1325.4686510725433, "episode_reward_mean": -812.9616434266336, "episode_len_mean": 134.16666666666666, "episode_media": {}, "episodes_timesteps_total": 10465, "policy_reward_min": {"policy_0": -1325.4686510725433}, "policy_reward_max": {"policy_0": -9.951621106278468}, "policy_reward_mean": {"policy_0": -812.9616434266336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-527.7490066432512, -68.01198016039719, -475.9516367275027, -1243.9230408447654, -667.9933450792453, -1286.4592195130717, -1217.1433981074756, -994.4970093176296, -809.1374967605635, -1089.0531578101745, -1248.3954143739468, -928.1811153121604, -717.1668442974559, -1138.1897770932967, -1082.395509556406, -880.4904595353531, -835.3408564439368, -750.7613096257851, -1062.6613677644477, -126.96124060089957, -1174.714498450233, -547.1200210011625, -501.57611773736147, -949.3379619824491, -894.2580503346524, -329.9331249207664, -1049.724811342001, -1172.0787927567376, -792.029901332162, -1222.3656707352498, -1290.6000668477625, -784.1475606184667, -477.16786266279337, -1325.4686510725433, -9.951621106278468, -395.6558149022826, -1159.6657811487264, -966.0337743324244, -942.4473582333892, -478.8056608884566, -1070.4429464060297, -1113.9859730729959, -995.8682218656887, -627.0357142447052, -1055.5077091339438, -1002.3725981528988, -1041.3741344563846, -1126.12116036423, -375.7089598649343, -257.0081118769857, -947.174664096399, -1111.4015112197503, -853.2618397306704, -901.382845898136, -1163.2728670734755, -920.7888495751672, -63.92888909233788, -1197.8182574175921, -843.2920157612307, -1186.555915737256, -1197.1175925011073, -472.0753594929367, -1044.596597103517, -508.6150358677925, -782.0156221822123, -468.0223586557295, -65.93789333514819, -281.2713011196532, -357.2198850219606, -807.5164915236722, -587.0504992016483, -917.5185435293572, -1075.9617510783476, -987.1665860632698, -439.4566817403446, -655.8977868398, -159.55525538050878, -1136.163473625922], "episode_lengths": [150, 55, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 121, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 111, 150, 34, 119, 150, 150, 150, 106, 150, 150, 150, 141, 150, 150, 150, 150, 92, 88, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 100, 150, 150, 150, 132, 44, 83, 82, 150, 150, 150, 150, 150, 96, 124, 61, 150], "policy_policy_0_reward": [-527.7490066432512, -68.01198016039719, -475.9516367275027, -1243.9230408447654, -667.9933450792453, -1286.4592195130717, -1217.1433981074756, -994.4970093176296, -809.1374967605635, -1089.0531578101745, -1248.3954143739468, -928.1811153121604, -717.1668442974559, -1138.1897770932967, -1082.395509556406, -880.4904595353531, -835.3408564439368, -750.7613096257851, -1062.6613677644477, -126.96124060089957, -1174.714498450233, -547.1200210011625, -501.57611773736147, -949.3379619824491, -894.2580503346524, -329.9331249207664, -1049.724811342001, -1172.0787927567376, -792.029901332162, -1222.3656707352498, -1290.6000668477625, -784.1475606184667, -477.16786266279337, -1325.4686510725433, -9.951621106278468, -395.6558149022826, -1159.6657811487264, -966.0337743324244, -942.4473582333892, -478.8056608884566, -1070.4429464060297, -1113.9859730729959, -995.8682218656887, -627.0357142447052, -1055.5077091339438, -1002.3725981528988, -1041.3741344563846, -1126.12116036423, -375.7089598649343, -257.0081118769857, -947.174664096399, -1111.4015112197503, -853.2618397306704, -901.382845898136, -1163.2728670734755, -920.7888495751672, -63.92888909233788, -1197.8182574175921, -843.2920157612307, -1186.555915737256, -1197.1175925011073, -472.0753594929367, -1044.596597103517, -508.6150358677925, -782.0156221822123, -468.0223586557295, -65.93789333514819, -281.2713011196532, -357.2198850219606, -807.5164915236722, -587.0504992016483, -917.5185435293572, -1075.9617510783476, -987.1665860632698, -439.4566817403446, -655.8977868398, -159.55525538050878, -1136.163473625922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5698276292173724, "mean_inference_ms": 1.6820884444992616, "mean_action_processing_ms": 0.2797843624185886, "mean_env_wait_ms": 3.4203642298066668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013423577333107973, "StateBufferConnector_ms": 0.008422594804030199, "ViewRequirementAgentConnector_ms": 0.1886890484736516}, "num_episodes": 30, "episode_return_max": -9.951621106278468, "episode_return_min": -1325.4686510725433, "episode_return_mean": -812.9616434266336, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.66909971048227, "num_env_steps_trained_throughput_per_sec": 306.66909971048227, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13022.079, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13022.01, "sample_time_ms": 1141.282, "learn_time_ms": 11816.494, "learn_throughput": 338.51, "synch_weights_time_ms": 63.442}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1e132_00002", "date": "2024-08-04_07-44-15", "timestamp": 1722737655, "time_this_iter_s": 13.055182933807373, "time_total_s": 39.102359771728516, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996512440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.102359771728516, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.855555555555554, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.542914216220378, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.680345750848452, "policy_loss": -0.011656578632149224, "vf_loss": 7.688892359038194, "vf_explained_var": 0.5263236386701464, "kl": 0.016290156960045956, "entropy": 1.4808347520728906, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -9.951621106278468, "episode_reward_min": -1441.158495942355, "episode_reward_mean": -787.1947869019855, "episode_len_mean": 133.68, "episode_media": {}, "episodes_timesteps_total": 13368, "policy_reward_min": {"policy_0": -1441.158495942355}, "policy_reward_max": {"policy_0": -9.951621106278468}, "policy_reward_mean": {"policy_0": -787.1947869019855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1089.0531578101745, -1248.3954143739468, -928.1811153121604, -717.1668442974559, -1138.1897770932967, -1082.395509556406, -880.4904595353531, -835.3408564439368, -750.7613096257851, -1062.6613677644477, -126.96124060089957, -1174.714498450233, -547.1200210011625, -501.57611773736147, -949.3379619824491, -894.2580503346524, -329.9331249207664, -1049.724811342001, -1172.0787927567376, -792.029901332162, -1222.3656707352498, -1290.6000668477625, -784.1475606184667, -477.16786266279337, -1325.4686510725433, -9.951621106278468, -395.6558149022826, -1159.6657811487264, -966.0337743324244, -942.4473582333892, -478.8056608884566, -1070.4429464060297, -1113.9859730729959, -995.8682218656887, -627.0357142447052, -1055.5077091339438, -1002.3725981528988, -1041.3741344563846, -1126.12116036423, -375.7089598649343, -257.0081118769857, -947.174664096399, -1111.4015112197503, -853.2618397306704, -901.382845898136, -1163.2728670734755, -920.7888495751672, -63.92888909233788, -1197.8182574175921, -843.2920157612307, -1186.555915737256, -1197.1175925011073, -472.0753594929367, -1044.596597103517, -508.6150358677925, -782.0156221822123, -468.0223586557295, -65.93789333514819, -281.2713011196532, -357.2198850219606, -807.5164915236722, -587.0504992016483, -917.5185435293572, -1075.9617510783476, -987.1665860632698, -439.4566817403446, -655.8977868398, -159.55525538050878, -1136.163473625922, -1032.5351018552421, -1204.161260241954, -253.07376173679515, -873.5132057567492, -480.5756067180695, -379.4212985163898, -406.85066065432795, -883.8187969590679, -189.8117808757642, -248.96415363279874, -380.94356409963905, -975.2970573736036, -110.89116327130162, -622.7366824236132, -936.8541246218982, -981.498093152708, -1092.4921870602213, -1441.158495942355, -785.0117845908663, -1047.6745949628748, -989.918211961118, -174.4779149796557, -894.9149110175166, -448.9417651063768, -648.0800799605751, -1149.6333477866033, -583.4801061738806, -1038.1675629908373, -1069.8084257012283, -197.4067752431451, -1077.224160707873], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 121, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 111, 150, 34, 119, 150, 150, 150, 106, 150, 150, 150, 141, 150, 150, 150, 150, 92, 88, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 100, 150, 150, 150, 132, 44, 83, 82, 150, 150, 150, 150, 150, 96, 124, 61, 150, 150, 150, 75, 150, 130, 121, 109, 150, 80, 85, 137, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 72, 150], "policy_policy_0_reward": [-1089.0531578101745, -1248.3954143739468, -928.1811153121604, -717.1668442974559, -1138.1897770932967, -1082.395509556406, -880.4904595353531, -835.3408564439368, -750.7613096257851, -1062.6613677644477, -126.96124060089957, -1174.714498450233, -547.1200210011625, -501.57611773736147, -949.3379619824491, -894.2580503346524, -329.9331249207664, -1049.724811342001, -1172.0787927567376, -792.029901332162, -1222.3656707352498, -1290.6000668477625, -784.1475606184667, -477.16786266279337, -1325.4686510725433, -9.951621106278468, -395.6558149022826, -1159.6657811487264, -966.0337743324244, -942.4473582333892, -478.8056608884566, -1070.4429464060297, -1113.9859730729959, -995.8682218656887, -627.0357142447052, -1055.5077091339438, -1002.3725981528988, -1041.3741344563846, -1126.12116036423, -375.7089598649343, -257.0081118769857, -947.174664096399, -1111.4015112197503, -853.2618397306704, -901.382845898136, -1163.2728670734755, -920.7888495751672, -63.92888909233788, -1197.8182574175921, -843.2920157612307, -1186.555915737256, -1197.1175925011073, -472.0753594929367, -1044.596597103517, -508.6150358677925, -782.0156221822123, -468.0223586557295, -65.93789333514819, -281.2713011196532, -357.2198850219606, -807.5164915236722, -587.0504992016483, -917.5185435293572, -1075.9617510783476, -987.1665860632698, -439.4566817403446, -655.8977868398, -159.55525538050878, -1136.163473625922, -1032.5351018552421, -1204.161260241954, -253.07376173679515, -873.5132057567492, -480.5756067180695, -379.4212985163898, -406.85066065432795, -883.8187969590679, -189.8117808757642, -248.96415363279874, -380.94356409963905, -975.2970573736036, -110.89116327130162, -622.7366824236132, -936.8541246218982, -981.498093152708, -1092.4921870602213, -1441.158495942355, -785.0117845908663, -1047.6745949628748, -989.918211961118, -174.4779149796557, -894.9149110175166, -448.9417651063768, -648.0800799605751, -1149.6333477866033, -583.4801061738806, -1038.1675629908373, -1069.8084257012283, -197.4067752431451, -1077.224160707873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5677424905586709, "mean_inference_ms": 1.6849326568294365, "mean_action_processing_ms": 0.28029428395342215, "mean_env_wait_ms": 3.4343617362979852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013950109481811523, "StateBufferConnector_ms": 0.016780614852905273, "ViewRequirementAgentConnector_ms": 0.19411802291870117}, "num_episodes": 31, "episode_return_max": -9.951621106278468, "episode_return_min": -1441.158495942355, "episode_return_mean": -787.1947869019855, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.34408907654466, "num_env_steps_trained_throughput_per_sec": 320.34408907654466, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12888.206, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12888.137, "sample_time_ms": 1148.627, "learn_time_ms": 11674.773, "learn_throughput": 342.619, "synch_weights_time_ms": 63.94}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1e132_00002", "date": "2024-08-04_07-44-27", "timestamp": 1722737667, "time_this_iter_s": 12.498861312866211, "time_total_s": 51.60122108459473, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448add0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.60122108459473, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.35, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.35067465653022, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.243102153142293, "policy_loss": -0.008422683088671572, "vf_loss": 7.248762586712838, "vf_explained_var": 0.6992629576474428, "kl": 0.014531404015239486, "entropy": 1.4401590891182423, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -9.951621106278468, "episode_reward_min": -1441.4862547289076, "episode_reward_mean": -782.5638494299881, "episode_len_mean": 134.04, "episode_media": {}, "episodes_timesteps_total": 13404, "policy_reward_min": {"policy_0": -1441.4862547289076}, "policy_reward_max": {"policy_0": -9.951621106278468}, "policy_reward_mean": {"policy_0": -782.5638494299881}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.951621106278468, -395.6558149022826, -1159.6657811487264, -966.0337743324244, -942.4473582333892, -478.8056608884566, -1070.4429464060297, -1113.9859730729959, -995.8682218656887, -627.0357142447052, -1055.5077091339438, -1002.3725981528988, -1041.3741344563846, -1126.12116036423, -375.7089598649343, -257.0081118769857, -947.174664096399, -1111.4015112197503, -853.2618397306704, -901.382845898136, -1163.2728670734755, -920.7888495751672, -63.92888909233788, -1197.8182574175921, -843.2920157612307, -1186.555915737256, -1197.1175925011073, -472.0753594929367, -1044.596597103517, -508.6150358677925, -782.0156221822123, -468.0223586557295, -65.93789333514819, -281.2713011196532, -357.2198850219606, -807.5164915236722, -587.0504992016483, -917.5185435293572, -1075.9617510783476, -987.1665860632698, -439.4566817403446, -655.8977868398, -159.55525538050878, -1136.163473625922, -1032.5351018552421, -1204.161260241954, -253.07376173679515, -873.5132057567492, -480.5756067180695, -379.4212985163898, -406.85066065432795, -883.8187969590679, -189.8117808757642, -248.96415363279874, -380.94356409963905, -975.2970573736036, -110.89116327130162, -622.7366824236132, -936.8541246218982, -981.498093152708, -1092.4921870602213, -1441.158495942355, -785.0117845908663, -1047.6745949628748, -989.918211961118, -174.4779149796557, -894.9149110175166, -448.9417651063768, -648.0800799605751, -1149.6333477866033, -583.4801061738806, -1038.1675629908373, -1069.8084257012283, -197.4067752431451, -1077.224160707873, -1441.4862547289076, -974.7750450806342, -67.26999345291365, -786.2458559297088, -699.8413572510823, -858.1475670703421, -1105.846052669981, -903.3119662560097, -1002.5023985887909, -940.3032829558688, -1230.9497644191495, -1014.6987468386427, -736.6685457089766, -873.5103920620923, -1027.577077915183, -835.4788610773624, -843.9214541051067, -634.4841114613, -146.37805109242174, -837.7557860222196, -732.186333877193, -1098.6587757790069, -956.764789598032, -1194.5059327980355, -963.7580002694701], "episode_lengths": [34, 119, 150, 150, 150, 106, 150, 150, 150, 141, 150, 150, 150, 150, 92, 88, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 100, 150, 150, 150, 132, 44, 83, 82, 150, 150, 150, 150, 150, 96, 124, 61, 150, 150, 150, 75, 150, 130, 121, 109, 150, 80, 85, 137, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-9.951621106278468, -395.6558149022826, -1159.6657811487264, -966.0337743324244, -942.4473582333892, -478.8056608884566, -1070.4429464060297, -1113.9859730729959, -995.8682218656887, -627.0357142447052, -1055.5077091339438, -1002.3725981528988, -1041.3741344563846, -1126.12116036423, -375.7089598649343, -257.0081118769857, -947.174664096399, -1111.4015112197503, -853.2618397306704, -901.382845898136, -1163.2728670734755, -920.7888495751672, -63.92888909233788, -1197.8182574175921, -843.2920157612307, -1186.555915737256, -1197.1175925011073, -472.0753594929367, -1044.596597103517, -508.6150358677925, -782.0156221822123, -468.0223586557295, -65.93789333514819, -281.2713011196532, -357.2198850219606, -807.5164915236722, -587.0504992016483, -917.5185435293572, -1075.9617510783476, -987.1665860632698, -439.4566817403446, -655.8977868398, -159.55525538050878, -1136.163473625922, -1032.5351018552421, -1204.161260241954, -253.07376173679515, -873.5132057567492, -480.5756067180695, -379.4212985163898, -406.85066065432795, -883.8187969590679, -189.8117808757642, -248.96415363279874, -380.94356409963905, -975.2970573736036, -110.89116327130162, -622.7366824236132, -936.8541246218982, -981.498093152708, -1092.4921870602213, -1441.158495942355, -785.0117845908663, -1047.6745949628748, -989.918211961118, -174.4779149796557, -894.9149110175166, -448.9417651063768, -648.0800799605751, -1149.6333477866033, -583.4801061738806, -1038.1675629908373, -1069.8084257012283, -197.4067752431451, -1077.224160707873, -1441.4862547289076, -974.7750450806342, -67.26999345291365, -786.2458559297088, -699.8413572510823, -858.1475670703421, -1105.846052669981, -903.3119662560097, -1002.5023985887909, -940.3032829558688, -1230.9497644191495, -1014.6987468386427, -736.6685457089766, -873.5103920620923, -1027.577077915183, -835.4788610773624, -843.9214541051067, -634.4841114613, -146.37805109242174, -837.7557860222196, -732.186333877193, -1098.6587757790069, -956.764789598032, -1194.5059327980355, -963.7580002694701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.566447585110865, "mean_inference_ms": 1.6822151537211567, "mean_action_processing_ms": 0.280827815876013, "mean_env_wait_ms": 3.438109705185305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013502120971679688, "StateBufferConnector_ms": 0.016925811767578125, "ViewRequirementAgentConnector_ms": 0.19207501411437988}, "num_episodes": 25, "episode_return_max": -9.951621106278468, "episode_return_min": -1441.4862547289076, "episode_return_mean": -782.5638494299881, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.3664836926642, "num_env_steps_trained_throughput_per_sec": 320.3664836926642, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12807.707, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12807.64, "sample_time_ms": 1139.748, "learn_time_ms": 11604.397, "learn_throughput": 344.697, "synch_weights_time_ms": 62.703}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1e132_00002", "date": "2024-08-04_07-44-40", "timestamp": 1722737680, "time_this_iter_s": 12.497234344482422, "time_total_s": 64.09845542907715, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544895a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.09845542907715, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.005555555555553, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.980075458685555, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.504616728921731, "policy_loss": -0.011770476204886412, "vf_loss": 6.512871238092582, "vf_explained_var": 0.7787635752310356, "kl": 0.018330013641813518, "entropy": 1.5001124386986098, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -42.18246703053412, "episode_reward_min": -1441.4862547289076, "episode_reward_mean": -770.695866895307, "episode_len_mean": 134.17, "episode_media": {}, "episodes_timesteps_total": 13417, "policy_reward_min": {"policy_0": -1441.4862547289076}, "policy_reward_max": {"policy_0": -42.18246703053412}, "policy_reward_mean": {"policy_0": -770.695866895307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-468.0223586557295, -65.93789333514819, -281.2713011196532, -357.2198850219606, -807.5164915236722, -587.0504992016483, -917.5185435293572, -1075.9617510783476, -987.1665860632698, -439.4566817403446, -655.8977868398, -159.55525538050878, -1136.163473625922, -1032.5351018552421, -1204.161260241954, -253.07376173679515, -873.5132057567492, -480.5756067180695, -379.4212985163898, -406.85066065432795, -883.8187969590679, -189.8117808757642, -248.96415363279874, -380.94356409963905, -975.2970573736036, -110.89116327130162, -622.7366824236132, -936.8541246218982, -981.498093152708, -1092.4921870602213, -1441.158495942355, -785.0117845908663, -1047.6745949628748, -989.918211961118, -174.4779149796557, -894.9149110175166, -448.9417651063768, -648.0800799605751, -1149.6333477866033, -583.4801061738806, -1038.1675629908373, -1069.8084257012283, -197.4067752431451, -1077.224160707873, -1441.4862547289076, -974.7750450806342, -67.26999345291365, -786.2458559297088, -699.8413572510823, -858.1475670703421, -1105.846052669981, -903.3119662560097, -1002.5023985887909, -940.3032829558688, -1230.9497644191495, -1014.6987468386427, -736.6685457089766, -873.5103920620923, -1027.577077915183, -835.4788610773624, -843.9214541051067, -634.4841114613, -146.37805109242174, -837.7557860222196, -732.186333877193, -1098.6587757790069, -956.764789598032, -1194.5059327980355, -963.7580002694701, -666.8994758224761, -467.90720893938595, -1286.814428859176, -440.05412053061366, -1396.68146211851, -558.5067932576751, -957.8972122178546, -93.35010216002587, -689.1794151807876, -958.5737623057788, -1025.3457106198164, -1086.1168925166053, -525.7634128911693, -246.7893195043021, -1087.8766063642922, -472.89105011204396, -335.80730387202505, -636.0046924443806, -616.8763849426176, -1312.1348798540575, -698.8076482852156, -42.18246703053412, -1158.3040774349727, -931.0565296456532, -47.35003284899371, -1086.0693612542375, -1347.8841104731928, -1221.4011502394358, -1250.8453435243355, -792.143146781398, -1186.9710473002929], "episode_lengths": [132, 44, 83, 82, 150, 150, 150, 150, 150, 96, 124, 61, 150, 150, 150, 75, 150, 130, 121, 109, 150, 80, 85, 137, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 47, 149, 150, 150, 150, 150, 98, 150, 145, 88, 150, 150, 150, 150, 48, 150, 150, 45, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-468.0223586557295, -65.93789333514819, -281.2713011196532, -357.2198850219606, -807.5164915236722, -587.0504992016483, -917.5185435293572, -1075.9617510783476, -987.1665860632698, -439.4566817403446, -655.8977868398, -159.55525538050878, -1136.163473625922, -1032.5351018552421, -1204.161260241954, -253.07376173679515, -873.5132057567492, -480.5756067180695, -379.4212985163898, -406.85066065432795, -883.8187969590679, -189.8117808757642, -248.96415363279874, -380.94356409963905, -975.2970573736036, -110.89116327130162, -622.7366824236132, -936.8541246218982, -981.498093152708, -1092.4921870602213, -1441.158495942355, -785.0117845908663, -1047.6745949628748, -989.918211961118, -174.4779149796557, -894.9149110175166, -448.9417651063768, -648.0800799605751, -1149.6333477866033, -583.4801061738806, -1038.1675629908373, -1069.8084257012283, -197.4067752431451, -1077.224160707873, -1441.4862547289076, -974.7750450806342, -67.26999345291365, -786.2458559297088, -699.8413572510823, -858.1475670703421, -1105.846052669981, -903.3119662560097, -1002.5023985887909, -940.3032829558688, -1230.9497644191495, -1014.6987468386427, -736.6685457089766, -873.5103920620923, -1027.577077915183, -835.4788610773624, -843.9214541051067, -634.4841114613, -146.37805109242174, -837.7557860222196, -732.186333877193, -1098.6587757790069, -956.764789598032, -1194.5059327980355, -963.7580002694701, -666.8994758224761, -467.90720893938595, -1286.814428859176, -440.05412053061366, -1396.68146211851, -558.5067932576751, -957.8972122178546, -93.35010216002587, -689.1794151807876, -958.5737623057788, -1025.3457106198164, -1086.1168925166053, -525.7634128911693, -246.7893195043021, -1087.8766063642922, -472.89105011204396, -335.80730387202505, -636.0046924443806, -616.8763849426176, -1312.1348798540575, -698.8076482852156, -42.18246703053412, -1158.3040774349727, -931.0565296456532, -47.35003284899371, -1086.0693612542375, -1347.8841104731928, -1221.4011502394358, -1250.8453435243355, -792.143146781398, -1186.9710473002929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5659768335864875, "mean_inference_ms": 1.6851943993699878, "mean_action_processing_ms": 0.282085823017364, "mean_env_wait_ms": 3.4495140103757613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013474225997924805, "StateBufferConnector_ms": 0.017188310623168945, "ViewRequirementAgentConnector_ms": 0.1954810619354248}, "num_episodes": 31, "episode_return_max": -42.18246703053412, "episode_return_min": -1441.4862547289076, "episode_return_mean": -770.695866895307, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.40514679324946, "num_env_steps_trained_throughput_per_sec": 303.40514679324946, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12870.373, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12870.305, "sample_time_ms": 1136.258, "learn_time_ms": 11671.133, "learn_throughput": 342.726, "synch_weights_time_ms": 62.126}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1e132_00002", "date": "2024-08-04_07-44-53", "timestamp": 1722737693, "time_this_iter_s": 13.195614576339722, "time_total_s": 77.29407000541687, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac121900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.29407000541687, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.74210526315789, "ram_util_percent": 28.110526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.19626844028632, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.639139550924301, "policy_loss": -0.013139565127009216, "vf_loss": 5.649087914824486, "vf_explained_var": 0.8898586828261614, "kl": 0.016689176419034387, "entropy": 1.4664314195513726, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -13.413043368539457, "episode_reward_min": -1441.4862547289076, "episode_reward_mean": -800.4938097124501, "episode_len_mean": 135.15, "episode_media": {}, "episodes_timesteps_total": 13515, "policy_reward_min": {"policy_0": -1441.4862547289076}, "policy_reward_max": {"policy_0": -13.413043368539457}, "policy_reward_mean": {"policy_0": -800.4938097124501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-989.918211961118, -174.4779149796557, -894.9149110175166, -448.9417651063768, -648.0800799605751, -1149.6333477866033, -583.4801061738806, -1038.1675629908373, -1069.8084257012283, -197.4067752431451, -1077.224160707873, -1441.4862547289076, -974.7750450806342, -67.26999345291365, -786.2458559297088, -699.8413572510823, -858.1475670703421, -1105.846052669981, -903.3119662560097, -1002.5023985887909, -940.3032829558688, -1230.9497644191495, -1014.6987468386427, -736.6685457089766, -873.5103920620923, -1027.577077915183, -835.4788610773624, -843.9214541051067, -634.4841114613, -146.37805109242174, -837.7557860222196, -732.186333877193, -1098.6587757790069, -956.764789598032, -1194.5059327980355, -963.7580002694701, -666.8994758224761, -467.90720893938595, -1286.814428859176, -440.05412053061366, -1396.68146211851, -558.5067932576751, -957.8972122178546, -93.35010216002587, -689.1794151807876, -958.5737623057788, -1025.3457106198164, -1086.1168925166053, -525.7634128911693, -246.7893195043021, -1087.8766063642922, -472.89105011204396, -335.80730387202505, -636.0046924443806, -616.8763849426176, -1312.1348798540575, -698.8076482852156, -42.18246703053412, -1158.3040774349727, -931.0565296456532, -47.35003284899371, -1086.0693612542375, -1347.8841104731928, -1221.4011502394358, -1250.8453435243355, -792.143146781398, -1186.9710473002929, -938.4501560621321, -448.52377608796974, -52.40882163372559, -707.6955781252229, -893.6426663525308, -1049.8566147219576, -352.2733627219458, -942.555411636975, -943.0328536758469, -307.0157159177291, -13.413043368539457, -1177.218680604208, -16.427272986518076, -477.4356250565161, -1209.3908020934625, -1192.2700837691016, -866.4558055972299, -990.9973574294117, -1235.731367645733, -1070.4075886799867, -749.4312375028054, -1187.0455765282557, -953.4930537356864, -1111.383058207102, -826.8210530200776, -881.5616007681742, -228.65523292925783, -1132.8516274830977, -985.0163014957718, -186.99765013678626, -942.1554958348737, -305.1352325148972, -870.0664589523918], "episode_lengths": [150, 81, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 47, 149, 150, 150, 150, 150, 98, 150, 145, 88, 150, 150, 150, 150, 48, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 103, 40, 128, 150, 150, 143, 150, 150, 85, 40, 150, 34, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 61, 150, 89, 150], "policy_policy_0_reward": [-989.918211961118, -174.4779149796557, -894.9149110175166, -448.9417651063768, -648.0800799605751, -1149.6333477866033, -583.4801061738806, -1038.1675629908373, -1069.8084257012283, -197.4067752431451, -1077.224160707873, -1441.4862547289076, -974.7750450806342, -67.26999345291365, -786.2458559297088, -699.8413572510823, -858.1475670703421, -1105.846052669981, -903.3119662560097, -1002.5023985887909, -940.3032829558688, -1230.9497644191495, -1014.6987468386427, -736.6685457089766, -873.5103920620923, -1027.577077915183, -835.4788610773624, -843.9214541051067, -634.4841114613, -146.37805109242174, -837.7557860222196, -732.186333877193, -1098.6587757790069, -956.764789598032, -1194.5059327980355, -963.7580002694701, -666.8994758224761, -467.90720893938595, -1286.814428859176, -440.05412053061366, -1396.68146211851, -558.5067932576751, -957.8972122178546, -93.35010216002587, -689.1794151807876, -958.5737623057788, -1025.3457106198164, -1086.1168925166053, -525.7634128911693, -246.7893195043021, -1087.8766063642922, -472.89105011204396, -335.80730387202505, -636.0046924443806, -616.8763849426176, -1312.1348798540575, -698.8076482852156, -42.18246703053412, -1158.3040774349727, -931.0565296456532, -47.35003284899371, -1086.0693612542375, -1347.8841104731928, -1221.4011502394358, -1250.8453435243355, -792.143146781398, -1186.9710473002929, -938.4501560621321, -448.52377608796974, -52.40882163372559, -707.6955781252229, -893.6426663525308, -1049.8566147219576, -352.2733627219458, -942.555411636975, -943.0328536758469, -307.0157159177291, -13.413043368539457, -1177.218680604208, -16.427272986518076, -477.4356250565161, -1209.3908020934625, -1192.2700837691016, -866.4558055972299, -990.9973574294117, -1235.731367645733, -1070.4075886799867, -749.4312375028054, -1187.0455765282557, -953.4930537356864, -1111.383058207102, -826.8210530200776, -881.5616007681742, -228.65523292925783, -1132.8516274830977, -985.0163014957718, -186.99765013678626, -942.1554958348737, -305.1352325148972, -870.0664589523918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5641110860149212, "mean_inference_ms": 1.6815533061038794, "mean_action_processing_ms": 0.2812845094178492, "mean_env_wait_ms": 3.450531287924917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01303553581237793, "StateBufferConnector_ms": 0.017033815383911133, "ViewRequirementAgentConnector_ms": 0.19542932510375977}, "num_episodes": 33, "episode_return_max": -13.413043368539457, "episode_return_min": -1441.4862547289076, "episode_return_mean": -800.4938097124501, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.78876374332697, "num_env_steps_trained_throughput_per_sec": 306.78876374332697, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12894.363, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12894.295, "sample_time_ms": 1162.873, "learn_time_ms": 11667.566, "learn_throughput": 342.831, "synch_weights_time_ms": 63.07}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1e132_00002", "date": "2024-08-04_07-45-06", "timestamp": 1722737706, "time_this_iter_s": 13.05094027519226, "time_total_s": 90.34501028060913, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac122710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.34501028060913, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.077777777777776, "ram_util_percent": 28.194444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.97923333744208, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.048096033682426, "policy_loss": -0.01618344592619299, "vf_loss": 5.060828282684088, "vf_explained_var": 0.9126754854495327, "kl": 0.017944925345909732, "entropy": 1.3779799909641346, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -13.413043368539457, "episode_reward_min": -1403.7721346183635, "episode_reward_mean": -748.8388508241763, "episode_len_mean": 131.03, "episode_media": {}, "episodes_timesteps_total": 13103, "policy_reward_min": {"policy_0": -1403.7721346183635}, "policy_reward_max": {"policy_0": -13.413043368539457}, "policy_reward_mean": {"policy_0": -748.8388508241763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.37805109242174, -837.7557860222196, -732.186333877193, -1098.6587757790069, -956.764789598032, -1194.5059327980355, -963.7580002694701, -666.8994758224761, -467.90720893938595, -1286.814428859176, -440.05412053061366, -1396.68146211851, -558.5067932576751, -957.8972122178546, -93.35010216002587, -689.1794151807876, -958.5737623057788, -1025.3457106198164, -1086.1168925166053, -525.7634128911693, -246.7893195043021, -1087.8766063642922, -472.89105011204396, -335.80730387202505, -636.0046924443806, -616.8763849426176, -1312.1348798540575, -698.8076482852156, -42.18246703053412, -1158.3040774349727, -931.0565296456532, -47.35003284899371, -1086.0693612542375, -1347.8841104731928, -1221.4011502394358, -1250.8453435243355, -792.143146781398, -1186.9710473002929, -938.4501560621321, -448.52377608796974, -52.40882163372559, -707.6955781252229, -893.6426663525308, -1049.8566147219576, -352.2733627219458, -942.555411636975, -943.0328536758469, -307.0157159177291, -13.413043368539457, -1177.218680604208, -16.427272986518076, -477.4356250565161, -1209.3908020934625, -1192.2700837691016, -866.4558055972299, -990.9973574294117, -1235.731367645733, -1070.4075886799867, -749.4312375028054, -1187.0455765282557, -953.4930537356864, -1111.383058207102, -826.8210530200776, -881.5616007681742, -228.65523292925783, -1132.8516274830977, -985.0163014957718, -186.99765013678626, -942.1554958348737, -305.1352325148972, -870.0664589523918, -976.4658034519722, -564.1859264249065, -1220.368204914535, -1138.9207908377066, -823.6014595278493, -993.1139253181141, -970.3007751685659, -437.01203862406976, -892.1795996543584, -144.45042920722435, -90.72237755712837, -1129.3899916134974, -1289.6182873467378, -552.1272185366079, -205.86563495579378, -211.58101782950502, -473.5511019886314, -903.750920061994, -61.77922052111724, -1403.7721346183635, -721.2491837164383, -47.72796308520094, -346.17272739598025, -278.4551163686338, -701.9810592975109, -540.8700218346623, -359.23155388279486, -632.2207102989124, -972.9109063346498], "episode_lengths": [78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 47, 149, 150, 150, 150, 150, 98, 150, 145, 88, 150, 150, 150, 150, 48, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 103, 40, 128, 150, 150, 143, 150, 150, 85, 40, 150, 34, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 61, 150, 89, 150, 150, 130, 150, 150, 150, 150, 150, 144, 150, 77, 66, 150, 150, 150, 79, 64, 150, 150, 53, 150, 150, 57, 139, 79, 150, 132, 150, 126, 150], "policy_policy_0_reward": [-146.37805109242174, -837.7557860222196, -732.186333877193, -1098.6587757790069, -956.764789598032, -1194.5059327980355, -963.7580002694701, -666.8994758224761, -467.90720893938595, -1286.814428859176, -440.05412053061366, -1396.68146211851, -558.5067932576751, -957.8972122178546, -93.35010216002587, -689.1794151807876, -958.5737623057788, -1025.3457106198164, -1086.1168925166053, -525.7634128911693, -246.7893195043021, -1087.8766063642922, -472.89105011204396, -335.80730387202505, -636.0046924443806, -616.8763849426176, -1312.1348798540575, -698.8076482852156, -42.18246703053412, -1158.3040774349727, -931.0565296456532, -47.35003284899371, -1086.0693612542375, -1347.8841104731928, -1221.4011502394358, -1250.8453435243355, -792.143146781398, -1186.9710473002929, -938.4501560621321, -448.52377608796974, -52.40882163372559, -707.6955781252229, -893.6426663525308, -1049.8566147219576, -352.2733627219458, -942.555411636975, -943.0328536758469, -307.0157159177291, -13.413043368539457, -1177.218680604208, -16.427272986518076, -477.4356250565161, -1209.3908020934625, -1192.2700837691016, -866.4558055972299, -990.9973574294117, -1235.731367645733, -1070.4075886799867, -749.4312375028054, -1187.0455765282557, -953.4930537356864, -1111.383058207102, -826.8210530200776, -881.5616007681742, -228.65523292925783, -1132.8516274830977, -985.0163014957718, -186.99765013678626, -942.1554958348737, -305.1352325148972, -870.0664589523918, -976.4658034519722, -564.1859264249065, -1220.368204914535, -1138.9207908377066, -823.6014595278493, -993.1139253181141, -970.3007751685659, -437.01203862406976, -892.1795996543584, -144.45042920722435, -90.72237755712837, -1129.3899916134974, -1289.6182873467378, -552.1272185366079, -205.86563495579378, -211.58101782950502, -473.5511019886314, -903.750920061994, -61.77922052111724, -1403.7721346183635, -721.2491837164383, -47.72796308520094, -346.17272739598025, -278.4551163686338, -701.9810592975109, -540.8700218346623, -359.23155388279486, -632.2207102989124, -972.9109063346498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628895548925549, "mean_inference_ms": 1.681212230671266, "mean_action_processing_ms": 0.2810718880927333, "mean_env_wait_ms": 3.453867858417389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012659788131713867, "StateBufferConnector_ms": 0.00864267349243164, "ViewRequirementAgentConnector_ms": 0.19290518760681152}, "num_episodes": 29, "episode_return_max": -13.413043368539457, "episode_return_min": -1403.7721346183635, "episode_return_mean": -748.8388508241763, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.0191166651914, "num_env_steps_trained_throughput_per_sec": 321.0191166651914, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12840.109, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12840.039, "sample_time_ms": 1160.375, "learn_time_ms": 11613.71, "learn_throughput": 344.421, "synch_weights_time_ms": 65.142}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1e132_00002", "date": "2024-08-04_07-45-19", "timestamp": 1722737719, "time_this_iter_s": 12.473509788513184, "time_total_s": 102.81852006912231, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bf130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.81852006912231, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.055555555555557, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.55991925795873, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.104014755785466, "policy_loss": -0.017408229470311197, "vf_loss": 5.117079918583234, "vf_explained_var": 0.9015270481506984, "kl": 0.022434013101261977, "entropy": 1.4373176413277784, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -13.413043368539457, "episode_reward_min": -1403.7721346183635, "episode_reward_mean": -717.4506702782953, "episode_len_mean": 127.1, "episode_media": {}, "episodes_timesteps_total": 12710, "policy_reward_min": {"policy_0": -1403.7721346183635}, "policy_reward_max": {"policy_0": -13.413043368539457}, "policy_reward_mean": {"policy_0": -717.4506702782953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1347.8841104731928, -1221.4011502394358, -1250.8453435243355, -792.143146781398, -1186.9710473002929, -938.4501560621321, -448.52377608796974, -52.40882163372559, -707.6955781252229, -893.6426663525308, -1049.8566147219576, -352.2733627219458, -942.555411636975, -943.0328536758469, -307.0157159177291, -13.413043368539457, -1177.218680604208, -16.427272986518076, -477.4356250565161, -1209.3908020934625, -1192.2700837691016, -866.4558055972299, -990.9973574294117, -1235.731367645733, -1070.4075886799867, -749.4312375028054, -1187.0455765282557, -953.4930537356864, -1111.383058207102, -826.8210530200776, -881.5616007681742, -228.65523292925783, -1132.8516274830977, -985.0163014957718, -186.99765013678626, -942.1554958348737, -305.1352325148972, -870.0664589523918, -976.4658034519722, -564.1859264249065, -1220.368204914535, -1138.9207908377066, -823.6014595278493, -993.1139253181141, -970.3007751685659, -437.01203862406976, -892.1795996543584, -144.45042920722435, -90.72237755712837, -1129.3899916134974, -1289.6182873467378, -552.1272185366079, -205.86563495579378, -211.58101782950502, -473.5511019886314, -903.750920061994, -61.77922052111724, -1403.7721346183635, -721.2491837164383, -47.72796308520094, -346.17272739598025, -278.4551163686338, -701.9810592975109, -540.8700218346623, -359.23155388279486, -632.2207102989124, -972.9109063346498, -1030.6419272562473, -918.712388893038, -600.8912794073796, -433.10178044816774, -1000.6293986484806, -1005.0350586443548, -1186.7172304360217, -57.56474360288645, -273.48523104755293, -493.2808211923531, -286.4788487283668, -1064.4200198501694, -33.02538247373228, -912.4271681873233, -1023.8489040929298, -389.6557341883637, -410.2692913909679, -1114.992387320562, -672.825453868612, -63.34133481343946, -961.0656761969751, -482.88616350257047, -553.4340268097784, -938.7825721942627, -1053.2789619500825, -460.4965785459979, -185.0567597869587, -394.90351380607814, -605.9254782171287, -1122.1023021945643, -700.8298104866994, -1108.714124844728, -77.60961283472686], "episode_lengths": [150, 150, 150, 150, 150, 150, 103, 40, 128, 150, 150, 143, 150, 150, 85, 40, 150, 34, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 61, 150, 89, 150, 150, 130, 150, 150, 150, 150, 150, 144, 150, 77, 66, 150, 150, 150, 79, 64, 150, 150, 53, 150, 150, 57, 139, 79, 150, 132, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 40, 87, 102, 75, 150, 50, 150, 150, 97, 96, 150, 150, 56, 150, 107, 116, 150, 150, 150, 79, 110, 114, 150, 150, 150, 62], "policy_policy_0_reward": [-1347.8841104731928, -1221.4011502394358, -1250.8453435243355, -792.143146781398, -1186.9710473002929, -938.4501560621321, -448.52377608796974, -52.40882163372559, -707.6955781252229, -893.6426663525308, -1049.8566147219576, -352.2733627219458, -942.555411636975, -943.0328536758469, -307.0157159177291, -13.413043368539457, -1177.218680604208, -16.427272986518076, -477.4356250565161, -1209.3908020934625, -1192.2700837691016, -866.4558055972299, -990.9973574294117, -1235.731367645733, -1070.4075886799867, -749.4312375028054, -1187.0455765282557, -953.4930537356864, -1111.383058207102, -826.8210530200776, -881.5616007681742, -228.65523292925783, -1132.8516274830977, -985.0163014957718, -186.99765013678626, -942.1554958348737, -305.1352325148972, -870.0664589523918, -976.4658034519722, -564.1859264249065, -1220.368204914535, -1138.9207908377066, -823.6014595278493, -993.1139253181141, -970.3007751685659, -437.01203862406976, -892.1795996543584, -144.45042920722435, -90.72237755712837, -1129.3899916134974, -1289.6182873467378, -552.1272185366079, -205.86563495579378, -211.58101782950502, -473.5511019886314, -903.750920061994, -61.77922052111724, -1403.7721346183635, -721.2491837164383, -47.72796308520094, -346.17272739598025, -278.4551163686338, -701.9810592975109, -540.8700218346623, -359.23155388279486, -632.2207102989124, -972.9109063346498, -1030.6419272562473, -918.712388893038, -600.8912794073796, -433.10178044816774, -1000.6293986484806, -1005.0350586443548, -1186.7172304360217, -57.56474360288645, -273.48523104755293, -493.2808211923531, -286.4788487283668, -1064.4200198501694, -33.02538247373228, -912.4271681873233, -1023.8489040929298, -389.6557341883637, -410.2692913909679, -1114.992387320562, -672.825453868612, -63.34133481343946, -961.0656761969751, -482.88616350257047, -553.4340268097784, -938.7825721942627, -1053.2789619500825, -460.4965785459979, -185.0567597869587, -394.90351380607814, -605.9254782171287, -1122.1023021945643, -700.8298104866994, -1108.714124844728, -77.60961283472686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615082149428173, "mean_inference_ms": 1.6805560977093967, "mean_action_processing_ms": 0.2797840140749053, "mean_env_wait_ms": 3.4541861905289157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012138843536376953, "StateBufferConnector_ms": 0.008210420608520508, "ViewRequirementAgentConnector_ms": 0.19226813316345215}, "num_episodes": 33, "episode_return_max": -13.413043368539457, "episode_return_min": -1403.7721346183635, "episode_return_mean": -717.4506702782953, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8284103561707, "num_env_steps_trained_throughput_per_sec": 307.8284103561707, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12857.238, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12857.165, "sample_time_ms": 1156.012, "learn_time_ms": 11634.878, "learn_throughput": 343.794, "synch_weights_time_ms": 65.425}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1e132_00002", "date": "2024-08-04_07-45-32", "timestamp": 1722737732, "time_this_iter_s": 13.006107330322266, "time_total_s": 115.82462739944458, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544895a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.82462739944458, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.62105263157895, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.19061554074287, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.670975779245297, "policy_loss": -0.009253008744174925, "vf_loss": 4.675797098875046, "vf_explained_var": 0.9459347855920593, "kl": 0.015250481440792414, "entropy": 1.4345207293828328, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -33.02538247373228, "episode_reward_min": -1403.7721346183635, "episode_reward_mean": -671.9580727314237, "episode_len_mean": 125.35, "episode_media": {}, "episodes_timesteps_total": 12535, "policy_reward_min": {"policy_0": -1403.7721346183635}, "policy_reward_max": {"policy_0": -33.02538247373228}, "policy_reward_mean": {"policy_0": -671.9580727314237}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-228.65523292925783, -1132.8516274830977, -985.0163014957718, -186.99765013678626, -942.1554958348737, -305.1352325148972, -870.0664589523918, -976.4658034519722, -564.1859264249065, -1220.368204914535, -1138.9207908377066, -823.6014595278493, -993.1139253181141, -970.3007751685659, -437.01203862406976, -892.1795996543584, -144.45042920722435, -90.72237755712837, -1129.3899916134974, -1289.6182873467378, -552.1272185366079, -205.86563495579378, -211.58101782950502, -473.5511019886314, -903.750920061994, -61.77922052111724, -1403.7721346183635, -721.2491837164383, -47.72796308520094, -346.17272739598025, -278.4551163686338, -701.9810592975109, -540.8700218346623, -359.23155388279486, -632.2207102989124, -972.9109063346498, -1030.6419272562473, -918.712388893038, -600.8912794073796, -433.10178044816774, -1000.6293986484806, -1005.0350586443548, -1186.7172304360217, -57.56474360288645, -273.48523104755293, -493.2808211923531, -286.4788487283668, -1064.4200198501694, -33.02538247373228, -912.4271681873233, -1023.8489040929298, -389.6557341883637, -410.2692913909679, -1114.992387320562, -672.825453868612, -63.34133481343946, -961.0656761969751, -482.88616350257047, -553.4340268097784, -938.7825721942627, -1053.2789619500825, -460.4965785459979, -185.0567597869587, -394.90351380607814, -605.9254782171287, -1122.1023021945643, -700.8298104866994, -1108.714124844728, -77.60961283472686, -1015.130343768491, -711.3289499935776, -422.9469527288341, -625.8791924278108, -1243.8116590020013, -59.100386142632416, -76.82606230903069, -879.7490095743382, -642.7729850563962, -1025.0809675604726, -117.62388935056028, -877.2516401099946, -805.937153857008, -1060.879995781365, -234.9677310162698, -185.39168033813803, -936.6879679625754, -812.6779549342231, -878.9071877030966, -507.9049424195551, -1284.6951771992383, -119.73683215876937, -926.8332547571292, -1176.1687340707997, -937.4965767975385, -949.3473669713126, -258.2782329277928, -1037.9432793454516, -1045.2522898857935, -924.0389714472526, -64.27583996286478], "episode_lengths": [85, 150, 150, 61, 150, 89, 150, 150, 130, 150, 150, 150, 150, 150, 144, 150, 77, 66, 150, 150, 150, 79, 64, 150, 150, 53, 150, 150, 57, 139, 79, 150, 132, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 40, 87, 102, 75, 150, 50, 150, 150, 97, 96, 150, 150, 56, 150, 107, 116, 150, 150, 150, 79, 110, 114, 150, 150, 150, 62, 150, 150, 119, 150, 150, 61, 59, 150, 150, 150, 62, 150, 150, 150, 66, 92, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 77, 150, 150, 150, 57], "policy_policy_0_reward": [-228.65523292925783, -1132.8516274830977, -985.0163014957718, -186.99765013678626, -942.1554958348737, -305.1352325148972, -870.0664589523918, -976.4658034519722, -564.1859264249065, -1220.368204914535, -1138.9207908377066, -823.6014595278493, -993.1139253181141, -970.3007751685659, -437.01203862406976, -892.1795996543584, -144.45042920722435, -90.72237755712837, -1129.3899916134974, -1289.6182873467378, -552.1272185366079, -205.86563495579378, -211.58101782950502, -473.5511019886314, -903.750920061994, -61.77922052111724, -1403.7721346183635, -721.2491837164383, -47.72796308520094, -346.17272739598025, -278.4551163686338, -701.9810592975109, -540.8700218346623, -359.23155388279486, -632.2207102989124, -972.9109063346498, -1030.6419272562473, -918.712388893038, -600.8912794073796, -433.10178044816774, -1000.6293986484806, -1005.0350586443548, -1186.7172304360217, -57.56474360288645, -273.48523104755293, -493.2808211923531, -286.4788487283668, -1064.4200198501694, -33.02538247373228, -912.4271681873233, -1023.8489040929298, -389.6557341883637, -410.2692913909679, -1114.992387320562, -672.825453868612, -63.34133481343946, -961.0656761969751, -482.88616350257047, -553.4340268097784, -938.7825721942627, -1053.2789619500825, -460.4965785459979, -185.0567597869587, -394.90351380607814, -605.9254782171287, -1122.1023021945643, -700.8298104866994, -1108.714124844728, -77.60961283472686, -1015.130343768491, -711.3289499935776, -422.9469527288341, -625.8791924278108, -1243.8116590020013, -59.100386142632416, -76.82606230903069, -879.7490095743382, -642.7729850563962, -1025.0809675604726, -117.62388935056028, -877.2516401099946, -805.937153857008, -1060.879995781365, -234.9677310162698, -185.39168033813803, -936.6879679625754, -812.6779549342231, -878.9071877030966, -507.9049424195551, -1284.6951771992383, -119.73683215876937, -926.8332547571292, -1176.1687340707997, -937.4965767975385, -949.3473669713126, -258.2782329277928, -1037.9432793454516, -1045.2522898857935, -924.0389714472526, -64.27583996286478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5603478502165691, "mean_inference_ms": 1.681357478738147, "mean_action_processing_ms": 0.27939600950868365, "mean_env_wait_ms": 3.4593121134873104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012014627456665039, "StateBufferConnector_ms": 0.008032798767089844, "ViewRequirementAgentConnector_ms": 0.19113969802856445}, "num_episodes": 31, "episode_return_max": -33.02538247373228, "episode_return_min": -1403.7721346183635, "episode_return_mean": -671.9580727314237, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.97073605527373, "num_env_steps_trained_throughput_per_sec": 312.97073605527373, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12849.59, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12849.518, "sample_time_ms": 1165.31, "learn_time_ms": 11618.082, "learn_throughput": 344.291, "synch_weights_time_ms": 65.285}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1e132_00002", "date": "2024-08-04_07-45-45", "timestamp": 1722737745, "time_this_iter_s": 12.793848752975464, "time_total_s": 128.61847615242004, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac121870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.61847615242004, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.000000000000004, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.88646409312884, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.558311649411917, "policy_loss": -0.008731453441335664, "vf_loss": 4.562626275668541, "vf_explained_var": 0.9648030983284116, "kl": 0.015173679002449111, "entropy": 1.3526599430168669, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -2.88859384329026, "episode_reward_min": -1416.3723413812036, "episode_reward_mean": -686.2798898253365, "episode_len_mean": 124.87, "episode_media": {}, "episodes_timesteps_total": 12487, "policy_reward_min": {"policy_0": -1416.3723413812036}, "policy_reward_max": {"policy_0": -2.88859384329026}, "policy_reward_mean": {"policy_0": -686.2798898253365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-632.2207102989124, -972.9109063346498, -1030.6419272562473, -918.712388893038, -600.8912794073796, -433.10178044816774, -1000.6293986484806, -1005.0350586443548, -1186.7172304360217, -57.56474360288645, -273.48523104755293, -493.2808211923531, -286.4788487283668, -1064.4200198501694, -33.02538247373228, -912.4271681873233, -1023.8489040929298, -389.6557341883637, -410.2692913909679, -1114.992387320562, -672.825453868612, -63.34133481343946, -961.0656761969751, -482.88616350257047, -553.4340268097784, -938.7825721942627, -1053.2789619500825, -460.4965785459979, -185.0567597869587, -394.90351380607814, -605.9254782171287, -1122.1023021945643, -700.8298104866994, -1108.714124844728, -77.60961283472686, -1015.130343768491, -711.3289499935776, -422.9469527288341, -625.8791924278108, -1243.8116590020013, -59.100386142632416, -76.82606230903069, -879.7490095743382, -642.7729850563962, -1025.0809675604726, -117.62388935056028, -877.2516401099946, -805.937153857008, -1060.879995781365, -234.9677310162698, -185.39168033813803, -936.6879679625754, -812.6779549342231, -878.9071877030966, -507.9049424195551, -1284.6951771992383, -119.73683215876937, -926.8332547571292, -1176.1687340707997, -937.4965767975385, -949.3473669713126, -258.2782329277928, -1037.9432793454516, -1045.2522898857935, -924.0389714472526, -64.27583996286478, -1031.9681790270074, -663.2892493767763, -1248.8203409711641, -92.72134119360962, -18.35021340942569, -899.4255288838458, -755.2788077527185, -575.7257523359722, -66.34095883527945, -2.88859384329026, -1390.6636821361215, -363.43225382799574, -911.9687869067048, -125.63331318813663, -1177.176758077668, -1202.5438187446334, -188.93226874648468, -608.0294067546654, -1293.582351776076, -814.9106555445658, -17.166837766497473, -504.6521962038371, -672.3547858091898, -861.3718316887697, -889.2109102781536, -1079.1155046917315, -1148.3874994579016, -1143.8891817927547, -78.25505145627888, -1416.3723413812036, -305.52755370390867, -106.98187708064668, -699.8860116689293, -1206.6503481663215], "episode_lengths": [126, 150, 150, 150, 150, 150, 150, 150, 150, 40, 87, 102, 75, 150, 50, 150, 150, 97, 96, 150, 150, 56, 150, 107, 116, 150, 150, 150, 79, 110, 114, 150, 150, 150, 62, 150, 150, 119, 150, 150, 61, 59, 150, 150, 150, 62, 150, 150, 150, 66, 92, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 77, 150, 150, 150, 57, 150, 150, 150, 59, 51, 150, 150, 150, 63, 33, 150, 89, 150, 75, 150, 150, 108, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 77, 150, 92, 67, 150, 150], "policy_policy_0_reward": [-632.2207102989124, -972.9109063346498, -1030.6419272562473, -918.712388893038, -600.8912794073796, -433.10178044816774, -1000.6293986484806, -1005.0350586443548, -1186.7172304360217, -57.56474360288645, -273.48523104755293, -493.2808211923531, -286.4788487283668, -1064.4200198501694, -33.02538247373228, -912.4271681873233, -1023.8489040929298, -389.6557341883637, -410.2692913909679, -1114.992387320562, -672.825453868612, -63.34133481343946, -961.0656761969751, -482.88616350257047, -553.4340268097784, -938.7825721942627, -1053.2789619500825, -460.4965785459979, -185.0567597869587, -394.90351380607814, -605.9254782171287, -1122.1023021945643, -700.8298104866994, -1108.714124844728, -77.60961283472686, -1015.130343768491, -711.3289499935776, -422.9469527288341, -625.8791924278108, -1243.8116590020013, -59.100386142632416, -76.82606230903069, -879.7490095743382, -642.7729850563962, -1025.0809675604726, -117.62388935056028, -877.2516401099946, -805.937153857008, -1060.879995781365, -234.9677310162698, -185.39168033813803, -936.6879679625754, -812.6779549342231, -878.9071877030966, -507.9049424195551, -1284.6951771992383, -119.73683215876937, -926.8332547571292, -1176.1687340707997, -937.4965767975385, -949.3473669713126, -258.2782329277928, -1037.9432793454516, -1045.2522898857935, -924.0389714472526, -64.27583996286478, -1031.9681790270074, -663.2892493767763, -1248.8203409711641, -92.72134119360962, -18.35021340942569, -899.4255288838458, -755.2788077527185, -575.7257523359722, -66.34095883527945, -2.88859384329026, -1390.6636821361215, -363.43225382799574, -911.9687869067048, -125.63331318813663, -1177.176758077668, -1202.5438187446334, -188.93226874648468, -608.0294067546654, -1293.582351776076, -814.9106555445658, -17.166837766497473, -504.6521962038371, -672.3547858091898, -861.3718316887697, -889.2109102781536, -1079.1155046917315, -1148.3874994579016, -1143.8891817927547, -78.25505145627888, -1416.3723413812036, -305.52755370390867, -106.98187708064668, -699.8860116689293, -1206.6503481663215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5604828840825266, "mean_inference_ms": 1.6831488900032434, "mean_action_processing_ms": 0.27961646755717395, "mean_env_wait_ms": 3.4701898605643713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012052297592163086, "StateBufferConnector_ms": 0.00823354721069336, "ViewRequirementAgentConnector_ms": 0.1981983184814453}, "num_episodes": 34, "episode_return_max": -2.88859384329026, "episode_return_min": -1416.3723413812036, "episode_return_mean": -686.2798898253365, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.1649275478385, "num_env_steps_trained_throughput_per_sec": 311.1649275478385, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12833.964, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12833.892, "sample_time_ms": 1152.037, "learn_time_ms": 11617.179, "learn_throughput": 344.318, "synch_weights_time_ms": 63.843}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1e132_00002", "date": "2024-08-04_07-45-58", "timestamp": 1722737758, "time_this_iter_s": 12.867552757263184, "time_total_s": 141.48602890968323, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bf130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.48602890968323, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.038888888888888, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.72236252029737, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.076817281295856, "policy_loss": -0.010619421744680342, "vf_loss": 4.083491834998131, "vf_explained_var": 0.9608953240637977, "kl": 0.01359231003701402, "entropy": 1.3282171471665303, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -2.88859384329026, "episode_reward_min": -1416.3723413812036, "episode_reward_mean": -693.6611574904158, "episode_len_mean": 126.79, "episode_media": {}, "episodes_timesteps_total": 12679, "policy_reward_min": {"policy_0": -1416.3723413812036}, "policy_reward_max": {"policy_0": -2.88859384329026}, "policy_reward_mean": {"policy_0": -693.6611574904158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-605.9254782171287, -1122.1023021945643, -700.8298104866994, -1108.714124844728, -77.60961283472686, -1015.130343768491, -711.3289499935776, -422.9469527288341, -625.8791924278108, -1243.8116590020013, -59.100386142632416, -76.82606230903069, -879.7490095743382, -642.7729850563962, -1025.0809675604726, -117.62388935056028, -877.2516401099946, -805.937153857008, -1060.879995781365, -234.9677310162698, -185.39168033813803, -936.6879679625754, -812.6779549342231, -878.9071877030966, -507.9049424195551, -1284.6951771992383, -119.73683215876937, -926.8332547571292, -1176.1687340707997, -937.4965767975385, -949.3473669713126, -258.2782329277928, -1037.9432793454516, -1045.2522898857935, -924.0389714472526, -64.27583996286478, -1031.9681790270074, -663.2892493767763, -1248.8203409711641, -92.72134119360962, -18.35021340942569, -899.4255288838458, -755.2788077527185, -575.7257523359722, -66.34095883527945, -2.88859384329026, -1390.6636821361215, -363.43225382799574, -911.9687869067048, -125.63331318813663, -1177.176758077668, -1202.5438187446334, -188.93226874648468, -608.0294067546654, -1293.582351776076, -814.9106555445658, -17.166837766497473, -504.6521962038371, -672.3547858091898, -861.3718316887697, -889.2109102781536, -1079.1155046917315, -1148.3874994579016, -1143.8891817927547, -78.25505145627888, -1416.3723413812036, -305.52755370390867, -106.98187708064668, -699.8860116689293, -1206.6503481663215, -754.9822577778859, -889.7568808713083, -69.44717135991428, -62.59022237397392, -1003.2011872372723, -657.7684273161035, -640.1958145583503, -649.7298965033399, -1079.21066329245, -650.2058443870392, -952.4015803105331, -651.5634013083393, -1235.2957803236413, -571.813789003718, -323.3121910536597, -1177.3639947988404, -1314.27373064363, -399.12420654532474, -527.3861033273674, -33.45912219619531, -305.4134797592868, -768.9303327912676, -384.6191115637301, -339.4990233940154, -1011.2082289057739, -1032.2783674904194, -474.87746509137787, -153.22610334605304, -1088.6139159407142, -1142.7587269536311], "episode_lengths": [114, 150, 150, 150, 62, 150, 150, 119, 150, 150, 61, 59, 150, 150, 150, 62, 150, 150, 150, 66, 92, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 77, 150, 150, 150, 57, 150, 150, 150, 59, 51, 150, 150, 150, 63, 33, 150, 89, 150, 75, 150, 150, 108, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 77, 150, 92, 67, 150, 150, 149, 150, 67, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 87, 150, 150, 150, 140, 49, 80, 150, 150, 85, 150, 150, 150, 55, 150, 150], "policy_policy_0_reward": [-605.9254782171287, -1122.1023021945643, -700.8298104866994, -1108.714124844728, -77.60961283472686, -1015.130343768491, -711.3289499935776, -422.9469527288341, -625.8791924278108, -1243.8116590020013, -59.100386142632416, -76.82606230903069, -879.7490095743382, -642.7729850563962, -1025.0809675604726, -117.62388935056028, -877.2516401099946, -805.937153857008, -1060.879995781365, -234.9677310162698, -185.39168033813803, -936.6879679625754, -812.6779549342231, -878.9071877030966, -507.9049424195551, -1284.6951771992383, -119.73683215876937, -926.8332547571292, -1176.1687340707997, -937.4965767975385, -949.3473669713126, -258.2782329277928, -1037.9432793454516, -1045.2522898857935, -924.0389714472526, -64.27583996286478, -1031.9681790270074, -663.2892493767763, -1248.8203409711641, -92.72134119360962, -18.35021340942569, -899.4255288838458, -755.2788077527185, -575.7257523359722, -66.34095883527945, -2.88859384329026, -1390.6636821361215, -363.43225382799574, -911.9687869067048, -125.63331318813663, -1177.176758077668, -1202.5438187446334, -188.93226874648468, -608.0294067546654, -1293.582351776076, -814.9106555445658, -17.166837766497473, -504.6521962038371, -672.3547858091898, -861.3718316887697, -889.2109102781536, -1079.1155046917315, -1148.3874994579016, -1143.8891817927547, -78.25505145627888, -1416.3723413812036, -305.52755370390867, -106.98187708064668, -699.8860116689293, -1206.6503481663215, -754.9822577778859, -889.7568808713083, -69.44717135991428, -62.59022237397392, -1003.2011872372723, -657.7684273161035, -640.1958145583503, -649.7298965033399, -1079.21066329245, -650.2058443870392, -952.4015803105331, -651.5634013083393, -1235.2957803236413, -571.813789003718, -323.3121910536597, -1177.3639947988404, -1314.27373064363, -399.12420654532474, -527.3861033273674, -33.45912219619531, -305.4134797592868, -768.9303327912676, -384.6191115637301, -339.4990233940154, -1011.2082289057739, -1032.2783674904194, -474.87746509137787, -153.22610334605304, -1088.6139159407142, -1142.7587269536311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590262436660197, "mean_inference_ms": 1.6831326287776707, "mean_action_processing_ms": 0.27960465125955636, "mean_env_wait_ms": 3.4738423909707454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012445926666259766, "StateBufferConnector_ms": 0.008172035217285156, "ViewRequirementAgentConnector_ms": 0.19665980339050293}, "num_episodes": 30, "episode_return_max": -2.88859384329026, "episode_return_min": -1416.3723413812036, "episode_return_mean": -693.6611574904158, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.5051906717442, "num_env_steps_trained_throughput_per_sec": 306.5051906717442, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12837.834, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12837.764, "sample_time_ms": 1153.722, "learn_time_ms": 11618.656, "learn_throughput": 344.274, "synch_weights_time_ms": 64.546}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1e132_00002", "date": "2024-08-04_07-46-11", "timestamp": 1722737771, "time_this_iter_s": 13.062061786651611, "time_total_s": 154.54809069633484, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544895a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.54809069633484, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.59473684210526, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.04380950331688, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.233800928791364, "policy_loss": -0.010809797503073544, "vf_loss": 4.239985134452581, "vf_explained_var": 0.9696707007164757, "kl": 0.0158488051398308, "entropy": 1.2905333949873845, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -2.88859384329026, "episode_reward_min": -1416.3723413812036, "episode_reward_mean": -669.2340640448424, "episode_len_mean": 127.6, "episode_media": {}, "episodes_timesteps_total": 12760, "policy_reward_min": {"policy_0": -1416.3723413812036}, "policy_reward_max": {"policy_0": -2.88859384329026}, "policy_reward_mean": {"policy_0": -669.2340640448424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1037.9432793454516, -1045.2522898857935, -924.0389714472526, -64.27583996286478, -1031.9681790270074, -663.2892493767763, -1248.8203409711641, -92.72134119360962, -18.35021340942569, -899.4255288838458, -755.2788077527185, -575.7257523359722, -66.34095883527945, -2.88859384329026, -1390.6636821361215, -363.43225382799574, -911.9687869067048, -125.63331318813663, -1177.176758077668, -1202.5438187446334, -188.93226874648468, -608.0294067546654, -1293.582351776076, -814.9106555445658, -17.166837766497473, -504.6521962038371, -672.3547858091898, -861.3718316887697, -889.2109102781536, -1079.1155046917315, -1148.3874994579016, -1143.8891817927547, -78.25505145627888, -1416.3723413812036, -305.52755370390867, -106.98187708064668, -699.8860116689293, -1206.6503481663215, -754.9822577778859, -889.7568808713083, -69.44717135991428, -62.59022237397392, -1003.2011872372723, -657.7684273161035, -640.1958145583503, -649.7298965033399, -1079.21066329245, -650.2058443870392, -952.4015803105331, -651.5634013083393, -1235.2957803236413, -571.813789003718, -323.3121910536597, -1177.3639947988404, -1314.27373064363, -399.12420654532474, -527.3861033273674, -33.45912219619531, -305.4134797592868, -768.9303327912676, -384.6191115637301, -339.4990233940154, -1011.2082289057739, -1032.2783674904194, -474.87746509137787, -153.22610334605304, -1088.6139159407142, -1142.7587269536311, -616.1883469898532, -935.9009226424266, -257.32601304525895, -57.470284348766654, -96.23791858504873, -1255.2170291443238, -488.1396949578448, -1152.2976335414608, -956.6797789669084, -312.93439709521664, -936.3393393235858, -1025.6622282879655, -1206.5808813874014, -167.46957840924443, -803.5059869840147, -80.62726238446628, -457.4698919166529, -519.1226787853484, -1045.4953805897278, -553.2478866327842, -55.44573560599005, -1180.1453704995731, -530.4552785318394, -469.97471198586896, -1001.3037858119195, -577.034395242859, -609.8322729451282, -313.7512395764021, -478.99633643588317, -414.2671917199861, -1302.4585342341366, -88.30682433156049], "episode_lengths": [150, 150, 150, 57, 150, 150, 150, 59, 51, 150, 150, 150, 63, 33, 150, 89, 150, 75, 150, 150, 108, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 77, 150, 92, 67, 150, 150, 149, 150, 67, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 87, 150, 150, 150, 140, 49, 80, 150, 150, 85, 150, 150, 150, 55, 150, 150, 150, 150, 150, 59, 61, 150, 116, 150, 150, 136, 150, 150, 150, 95, 150, 57, 106, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 147, 111, 150, 150, 69], "policy_policy_0_reward": [-1037.9432793454516, -1045.2522898857935, -924.0389714472526, -64.27583996286478, -1031.9681790270074, -663.2892493767763, -1248.8203409711641, -92.72134119360962, -18.35021340942569, -899.4255288838458, -755.2788077527185, -575.7257523359722, -66.34095883527945, -2.88859384329026, -1390.6636821361215, -363.43225382799574, -911.9687869067048, -125.63331318813663, -1177.176758077668, -1202.5438187446334, -188.93226874648468, -608.0294067546654, -1293.582351776076, -814.9106555445658, -17.166837766497473, -504.6521962038371, -672.3547858091898, -861.3718316887697, -889.2109102781536, -1079.1155046917315, -1148.3874994579016, -1143.8891817927547, -78.25505145627888, -1416.3723413812036, -305.52755370390867, -106.98187708064668, -699.8860116689293, -1206.6503481663215, -754.9822577778859, -889.7568808713083, -69.44717135991428, -62.59022237397392, -1003.2011872372723, -657.7684273161035, -640.1958145583503, -649.7298965033399, -1079.21066329245, -650.2058443870392, -952.4015803105331, -651.5634013083393, -1235.2957803236413, -571.813789003718, -323.3121910536597, -1177.3639947988404, -1314.27373064363, -399.12420654532474, -527.3861033273674, -33.45912219619531, -305.4134797592868, -768.9303327912676, -384.6191115637301, -339.4990233940154, -1011.2082289057739, -1032.2783674904194, -474.87746509137787, -153.22610334605304, -1088.6139159407142, -1142.7587269536311, -616.1883469898532, -935.9009226424266, -257.32601304525895, -57.470284348766654, -96.23791858504873, -1255.2170291443238, -488.1396949578448, -1152.2976335414608, -956.6797789669084, -312.93439709521664, -936.3393393235858, -1025.6622282879655, -1206.5808813874014, -167.46957840924443, -803.5059869840147, -80.62726238446628, -457.4698919166529, -519.1226787853484, -1045.4953805897278, -553.2478866327842, -55.44573560599005, -1180.1453704995731, -530.4552785318394, -469.97471198586896, -1001.3037858119195, -577.034395242859, -609.8322729451282, -313.7512395764021, -478.99633643588317, -414.2671917199861, -1302.4585342341366, -88.30682433156049]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589791872296077, "mean_inference_ms": 1.6819909832731765, "mean_action_processing_ms": 0.2793770935070705, "mean_env_wait_ms": 3.4709897657633118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01214742660522461, "StateBufferConnector_ms": 0.008296012878417969, "ViewRequirementAgentConnector_ms": 0.19852066040039062}, "num_episodes": 32, "episode_return_max": -2.88859384329026, "episode_return_min": -1416.3723413812036, "episode_return_mean": -669.2340640448424, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.2816433349908, "num_env_steps_trained_throughput_per_sec": 293.2816433349908, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12897.374, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12897.303, "sample_time_ms": 1164.719, "learn_time_ms": 11664.085, "learn_throughput": 342.933, "synch_weights_time_ms": 67.65}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1e132_00002", "date": "2024-08-04_07-46-24", "timestamp": 1722737784, "time_this_iter_s": 13.651134967803955, "time_total_s": 168.1992256641388, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.1992256641388, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.673684210526318, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.52643184860548, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.114268813033899, "policy_loss": -0.010828209903653867, "vf_loss": 4.120808329433203, "vf_explained_var": 0.963140454205374, "kl": 0.014729561322504515, "entropy": 1.3016964309538404, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -33.45912219619531, "episode_reward_min": -1416.3723413812036, "episode_reward_mean": -644.5136465821865, "episode_len_mean": 127.55, "episode_media": {}, "episodes_timesteps_total": 12755, "policy_reward_min": {"policy_0": -1416.3723413812036}, "policy_reward_max": {"policy_0": -33.45912219619531}, "policy_reward_mean": {"policy_0": -644.5136465821865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1416.3723413812036, -305.52755370390867, -106.98187708064668, -699.8860116689293, -1206.6503481663215, -754.9822577778859, -889.7568808713083, -69.44717135991428, -62.59022237397392, -1003.2011872372723, -657.7684273161035, -640.1958145583503, -649.7298965033399, -1079.21066329245, -650.2058443870392, -952.4015803105331, -651.5634013083393, -1235.2957803236413, -571.813789003718, -323.3121910536597, -1177.3639947988404, -1314.27373064363, -399.12420654532474, -527.3861033273674, -33.45912219619531, -305.4134797592868, -768.9303327912676, -384.6191115637301, -339.4990233940154, -1011.2082289057739, -1032.2783674904194, -474.87746509137787, -153.22610334605304, -1088.6139159407142, -1142.7587269536311, -616.1883469898532, -935.9009226424266, -257.32601304525895, -57.470284348766654, -96.23791858504873, -1255.2170291443238, -488.1396949578448, -1152.2976335414608, -956.6797789669084, -312.93439709521664, -936.3393393235858, -1025.6622282879655, -1206.5808813874014, -167.46957840924443, -803.5059869840147, -80.62726238446628, -457.4698919166529, -519.1226787853484, -1045.4953805897278, -553.2478866327842, -55.44573560599005, -1180.1453704995731, -530.4552785318394, -469.97471198586896, -1001.3037858119195, -577.034395242859, -609.8322729451282, -313.7512395764021, -478.99633643588317, -414.2671917199861, -1302.4585342341366, -88.30682433156049, -1018.3110280187549, -947.6518877762719, -713.9570144597744, -190.11610516661634, -1001.0041097138486, -138.81843785048093, -861.3167148217974, -412.117877179673, -893.6532399854731, -134.4327984336555, -881.6433999004275, -491.1856682223911, -754.9562891102977, -525.0258857956197, -33.79090437059827, -384.63667239450257, -985.5225081428314, -1079.7193306831798, -1231.4444301958301, -614.3999709300438, -381.8135812493237, -1203.3997722342754, -168.2588829394669, -248.2727369417242, -261.46120205381766, -53.433093812500886, -107.68354289589261, -954.2279764161391, -476.4607215700849, -1223.0194139934133, -414.39364065711146, -693.3717506370838, -946.0541063001356], "episode_lengths": [150, 92, 67, 150, 150, 149, 150, 67, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 87, 150, 150, 150, 140, 49, 80, 150, 150, 85, 150, 150, 150, 55, 150, 150, 150, 150, 150, 59, 61, 150, 116, 150, 150, 136, 150, 150, 150, 95, 150, 57, 106, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 147, 111, 150, 150, 69, 150, 150, 150, 92, 150, 75, 150, 150, 150, 72, 150, 150, 150, 117, 47, 119, 150, 150, 150, 150, 138, 150, 67, 81, 85, 48, 68, 150, 110, 150, 131, 150, 150], "policy_policy_0_reward": [-1416.3723413812036, -305.52755370390867, -106.98187708064668, -699.8860116689293, -1206.6503481663215, -754.9822577778859, -889.7568808713083, -69.44717135991428, -62.59022237397392, -1003.2011872372723, -657.7684273161035, -640.1958145583503, -649.7298965033399, -1079.21066329245, -650.2058443870392, -952.4015803105331, -651.5634013083393, -1235.2957803236413, -571.813789003718, -323.3121910536597, -1177.3639947988404, -1314.27373064363, -399.12420654532474, -527.3861033273674, -33.45912219619531, -305.4134797592868, -768.9303327912676, -384.6191115637301, -339.4990233940154, -1011.2082289057739, -1032.2783674904194, -474.87746509137787, -153.22610334605304, -1088.6139159407142, -1142.7587269536311, -616.1883469898532, -935.9009226424266, -257.32601304525895, -57.470284348766654, -96.23791858504873, -1255.2170291443238, -488.1396949578448, -1152.2976335414608, -956.6797789669084, -312.93439709521664, -936.3393393235858, -1025.6622282879655, -1206.5808813874014, -167.46957840924443, -803.5059869840147, -80.62726238446628, -457.4698919166529, -519.1226787853484, -1045.4953805897278, -553.2478866327842, -55.44573560599005, -1180.1453704995731, -530.4552785318394, -469.97471198586896, -1001.3037858119195, -577.034395242859, -609.8322729451282, -313.7512395764021, -478.99633643588317, -414.2671917199861, -1302.4585342341366, -88.30682433156049, -1018.3110280187549, -947.6518877762719, -713.9570144597744, -190.11610516661634, -1001.0041097138486, -138.81843785048093, -861.3167148217974, -412.117877179673, -893.6532399854731, -134.4327984336555, -881.6433999004275, -491.1856682223911, -754.9562891102977, -525.0258857956197, -33.79090437059827, -384.63667239450257, -985.5225081428314, -1079.7193306831798, -1231.4444301958301, -614.3999709300438, -381.8135812493237, -1203.3997722342754, -168.2588829394669, -248.2727369417242, -261.46120205381766, -53.433093812500886, -107.68354289589261, -954.2279764161391, -476.4607215700849, -1223.0194139934133, -414.39364065711146, -693.3717506370838, -946.0541063001356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577926302074807, "mean_inference_ms": 1.6816368770274266, "mean_action_processing_ms": 0.2790951809782266, "mean_env_wait_ms": 3.467769616193355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012262582778930664, "StateBufferConnector_ms": 0.008098125457763672, "ViewRequirementAgentConnector_ms": 0.19288849830627441}, "num_episodes": 33, "episode_return_max": -33.45912219619531, "episode_return_min": -1416.3723413812036, "episode_return_mean": -644.5136465821865, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.77267833222953, "num_env_steps_trained_throughput_per_sec": 304.77267833222953, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12961.17, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12961.098, "sample_time_ms": 1157.295, "learn_time_ms": 11735.715, "learn_throughput": 340.84, "synch_weights_time_ms": 67.245}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1e132_00002", "date": "2024-08-04_07-46-38", "timestamp": 1722737798, "time_this_iter_s": 13.137840509414673, "time_total_s": 181.33706617355347, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448bf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 181.33706617355347, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.73684210526316, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.03140043715635, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7190848807493846, "policy_loss": -0.005717282054926424, "vf_loss": 3.7205704112847644, "vf_explained_var": 0.9603279543419679, "kl": 0.014533152241877678, "entropy": 1.2819790581862132, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -33.79090437059827, "episode_reward_min": -1302.4585342341366, "episode_reward_mean": -629.5964520574838, "episode_len_mean": 128.96, "episode_media": {}, "episodes_timesteps_total": 12896, "policy_reward_min": {"policy_0": -1302.4585342341366}, "policy_reward_max": {"policy_0": -33.79090437059827}, "policy_reward_mean": {"policy_0": -629.5964520574838}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011.2082289057739, -1032.2783674904194, -474.87746509137787, -153.22610334605304, -1088.6139159407142, -1142.7587269536311, -616.1883469898532, -935.9009226424266, -257.32601304525895, -57.470284348766654, -96.23791858504873, -1255.2170291443238, -488.1396949578448, -1152.2976335414608, -956.6797789669084, -312.93439709521664, -936.3393393235858, -1025.6622282879655, -1206.5808813874014, -167.46957840924443, -803.5059869840147, -80.62726238446628, -457.4698919166529, -519.1226787853484, -1045.4953805897278, -553.2478866327842, -55.44573560599005, -1180.1453704995731, -530.4552785318394, -469.97471198586896, -1001.3037858119195, -577.034395242859, -609.8322729451282, -313.7512395764021, -478.99633643588317, -414.2671917199861, -1302.4585342341366, -88.30682433156049, -1018.3110280187549, -947.6518877762719, -713.9570144597744, -190.11610516661634, -1001.0041097138486, -138.81843785048093, -861.3167148217974, -412.117877179673, -893.6532399854731, -134.4327984336555, -881.6433999004275, -491.1856682223911, -754.9562891102977, -525.0258857956197, -33.79090437059827, -384.63667239450257, -985.5225081428314, -1079.7193306831798, -1231.4444301958301, -614.3999709300438, -381.8135812493237, -1203.3997722342754, -168.2588829394669, -248.2727369417242, -261.46120205381766, -53.433093812500886, -107.68354289589261, -954.2279764161391, -476.4607215700849, -1223.0194139934133, -414.39364065711146, -693.3717506370838, -946.0541063001356, -944.8815521637252, -1049.6072767117107, -887.2012606463941, -439.578801829487, -352.056392972678, -1010.1967411633166, -162.10507792338154, -421.2318105181653, -88.54307163592924, -532.0498435941696, -522.4229664166966, -717.9533410685152, -735.5622824712419, -882.72774030337, -230.22932303271043, -623.3305468953295, -526.852512354273, -658.6322816251665, -478.4527987498448, -721.5733703584839, -1244.8003311033058, -277.910893229375, -442.3612183922963, -757.2817863133835, -189.79456803380657, -579.7822134877634, -415.4295372554477, -930.1510906210746, -862.5422613568821], "episode_lengths": [150, 150, 150, 55, 150, 150, 150, 150, 150, 59, 61, 150, 116, 150, 150, 136, 150, 150, 150, 95, 150, 57, 106, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 147, 111, 150, 150, 69, 150, 150, 150, 92, 150, 75, 150, 150, 150, 72, 150, 150, 150, 117, 47, 119, 150, 150, 150, 150, 138, 150, 67, 81, 85, 48, 68, 150, 110, 150, 131, 150, 150, 150, 150, 150, 150, 89, 150, 96, 150, 68, 150, 150, 150, 150, 150, 87, 150, 150, 150, 127, 150, 150, 77, 133, 150, 77, 121, 103, 150, 150], "policy_policy_0_reward": [-1011.2082289057739, -1032.2783674904194, -474.87746509137787, -153.22610334605304, -1088.6139159407142, -1142.7587269536311, -616.1883469898532, -935.9009226424266, -257.32601304525895, -57.470284348766654, -96.23791858504873, -1255.2170291443238, -488.1396949578448, -1152.2976335414608, -956.6797789669084, -312.93439709521664, -936.3393393235858, -1025.6622282879655, -1206.5808813874014, -167.46957840924443, -803.5059869840147, -80.62726238446628, -457.4698919166529, -519.1226787853484, -1045.4953805897278, -553.2478866327842, -55.44573560599005, -1180.1453704995731, -530.4552785318394, -469.97471198586896, -1001.3037858119195, -577.034395242859, -609.8322729451282, -313.7512395764021, -478.99633643588317, -414.2671917199861, -1302.4585342341366, -88.30682433156049, -1018.3110280187549, -947.6518877762719, -713.9570144597744, -190.11610516661634, -1001.0041097138486, -138.81843785048093, -861.3167148217974, -412.117877179673, -893.6532399854731, -134.4327984336555, -881.6433999004275, -491.1856682223911, -754.9562891102977, -525.0258857956197, -33.79090437059827, -384.63667239450257, -985.5225081428314, -1079.7193306831798, -1231.4444301958301, -614.3999709300438, -381.8135812493237, -1203.3997722342754, -168.2588829394669, -248.2727369417242, -261.46120205381766, -53.433093812500886, -107.68354289589261, -954.2279764161391, -476.4607215700849, -1223.0194139934133, -414.39364065711146, -693.3717506370838, -946.0541063001356, -944.8815521637252, -1049.6072767117107, -887.2012606463941, -439.578801829487, -352.056392972678, -1010.1967411633166, -162.10507792338154, -421.2318105181653, -88.54307163592924, -532.0498435941696, -522.4229664166966, -717.9533410685152, -735.5622824712419, -882.72774030337, -230.22932303271043, -623.3305468953295, -526.852512354273, -658.6322816251665, -478.4527987498448, -721.5733703584839, -1244.8003311033058, -277.910893229375, -442.3612183922963, -757.2817863133835, -189.79456803380657, -579.7822134877634, -415.4295372554477, -930.1510906210746, -862.5422613568821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575134056289359, "mean_inference_ms": 1.6806092879424148, "mean_action_processing_ms": 0.27857182890696647, "mean_env_wait_ms": 3.4654849250091826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01201772689819336, "StateBufferConnector_ms": 0.008194923400878906, "ViewRequirementAgentConnector_ms": 0.19345498085021973}, "num_episodes": 29, "episode_return_max": -33.79090437059827, "episode_return_min": -1302.4585342341366, "episode_return_mean": -629.5964520574838, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7067575377875, "num_env_steps_trained_throughput_per_sec": 302.7067575377875, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13034.011, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13033.939, "sample_time_ms": 1162.331, "learn_time_ms": 11803.675, "learn_throughput": 338.878, "synch_weights_time_ms": 67.089}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1e132_00002", "date": "2024-08-04_07-46-51", "timestamp": 1722737811, "time_this_iter_s": 13.226136207580566, "time_total_s": 194.56320238113403, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bfac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.56320238113403, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.731578947368423, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.37241892615955, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7384116386373836, "policy_loss": -0.012435541567295634, "vf_loss": 3.746630202233791, "vf_explained_var": 0.9621797396490971, "kl": 0.014478095195105805, "entropy": 1.2644091061626872, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -33.79090437059827, "episode_reward_min": -1302.4585342341366, "episode_reward_mean": -567.4687646925697, "episode_len_mean": 124.28, "episode_media": {}, "episodes_timesteps_total": 12428, "policy_reward_min": {"policy_0": -1302.4585342341366}, "policy_reward_max": {"policy_0": -33.79090437059827}, "policy_reward_mean": {"policy_0": -567.4687646925697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313.7512395764021, -478.99633643588317, -414.2671917199861, -1302.4585342341366, -88.30682433156049, -1018.3110280187549, -947.6518877762719, -713.9570144597744, -190.11610516661634, -1001.0041097138486, -138.81843785048093, -861.3167148217974, -412.117877179673, -893.6532399854731, -134.4327984336555, -881.6433999004275, -491.1856682223911, -754.9562891102977, -525.0258857956197, -33.79090437059827, -384.63667239450257, -985.5225081428314, -1079.7193306831798, -1231.4444301958301, -614.3999709300438, -381.8135812493237, -1203.3997722342754, -168.2588829394669, -248.2727369417242, -261.46120205381766, -53.433093812500886, -107.68354289589261, -954.2279764161391, -476.4607215700849, -1223.0194139934133, -414.39364065711146, -693.3717506370838, -946.0541063001356, -944.8815521637252, -1049.6072767117107, -887.2012606463941, -439.578801829487, -352.056392972678, -1010.1967411633166, -162.10507792338154, -421.2318105181653, -88.54307163592924, -532.0498435941696, -522.4229664166966, -717.9533410685152, -735.5622824712419, -882.72774030337, -230.22932303271043, -623.3305468953295, -526.852512354273, -658.6322816251665, -478.4527987498448, -721.5733703584839, -1244.8003311033058, -277.910893229375, -442.3612183922963, -757.2817863133835, -189.79456803380657, -579.7822134877634, -415.4295372554477, -930.1510906210746, -862.5422613568821, -337.2799011244785, -821.5489885886191, -123.30945102186611, -452.93385113157865, -504.8904003130756, -376.1427466939431, -1014.7247708531578, -243.3236558525107, -34.59743695119789, -293.6415942153822, -608.059682790854, -1288.0864553745885, -535.4873131850834, -823.7023844838033, -514.0257256052532, -321.9024723249852, -652.8989969296123, -236.3592181639151, -339.3830366855399, -433.2175586783535, -362.0949452099963, -148.19171687482134, -749.7817099848507, -546.5207157957033, -60.47396924674158, -199.68132477198398, -235.52068338964372, -472.3673103926087, -89.15741031237638, -957.112627605287, -979.0141491308743, -85.02105017667965, -1197.8455020186714], "episode_lengths": [147, 111, 150, 150, 69, 150, 150, 150, 92, 150, 75, 150, 150, 150, 72, 150, 150, 150, 117, 47, 119, 150, 150, 150, 150, 138, 150, 67, 81, 85, 48, 68, 150, 110, 150, 131, 150, 150, 150, 150, 150, 150, 89, 150, 96, 150, 68, 150, 150, 150, 150, 150, 87, 150, 150, 150, 127, 150, 150, 77, 133, 150, 77, 121, 103, 150, 150, 84, 145, 69, 150, 146, 99, 150, 71, 40, 98, 121, 150, 150, 150, 119, 132, 150, 150, 111, 150, 129, 82, 150, 134, 57, 64, 139, 115, 66, 150, 150, 52, 150], "policy_policy_0_reward": [-313.7512395764021, -478.99633643588317, -414.2671917199861, -1302.4585342341366, -88.30682433156049, -1018.3110280187549, -947.6518877762719, -713.9570144597744, -190.11610516661634, -1001.0041097138486, -138.81843785048093, -861.3167148217974, -412.117877179673, -893.6532399854731, -134.4327984336555, -881.6433999004275, -491.1856682223911, -754.9562891102977, -525.0258857956197, -33.79090437059827, -384.63667239450257, -985.5225081428314, -1079.7193306831798, -1231.4444301958301, -614.3999709300438, -381.8135812493237, -1203.3997722342754, -168.2588829394669, -248.2727369417242, -261.46120205381766, -53.433093812500886, -107.68354289589261, -954.2279764161391, -476.4607215700849, -1223.0194139934133, -414.39364065711146, -693.3717506370838, -946.0541063001356, -944.8815521637252, -1049.6072767117107, -887.2012606463941, -439.578801829487, -352.056392972678, -1010.1967411633166, -162.10507792338154, -421.2318105181653, -88.54307163592924, -532.0498435941696, -522.4229664166966, -717.9533410685152, -735.5622824712419, -882.72774030337, -230.22932303271043, -623.3305468953295, -526.852512354273, -658.6322816251665, -478.4527987498448, -721.5733703584839, -1244.8003311033058, -277.910893229375, -442.3612183922963, -757.2817863133835, -189.79456803380657, -579.7822134877634, -415.4295372554477, -930.1510906210746, -862.5422613568821, -337.2799011244785, -821.5489885886191, -123.30945102186611, -452.93385113157865, -504.8904003130756, -376.1427466939431, -1014.7247708531578, -243.3236558525107, -34.59743695119789, -293.6415942153822, -608.059682790854, -1288.0864553745885, -535.4873131850834, -823.7023844838033, -514.0257256052532, -321.9024723249852, -652.8989969296123, -236.3592181639151, -339.3830366855399, -433.2175586783535, -362.0949452099963, -148.19171687482134, -749.7817099848507, -546.5207157957033, -60.47396924674158, -199.68132477198398, -235.52068338964372, -472.3673103926087, -89.15741031237638, -957.112627605287, -979.0141491308743, -85.02105017667965, -1197.8455020186714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571491653957762, "mean_inference_ms": 1.6804338359030835, "mean_action_processing_ms": 0.2780712315163549, "mean_env_wait_ms": 3.4623786139209223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01180577278137207, "StateBufferConnector_ms": 0.007994413375854492, "ViewRequirementAgentConnector_ms": 0.19225788116455078}, "num_episodes": 33, "episode_return_max": -33.79090437059827, "episode_return_min": -1302.4585342341366, "episode_return_mean": -567.4687646925697, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6451384694834, "num_env_steps_trained_throughput_per_sec": 304.6451384694834, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13028.645, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13028.573, "sample_time_ms": 1160.184, "learn_time_ms": 11800.112, "learn_throughput": 338.98, "synch_weights_time_ms": 67.435}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1e132_00002", "date": "2024-08-04_07-47-04", "timestamp": 1722737824, "time_this_iter_s": 13.143316268920898, "time_total_s": 207.70651865005493, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac121000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.70651865005493, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.673684210526318, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 174.89923883676528, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.639600378274918, "policy_loss": -0.009103621167499416, "vf_loss": 3.6438052116582793, "vf_explained_var": 0.9737547674526771, "kl": 0.01675910923950143, "entropy": 1.2895270044604936, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -21.638176357992478, "episode_reward_min": -1288.0864553745885, "episode_reward_mean": -573.6632293511192, "episode_len_mean": 125.65, "episode_media": {}, "episodes_timesteps_total": 12565, "policy_reward_min": {"policy_0": -1288.0864553745885}, "policy_reward_max": {"policy_0": -21.638176357992478}, "policy_reward_mean": {"policy_0": -573.6632293511192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.0194139934133, -414.39364065711146, -693.3717506370838, -946.0541063001356, -944.8815521637252, -1049.6072767117107, -887.2012606463941, -439.578801829487, -352.056392972678, -1010.1967411633166, -162.10507792338154, -421.2318105181653, -88.54307163592924, -532.0498435941696, -522.4229664166966, -717.9533410685152, -735.5622824712419, -882.72774030337, -230.22932303271043, -623.3305468953295, -526.852512354273, -658.6322816251665, -478.4527987498448, -721.5733703584839, -1244.8003311033058, -277.910893229375, -442.3612183922963, -757.2817863133835, -189.79456803380657, -579.7822134877634, -415.4295372554477, -930.1510906210746, -862.5422613568821, -337.2799011244785, -821.5489885886191, -123.30945102186611, -452.93385113157865, -504.8904003130756, -376.1427466939431, -1014.7247708531578, -243.3236558525107, -34.59743695119789, -293.6415942153822, -608.059682790854, -1288.0864553745885, -535.4873131850834, -823.7023844838033, -514.0257256052532, -321.9024723249852, -652.8989969296123, -236.3592181639151, -339.3830366855399, -433.2175586783535, -362.0949452099963, -148.19171687482134, -749.7817099848507, -546.5207157957033, -60.47396924674158, -199.68132477198398, -235.52068338964372, -472.3673103926087, -89.15741031237638, -957.112627605287, -979.0141491308743, -85.02105017667965, -1197.8455020186714, -999.774426113612, -85.78347229372447, -21.638176357992478, -362.58541732632654, -324.270124775872, -917.6573463153815, -764.913043658619, -1091.2812329148958, -771.5257881829601, -280.819565652792, -861.069376626471, -121.69408131644803, -1189.6120247330089, -790.3119441693404, -250.84453209799162, -211.03488628653284, -829.4199522408014, -135.62795632075955, -126.3340804222984, -840.2385611467058, -531.1146895708812, -335.644256617064, -203.87085377824727, -490.25917003698453, -764.8361045761544, -892.9121318852939, -881.4071986499596, -547.3527397034852, -686.3839971965336, -1061.5974831911437, -1171.2562543531456, -588.8741096184515, -440.8304538996803, -793.1669433886456], "episode_lengths": [150, 131, 150, 150, 150, 150, 150, 150, 89, 150, 96, 150, 68, 150, 150, 150, 150, 150, 87, 150, 150, 150, 127, 150, 150, 77, 133, 150, 77, 121, 103, 150, 150, 84, 145, 69, 150, 146, 99, 150, 71, 40, 98, 121, 150, 150, 150, 119, 132, 150, 150, 111, 150, 129, 82, 150, 134, 57, 64, 139, 115, 66, 150, 150, 52, 150, 150, 60, 39, 150, 150, 150, 150, 150, 150, 82, 150, 71, 150, 150, 70, 85, 150, 78, 65, 150, 150, 125, 68, 142, 138, 150, 150, 150, 150, 150, 150, 150, 110, 150], "policy_policy_0_reward": [-1223.0194139934133, -414.39364065711146, -693.3717506370838, -946.0541063001356, -944.8815521637252, -1049.6072767117107, -887.2012606463941, -439.578801829487, -352.056392972678, -1010.1967411633166, -162.10507792338154, -421.2318105181653, -88.54307163592924, -532.0498435941696, -522.4229664166966, -717.9533410685152, -735.5622824712419, -882.72774030337, -230.22932303271043, -623.3305468953295, -526.852512354273, -658.6322816251665, -478.4527987498448, -721.5733703584839, -1244.8003311033058, -277.910893229375, -442.3612183922963, -757.2817863133835, -189.79456803380657, -579.7822134877634, -415.4295372554477, -930.1510906210746, -862.5422613568821, -337.2799011244785, -821.5489885886191, -123.30945102186611, -452.93385113157865, -504.8904003130756, -376.1427466939431, -1014.7247708531578, -243.3236558525107, -34.59743695119789, -293.6415942153822, -608.059682790854, -1288.0864553745885, -535.4873131850834, -823.7023844838033, -514.0257256052532, -321.9024723249852, -652.8989969296123, -236.3592181639151, -339.3830366855399, -433.2175586783535, -362.0949452099963, -148.19171687482134, -749.7817099848507, -546.5207157957033, -60.47396924674158, -199.68132477198398, -235.52068338964372, -472.3673103926087, -89.15741031237638, -957.112627605287, -979.0141491308743, -85.02105017667965, -1197.8455020186714, -999.774426113612, -85.78347229372447, -21.638176357992478, -362.58541732632654, -324.270124775872, -917.6573463153815, -764.913043658619, -1091.2812329148958, -771.5257881829601, -280.819565652792, -861.069376626471, -121.69408131644803, -1189.6120247330089, -790.3119441693404, -250.84453209799162, -211.03488628653284, -829.4199522408014, -135.62795632075955, -126.3340804222984, -840.2385611467058, -531.1146895708812, -335.644256617064, -203.87085377824727, -490.25917003698453, -764.8361045761544, -892.9121318852939, -881.4071986499596, -547.3527397034852, -686.3839971965336, -1061.5974831911437, -1171.2562543531456, -588.8741096184515, -440.8304538996803, -793.1669433886456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571887175685233, "mean_inference_ms": 1.6771834039447926, "mean_action_processing_ms": 0.277415070661293, "mean_env_wait_ms": 3.456411475611801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011614561080932617, "StateBufferConnector_ms": 0.007987260818481445, "ViewRequirementAgentConnector_ms": 0.19153666496276855}, "num_episodes": 34, "episode_return_max": -21.638176357992478, "episode_return_min": -1288.0864553745885, "episode_return_mean": -573.6632293511192, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.4255713731417, "num_env_steps_trained_throughput_per_sec": 309.4255713731417, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13017.534, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13017.462, "sample_time_ms": 1141.903, "learn_time_ms": 11809.216, "learn_throughput": 338.718, "synch_weights_time_ms": 65.495}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1e132_00002", "date": "2024-08-04_07-47-17", "timestamp": 1722737837, "time_this_iter_s": 12.940450668334961, "time_total_s": 220.6469693183899, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac121990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.6469693183899, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.877777777777776, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.60482975840569, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.868188603967428, "policy_loss": -0.0068036266801451955, "vf_loss": 3.871067003905773, "vf_explained_var": 0.9660710042963425, "kl": 0.013544422374858811, "entropy": 1.3809451278299094, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -12.872747275193824, "episode_reward_min": -1409.567512938059, "episode_reward_mean": -571.1950897747269, "episode_len_mean": 121.88, "episode_media": {}, "episodes_timesteps_total": 12188, "policy_reward_min": {"policy_0": -1409.567512938059}, "policy_reward_max": {"policy_0": -12.872747275193824}, "policy_reward_mean": {"policy_0": -571.1950897747269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-862.5422613568821, -337.2799011244785, -821.5489885886191, -123.30945102186611, -452.93385113157865, -504.8904003130756, -376.1427466939431, -1014.7247708531578, -243.3236558525107, -34.59743695119789, -293.6415942153822, -608.059682790854, -1288.0864553745885, -535.4873131850834, -823.7023844838033, -514.0257256052532, -321.9024723249852, -652.8989969296123, -236.3592181639151, -339.3830366855399, -433.2175586783535, -362.0949452099963, -148.19171687482134, -749.7817099848507, -546.5207157957033, -60.47396924674158, -199.68132477198398, -235.52068338964372, -472.3673103926087, -89.15741031237638, -957.112627605287, -979.0141491308743, -85.02105017667965, -1197.8455020186714, -999.774426113612, -85.78347229372447, -21.638176357992478, -362.58541732632654, -324.270124775872, -917.6573463153815, -764.913043658619, -1091.2812329148958, -771.5257881829601, -280.819565652792, -861.069376626471, -121.69408131644803, -1189.6120247330089, -790.3119441693404, -250.84453209799162, -211.03488628653284, -829.4199522408014, -135.62795632075955, -126.3340804222984, -840.2385611467058, -531.1146895708812, -335.644256617064, -203.87085377824727, -490.25917003698453, -764.8361045761544, -892.9121318852939, -881.4071986499596, -547.3527397034852, -686.3839971965336, -1061.5974831911437, -1171.2562543531456, -588.8741096184515, -440.8304538996803, -793.1669433886456, -356.054260037047, -323.63063759050436, -1323.5579380741365, -831.2920668090524, -803.5591306851337, -509.0216426955364, -774.223057709201, -43.686382046241285, -12.872747275193824, -1024.27608080696, -64.98347978245609, -916.421150080715, -237.51209451002683, -802.9488204274777, -1409.567512938059, -1336.8272857644345, -357.1941612832384, -226.60769631565609, -295.4784521417874, -896.6423084579503, -141.04407813104507, -98.98427380564658, -304.92957419975886, -696.0543952212505, -167.47232422795048, -1172.6412040535854, -256.4729222705611, -542.1292165262367, -1113.539627972672, -1019.6224683392804, -961.097773862162, -832.3808207786047], "episode_lengths": [150, 84, 145, 69, 150, 146, 99, 150, 71, 40, 98, 121, 150, 150, 150, 119, 132, 150, 150, 111, 150, 129, 82, 150, 134, 57, 64, 139, 115, 66, 150, 150, 52, 150, 150, 60, 39, 150, 150, 150, 150, 150, 150, 82, 150, 71, 150, 150, 70, 85, 150, 78, 65, 150, 150, 125, 68, 142, 138, 150, 150, 150, 150, 150, 150, 150, 110, 150, 102, 150, 150, 150, 146, 150, 150, 37, 42, 150, 64, 150, 83, 150, 150, 150, 119, 98, 105, 150, 77, 46, 111, 150, 87, 150, 95, 120, 150, 150, 150, 150], "policy_policy_0_reward": [-862.5422613568821, -337.2799011244785, -821.5489885886191, -123.30945102186611, -452.93385113157865, -504.8904003130756, -376.1427466939431, -1014.7247708531578, -243.3236558525107, -34.59743695119789, -293.6415942153822, -608.059682790854, -1288.0864553745885, -535.4873131850834, -823.7023844838033, -514.0257256052532, -321.9024723249852, -652.8989969296123, -236.3592181639151, -339.3830366855399, -433.2175586783535, -362.0949452099963, -148.19171687482134, -749.7817099848507, -546.5207157957033, -60.47396924674158, -199.68132477198398, -235.52068338964372, -472.3673103926087, -89.15741031237638, -957.112627605287, -979.0141491308743, -85.02105017667965, -1197.8455020186714, -999.774426113612, -85.78347229372447, -21.638176357992478, -362.58541732632654, -324.270124775872, -917.6573463153815, -764.913043658619, -1091.2812329148958, -771.5257881829601, -280.819565652792, -861.069376626471, -121.69408131644803, -1189.6120247330089, -790.3119441693404, -250.84453209799162, -211.03488628653284, -829.4199522408014, -135.62795632075955, -126.3340804222984, -840.2385611467058, -531.1146895708812, -335.644256617064, -203.87085377824727, -490.25917003698453, -764.8361045761544, -892.9121318852939, -881.4071986499596, -547.3527397034852, -686.3839971965336, -1061.5974831911437, -1171.2562543531456, -588.8741096184515, -440.8304538996803, -793.1669433886456, -356.054260037047, -323.63063759050436, -1323.5579380741365, -831.2920668090524, -803.5591306851337, -509.0216426955364, -774.223057709201, -43.686382046241285, -12.872747275193824, -1024.27608080696, -64.98347978245609, -916.421150080715, -237.51209451002683, -802.9488204274777, -1409.567512938059, -1336.8272857644345, -357.1941612832384, -226.60769631565609, -295.4784521417874, -896.6423084579503, -141.04407813104507, -98.98427380564658, -304.92957419975886, -696.0543952212505, -167.47232422795048, -1172.6412040535854, -256.4729222705611, -542.1292165262367, -1113.539627972672, -1019.6224683392804, -961.097773862162, -832.3808207786047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.558233686748534, "mean_inference_ms": 1.6779500450460823, "mean_action_processing_ms": 0.2772010172690957, "mean_env_wait_ms": 3.4572498209314695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011710643768310547, "StateBufferConnector_ms": 0.00788259506225586, "ViewRequirementAgentConnector_ms": 0.19109797477722168}, "num_episodes": 32, "episode_return_max": -12.872747275193824, "episode_return_min": -1409.567512938059, "episode_return_mean": -571.1950897747269, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.8145306340968, "num_env_steps_trained_throughput_per_sec": 410.8145306340968, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12745.177, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12745.106, "sample_time_ms": 1141.641, "learn_time_ms": 11539.661, "learn_throughput": 346.631, "synch_weights_time_ms": 62.982}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1e132_00002", "date": "2024-08-04_07-47-27", "timestamp": 1722737847, "time_this_iter_s": 9.749279499053955, "time_total_s": 230.39624881744385, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.39624881744385, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.335714285714285, "ram_util_percent": 28.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 220.58486330707868, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.3253097609927256, "policy_loss": -0.010177616148818439, "vf_loss": 3.330360712110996, "vf_explained_var": 0.9852860130990545, "kl": 0.017537205076769168, "entropy": 1.344944484780232, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -12.872747275193824, "episode_reward_min": -1409.567512938059, "episode_reward_mean": -634.4570524175547, "episode_len_mean": 123.86, "episode_media": {}, "episodes_timesteps_total": 12386, "policy_reward_min": {"policy_0": -1409.567512938059}, "policy_reward_max": {"policy_0": -12.872747275193824}, "policy_reward_mean": {"policy_0": -634.4570524175547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.02105017667965, -1197.8455020186714, -999.774426113612, -85.78347229372447, -21.638176357992478, -362.58541732632654, -324.270124775872, -917.6573463153815, -764.913043658619, -1091.2812329148958, -771.5257881829601, -280.819565652792, -861.069376626471, -121.69408131644803, -1189.6120247330089, -790.3119441693404, -250.84453209799162, -211.03488628653284, -829.4199522408014, -135.62795632075955, -126.3340804222984, -840.2385611467058, -531.1146895708812, -335.644256617064, -203.87085377824727, -490.25917003698453, -764.8361045761544, -892.9121318852939, -881.4071986499596, -547.3527397034852, -686.3839971965336, -1061.5974831911437, -1171.2562543531456, -588.8741096184515, -440.8304538996803, -793.1669433886456, -356.054260037047, -323.63063759050436, -1323.5579380741365, -831.2920668090524, -803.5591306851337, -509.0216426955364, -774.223057709201, -43.686382046241285, -12.872747275193824, -1024.27608080696, -64.98347978245609, -916.421150080715, -237.51209451002683, -802.9488204274777, -1409.567512938059, -1336.8272857644345, -357.1941612832384, -226.60769631565609, -295.4784521417874, -896.6423084579503, -141.04407813104507, -98.98427380564658, -304.92957419975886, -696.0543952212505, -167.47232422795048, -1172.6412040535854, -256.4729222705611, -542.1292165262367, -1113.539627972672, -1019.6224683392804, -961.097773862162, -832.3808207786047, -1043.0538452741475, -1098.843451461306, -445.6163732176425, -911.4703173811292, -723.0624844626834, -1073.7866961237523, -52.62233601710271, -1040.0299178824184, -1141.0291375470022, -483.89749643431827, -1087.9247132395867, -1287.1002052255128, -1266.051225759509, -1234.448479070616, -884.3601106746297, -858.5088156102345, -36.96920494976479, -132.11690358065334, -663.5706659615092, -734.315338317147, -47.66044590366839, -199.08128896546694, -824.6549154555263, -874.2914588136263, -199.14743542371212, -104.94037401279901, -143.0624499108527, -293.0955678163276, -97.66645398021919, -990.9220164425144, -1214.2102960862242, -756.6603083207546], "episode_lengths": [52, 150, 150, 60, 39, 150, 150, 150, 150, 150, 150, 82, 150, 71, 150, 150, 70, 85, 150, 78, 65, 150, 150, 125, 68, 142, 138, 150, 150, 150, 150, 150, 150, 150, 110, 150, 102, 150, 150, 150, 146, 150, 150, 37, 42, 150, 64, 150, 83, 150, 150, 150, 119, 98, 105, 150, 77, 46, 111, 150, 87, 150, 95, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 62, 150, 150, 47, 106, 150, 150, 78, 55, 55, 150, 68, 150, 150, 150], "policy_policy_0_reward": [-85.02105017667965, -1197.8455020186714, -999.774426113612, -85.78347229372447, -21.638176357992478, -362.58541732632654, -324.270124775872, -917.6573463153815, -764.913043658619, -1091.2812329148958, -771.5257881829601, -280.819565652792, -861.069376626471, -121.69408131644803, -1189.6120247330089, -790.3119441693404, -250.84453209799162, -211.03488628653284, -829.4199522408014, -135.62795632075955, -126.3340804222984, -840.2385611467058, -531.1146895708812, -335.644256617064, -203.87085377824727, -490.25917003698453, -764.8361045761544, -892.9121318852939, -881.4071986499596, -547.3527397034852, -686.3839971965336, -1061.5974831911437, -1171.2562543531456, -588.8741096184515, -440.8304538996803, -793.1669433886456, -356.054260037047, -323.63063759050436, -1323.5579380741365, -831.2920668090524, -803.5591306851337, -509.0216426955364, -774.223057709201, -43.686382046241285, -12.872747275193824, -1024.27608080696, -64.98347978245609, -916.421150080715, -237.51209451002683, -802.9488204274777, -1409.567512938059, -1336.8272857644345, -357.1941612832384, -226.60769631565609, -295.4784521417874, -896.6423084579503, -141.04407813104507, -98.98427380564658, -304.92957419975886, -696.0543952212505, -167.47232422795048, -1172.6412040535854, -256.4729222705611, -542.1292165262367, -1113.539627972672, -1019.6224683392804, -961.097773862162, -832.3808207786047, -1043.0538452741475, -1098.843451461306, -445.6163732176425, -911.4703173811292, -723.0624844626834, -1073.7866961237523, -52.62233601710271, -1040.0299178824184, -1141.0291375470022, -483.89749643431827, -1087.9247132395867, -1287.1002052255128, -1266.051225759509, -1234.448479070616, -884.3601106746297, -858.5088156102345, -36.96920494976479, -132.11690358065334, -663.5706659615092, -734.315338317147, -47.66044590366839, -199.08128896546694, -824.6549154555263, -874.2914588136263, -199.14743542371212, -104.94037401279901, -143.0624499108527, -293.0955678163276, -97.66645398021919, -990.9220164425144, -1214.2102960862242, -756.6603083207546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585722487469632, "mean_inference_ms": 1.6781014725355528, "mean_action_processing_ms": 0.2772644278820007, "mean_env_wait_ms": 3.4586429293348613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011812686920166016, "StateBufferConnector_ms": 0.007970094680786133, "ViewRequirementAgentConnector_ms": 0.19347405433654785}, "num_episodes": 32, "episode_return_max": -12.872747275193824, "episode_return_min": -1409.567512938059, "episode_return_mean": -634.4570524175547, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.40586424134443, "num_env_steps_trained_throughput_per_sec": 314.40586424134443, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12717.993, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12717.925, "sample_time_ms": 1141.914, "learn_time_ms": 11512.408, "learn_throughput": 347.451, "synch_weights_time_ms": 62.819}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1e132_00002", "date": "2024-08-04_07-47-40", "timestamp": 1722737860, "time_this_iter_s": 12.734930038452148, "time_total_s": 243.131178855896, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1224d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 243.131178855896, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.11111111111111, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 196.87159254948298, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.522894942139586, "policy_loss": -0.013130584169994108, "vf_loss": 3.531153795619806, "vf_explained_var": 0.9819922454034289, "kl": 0.01664648122920579, "entropy": 1.222226971325775, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -12.872747275193824, "episode_reward_min": -1409.567512938059, "episode_reward_mean": -663.2725228665499, "episode_len_mean": 126.63, "episode_media": {}, "episodes_timesteps_total": 12663, "policy_reward_min": {"policy_0": -1409.567512938059}, "policy_reward_max": {"policy_0": -12.872747275193824}, "policy_reward_mean": {"policy_0": -663.2725228665499}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-892.9121318852939, -881.4071986499596, -547.3527397034852, -686.3839971965336, -1061.5974831911437, -1171.2562543531456, -588.8741096184515, -440.8304538996803, -793.1669433886456, -356.054260037047, -323.63063759050436, -1323.5579380741365, -831.2920668090524, -803.5591306851337, -509.0216426955364, -774.223057709201, -43.686382046241285, -12.872747275193824, -1024.27608080696, -64.98347978245609, -916.421150080715, -237.51209451002683, -802.9488204274777, -1409.567512938059, -1336.8272857644345, -357.1941612832384, -226.60769631565609, -295.4784521417874, -896.6423084579503, -141.04407813104507, -98.98427380564658, -304.92957419975886, -696.0543952212505, -167.47232422795048, -1172.6412040535854, -256.4729222705611, -542.1292165262367, -1113.539627972672, -1019.6224683392804, -961.097773862162, -832.3808207786047, -1043.0538452741475, -1098.843451461306, -445.6163732176425, -911.4703173811292, -723.0624844626834, -1073.7866961237523, -52.62233601710271, -1040.0299178824184, -1141.0291375470022, -483.89749643431827, -1087.9247132395867, -1287.1002052255128, -1266.051225759509, -1234.448479070616, -884.3601106746297, -858.5088156102345, -36.96920494976479, -132.11690358065334, -663.5706659615092, -734.315338317147, -47.66044590366839, -199.08128896546694, -824.6549154555263, -874.2914588136263, -199.14743542371212, -104.94037401279901, -143.0624499108527, -293.0955678163276, -97.66645398021919, -990.9220164425144, -1214.2102960862242, -756.6603083207546, -393.9017750595757, -1139.3983490413634, -122.12526520409412, -1038.8210248120988, -886.153707806117, -177.28921686114487, -785.1939867592366, -857.2579535227512, -779.6563374378105, -266.81800208641647, -200.82332303449954, -939.9665751230805, -106.41871405449191, -1221.0623111417417, -1176.5768305520705, -824.9825252292787, -950.6389358987404, -767.6982365081418, -733.4162880051675, -245.81257045884806, -81.7512662237012, -273.26564428119997, -644.854034974537, -764.5448561015562, -272.40289352752063, -974.0111065269543, -841.7329303946035], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 110, 150, 102, 150, 150, 150, 146, 150, 150, 37, 42, 150, 64, 150, 83, 150, 150, 150, 119, 98, 105, 150, 77, 46, 111, 150, 87, 150, 95, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 62, 150, 150, 47, 106, 150, 150, 78, 55, 55, 150, 68, 150, 150, 150, 150, 150, 73, 150, 150, 97, 150, 150, 150, 81, 64, 150, 62, 150, 150, 150, 150, 150, 150, 101, 52, 101, 150, 150, 121, 150, 150], "policy_policy_0_reward": [-892.9121318852939, -881.4071986499596, -547.3527397034852, -686.3839971965336, -1061.5974831911437, -1171.2562543531456, -588.8741096184515, -440.8304538996803, -793.1669433886456, -356.054260037047, -323.63063759050436, -1323.5579380741365, -831.2920668090524, -803.5591306851337, -509.0216426955364, -774.223057709201, -43.686382046241285, -12.872747275193824, -1024.27608080696, -64.98347978245609, -916.421150080715, -237.51209451002683, -802.9488204274777, -1409.567512938059, -1336.8272857644345, -357.1941612832384, -226.60769631565609, -295.4784521417874, -896.6423084579503, -141.04407813104507, -98.98427380564658, -304.92957419975886, -696.0543952212505, -167.47232422795048, -1172.6412040535854, -256.4729222705611, -542.1292165262367, -1113.539627972672, -1019.6224683392804, -961.097773862162, -832.3808207786047, -1043.0538452741475, -1098.843451461306, -445.6163732176425, -911.4703173811292, -723.0624844626834, -1073.7866961237523, -52.62233601710271, -1040.0299178824184, -1141.0291375470022, -483.89749643431827, -1087.9247132395867, -1287.1002052255128, -1266.051225759509, -1234.448479070616, -884.3601106746297, -858.5088156102345, -36.96920494976479, -132.11690358065334, -663.5706659615092, -734.315338317147, -47.66044590366839, -199.08128896546694, -824.6549154555263, -874.2914588136263, -199.14743542371212, -104.94037401279901, -143.0624499108527, -293.0955678163276, -97.66645398021919, -990.9220164425144, -1214.2102960862242, -756.6603083207546, -393.9017750595757, -1139.3983490413634, -122.12526520409412, -1038.8210248120988, -886.153707806117, -177.28921686114487, -785.1939867592366, -857.2579535227512, -779.6563374378105, -266.81800208641647, -200.82332303449954, -939.9665751230805, -106.41871405449191, -1221.0623111417417, -1176.5768305520705, -824.9825252292787, -950.6389358987404, -767.6982365081418, -733.4162880051675, -245.81257045884806, -81.7512662237012, -273.26564428119997, -644.854034974537, -764.5448561015562, -272.40289352752063, -974.0111065269543, -841.7329303946035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574631632805831, "mean_inference_ms": 1.677805415958538, "mean_action_processing_ms": 0.27686820297639453, "mean_env_wait_ms": 3.45654618248619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011763572692871094, "StateBufferConnector_ms": 0.00795745849609375, "ViewRequirementAgentConnector_ms": 0.192840576171875}, "num_episodes": 27, "episode_return_max": -12.872747275193824, "episode_return_min": -1409.567512938059, "episode_return_mean": -663.2725228665499, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.0515106921633, "num_env_steps_trained_throughput_per_sec": 317.0515106921633, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12701.543, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12701.475, "sample_time_ms": 1128.401, "learn_time_ms": 11508.141, "learn_throughput": 347.58, "synch_weights_time_ms": 64.138}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1e132_00002", "date": "2024-08-04_07-47-52", "timestamp": 1722737872, "time_this_iter_s": 12.628812074661255, "time_total_s": 255.75999093055725, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 255.75999093055725, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.072222222222226, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.37608951131503, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.9313056249171496, "policy_loss": -0.012763596762670203, "vf_loss": 3.9394174572080374, "vf_explained_var": 0.9868332068746288, "kl": 0.015909289555687208, "entropy": 1.2101219068591793, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -36.96920494976479, "episode_reward_min": -1349.0870782613242, "episode_reward_mean": -624.2523802886038, "episode_len_mean": 126.4, "episode_media": {}, "episodes_timesteps_total": 12640, "policy_reward_min": {"policy_0": -1349.0870782613242}, "policy_reward_max": {"policy_0": -36.96920494976479}, "policy_reward_mean": {"policy_0": -624.2523802886038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-961.097773862162, -832.3808207786047, -1043.0538452741475, -1098.843451461306, -445.6163732176425, -911.4703173811292, -723.0624844626834, -1073.7866961237523, -52.62233601710271, -1040.0299178824184, -1141.0291375470022, -483.89749643431827, -1087.9247132395867, -1287.1002052255128, -1266.051225759509, -1234.448479070616, -884.3601106746297, -858.5088156102345, -36.96920494976479, -132.11690358065334, -663.5706659615092, -734.315338317147, -47.66044590366839, -199.08128896546694, -824.6549154555263, -874.2914588136263, -199.14743542371212, -104.94037401279901, -143.0624499108527, -293.0955678163276, -97.66645398021919, -990.9220164425144, -1214.2102960862242, -756.6603083207546, -393.9017750595757, -1139.3983490413634, -122.12526520409412, -1038.8210248120988, -886.153707806117, -177.28921686114487, -785.1939867592366, -857.2579535227512, -779.6563374378105, -266.81800208641647, -200.82332303449954, -939.9665751230805, -106.41871405449191, -1221.0623111417417, -1176.5768305520705, -824.9825252292787, -950.6389358987404, -767.6982365081418, -733.4162880051675, -245.81257045884806, -81.7512662237012, -273.26564428119997, -644.854034974537, -764.5448561015562, -272.40289352752063, -974.0111065269543, -841.7329303946035, -454.9583038587, -38.39871249883136, -123.28747365000181, -377.8469543879625, -152.0394640395738, -903.7381062888817, -112.58141735765153, -823.1653485418373, -766.552035093025, -229.47407273543357, -859.1189322022324, -178.99042665288297, -1285.2774426953217, -86.57027626157743, -73.18516487756133, -105.9922568810392, -555.1870923854714, -329.6367015886506, -610.2034069697147, -280.9972456338856, -955.5564470676584, -779.5118199955956, -517.7231911286042, -1349.0870782613242, -234.22282313461707, -243.7925280678014, -990.8061841015151, -553.2578603002323, -1325.4949080549823, -348.52498325563874, -376.82677845260355, -694.1009552699185, -727.6472465329342, -439.1143211879876, -719.1177768058411, -420.6886079209506, -906.2311168757349, -523.9694004111751, -768.1391828451701], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 62, 150, 150, 47, 106, 150, 150, 78, 55, 55, 150, 68, 150, 150, 150, 150, 150, 73, 150, 150, 97, 150, 150, 150, 81, 64, 150, 62, 150, 150, 150, 150, 150, 150, 101, 52, 101, 150, 150, 121, 150, 150, 146, 60, 82, 117, 53, 150, 78, 150, 150, 90, 150, 61, 150, 70, 61, 80, 150, 100, 150, 113, 150, 150, 150, 150, 104, 81, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-961.097773862162, -832.3808207786047, -1043.0538452741475, -1098.843451461306, -445.6163732176425, -911.4703173811292, -723.0624844626834, -1073.7866961237523, -52.62233601710271, -1040.0299178824184, -1141.0291375470022, -483.89749643431827, -1087.9247132395867, -1287.1002052255128, -1266.051225759509, -1234.448479070616, -884.3601106746297, -858.5088156102345, -36.96920494976479, -132.11690358065334, -663.5706659615092, -734.315338317147, -47.66044590366839, -199.08128896546694, -824.6549154555263, -874.2914588136263, -199.14743542371212, -104.94037401279901, -143.0624499108527, -293.0955678163276, -97.66645398021919, -990.9220164425144, -1214.2102960862242, -756.6603083207546, -393.9017750595757, -1139.3983490413634, -122.12526520409412, -1038.8210248120988, -886.153707806117, -177.28921686114487, -785.1939867592366, -857.2579535227512, -779.6563374378105, -266.81800208641647, -200.82332303449954, -939.9665751230805, -106.41871405449191, -1221.0623111417417, -1176.5768305520705, -824.9825252292787, -950.6389358987404, -767.6982365081418, -733.4162880051675, -245.81257045884806, -81.7512662237012, -273.26564428119997, -644.854034974537, -764.5448561015562, -272.40289352752063, -974.0111065269543, -841.7329303946035, -454.9583038587, -38.39871249883136, -123.28747365000181, -377.8469543879625, -152.0394640395738, -903.7381062888817, -112.58141735765153, -823.1653485418373, -766.552035093025, -229.47407273543357, -859.1189322022324, -178.99042665288297, -1285.2774426953217, -86.57027626157743, -73.18516487756133, -105.9922568810392, -555.1870923854714, -329.6367015886506, -610.2034069697147, -280.9972456338856, -955.5564470676584, -779.5118199955956, -517.7231911286042, -1349.0870782613242, -234.22282313461707, -243.7925280678014, -990.8061841015151, -553.2578603002323, -1325.4949080549823, -348.52498325563874, -376.82677845260355, -694.1009552699185, -727.6472465329342, -439.1143211879876, -719.1177768058411, -420.6886079209506, -906.2311168757349, -523.9694004111751, -768.1391828451701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568809219881321, "mean_inference_ms": 1.6761352848067939, "mean_action_processing_ms": 0.27680303644778315, "mean_env_wait_ms": 3.452869922731072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011837005615234375, "StateBufferConnector_ms": 0.008409738540649414, "ViewRequirementAgentConnector_ms": 0.19715309143066406}, "num_episodes": 39, "episode_return_max": -36.96920494976479, "episode_return_min": -1349.0870782613242, "episode_return_mean": -624.2523802886038, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.7005931310117, "num_env_steps_trained_throughput_per_sec": 308.7005931310117, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12711.804, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12711.738, "sample_time_ms": 1130.153, "learn_time_ms": 11516.699, "learn_throughput": 347.322, "synch_weights_time_ms": 64.091}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1e132_00002", "date": "2024-08-04_07-48-05", "timestamp": 1722737885, "time_this_iter_s": 12.97022557258606, "time_total_s": 268.7302165031433, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac122c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 268.7302165031433, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.584210526315786, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 154.9751049757004, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.910549611846606, "policy_loss": -0.01799695560815356, "vf_loss": 3.92310554732879, "vf_explained_var": 0.9780034097532432, "kl": 0.018553350829946216, "entropy": 1.2498614248509208, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -38.39871249883136, "episode_reward_min": -1349.0870782613242, "episode_reward_mean": -586.2042747040837, "episode_len_mean": 125.29, "episode_media": {}, "episodes_timesteps_total": 12529, "policy_reward_min": {"policy_0": -1349.0870782613242}, "policy_reward_max": {"policy_0": -38.39871249883136}, "policy_reward_mean": {"policy_0": -586.2042747040837}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.66645398021919, -990.9220164425144, -1214.2102960862242, -756.6603083207546, -393.9017750595757, -1139.3983490413634, -122.12526520409412, -1038.8210248120988, -886.153707806117, -177.28921686114487, -785.1939867592366, -857.2579535227512, -779.6563374378105, -266.81800208641647, -200.82332303449954, -939.9665751230805, -106.41871405449191, -1221.0623111417417, -1176.5768305520705, -824.9825252292787, -950.6389358987404, -767.6982365081418, -733.4162880051675, -245.81257045884806, -81.7512662237012, -273.26564428119997, -644.854034974537, -764.5448561015562, -272.40289352752063, -974.0111065269543, -841.7329303946035, -454.9583038587, -38.39871249883136, -123.28747365000181, -377.8469543879625, -152.0394640395738, -903.7381062888817, -112.58141735765153, -823.1653485418373, -766.552035093025, -229.47407273543357, -859.1189322022324, -178.99042665288297, -1285.2774426953217, -86.57027626157743, -73.18516487756133, -105.9922568810392, -555.1870923854714, -329.6367015886506, -610.2034069697147, -280.9972456338856, -955.5564470676584, -779.5118199955956, -517.7231911286042, -1349.0870782613242, -234.22282313461707, -243.7925280678014, -990.8061841015151, -553.2578603002323, -1325.4949080549823, -348.52498325563874, -376.82677845260355, -694.1009552699185, -727.6472465329342, -439.1143211879876, -719.1177768058411, -420.6886079209506, -906.2311168757349, -523.9694004111751, -768.1391828451701, -730.8127484152676, -224.895528530403, -1031.549047962275, -1281.3618812262746, -731.0908067053209, -1316.8844438654087, -828.6282070236541, -442.74033302952057, -1160.9845345847316, -887.9466234147847, -727.1721434153809, -513.2860213164312, -1103.2975472194748, -258.54837731237814, -234.56335652028145, -537.6865544070092, -190.85907199124304, -262.3719456448186, -266.1090388840904, -58.96150909786728, -191.674663350225, -295.5790745375138, -471.1838213017185, -129.86404112098379, -773.5998593507932, -806.7181984291585, -182.06676966747548, -325.26750736108875, -803.8415778636063, -103.83445713220948], "episode_lengths": [68, 150, 150, 150, 150, 150, 73, 150, 150, 97, 150, 150, 150, 81, 64, 150, 62, 150, 150, 150, 150, 150, 150, 101, 52, 101, 150, 150, 121, 150, 150, 146, 60, 82, 117, 53, 150, 78, 150, 150, 90, 150, 61, 150, 70, 61, 80, 150, 100, 150, 113, 150, 150, 150, 150, 104, 81, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 106, 150, 135, 112, 78, 65, 95, 78, 135, 59, 150, 150, 71, 91, 150, 73], "policy_policy_0_reward": [-97.66645398021919, -990.9220164425144, -1214.2102960862242, -756.6603083207546, -393.9017750595757, -1139.3983490413634, -122.12526520409412, -1038.8210248120988, -886.153707806117, -177.28921686114487, -785.1939867592366, -857.2579535227512, -779.6563374378105, -266.81800208641647, -200.82332303449954, -939.9665751230805, -106.41871405449191, -1221.0623111417417, -1176.5768305520705, -824.9825252292787, -950.6389358987404, -767.6982365081418, -733.4162880051675, -245.81257045884806, -81.7512662237012, -273.26564428119997, -644.854034974537, -764.5448561015562, -272.40289352752063, -974.0111065269543, -841.7329303946035, -454.9583038587, -38.39871249883136, -123.28747365000181, -377.8469543879625, -152.0394640395738, -903.7381062888817, -112.58141735765153, -823.1653485418373, -766.552035093025, -229.47407273543357, -859.1189322022324, -178.99042665288297, -1285.2774426953217, -86.57027626157743, -73.18516487756133, -105.9922568810392, -555.1870923854714, -329.6367015886506, -610.2034069697147, -280.9972456338856, -955.5564470676584, -779.5118199955956, -517.7231911286042, -1349.0870782613242, -234.22282313461707, -243.7925280678014, -990.8061841015151, -553.2578603002323, -1325.4949080549823, -348.52498325563874, -376.82677845260355, -694.1009552699185, -727.6472465329342, -439.1143211879876, -719.1177768058411, -420.6886079209506, -906.2311168757349, -523.9694004111751, -768.1391828451701, -730.8127484152676, -224.895528530403, -1031.549047962275, -1281.3618812262746, -731.0908067053209, -1316.8844438654087, -828.6282070236541, -442.74033302952057, -1160.9845345847316, -887.9466234147847, -727.1721434153809, -513.2860213164312, -1103.2975472194748, -258.54837731237814, -234.56335652028145, -537.6865544070092, -190.85907199124304, -262.3719456448186, -266.1090388840904, -58.96150909786728, -191.674663350225, -295.5790745375138, -471.1838213017185, -129.86404112098379, -773.5998593507932, -806.7181984291585, -182.06676966747548, -325.26750736108875, -803.8415778636063, -103.83445713220948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563950322895379, "mean_inference_ms": 1.675476672238145, "mean_action_processing_ms": 0.2764175200783241, "mean_env_wait_ms": 3.4473647114692034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011834144592285156, "StateBufferConnector_ms": 0.008371591567993164, "ViewRequirementAgentConnector_ms": 0.19656610488891602}, "num_episodes": 30, "episode_return_max": -38.39871249883136, "episode_return_min": -1349.0870782613242, "episode_return_mean": -586.2042747040837, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.0877510300678, "num_env_steps_trained_throughput_per_sec": 307.0877510300678, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12709.329, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12709.26, "sample_time_ms": 1128.412, "learn_time_ms": 11515.13, "learn_throughput": 347.369, "synch_weights_time_ms": 64.927}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1e132_00002", "date": "2024-08-04_07-48-18", "timestamp": 1722737898, "time_this_iter_s": 13.038186073303223, "time_total_s": 281.76840257644653, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac120ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.76840257644653, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.01111111111111, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.3615321437518, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.63468432414035, "policy_loss": -0.011936887159148075, "vf_loss": 3.641139606386423, "vf_explained_var": 0.977251015479366, "kl": 0.018638915802390934, "entropy": 1.1007707559193174, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -21.01811342682648, "episode_reward_min": -1349.0870782613242, "episode_reward_mean": -537.109312483925, "episode_len_mean": 122.23, "episode_media": {}, "episodes_timesteps_total": 12223, "policy_reward_min": {"policy_0": -1349.0870782613242}, "policy_reward_max": {"policy_0": -21.01811342682648}, "policy_reward_mean": {"policy_0": -537.109312483925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-377.8469543879625, -152.0394640395738, -903.7381062888817, -112.58141735765153, -823.1653485418373, -766.552035093025, -229.47407273543357, -859.1189322022324, -178.99042665288297, -1285.2774426953217, -86.57027626157743, -73.18516487756133, -105.9922568810392, -555.1870923854714, -329.6367015886506, -610.2034069697147, -280.9972456338856, -955.5564470676584, -779.5118199955956, -517.7231911286042, -1349.0870782613242, -234.22282313461707, -243.7925280678014, -990.8061841015151, -553.2578603002323, -1325.4949080549823, -348.52498325563874, -376.82677845260355, -694.1009552699185, -727.6472465329342, -439.1143211879876, -719.1177768058411, -420.6886079209506, -906.2311168757349, -523.9694004111751, -768.1391828451701, -730.8127484152676, -224.895528530403, -1031.549047962275, -1281.3618812262746, -731.0908067053209, -1316.8844438654087, -828.6282070236541, -442.74033302952057, -1160.9845345847316, -887.9466234147847, -727.1721434153809, -513.2860213164312, -1103.2975472194748, -258.54837731237814, -234.56335652028145, -537.6865544070092, -190.85907199124304, -262.3719456448186, -266.1090388840904, -58.96150909786728, -191.674663350225, -295.5790745375138, -471.1838213017185, -129.86404112098379, -773.5998593507932, -806.7181984291585, -182.06676966747548, -325.26750736108875, -803.8415778636063, -103.83445713220948, -705.0984884150889, -432.3315618318419, -291.00054038225744, -285.6392159664099, -191.2968994927408, -380.9408180722665, -34.00132689563922, -930.9989262145044, -787.2722610814793, -1055.0795380213012, -144.68247270463849, -211.98538433038723, -851.3511712493731, -142.59555117447144, -515.3575882800939, -646.1676649731739, -708.418355303885, -193.13691034152964, -337.48392117803, -1058.4981454072638, -77.06336117363405, -494.0090748440071, -462.0823931396899, -894.2536442066954, -110.31331442437465, -21.01811342682648, -357.4729132047142, -825.2322575725152, -145.67329015107995, -1053.7841010581567, -755.8352644054835, -233.9675346274442, -538.6694615712526, -360.4705383258677], "episode_lengths": [117, 53, 150, 78, 150, 150, 90, 150, 61, 150, 70, 61, 80, 150, 100, 150, 113, 150, 150, 150, 150, 104, 81, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 106, 150, 135, 112, 78, 65, 95, 78, 135, 59, 150, 150, 71, 91, 150, 73, 150, 149, 103, 117, 77, 100, 41, 150, 150, 150, 60, 124, 150, 51, 122, 150, 150, 81, 132, 150, 58, 150, 150, 150, 76, 43, 92, 150, 70, 150, 150, 102, 150, 104], "policy_policy_0_reward": [-377.8469543879625, -152.0394640395738, -903.7381062888817, -112.58141735765153, -823.1653485418373, -766.552035093025, -229.47407273543357, -859.1189322022324, -178.99042665288297, -1285.2774426953217, -86.57027626157743, -73.18516487756133, -105.9922568810392, -555.1870923854714, -329.6367015886506, -610.2034069697147, -280.9972456338856, -955.5564470676584, -779.5118199955956, -517.7231911286042, -1349.0870782613242, -234.22282313461707, -243.7925280678014, -990.8061841015151, -553.2578603002323, -1325.4949080549823, -348.52498325563874, -376.82677845260355, -694.1009552699185, -727.6472465329342, -439.1143211879876, -719.1177768058411, -420.6886079209506, -906.2311168757349, -523.9694004111751, -768.1391828451701, -730.8127484152676, -224.895528530403, -1031.549047962275, -1281.3618812262746, -731.0908067053209, -1316.8844438654087, -828.6282070236541, -442.74033302952057, -1160.9845345847316, -887.9466234147847, -727.1721434153809, -513.2860213164312, -1103.2975472194748, -258.54837731237814, -234.56335652028145, -537.6865544070092, -190.85907199124304, -262.3719456448186, -266.1090388840904, -58.96150909786728, -191.674663350225, -295.5790745375138, -471.1838213017185, -129.86404112098379, -773.5998593507932, -806.7181984291585, -182.06676966747548, -325.26750736108875, -803.8415778636063, -103.83445713220948, -705.0984884150889, -432.3315618318419, -291.00054038225744, -285.6392159664099, -191.2968994927408, -380.9408180722665, -34.00132689563922, -930.9989262145044, -787.2722610814793, -1055.0795380213012, -144.68247270463849, -211.98538433038723, -851.3511712493731, -142.59555117447144, -515.3575882800939, -646.1676649731739, -708.418355303885, -193.13691034152964, -337.48392117803, -1058.4981454072638, -77.06336117363405, -494.0090748440071, -462.0823931396899, -894.2536442066954, -110.31331442437465, -21.01811342682648, -357.4729132047142, -825.2322575725152, -145.67329015107995, -1053.7841010581567, -755.8352644054835, -233.9675346274442, -538.6694615712526, -360.4705383258677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567911732189857, "mean_inference_ms": 1.6759891162785885, "mean_action_processing_ms": 0.27670225208289867, "mean_env_wait_ms": 3.4498352991833303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012061834335327148, "StateBufferConnector_ms": 0.008372306823730469, "ViewRequirementAgentConnector_ms": 0.1967465877532959}, "num_episodes": 34, "episode_return_max": -21.01811342682648, "episode_return_min": -1349.0870782613242, "episode_return_mean": -537.109312483925, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.5671330926711, "num_env_steps_trained_throughput_per_sec": 305.5671330926711, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12654.493, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12654.425, "sample_time_ms": 1123.683, "learn_time_ms": 11467.905, "learn_throughput": 348.8, "synch_weights_time_ms": 62.056}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1e132_00002", "date": "2024-08-04_07-48-31", "timestamp": 1722737911, "time_this_iter_s": 13.101929903030396, "time_total_s": 294.87033247947693, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 294.87033247947693, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.46842105263158, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.76832429965336, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.404146653289596, "policy_loss": -0.011027239956213937, "vf_loss": 3.4103772255281606, "vf_explained_var": 0.9784866231804092, "kl": 0.016367212256348792, "entropy": 1.1350485776240626, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -11.669285109122582, "episode_reward_min": -1316.8844438654087, "episode_reward_mean": -540.88922222096, "episode_len_mean": 123.69, "episode_media": {}, "episodes_timesteps_total": 12369, "policy_reward_min": {"policy_0": -1316.8844438654087}, "policy_reward_max": {"policy_0": -11.669285109122582}, "policy_reward_mean": {"policy_0": -540.88922222096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-420.6886079209506, -906.2311168757349, -523.9694004111751, -768.1391828451701, -730.8127484152676, -224.895528530403, -1031.549047962275, -1281.3618812262746, -731.0908067053209, -1316.8844438654087, -828.6282070236541, -442.74033302952057, -1160.9845345847316, -887.9466234147847, -727.1721434153809, -513.2860213164312, -1103.2975472194748, -258.54837731237814, -234.56335652028145, -537.6865544070092, -190.85907199124304, -262.3719456448186, -266.1090388840904, -58.96150909786728, -191.674663350225, -295.5790745375138, -471.1838213017185, -129.86404112098379, -773.5998593507932, -806.7181984291585, -182.06676966747548, -325.26750736108875, -803.8415778636063, -103.83445713220948, -705.0984884150889, -432.3315618318419, -291.00054038225744, -285.6392159664099, -191.2968994927408, -380.9408180722665, -34.00132689563922, -930.9989262145044, -787.2722610814793, -1055.0795380213012, -144.68247270463849, -211.98538433038723, -851.3511712493731, -142.59555117447144, -515.3575882800939, -646.1676649731739, -708.418355303885, -193.13691034152964, -337.48392117803, -1058.4981454072638, -77.06336117363405, -494.0090748440071, -462.0823931396899, -894.2536442066954, -110.31331442437465, -21.01811342682648, -357.4729132047142, -825.2322575725152, -145.67329015107995, -1053.7841010581567, -755.8352644054835, -233.9675346274442, -538.6694615712526, -360.4705383258677, -798.8756244576849, -790.6224387069796, -849.177561472182, -1243.8851962037165, -232.05807791666533, -68.79274202067171, -515.5377642613139, -295.6431726919596, -740.1551429483385, -818.6333956568155, -187.03761280295197, -440.1994513525052, -1176.0552052414084, -11.669285109122582, -583.3956959181155, -753.3848769871954, -453.36150852144334, -711.8935384575703, -503.57783022679575, -157.91504196689758, -720.297060853539, -1075.6305312095876, -437.7580970295722, -537.8459238759855, -716.5816034092343, -825.1913252475908, -208.7676444403374, -699.403764682147, -683.6388955131767, -556.6236169095877, -449.281858375971, -120.44073544640119], "episode_lengths": [150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 106, 150, 135, 112, 78, 65, 95, 78, 135, 59, 150, 150, 71, 91, 150, 73, 150, 149, 103, 117, 77, 100, 41, 150, 150, 150, 60, 124, 150, 51, 122, 150, 150, 81, 132, 150, 58, 150, 150, 150, 76, 43, 92, 150, 70, 150, 150, 102, 150, 104, 150, 150, 150, 150, 85, 72, 150, 143, 150, 150, 94, 150, 150, 40, 111, 150, 103, 138, 150, 83, 150, 150, 149, 134, 150, 150, 68, 150, 150, 135, 143, 79], "policy_policy_0_reward": [-420.6886079209506, -906.2311168757349, -523.9694004111751, -768.1391828451701, -730.8127484152676, -224.895528530403, -1031.549047962275, -1281.3618812262746, -731.0908067053209, -1316.8844438654087, -828.6282070236541, -442.74033302952057, -1160.9845345847316, -887.9466234147847, -727.1721434153809, -513.2860213164312, -1103.2975472194748, -258.54837731237814, -234.56335652028145, -537.6865544070092, -190.85907199124304, -262.3719456448186, -266.1090388840904, -58.96150909786728, -191.674663350225, -295.5790745375138, -471.1838213017185, -129.86404112098379, -773.5998593507932, -806.7181984291585, -182.06676966747548, -325.26750736108875, -803.8415778636063, -103.83445713220948, -705.0984884150889, -432.3315618318419, -291.00054038225744, -285.6392159664099, -191.2968994927408, -380.9408180722665, -34.00132689563922, -930.9989262145044, -787.2722610814793, -1055.0795380213012, -144.68247270463849, -211.98538433038723, -851.3511712493731, -142.59555117447144, -515.3575882800939, -646.1676649731739, -708.418355303885, -193.13691034152964, -337.48392117803, -1058.4981454072638, -77.06336117363405, -494.0090748440071, -462.0823931396899, -894.2536442066954, -110.31331442437465, -21.01811342682648, -357.4729132047142, -825.2322575725152, -145.67329015107995, -1053.7841010581567, -755.8352644054835, -233.9675346274442, -538.6694615712526, -360.4705383258677, -798.8756244576849, -790.6224387069796, -849.177561472182, -1243.8851962037165, -232.05807791666533, -68.79274202067171, -515.5377642613139, -295.6431726919596, -740.1551429483385, -818.6333956568155, -187.03761280295197, -440.1994513525052, -1176.0552052414084, -11.669285109122582, -583.3956959181155, -753.3848769871954, -453.36150852144334, -711.8935384575703, -503.57783022679575, -157.91504196689758, -720.297060853539, -1075.6305312095876, -437.7580970295722, -537.8459238759855, -716.5816034092343, -825.1913252475908, -208.7676444403374, -699.403764682147, -683.6388955131767, -556.6236169095877, -449.281858375971, -120.44073544640119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565611615986876, "mean_inference_ms": 1.6744887165793116, "mean_action_processing_ms": 0.2762237738716978, "mean_env_wait_ms": 3.443748047883145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012179374694824219, "StateBufferConnector_ms": 0.008012533187866211, "ViewRequirementAgentConnector_ms": 0.19289612770080566}, "num_episodes": 32, "episode_return_max": -11.669285109122582, "episode_return_min": -1316.8844438654087, "episode_return_mean": -540.88922222096, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.8924962803645, "num_env_steps_trained_throughput_per_sec": 305.8924962803645, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12649.688, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12649.619, "sample_time_ms": 1128.076, "learn_time_ms": 11458.921, "learn_throughput": 349.073, "synch_weights_time_ms": 61.839}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1e132_00002", "date": "2024-08-04_07-48-45", "timestamp": 1722737925, "time_this_iter_s": 13.08949613571167, "time_total_s": 307.9598286151886, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac134c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.9598286151886, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.916666666666664, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.00889631509781, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.1343536616613465, "policy_loss": -0.011852346244753183, "vf_loss": 3.140697223568956, "vf_explained_var": 0.9771707609916727, "kl": 0.01872960423358263, "entropy": 1.1009532337387402, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -11.669285109122582, "episode_reward_min": -1243.8851962037165, "episode_reward_mean": -508.5333585152597, "episode_len_mean": 121.82, "episode_media": {}, "episodes_timesteps_total": 12182, "policy_reward_min": {"policy_0": -1243.8851962037165}, "policy_reward_max": {"policy_0": -11.669285109122582}, "policy_reward_mean": {"policy_0": -508.5333585152597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.06676966747548, -325.26750736108875, -803.8415778636063, -103.83445713220948, -705.0984884150889, -432.3315618318419, -291.00054038225744, -285.6392159664099, -191.2968994927408, -380.9408180722665, -34.00132689563922, -930.9989262145044, -787.2722610814793, -1055.0795380213012, -144.68247270463849, -211.98538433038723, -851.3511712493731, -142.59555117447144, -515.3575882800939, -646.1676649731739, -708.418355303885, -193.13691034152964, -337.48392117803, -1058.4981454072638, -77.06336117363405, -494.0090748440071, -462.0823931396899, -894.2536442066954, -110.31331442437465, -21.01811342682648, -357.4729132047142, -825.2322575725152, -145.67329015107995, -1053.7841010581567, -755.8352644054835, -233.9675346274442, -538.6694615712526, -360.4705383258677, -798.8756244576849, -790.6224387069796, -849.177561472182, -1243.8851962037165, -232.05807791666533, -68.79274202067171, -515.5377642613139, -295.6431726919596, -740.1551429483385, -818.6333956568155, -187.03761280295197, -440.1994513525052, -1176.0552052414084, -11.669285109122582, -583.3956959181155, -753.3848769871954, -453.36150852144334, -711.8935384575703, -503.57783022679575, -157.91504196689758, -720.297060853539, -1075.6305312095876, -437.7580970295722, -537.8459238759855, -716.5816034092343, -825.1913252475908, -208.7676444403374, -699.403764682147, -683.6388955131767, -556.6236169095877, -449.281858375971, -120.44073544640119, -1195.7467401748686, -632.1497420821901, -945.8065654227985, -225.53688903923072, -352.6038067425986, -447.6052008921212, -552.8259414343935, -292.18101606300394, -291.56403192094297, -20.55876213129502, -487.54337611920005, -458.14728921457584, -759.3171332233301, -263.88006244609625, -445.4322250350586, -221.55590502252608, -1148.8241370159003, -94.34863155043105, -503.7508316775396, -369.51378226997315, -359.4434655928612, -844.2313880478152, -172.49763721544923, -848.8477081185092, -868.9211592662632, -231.93634008398246, -368.5772022214421, -57.74755300423079, -450.9351605019792, -929.7816326094012], "episode_lengths": [71, 91, 150, 73, 150, 149, 103, 117, 77, 100, 41, 150, 150, 150, 60, 124, 150, 51, 122, 150, 150, 81, 132, 150, 58, 150, 150, 150, 76, 43, 92, 150, 70, 150, 150, 102, 150, 104, 150, 150, 150, 150, 85, 72, 150, 143, 150, 150, 94, 150, 150, 40, 111, 150, 103, 138, 150, 83, 150, 150, 149, 134, 150, 150, 68, 150, 150, 135, 143, 79, 150, 150, 143, 72, 143, 150, 150, 129, 75, 42, 150, 150, 150, 121, 150, 70, 150, 80, 150, 121, 135, 150, 84, 150, 150, 96, 89, 68, 150, 150], "policy_policy_0_reward": [-182.06676966747548, -325.26750736108875, -803.8415778636063, -103.83445713220948, -705.0984884150889, -432.3315618318419, -291.00054038225744, -285.6392159664099, -191.2968994927408, -380.9408180722665, -34.00132689563922, -930.9989262145044, -787.2722610814793, -1055.0795380213012, -144.68247270463849, -211.98538433038723, -851.3511712493731, -142.59555117447144, -515.3575882800939, -646.1676649731739, -708.418355303885, -193.13691034152964, -337.48392117803, -1058.4981454072638, -77.06336117363405, -494.0090748440071, -462.0823931396899, -894.2536442066954, -110.31331442437465, -21.01811342682648, -357.4729132047142, -825.2322575725152, -145.67329015107995, -1053.7841010581567, -755.8352644054835, -233.9675346274442, -538.6694615712526, -360.4705383258677, -798.8756244576849, -790.6224387069796, -849.177561472182, -1243.8851962037165, -232.05807791666533, -68.79274202067171, -515.5377642613139, -295.6431726919596, -740.1551429483385, -818.6333956568155, -187.03761280295197, -440.1994513525052, -1176.0552052414084, -11.669285109122582, -583.3956959181155, -753.3848769871954, -453.36150852144334, -711.8935384575703, -503.57783022679575, -157.91504196689758, -720.297060853539, -1075.6305312095876, -437.7580970295722, -537.8459238759855, -716.5816034092343, -825.1913252475908, -208.7676444403374, -699.403764682147, -683.6388955131767, -556.6236169095877, -449.281858375971, -120.44073544640119, -1195.7467401748686, -632.1497420821901, -945.8065654227985, -225.53688903923072, -352.6038067425986, -447.6052008921212, -552.8259414343935, -292.18101606300394, -291.56403192094297, -20.55876213129502, -487.54337611920005, -458.14728921457584, -759.3171332233301, -263.88006244609625, -445.4322250350586, -221.55590502252608, -1148.8241370159003, -94.34863155043105, -503.7508316775396, -369.51378226997315, -359.4434655928612, -844.2313880478152, -172.49763721544923, -848.8477081185092, -868.9211592662632, -231.93634008398246, -368.5772022214421, -57.74755300423079, -450.9351605019792, -929.7816326094012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568203472436625, "mean_inference_ms": 1.6743462726559069, "mean_action_processing_ms": 0.2762517247632643, "mean_env_wait_ms": 3.4436305518030768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012300968170166016, "StateBufferConnector_ms": 0.012086868286132812, "ViewRequirementAgentConnector_ms": 0.19443297386169434}, "num_episodes": 30, "episode_return_max": -11.669285109122582, "episode_return_min": -1243.8851962037165, "episode_return_mean": -508.5333585152597, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.01516425312667, "num_env_steps_trained_throughput_per_sec": 302.01516425312667, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12652.714, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12652.645, "sample_time_ms": 1136.644, "learn_time_ms": 11452.112, "learn_throughput": 349.281, "synch_weights_time_ms": 63.107}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "1e132_00002", "date": "2024-08-04_07-48-58", "timestamp": 1722737938, "time_this_iter_s": 13.256884098052979, "time_total_s": 321.2167127132416, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac135870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.2167127132416, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.710526315789473, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.03342139522235, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.8356589678674937, "policy_loss": -0.018411208864320846, "vf_loss": 2.847943764552474, "vf_explained_var": 0.9922789632032315, "kl": 0.02079029787989081, "entropy": 1.106783559297522, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -11.669285109122582, "episode_reward_min": -1360.2902189669096, "episode_reward_mean": -513.1047514442012, "episode_len_mean": 122.11, "episode_media": {}, "episodes_timesteps_total": 12211, "policy_reward_min": {"policy_0": -1360.2902189669096}, "policy_reward_max": {"policy_0": -11.669285109122582}, "policy_reward_mean": {"policy_0": -513.1047514442012}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.8756244576849, -790.6224387069796, -849.177561472182, -1243.8851962037165, -232.05807791666533, -68.79274202067171, -515.5377642613139, -295.6431726919596, -740.1551429483385, -818.6333956568155, -187.03761280295197, -440.1994513525052, -1176.0552052414084, -11.669285109122582, -583.3956959181155, -753.3848769871954, -453.36150852144334, -711.8935384575703, -503.57783022679575, -157.91504196689758, -720.297060853539, -1075.6305312095876, -437.7580970295722, -537.8459238759855, -716.5816034092343, -825.1913252475908, -208.7676444403374, -699.403764682147, -683.6388955131767, -556.6236169095877, -449.281858375971, -120.44073544640119, -1195.7467401748686, -632.1497420821901, -945.8065654227985, -225.53688903923072, -352.6038067425986, -447.6052008921212, -552.8259414343935, -292.18101606300394, -291.56403192094297, -20.55876213129502, -487.54337611920005, -458.14728921457584, -759.3171332233301, -263.88006244609625, -445.4322250350586, -221.55590502252608, -1148.8241370159003, -94.34863155043105, -503.7508316775396, -369.51378226997315, -359.4434655928612, -844.2313880478152, -172.49763721544923, -848.8477081185092, -868.9211592662632, -231.93634008398246, -368.5772022214421, -57.74755300423079, -450.9351605019792, -929.7816326094012, -458.5294360568147, -1360.2902189669096, -790.4467786950764, -202.3399612230273, -256.3386839576577, -96.05646651595903, -779.077106148449, -48.2773343768711, -164.2405737445269, -175.12788173675506, -833.8110904751857, -61.00249692000584, -252.7922054481631, -50.82858684530517, -948.26476363168, -1028.5673426515812, -574.3991371622163, -176.56638373683546, -341.869981726829, -33.50292320946382, -228.4224501397676, -434.87868156076144, -254.12186032130856, -199.011079428674, -50.341466123135554, -159.9095431288584, -74.81641247378137, -733.4271624795336, -523.8676046903959, -810.8192342577034, -593.3779941583281, -1223.8491546115574, -702.9910315813174, -648.1457427731636, -149.8917131281452, -996.643348476028, -745.9594439171822, -942.5283318876768], "episode_lengths": [150, 150, 150, 150, 85, 72, 150, 143, 150, 150, 94, 150, 150, 40, 111, 150, 103, 138, 150, 83, 150, 150, 149, 134, 150, 150, 68, 150, 150, 135, 143, 79, 150, 150, 143, 72, 143, 150, 150, 129, 75, 42, 150, 150, 150, 121, 150, 70, 150, 80, 150, 121, 135, 150, 84, 150, 150, 96, 89, 68, 150, 150, 150, 150, 150, 95, 96, 74, 150, 51, 78, 75, 150, 49, 112, 52, 150, 150, 150, 94, 119, 43, 114, 150, 81, 91, 46, 87, 65, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150], "policy_policy_0_reward": [-798.8756244576849, -790.6224387069796, -849.177561472182, -1243.8851962037165, -232.05807791666533, -68.79274202067171, -515.5377642613139, -295.6431726919596, -740.1551429483385, -818.6333956568155, -187.03761280295197, -440.1994513525052, -1176.0552052414084, -11.669285109122582, -583.3956959181155, -753.3848769871954, -453.36150852144334, -711.8935384575703, -503.57783022679575, -157.91504196689758, -720.297060853539, -1075.6305312095876, -437.7580970295722, -537.8459238759855, -716.5816034092343, -825.1913252475908, -208.7676444403374, -699.403764682147, -683.6388955131767, -556.6236169095877, -449.281858375971, -120.44073544640119, -1195.7467401748686, -632.1497420821901, -945.8065654227985, -225.53688903923072, -352.6038067425986, -447.6052008921212, -552.8259414343935, -292.18101606300394, -291.56403192094297, -20.55876213129502, -487.54337611920005, -458.14728921457584, -759.3171332233301, -263.88006244609625, -445.4322250350586, -221.55590502252608, -1148.8241370159003, -94.34863155043105, -503.7508316775396, -369.51378226997315, -359.4434655928612, -844.2313880478152, -172.49763721544923, -848.8477081185092, -868.9211592662632, -231.93634008398246, -368.5772022214421, -57.74755300423079, -450.9351605019792, -929.7816326094012, -458.5294360568147, -1360.2902189669096, -790.4467786950764, -202.3399612230273, -256.3386839576577, -96.05646651595903, -779.077106148449, -48.2773343768711, -164.2405737445269, -175.12788173675506, -833.8110904751857, -61.00249692000584, -252.7922054481631, -50.82858684530517, -948.26476363168, -1028.5673426515812, -574.3991371622163, -176.56638373683546, -341.869981726829, -33.50292320946382, -228.4224501397676, -434.87868156076144, -254.12186032130856, -199.011079428674, -50.341466123135554, -159.9095431288584, -74.81641247378137, -733.4271624795336, -523.8676046903959, -810.8192342577034, -593.3779941583281, -1223.8491546115574, -702.9910315813174, -648.1457427731636, -149.8917131281452, -996.643348476028, -745.9594439171822, -942.5283318876768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570280135468169, "mean_inference_ms": 1.6747618080448279, "mean_action_processing_ms": 0.27626946150218545, "mean_env_wait_ms": 3.442040414534558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012479066848754883, "StateBufferConnector_ms": 0.012157201766967773, "ViewRequirementAgentConnector_ms": 0.19513297080993652}, "num_episodes": 38, "episode_return_max": -11.669285109122582, "episode_return_min": -1360.2902189669096, "episode_return_mean": -513.1047514442012, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.65937938230246, "num_env_steps_trained_throughput_per_sec": 363.65937938230246, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12439.641, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12439.573, "sample_time_ms": 1141.036, "learn_time_ms": 11234.303, "learn_throughput": 356.052, "synch_weights_time_ms": 63.449}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "1e132_00002", "date": "2024-08-04_07-49-09", "timestamp": 1722737949, "time_this_iter_s": 11.011226654052734, "time_total_s": 332.2279393672943, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544895a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.2279393672943, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.79375, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.2898564875126, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.7521422274410723, "policy_loss": -0.011499225742106016, "vf_loss": 2.7566528604676326, "vf_explained_var": 0.9909378798057635, "kl": 0.015759056409539576, "entropy": 1.0298643972103794, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -0.5078714503885491, "episode_reward_min": -1360.2902189669096, "episode_reward_mean": -470.7931197945569, "episode_len_mean": 117.67, "episode_media": {}, "episodes_timesteps_total": 11767, "policy_reward_min": {"policy_0": -1360.2902189669096}, "policy_reward_max": {"policy_0": -0.5078714503885491}, "policy_reward_mean": {"policy_0": -470.7931197945569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1195.7467401748686, -632.1497420821901, -945.8065654227985, -225.53688903923072, -352.6038067425986, -447.6052008921212, -552.8259414343935, -292.18101606300394, -291.56403192094297, -20.55876213129502, -487.54337611920005, -458.14728921457584, -759.3171332233301, -263.88006244609625, -445.4322250350586, -221.55590502252608, -1148.8241370159003, -94.34863155043105, -503.7508316775396, -369.51378226997315, -359.4434655928612, -844.2313880478152, -172.49763721544923, -848.8477081185092, -868.9211592662632, -231.93634008398246, -368.5772022214421, -57.74755300423079, -450.9351605019792, -929.7816326094012, -458.5294360568147, -1360.2902189669096, -790.4467786950764, -202.3399612230273, -256.3386839576577, -96.05646651595903, -779.077106148449, -48.2773343768711, -164.2405737445269, -175.12788173675506, -833.8110904751857, -61.00249692000584, -252.7922054481631, -50.82858684530517, -948.26476363168, -1028.5673426515812, -574.3991371622163, -176.56638373683546, -341.869981726829, -33.50292320946382, -228.4224501397676, -434.87868156076144, -254.12186032130856, -199.011079428674, -50.341466123135554, -159.9095431288584, -74.81641247378137, -733.4271624795336, -523.8676046903959, -810.8192342577034, -593.3779941583281, -1223.8491546115574, -702.9910315813174, -648.1457427731636, -149.8917131281452, -996.643348476028, -745.9594439171822, -942.5283318876768, -535.1877531606002, -307.3737255972807, -573.0333041308934, -121.6406632791331, -127.98439258441103, -869.7660845171621, -193.51670042843142, -112.90235911720495, -1124.531459378536, -596.1679344744903, -554.4061005831769, -64.8200201476954, -303.53308495013727, -701.9068764913594, -147.0245106567464, -0.5078714503885491, -742.5617030446894, -832.7360395249489, -211.7959530172263, -375.53648517346517, -84.29568211305349, -155.97213236751185, -423.1494937955739, -90.43070860449798, -981.3733740673886, -965.1505737464595, -385.07837336966674, -637.2675912495238, -137.0615661371579, -164.06138514551867, -1155.5821223280368, -455.8130303166841], "episode_lengths": [150, 150, 143, 72, 143, 150, 150, 129, 75, 42, 150, 150, 150, 121, 150, 70, 150, 80, 150, 121, 135, 150, 84, 150, 150, 96, 89, 68, 150, 150, 150, 150, 150, 95, 96, 74, 150, 51, 78, 75, 150, 49, 112, 52, 150, 150, 150, 94, 119, 43, 114, 150, 81, 91, 46, 87, 65, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 129, 150, 83, 85, 150, 97, 78, 150, 150, 150, 57, 101, 150, 83, 34, 150, 150, 69, 122, 74, 97, 104, 70, 150, 150, 150, 146, 78, 76, 150, 150], "policy_policy_0_reward": [-1195.7467401748686, -632.1497420821901, -945.8065654227985, -225.53688903923072, -352.6038067425986, -447.6052008921212, -552.8259414343935, -292.18101606300394, -291.56403192094297, -20.55876213129502, -487.54337611920005, -458.14728921457584, -759.3171332233301, -263.88006244609625, -445.4322250350586, -221.55590502252608, -1148.8241370159003, -94.34863155043105, -503.7508316775396, -369.51378226997315, -359.4434655928612, -844.2313880478152, -172.49763721544923, -848.8477081185092, -868.9211592662632, -231.93634008398246, -368.5772022214421, -57.74755300423079, -450.9351605019792, -929.7816326094012, -458.5294360568147, -1360.2902189669096, -790.4467786950764, -202.3399612230273, -256.3386839576577, -96.05646651595903, -779.077106148449, -48.2773343768711, -164.2405737445269, -175.12788173675506, -833.8110904751857, -61.00249692000584, -252.7922054481631, -50.82858684530517, -948.26476363168, -1028.5673426515812, -574.3991371622163, -176.56638373683546, -341.869981726829, -33.50292320946382, -228.4224501397676, -434.87868156076144, -254.12186032130856, -199.011079428674, -50.341466123135554, -159.9095431288584, -74.81641247378137, -733.4271624795336, -523.8676046903959, -810.8192342577034, -593.3779941583281, -1223.8491546115574, -702.9910315813174, -648.1457427731636, -149.8917131281452, -996.643348476028, -745.9594439171822, -942.5283318876768, -535.1877531606002, -307.3737255972807, -573.0333041308934, -121.6406632791331, -127.98439258441103, -869.7660845171621, -193.51670042843142, -112.90235911720495, -1124.531459378536, -596.1679344744903, -554.4061005831769, -64.8200201476954, -303.53308495013727, -701.9068764913594, -147.0245106567464, -0.5078714503885491, -742.5617030446894, -832.7360395249489, -211.7959530172263, -375.53648517346517, -84.29568211305349, -155.97213236751185, -423.1494937955739, -90.43070860449798, -981.3733740673886, -965.1505737464595, -385.07837336966674, -637.2675912495238, -137.0615661371579, -164.06138514551867, -1155.5821223280368, -455.8130303166841]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566169253295616, "mean_inference_ms": 1.674610135278646, "mean_action_processing_ms": 0.27608953204809256, "mean_env_wait_ms": 3.43891186077542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012405872344970703, "StateBufferConnector_ms": 0.012093067169189453, "ViewRequirementAgentConnector_ms": 0.1944591999053955}, "num_episodes": 32, "episode_return_max": -0.5078714503885491, "episode_return_min": -1360.2902189669096, "episode_return_mean": -470.7931197945569, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.68870230580836, "num_env_steps_trained_throughput_per_sec": 304.68870230580836, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12459.739, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12459.67, "sample_time_ms": 1139.473, "learn_time_ms": 11253.824, "learn_throughput": 355.435, "synch_weights_time_ms": 65.576}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "1e132_00002", "date": "2024-08-04_07-49-22", "timestamp": 1722737962, "time_this_iter_s": 13.140803575515747, "time_total_s": 345.36874294281006, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bc820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 345.36874294281006, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.55263157894737, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.24624823729198, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.938721150904894, "policy_loss": -0.013280063067698696, "vf_loss": 2.9451925585667293, "vf_explained_var": 0.9881600761165221, "kl": 0.01535457251735961, "entropy": 1.0089806515102586, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -0.5078714503885491, "episode_reward_min": -1223.8491546115574, "episode_reward_mean": -467.13367163996315, "episode_len_mean": 115.48, "episode_media": {}, "episodes_timesteps_total": 11548, "policy_reward_min": {"policy_0": -1223.8491546115574}, "policy_reward_max": {"policy_0": -0.5078714503885491}, "policy_reward_mean": {"policy_0": -467.13367163996315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-779.077106148449, -48.2773343768711, -164.2405737445269, -175.12788173675506, -833.8110904751857, -61.00249692000584, -252.7922054481631, -50.82858684530517, -948.26476363168, -1028.5673426515812, -574.3991371622163, -176.56638373683546, -341.869981726829, -33.50292320946382, -228.4224501397676, -434.87868156076144, -254.12186032130856, -199.011079428674, -50.341466123135554, -159.9095431288584, -74.81641247378137, -733.4271624795336, -523.8676046903959, -810.8192342577034, -593.3779941583281, -1223.8491546115574, -702.9910315813174, -648.1457427731636, -149.8917131281452, -996.643348476028, -745.9594439171822, -942.5283318876768, -535.1877531606002, -307.3737255972807, -573.0333041308934, -121.6406632791331, -127.98439258441103, -869.7660845171621, -193.51670042843142, -112.90235911720495, -1124.531459378536, -596.1679344744903, -554.4061005831769, -64.8200201476954, -303.53308495013727, -701.9068764913594, -147.0245106567464, -0.5078714503885491, -742.5617030446894, -832.7360395249489, -211.7959530172263, -375.53648517346517, -84.29568211305349, -155.97213236751185, -423.1494937955739, -90.43070860449798, -981.3733740673886, -965.1505737464595, -385.07837336966674, -637.2675912495238, -137.0615661371579, -164.06138514551867, -1155.5821223280368, -455.8130303166841, -1147.8065563614039, -94.26072222251703, -565.6597281064625, -449.6011027204079, -539.2578597258206, -1133.7685989014929, -202.18710714007995, -36.32631876024082, -693.2665997519132, -51.914763808085866, -203.32661785384582, -926.2367438836468, -47.528565539304445, -282.392961406326, -406.3269361688959, -399.57073543760936, -135.13770267047786, -1118.2464994262054, -95.68097442301695, -238.9257249234389, -556.1819029908193, -1028.6993386755655, -857.242707719165, -715.06008053451, -1022.867029535141, -1012.2755986573935, -976.6787805719551, -251.11100620182728, -482.6065876575841, -101.03148380218376, -62.47885092138399, -90.89278442390547, -862.6216086229147, -600.8254580956843, -236.9833480737327, -14.88866038111374], "episode_lengths": [150, 51, 78, 75, 150, 49, 112, 52, 150, 150, 150, 94, 119, 43, 114, 150, 81, 91, 46, 87, 65, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 129, 150, 83, 85, 150, 97, 78, 150, 150, 150, 57, 101, 150, 83, 34, 150, 150, 69, 122, 74, 97, 104, 70, 150, 150, 150, 146, 78, 76, 150, 150, 150, 65, 150, 150, 132, 150, 106, 52, 150, 51, 79, 150, 44, 150, 150, 150, 91, 150, 77, 102, 150, 150, 150, 150, 150, 150, 150, 86, 150, 50, 68, 60, 150, 127, 129, 45], "policy_policy_0_reward": [-779.077106148449, -48.2773343768711, -164.2405737445269, -175.12788173675506, -833.8110904751857, -61.00249692000584, -252.7922054481631, -50.82858684530517, -948.26476363168, -1028.5673426515812, -574.3991371622163, -176.56638373683546, -341.869981726829, -33.50292320946382, -228.4224501397676, -434.87868156076144, -254.12186032130856, -199.011079428674, -50.341466123135554, -159.9095431288584, -74.81641247378137, -733.4271624795336, -523.8676046903959, -810.8192342577034, -593.3779941583281, -1223.8491546115574, -702.9910315813174, -648.1457427731636, -149.8917131281452, -996.643348476028, -745.9594439171822, -942.5283318876768, -535.1877531606002, -307.3737255972807, -573.0333041308934, -121.6406632791331, -127.98439258441103, -869.7660845171621, -193.51670042843142, -112.90235911720495, -1124.531459378536, -596.1679344744903, -554.4061005831769, -64.8200201476954, -303.53308495013727, -701.9068764913594, -147.0245106567464, -0.5078714503885491, -742.5617030446894, -832.7360395249489, -211.7959530172263, -375.53648517346517, -84.29568211305349, -155.97213236751185, -423.1494937955739, -90.43070860449798, -981.3733740673886, -965.1505737464595, -385.07837336966674, -637.2675912495238, -137.0615661371579, -164.06138514551867, -1155.5821223280368, -455.8130303166841, -1147.8065563614039, -94.26072222251703, -565.6597281064625, -449.6011027204079, -539.2578597258206, -1133.7685989014929, -202.18710714007995, -36.32631876024082, -693.2665997519132, -51.914763808085866, -203.32661785384582, -926.2367438836468, -47.528565539304445, -282.392961406326, -406.3269361688959, -399.57073543760936, -135.13770267047786, -1118.2464994262054, -95.68097442301695, -238.9257249234389, -556.1819029908193, -1028.6993386755655, -857.242707719165, -715.06008053451, -1022.867029535141, -1012.2755986573935, -976.6787805719551, -251.11100620182728, -482.6065876575841, -101.03148380218376, -62.47885092138399, -90.89278442390547, -862.6216086229147, -600.8254580956843, -236.9833480737327, -14.88866038111374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564565834943755, "mean_inference_ms": 1.6742437964743915, "mean_action_processing_ms": 0.2756761921403009, "mean_env_wait_ms": 3.4328407120485243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01241445541381836, "StateBufferConnector_ms": 0.007972002029418945, "ViewRequirementAgentConnector_ms": 0.19272899627685547}, "num_episodes": 36, "episode_return_max": -0.5078714503885491, "episode_return_min": -1223.8491546115574, "episode_return_mean": -467.13367163996315, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.46754901662115, "num_env_steps_trained_throughput_per_sec": 296.46754901662115, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12835.284, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12835.216, "sample_time_ms": 1159.938, "learn_time_ms": 11607.437, "learn_throughput": 344.607, "synch_weights_time_ms": 67.031}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "1e132_00002", "date": "2024-08-04_07-49-36", "timestamp": 1722737976, "time_this_iter_s": 13.50450325012207, "time_total_s": 358.87324619293213, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 358.87324619293213, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 16.92105263157895, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.3446468234062, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.417970586195588, "policy_loss": -0.010345095729765793, "vf_loss": 3.420659162849188, "vf_explained_var": 0.9879272152359287, "kl": 0.017236769046030533, "entropy": 1.0003346224625906, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -0.5078714503885491, "episode_reward_min": -1289.6299379001828, "episode_reward_mean": -483.61875210339406, "episode_len_mean": 115.18, "episode_media": {}, "episodes_timesteps_total": 11518, "policy_reward_min": {"policy_0": -1289.6299379001828}, "policy_reward_max": {"policy_0": -0.5078714503885491}, "policy_reward_mean": {"policy_0": -483.61875210339406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-573.0333041308934, -121.6406632791331, -127.98439258441103, -869.7660845171621, -193.51670042843142, -112.90235911720495, -1124.531459378536, -596.1679344744903, -554.4061005831769, -64.8200201476954, -303.53308495013727, -701.9068764913594, -147.0245106567464, -0.5078714503885491, -742.5617030446894, -832.7360395249489, -211.7959530172263, -375.53648517346517, -84.29568211305349, -155.97213236751185, -423.1494937955739, -90.43070860449798, -981.3733740673886, -965.1505737464595, -385.07837336966674, -637.2675912495238, -137.0615661371579, -164.06138514551867, -1155.5821223280368, -455.8130303166841, -1147.8065563614039, -94.26072222251703, -565.6597281064625, -449.6011027204079, -539.2578597258206, -1133.7685989014929, -202.18710714007995, -36.32631876024082, -693.2665997519132, -51.914763808085866, -203.32661785384582, -926.2367438836468, -47.528565539304445, -282.392961406326, -406.3269361688959, -399.57073543760936, -135.13770267047786, -1118.2464994262054, -95.68097442301695, -238.9257249234389, -556.1819029908193, -1028.6993386755655, -857.242707719165, -715.06008053451, -1022.867029535141, -1012.2755986573935, -976.6787805719551, -251.11100620182728, -482.6065876575841, -101.03148380218376, -62.47885092138399, -90.89278442390547, -862.6216086229147, -600.8254580956843, -236.9833480737327, -14.88866038111374, -301.92870285780555, -1256.8543384729983, -838.6047042477409, -46.43875180770869, -450.561554323059, -1289.6299379001828, -231.13178313642584, -322.79477596562543, -87.52620463232381, -221.45611441590756, -344.6303820404893, -74.35033839537581, -948.713707871209, -1278.5241239285244, -379.7234768553661, -526.7702296873745, -684.8870540656238, -474.0389375877272, -68.16339438710862, -757.3682770199154, -1059.7949313827287, -634.1864110025605, -463.6734020646689, -126.44775960172528, -133.96251410646985, -198.15069284804986, -965.636257617437, -1125.1058544003113, -325.5665653923533, -177.11251479483929, -240.27757650252585, -25.051987515646346, -985.9369193293871, -387.39941189496864], "episode_lengths": [150, 83, 85, 150, 97, 78, 150, 150, 150, 57, 101, 150, 83, 34, 150, 150, 69, 122, 74, 97, 104, 70, 150, 150, 150, 146, 78, 76, 150, 150, 150, 65, 150, 150, 132, 150, 106, 52, 150, 51, 79, 150, 44, 150, 150, 150, 91, 150, 77, 102, 150, 150, 150, 150, 150, 150, 150, 86, 150, 50, 68, 60, 150, 127, 129, 45, 83, 150, 150, 49, 101, 150, 73, 106, 59, 86, 92, 50, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 89, 105, 93, 150, 150, 104, 97, 83, 40, 150, 133], "policy_policy_0_reward": [-573.0333041308934, -121.6406632791331, -127.98439258441103, -869.7660845171621, -193.51670042843142, -112.90235911720495, -1124.531459378536, -596.1679344744903, -554.4061005831769, -64.8200201476954, -303.53308495013727, -701.9068764913594, -147.0245106567464, -0.5078714503885491, -742.5617030446894, -832.7360395249489, -211.7959530172263, -375.53648517346517, -84.29568211305349, -155.97213236751185, -423.1494937955739, -90.43070860449798, -981.3733740673886, -965.1505737464595, -385.07837336966674, -637.2675912495238, -137.0615661371579, -164.06138514551867, -1155.5821223280368, -455.8130303166841, -1147.8065563614039, -94.26072222251703, -565.6597281064625, -449.6011027204079, -539.2578597258206, -1133.7685989014929, -202.18710714007995, -36.32631876024082, -693.2665997519132, -51.914763808085866, -203.32661785384582, -926.2367438836468, -47.528565539304445, -282.392961406326, -406.3269361688959, -399.57073543760936, -135.13770267047786, -1118.2464994262054, -95.68097442301695, -238.9257249234389, -556.1819029908193, -1028.6993386755655, -857.242707719165, -715.06008053451, -1022.867029535141, -1012.2755986573935, -976.6787805719551, -251.11100620182728, -482.6065876575841, -101.03148380218376, -62.47885092138399, -90.89278442390547, -862.6216086229147, -600.8254580956843, -236.9833480737327, -14.88866038111374, -301.92870285780555, -1256.8543384729983, -838.6047042477409, -46.43875180770869, -450.561554323059, -1289.6299379001828, -231.13178313642584, -322.79477596562543, -87.52620463232381, -221.45611441590756, -344.6303820404893, -74.35033839537581, -948.713707871209, -1278.5241239285244, -379.7234768553661, -526.7702296873745, -684.8870540656238, -474.0389375877272, -68.16339438710862, -757.3682770199154, -1059.7949313827287, -634.1864110025605, -463.6734020646689, -126.44775960172528, -133.96251410646985, -198.15069284804986, -965.636257617437, -1125.1058544003113, -325.5665653923533, -177.11251479483929, -240.27757650252585, -25.051987515646346, -985.9369193293871, -387.39941189496864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556363552779576, "mean_inference_ms": 1.6733496637077292, "mean_action_processing_ms": 0.27554070134983977, "mean_env_wait_ms": 3.429004436997999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01237344741821289, "StateBufferConnector_ms": 0.007990837097167969, "ViewRequirementAgentConnector_ms": 0.1936168670654297}, "num_episodes": 34, "episode_return_max": -0.5078714503885491, "episode_return_min": -1289.6299379001828, "episode_return_mean": -483.61875210339406, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.44404868867986, "num_env_steps_trained_throughput_per_sec": 300.44404868867986, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12894.406, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12894.338, "sample_time_ms": 1167.767, "learn_time_ms": 11656.119, "learn_throughput": 343.167, "synch_weights_time_ms": 69.642}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "1e132_00002", "date": "2024-08-04_07-49-49", "timestamp": 1722737989, "time_this_iter_s": 13.325797080993652, "time_total_s": 372.1990432739258, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d996512170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.1990432739258, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.452631578947365, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.6370541214943, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.109525623420874, "policy_loss": -0.007397052223677747, "vf_loss": 3.1105099388708672, "vf_explained_var": 0.988508815690875, "kl": 0.014511104512106044, "entropy": 1.1725992561007539, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -14.88866038111374, "episode_reward_min": -1488.9881280956452, "episode_reward_mean": -484.3990428415889, "episode_len_mean": 116.44, "episode_media": {}, "episodes_timesteps_total": 11644, "policy_reward_min": {"policy_0": -1488.9881280956452}, "policy_reward_max": {"policy_0": -14.88866038111374}, "policy_reward_mean": {"policy_0": -484.3990428415889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.26072222251703, -565.6597281064625, -449.6011027204079, -539.2578597258206, -1133.7685989014929, -202.18710714007995, -36.32631876024082, -693.2665997519132, -51.914763808085866, -203.32661785384582, -926.2367438836468, -47.528565539304445, -282.392961406326, -406.3269361688959, -399.57073543760936, -135.13770267047786, -1118.2464994262054, -95.68097442301695, -238.9257249234389, -556.1819029908193, -1028.6993386755655, -857.242707719165, -715.06008053451, -1022.867029535141, -1012.2755986573935, -976.6787805719551, -251.11100620182728, -482.6065876575841, -101.03148380218376, -62.47885092138399, -90.89278442390547, -862.6216086229147, -600.8254580956843, -236.9833480737327, -14.88866038111374, -301.92870285780555, -1256.8543384729983, -838.6047042477409, -46.43875180770869, -450.561554323059, -1289.6299379001828, -231.13178313642584, -322.79477596562543, -87.52620463232381, -221.45611441590756, -344.6303820404893, -74.35033839537581, -948.713707871209, -1278.5241239285244, -379.7234768553661, -526.7702296873745, -684.8870540656238, -474.0389375877272, -68.16339438710862, -757.3682770199154, -1059.7949313827287, -634.1864110025605, -463.6734020646689, -126.44775960172528, -133.96251410646985, -198.15069284804986, -965.636257617437, -1125.1058544003113, -325.5665653923533, -177.11251479483929, -240.27757650252585, -25.051987515646346, -985.9369193293871, -387.39941189496864, -781.2725101162359, -628.7604846683307, -881.8640191625698, -228.90659494678485, -156.4244579818954, -912.4681816097203, -250.7209268324638, -1488.9881280956452, -212.59456488443016, -114.04135882996843, -581.1143824250013, -67.9050979512052, -688.5494822306298, -682.0192178830588, -750.9692086469742, -1316.2829945621297, -322.52512037685057, -84.28414372375498, -562.5389020461337, -426.79807367820564, -255.52741832317614, -125.98079595381371, -66.9055589062394, -866.8899581355728, -215.16340160090357, -267.1596548864426, -725.2875668417611, -35.32546022838806, -91.55442577011866, -135.11158209272668, -591.5095329809259], "episode_lengths": [65, 150, 150, 132, 150, 106, 52, 150, 51, 79, 150, 44, 150, 150, 150, 91, 150, 77, 102, 150, 150, 150, 150, 150, 150, 150, 86, 150, 50, 68, 60, 150, 127, 129, 45, 83, 150, 150, 49, 101, 150, 73, 106, 59, 86, 92, 50, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 89, 105, 93, 150, 150, 104, 97, 83, 40, 150, 133, 150, 150, 150, 130, 87, 150, 88, 150, 100, 72, 150, 67, 147, 150, 150, 150, 150, 69, 149, 150, 127, 88, 60, 150, 97, 93, 150, 48, 70, 88, 150], "policy_policy_0_reward": [-94.26072222251703, -565.6597281064625, -449.6011027204079, -539.2578597258206, -1133.7685989014929, -202.18710714007995, -36.32631876024082, -693.2665997519132, -51.914763808085866, -203.32661785384582, -926.2367438836468, -47.528565539304445, -282.392961406326, -406.3269361688959, -399.57073543760936, -135.13770267047786, -1118.2464994262054, -95.68097442301695, -238.9257249234389, -556.1819029908193, -1028.6993386755655, -857.242707719165, -715.06008053451, -1022.867029535141, -1012.2755986573935, -976.6787805719551, -251.11100620182728, -482.6065876575841, -101.03148380218376, -62.47885092138399, -90.89278442390547, -862.6216086229147, -600.8254580956843, -236.9833480737327, -14.88866038111374, -301.92870285780555, -1256.8543384729983, -838.6047042477409, -46.43875180770869, -450.561554323059, -1289.6299379001828, -231.13178313642584, -322.79477596562543, -87.52620463232381, -221.45611441590756, -344.6303820404893, -74.35033839537581, -948.713707871209, -1278.5241239285244, -379.7234768553661, -526.7702296873745, -684.8870540656238, -474.0389375877272, -68.16339438710862, -757.3682770199154, -1059.7949313827287, -634.1864110025605, -463.6734020646689, -126.44775960172528, -133.96251410646985, -198.15069284804986, -965.636257617437, -1125.1058544003113, -325.5665653923533, -177.11251479483929, -240.27757650252585, -25.051987515646346, -985.9369193293871, -387.39941189496864, -781.2725101162359, -628.7604846683307, -881.8640191625698, -228.90659494678485, -156.4244579818954, -912.4681816097203, -250.7209268324638, -1488.9881280956452, -212.59456488443016, -114.04135882996843, -581.1143824250013, -67.9050979512052, -688.5494822306298, -682.0192178830588, -750.9692086469742, -1316.2829945621297, -322.52512037685057, -84.28414372375498, -562.5389020461337, -426.79807367820564, -255.52741832317614, -125.98079595381371, -66.9055589062394, -866.8899581355728, -215.16340160090357, -267.1596548864426, -725.2875668417611, -35.32546022838806, -91.55442577011866, -135.11158209272668, -591.5095329809259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562596221320467, "mean_inference_ms": 1.673520317305015, "mean_action_processing_ms": 0.2756711245157649, "mean_env_wait_ms": 3.428693609965818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012484073638916016, "StateBufferConnector_ms": 0.007927417755126953, "ViewRequirementAgentConnector_ms": 0.19382286071777344}, "num_episodes": 31, "episode_return_max": -14.88866038111374, "episode_return_min": -1488.9881280956452, "episode_return_mean": -484.3990428415889, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.20578747712665, "num_env_steps_trained_throughput_per_sec": 316.20578747712665, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12897.78, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12897.712, "sample_time_ms": 1166.464, "learn_time_ms": 11663.186, "learn_throughput": 342.959, "synch_weights_time_ms": 67.258}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "1e132_00002", "date": "2024-08-04_07-50-02", "timestamp": 1722738002, "time_this_iter_s": 12.662976503372192, "time_total_s": 384.862019777298, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 384.862019777298, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.95, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.83624200423557, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.997686181217432, "policy_loss": -0.011890708896680735, "vf_loss": 3.0039643203218778, "vf_explained_var": 0.9856623004501065, "kl": 0.012703344827468755, "entropy": 1.0393251851821939, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -25.051987515646346, "episode_reward_min": -1488.9881280956452, "episode_reward_mean": -482.0752331773302, "episode_len_mean": 117.46, "episode_media": {}, "episodes_timesteps_total": 11746, "policy_reward_min": {"policy_0": -1488.9881280956452}, "policy_reward_max": {"policy_0": -25.051987515646346}, "policy_reward_mean": {"policy_0": -482.0752331773302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.43875180770869, -450.561554323059, -1289.6299379001828, -231.13178313642584, -322.79477596562543, -87.52620463232381, -221.45611441590756, -344.6303820404893, -74.35033839537581, -948.713707871209, -1278.5241239285244, -379.7234768553661, -526.7702296873745, -684.8870540656238, -474.0389375877272, -68.16339438710862, -757.3682770199154, -1059.7949313827287, -634.1864110025605, -463.6734020646689, -126.44775960172528, -133.96251410646985, -198.15069284804986, -965.636257617437, -1125.1058544003113, -325.5665653923533, -177.11251479483929, -240.27757650252585, -25.051987515646346, -985.9369193293871, -387.39941189496864, -781.2725101162359, -628.7604846683307, -881.8640191625698, -228.90659494678485, -156.4244579818954, -912.4681816097203, -250.7209268324638, -1488.9881280956452, -212.59456488443016, -114.04135882996843, -581.1143824250013, -67.9050979512052, -688.5494822306298, -682.0192178830588, -750.9692086469742, -1316.2829945621297, -322.52512037685057, -84.28414372375498, -562.5389020461337, -426.79807367820564, -255.52741832317614, -125.98079595381371, -66.9055589062394, -866.8899581355728, -215.16340160090357, -267.1596548864426, -725.2875668417611, -35.32546022838806, -91.55442577011866, -135.11158209272668, -591.5095329809259, -333.21902647137205, -246.6118320850313, -419.264541713105, -1020.6424404793682, -434.4692021441889, -353.80883906053293, -278.98049644646005, -205.20320756904425, -502.48972774642846, -43.49367961797197, -146.48776495921442, -1180.5833377971428, -77.13716162159963, -252.13198180747756, -590.3794734743417, -25.56974481689058, -155.0351197325329, -33.123482418994655, -162.9379268312378, -797.0858626206187, -550.2218005708194, -305.29771590050814, -827.0494243844898, -1270.0784543593693, -1093.3855503967707, -343.55230231043276, -93.55886742031122, -44.001187611442944, -1258.3841718187928, -828.0850324171238, -525.2723472481651, -1145.5714556269945, -972.9591667976816, -586.0187378253036, -119.76322004399421, -631.3064207110625, -130.87042032201617, -673.0371437085071], "episode_lengths": [49, 101, 150, 73, 106, 59, 86, 92, 50, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 89, 105, 93, 150, 150, 104, 97, 83, 40, 150, 133, 150, 150, 150, 130, 87, 150, 88, 150, 100, 72, 150, 67, 147, 150, 150, 150, 150, 69, 149, 150, 127, 88, 60, 150, 97, 93, 150, 48, 70, 88, 150, 144, 150, 150, 150, 150, 132, 108, 108, 150, 42, 79, 150, 66, 90, 150, 38, 76, 52, 85, 138, 150, 117, 150, 150, 150, 150, 64, 59, 150, 150, 150, 150, 150, 150, 68, 150, 83, 150], "policy_policy_0_reward": [-46.43875180770869, -450.561554323059, -1289.6299379001828, -231.13178313642584, -322.79477596562543, -87.52620463232381, -221.45611441590756, -344.6303820404893, -74.35033839537581, -948.713707871209, -1278.5241239285244, -379.7234768553661, -526.7702296873745, -684.8870540656238, -474.0389375877272, -68.16339438710862, -757.3682770199154, -1059.7949313827287, -634.1864110025605, -463.6734020646689, -126.44775960172528, -133.96251410646985, -198.15069284804986, -965.636257617437, -1125.1058544003113, -325.5665653923533, -177.11251479483929, -240.27757650252585, -25.051987515646346, -985.9369193293871, -387.39941189496864, -781.2725101162359, -628.7604846683307, -881.8640191625698, -228.90659494678485, -156.4244579818954, -912.4681816097203, -250.7209268324638, -1488.9881280956452, -212.59456488443016, -114.04135882996843, -581.1143824250013, -67.9050979512052, -688.5494822306298, -682.0192178830588, -750.9692086469742, -1316.2829945621297, -322.52512037685057, -84.28414372375498, -562.5389020461337, -426.79807367820564, -255.52741832317614, -125.98079595381371, -66.9055589062394, -866.8899581355728, -215.16340160090357, -267.1596548864426, -725.2875668417611, -35.32546022838806, -91.55442577011866, -135.11158209272668, -591.5095329809259, -333.21902647137205, -246.6118320850313, -419.264541713105, -1020.6424404793682, -434.4692021441889, -353.80883906053293, -278.98049644646005, -205.20320756904425, -502.48972774642846, -43.49367961797197, -146.48776495921442, -1180.5833377971428, -77.13716162159963, -252.13198180747756, -590.3794734743417, -25.56974481689058, -155.0351197325329, -33.123482418994655, -162.9379268312378, -797.0858626206187, -550.2218005708194, -305.29771590050814, -827.0494243844898, -1270.0784543593693, -1093.3855503967707, -343.55230231043276, -93.55886742031122, -44.001187611442944, -1258.3841718187928, -828.0850324171238, -525.2723472481651, -1145.5714556269945, -972.9591667976816, -586.0187378253036, -119.76322004399421, -631.3064207110625, -130.87042032201617, -673.0371437085071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558648719885373, "mean_inference_ms": 1.699868452952398, "mean_action_processing_ms": 0.27554984576309527, "mean_env_wait_ms": 3.4241998030868914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012342453002929688, "StateBufferConnector_ms": 0.00806879997253418, "ViewRequirementAgentConnector_ms": 0.20097708702087402}, "num_episodes": 38, "episode_return_max": -25.051987515646346, "episode_return_min": -1488.9881280956452, "episode_return_mean": -482.0752331773302, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.2663518281719, "num_env_steps_trained_throughput_per_sec": 307.2663518281719, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12903.829, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12903.757, "sample_time_ms": 1206.217, "learn_time_ms": 11628.462, "learn_throughput": 343.984, "synch_weights_time_ms": 68.268}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "1e132_00002", "date": "2024-08-04_07-50-15", "timestamp": 1722738015, "time_this_iter_s": 13.0310959815979, "time_total_s": 397.8931157588959, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1364d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 397.8931157588959, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 21.127777777777776, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.57988738020262, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.891564993125697, "policy_loss": -0.01388161830836907, "vf_loss": 2.897907409071922, "vf_explained_var": 0.9917308753356338, "kl": 0.017012681130715197, "entropy": 1.165064096947511, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -1.5197576081772666, "episode_reward_min": -1488.9881280956452, "episode_reward_mean": -496.10143384314057, "episode_len_mean": 121.52, "episode_media": {}, "episodes_timesteps_total": 12152, "policy_reward_min": {"policy_0": -1488.9881280956452}, "policy_reward_max": {"policy_0": -1.5197576081772666}, "policy_reward_mean": {"policy_0": -496.10143384314057}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-387.39941189496864, -781.2725101162359, -628.7604846683307, -881.8640191625698, -228.90659494678485, -156.4244579818954, -912.4681816097203, -250.7209268324638, -1488.9881280956452, -212.59456488443016, -114.04135882996843, -581.1143824250013, -67.9050979512052, -688.5494822306298, -682.0192178830588, -750.9692086469742, -1316.2829945621297, -322.52512037685057, -84.28414372375498, -562.5389020461337, -426.79807367820564, -255.52741832317614, -125.98079595381371, -66.9055589062394, -866.8899581355728, -215.16340160090357, -267.1596548864426, -725.2875668417611, -35.32546022838806, -91.55442577011866, -135.11158209272668, -591.5095329809259, -333.21902647137205, -246.6118320850313, -419.264541713105, -1020.6424404793682, -434.4692021441889, -353.80883906053293, -278.98049644646005, -205.20320756904425, -502.48972774642846, -43.49367961797197, -146.48776495921442, -1180.5833377971428, -77.13716162159963, -252.13198180747756, -590.3794734743417, -25.56974481689058, -155.0351197325329, -33.123482418994655, -162.9379268312378, -797.0858626206187, -550.2218005708194, -305.29771590050814, -827.0494243844898, -1270.0784543593693, -1093.3855503967707, -343.55230231043276, -93.55886742031122, -44.001187611442944, -1258.3841718187928, -828.0850324171238, -525.2723472481651, -1145.5714556269945, -972.9591667976816, -586.0187378253036, -119.76322004399421, -631.3064207110625, -130.87042032201617, -673.0371437085071, -651.5302063429785, -546.9529583593331, -634.4586808563921, -207.9186230775332, -668.9645352645199, -1118.4353088790317, -645.7856937839771, -324.4370016434966, -324.5023987731996, -259.2870987945667, -156.1055221097372, -903.5860030756166, -156.09332868835526, -68.14103748623764, -1105.7497551115696, -1304.7526244550825, -406.6072063702931, -470.0634319863659, -1053.6366861025474, -437.6350011369813, -712.049663783583, -549.1204432205145, -546.5307919973029, -217.79454970984438, -95.76092865483156, -213.34576997227924, -535.9991135865023, -1.5197576081772666, -883.5742296487773, -849.8941466800554], "episode_lengths": [133, 150, 150, 150, 130, 87, 150, 88, 150, 100, 72, 150, 67, 147, 150, 150, 150, 150, 69, 149, 150, 127, 88, 60, 150, 97, 93, 150, 48, 70, 88, 150, 144, 150, 150, 150, 150, 132, 108, 108, 150, 42, 79, 150, 66, 90, 150, 38, 76, 52, 85, 138, 150, 117, 150, 150, 150, 150, 64, 59, 150, 150, 150, 150, 150, 150, 68, 150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 132, 91, 121, 87, 150, 91, 79, 150, 150, 150, 135, 150, 150, 150, 150, 150, 105, 53, 91, 150, 33, 150, 150], "policy_policy_0_reward": [-387.39941189496864, -781.2725101162359, -628.7604846683307, -881.8640191625698, -228.90659494678485, -156.4244579818954, -912.4681816097203, -250.7209268324638, -1488.9881280956452, -212.59456488443016, -114.04135882996843, -581.1143824250013, -67.9050979512052, -688.5494822306298, -682.0192178830588, -750.9692086469742, -1316.2829945621297, -322.52512037685057, -84.28414372375498, -562.5389020461337, -426.79807367820564, -255.52741832317614, -125.98079595381371, -66.9055589062394, -866.8899581355728, -215.16340160090357, -267.1596548864426, -725.2875668417611, -35.32546022838806, -91.55442577011866, -135.11158209272668, -591.5095329809259, -333.21902647137205, -246.6118320850313, -419.264541713105, -1020.6424404793682, -434.4692021441889, -353.80883906053293, -278.98049644646005, -205.20320756904425, -502.48972774642846, -43.49367961797197, -146.48776495921442, -1180.5833377971428, -77.13716162159963, -252.13198180747756, -590.3794734743417, -25.56974481689058, -155.0351197325329, -33.123482418994655, -162.9379268312378, -797.0858626206187, -550.2218005708194, -305.29771590050814, -827.0494243844898, -1270.0784543593693, -1093.3855503967707, -343.55230231043276, -93.55886742031122, -44.001187611442944, -1258.3841718187928, -828.0850324171238, -525.2723472481651, -1145.5714556269945, -972.9591667976816, -586.0187378253036, -119.76322004399421, -631.3064207110625, -130.87042032201617, -673.0371437085071, -651.5302063429785, -546.9529583593331, -634.4586808563921, -207.9186230775332, -668.9645352645199, -1118.4353088790317, -645.7856937839771, -324.4370016434966, -324.5023987731996, -259.2870987945667, -156.1055221097372, -903.5860030756166, -156.09332868835526, -68.14103748623764, -1105.7497551115696, -1304.7526244550825, -406.6072063702931, -470.0634319863659, -1053.6366861025474, -437.6350011369813, -712.049663783583, -549.1204432205145, -546.5307919973029, -217.79454970984438, -95.76092865483156, -213.34576997227924, -535.9991135865023, -1.5197576081772666, -883.5742296487773, -849.8941466800554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558901905162135, "mean_inference_ms": 1.720619411613511, "mean_action_processing_ms": 0.2756267859476986, "mean_env_wait_ms": 3.4249826179899543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012061595916748047, "StateBufferConnector_ms": 0.00804758071899414, "ViewRequirementAgentConnector_ms": 0.20060181617736816}, "num_episodes": 30, "episode_return_max": -1.5197576081772666, "episode_return_min": -1488.9881280956452, "episode_return_mean": -496.10143384314057, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8411958002783, "num_env_steps_trained_throughput_per_sec": 302.8411958002783, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12922.094, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12922.025, "sample_time_ms": 1205.995, "learn_time_ms": 11647.661, "learn_throughput": 343.417, "synch_weights_time_ms": 67.56}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "1e132_00002", "date": "2024-08-04_07-50-28", "timestamp": 1722738028, "time_this_iter_s": 13.220905065536499, "time_total_s": 411.1140208244324, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac122440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 411.1140208244324, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.521052631578947, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.1443398475647, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.848461289082964, "policy_loss": -0.009363895479570299, "vf_loss": 2.850812016800046, "vf_explained_var": 0.984367763561507, "kl": 0.01580081494948903, "entropy": 0.9720360640436411, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -1.5197576081772666, "episode_reward_min": -1304.7526244550825, "episode_reward_mean": -477.6674771053364, "episode_len_mean": 118.87, "episode_media": {}, "episodes_timesteps_total": 11887, "policy_reward_min": {"policy_0": -1304.7526244550825}, "policy_reward_max": {"policy_0": -1.5197576081772666}, "policy_reward_mean": {"policy_0": -477.6674771053364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1020.6424404793682, -434.4692021441889, -353.80883906053293, -278.98049644646005, -205.20320756904425, -502.48972774642846, -43.49367961797197, -146.48776495921442, -1180.5833377971428, -77.13716162159963, -252.13198180747756, -590.3794734743417, -25.56974481689058, -155.0351197325329, -33.123482418994655, -162.9379268312378, -797.0858626206187, -550.2218005708194, -305.29771590050814, -827.0494243844898, -1270.0784543593693, -1093.3855503967707, -343.55230231043276, -93.55886742031122, -44.001187611442944, -1258.3841718187928, -828.0850324171238, -525.2723472481651, -1145.5714556269945, -972.9591667976816, -586.0187378253036, -119.76322004399421, -631.3064207110625, -130.87042032201617, -673.0371437085071, -651.5302063429785, -546.9529583593331, -634.4586808563921, -207.9186230775332, -668.9645352645199, -1118.4353088790317, -645.7856937839771, -324.4370016434966, -324.5023987731996, -259.2870987945667, -156.1055221097372, -903.5860030756166, -156.09332868835526, -68.14103748623764, -1105.7497551115696, -1304.7526244550825, -406.6072063702931, -470.0634319863659, -1053.6366861025474, -437.6350011369813, -712.049663783583, -549.1204432205145, -546.5307919973029, -217.79454970984438, -95.76092865483156, -213.34576997227924, -535.9991135865023, -1.5197576081772666, -883.5742296487773, -849.8941466800554, -271.69066814510705, -163.39906477300724, -272.01461223344273, -124.85519709068244, -131.53977373797142, -52.07014321676281, -834.6922844399796, -172.31141548054075, -442.9204344451318, -562.6021353615151, -105.72470217863966, -69.47592268675308, -1075.3348482290216, -447.3028909826981, -914.1596206640583, -981.6640753108816, -102.78156515080526, -380.3616509899875, -1262.344435541207, -211.37418336985982, -913.6006726553088, -359.8225412486946, -477.2507057010501, -656.464074834914, -111.18757888758503, -172.13643177610018, -108.01149535802827, -532.9843678775636, -89.08359653917523, -261.6411391050121, -433.9849236908467, -444.42070007421813, -104.228662278847, -681.0903123335312, -134.01551836719614], "episode_lengths": [150, 150, 132, 108, 108, 150, 42, 79, 150, 66, 90, 150, 38, 76, 52, 85, 138, 150, 117, 150, 150, 150, 150, 64, 59, 150, 150, 150, 150, 150, 150, 68, 150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 132, 91, 121, 87, 150, 91, 79, 150, 150, 150, 135, 150, 150, 150, 150, 150, 105, 53, 91, 150, 33, 150, 150, 117, 93, 98, 77, 83, 56, 150, 94, 150, 150, 70, 60, 150, 150, 150, 150, 78, 138, 150, 93, 150, 150, 150, 150, 79, 90, 69, 142, 62, 106, 149, 132, 78, 150, 78], "policy_policy_0_reward": [-1020.6424404793682, -434.4692021441889, -353.80883906053293, -278.98049644646005, -205.20320756904425, -502.48972774642846, -43.49367961797197, -146.48776495921442, -1180.5833377971428, -77.13716162159963, -252.13198180747756, -590.3794734743417, -25.56974481689058, -155.0351197325329, -33.123482418994655, -162.9379268312378, -797.0858626206187, -550.2218005708194, -305.29771590050814, -827.0494243844898, -1270.0784543593693, -1093.3855503967707, -343.55230231043276, -93.55886742031122, -44.001187611442944, -1258.3841718187928, -828.0850324171238, -525.2723472481651, -1145.5714556269945, -972.9591667976816, -586.0187378253036, -119.76322004399421, -631.3064207110625, -130.87042032201617, -673.0371437085071, -651.5302063429785, -546.9529583593331, -634.4586808563921, -207.9186230775332, -668.9645352645199, -1118.4353088790317, -645.7856937839771, -324.4370016434966, -324.5023987731996, -259.2870987945667, -156.1055221097372, -903.5860030756166, -156.09332868835526, -68.14103748623764, -1105.7497551115696, -1304.7526244550825, -406.6072063702931, -470.0634319863659, -1053.6366861025474, -437.6350011369813, -712.049663783583, -549.1204432205145, -546.5307919973029, -217.79454970984438, -95.76092865483156, -213.34576997227924, -535.9991135865023, -1.5197576081772666, -883.5742296487773, -849.8941466800554, -271.69066814510705, -163.39906477300724, -272.01461223344273, -124.85519709068244, -131.53977373797142, -52.07014321676281, -834.6922844399796, -172.31141548054075, -442.9204344451318, -562.6021353615151, -105.72470217863966, -69.47592268675308, -1075.3348482290216, -447.3028909826981, -914.1596206640583, -981.6640753108816, -102.78156515080526, -380.3616509899875, -1262.344435541207, -211.37418336985982, -913.6006726553088, -359.8225412486946, -477.2507057010501, -656.464074834914, -111.18757888758503, -172.13643177610018, -108.01149535802827, -532.9843678775636, -89.08359653917523, -261.6411391050121, -433.9849236908467, -444.42070007421813, -104.228662278847, -681.0903123335312, -134.01551836719614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556984380251759, "mean_inference_ms": 1.7423146631838395, "mean_action_processing_ms": 0.2754267451804988, "mean_env_wait_ms": 3.4220575643230706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011711597442626953, "StateBufferConnector_ms": 0.008051156997680664, "ViewRequirementAgentConnector_ms": 0.20831942558288574}, "num_episodes": 35, "episode_return_max": -1.5197576081772666, "episode_return_min": -1304.7526244550825, "episode_return_mean": -477.6674771053364, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.9233727936583, "num_env_steps_trained_throughput_per_sec": 297.9233727936583, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12955.68, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12955.61, "sample_time_ms": 1210.596, "learn_time_ms": 11675.222, "learn_throughput": 342.606, "synch_weights_time_ms": 68.971}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "1e132_00002", "date": "2024-08-04_07-50-42", "timestamp": 1722738042, "time_this_iter_s": 13.438766479492188, "time_total_s": 424.55278730392456, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 424.55278730392456, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.794736842105266, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.4687723815441, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.7050946560998756, "policy_loss": -0.015841275808634238, "vf_loss": 2.7127233705172937, "vf_explained_var": 0.9920909005527695, "kl": 0.018509363416736355, "entropy": 1.1664718775078655, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -1.5197576081772666, "episode_reward_min": -1461.102195647824, "episode_reward_mean": -491.28131658410297, "episode_len_mean": 122.32, "episode_media": {}, "episodes_timesteps_total": 12232, "policy_reward_min": {"policy_0": -1461.102195647824}, "policy_reward_max": {"policy_0": -1.5197576081772666}, "policy_reward_mean": {"policy_0": -491.28131658410297}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-631.3064207110625, -130.87042032201617, -673.0371437085071, -651.5302063429785, -546.9529583593331, -634.4586808563921, -207.9186230775332, -668.9645352645199, -1118.4353088790317, -645.7856937839771, -324.4370016434966, -324.5023987731996, -259.2870987945667, -156.1055221097372, -903.5860030756166, -156.09332868835526, -68.14103748623764, -1105.7497551115696, -1304.7526244550825, -406.6072063702931, -470.0634319863659, -1053.6366861025474, -437.6350011369813, -712.049663783583, -549.1204432205145, -546.5307919973029, -217.79454970984438, -95.76092865483156, -213.34576997227924, -535.9991135865023, -1.5197576081772666, -883.5742296487773, -849.8941466800554, -271.69066814510705, -163.39906477300724, -272.01461223344273, -124.85519709068244, -131.53977373797142, -52.07014321676281, -834.6922844399796, -172.31141548054075, -442.9204344451318, -562.6021353615151, -105.72470217863966, -69.47592268675308, -1075.3348482290216, -447.3028909826981, -914.1596206640583, -981.6640753108816, -102.78156515080526, -380.3616509899875, -1262.344435541207, -211.37418336985982, -913.6006726553088, -359.8225412486946, -477.2507057010501, -656.464074834914, -111.18757888758503, -172.13643177610018, -108.01149535802827, -532.9843678775636, -89.08359653917523, -261.6411391050121, -433.9849236908467, -444.42070007421813, -104.228662278847, -681.0903123335312, -134.01551836719614, -11.404420327033161, -383.3884330793723, -216.78379637366905, -518.7195732877738, -1009.2435176448364, -1042.1216778920416, -334.9265945169671, -299.54573109473955, -361.08268988955655, -1064.0046500782205, -447.3838231672597, -275.5702301067739, -283.9616872822457, -602.0641945233168, -29.77369266770262, -214.50730329429783, -407.0319554398371, -227.37777016633473, -407.61340387443374, -665.8446062148448, -853.9887816102807, -753.0728816843938, -1461.102195647824, -208.05091747442344, -605.713479684083, -244.34053440916608, -1009.432774529259, -83.30881259314803, -420.01414828133466, -815.6490919228921, -1128.803307899719, -1198.3161550951263], "episode_lengths": [150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 132, 91, 121, 87, 150, 91, 79, 150, 150, 150, 135, 150, 150, 150, 150, 150, 105, 53, 91, 150, 33, 150, 150, 117, 93, 98, 77, 83, 56, 150, 94, 150, 150, 70, 60, 150, 150, 150, 150, 78, 138, 150, 93, 150, 150, 150, 150, 79, 90, 69, 142, 62, 106, 149, 132, 78, 150, 78, 32, 144, 81, 150, 150, 150, 130, 99, 150, 150, 150, 101, 150, 148, 44, 104, 101, 112, 150, 150, 150, 150, 150, 93, 150, 118, 150, 65, 145, 150, 150, 150], "policy_policy_0_reward": [-631.3064207110625, -130.87042032201617, -673.0371437085071, -651.5302063429785, -546.9529583593331, -634.4586808563921, -207.9186230775332, -668.9645352645199, -1118.4353088790317, -645.7856937839771, -324.4370016434966, -324.5023987731996, -259.2870987945667, -156.1055221097372, -903.5860030756166, -156.09332868835526, -68.14103748623764, -1105.7497551115696, -1304.7526244550825, -406.6072063702931, -470.0634319863659, -1053.6366861025474, -437.6350011369813, -712.049663783583, -549.1204432205145, -546.5307919973029, -217.79454970984438, -95.76092865483156, -213.34576997227924, -535.9991135865023, -1.5197576081772666, -883.5742296487773, -849.8941466800554, -271.69066814510705, -163.39906477300724, -272.01461223344273, -124.85519709068244, -131.53977373797142, -52.07014321676281, -834.6922844399796, -172.31141548054075, -442.9204344451318, -562.6021353615151, -105.72470217863966, -69.47592268675308, -1075.3348482290216, -447.3028909826981, -914.1596206640583, -981.6640753108816, -102.78156515080526, -380.3616509899875, -1262.344435541207, -211.37418336985982, -913.6006726553088, -359.8225412486946, -477.2507057010501, -656.464074834914, -111.18757888758503, -172.13643177610018, -108.01149535802827, -532.9843678775636, -89.08359653917523, -261.6411391050121, -433.9849236908467, -444.42070007421813, -104.228662278847, -681.0903123335312, -134.01551836719614, -11.404420327033161, -383.3884330793723, -216.78379637366905, -518.7195732877738, -1009.2435176448364, -1042.1216778920416, -334.9265945169671, -299.54573109473955, -361.08268988955655, -1064.0046500782205, -447.3838231672597, -275.5702301067739, -283.9616872822457, -602.0641945233168, -29.77369266770262, -214.50730329429783, -407.0319554398371, -227.37777016633473, -407.61340387443374, -665.8446062148448, -853.9887816102807, -753.0728816843938, -1461.102195647824, -208.05091747442344, -605.713479684083, -244.34053440916608, -1009.432774529259, -83.30881259314803, -420.01414828133466, -815.6490919228921, -1128.803307899719, -1198.3161550951263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561656896283191, "mean_inference_ms": 1.740125762928695, "mean_action_processing_ms": 0.2754406619939679, "mean_env_wait_ms": 3.4230953768094468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011959552764892578, "StateBufferConnector_ms": 0.00787353515625, "ViewRequirementAgentConnector_ms": 0.19949769973754883}, "num_episodes": 32, "episode_return_max": -1.5197576081772666, "episode_return_min": -1461.102195647824, "episode_return_mean": -491.28131658410297, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.99128753692617, "num_env_steps_trained_throughput_per_sec": 302.99128753692617, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12968.201, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12968.133, "sample_time_ms": 1204.271, "learn_time_ms": 11693.708, "learn_throughput": 342.064, "synch_weights_time_ms": 69.322}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "1e132_00002", "date": "2024-08-04_07-50-55", "timestamp": 1722738055, "time_this_iter_s": 13.214818716049194, "time_total_s": 437.76760601997375, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac136290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 437.76760601997375, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.621052631578948, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.97367651462554, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.3360642578452824, "policy_loss": -0.014009778044419363, "vf_loss": 3.342758447180192, "vf_explained_var": 0.9927994436273972, "kl": 0.016518839586084747, "entropy": 1.1788062679270903, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -7.046598719112028, "episode_reward_min": -1461.102195647824, "episode_reward_mean": -482.5817273782125, "episode_len_mean": 118.76, "episode_media": {}, "episodes_timesteps_total": 11876, "policy_reward_min": {"policy_0": -1461.102195647824}, "policy_reward_max": {"policy_0": -7.046598719112028}, "policy_reward_mean": {"policy_0": -482.5817273782125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-124.85519709068244, -131.53977373797142, -52.07014321676281, -834.6922844399796, -172.31141548054075, -442.9204344451318, -562.6021353615151, -105.72470217863966, -69.47592268675308, -1075.3348482290216, -447.3028909826981, -914.1596206640583, -981.6640753108816, -102.78156515080526, -380.3616509899875, -1262.344435541207, -211.37418336985982, -913.6006726553088, -359.8225412486946, -477.2507057010501, -656.464074834914, -111.18757888758503, -172.13643177610018, -108.01149535802827, -532.9843678775636, -89.08359653917523, -261.6411391050121, -433.9849236908467, -444.42070007421813, -104.228662278847, -681.0903123335312, -134.01551836719614, -11.404420327033161, -383.3884330793723, -216.78379637366905, -518.7195732877738, -1009.2435176448364, -1042.1216778920416, -334.9265945169671, -299.54573109473955, -361.08268988955655, -1064.0046500782205, -447.3838231672597, -275.5702301067739, -283.9616872822457, -602.0641945233168, -29.77369266770262, -214.50730329429783, -407.0319554398371, -227.37777016633473, -407.61340387443374, -665.8446062148448, -853.9887816102807, -753.0728816843938, -1461.102195647824, -208.05091747442344, -605.713479684083, -244.34053440916608, -1009.432774529259, -83.30881259314803, -420.01414828133466, -815.6490919228921, -1128.803307899719, -1198.3161550951263, -499.61086580596015, -39.94379150321812, -1054.366561949204, -28.962087450435753, -405.9287445719719, -1008.6927251707175, -217.57400280060108, -176.35215358791157, -7.046598719112028, -239.3960993530335, -475.8797366746441, -717.6094890421886, -1100.3153723997498, -391.04590545213375, -933.7680797153004, -1213.193172742561, -118.35988600074081, -1074.3480383221633, -585.0409075026157, -1040.4481384998137, -169.1016590118937, -842.0180251386716, -103.08682472690437, -98.68361263675969, -313.40988332918414, -89.79385878087108, -287.63778801006947, -117.42621986775377, -211.51489493343388, -219.36095306119626, -200.8395790736622, -667.9479775922058, -515.7942004818989, -761.8607258947803, -1234.3928243866083, -161.84052227380792], "episode_lengths": [77, 83, 56, 150, 94, 150, 150, 70, 60, 150, 150, 150, 150, 78, 138, 150, 93, 150, 150, 150, 150, 79, 90, 69, 142, 62, 106, 149, 132, 78, 150, 78, 32, 144, 81, 150, 150, 150, 130, 99, 150, 150, 150, 101, 150, 148, 44, 104, 101, 112, 150, 150, 150, 150, 150, 93, 150, 118, 150, 65, 145, 150, 150, 150, 150, 49, 150, 48, 148, 150, 105, 97, 35, 107, 150, 150, 150, 147, 150, 150, 68, 150, 150, 150, 98, 150, 69, 68, 112, 52, 116, 52, 88, 85, 90, 150, 150, 150, 150, 91], "policy_policy_0_reward": [-124.85519709068244, -131.53977373797142, -52.07014321676281, -834.6922844399796, -172.31141548054075, -442.9204344451318, -562.6021353615151, -105.72470217863966, -69.47592268675308, -1075.3348482290216, -447.3028909826981, -914.1596206640583, -981.6640753108816, -102.78156515080526, -380.3616509899875, -1262.344435541207, -211.37418336985982, -913.6006726553088, -359.8225412486946, -477.2507057010501, -656.464074834914, -111.18757888758503, -172.13643177610018, -108.01149535802827, -532.9843678775636, -89.08359653917523, -261.6411391050121, -433.9849236908467, -444.42070007421813, -104.228662278847, -681.0903123335312, -134.01551836719614, -11.404420327033161, -383.3884330793723, -216.78379637366905, -518.7195732877738, -1009.2435176448364, -1042.1216778920416, -334.9265945169671, -299.54573109473955, -361.08268988955655, -1064.0046500782205, -447.3838231672597, -275.5702301067739, -283.9616872822457, -602.0641945233168, -29.77369266770262, -214.50730329429783, -407.0319554398371, -227.37777016633473, -407.61340387443374, -665.8446062148448, -853.9887816102807, -753.0728816843938, -1461.102195647824, -208.05091747442344, -605.713479684083, -244.34053440916608, -1009.432774529259, -83.30881259314803, -420.01414828133466, -815.6490919228921, -1128.803307899719, -1198.3161550951263, -499.61086580596015, -39.94379150321812, -1054.366561949204, -28.962087450435753, -405.9287445719719, -1008.6927251707175, -217.57400280060108, -176.35215358791157, -7.046598719112028, -239.3960993530335, -475.8797366746441, -717.6094890421886, -1100.3153723997498, -391.04590545213375, -933.7680797153004, -1213.193172742561, -118.35988600074081, -1074.3480383221633, -585.0409075026157, -1040.4481384998137, -169.1016590118937, -842.0180251386716, -103.08682472690437, -98.68361263675969, -313.40988332918414, -89.79385878087108, -287.63778801006947, -117.42621986775377, -211.51489493343388, -219.36095306119626, -200.8395790736622, -667.9479775922058, -515.7942004818989, -761.8607258947803, -1234.3928243866083, -161.84052227380792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562360148676883, "mean_inference_ms": 1.739888317177697, "mean_action_processing_ms": 0.275366756000839, "mean_env_wait_ms": 3.4205529760293056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01219630241394043, "StateBufferConnector_ms": 0.007915496826171875, "ViewRequirementAgentConnector_ms": 0.20189476013183594}, "num_episodes": 36, "episode_return_max": -7.046598719112028, "episode_return_min": -1461.102195647824, "episode_return_mean": -482.5817273782125, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.66115395123285, "num_env_steps_trained_throughput_per_sec": 304.66115395123285, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12956.698, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12956.63, "sample_time_ms": 1193.19, "learn_time_ms": 11693.239, "learn_throughput": 342.078, "synch_weights_time_ms": 69.368}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "1e132_00002", "date": "2024-08-04_07-51-08", "timestamp": 1722738068, "time_this_iter_s": 13.142218112945557, "time_total_s": 450.9098241329193, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac120670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 450.9098241329193, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.773684210526316, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.1036857644717, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.2902945497383675, "policy_loss": -0.008159664404229262, "vf_loss": 3.2910838101059197, "vf_explained_var": 0.9826364434013765, "kl": 0.016630573379976983, "entropy": 1.1336169236650069, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -7.046598719112028, "episode_reward_min": -1463.9319230196495, "episode_reward_mean": -497.3504398244438, "episode_len_mean": 118.86, "episode_media": {}, "episodes_timesteps_total": 11886, "policy_reward_min": {"policy_0": -1463.9319230196495}, "policy_reward_max": {"policy_0": -7.046598719112028}, "policy_reward_mean": {"policy_0": -497.3504398244438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-216.78379637366905, -518.7195732877738, -1009.2435176448364, -1042.1216778920416, -334.9265945169671, -299.54573109473955, -361.08268988955655, -1064.0046500782205, -447.3838231672597, -275.5702301067739, -283.9616872822457, -602.0641945233168, -29.77369266770262, -214.50730329429783, -407.0319554398371, -227.37777016633473, -407.61340387443374, -665.8446062148448, -853.9887816102807, -753.0728816843938, -1461.102195647824, -208.05091747442344, -605.713479684083, -244.34053440916608, -1009.432774529259, -83.30881259314803, -420.01414828133466, -815.6490919228921, -1128.803307899719, -1198.3161550951263, -499.61086580596015, -39.94379150321812, -1054.366561949204, -28.962087450435753, -405.9287445719719, -1008.6927251707175, -217.57400280060108, -176.35215358791157, -7.046598719112028, -239.3960993530335, -475.8797366746441, -717.6094890421886, -1100.3153723997498, -391.04590545213375, -933.7680797153004, -1213.193172742561, -118.35988600074081, -1074.3480383221633, -585.0409075026157, -1040.4481384998137, -169.1016590118937, -842.0180251386716, -103.08682472690437, -98.68361263675969, -313.40988332918414, -89.79385878087108, -287.63778801006947, -117.42621986775377, -211.51489493343388, -219.36095306119626, -200.8395790736622, -667.9479775922058, -515.7942004818989, -761.8607258947803, -1234.3928243866083, -161.84052227380792, -498.4816226326742, -354.64243192742896, -212.46074713886563, -774.5301847296549, -1463.9319230196495, -348.9928397467334, -59.26099423948039, -777.7000892421121, -154.9808816939102, -97.03618227929964, -113.74336695179066, -95.10649206945595, -1152.0468018590043, -563.980401531531, -409.5220737374016, -341.36231729749863, -305.65122618475766, -276.2449443437956, -629.1009402640291, -11.828061761660237, -144.81026124234089, -448.9831671543191, -176.9754609490448, -215.35181629040898, -889.2657663004803, -567.1990939372428, -271.2303831806145, -572.0250434228587, -177.609520936438, -135.6558630428715, -631.716936522734, -600.5211923003103, -515.5410855826987, -1235.611984121015], "episode_lengths": [81, 150, 150, 150, 130, 99, 150, 150, 150, 101, 150, 148, 44, 104, 101, 112, 150, 150, 150, 150, 150, 93, 150, 118, 150, 65, 145, 150, 150, 150, 150, 49, 150, 48, 148, 150, 105, 97, 35, 107, 150, 150, 150, 147, 150, 150, 68, 150, 150, 150, 98, 150, 69, 68, 112, 52, 116, 52, 88, 85, 90, 150, 150, 150, 150, 91, 150, 132, 90, 150, 150, 102, 59, 150, 76, 80, 75, 52, 150, 150, 98, 135, 89, 82, 150, 38, 55, 142, 89, 104, 150, 150, 117, 150, 93, 69, 143, 150, 150, 150], "policy_policy_0_reward": [-216.78379637366905, -518.7195732877738, -1009.2435176448364, -1042.1216778920416, -334.9265945169671, -299.54573109473955, -361.08268988955655, -1064.0046500782205, -447.3838231672597, -275.5702301067739, -283.9616872822457, -602.0641945233168, -29.77369266770262, -214.50730329429783, -407.0319554398371, -227.37777016633473, -407.61340387443374, -665.8446062148448, -853.9887816102807, -753.0728816843938, -1461.102195647824, -208.05091747442344, -605.713479684083, -244.34053440916608, -1009.432774529259, -83.30881259314803, -420.01414828133466, -815.6490919228921, -1128.803307899719, -1198.3161550951263, -499.61086580596015, -39.94379150321812, -1054.366561949204, -28.962087450435753, -405.9287445719719, -1008.6927251707175, -217.57400280060108, -176.35215358791157, -7.046598719112028, -239.3960993530335, -475.8797366746441, -717.6094890421886, -1100.3153723997498, -391.04590545213375, -933.7680797153004, -1213.193172742561, -118.35988600074081, -1074.3480383221633, -585.0409075026157, -1040.4481384998137, -169.1016590118937, -842.0180251386716, -103.08682472690437, -98.68361263675969, -313.40988332918414, -89.79385878087108, -287.63778801006947, -117.42621986775377, -211.51489493343388, -219.36095306119626, -200.8395790736622, -667.9479775922058, -515.7942004818989, -761.8607258947803, -1234.3928243866083, -161.84052227380792, -498.4816226326742, -354.64243192742896, -212.46074713886563, -774.5301847296549, -1463.9319230196495, -348.9928397467334, -59.26099423948039, -777.7000892421121, -154.9808816939102, -97.03618227929964, -113.74336695179066, -95.10649206945595, -1152.0468018590043, -563.980401531531, -409.5220737374016, -341.36231729749863, -305.65122618475766, -276.2449443437956, -629.1009402640291, -11.828061761660237, -144.81026124234089, -448.9831671543191, -176.9754609490448, -215.35181629040898, -889.2657663004803, -567.1990939372428, -271.2303831806145, -572.0250434228587, -177.609520936438, -135.6558630428715, -631.716936522734, -600.5211923003103, -515.5410855826987, -1235.611984121015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569859379344354, "mean_inference_ms": 1.7379551247895453, "mean_action_processing_ms": 0.2754663328120949, "mean_env_wait_ms": 3.4196986159237235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012248039245605469, "StateBufferConnector_ms": 0.007964372634887695, "ViewRequirementAgentConnector_ms": 0.19317984580993652}, "num_episodes": 34, "episode_return_max": -7.046598719112028, "episode_return_min": -1463.9319230196495, "episode_return_mean": -497.3504398244438, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.1860977289095, "num_env_steps_trained_throughput_per_sec": 305.1860977289095, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 13167.443, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13167.376, "sample_time_ms": 1189.09, "learn_time_ms": 11908.708, "learn_throughput": 335.889, "synch_weights_time_ms": 68.743}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "1e132_00002", "date": "2024-08-04_07-51-21", "timestamp": 1722738081, "time_this_iter_s": 13.12058162689209, "time_total_s": 464.0304057598114, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d85448a9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 464.0304057598114, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.584210526315786, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.4283582051595, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.106336575001478, "policy_loss": -0.008993074638904848, "vf_loss": 3.108565320322911, "vf_explained_var": 0.9798246494183938, "kl": 0.015255269033271663, "entropy": 1.0053754281873504, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -7.046598719112028, "episode_reward_min": -1463.9319230196495, "episode_reward_mean": -441.92908975594816, "episode_len_mean": 112.32, "episode_media": {}, "episodes_timesteps_total": 11232, "policy_reward_min": {"policy_0": -1463.9319230196495}, "policy_reward_max": {"policy_0": -7.046598719112028}, "policy_reward_mean": {"policy_0": -441.92908975594816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.35215358791157, -7.046598719112028, -239.3960993530335, -475.8797366746441, -717.6094890421886, -1100.3153723997498, -391.04590545213375, -933.7680797153004, -1213.193172742561, -118.35988600074081, -1074.3480383221633, -585.0409075026157, -1040.4481384998137, -169.1016590118937, -842.0180251386716, -103.08682472690437, -98.68361263675969, -313.40988332918414, -89.79385878087108, -287.63778801006947, -117.42621986775377, -211.51489493343388, -219.36095306119626, -200.8395790736622, -667.9479775922058, -515.7942004818989, -761.8607258947803, -1234.3928243866083, -161.84052227380792, -498.4816226326742, -354.64243192742896, -212.46074713886563, -774.5301847296549, -1463.9319230196495, -348.9928397467334, -59.26099423948039, -777.7000892421121, -154.9808816939102, -97.03618227929964, -113.74336695179066, -95.10649206945595, -1152.0468018590043, -563.980401531531, -409.5220737374016, -341.36231729749863, -305.65122618475766, -276.2449443437956, -629.1009402640291, -11.828061761660237, -144.81026124234089, -448.9831671543191, -176.9754609490448, -215.35181629040898, -889.2657663004803, -567.1990939372428, -271.2303831806145, -572.0250434228587, -177.609520936438, -135.6558630428715, -631.716936522734, -600.5211923003103, -515.5410855826987, -1235.611984121015, -284.62003522187746, -1245.4297559377046, -70.90440887131358, -203.89535430139304, -754.0831609505834, -389.8927829077554, -313.9400927996858, -154.01300869861117, -542.7084086764562, -311.42043491698763, -136.56156408768408, -1010.0665242549596, -111.23802614515533, -520.3690415630019, -265.9661562175708, -322.4174304980513, -376.25487257446576, -1063.654760617491, -935.8410833700032, -240.14849256658235, -531.7479947805149, -403.28156587603627, -155.90080468421573, -552.8591765287914, -439.49293160162097, -80.4972219308398, -54.60546981713688, -900.3981804176501, -334.1332063090293, -206.11536741031395, -187.27121144876557, -15.645933633109962, -260.9943208909474, -37.91645828239313, -52.76990262500671, -1130.1109332215167, -305.1276761138091], "episode_lengths": [97, 35, 107, 150, 150, 150, 147, 150, 150, 68, 150, 150, 150, 98, 150, 69, 68, 112, 52, 116, 52, 88, 85, 90, 150, 150, 150, 150, 91, 150, 132, 90, 150, 150, 102, 59, 150, 76, 80, 75, 52, 150, 150, 98, 135, 89, 82, 150, 38, 55, 142, 89, 104, 150, 150, 117, 150, 93, 69, 143, 150, 150, 150, 120, 150, 63, 92, 150, 88, 88, 80, 150, 130, 81, 150, 67, 150, 115, 104, 126, 150, 150, 95, 150, 106, 97, 150, 99, 64, 47, 150, 124, 104, 97, 42, 94, 53, 61, 150, 150], "policy_policy_0_reward": [-176.35215358791157, -7.046598719112028, -239.3960993530335, -475.8797366746441, -717.6094890421886, -1100.3153723997498, -391.04590545213375, -933.7680797153004, -1213.193172742561, -118.35988600074081, -1074.3480383221633, -585.0409075026157, -1040.4481384998137, -169.1016590118937, -842.0180251386716, -103.08682472690437, -98.68361263675969, -313.40988332918414, -89.79385878087108, -287.63778801006947, -117.42621986775377, -211.51489493343388, -219.36095306119626, -200.8395790736622, -667.9479775922058, -515.7942004818989, -761.8607258947803, -1234.3928243866083, -161.84052227380792, -498.4816226326742, -354.64243192742896, -212.46074713886563, -774.5301847296549, -1463.9319230196495, -348.9928397467334, -59.26099423948039, -777.7000892421121, -154.9808816939102, -97.03618227929964, -113.74336695179066, -95.10649206945595, -1152.0468018590043, -563.980401531531, -409.5220737374016, -341.36231729749863, -305.65122618475766, -276.2449443437956, -629.1009402640291, -11.828061761660237, -144.81026124234089, -448.9831671543191, -176.9754609490448, -215.35181629040898, -889.2657663004803, -567.1990939372428, -271.2303831806145, -572.0250434228587, -177.609520936438, -135.6558630428715, -631.716936522734, -600.5211923003103, -515.5410855826987, -1235.611984121015, -284.62003522187746, -1245.4297559377046, -70.90440887131358, -203.89535430139304, -754.0831609505834, -389.8927829077554, -313.9400927996858, -154.01300869861117, -542.7084086764562, -311.42043491698763, -136.56156408768408, -1010.0665242549596, -111.23802614515533, -520.3690415630019, -265.9661562175708, -322.4174304980513, -376.25487257446576, -1063.654760617491, -935.8410833700032, -240.14849256658235, -531.7479947805149, -403.28156587603627, -155.90080468421573, -552.8591765287914, -439.49293160162097, -80.4972219308398, -54.60546981713688, -900.3981804176501, -334.1332063090293, -206.11536741031395, -187.27121144876557, -15.645933633109962, -260.9943208909474, -37.91645828239313, -52.76990262500671, -1130.1109332215167, -305.1276761138091]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562967771639739, "mean_inference_ms": 1.7361214254999868, "mean_action_processing_ms": 0.2753640949641566, "mean_env_wait_ms": 3.4156039409001098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012012481689453125, "StateBufferConnector_ms": 0.008114814758300781, "ViewRequirementAgentConnector_ms": 0.1925206184387207}, "num_episodes": 37, "episode_return_max": -7.046598719112028, "episode_return_min": -1463.9319230196495, "episode_return_mean": -441.92908975594816, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.40216034064895, "num_env_steps_trained_throughput_per_sec": 366.40216034064895, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12946.324, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12946.258, "sample_time_ms": 1185.241, "learn_time_ms": 11692.929, "learn_throughput": 342.087, "synch_weights_time_ms": 67.27}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "1e132_00002", "date": "2024-08-04_07-51-32", "timestamp": 1722738092, "time_this_iter_s": 10.929104089736938, "time_total_s": 474.95950984954834, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bf9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.95950984954834, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.52, "ram_util_percent": 28.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.38453334768613, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.9809744904438653, "policy_loss": -0.010969951873994433, "vf_loss": 2.984598957250516, "vf_explained_var": 0.9893692338839173, "kl": 0.016586109004735332, "entropy": 1.1825415022671222, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -11.828061761660237, "episode_reward_min": -1481.535997444842, "episode_reward_mean": -436.3375389962709, "episode_len_mean": 112.1, "episode_media": {}, "episodes_timesteps_total": 11210, "policy_reward_min": {"policy_0": -1481.535997444842}, "policy_reward_max": {"policy_0": -11.828061761660237}, "policy_reward_mean": {"policy_0": -436.3375389962709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-777.7000892421121, -154.9808816939102, -97.03618227929964, -113.74336695179066, -95.10649206945595, -1152.0468018590043, -563.980401531531, -409.5220737374016, -341.36231729749863, -305.65122618475766, -276.2449443437956, -629.1009402640291, -11.828061761660237, -144.81026124234089, -448.9831671543191, -176.9754609490448, -215.35181629040898, -889.2657663004803, -567.1990939372428, -271.2303831806145, -572.0250434228587, -177.609520936438, -135.6558630428715, -631.716936522734, -600.5211923003103, -515.5410855826987, -1235.611984121015, -284.62003522187746, -1245.4297559377046, -70.90440887131358, -203.89535430139304, -754.0831609505834, -389.8927829077554, -313.9400927996858, -154.01300869861117, -542.7084086764562, -311.42043491698763, -136.56156408768408, -1010.0665242549596, -111.23802614515533, -520.3690415630019, -265.9661562175708, -322.4174304980513, -376.25487257446576, -1063.654760617491, -935.8410833700032, -240.14849256658235, -531.7479947805149, -403.28156587603627, -155.90080468421573, -552.8591765287914, -439.49293160162097, -80.4972219308398, -54.60546981713688, -900.3981804176501, -334.1332063090293, -206.11536741031395, -187.27121144876557, -15.645933633109962, -260.9943208909474, -37.91645828239313, -52.76990262500671, -1130.1109332215167, -305.1276761138091, -205.53159726775223, -109.9936582527271, -376.8975605191225, -1481.535997444842, -1332.7789548865762, -136.99058703473102, -343.2896399002959, -214.6057166642503, -280.05072786820637, -206.34920722454797, -69.23708970676844, -1141.578215325957, -600.2540398029914, -798.6137471453895, -545.1124512474041, -588.0526677282834, -1077.4982874783223, -543.6491008436557, -284.90645609441873, -1097.2234101405868, -145.41162676388876, -835.0262459169644, -78.77271210106012, -131.1034855799482, -81.42601436333747, -166.70105062185004, -1025.4591875484446, -81.20585905838742, -72.6311286774956, -358.56070427618266, -213.1058498346797, -917.7158256592476, -651.2599788042203, -199.55582696652772, -446.4155268163148, -382.15865911305104], "episode_lengths": [150, 76, 80, 75, 52, 150, 150, 98, 135, 89, 82, 150, 38, 55, 142, 89, 104, 150, 150, 117, 150, 93, 69, 143, 150, 150, 150, 120, 150, 63, 92, 150, 88, 88, 80, 150, 130, 81, 150, 67, 150, 115, 104, 126, 150, 150, 95, 150, 106, 97, 150, 99, 64, 47, 150, 124, 104, 97, 42, 94, 53, 61, 150, 150, 86, 81, 141, 150, 150, 69, 118, 95, 104, 88, 62, 150, 150, 150, 150, 147, 150, 116, 82, 150, 86, 150, 52, 78, 64, 89, 150, 64, 60, 150, 99, 150, 150, 105, 150, 150], "policy_policy_0_reward": [-777.7000892421121, -154.9808816939102, -97.03618227929964, -113.74336695179066, -95.10649206945595, -1152.0468018590043, -563.980401531531, -409.5220737374016, -341.36231729749863, -305.65122618475766, -276.2449443437956, -629.1009402640291, -11.828061761660237, -144.81026124234089, -448.9831671543191, -176.9754609490448, -215.35181629040898, -889.2657663004803, -567.1990939372428, -271.2303831806145, -572.0250434228587, -177.609520936438, -135.6558630428715, -631.716936522734, -600.5211923003103, -515.5410855826987, -1235.611984121015, -284.62003522187746, -1245.4297559377046, -70.90440887131358, -203.89535430139304, -754.0831609505834, -389.8927829077554, -313.9400927996858, -154.01300869861117, -542.7084086764562, -311.42043491698763, -136.56156408768408, -1010.0665242549596, -111.23802614515533, -520.3690415630019, -265.9661562175708, -322.4174304980513, -376.25487257446576, -1063.654760617491, -935.8410833700032, -240.14849256658235, -531.7479947805149, -403.28156587603627, -155.90080468421573, -552.8591765287914, -439.49293160162097, -80.4972219308398, -54.60546981713688, -900.3981804176501, -334.1332063090293, -206.11536741031395, -187.27121144876557, -15.645933633109962, -260.9943208909474, -37.91645828239313, -52.76990262500671, -1130.1109332215167, -305.1276761138091, -205.53159726775223, -109.9936582527271, -376.8975605191225, -1481.535997444842, -1332.7789548865762, -136.99058703473102, -343.2896399002959, -214.6057166642503, -280.05072786820637, -206.34920722454797, -69.23708970676844, -1141.578215325957, -600.2540398029914, -798.6137471453895, -545.1124512474041, -588.0526677282834, -1077.4982874783223, -543.6491008436557, -284.90645609441873, -1097.2234101405868, -145.41162676388876, -835.0262459169644, -78.77271210106012, -131.1034855799482, -81.42601436333747, -166.70105062185004, -1025.4591875484446, -81.20585905838742, -72.6311286774956, -358.56070427618266, -213.1058498346797, -917.7158256592476, -651.2599788042203, -199.55582696652772, -446.4155268163148, -382.15865911305104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556551539789074, "mean_inference_ms": 1.7347321898078838, "mean_action_processing_ms": 0.27542350825793704, "mean_env_wait_ms": 3.4140701265627182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011974096298217773, "StateBufferConnector_ms": 0.008148431777954102, "ViewRequirementAgentConnector_ms": 0.1929025650024414}, "num_episodes": 36, "episode_return_max": -11.828061761660237, "episode_return_min": -1481.535997444842, "episode_return_mean": -436.3375389962709, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.95127703864335, "num_env_steps_trained_throughput_per_sec": 308.95127703864335, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12891.806, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12891.74, "sample_time_ms": 1168.788, "learn_time_ms": 11655.815, "learn_throughput": 343.176, "synch_weights_time_ms": 66.329}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "1e132_00002", "date": "2024-08-04_07-51-45", "timestamp": 1722738105, "time_this_iter_s": 12.961464166641235, "time_total_s": 487.9209740161896, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 487.9209740161896, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.5, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.8138758480549, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.9946935538202526, "policy_loss": -0.015326664794217019, "vf_loss": 3.0023819812883934, "vf_explained_var": 0.9913885476067662, "kl": 0.01724409327904747, "entropy": 1.2160732921833792, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -15.645933633109962, "episode_reward_min": -1481.535997444842, "episode_reward_mean": -453.1613941841733, "episode_len_mean": 113.45, "episode_media": {}, "episodes_timesteps_total": 11345, "policy_reward_min": {"policy_0": -1481.535997444842}, "policy_reward_max": {"policy_0": -15.645933633109962}, "policy_reward_mean": {"policy_0": -453.1613941841733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-389.8927829077554, -313.9400927996858, -154.01300869861117, -542.7084086764562, -311.42043491698763, -136.56156408768408, -1010.0665242549596, -111.23802614515533, -520.3690415630019, -265.9661562175708, -322.4174304980513, -376.25487257446576, -1063.654760617491, -935.8410833700032, -240.14849256658235, -531.7479947805149, -403.28156587603627, -155.90080468421573, -552.8591765287914, -439.49293160162097, -80.4972219308398, -54.60546981713688, -900.3981804176501, -334.1332063090293, -206.11536741031395, -187.27121144876557, -15.645933633109962, -260.9943208909474, -37.91645828239313, -52.76990262500671, -1130.1109332215167, -305.1276761138091, -205.53159726775223, -109.9936582527271, -376.8975605191225, -1481.535997444842, -1332.7789548865762, -136.99058703473102, -343.2896399002959, -214.6057166642503, -280.05072786820637, -206.34920722454797, -69.23708970676844, -1141.578215325957, -600.2540398029914, -798.6137471453895, -545.1124512474041, -588.0526677282834, -1077.4982874783223, -543.6491008436557, -284.90645609441873, -1097.2234101405868, -145.41162676388876, -835.0262459169644, -78.77271210106012, -131.1034855799482, -81.42601436333747, -166.70105062185004, -1025.4591875484446, -81.20585905838742, -72.6311286774956, -358.56070427618266, -213.1058498346797, -917.7158256592476, -651.2599788042203, -199.55582696652772, -446.4155268163148, -382.15865911305104, -1318.7800824188837, -1246.123171877293, -1135.5586677949875, -1087.9887337098369, -464.97005389697966, -373.8584803727927, -161.665993472853, -137.56219357516733, -62.6451638110701, -175.1534317793298, -371.3042459556149, -605.1950733514763, -1020.8095716818411, -449.24905250036034, -133.24642964305153, -150.2863530601162, -26.550142733896195, -40.5118597169519, -149.77723021624396, -440.06333102320224, -184.0835517663031, -538.7055582973218, -668.536541297009, -209.60326087916968, -205.52096940714117, -59.46522988802392, -1166.2679997999287, -349.3588363269099, -410.9704652068937, -988.485374434956, -939.7509301339294, -480.0716082432059], "episode_lengths": [88, 88, 80, 150, 130, 81, 150, 67, 150, 115, 104, 126, 150, 150, 95, 150, 106, 97, 150, 99, 64, 47, 150, 124, 104, 97, 42, 94, 53, 61, 150, 150, 86, 81, 141, 150, 150, 69, 118, 95, 104, 88, 62, 150, 150, 150, 150, 147, 150, 116, 82, 150, 86, 150, 52, 78, 64, 89, 150, 64, 60, 150, 99, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 100, 85, 43, 104, 150, 150, 150, 150, 70, 75, 46, 51, 85, 150, 82, 150, 150, 83, 63, 57, 150, 117, 136, 150, 150, 150], "policy_policy_0_reward": [-389.8927829077554, -313.9400927996858, -154.01300869861117, -542.7084086764562, -311.42043491698763, -136.56156408768408, -1010.0665242549596, -111.23802614515533, -520.3690415630019, -265.9661562175708, -322.4174304980513, -376.25487257446576, -1063.654760617491, -935.8410833700032, -240.14849256658235, -531.7479947805149, -403.28156587603627, -155.90080468421573, -552.8591765287914, -439.49293160162097, -80.4972219308398, -54.60546981713688, -900.3981804176501, -334.1332063090293, -206.11536741031395, -187.27121144876557, -15.645933633109962, -260.9943208909474, -37.91645828239313, -52.76990262500671, -1130.1109332215167, -305.1276761138091, -205.53159726775223, -109.9936582527271, -376.8975605191225, -1481.535997444842, -1332.7789548865762, -136.99058703473102, -343.2896399002959, -214.6057166642503, -280.05072786820637, -206.34920722454797, -69.23708970676844, -1141.578215325957, -600.2540398029914, -798.6137471453895, -545.1124512474041, -588.0526677282834, -1077.4982874783223, -543.6491008436557, -284.90645609441873, -1097.2234101405868, -145.41162676388876, -835.0262459169644, -78.77271210106012, -131.1034855799482, -81.42601436333747, -166.70105062185004, -1025.4591875484446, -81.20585905838742, -72.6311286774956, -358.56070427618266, -213.1058498346797, -917.7158256592476, -651.2599788042203, -199.55582696652772, -446.4155268163148, -382.15865911305104, -1318.7800824188837, -1246.123171877293, -1135.5586677949875, -1087.9887337098369, -464.97005389697966, -373.8584803727927, -161.665993472853, -137.56219357516733, -62.6451638110701, -175.1534317793298, -371.3042459556149, -605.1950733514763, -1020.8095716818411, -449.24905250036034, -133.24642964305153, -150.2863530601162, -26.550142733896195, -40.5118597169519, -149.77723021624396, -440.06333102320224, -184.0835517663031, -538.7055582973218, -668.536541297009, -209.60326087916968, -205.52096940714117, -59.46522988802392, -1166.2679997999287, -349.3588363269099, -410.9704652068937, -988.485374434956, -939.7509301339294, -480.0716082432059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566296207722797, "mean_inference_ms": 1.7336592995485345, "mean_action_processing_ms": 0.2754304598717437, "mean_env_wait_ms": 3.413168984427785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012139558792114258, "StateBufferConnector_ms": 0.008031368255615234, "ViewRequirementAgentConnector_ms": 0.19196057319641113}, "num_episodes": 32, "episode_return_max": -15.645933633109962, "episode_return_min": -1481.535997444842, "episode_return_mean": -453.1613941841733, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.63988707410306, "num_env_steps_trained_throughput_per_sec": 317.63988707410306, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12819.732, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12819.664, "sample_time_ms": 1167.343, "learn_time_ms": 11586.835, "learn_throughput": 345.219, "synch_weights_time_ms": 64.672}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "1e132_00002", "date": "2024-08-04_07-51-58", "timestamp": 1722738118, "time_this_iter_s": 12.604923725128174, "time_total_s": 500.52589774131775, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac121630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 500.52589774131775, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.027777777777782, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.688673299551, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.315907910342018, "policy_loss": 0.2821533665546061, "vf_loss": 2.772968376179536, "vf_explained_var": 0.991730703227222, "kl": 0.5799614772456455, "entropy": 1.9649606099352241, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -26.550142733896195, "episode_reward_min": -1318.7800824188837, "episode_reward_mean": -473.41417267788506, "episode_len_mean": 116.17, "episode_media": {}, "episodes_timesteps_total": 11617, "policy_reward_min": {"policy_0": -1318.7800824188837}, "policy_reward_max": {"policy_0": -26.550142733896195}, "policy_reward_mean": {"policy_0": -473.41417267788506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-343.2896399002959, -214.6057166642503, -280.05072786820637, -206.34920722454797, -69.23708970676844, -1141.578215325957, -600.2540398029914, -798.6137471453895, -545.1124512474041, -588.0526677282834, -1077.4982874783223, -543.6491008436557, -284.90645609441873, -1097.2234101405868, -145.41162676388876, -835.0262459169644, -78.77271210106012, -131.1034855799482, -81.42601436333747, -166.70105062185004, -1025.4591875484446, -81.20585905838742, -72.6311286774956, -358.56070427618266, -213.1058498346797, -917.7158256592476, -651.2599788042203, -199.55582696652772, -446.4155268163148, -382.15865911305104, -1318.7800824188837, -1246.123171877293, -1135.5586677949875, -1087.9887337098369, -464.97005389697966, -373.8584803727927, -161.665993472853, -137.56219357516733, -62.6451638110701, -175.1534317793298, -371.3042459556149, -605.1950733514763, -1020.8095716818411, -449.24905250036034, -133.24642964305153, -150.2863530601162, -26.550142733896195, -40.5118597169519, -149.77723021624396, -440.06333102320224, -184.0835517663031, -538.7055582973218, -668.536541297009, -209.60326087916968, -205.52096940714117, -59.46522988802392, -1166.2679997999287, -349.3588363269099, -410.9704652068937, -988.485374434956, -939.7509301339294, -480.0716082432059, -225.993321686105, -903.490884165981, -126.14899043563679, -670.0870602245602, -942.998122593417, -136.50970101032757, -203.77438910906625, -528.0693433333873, -1083.9108768963542, -234.03888797955844, -155.62600644029095, -1281.759419301075, -160.38922322829478, -422.45759193212103, -307.741509572399, -442.74671748103714, -1080.8653926749128, -927.0316940090989, -517.5314719996672, -953.1092250919885, -1057.4056527934251, -296.80373537050247, -150.4061670481815, -950.7054980392048, -203.3404811762521, -75.92869566320826, -256.98684945932393, -171.27496430073592, -71.77980890627602, -78.08644337009103, -568.1009189148104, -52.062046719375104, -692.0281412751879, -579.5791858438255, -374.31681605614017, -577.1873875884047, -460.42241826100445, -91.6722002918528], "episode_lengths": [118, 95, 104, 88, 62, 150, 150, 150, 150, 147, 150, 116, 82, 150, 86, 150, 52, 78, 64, 89, 150, 64, 60, 150, 99, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 100, 85, 43, 104, 150, 150, 150, 150, 70, 75, 46, 51, 85, 150, 82, 150, 150, 83, 63, 57, 150, 117, 136, 150, 150, 150, 102, 150, 79, 150, 150, 68, 69, 150, 150, 100, 78, 150, 87, 121, 117, 150, 150, 150, 150, 150, 150, 99, 79, 150, 86, 62, 95, 94, 56, 76, 150, 61, 150, 150, 150, 113, 150, 69], "policy_policy_0_reward": [-343.2896399002959, -214.6057166642503, -280.05072786820637, -206.34920722454797, -69.23708970676844, -1141.578215325957, -600.2540398029914, -798.6137471453895, -545.1124512474041, -588.0526677282834, -1077.4982874783223, -543.6491008436557, -284.90645609441873, -1097.2234101405868, -145.41162676388876, -835.0262459169644, -78.77271210106012, -131.1034855799482, -81.42601436333747, -166.70105062185004, -1025.4591875484446, -81.20585905838742, -72.6311286774956, -358.56070427618266, -213.1058498346797, -917.7158256592476, -651.2599788042203, -199.55582696652772, -446.4155268163148, -382.15865911305104, -1318.7800824188837, -1246.123171877293, -1135.5586677949875, -1087.9887337098369, -464.97005389697966, -373.8584803727927, -161.665993472853, -137.56219357516733, -62.6451638110701, -175.1534317793298, -371.3042459556149, -605.1950733514763, -1020.8095716818411, -449.24905250036034, -133.24642964305153, -150.2863530601162, -26.550142733896195, -40.5118597169519, -149.77723021624396, -440.06333102320224, -184.0835517663031, -538.7055582973218, -668.536541297009, -209.60326087916968, -205.52096940714117, -59.46522988802392, -1166.2679997999287, -349.3588363269099, -410.9704652068937, -988.485374434956, -939.7509301339294, -480.0716082432059, -225.993321686105, -903.490884165981, -126.14899043563679, -670.0870602245602, -942.998122593417, -136.50970101032757, -203.77438910906625, -528.0693433333873, -1083.9108768963542, -234.03888797955844, -155.62600644029095, -1281.759419301075, -160.38922322829478, -422.45759193212103, -307.741509572399, -442.74671748103714, -1080.8653926749128, -927.0316940090989, -517.5314719996672, -953.1092250919885, -1057.4056527934251, -296.80373537050247, -150.4061670481815, -950.7054980392048, -203.3404811762521, -75.92869566320826, -256.98684945932393, -171.27496430073592, -71.77980890627602, -78.08644337009103, -568.1009189148104, -52.062046719375104, -692.0281412751879, -579.5791858438255, -374.31681605614017, -577.1873875884047, -460.42241826100445, -91.6722002918528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556798079860886, "mean_inference_ms": 1.7315876562008683, "mean_action_processing_ms": 0.27538251492777654, "mean_env_wait_ms": 3.41380534746014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012341737747192383, "StateBufferConnector_ms": 0.007972002029418945, "ViewRequirementAgentConnector_ms": 0.2018294334411621}, "num_episodes": 38, "episode_return_max": -26.550142733896195, "episode_return_min": -1318.7800824188837, "episode_return_mean": -473.41417267788506, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.75226158536435, "num_env_steps_trained_throughput_per_sec": 346.75226158536435, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12708.294, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12708.225, "sample_time_ms": 1171.726, "learn_time_ms": 11470.27, "learn_throughput": 348.728, "synch_weights_time_ms": 65.413}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "1e132_00002", "date": "2024-08-04_07-52-09", "timestamp": 1722738129, "time_this_iter_s": 11.547894716262817, "time_total_s": 512.0737924575806, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bc820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 512.0737924575806, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.981250000000003, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.1230535387993, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.0840664392958086, "policy_loss": -0.007801822811597958, "vf_loss": 3.0831982818742594, "vf_explained_var": 0.9840746010343234, "kl": 0.013097756999286548, "entropy": 1.710000382984678, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -25.971044649485137, "episode_reward_min": -1318.7800824188837, "episode_reward_mean": -528.5424131255961, "episode_len_mean": 120.33, "episode_media": {}, "episodes_timesteps_total": 12033, "policy_reward_min": {"policy_0": -1318.7800824188837}, "policy_reward_max": {"policy_0": -25.971044649485137}, "policy_reward_mean": {"policy_0": -528.5424131255961}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.55582696652772, -446.4155268163148, -382.15865911305104, -1318.7800824188837, -1246.123171877293, -1135.5586677949875, -1087.9887337098369, -464.97005389697966, -373.8584803727927, -161.665993472853, -137.56219357516733, -62.6451638110701, -175.1534317793298, -371.3042459556149, -605.1950733514763, -1020.8095716818411, -449.24905250036034, -133.24642964305153, -150.2863530601162, -26.550142733896195, -40.5118597169519, -149.77723021624396, -440.06333102320224, -184.0835517663031, -538.7055582973218, -668.536541297009, -209.60326087916968, -205.52096940714117, -59.46522988802392, -1166.2679997999287, -349.3588363269099, -410.9704652068937, -988.485374434956, -939.7509301339294, -480.0716082432059, -225.993321686105, -903.490884165981, -126.14899043563679, -670.0870602245602, -942.998122593417, -136.50970101032757, -203.77438910906625, -528.0693433333873, -1083.9108768963542, -234.03888797955844, -155.62600644029095, -1281.759419301075, -160.38922322829478, -422.45759193212103, -307.741509572399, -442.74671748103714, -1080.8653926749128, -927.0316940090989, -517.5314719996672, -953.1092250919885, -1057.4056527934251, -296.80373537050247, -150.4061670481815, -950.7054980392048, -203.3404811762521, -75.92869566320826, -256.98684945932393, -171.27496430073592, -71.77980890627602, -78.08644337009103, -568.1009189148104, -52.062046719375104, -692.0281412751879, -579.5791858438255, -374.31681605614017, -577.1873875884047, -460.42241826100445, -91.6722002918528, -191.1109984731468, -883.7099342210039, -1233.9994162529847, -403.9805673547545, -1154.3766593841997, -438.332871543121, -334.4710551706476, -738.2575000505744, -403.19583933174914, -1226.788002745338, -1170.3985773516156, -1181.385483652395, -441.48585365318263, -586.1677848977262, -379.626169257909, -53.18509661896548, -961.8277027247632, -25.971044649485137, -161.94805723540688, -565.8555327288716, -185.38300735300123, -1020.7238775833024, -506.9065080294871, -1196.6669630075244, -1060.5329024152563, -808.1934868870648, -747.1435785744109], "episode_lengths": [105, 150, 150, 150, 150, 150, 150, 150, 150, 100, 85, 43, 104, 150, 150, 150, 150, 70, 75, 46, 51, 85, 150, 82, 150, 150, 83, 63, 57, 150, 117, 136, 150, 150, 150, 102, 150, 79, 150, 150, 68, 69, 150, 150, 100, 78, 150, 87, 121, 117, 150, 150, 150, 150, 150, 150, 99, 79, 150, 86, 62, 95, 94, 56, 76, 150, 61, 150, 150, 150, 113, 150, 69, 71, 150, 150, 145, 150, 150, 111, 150, 121, 150, 150, 150, 129, 150, 150, 44, 150, 47, 60, 127, 81, 150, 150, 150, 150, 134, 150], "policy_policy_0_reward": [-199.55582696652772, -446.4155268163148, -382.15865911305104, -1318.7800824188837, -1246.123171877293, -1135.5586677949875, -1087.9887337098369, -464.97005389697966, -373.8584803727927, -161.665993472853, -137.56219357516733, -62.6451638110701, -175.1534317793298, -371.3042459556149, -605.1950733514763, -1020.8095716818411, -449.24905250036034, -133.24642964305153, -150.2863530601162, -26.550142733896195, -40.5118597169519, -149.77723021624396, -440.06333102320224, -184.0835517663031, -538.7055582973218, -668.536541297009, -209.60326087916968, -205.52096940714117, -59.46522988802392, -1166.2679997999287, -349.3588363269099, -410.9704652068937, -988.485374434956, -939.7509301339294, -480.0716082432059, -225.993321686105, -903.490884165981, -126.14899043563679, -670.0870602245602, -942.998122593417, -136.50970101032757, -203.77438910906625, -528.0693433333873, -1083.9108768963542, -234.03888797955844, -155.62600644029095, -1281.759419301075, -160.38922322829478, -422.45759193212103, -307.741509572399, -442.74671748103714, -1080.8653926749128, -927.0316940090989, -517.5314719996672, -953.1092250919885, -1057.4056527934251, -296.80373537050247, -150.4061670481815, -950.7054980392048, -203.3404811762521, -75.92869566320826, -256.98684945932393, -171.27496430073592, -71.77980890627602, -78.08644337009103, -568.1009189148104, -52.062046719375104, -692.0281412751879, -579.5791858438255, -374.31681605614017, -577.1873875884047, -460.42241826100445, -91.6722002918528, -191.1109984731468, -883.7099342210039, -1233.9994162529847, -403.9805673547545, -1154.3766593841997, -438.332871543121, -334.4710551706476, -738.2575000505744, -403.19583933174914, -1226.788002745338, -1170.3985773516156, -1181.385483652395, -441.48585365318263, -586.1677848977262, -379.626169257909, -53.18509661896548, -961.8277027247632, -25.971044649485137, -161.94805723540688, -565.8555327288716, -185.38300735300123, -1020.7238775833024, -506.9065080294871, -1196.6669630075244, -1060.5329024152563, -808.1934868870648, -747.1435785744109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563767157664943, "mean_inference_ms": 1.7293609945827868, "mean_action_processing_ms": 0.2753123067611653, "mean_env_wait_ms": 3.4150915104775748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011999845504760742, "StateBufferConnector_ms": 0.007873058319091797, "ViewRequirementAgentConnector_ms": 0.1984412670135498}, "num_episodes": 27, "episode_return_max": -25.971044649485137, "episode_return_min": -1318.7800824188837, "episode_return_mean": -528.5424131255961, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.27155160007834, "num_env_steps_trained_throughput_per_sec": 304.27155160007834, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12721.107, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12721.041, "sample_time_ms": 1131.163, "learn_time_ms": 11524.208, "learn_throughput": 347.095, "synch_weights_time_ms": 64.858}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "1e132_00002", "date": "2024-08-04_07-52-23", "timestamp": 1722738143, "time_this_iter_s": 13.157681226730347, "time_total_s": 525.2314736843109, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 525.2314736843109, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.610526315789475, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 249.59019454320273, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.5638571615020433, "policy_loss": -0.01667533413565252, "vf_loss": 2.5728559818118812, "vf_explained_var": 0.9946409477541844, "kl": 0.011653766624719234, "entropy": 1.8977701475222906, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -25.971044649485137, "episode_reward_min": -1494.709637385832, "episode_reward_mean": -634.2201513695857, "episode_len_mean": 125.45, "episode_media": {}, "episodes_timesteps_total": 12545, "policy_reward_min": {"policy_0": -1494.709637385832}, "policy_reward_max": {"policy_0": -25.971044649485137}, "policy_reward_mean": {"policy_0": -634.2201513695857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.9704652068937, -988.485374434956, -939.7509301339294, -480.0716082432059, -225.993321686105, -903.490884165981, -126.14899043563679, -670.0870602245602, -942.998122593417, -136.50970101032757, -203.77438910906625, -528.0693433333873, -1083.9108768963542, -234.03888797955844, -155.62600644029095, -1281.759419301075, -160.38922322829478, -422.45759193212103, -307.741509572399, -442.74671748103714, -1080.8653926749128, -927.0316940090989, -517.5314719996672, -953.1092250919885, -1057.4056527934251, -296.80373537050247, -150.4061670481815, -950.7054980392048, -203.3404811762521, -75.92869566320826, -256.98684945932393, -171.27496430073592, -71.77980890627602, -78.08644337009103, -568.1009189148104, -52.062046719375104, -692.0281412751879, -579.5791858438255, -374.31681605614017, -577.1873875884047, -460.42241826100445, -91.6722002918528, -191.1109984731468, -883.7099342210039, -1233.9994162529847, -403.9805673547545, -1154.3766593841997, -438.332871543121, -334.4710551706476, -738.2575000505744, -403.19583933174914, -1226.788002745338, -1170.3985773516156, -1181.385483652395, -441.48585365318263, -586.1677848977262, -379.626169257909, -53.18509661896548, -961.8277027247632, -25.971044649485137, -161.94805723540688, -565.8555327288716, -185.38300735300123, -1020.7238775833024, -506.9065080294871, -1196.6669630075244, -1060.5329024152563, -808.1934868870648, -747.1435785744109, -1042.8891551886945, -1102.9506586122077, -1225.1275977303399, -631.4677443873932, -118.60006273496602, -1494.709637385832, -235.96840679434322, -1003.6915397159801, -754.9607559328755, -893.9023689211975, -30.030062366860637, -99.43333199541084, -934.820493830895, -491.58531217383216, -28.481496083677598, -665.0768019900413, -1407.5152372534458, -993.1289361556672, -128.53404047275697, -916.5094180689836, -823.6410390086705, -725.8103710736215, -305.7600783187977, -1261.2806557044817, -1073.4846458200916, -997.7315078260395, -823.2934145265466, -663.251427150997, -1441.7454755824535, -979.59012084489, -1233.7732538966247], "episode_lengths": [136, 150, 150, 150, 102, 150, 79, 150, 150, 68, 69, 150, 150, 100, 78, 150, 87, 121, 117, 150, 150, 150, 150, 150, 150, 99, 79, 150, 86, 62, 95, 94, 56, 76, 150, 61, 150, 150, 150, 113, 150, 69, 71, 150, 150, 145, 150, 150, 111, 150, 121, 150, 150, 150, 129, 150, 150, 44, 150, 47, 60, 127, 81, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 61, 150, 109, 150, 150, 150, 59, 69, 150, 150, 44, 150, 150, 150, 50, 150, 150, 150, 87, 150, 150, 150, 150, 149, 150, 150, 150], "policy_policy_0_reward": [-410.9704652068937, -988.485374434956, -939.7509301339294, -480.0716082432059, -225.993321686105, -903.490884165981, -126.14899043563679, -670.0870602245602, -942.998122593417, -136.50970101032757, -203.77438910906625, -528.0693433333873, -1083.9108768963542, -234.03888797955844, -155.62600644029095, -1281.759419301075, -160.38922322829478, -422.45759193212103, -307.741509572399, -442.74671748103714, -1080.8653926749128, -927.0316940090989, -517.5314719996672, -953.1092250919885, -1057.4056527934251, -296.80373537050247, -150.4061670481815, -950.7054980392048, -203.3404811762521, -75.92869566320826, -256.98684945932393, -171.27496430073592, -71.77980890627602, -78.08644337009103, -568.1009189148104, -52.062046719375104, -692.0281412751879, -579.5791858438255, -374.31681605614017, -577.1873875884047, -460.42241826100445, -91.6722002918528, -191.1109984731468, -883.7099342210039, -1233.9994162529847, -403.9805673547545, -1154.3766593841997, -438.332871543121, -334.4710551706476, -738.2575000505744, -403.19583933174914, -1226.788002745338, -1170.3985773516156, -1181.385483652395, -441.48585365318263, -586.1677848977262, -379.626169257909, -53.18509661896548, -961.8277027247632, -25.971044649485137, -161.94805723540688, -565.8555327288716, -185.38300735300123, -1020.7238775833024, -506.9065080294871, -1196.6669630075244, -1060.5329024152563, -808.1934868870648, -747.1435785744109, -1042.8891551886945, -1102.9506586122077, -1225.1275977303399, -631.4677443873932, -118.60006273496602, -1494.709637385832, -235.96840679434322, -1003.6915397159801, -754.9607559328755, -893.9023689211975, -30.030062366860637, -99.43333199541084, -934.820493830895, -491.58531217383216, -28.481496083677598, -665.0768019900413, -1407.5152372534458, -993.1289361556672, -128.53404047275697, -916.5094180689836, -823.6410390086705, -725.8103710736215, -305.7600783187977, -1261.2806557044817, -1073.4846458200916, -997.7315078260395, -823.2934145265466, -663.251427150997, -1441.7454755824535, -979.59012084489, -1233.7732538966247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554848896419556, "mean_inference_ms": 1.7268160261560337, "mean_action_processing_ms": 0.27513203358825555, "mean_env_wait_ms": 3.4133702172647276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217283248901367, "StateBufferConnector_ms": 0.007922649383544922, "ViewRequirementAgentConnector_ms": 0.1988990306854248}, "num_episodes": 31, "episode_return_max": -25.971044649485137, "episode_return_min": -1494.709637385832, "episode_return_mean": -634.2201513695857, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.3374153269286, "num_env_steps_trained_throughput_per_sec": 303.3374153269286, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12718.946, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12718.878, "sample_time_ms": 1138.216, "learn_time_ms": 11514.553, "learn_throughput": 347.386, "synch_weights_time_ms": 65.296}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "1e132_00002", "date": "2024-08-04_07-52-36", "timestamp": 1722738156, "time_this_iter_s": 13.197956323623657, "time_total_s": 538.4294300079346, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac137910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 538.4294300079346, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.81578947368421, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 216.26853470603626, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.737100686877966, "policy_loss": -0.006480640833372794, "vf_loss": 2.7361975241452456, "vf_explained_var": 0.977831662259996, "kl": 0.011208771322465812, "entropy": 1.8211223639547824, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -25.971044649485137, "episode_reward_min": -1494.709637385832, "episode_reward_mean": -683.4029969232877, "episode_len_mean": 127.82, "episode_media": {}, "episodes_timesteps_total": 12782, "policy_reward_min": {"policy_0": -1494.709637385832}, "policy_reward_max": {"policy_0": -25.971044649485137}, "policy_reward_mean": {"policy_0": -683.4029969232877}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.98684945932393, -171.27496430073592, -71.77980890627602, -78.08644337009103, -568.1009189148104, -52.062046719375104, -692.0281412751879, -579.5791858438255, -374.31681605614017, -577.1873875884047, -460.42241826100445, -91.6722002918528, -191.1109984731468, -883.7099342210039, -1233.9994162529847, -403.9805673547545, -1154.3766593841997, -438.332871543121, -334.4710551706476, -738.2575000505744, -403.19583933174914, -1226.788002745338, -1170.3985773516156, -1181.385483652395, -441.48585365318263, -586.1677848977262, -379.626169257909, -53.18509661896548, -961.8277027247632, -25.971044649485137, -161.94805723540688, -565.8555327288716, -185.38300735300123, -1020.7238775833024, -506.9065080294871, -1196.6669630075244, -1060.5329024152563, -808.1934868870648, -747.1435785744109, -1042.8891551886945, -1102.9506586122077, -1225.1275977303399, -631.4677443873932, -118.60006273496602, -1494.709637385832, -235.96840679434322, -1003.6915397159801, -754.9607559328755, -893.9023689211975, -30.030062366860637, -99.43333199541084, -934.820493830895, -491.58531217383216, -28.481496083677598, -665.0768019900413, -1407.5152372534458, -993.1289361556672, -128.53404047275697, -916.5094180689836, -823.6410390086705, -725.8103710736215, -305.7600783187977, -1261.2806557044817, -1073.4846458200916, -997.7315078260395, -823.2934145265466, -663.251427150997, -1441.7454755824535, -979.59012084489, -1233.7732538966247, -904.2436774821879, -699.1821376992156, -227.56424421865344, -940.430202906813, -1233.963587491492, -364.62665690674066, -924.7013939223735, -691.1453334964344, -181.42372135673503, -1057.165525759314, -115.24174813429028, -937.8717991978598, -951.3814901076306, -325.7979903643566, -1375.7158789340683, -1040.1591595100847, -534.0711677368716, -816.0034144281734, -541.9119432577065, -970.6393298580272, -1128.3080770394836, -1452.3369339283731, -431.6313557582752, -300.9799714212018, -71.84232214085502, -1123.4569054733593, -530.9975428630339, -641.6000228909612, -371.22036525681284, -890.8190931038883], "episode_lengths": [95, 94, 56, 76, 150, 61, 150, 150, 150, 113, 150, 69, 71, 150, 150, 145, 150, 150, 111, 150, 121, 150, 150, 150, 129, 150, 150, 44, 150, 47, 60, 127, 81, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 61, 150, 109, 150, 150, 150, 59, 69, 150, 150, 44, 150, 150, 150, 50, 150, 150, 150, 87, 150, 150, 150, 150, 149, 150, 150, 150, 150, 130, 106, 150, 150, 90, 150, 145, 63, 150, 92, 150, 150, 97, 150, 150, 150, 150, 107, 150, 150, 150, 121, 125, 41, 150, 150, 150, 103, 150], "policy_policy_0_reward": [-256.98684945932393, -171.27496430073592, -71.77980890627602, -78.08644337009103, -568.1009189148104, -52.062046719375104, -692.0281412751879, -579.5791858438255, -374.31681605614017, -577.1873875884047, -460.42241826100445, -91.6722002918528, -191.1109984731468, -883.7099342210039, -1233.9994162529847, -403.9805673547545, -1154.3766593841997, -438.332871543121, -334.4710551706476, -738.2575000505744, -403.19583933174914, -1226.788002745338, -1170.3985773516156, -1181.385483652395, -441.48585365318263, -586.1677848977262, -379.626169257909, -53.18509661896548, -961.8277027247632, -25.971044649485137, -161.94805723540688, -565.8555327288716, -185.38300735300123, -1020.7238775833024, -506.9065080294871, -1196.6669630075244, -1060.5329024152563, -808.1934868870648, -747.1435785744109, -1042.8891551886945, -1102.9506586122077, -1225.1275977303399, -631.4677443873932, -118.60006273496602, -1494.709637385832, -235.96840679434322, -1003.6915397159801, -754.9607559328755, -893.9023689211975, -30.030062366860637, -99.43333199541084, -934.820493830895, -491.58531217383216, -28.481496083677598, -665.0768019900413, -1407.5152372534458, -993.1289361556672, -128.53404047275697, -916.5094180689836, -823.6410390086705, -725.8103710736215, -305.7600783187977, -1261.2806557044817, -1073.4846458200916, -997.7315078260395, -823.2934145265466, -663.251427150997, -1441.7454755824535, -979.59012084489, -1233.7732538966247, -904.2436774821879, -699.1821376992156, -227.56424421865344, -940.430202906813, -1233.963587491492, -364.62665690674066, -924.7013939223735, -691.1453334964344, -181.42372135673503, -1057.165525759314, -115.24174813429028, -937.8717991978598, -951.3814901076306, -325.7979903643566, -1375.7158789340683, -1040.1591595100847, -534.0711677368716, -816.0034144281734, -541.9119432577065, -970.6393298580272, -1128.3080770394836, -1452.3369339283731, -431.6313557582752, -300.9799714212018, -71.84232214085502, -1123.4569054733593, -530.9975428630339, -641.6000228909612, -371.22036525681284, -890.8190931038883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553728296591881, "mean_inference_ms": 1.7254114219818277, "mean_action_processing_ms": 0.27499943609405064, "mean_env_wait_ms": 3.415554400521878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012468338012695312, "StateBufferConnector_ms": 0.007869958877563477, "ViewRequirementAgentConnector_ms": 0.18983840942382812}, "num_episodes": 30, "episode_return_max": -25.971044649485137, "episode_return_min": -1494.709637385832, "episode_return_mean": -683.4029969232877, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.114219614562, "num_env_steps_trained_throughput_per_sec": 309.114219614562, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12670.339, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12670.271, "sample_time_ms": 1130.675, "learn_time_ms": 11474.028, "learn_throughput": 348.613, "synch_weights_time_ms": 64.761}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "1e132_00002", "date": "2024-08-04_07-52-49", "timestamp": 1722738169, "time_this_iter_s": 12.95311188697815, "time_total_s": 551.3825418949127, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac137a30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 551.3825418949127, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.161111111111115, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.9052179078261, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.682668415084481, "policy_loss": -0.013972499819647054, "vf_loss": 2.6893140649423004, "vf_explained_var": 0.9867014390726884, "kl": 0.011137147900240053, "entropy": 1.907278211042285, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -5.157884371271983, "episode_reward_min": -1494.709637385832, "episode_reward_mean": -728.5107922132153, "episode_len_mean": 129.16, "episode_media": {}, "episodes_timesteps_total": 12916, "policy_reward_min": {"policy_0": -1494.709637385832}, "policy_reward_max": {"policy_0": -5.157884371271983}, "policy_reward_mean": {"policy_0": -728.5107922132153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.38300735300123, -1020.7238775833024, -506.9065080294871, -1196.6669630075244, -1060.5329024152563, -808.1934868870648, -747.1435785744109, -1042.8891551886945, -1102.9506586122077, -1225.1275977303399, -631.4677443873932, -118.60006273496602, -1494.709637385832, -235.96840679434322, -1003.6915397159801, -754.9607559328755, -893.9023689211975, -30.030062366860637, -99.43333199541084, -934.820493830895, -491.58531217383216, -28.481496083677598, -665.0768019900413, -1407.5152372534458, -993.1289361556672, -128.53404047275697, -916.5094180689836, -823.6410390086705, -725.8103710736215, -305.7600783187977, -1261.2806557044817, -1073.4846458200916, -997.7315078260395, -823.2934145265466, -663.251427150997, -1441.7454755824535, -979.59012084489, -1233.7732538966247, -904.2436774821879, -699.1821376992156, -227.56424421865344, -940.430202906813, -1233.963587491492, -364.62665690674066, -924.7013939223735, -691.1453334964344, -181.42372135673503, -1057.165525759314, -115.24174813429028, -937.8717991978598, -951.3814901076306, -325.7979903643566, -1375.7158789340683, -1040.1591595100847, -534.0711677368716, -816.0034144281734, -541.9119432577065, -970.6393298580272, -1128.3080770394836, -1452.3369339283731, -431.6313557582752, -300.9799714212018, -71.84232214085502, -1123.4569054733593, -530.9975428630339, -641.6000228909612, -371.22036525681284, -890.8190931038883, -1084.8836598892492, -1085.0854548661716, -105.93710954898634, -1019.1213419360816, -278.30089537987806, -155.9072551410886, -1224.8375743830481, -419.4619971896665, -380.7099039986797, -81.78909851221495, -1054.4485855222588, -184.176021768816, -99.94416039334324, -740.1083623726535, -670.0519524955753, -970.7091903863445, -315.1114259391763, -1260.2674236679507, -242.28920327846495, -982.4481122744176, -792.8270600342967, -513.6435872254666, -611.6792658474246, -182.48955567886625, -862.8264867190946, -587.4482749772667, -685.009737992549, -1487.4929079577867, -905.5740045828455, -1066.5967659497244, -5.157884371271983, -964.0165969969412], "episode_lengths": [81, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 61, 150, 109, 150, 150, 150, 59, 69, 150, 150, 44, 150, 150, 150, 50, 150, 150, 150, 87, 150, 150, 150, 150, 149, 150, 150, 150, 150, 130, 106, 150, 150, 90, 150, 145, 63, 150, 92, 150, 150, 97, 150, 150, 150, 150, 107, 150, 150, 150, 121, 125, 41, 150, 150, 150, 103, 150, 150, 150, 59, 150, 99, 86, 150, 98, 93, 57, 150, 75, 60, 150, 150, 150, 115, 150, 95, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 37, 150], "policy_policy_0_reward": [-185.38300735300123, -1020.7238775833024, -506.9065080294871, -1196.6669630075244, -1060.5329024152563, -808.1934868870648, -747.1435785744109, -1042.8891551886945, -1102.9506586122077, -1225.1275977303399, -631.4677443873932, -118.60006273496602, -1494.709637385832, -235.96840679434322, -1003.6915397159801, -754.9607559328755, -893.9023689211975, -30.030062366860637, -99.43333199541084, -934.820493830895, -491.58531217383216, -28.481496083677598, -665.0768019900413, -1407.5152372534458, -993.1289361556672, -128.53404047275697, -916.5094180689836, -823.6410390086705, -725.8103710736215, -305.7600783187977, -1261.2806557044817, -1073.4846458200916, -997.7315078260395, -823.2934145265466, -663.251427150997, -1441.7454755824535, -979.59012084489, -1233.7732538966247, -904.2436774821879, -699.1821376992156, -227.56424421865344, -940.430202906813, -1233.963587491492, -364.62665690674066, -924.7013939223735, -691.1453334964344, -181.42372135673503, -1057.165525759314, -115.24174813429028, -937.8717991978598, -951.3814901076306, -325.7979903643566, -1375.7158789340683, -1040.1591595100847, -534.0711677368716, -816.0034144281734, -541.9119432577065, -970.6393298580272, -1128.3080770394836, -1452.3369339283731, -431.6313557582752, -300.9799714212018, -71.84232214085502, -1123.4569054733593, -530.9975428630339, -641.6000228909612, -371.22036525681284, -890.8190931038883, -1084.8836598892492, -1085.0854548661716, -105.93710954898634, -1019.1213419360816, -278.30089537987806, -155.9072551410886, -1224.8375743830481, -419.4619971896665, -380.7099039986797, -81.78909851221495, -1054.4485855222588, -184.176021768816, -99.94416039334324, -740.1083623726535, -670.0519524955753, -970.7091903863445, -315.1114259391763, -1260.2674236679507, -242.28920327846495, -982.4481122744176, -792.8270600342967, -513.6435872254666, -611.6792658474246, -182.48955567886625, -862.8264867190946, -587.4482749772667, -685.009737992549, -1487.4929079577867, -905.5740045828455, -1066.5967659497244, -5.157884371271983, -964.0165969969412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552981418421253, "mean_inference_ms": 1.7236721048636203, "mean_action_processing_ms": 0.2750450204769923, "mean_env_wait_ms": 3.416524353898349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012804508209228516, "StateBufferConnector_ms": 0.007953882217407227, "ViewRequirementAgentConnector_ms": 0.19359040260314941}, "num_episodes": 32, "episode_return_max": -5.157884371271983, "episode_return_min": -1494.709637385832, "episode_return_mean": -728.5107922132153, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.95513839625653, "num_env_steps_trained_throughput_per_sec": 313.95513839625653, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12624.237, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12624.167, "sample_time_ms": 1133.014, "learn_time_ms": 11424.943, "learn_throughput": 350.111, "synch_weights_time_ms": 65.401}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "1e132_00002", "date": "2024-08-04_07-53-02", "timestamp": 1722738182, "time_this_iter_s": 12.752331733703613, "time_total_s": 564.1348736286163, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac137eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 564.1348736286163, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.09444444444444, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 242.12223953604698, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.4553938704232374, "policy_loss": -0.010453169270961855, "vf_loss": 2.4578049920499323, "vf_explained_var": 0.9910226229578256, "kl": 0.012237261793173627, "entropy": 2.180989947170019, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -5.157884371271983, "episode_reward_min": -1487.4929079577867, "episode_reward_mean": -732.8169887620415, "episode_len_mean": 130.96, "episode_media": {}, "episodes_timesteps_total": 13096, "policy_reward_min": {"policy_0": -1487.4929079577867}, "policy_reward_max": {"policy_0": -5.157884371271983}, "policy_reward_mean": {"policy_0": -732.8169887620415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1261.2806557044817, -1073.4846458200916, -997.7315078260395, -823.2934145265466, -663.251427150997, -1441.7454755824535, -979.59012084489, -1233.7732538966247, -904.2436774821879, -699.1821376992156, -227.56424421865344, -940.430202906813, -1233.963587491492, -364.62665690674066, -924.7013939223735, -691.1453334964344, -181.42372135673503, -1057.165525759314, -115.24174813429028, -937.8717991978598, -951.3814901076306, -325.7979903643566, -1375.7158789340683, -1040.1591595100847, -534.0711677368716, -816.0034144281734, -541.9119432577065, -970.6393298580272, -1128.3080770394836, -1452.3369339283731, -431.6313557582752, -300.9799714212018, -71.84232214085502, -1123.4569054733593, -530.9975428630339, -641.6000228909612, -371.22036525681284, -890.8190931038883, -1084.8836598892492, -1085.0854548661716, -105.93710954898634, -1019.1213419360816, -278.30089537987806, -155.9072551410886, -1224.8375743830481, -419.4619971896665, -380.7099039986797, -81.78909851221495, -1054.4485855222588, -184.176021768816, -99.94416039334324, -740.1083623726535, -670.0519524955753, -970.7091903863445, -315.1114259391763, -1260.2674236679507, -242.28920327846495, -982.4481122744176, -792.8270600342967, -513.6435872254666, -611.6792658474246, -182.48955567886625, -862.8264867190946, -587.4482749772667, -685.009737992549, -1487.4929079577867, -905.5740045828455, -1066.5967659497244, -5.157884371271983, -964.0165969969412, -438.25806261952255, -1147.9474885570944, -230.60965084283905, -838.3279064951065, -912.4438740104305, -1250.336197603193, -774.9556923153315, -1139.7050835508571, -574.0573237650534, -583.5255900855957, -227.27936468658007, -827.0485661613392, -459.2242573712656, -462.50178963204104, -1373.1115459092998, -54.29041766456861, -1478.9297415317337, -1118.5527192606182, -258.20357258949264, -851.5515859079168, -1110.91410929095, -92.38796864036813, -1427.1399325195832, -329.3580302535639, -1308.4854066633568, -679.7436123685067, -522.7847180553999, -655.0489720906254, -464.40593819924, -419.63540628770477], "episode_lengths": [150, 150, 150, 150, 149, 150, 150, 150, 150, 130, 106, 150, 150, 90, 150, 145, 63, 150, 92, 150, 150, 97, 150, 150, 150, 150, 107, 150, 150, 150, 121, 125, 41, 150, 150, 150, 103, 150, 150, 150, 59, 150, 99, 86, 150, 98, 93, 57, 150, 75, 60, 150, 150, 150, 115, 150, 95, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 37, 150, 126, 150, 91, 150, 150, 150, 150, 150, 134, 123, 90, 150, 150, 142, 150, 41, 150, 150, 96, 150, 150, 92, 150, 114, 150, 150, 150, 150, 150, 125], "policy_policy_0_reward": [-1261.2806557044817, -1073.4846458200916, -997.7315078260395, -823.2934145265466, -663.251427150997, -1441.7454755824535, -979.59012084489, -1233.7732538966247, -904.2436774821879, -699.1821376992156, -227.56424421865344, -940.430202906813, -1233.963587491492, -364.62665690674066, -924.7013939223735, -691.1453334964344, -181.42372135673503, -1057.165525759314, -115.24174813429028, -937.8717991978598, -951.3814901076306, -325.7979903643566, -1375.7158789340683, -1040.1591595100847, -534.0711677368716, -816.0034144281734, -541.9119432577065, -970.6393298580272, -1128.3080770394836, -1452.3369339283731, -431.6313557582752, -300.9799714212018, -71.84232214085502, -1123.4569054733593, -530.9975428630339, -641.6000228909612, -371.22036525681284, -890.8190931038883, -1084.8836598892492, -1085.0854548661716, -105.93710954898634, -1019.1213419360816, -278.30089537987806, -155.9072551410886, -1224.8375743830481, -419.4619971896665, -380.7099039986797, -81.78909851221495, -1054.4485855222588, -184.176021768816, -99.94416039334324, -740.1083623726535, -670.0519524955753, -970.7091903863445, -315.1114259391763, -1260.2674236679507, -242.28920327846495, -982.4481122744176, -792.8270600342967, -513.6435872254666, -611.6792658474246, -182.48955567886625, -862.8264867190946, -587.4482749772667, -685.009737992549, -1487.4929079577867, -905.5740045828455, -1066.5967659497244, -5.157884371271983, -964.0165969969412, -438.25806261952255, -1147.9474885570944, -230.60965084283905, -838.3279064951065, -912.4438740104305, -1250.336197603193, -774.9556923153315, -1139.7050835508571, -574.0573237650534, -583.5255900855957, -227.27936468658007, -827.0485661613392, -459.2242573712656, -462.50178963204104, -1373.1115459092998, -54.29041766456861, -1478.9297415317337, -1118.5527192606182, -258.20357258949264, -851.5515859079168, -1110.91410929095, -92.38796864036813, -1427.1399325195832, -329.3580302535639, -1308.4854066633568, -679.7436123685067, -522.7847180553999, -655.0489720906254, -464.40593819924, -419.63540628770477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551300512413045, "mean_inference_ms": 1.7219634436065596, "mean_action_processing_ms": 0.27499679861761545, "mean_env_wait_ms": 3.418315532931897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012642145156860352, "StateBufferConnector_ms": 0.008260726928710938, "ViewRequirementAgentConnector_ms": 0.19475245475769043}, "num_episodes": 30, "episode_return_max": -5.157884371271983, "episode_return_min": -1487.4929079577867, "episode_return_mean": -732.8169887620415, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.199061009702, "num_env_steps_trained_throughput_per_sec": 305.199061009702, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12621.923, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12621.853, "sample_time_ms": 1132.469, "learn_time_ms": 11423.111, "learn_throughput": 350.167, "synch_weights_time_ms": 65.461}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "1e132_00002", "date": "2024-08-04_07-53-15", "timestamp": 1722738195, "time_this_iter_s": 13.118920087814331, "time_total_s": 577.2537937164307, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac136320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 577.2537937164307, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.873684210526314, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 274.27324973344804, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.8347083480407793, "policy_loss": -0.005775534907297697, "vf_loss": 2.83261615515997, "vf_explained_var": 0.977307996340096, "kl": 0.011970514043362877, "entropy": 2.1237578678876163, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -5.157884371271983, "episode_reward_min": -1497.6262063659472, "episode_reward_mean": -708.4690919189733, "episode_len_mean": 128.73, "episode_media": {}, "episodes_timesteps_total": 12873, "policy_reward_min": {"policy_0": -1497.6262063659472}, "policy_reward_max": {"policy_0": -5.157884371271983}, "policy_reward_mean": {"policy_0": -708.4690919189733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-431.6313557582752, -300.9799714212018, -71.84232214085502, -1123.4569054733593, -530.9975428630339, -641.6000228909612, -371.22036525681284, -890.8190931038883, -1084.8836598892492, -1085.0854548661716, -105.93710954898634, -1019.1213419360816, -278.30089537987806, -155.9072551410886, -1224.8375743830481, -419.4619971896665, -380.7099039986797, -81.78909851221495, -1054.4485855222588, -184.176021768816, -99.94416039334324, -740.1083623726535, -670.0519524955753, -970.7091903863445, -315.1114259391763, -1260.2674236679507, -242.28920327846495, -982.4481122744176, -792.8270600342967, -513.6435872254666, -611.6792658474246, -182.48955567886625, -862.8264867190946, -587.4482749772667, -685.009737992549, -1487.4929079577867, -905.5740045828455, -1066.5967659497244, -5.157884371271983, -964.0165969969412, -438.25806261952255, -1147.9474885570944, -230.60965084283905, -838.3279064951065, -912.4438740104305, -1250.336197603193, -774.9556923153315, -1139.7050835508571, -574.0573237650534, -583.5255900855957, -227.27936468658007, -827.0485661613392, -459.2242573712656, -462.50178963204104, -1373.1115459092998, -54.29041766456861, -1478.9297415317337, -1118.5527192606182, -258.20357258949264, -851.5515859079168, -1110.91410929095, -92.38796864036813, -1427.1399325195832, -329.3580302535639, -1308.4854066633568, -679.7436123685067, -522.7847180553999, -655.0489720906254, -464.40593819924, -419.63540628770477, -1340.6690688928772, -1373.9121595648085, -1073.96555602985, -1284.4064892176157, -700.9385453652737, -872.2676593933322, -960.9765218158548, -678.2068686480243, -399.3310527079338, -118.95609015403885, -1453.3812156584972, -34.26004381789962, -227.41226391479185, -1151.3576442371673, -217.47903509384548, -447.31682154617465, -1497.6262063659472, -1201.6941927381695, -354.524208507881, -350.60083723366967, -1466.7226691466144, -761.4277660378252, -519.7640326446625, -1019.1943037490166, -818.3920689471674, -578.053964383932, -714.5282188844433, -215.27487040826517, -415.5609240120058, -1205.0449316645734], "episode_lengths": [121, 125, 41, 150, 150, 150, 103, 150, 150, 150, 59, 150, 99, 86, 150, 98, 93, 57, 150, 75, 60, 150, 150, 150, 115, 150, 95, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 37, 150, 126, 150, 91, 150, 150, 150, 150, 150, 134, 123, 90, 150, 150, 142, 150, 41, 150, 150, 96, 150, 150, 92, 150, 114, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 127, 150, 150, 150, 150, 53, 150, 45, 72, 150, 111, 101, 150, 150, 92, 89, 150, 150, 150, 150, 147, 150, 150, 94, 125, 150], "policy_policy_0_reward": [-431.6313557582752, -300.9799714212018, -71.84232214085502, -1123.4569054733593, -530.9975428630339, -641.6000228909612, -371.22036525681284, -890.8190931038883, -1084.8836598892492, -1085.0854548661716, -105.93710954898634, -1019.1213419360816, -278.30089537987806, -155.9072551410886, -1224.8375743830481, -419.4619971896665, -380.7099039986797, -81.78909851221495, -1054.4485855222588, -184.176021768816, -99.94416039334324, -740.1083623726535, -670.0519524955753, -970.7091903863445, -315.1114259391763, -1260.2674236679507, -242.28920327846495, -982.4481122744176, -792.8270600342967, -513.6435872254666, -611.6792658474246, -182.48955567886625, -862.8264867190946, -587.4482749772667, -685.009737992549, -1487.4929079577867, -905.5740045828455, -1066.5967659497244, -5.157884371271983, -964.0165969969412, -438.25806261952255, -1147.9474885570944, -230.60965084283905, -838.3279064951065, -912.4438740104305, -1250.336197603193, -774.9556923153315, -1139.7050835508571, -574.0573237650534, -583.5255900855957, -227.27936468658007, -827.0485661613392, -459.2242573712656, -462.50178963204104, -1373.1115459092998, -54.29041766456861, -1478.9297415317337, -1118.5527192606182, -258.20357258949264, -851.5515859079168, -1110.91410929095, -92.38796864036813, -1427.1399325195832, -329.3580302535639, -1308.4854066633568, -679.7436123685067, -522.7847180553999, -655.0489720906254, -464.40593819924, -419.63540628770477, -1340.6690688928772, -1373.9121595648085, -1073.96555602985, -1284.4064892176157, -700.9385453652737, -872.2676593933322, -960.9765218158548, -678.2068686480243, -399.3310527079338, -118.95609015403885, -1453.3812156584972, -34.26004381789962, -227.41226391479185, -1151.3576442371673, -217.47903509384548, -447.31682154617465, -1497.6262063659472, -1201.6941927381695, -354.524208507881, -350.60083723366967, -1466.7226691466144, -761.4277660378252, -519.7640326446625, -1019.1943037490166, -818.3920689471674, -578.053964383932, -714.5282188844433, -215.27487040826517, -415.5609240120058, -1205.0449316645734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548825044376943, "mean_inference_ms": 1.7208462143150143, "mean_action_processing_ms": 0.27497584984211093, "mean_env_wait_ms": 3.421703523641433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012166738510131836, "StateBufferConnector_ms": 0.00824737548828125, "ViewRequirementAgentConnector_ms": 0.1943659782409668}, "num_episodes": 30, "episode_return_max": -5.157884371271983, "episode_return_min": -1497.6262063659472, "episode_return_mean": -708.4690919189733, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.93113739070327, "num_env_steps_trained_throughput_per_sec": 306.93113739070327, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12614.471, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12614.4, "sample_time_ms": 1137.554, "learn_time_ms": 11410.866, "learn_throughput": 350.543, "synch_weights_time_ms": 65.17}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "1e132_00002", "date": "2024-08-04_07-53-28", "timestamp": 1722738208, "time_this_iter_s": 13.044787168502808, "time_total_s": 590.2985808849335, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bc820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 590.2985808849335, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.810526315789474, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 259.48536939819655, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.2972724206745623, "policy_loss": -0.008470754629039826, "vf_loss": 2.2956160904839633, "vf_explained_var": 0.9941540041938424, "kl": 0.015298339743071664, "entropy": 1.9929629971583684, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -5.157884371271983, "episode_reward_min": -1499.7389114470643, "episode_reward_mean": -775.0513086521773, "episode_len_mean": 133.51, "episode_media": {}, "episodes_timesteps_total": 13351, "policy_reward_min": {"policy_0": -1499.7389114470643}, "policy_reward_max": {"policy_0": -5.157884371271983}, "policy_reward_mean": {"policy_0": -775.0513086521773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-611.6792658474246, -182.48955567886625, -862.8264867190946, -587.4482749772667, -685.009737992549, -1487.4929079577867, -905.5740045828455, -1066.5967659497244, -5.157884371271983, -964.0165969969412, -438.25806261952255, -1147.9474885570944, -230.60965084283905, -838.3279064951065, -912.4438740104305, -1250.336197603193, -774.9556923153315, -1139.7050835508571, -574.0573237650534, -583.5255900855957, -227.27936468658007, -827.0485661613392, -459.2242573712656, -462.50178963204104, -1373.1115459092998, -54.29041766456861, -1478.9297415317337, -1118.5527192606182, -258.20357258949264, -851.5515859079168, -1110.91410929095, -92.38796864036813, -1427.1399325195832, -329.3580302535639, -1308.4854066633568, -679.7436123685067, -522.7847180553999, -655.0489720906254, -464.40593819924, -419.63540628770477, -1340.6690688928772, -1373.9121595648085, -1073.96555602985, -1284.4064892176157, -700.9385453652737, -872.2676593933322, -960.9765218158548, -678.2068686480243, -399.3310527079338, -118.95609015403885, -1453.3812156584972, -34.26004381789962, -227.41226391479185, -1151.3576442371673, -217.47903509384548, -447.31682154617465, -1497.6262063659472, -1201.6941927381695, -354.524208507881, -350.60083723366967, -1466.7226691466144, -761.4277660378252, -519.7640326446625, -1019.1943037490166, -818.3920689471674, -578.053964383932, -714.5282188844433, -215.27487040826517, -415.5609240120058, -1205.0449316645734, -852.4830098237333, -1407.3224143264092, -1093.448754123705, -457.49229729738545, -1044.5825070999742, -597.6425063047446, -988.1139235710833, -1234.8413218659766, -879.8603893109596, -1187.6306953916526, -16.541322235531894, -294.1002083264923, -714.5667535801672, -1093.764362703417, -219.6375326750196, -1004.837181615554, -270.79517279202526, -1149.2912642667388, -840.8676058514889, -935.6414166770359, -1035.458323358211, -554.8569739001192, -844.0112578608548, -1062.7319922426523, -882.582273055415, -1205.923023941664, -237.63621388023344, -1499.7389114470643, -615.4393801547296, -460.98963875260904], "episode_lengths": [150, 79, 150, 150, 150, 150, 150, 150, 37, 150, 126, 150, 91, 150, 150, 150, 150, 150, 134, 123, 90, 150, 150, 142, 150, 41, 150, 150, 96, 150, 150, 92, 150, 114, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 127, 150, 150, 150, 150, 53, 150, 45, 72, 150, 111, 101, 150, 150, 92, 89, 150, 150, 150, 150, 147, 150, 150, 94, 125, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 46, 108, 150, 150, 89, 150, 75, 150, 150, 150, 150, 138, 150, 150, 150, 150, 85, 150, 150, 150], "policy_policy_0_reward": [-611.6792658474246, -182.48955567886625, -862.8264867190946, -587.4482749772667, -685.009737992549, -1487.4929079577867, -905.5740045828455, -1066.5967659497244, -5.157884371271983, -964.0165969969412, -438.25806261952255, -1147.9474885570944, -230.60965084283905, -838.3279064951065, -912.4438740104305, -1250.336197603193, -774.9556923153315, -1139.7050835508571, -574.0573237650534, -583.5255900855957, -227.27936468658007, -827.0485661613392, -459.2242573712656, -462.50178963204104, -1373.1115459092998, -54.29041766456861, -1478.9297415317337, -1118.5527192606182, -258.20357258949264, -851.5515859079168, -1110.91410929095, -92.38796864036813, -1427.1399325195832, -329.3580302535639, -1308.4854066633568, -679.7436123685067, -522.7847180553999, -655.0489720906254, -464.40593819924, -419.63540628770477, -1340.6690688928772, -1373.9121595648085, -1073.96555602985, -1284.4064892176157, -700.9385453652737, -872.2676593933322, -960.9765218158548, -678.2068686480243, -399.3310527079338, -118.95609015403885, -1453.3812156584972, -34.26004381789962, -227.41226391479185, -1151.3576442371673, -217.47903509384548, -447.31682154617465, -1497.6262063659472, -1201.6941927381695, -354.524208507881, -350.60083723366967, -1466.7226691466144, -761.4277660378252, -519.7640326446625, -1019.1943037490166, -818.3920689471674, -578.053964383932, -714.5282188844433, -215.27487040826517, -415.5609240120058, -1205.0449316645734, -852.4830098237333, -1407.3224143264092, -1093.448754123705, -457.49229729738545, -1044.5825070999742, -597.6425063047446, -988.1139235710833, -1234.8413218659766, -879.8603893109596, -1187.6306953916526, -16.541322235531894, -294.1002083264923, -714.5667535801672, -1093.764362703417, -219.6375326750196, -1004.837181615554, -270.79517279202526, -1149.2912642667388, -840.8676058514889, -935.6414166770359, -1035.458323358211, -554.8569739001192, -844.0112578608548, -1062.7319922426523, -882.582273055415, -1205.923023941664, -237.63621388023344, -1499.7389114470643, -615.4393801547296, -460.98963875260904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546512349550827, "mean_inference_ms": 1.719095064398245, "mean_action_processing_ms": 0.2747851378284784, "mean_env_wait_ms": 3.4234234166276303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011822700500488281, "StateBufferConnector_ms": 0.008149385452270508, "ViewRequirementAgentConnector_ms": 0.19118666648864746}, "num_episodes": 30, "episode_return_max": -5.157884371271983, "episode_return_min": -1499.7389114470643, "episode_return_mean": -775.0513086521773, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.3543083342309, "num_env_steps_trained_throughput_per_sec": 303.3543083342309, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12841.365, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12841.293, "sample_time_ms": 1146.571, "learn_time_ms": 11628.468, "learn_throughput": 343.983, "synch_weights_time_ms": 65.443}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "1e132_00002", "date": "2024-08-04_07-53-41", "timestamp": 1722738221, "time_this_iter_s": 13.197619199752808, "time_total_s": 603.4962000846863, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1369e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 603.4962000846863, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.91111111111111, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 281.5705833653609, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.3476825817177693, "policy_loss": -0.007612277234632832, "vf_loss": 2.3447538329909245, "vf_explained_var": 0.9927855185543497, "kl": 0.015918251344798337, "entropy": 2.037908613681793, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -16.541322235531894, "episode_reward_min": -1499.7389114470643, "episode_reward_mean": -766.3489563108285, "episode_len_mean": 132.11, "episode_media": {}, "episodes_timesteps_total": 13211, "policy_reward_min": {"policy_0": -1499.7389114470643}, "policy_reward_max": {"policy_0": -16.541322235531894}, "policy_reward_mean": {"policy_0": -766.3489563108285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.3580302535639, -1308.4854066633568, -679.7436123685067, -522.7847180553999, -655.0489720906254, -464.40593819924, -419.63540628770477, -1340.6690688928772, -1373.9121595648085, -1073.96555602985, -1284.4064892176157, -700.9385453652737, -872.2676593933322, -960.9765218158548, -678.2068686480243, -399.3310527079338, -118.95609015403885, -1453.3812156584972, -34.26004381789962, -227.41226391479185, -1151.3576442371673, -217.47903509384548, -447.31682154617465, -1497.6262063659472, -1201.6941927381695, -354.524208507881, -350.60083723366967, -1466.7226691466144, -761.4277660378252, -519.7640326446625, -1019.1943037490166, -818.3920689471674, -578.053964383932, -714.5282188844433, -215.27487040826517, -415.5609240120058, -1205.0449316645734, -852.4830098237333, -1407.3224143264092, -1093.448754123705, -457.49229729738545, -1044.5825070999742, -597.6425063047446, -988.1139235710833, -1234.8413218659766, -879.8603893109596, -1187.6306953916526, -16.541322235531894, -294.1002083264923, -714.5667535801672, -1093.764362703417, -219.6375326750196, -1004.837181615554, -270.79517279202526, -1149.2912642667388, -840.8676058514889, -935.6414166770359, -1035.458323358211, -554.8569739001192, -844.0112578608548, -1062.7319922426523, -882.582273055415, -1205.923023941664, -237.63621388023344, -1499.7389114470643, -615.4393801547296, -460.98963875260904, -651.1642589369601, -1255.9255065235664, -102.65132696043867, -845.5443315613619, -934.4473771102363, -999.3239099801915, -826.8834978044474, -1233.4799550965945, -1231.1788073398768, -910.6527358749884, -1223.4325630078956, -914.2069331083769, -1234.8510179253285, -1033.854417259485, -428.4349035455431, -1255.7361168545835, -1461.807605281342, -147.0253824796072, -1131.2122806106138, -1136.2313827080409, -198.71216620407677, -582.7031405070281, -392.8358227555377, -179.37391653383773, -494.15581572750034, -1111.4211790316565, -489.2131438667193, -189.80021811861266, -78.97588305530074, -754.082947976657, -96.99231663863323, -432.9374405437223, -160.11038702089652], "episode_lengths": [114, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 127, 150, 150, 150, 150, 53, 150, 45, 72, 150, 111, 101, 150, 150, 92, 89, 150, 150, 150, 150, 147, 150, 150, 94, 125, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 46, 108, 150, 150, 89, 150, 75, 150, 150, 150, 150, 138, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 86, 150, 127, 76, 134, 150, 124, 66, 59, 150, 69, 120, 72], "policy_policy_0_reward": [-329.3580302535639, -1308.4854066633568, -679.7436123685067, -522.7847180553999, -655.0489720906254, -464.40593819924, -419.63540628770477, -1340.6690688928772, -1373.9121595648085, -1073.96555602985, -1284.4064892176157, -700.9385453652737, -872.2676593933322, -960.9765218158548, -678.2068686480243, -399.3310527079338, -118.95609015403885, -1453.3812156584972, -34.26004381789962, -227.41226391479185, -1151.3576442371673, -217.47903509384548, -447.31682154617465, -1497.6262063659472, -1201.6941927381695, -354.524208507881, -350.60083723366967, -1466.7226691466144, -761.4277660378252, -519.7640326446625, -1019.1943037490166, -818.3920689471674, -578.053964383932, -714.5282188844433, -215.27487040826517, -415.5609240120058, -1205.0449316645734, -852.4830098237333, -1407.3224143264092, -1093.448754123705, -457.49229729738545, -1044.5825070999742, -597.6425063047446, -988.1139235710833, -1234.8413218659766, -879.8603893109596, -1187.6306953916526, -16.541322235531894, -294.1002083264923, -714.5667535801672, -1093.764362703417, -219.6375326750196, -1004.837181615554, -270.79517279202526, -1149.2912642667388, -840.8676058514889, -935.6414166770359, -1035.458323358211, -554.8569739001192, -844.0112578608548, -1062.7319922426523, -882.582273055415, -1205.923023941664, -237.63621388023344, -1499.7389114470643, -615.4393801547296, -460.98963875260904, -651.1642589369601, -1255.9255065235664, -102.65132696043867, -845.5443315613619, -934.4473771102363, -999.3239099801915, -826.8834978044474, -1233.4799550965945, -1231.1788073398768, -910.6527358749884, -1223.4325630078956, -914.2069331083769, -1234.8510179253285, -1033.854417259485, -428.4349035455431, -1255.7361168545835, -1461.807605281342, -147.0253824796072, -1131.2122806106138, -1136.2313827080409, -198.71216620407677, -582.7031405070281, -392.8358227555377, -179.37391653383773, -494.15581572750034, -1111.4211790316565, -489.2131438667193, -189.80021811861266, -78.97588305530074, -754.082947976657, -96.99231663863323, -432.9374405437223, -160.11038702089652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548796409605607, "mean_inference_ms": 1.7181266738933736, "mean_action_processing_ms": 0.2746829006591121, "mean_env_wait_ms": 3.4261946816916327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011876106262207031, "StateBufferConnector_ms": 0.00794839859008789, "ViewRequirementAgentConnector_ms": 0.19139838218688965}, "num_episodes": 33, "episode_return_max": -16.541322235531894, "episode_return_min": -1499.7389114470643, "episode_return_mean": -766.3489563108285, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.98535723936925, "num_env_steps_trained_throughput_per_sec": 311.98535723936925, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12828.774, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12828.7, "sample_time_ms": 1155.056, "learn_time_ms": 11605.854, "learn_throughput": 344.654, "synch_weights_time_ms": 66.938}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "1e132_00002", "date": "2024-08-04_07-53-54", "timestamp": 1722738234, "time_this_iter_s": 12.835049390792847, "time_total_s": 616.3312494754791, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac120f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.3312494754791, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.915789473684214, "ram_util_percent": 28.210526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 258.65477488040926, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.043732861243188, "policy_loss": -0.014715548634558217, "vf_loss": 2.049510856842001, "vf_explained_var": 0.9961899462466438, "kl": 0.013530074249138168, "entropy": 1.9524138137698173, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -9.728496491052384, "episode_reward_min": -1499.7389114470643, "episode_reward_mean": -735.4521606935205, "episode_len_mean": 129.8, "episode_media": {}, "episodes_timesteps_total": 12980, "policy_reward_min": {"policy_0": -1499.7389114470643}, "policy_reward_max": {"policy_0": -9.728496491052384}, "policy_reward_mean": {"policy_0": -735.4521606935205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1019.1943037490166, -818.3920689471674, -578.053964383932, -714.5282188844433, -215.27487040826517, -415.5609240120058, -1205.0449316645734, -852.4830098237333, -1407.3224143264092, -1093.448754123705, -457.49229729738545, -1044.5825070999742, -597.6425063047446, -988.1139235710833, -1234.8413218659766, -879.8603893109596, -1187.6306953916526, -16.541322235531894, -294.1002083264923, -714.5667535801672, -1093.764362703417, -219.6375326750196, -1004.837181615554, -270.79517279202526, -1149.2912642667388, -840.8676058514889, -935.6414166770359, -1035.458323358211, -554.8569739001192, -844.0112578608548, -1062.7319922426523, -882.582273055415, -1205.923023941664, -237.63621388023344, -1499.7389114470643, -615.4393801547296, -460.98963875260904, -651.1642589369601, -1255.9255065235664, -102.65132696043867, -845.5443315613619, -934.4473771102363, -999.3239099801915, -826.8834978044474, -1233.4799550965945, -1231.1788073398768, -910.6527358749884, -1223.4325630078956, -914.2069331083769, -1234.8510179253285, -1033.854417259485, -428.4349035455431, -1255.7361168545835, -1461.807605281342, -147.0253824796072, -1131.2122806106138, -1136.2313827080409, -198.71216620407677, -582.7031405070281, -392.8358227555377, -179.37391653383773, -494.15581572750034, -1111.4211790316565, -489.2131438667193, -189.80021811861266, -78.97588305530074, -754.082947976657, -96.99231663863323, -432.9374405437223, -160.11038702089652, -264.1184960326195, -305.20837794064494, -207.65465314863923, -139.1057668078261, -9.728496491052384, -566.4262817425355, -263.8088944750172, -274.65572023413944, -108.6153651355919, -955.4305403656201, -1191.0806522338687, -675.8138267338431, -431.9179908714614, -1297.785067539103, -1173.6550436209398, -1000.6501235001939, -636.4080188300626, -1048.049376690204, -103.87314074834332, -48.08166202890629, -982.8541158853915, -815.159431425904, -817.0668285679566, -294.3523496338755, -640.3873944256837, -937.8258866894079, -1026.8434105474712, -1346.3990952276622, -878.6738213465824, -1335.3496419997737], "episode_lengths": [150, 147, 150, 150, 94, 125, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 46, 108, 150, 150, 89, 150, 75, 150, 150, 150, 150, 138, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 86, 150, 127, 76, 134, 150, 124, 66, 59, 150, 69, 120, 72, 110, 84, 95, 52, 36, 150, 102, 99, 60, 150, 150, 150, 125, 150, 150, 150, 150, 150, 58, 53, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1019.1943037490166, -818.3920689471674, -578.053964383932, -714.5282188844433, -215.27487040826517, -415.5609240120058, -1205.0449316645734, -852.4830098237333, -1407.3224143264092, -1093.448754123705, -457.49229729738545, -1044.5825070999742, -597.6425063047446, -988.1139235710833, -1234.8413218659766, -879.8603893109596, -1187.6306953916526, -16.541322235531894, -294.1002083264923, -714.5667535801672, -1093.764362703417, -219.6375326750196, -1004.837181615554, -270.79517279202526, -1149.2912642667388, -840.8676058514889, -935.6414166770359, -1035.458323358211, -554.8569739001192, -844.0112578608548, -1062.7319922426523, -882.582273055415, -1205.923023941664, -237.63621388023344, -1499.7389114470643, -615.4393801547296, -460.98963875260904, -651.1642589369601, -1255.9255065235664, -102.65132696043867, -845.5443315613619, -934.4473771102363, -999.3239099801915, -826.8834978044474, -1233.4799550965945, -1231.1788073398768, -910.6527358749884, -1223.4325630078956, -914.2069331083769, -1234.8510179253285, -1033.854417259485, -428.4349035455431, -1255.7361168545835, -1461.807605281342, -147.0253824796072, -1131.2122806106138, -1136.2313827080409, -198.71216620407677, -582.7031405070281, -392.8358227555377, -179.37391653383773, -494.15581572750034, -1111.4211790316565, -489.2131438667193, -189.80021811861266, -78.97588305530074, -754.082947976657, -96.99231663863323, -432.9374405437223, -160.11038702089652, -264.1184960326195, -305.20837794064494, -207.65465314863923, -139.1057668078261, -9.728496491052384, -566.4262817425355, -263.8088944750172, -274.65572023413944, -108.6153651355919, -955.4305403656201, -1191.0806522338687, -675.8138267338431, -431.9179908714614, -1297.785067539103, -1173.6550436209398, -1000.6501235001939, -636.4080188300626, -1048.049376690204, -103.87314074834332, -48.08166202890629, -982.8541158853915, -815.159431425904, -817.0668285679566, -294.3523496338755, -640.3873944256837, -937.8258866894079, -1026.8434105474712, -1346.3990952276622, -878.6738213465824, -1335.3496419997737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548573342331383, "mean_inference_ms": 1.716584218972591, "mean_action_processing_ms": 0.27467676053943135, "mean_env_wait_ms": 3.4260968890726877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011724710464477539, "StateBufferConnector_ms": 0.007856130599975586, "ViewRequirementAgentConnector_ms": 0.18874788284301758}, "num_episodes": 30, "episode_return_max": -9.728496491052384, "episode_return_min": -1499.7389114470643, "episode_return_mean": -735.4521606935205, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.52309096926234, "num_env_steps_trained_throughput_per_sec": 342.52309096926234, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12737.291, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12737.218, "sample_time_ms": 1154.649, "learn_time_ms": 11515.547, "learn_throughput": 347.357, "synch_weights_time_ms": 66.163}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "1e132_00002", "date": "2024-08-04_07-54-06", "timestamp": 1722738246, "time_this_iter_s": 11.692073106765747, "time_total_s": 628.0233225822449, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1acf70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 628.0233225822449, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.0125, "ram_util_percent": 28.268749999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 364.29823635816575, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.195043080113828, "policy_loss": -0.006126227548763078, "vf_loss": 2.193020037592699, "vf_explained_var": 0.9831596914678812, "kl": 0.01237123813334625, "entropy": 2.0131941168258587, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -9.728496491052384, "episode_reward_min": -1499.7389114470643, "episode_reward_mean": -727.5904882457971, "episode_len_mean": 130.34, "episode_media": {}, "episodes_timesteps_total": 13034, "policy_reward_min": {"policy_0": -1499.7389114470643}, "policy_reward_max": {"policy_0": -9.728496491052384}, "policy_reward_mean": {"policy_0": -727.5904882457971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-882.582273055415, -1205.923023941664, -237.63621388023344, -1499.7389114470643, -615.4393801547296, -460.98963875260904, -651.1642589369601, -1255.9255065235664, -102.65132696043867, -845.5443315613619, -934.4473771102363, -999.3239099801915, -826.8834978044474, -1233.4799550965945, -1231.1788073398768, -910.6527358749884, -1223.4325630078956, -914.2069331083769, -1234.8510179253285, -1033.854417259485, -428.4349035455431, -1255.7361168545835, -1461.807605281342, -147.0253824796072, -1131.2122806106138, -1136.2313827080409, -198.71216620407677, -582.7031405070281, -392.8358227555377, -179.37391653383773, -494.15581572750034, -1111.4211790316565, -489.2131438667193, -189.80021811861266, -78.97588305530074, -754.082947976657, -96.99231663863323, -432.9374405437223, -160.11038702089652, -264.1184960326195, -305.20837794064494, -207.65465314863923, -139.1057668078261, -9.728496491052384, -566.4262817425355, -263.8088944750172, -274.65572023413944, -108.6153651355919, -955.4305403656201, -1191.0806522338687, -675.8138267338431, -431.9179908714614, -1297.785067539103, -1173.6550436209398, -1000.6501235001939, -636.4080188300626, -1048.049376690204, -103.87314074834332, -48.08166202890629, -982.8541158853915, -815.159431425904, -817.0668285679566, -294.3523496338755, -640.3873944256837, -937.8258866894079, -1026.8434105474712, -1346.3990952276622, -878.6738213465824, -1335.3496419997737, -535.0953320325797, -870.3616787968607, -460.3335320394857, -438.4492215117769, -1211.1322326403786, -1105.7005769513812, -811.7757887817639, -218.98395025683686, -975.726025576587, -530.0371527140742, -1089.4310810250197, -886.4947033685265, -806.7860918911538, -758.2628582140646, -96.4089382839295, -910.7190273505907, -386.38485269173805, -1198.186028697295, -1153.7758187904965, -907.8557289896695, -1014.277392934144, -394.28972783258513, -841.0969471202392, -126.09930691010716, -940.7829561155398, -1276.1795712736475, -921.852179689365, -1029.4264506092363, -563.8458011726215, -356.8659445985844, -1143.7843256177578], "episode_lengths": [150, 150, 85, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 86, 150, 127, 76, 134, 150, 124, 66, 59, 150, 69, 120, 72, 110, 84, 95, 52, 36, 150, 102, 99, 60, 150, 150, 150, 125, 150, 150, 150, 150, 150, 58, 53, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 114, 150, 150, 115, 150, 150, 150, 102, 150, 150, 150, 150, 150, 141, 64, 150, 120, 150, 150, 150, 150, 125, 150, 82, 150, 150, 150, 150, 150, 127, 150], "policy_policy_0_reward": [-882.582273055415, -1205.923023941664, -237.63621388023344, -1499.7389114470643, -615.4393801547296, -460.98963875260904, -651.1642589369601, -1255.9255065235664, -102.65132696043867, -845.5443315613619, -934.4473771102363, -999.3239099801915, -826.8834978044474, -1233.4799550965945, -1231.1788073398768, -910.6527358749884, -1223.4325630078956, -914.2069331083769, -1234.8510179253285, -1033.854417259485, -428.4349035455431, -1255.7361168545835, -1461.807605281342, -147.0253824796072, -1131.2122806106138, -1136.2313827080409, -198.71216620407677, -582.7031405070281, -392.8358227555377, -179.37391653383773, -494.15581572750034, -1111.4211790316565, -489.2131438667193, -189.80021811861266, -78.97588305530074, -754.082947976657, -96.99231663863323, -432.9374405437223, -160.11038702089652, -264.1184960326195, -305.20837794064494, -207.65465314863923, -139.1057668078261, -9.728496491052384, -566.4262817425355, -263.8088944750172, -274.65572023413944, -108.6153651355919, -955.4305403656201, -1191.0806522338687, -675.8138267338431, -431.9179908714614, -1297.785067539103, -1173.6550436209398, -1000.6501235001939, -636.4080188300626, -1048.049376690204, -103.87314074834332, -48.08166202890629, -982.8541158853915, -815.159431425904, -817.0668285679566, -294.3523496338755, -640.3873944256837, -937.8258866894079, -1026.8434105474712, -1346.3990952276622, -878.6738213465824, -1335.3496419997737, -535.0953320325797, -870.3616787968607, -460.3335320394857, -438.4492215117769, -1211.1322326403786, -1105.7005769513812, -811.7757887817639, -218.98395025683686, -975.726025576587, -530.0371527140742, -1089.4310810250197, -886.4947033685265, -806.7860918911538, -758.2628582140646, -96.4089382839295, -910.7190273505907, -386.38485269173805, -1198.186028697295, -1153.7758187904965, -907.8557289896695, -1014.277392934144, -394.28972783258513, -841.0969471202392, -126.09930691010716, -940.7829561155398, -1276.1795712736475, -921.852179689365, -1029.4264506092363, -563.8458011726215, -356.8659445985844, -1143.7843256177578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547902351014438, "mean_inference_ms": 1.7163383999371904, "mean_action_processing_ms": 0.2748626377297372, "mean_env_wait_ms": 3.431579711589438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012003421783447266, "StateBufferConnector_ms": 0.007914304733276367, "ViewRequirementAgentConnector_ms": 0.18995165824890137}, "num_episodes": 31, "episode_return_max": -9.728496491052384, "episode_return_min": -1499.7389114470643, "episode_return_mean": -727.5904882457971, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.1253657561752, "num_env_steps_trained_throughput_per_sec": 309.1253657561752, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12877.702, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12877.631, "sample_time_ms": 1151.742, "learn_time_ms": 11658.369, "learn_throughput": 343.101, "synch_weights_time_ms": 66.668}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "training_iteration": 50, "trial_id": "1e132_00002", "date": "2024-08-04_07-54-19", "timestamp": 1722738259, "time_this_iter_s": 12.95168161392212, "time_total_s": 640.975004196167, "pid": 605595, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.94, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bf9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 640.975004196167, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.747368421052634, "ram_util_percent": 28.294736842105266}}
