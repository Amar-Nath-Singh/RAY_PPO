{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1241298472508787, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.596061012148857, "policy_loss": -0.0049275570034903165, "vf_loss": 9.599281437198321, "vf_explained_var": 0.017393058786789577, "kl": 0.009239556213492506, "entropy": 1.4082183297723532, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -11.486806125821413, "episode_reward_min": -1309.897716489696, "episode_reward_mean": -697.7238752959589, "episode_len_mean": 121.5, "episode_media": {}, "episodes_timesteps_total": 3159, "policy_reward_min": {"policy_0": -1309.897716489696}, "policy_reward_max": {"policy_0": -11.486806125821413}, "policy_reward_mean": {"policy_0": -697.7238752959589}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1122.8612263386908, -473.338244078163, -731.8620920505065, -1089.0184842843726, -1110.8673983671397, -1052.0083407214847, -84.4126616130838, -370.85643216664454, -11.486806125821413, -1187.9817012908711, -1040.9866961705231, -46.80778653829058, -344.8364155331458, -693.2396140021646, -909.4960286951267, -897.2573702447061, -510.90237286558863, -1028.9856244987818, -382.4443588005884, -272.1573135487517, -1204.0410246522636, -757.8847440467056, -1309.897716489696, -400.86750192277754, -83.99911461610345, -1022.323688032938], "episode_lengths": [150, 110, 150, 150, 150, 150, 74, 90, 39, 150, 150, 55, 115, 150, 150, 150, 120, 150, 89, 76, 150, 150, 150, 95, 46, 150], "policy_policy_0_reward": [-1122.8612263386908, -473.338244078163, -731.8620920505065, -1089.0184842843726, -1110.8673983671397, -1052.0083407214847, -84.4126616130838, -370.85643216664454, -11.486806125821413, -1187.9817012908711, -1040.9866961705231, -46.80778653829058, -344.8364155331458, -693.2396140021646, -909.4960286951267, -897.2573702447061, -510.90237286558863, -1028.9856244987818, -382.4443588005884, -272.1573135487517, -1204.0410246522636, -757.8847440467056, -1309.897716489696, -400.86750192277754, -83.99911461610345, -1022.323688032938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5693031739628465, "mean_inference_ms": 1.6540246101977836, "mean_action_processing_ms": 0.27591026957113063, "mean_env_wait_ms": 3.354423957987086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01131296157836914, "StateBufferConnector_ms": 0.008194263164813701, "ViewRequirementAgentConnector_ms": 0.18048653235802284}, "num_episodes": 26, "episode_return_max": -11.486806125821413, "episode_return_min": -1309.897716489696, "episode_return_mean": -697.7238752959589, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.4497089216859, "num_env_steps_trained_throughput_per_sec": 308.4497089216859, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12968.088, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12968.023, "sample_time_ms": 1113.791, "learn_time_ms": 11770.811, "learn_throughput": 339.824, "synch_weights_time_ms": 82.568}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1e132_00003", "date": "2024-08-04_07-54-49", "timestamp": 1722738289, "time_this_iter_s": 12.978469610214233, "time_total_s": 12.978469610214233, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bfd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.978469610214233, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.87368421052632, "ram_util_percent": 28.094736842105267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.830561579608669, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.529964723189671, "policy_loss": -0.010220508632482962, "vf_loss": 9.53798691034317, "vf_explained_var": 0.09915529061108827, "kl": 0.011696495845997863, "entropy": 1.4102485631903012, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -11.486806125821413, "episode_reward_min": -1349.796529328108, "episode_reward_mean": -766.5927845927907, "episode_len_mean": 126.81132075471699, "episode_media": {}, "episodes_timesteps_total": 6721, "policy_reward_min": {"policy_0": -1349.796529328108}, "policy_reward_max": {"policy_0": -11.486806125821413}, "policy_reward_mean": {"policy_0": -766.5927845927907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1122.8612263386908, -473.338244078163, -731.8620920505065, -1089.0184842843726, -1110.8673983671397, -1052.0083407214847, -84.4126616130838, -370.85643216664454, -11.486806125821413, -1187.9817012908711, -1040.9866961705231, -46.80778653829058, -344.8364155331458, -693.2396140021646, -909.4960286951267, -897.2573702447061, -510.90237286558863, -1028.9856244987818, -382.4443588005884, -272.1573135487517, -1204.0410246522636, -757.8847440467056, -1309.897716489696, -400.86750192277754, -83.99911461610345, -1022.323688032938, -1141.2880630348457, -930.91227479755, -41.68038985464942, -1088.5262627438576, -1140.286992465545, -942.7542047559359, -1205.599689563125, -171.0953129458968, -688.7113970571232, -927.7857487609627, -1187.7288063143426, -1062.959427467701, -1112.2449395918836, -936.8440214794542, -357.0225782239277, -131.1203521744415, -1269.4908428442698, -666.1365658440659, -403.32809957860474, -797.5193189960786, -1198.314180762756, -995.8138030375281, -1349.796529328108, -377.30595231571357, -311.52158412973563, -888.189293386835, -1164.6201942680439], "episode_lengths": [150, 110, 150, 150, 150, 150, 74, 90, 39, 150, 150, 55, 115, 150, 150, 150, 120, 150, 89, 76, 150, 150, 150, 95, 46, 150, 150, 150, 47, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 91, 51, 150, 134, 150, 150, 150, 150, 150, 87, 92, 150, 150], "policy_policy_0_reward": [-1122.8612263386908, -473.338244078163, -731.8620920505065, -1089.0184842843726, -1110.8673983671397, -1052.0083407214847, -84.4126616130838, -370.85643216664454, -11.486806125821413, -1187.9817012908711, -1040.9866961705231, -46.80778653829058, -344.8364155331458, -693.2396140021646, -909.4960286951267, -897.2573702447061, -510.90237286558863, -1028.9856244987818, -382.4443588005884, -272.1573135487517, -1204.0410246522636, -757.8847440467056, -1309.897716489696, -400.86750192277754, -83.99911461610345, -1022.323688032938, -1141.2880630348457, -930.91227479755, -41.68038985464942, -1088.5262627438576, -1140.286992465545, -942.7542047559359, -1205.599689563125, -171.0953129458968, -688.7113970571232, -927.7857487609627, -1187.7288063143426, -1062.959427467701, -1112.2449395918836, -936.8440214794542, -357.0225782239277, -131.1203521744415, -1269.4908428442698, -666.1365658440659, -403.32809957860474, -797.5193189960786, -1198.314180762756, -995.8138030375281, -1349.796529328108, -377.30595231571357, -311.52158412973563, -888.189293386835, -1164.6201942680439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5678177079665189, "mean_inference_ms": 1.6579484144669001, "mean_action_processing_ms": 0.27711092138639787, "mean_env_wait_ms": 3.37036690453918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013352340122438827, "StateBufferConnector_ms": 0.008529537128952314, "ViewRequirementAgentConnector_ms": 0.1840411492113797}, "num_episodes": 27, "episode_return_max": -11.486806125821413, "episode_return_min": -1349.796529328108, "episode_return_mean": -766.5927845927907, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.35039749571155, "num_env_steps_trained_throughput_per_sec": 310.35039749571155, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12928.378, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12928.315, "sample_time_ms": 1098.768, "learn_time_ms": 11755.101, "learn_throughput": 340.278, "synch_weights_time_ms": 73.651}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1e132_00003", "date": "2024-08-04_07-55-02", "timestamp": 1722738302, "time_this_iter_s": 12.900677919387817, "time_total_s": 25.87914752960205, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.87914752960205, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.866666666666667, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2857156621602672, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.502278345823289, "policy_loss": -0.007395349497771046, "vf_loss": 9.506803386410077, "vf_explained_var": 0.17401520771284898, "kl": 0.015025756596135887, "entropy": 1.3482408312459786, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -11.486806125821413, "episode_reward_min": -1349.796529328108, "episode_reward_mean": -745.7324631125839, "episode_len_mean": 125.61728395061728, "episode_media": {}, "episodes_timesteps_total": 10175, "policy_reward_min": {"policy_0": -1349.796529328108}, "policy_reward_max": {"policy_0": -11.486806125821413}, "policy_reward_mean": {"policy_0": -745.7324631125839}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1122.8612263386908, -473.338244078163, -731.8620920505065, -1089.0184842843726, -1110.8673983671397, -1052.0083407214847, -84.4126616130838, -370.85643216664454, -11.486806125821413, -1187.9817012908711, -1040.9866961705231, -46.80778653829058, -344.8364155331458, -693.2396140021646, -909.4960286951267, -897.2573702447061, -510.90237286558863, -1028.9856244987818, -382.4443588005884, -272.1573135487517, -1204.0410246522636, -757.8847440467056, -1309.897716489696, -400.86750192277754, -83.99911461610345, -1022.323688032938, -1141.2880630348457, -930.91227479755, -41.68038985464942, -1088.5262627438576, -1140.286992465545, -942.7542047559359, -1205.599689563125, -171.0953129458968, -688.7113970571232, -927.7857487609627, -1187.7288063143426, -1062.959427467701, -1112.2449395918836, -936.8440214794542, -357.0225782239277, -131.1203521744415, -1269.4908428442698, -666.1365658440659, -403.32809957860474, -797.5193189960786, -1198.314180762756, -995.8138030375281, -1349.796529328108, -377.30595231571357, -311.52158412973563, -888.189293386835, -1164.6201942680439, -971.3442523912715, -172.3591894198821, -864.3638831223558, -120.4773465230675, -808.8502976739725, -594.2189867374315, -914.6163143768481, -92.08010982785062, -898.4350412227863, -1284.547461315071, -140.79405040447608, -116.93178040309962, -257.01593659305917, -753.3373585392128, -1347.3235901107016, -1135.9196401470222, -534.3734947733819, -1040.226554909614, -1287.140608149505, -72.02716370122663, -1199.9049934964721, -1342.3778907167155, -560.5831490847584, -264.72558687868036, -287.15683175085945, -819.5634967905937, -1072.0251578957689, -822.1917617457007], "episode_lengths": [150, 110, 150, 150, 150, 150, 74, 90, 39, 150, 150, 55, 115, 150, 150, 150, 120, 150, 89, 76, 150, 150, 150, 95, 46, 150, 150, 150, 47, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 91, 51, 150, 134, 150, 150, 150, 150, 150, 87, 92, 150, 150, 150, 59, 150, 74, 146, 137, 150, 71, 150, 150, 70, 59, 77, 135, 150, 150, 150, 150, 150, 66, 150, 150, 150, 82, 78, 150, 150, 150], "policy_policy_0_reward": [-1122.8612263386908, -473.338244078163, -731.8620920505065, -1089.0184842843726, -1110.8673983671397, -1052.0083407214847, -84.4126616130838, -370.85643216664454, -11.486806125821413, -1187.9817012908711, -1040.9866961705231, -46.80778653829058, -344.8364155331458, -693.2396140021646, -909.4960286951267, -897.2573702447061, -510.90237286558863, -1028.9856244987818, -382.4443588005884, -272.1573135487517, -1204.0410246522636, -757.8847440467056, -1309.897716489696, -400.86750192277754, -83.99911461610345, -1022.323688032938, -1141.2880630348457, -930.91227479755, -41.68038985464942, -1088.5262627438576, -1140.286992465545, -942.7542047559359, -1205.599689563125, -171.0953129458968, -688.7113970571232, -927.7857487609627, -1187.7288063143426, -1062.959427467701, -1112.2449395918836, -936.8440214794542, -357.0225782239277, -131.1203521744415, -1269.4908428442698, -666.1365658440659, -403.32809957860474, -797.5193189960786, -1198.314180762756, -995.8138030375281, -1349.796529328108, -377.30595231571357, -311.52158412973563, -888.189293386835, -1164.6201942680439, -971.3442523912715, -172.3591894198821, -864.3638831223558, -120.4773465230675, -808.8502976739725, -594.2189867374315, -914.6163143768481, -92.08010982785062, -898.4350412227863, -1284.547461315071, -140.79405040447608, -116.93178040309962, -257.01593659305917, -753.3373585392128, -1347.3235901107016, -1135.9196401470222, -534.3734947733819, -1040.226554909614, -1287.140608149505, -72.02716370122663, -1199.9049934964721, -1342.3778907167155, -560.5831490847584, -264.72558687868036, -287.15683175085945, -819.5634967905937, -1072.0251578957689, -822.1917617457007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5651772899868448, "mean_inference_ms": 1.659720439634672, "mean_action_processing_ms": 0.2771877642328238, "mean_env_wait_ms": 3.369835346810934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013057979536645207, "StateBufferConnector_ms": 0.008536562507535204, "ViewRequirementAgentConnector_ms": 0.1847667458616657}, "num_episodes": 28, "episode_return_max": -11.486806125821413, "episode_return_min": -1349.796529328108, "episode_return_mean": -745.7324631125839, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.6132338358172, "num_env_steps_trained_throughput_per_sec": 311.6132338358172, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12897.732, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12897.666, "sample_time_ms": 1110.684, "learn_time_ms": 11708.984, "learn_throughput": 341.618, "synch_weights_time_ms": 77.146}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1e132_00003", "date": "2024-08-04_07-55-15", "timestamp": 1722738315, "time_this_iter_s": 12.847445964813232, "time_total_s": 38.72659349441528, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.72659349441528, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 28.105263157894743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.415598966429631, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.377899845441183, "policy_loss": -0.012988953672659894, "vf_loss": 9.38764374355475, "vf_explained_var": 0.2510147469739119, "kl": 0.016953884891942536, "entropy": 1.4569081521282594, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -41.68038985464942, "episode_reward_min": -1349.796529328108, "episode_reward_mean": -757.6539053178417, "episode_len_mean": 128.22, "episode_media": {}, "episodes_timesteps_total": 12822, "policy_reward_min": {"policy_0": -1349.796529328108}, "policy_reward_max": {"policy_0": -41.68038985464942}, "policy_reward_mean": {"policy_0": -757.6539053178417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-909.4960286951267, -897.2573702447061, -510.90237286558863, -1028.9856244987818, -382.4443588005884, -272.1573135487517, -1204.0410246522636, -757.8847440467056, -1309.897716489696, -400.86750192277754, -83.99911461610345, -1022.323688032938, -1141.2880630348457, -930.91227479755, -41.68038985464942, -1088.5262627438576, -1140.286992465545, -942.7542047559359, -1205.599689563125, -171.0953129458968, -688.7113970571232, -927.7857487609627, -1187.7288063143426, -1062.959427467701, -1112.2449395918836, -936.8440214794542, -357.0225782239277, -131.1203521744415, -1269.4908428442698, -666.1365658440659, -403.32809957860474, -797.5193189960786, -1198.314180762756, -995.8138030375281, -1349.796529328108, -377.30595231571357, -311.52158412973563, -888.189293386835, -1164.6201942680439, -971.3442523912715, -172.3591894198821, -864.3638831223558, -120.4773465230675, -808.8502976739725, -594.2189867374315, -914.6163143768481, -92.08010982785062, -898.4350412227863, -1284.547461315071, -140.79405040447608, -116.93178040309962, -257.01593659305917, -753.3373585392128, -1347.3235901107016, -1135.9196401470222, -534.3734947733819, -1040.226554909614, -1287.140608149505, -72.02716370122663, -1199.9049934964721, -1342.3778907167155, -560.5831490847584, -264.72558687868036, -287.15683175085945, -819.5634967905937, -1072.0251578957689, -822.1917617457007, -168.81336880194453, -881.2751053475154, -1104.2870670662262, -481.765617405508, -1187.9699890934075, -843.3522040319551, -403.671565926513, -1026.5521026272838, -846.2550213870169, -59.89107717001337, -952.3027750914295, -1207.0260950691365, -1178.9328077720554, -305.2077783959806, -134.36127184151948, -1008.5502089832958, -1008.4274265660705, -71.15930687246495, -594.5948914814165, -336.86938681551476, -824.7767231765571, -84.51793821188566, -779.3444856486099, -1165.2123776025467, -597.7907146359865, -961.9540790251433, -920.6742406571489, -757.782929773372, -967.3455708548129, -1030.4377628655643, -893.3968983480462, -1253.85078043407, -683.2753499657671], "episode_lengths": [150, 150, 120, 150, 89, 76, 150, 150, 150, 95, 46, 150, 150, 150, 47, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 91, 51, 150, 134, 150, 150, 150, 150, 150, 87, 92, 150, 150, 150, 59, 150, 74, 146, 137, 150, 71, 150, 150, 70, 59, 77, 135, 150, 150, 150, 150, 150, 66, 150, 150, 150, 82, 78, 150, 150, 150, 95, 150, 150, 106, 150, 150, 93, 150, 150, 46, 150, 150, 150, 80, 69, 150, 150, 60, 150, 122, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146], "policy_policy_0_reward": [-909.4960286951267, -897.2573702447061, -510.90237286558863, -1028.9856244987818, -382.4443588005884, -272.1573135487517, -1204.0410246522636, -757.8847440467056, -1309.897716489696, -400.86750192277754, -83.99911461610345, -1022.323688032938, -1141.2880630348457, -930.91227479755, -41.68038985464942, -1088.5262627438576, -1140.286992465545, -942.7542047559359, -1205.599689563125, -171.0953129458968, -688.7113970571232, -927.7857487609627, -1187.7288063143426, -1062.959427467701, -1112.2449395918836, -936.8440214794542, -357.0225782239277, -131.1203521744415, -1269.4908428442698, -666.1365658440659, -403.32809957860474, -797.5193189960786, -1198.314180762756, -995.8138030375281, -1349.796529328108, -377.30595231571357, -311.52158412973563, -888.189293386835, -1164.6201942680439, -971.3442523912715, -172.3591894198821, -864.3638831223558, -120.4773465230675, -808.8502976739725, -594.2189867374315, -914.6163143768481, -92.08010982785062, -898.4350412227863, -1284.547461315071, -140.79405040447608, -116.93178040309962, -257.01593659305917, -753.3373585392128, -1347.3235901107016, -1135.9196401470222, -534.3734947733819, -1040.226554909614, -1287.140608149505, -72.02716370122663, -1199.9049934964721, -1342.3778907167155, -560.5831490847584, -264.72558687868036, -287.15683175085945, -819.5634967905937, -1072.0251578957689, -822.1917617457007, -168.81336880194453, -881.2751053475154, -1104.2870670662262, -481.765617405508, -1187.9699890934075, -843.3522040319551, -403.671565926513, -1026.5521026272838, -846.2550213870169, -59.89107717001337, -952.3027750914295, -1207.0260950691365, -1178.9328077720554, -305.2077783959806, -134.36127184151948, -1008.5502089832958, -1008.4274265660705, -71.15930687246495, -594.5948914814165, -336.86938681551476, -824.7767231765571, -84.51793821188566, -779.3444856486099, -1165.2123776025467, -597.7907146359865, -961.9540790251433, -920.6742406571489, -757.782929773372, -967.3455708548129, -1030.4377628655643, -893.3968983480462, -1253.85078043407, -683.2753499657671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.563449376620023, "mean_inference_ms": 1.6627132927592982, "mean_action_processing_ms": 0.27770225461943904, "mean_env_wait_ms": 3.375235039884403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013198137283325195, "StateBufferConnector_ms": 0.008674860000610352, "ViewRequirementAgentConnector_ms": 0.18949031829833984}, "num_episodes": 33, "episode_return_max": -41.68038985464942, "episode_return_min": -1349.796529328108, "episode_return_mean": -757.6539053178417, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.2989199211807, "num_env_steps_trained_throughput_per_sec": 314.2989199211807, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12854.987, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12854.921, "sample_time_ms": 1116.928, "learn_time_ms": 11663.637, "learn_throughput": 342.946, "synch_weights_time_ms": 73.525}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1e132_00003", "date": "2024-08-04_07-55-28", "timestamp": 1722738328, "time_this_iter_s": 12.739386796951294, "time_total_s": 51.46598029136658, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ad090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.46598029136658, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.95555555555556, "ram_util_percent": 28.194444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.254326444243391, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.360294882456461, "policy_loss": -0.007959774919436313, "vf_loss": 9.365684827168783, "vf_explained_var": 0.3443002363666892, "kl": 0.013587501671160383, "entropy": 1.4768301080912352, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -46.49975655410688, "episode_reward_min": -1349.796529328108, "episode_reward_mean": -728.7672399639587, "episode_len_mean": 127.69, "episode_media": {}, "episodes_timesteps_total": 12769, "policy_reward_min": {"policy_0": -1349.796529328108}, "policy_reward_max": {"policy_0": -46.49975655410688}, "policy_reward_mean": {"policy_0": -728.7672399639587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.314180762756, -995.8138030375281, -1349.796529328108, -377.30595231571357, -311.52158412973563, -888.189293386835, -1164.6201942680439, -971.3442523912715, -172.3591894198821, -864.3638831223558, -120.4773465230675, -808.8502976739725, -594.2189867374315, -914.6163143768481, -92.08010982785062, -898.4350412227863, -1284.547461315071, -140.79405040447608, -116.93178040309962, -257.01593659305917, -753.3373585392128, -1347.3235901107016, -1135.9196401470222, -534.3734947733819, -1040.226554909614, -1287.140608149505, -72.02716370122663, -1199.9049934964721, -1342.3778907167155, -560.5831490847584, -264.72558687868036, -287.15683175085945, -819.5634967905937, -1072.0251578957689, -822.1917617457007, -168.81336880194453, -881.2751053475154, -1104.2870670662262, -481.765617405508, -1187.9699890934075, -843.3522040319551, -403.671565926513, -1026.5521026272838, -846.2550213870169, -59.89107717001337, -952.3027750914295, -1207.0260950691365, -1178.9328077720554, -305.2077783959806, -134.36127184151948, -1008.5502089832958, -1008.4274265660705, -71.15930687246495, -594.5948914814165, -336.86938681551476, -824.7767231765571, -84.51793821188566, -779.3444856486099, -1165.2123776025467, -597.7907146359865, -961.9540790251433, -920.6742406571489, -757.782929773372, -967.3455708548129, -1030.4377628655643, -893.3968983480462, -1253.85078043407, -683.2753499657671, -836.4438677996428, -706.8781611799837, -237.58683169796512, -1105.4179438749113, -895.3118451897332, -768.0198039021769, -1208.100462268544, -1070.738527309271, -972.2905281300245, -581.8536983713637, -1172.8757481339321, -683.3899073538805, -394.89719640031103, -48.441056746625584, -258.19954572565473, -687.1378852035724, -1229.6101462762524, -627.5065789934578, -829.3083882597916, -315.93445223247784, -971.4939897773185, -46.49975655410688, -372.6511154990114, -270.8287856222974, -1061.2225044752558, -714.671554821146, -891.136378457857, -1096.3386330505841, -317.68609974581193, -818.1227253099905, -382.85979425663913, -521.1716989003796], "episode_lengths": [150, 150, 150, 87, 92, 150, 150, 150, 59, 150, 74, 146, 137, 150, 71, 150, 150, 70, 59, 77, 135, 150, 150, 150, 150, 150, 66, 150, 150, 150, 82, 78, 150, 150, 150, 95, 150, 150, 106, 150, 150, 93, 150, 150, 46, 150, 150, 150, 80, 69, 150, 150, 60, 150, 122, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 133, 69, 150, 150, 132, 150, 150, 150, 150, 150, 150, 122, 46, 89, 142, 150, 120, 150, 89, 150, 56, 92, 70, 150, 150, 150, 150, 118, 150, 103, 125], "policy_policy_0_reward": [-1198.314180762756, -995.8138030375281, -1349.796529328108, -377.30595231571357, -311.52158412973563, -888.189293386835, -1164.6201942680439, -971.3442523912715, -172.3591894198821, -864.3638831223558, -120.4773465230675, -808.8502976739725, -594.2189867374315, -914.6163143768481, -92.08010982785062, -898.4350412227863, -1284.547461315071, -140.79405040447608, -116.93178040309962, -257.01593659305917, -753.3373585392128, -1347.3235901107016, -1135.9196401470222, -534.3734947733819, -1040.226554909614, -1287.140608149505, -72.02716370122663, -1199.9049934964721, -1342.3778907167155, -560.5831490847584, -264.72558687868036, -287.15683175085945, -819.5634967905937, -1072.0251578957689, -822.1917617457007, -168.81336880194453, -881.2751053475154, -1104.2870670662262, -481.765617405508, -1187.9699890934075, -843.3522040319551, -403.671565926513, -1026.5521026272838, -846.2550213870169, -59.89107717001337, -952.3027750914295, -1207.0260950691365, -1178.9328077720554, -305.2077783959806, -134.36127184151948, -1008.5502089832958, -1008.4274265660705, -71.15930687246495, -594.5948914814165, -336.86938681551476, -824.7767231765571, -84.51793821188566, -779.3444856486099, -1165.2123776025467, -597.7907146359865, -961.9540790251433, -920.6742406571489, -757.782929773372, -967.3455708548129, -1030.4377628655643, -893.3968983480462, -1253.85078043407, -683.2753499657671, -836.4438677996428, -706.8781611799837, -237.58683169796512, -1105.4179438749113, -895.3118451897332, -768.0198039021769, -1208.100462268544, -1070.738527309271, -972.2905281300245, -581.8536983713637, -1172.8757481339321, -683.3899073538805, -394.89719640031103, -48.441056746625584, -258.19954572565473, -687.1378852035724, -1229.6101462762524, -627.5065789934578, -829.3083882597916, -315.93445223247784, -971.4939897773185, -46.49975655410688, -372.6511154990114, -270.8287856222974, -1061.2225044752558, -714.671554821146, -891.136378457857, -1096.3386330505841, -317.68609974581193, -818.1227253099905, -382.85979425663913, -521.1716989003796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621707647398818, "mean_inference_ms": 1.6679060026409553, "mean_action_processing_ms": 0.2780096743358126, "mean_env_wait_ms": 3.389750304054494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01304936408996582, "StateBufferConnector_ms": 0.008833885192871094, "ViewRequirementAgentConnector_ms": 0.1936328411102295}, "num_episodes": 32, "episode_return_max": -46.49975655410688, "episode_return_min": -1349.796529328108, "episode_return_mean": -728.7672399639587, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.2183612570444, "num_env_steps_trained_throughput_per_sec": 318.2183612570444, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12797.989, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12797.922, "sample_time_ms": 1113.203, "learn_time_ms": 11613.221, "learn_throughput": 344.435, "synch_weights_time_ms": 70.679}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1e132_00003", "date": "2024-08-04_07-55-40", "timestamp": 1722738340, "time_this_iter_s": 12.582790613174438, "time_total_s": 64.04877090454102, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d854489360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.04877090454102, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.994444444444447, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.72040033650895, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.508150407175224, "policy_loss": -0.014629985706415027, "vf_loss": 8.51910867045323, "vf_explained_var": 0.382050041295588, "kl": 0.019089084055212886, "entropy": 1.4608778490374486, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -46.49975655410688, "episode_reward_min": -1366.0371552266542, "episode_reward_mean": -754.0182874975458, "episode_len_mean": 131.25, "episode_media": {}, "episodes_timesteps_total": 13125, "policy_reward_min": {"policy_0": -1366.0371552266542}, "policy_reward_max": {"policy_0": -46.49975655410688}, "policy_reward_mean": {"policy_0": -754.0182874975458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-287.15683175085945, -819.5634967905937, -1072.0251578957689, -822.1917617457007, -168.81336880194453, -881.2751053475154, -1104.2870670662262, -481.765617405508, -1187.9699890934075, -843.3522040319551, -403.671565926513, -1026.5521026272838, -846.2550213870169, -59.89107717001337, -952.3027750914295, -1207.0260950691365, -1178.9328077720554, -305.2077783959806, -134.36127184151948, -1008.5502089832958, -1008.4274265660705, -71.15930687246495, -594.5948914814165, -336.86938681551476, -824.7767231765571, -84.51793821188566, -779.3444856486099, -1165.2123776025467, -597.7907146359865, -961.9540790251433, -920.6742406571489, -757.782929773372, -967.3455708548129, -1030.4377628655643, -893.3968983480462, -1253.85078043407, -683.2753499657671, -836.4438677996428, -706.8781611799837, -237.58683169796512, -1105.4179438749113, -895.3118451897332, -768.0198039021769, -1208.100462268544, -1070.738527309271, -972.2905281300245, -581.8536983713637, -1172.8757481339321, -683.3899073538805, -394.89719640031103, -48.441056746625584, -258.19954572565473, -687.1378852035724, -1229.6101462762524, -627.5065789934578, -829.3083882597916, -315.93445223247784, -971.4939897773185, -46.49975655410688, -372.6511154990114, -270.8287856222974, -1061.2225044752558, -714.671554821146, -891.136378457857, -1096.3386330505841, -317.68609974581193, -818.1227253099905, -382.85979425663913, -521.1716989003796, -1223.4651219772818, -769.8022465967559, -910.3142410194, -595.6167200923222, -494.6868718339926, -273.6524718147163, -520.6425227448724, -1172.999613167614, -163.93542106670822, -320.6535050294915, -1292.07708796173, -927.9553313697861, -1126.7837525272685, -288.75752914944565, -1366.0371552266542, -1000.3686346362833, -1066.8011876223718, -1301.4210910043787, -631.8556321310067, -1223.1163603237944, -715.5711797802952, -681.6019311728527, -386.712918079689, -418.6042392763608, -87.39282753931978, -1337.7164950091471, -1043.8459904273707, -1039.8837546555935, -1188.6458907161018, -818.2443273116777, -1195.4789198416324], "episode_lengths": [78, 150, 150, 150, 95, 150, 150, 106, 150, 150, 93, 150, 150, 46, 150, 150, 150, 80, 69, 150, 150, 60, 150, 122, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 133, 69, 150, 150, 132, 150, 150, 150, 150, 150, 150, 122, 46, 89, 142, 150, 120, 150, 89, 150, 56, 92, 70, 150, 150, 150, 150, 118, 150, 103, 125, 150, 150, 150, 150, 150, 79, 150, 150, 58, 93, 150, 150, 150, 105, 150, 150, 150, 150, 142, 150, 134, 149, 109, 150, 42, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-287.15683175085945, -819.5634967905937, -1072.0251578957689, -822.1917617457007, -168.81336880194453, -881.2751053475154, -1104.2870670662262, -481.765617405508, -1187.9699890934075, -843.3522040319551, -403.671565926513, -1026.5521026272838, -846.2550213870169, -59.89107717001337, -952.3027750914295, -1207.0260950691365, -1178.9328077720554, -305.2077783959806, -134.36127184151948, -1008.5502089832958, -1008.4274265660705, -71.15930687246495, -594.5948914814165, -336.86938681551476, -824.7767231765571, -84.51793821188566, -779.3444856486099, -1165.2123776025467, -597.7907146359865, -961.9540790251433, -920.6742406571489, -757.782929773372, -967.3455708548129, -1030.4377628655643, -893.3968983480462, -1253.85078043407, -683.2753499657671, -836.4438677996428, -706.8781611799837, -237.58683169796512, -1105.4179438749113, -895.3118451897332, -768.0198039021769, -1208.100462268544, -1070.738527309271, -972.2905281300245, -581.8536983713637, -1172.8757481339321, -683.3899073538805, -394.89719640031103, -48.441056746625584, -258.19954572565473, -687.1378852035724, -1229.6101462762524, -627.5065789934578, -829.3083882597916, -315.93445223247784, -971.4939897773185, -46.49975655410688, -372.6511154990114, -270.8287856222974, -1061.2225044752558, -714.671554821146, -891.136378457857, -1096.3386330505841, -317.68609974581193, -818.1227253099905, -382.85979425663913, -521.1716989003796, -1223.4651219772818, -769.8022465967559, -910.3142410194, -595.6167200923222, -494.6868718339926, -273.6524718147163, -520.6425227448724, -1172.999613167614, -163.93542106670822, -320.6535050294915, -1292.07708796173, -927.9553313697861, -1126.7837525272685, -288.75752914944565, -1366.0371552266542, -1000.3686346362833, -1066.8011876223718, -1301.4210910043787, -631.8556321310067, -1223.1163603237944, -715.5711797802952, -681.6019311728527, -386.712918079689, -418.6042392763608, -87.39282753931978, -1337.7164950091471, -1043.8459904273707, -1039.8837546555935, -1188.6458907161018, -818.2443273116777, -1195.4789198416324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613180192693233, "mean_inference_ms": 1.6699069686298764, "mean_action_processing_ms": 0.27846212725119907, "mean_env_wait_ms": 3.397963686322247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012997150421142578, "StateBufferConnector_ms": 0.008798837661743164, "ViewRequirementAgentConnector_ms": 0.19304752349853516}, "num_episodes": 31, "episode_return_max": -46.49975655410688, "episode_return_min": -1366.0371552266542, "episode_return_mean": -754.0182874975458, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.19363920764727, "num_env_steps_trained_throughput_per_sec": 299.19363920764727, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12893.205, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12893.134, "sample_time_ms": 1115.059, "learn_time_ms": 11708.374, "learn_throughput": 341.636, "synch_weights_time_ms": 68.886}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1e132_00003", "date": "2024-08-04_07-55-54", "timestamp": 1722738354, "time_this_iter_s": 13.380117177963257, "time_total_s": 77.42888808250427, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.42888808250427, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.64210526315789, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.367411061935126, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.02059417963028, "policy_loss": -0.01286483770381892, "vf_loss": 9.030153565605481, "vf_explained_var": 0.4719689274827639, "kl": 0.01725917800930195, "entropy": 1.4638384211808444, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -46.49975655410688, "episode_reward_min": -1366.0371552266542, "episode_reward_mean": -777.8436295491939, "episode_len_mean": 133.66, "episode_media": {}, "episodes_timesteps_total": 13366, "policy_reward_min": {"policy_0": -1366.0371552266542}, "policy_reward_max": {"policy_0": -46.49975655410688}, "policy_reward_mean": {"policy_0": -777.8436295491939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-597.7907146359865, -961.9540790251433, -920.6742406571489, -757.782929773372, -967.3455708548129, -1030.4377628655643, -893.3968983480462, -1253.85078043407, -683.2753499657671, -836.4438677996428, -706.8781611799837, -237.58683169796512, -1105.4179438749113, -895.3118451897332, -768.0198039021769, -1208.100462268544, -1070.738527309271, -972.2905281300245, -581.8536983713637, -1172.8757481339321, -683.3899073538805, -394.89719640031103, -48.441056746625584, -258.19954572565473, -687.1378852035724, -1229.6101462762524, -627.5065789934578, -829.3083882597916, -315.93445223247784, -971.4939897773185, -46.49975655410688, -372.6511154990114, -270.8287856222974, -1061.2225044752558, -714.671554821146, -891.136378457857, -1096.3386330505841, -317.68609974581193, -818.1227253099905, -382.85979425663913, -521.1716989003796, -1223.4651219772818, -769.8022465967559, -910.3142410194, -595.6167200923222, -494.6868718339926, -273.6524718147163, -520.6425227448724, -1172.999613167614, -163.93542106670822, -320.6535050294915, -1292.07708796173, -927.9553313697861, -1126.7837525272685, -288.75752914944565, -1366.0371552266542, -1000.3686346362833, -1066.8011876223718, -1301.4210910043787, -631.8556321310067, -1223.1163603237944, -715.5711797802952, -681.6019311728527, -386.712918079689, -418.6042392763608, -87.39282753931978, -1337.7164950091471, -1043.8459904273707, -1039.8837546555935, -1188.6458907161018, -818.2443273116777, -1195.4789198416324, -1116.8314722386021, -1249.3906607919791, -600.0020959876033, -746.623889206526, -1264.56528055168, -785.4925177447615, -72.62533462693375, -352.7874749662911, -1238.8545091799197, -103.82412342408693, -963.7067769937012, -377.5837435303289, -968.5006499425186, -501.8812213020513, -872.2314510503073, -695.2149040684359, -1274.1206367402767, -825.3480701389321, -883.1577542847168, -807.0944347811383, -578.8108838094739, -1202.939911258269, -1312.919395290209, -698.9373452584684, -69.72970418965019, -59.686868045791535, -1097.9509240097664, -1317.7760123211792], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 133, 69, 150, 150, 132, 150, 150, 150, 150, 150, 150, 122, 46, 89, 142, 150, 120, 150, 89, 150, 56, 92, 70, 150, 150, 150, 150, 118, 150, 103, 125, 150, 150, 150, 150, 150, 79, 150, 150, 58, 93, 150, 150, 150, 105, 150, 150, 150, 150, 142, 150, 134, 149, 109, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 79, 150, 89, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 131, 51, 53, 150, 150], "policy_policy_0_reward": [-597.7907146359865, -961.9540790251433, -920.6742406571489, -757.782929773372, -967.3455708548129, -1030.4377628655643, -893.3968983480462, -1253.85078043407, -683.2753499657671, -836.4438677996428, -706.8781611799837, -237.58683169796512, -1105.4179438749113, -895.3118451897332, -768.0198039021769, -1208.100462268544, -1070.738527309271, -972.2905281300245, -581.8536983713637, -1172.8757481339321, -683.3899073538805, -394.89719640031103, -48.441056746625584, -258.19954572565473, -687.1378852035724, -1229.6101462762524, -627.5065789934578, -829.3083882597916, -315.93445223247784, -971.4939897773185, -46.49975655410688, -372.6511154990114, -270.8287856222974, -1061.2225044752558, -714.671554821146, -891.136378457857, -1096.3386330505841, -317.68609974581193, -818.1227253099905, -382.85979425663913, -521.1716989003796, -1223.4651219772818, -769.8022465967559, -910.3142410194, -595.6167200923222, -494.6868718339926, -273.6524718147163, -520.6425227448724, -1172.999613167614, -163.93542106670822, -320.6535050294915, -1292.07708796173, -927.9553313697861, -1126.7837525272685, -288.75752914944565, -1366.0371552266542, -1000.3686346362833, -1066.8011876223718, -1301.4210910043787, -631.8556321310067, -1223.1163603237944, -715.5711797802952, -681.6019311728527, -386.712918079689, -418.6042392763608, -87.39282753931978, -1337.7164950091471, -1043.8459904273707, -1039.8837546555935, -1188.6458907161018, -818.2443273116777, -1195.4789198416324, -1116.8314722386021, -1249.3906607919791, -600.0020959876033, -746.623889206526, -1264.56528055168, -785.4925177447615, -72.62533462693375, -352.7874749662911, -1238.8545091799197, -103.82412342408693, -963.7067769937012, -377.5837435303289, -968.5006499425186, -501.8812213020513, -872.2314510503073, -695.2149040684359, -1274.1206367402767, -825.3480701389321, -883.1577542847168, -807.0944347811383, -578.8108838094739, -1202.939911258269, -1312.919395290209, -698.9373452584684, -69.72970418965019, -59.686868045791535, -1097.9509240097664, -1317.7760123211792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597107767262611, "mean_inference_ms": 1.670399058378314, "mean_action_processing_ms": 0.2781611491811319, "mean_env_wait_ms": 3.4027598538271295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012901544570922852, "StateBufferConnector_ms": 0.008655071258544922, "ViewRequirementAgentConnector_ms": 0.19485259056091309}, "num_episodes": 28, "episode_return_max": -46.49975655410688, "episode_return_min": -1366.0371552266542, "episode_return_mean": -777.8436295491939, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.30806902876435, "num_env_steps_trained_throughput_per_sec": 344.30806902876435, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12710.964, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12710.894, "sample_time_ms": 1114.706, "learn_time_ms": 11524.593, "learn_throughput": 347.084, "synch_weights_time_ms": 70.786}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1e132_00003", "date": "2024-08-04_07-56-05", "timestamp": 1722738365, "time_this_iter_s": 11.631068706512451, "time_total_s": 89.05995678901672, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ae710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.05995678901672, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.443749999999998, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.39578822925687, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.568680840730668, "policy_loss": -0.014793451636311754, "vf_loss": 8.578844812015692, "vf_explained_var": 0.6660188327232996, "kl": 0.02386437913883128, "entropy": 1.4340292636305094, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -46.49975655410688, "episode_reward_min": -1366.0371552266542, "episode_reward_mean": -751.5395897781839, "episode_len_mean": 132.66, "episode_media": {}, "episodes_timesteps_total": 13266, "policy_reward_min": {"policy_0": -1366.0371552266542}, "policy_reward_max": {"policy_0": -46.49975655410688}, "policy_reward_mean": {"policy_0": -751.5395897781839}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-829.3083882597916, -315.93445223247784, -971.4939897773185, -46.49975655410688, -372.6511154990114, -270.8287856222974, -1061.2225044752558, -714.671554821146, -891.136378457857, -1096.3386330505841, -317.68609974581193, -818.1227253099905, -382.85979425663913, -521.1716989003796, -1223.4651219772818, -769.8022465967559, -910.3142410194, -595.6167200923222, -494.6868718339926, -273.6524718147163, -520.6425227448724, -1172.999613167614, -163.93542106670822, -320.6535050294915, -1292.07708796173, -927.9553313697861, -1126.7837525272685, -288.75752914944565, -1366.0371552266542, -1000.3686346362833, -1066.8011876223718, -1301.4210910043787, -631.8556321310067, -1223.1163603237944, -715.5711797802952, -681.6019311728527, -386.712918079689, -418.6042392763608, -87.39282753931978, -1337.7164950091471, -1043.8459904273707, -1039.8837546555935, -1188.6458907161018, -818.2443273116777, -1195.4789198416324, -1116.8314722386021, -1249.3906607919791, -600.0020959876033, -746.623889206526, -1264.56528055168, -785.4925177447615, -72.62533462693375, -352.7874749662911, -1238.8545091799197, -103.82412342408693, -963.7067769937012, -377.5837435303289, -968.5006499425186, -501.8812213020513, -872.2314510503073, -695.2149040684359, -1274.1206367402767, -825.3480701389321, -883.1577542847168, -807.0944347811383, -578.8108838094739, -1202.939911258269, -1312.919395290209, -698.9373452584684, -69.72970418965019, -59.686868045791535, -1097.9509240097664, -1317.7760123211792, -247.1051921297811, -923.1721724793364, -844.223258122342, -189.13337462692382, -1236.1291407942067, -693.7309410901106, -1241.0432310781666, -120.59042432303383, -658.5686556244011, -366.431711063902, -687.846319943955, -769.7567744646711, -902.7976224714524, -1176.2080720039723, -1032.996964929316, -1095.6464022005205, -842.426565598754, -1135.1101917663036, -279.58215642361773, -72.23755132765282, -604.2624255041878, -563.2574631644756, -363.81793385011827, -164.2090252584766, -1162.960821833819, -538.5783373830075, -1008.9813545596963], "episode_lengths": [150, 89, 150, 56, 92, 70, 150, 150, 150, 150, 118, 150, 103, 125, 150, 150, 150, 150, 150, 79, 150, 150, 58, 93, 150, 150, 150, 105, 150, 150, 150, 150, 142, 150, 134, 149, 109, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 79, 150, 89, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 131, 51, 53, 150, 150, 103, 150, 150, 63, 150, 150, 150, 79, 138, 150, 140, 132, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 102, 106, 150, 123, 150], "policy_policy_0_reward": [-829.3083882597916, -315.93445223247784, -971.4939897773185, -46.49975655410688, -372.6511154990114, -270.8287856222974, -1061.2225044752558, -714.671554821146, -891.136378457857, -1096.3386330505841, -317.68609974581193, -818.1227253099905, -382.85979425663913, -521.1716989003796, -1223.4651219772818, -769.8022465967559, -910.3142410194, -595.6167200923222, -494.6868718339926, -273.6524718147163, -520.6425227448724, -1172.999613167614, -163.93542106670822, -320.6535050294915, -1292.07708796173, -927.9553313697861, -1126.7837525272685, -288.75752914944565, -1366.0371552266542, -1000.3686346362833, -1066.8011876223718, -1301.4210910043787, -631.8556321310067, -1223.1163603237944, -715.5711797802952, -681.6019311728527, -386.712918079689, -418.6042392763608, -87.39282753931978, -1337.7164950091471, -1043.8459904273707, -1039.8837546555935, -1188.6458907161018, -818.2443273116777, -1195.4789198416324, -1116.8314722386021, -1249.3906607919791, -600.0020959876033, -746.623889206526, -1264.56528055168, -785.4925177447615, -72.62533462693375, -352.7874749662911, -1238.8545091799197, -103.82412342408693, -963.7067769937012, -377.5837435303289, -968.5006499425186, -501.8812213020513, -872.2314510503073, -695.2149040684359, -1274.1206367402767, -825.3480701389321, -883.1577542847168, -807.0944347811383, -578.8108838094739, -1202.939911258269, -1312.919395290209, -698.9373452584684, -69.72970418965019, -59.686868045791535, -1097.9509240097664, -1317.7760123211792, -247.1051921297811, -923.1721724793364, -844.223258122342, -189.13337462692382, -1236.1291407942067, -693.7309410901106, -1241.0432310781666, -120.59042432303383, -658.5686556244011, -366.431711063902, -687.846319943955, -769.7567744646711, -902.7976224714524, -1176.2080720039723, -1032.996964929316, -1095.6464022005205, -842.426565598754, -1135.1101917663036, -279.58215642361773, -72.23755132765282, -604.2624255041878, -563.2574631644756, -363.81793385011827, -164.2090252584766, -1162.960821833819, -538.5783373830075, -1008.9813545596963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576193384494651, "mean_inference_ms": 1.6673352611838943, "mean_action_processing_ms": 0.27722914217538347, "mean_env_wait_ms": 3.400191389475667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012534856796264648, "StateBufferConnector_ms": 0.008279800415039062, "ViewRequirementAgentConnector_ms": 0.19673895835876465}, "num_episodes": 27, "episode_return_max": -46.49975655410688, "episode_return_min": -1366.0371552266542, "episode_return_mean": -751.5395897781839, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.02379764097276, "num_env_steps_trained_throughput_per_sec": 312.02379764097276, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12724.537, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12724.465, "sample_time_ms": 1111.988, "learn_time_ms": 11538.42, "learn_throughput": 346.668, "synch_weights_time_ms": 73.231}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1e132_00003", "date": "2024-08-04_07-56-18", "timestamp": 1722738378, "time_this_iter_s": 12.833646297454834, "time_total_s": 101.89360308647156, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bfbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.89360308647156, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.92222222222222, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.706442343691986, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.411569645504157, "policy_loss": -0.010197334349504672, "vf_loss": 7.4173312306404116, "vf_explained_var": 0.6664083271597823, "kl": 0.015248417305944418, "entropy": 1.3879798134167989, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -12.2278324974553, "episode_reward_min": -1447.922833594227, "episode_reward_mean": -726.1132236456396, "episode_len_mean": 131.89, "episode_media": {}, "episodes_timesteps_total": 13189, "policy_reward_min": {"policy_0": -1447.922833594227}, "policy_reward_max": {"policy_0": -12.2278324974553}, "policy_reward_mean": {"policy_0": -726.1132236456396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.1163603237944, -715.5711797802952, -681.6019311728527, -386.712918079689, -418.6042392763608, -87.39282753931978, -1337.7164950091471, -1043.8459904273707, -1039.8837546555935, -1188.6458907161018, -818.2443273116777, -1195.4789198416324, -1116.8314722386021, -1249.3906607919791, -600.0020959876033, -746.623889206526, -1264.56528055168, -785.4925177447615, -72.62533462693375, -352.7874749662911, -1238.8545091799197, -103.82412342408693, -963.7067769937012, -377.5837435303289, -968.5006499425186, -501.8812213020513, -872.2314510503073, -695.2149040684359, -1274.1206367402767, -825.3480701389321, -883.1577542847168, -807.0944347811383, -578.8108838094739, -1202.939911258269, -1312.919395290209, -698.9373452584684, -69.72970418965019, -59.686868045791535, -1097.9509240097664, -1317.7760123211792, -247.1051921297811, -923.1721724793364, -844.223258122342, -189.13337462692382, -1236.1291407942067, -693.7309410901106, -1241.0432310781666, -120.59042432303383, -658.5686556244011, -366.431711063902, -687.846319943955, -769.7567744646711, -902.7976224714524, -1176.2080720039723, -1032.996964929316, -1095.6464022005205, -842.426565598754, -1135.1101917663036, -279.58215642361773, -72.23755132765282, -604.2624255041878, -563.2574631644756, -363.81793385011827, -164.2090252584766, -1162.960821833819, -538.5783373830075, -1008.9813545596963, -1447.922833594227, -1179.1528928795983, -459.1005575972927, -1235.8087851230741, -1289.5149726262034, -266.31729275610223, -134.61499254065552, -475.6323766382783, -63.88649837576674, -1026.0068710182436, -499.58782595081834, -976.9961194919869, -44.80233215490015, -593.3419100642217, -1002.564136670936, -629.2359012731501, -256.55872583583533, -574.2550320870828, -182.3532162237635, -760.0912558468493, -797.2686626385738, -536.0517819437734, -720.1678455758852, -407.57637202886536, -843.8429401426472, -603.0988487108285, -1084.063446349496, -840.6401034327167, -588.3580713959719, -681.7219301836734, -503.80958569677796, -12.2278324974553, -798.5434513346434], "episode_lengths": [150, 134, 149, 109, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 79, 150, 89, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 131, 51, 53, 150, 150, 103, 150, 150, 63, 150, 150, 150, 79, 138, 150, 140, 132, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 102, 106, 150, 123, 150, 150, 150, 150, 150, 150, 71, 68, 150, 69, 150, 150, 150, 36, 150, 150, 123, 72, 150, 62, 150, 132, 129, 150, 150, 150, 150, 150, 150, 150, 150, 105, 36, 150], "policy_policy_0_reward": [-1223.1163603237944, -715.5711797802952, -681.6019311728527, -386.712918079689, -418.6042392763608, -87.39282753931978, -1337.7164950091471, -1043.8459904273707, -1039.8837546555935, -1188.6458907161018, -818.2443273116777, -1195.4789198416324, -1116.8314722386021, -1249.3906607919791, -600.0020959876033, -746.623889206526, -1264.56528055168, -785.4925177447615, -72.62533462693375, -352.7874749662911, -1238.8545091799197, -103.82412342408693, -963.7067769937012, -377.5837435303289, -968.5006499425186, -501.8812213020513, -872.2314510503073, -695.2149040684359, -1274.1206367402767, -825.3480701389321, -883.1577542847168, -807.0944347811383, -578.8108838094739, -1202.939911258269, -1312.919395290209, -698.9373452584684, -69.72970418965019, -59.686868045791535, -1097.9509240097664, -1317.7760123211792, -247.1051921297811, -923.1721724793364, -844.223258122342, -189.13337462692382, -1236.1291407942067, -693.7309410901106, -1241.0432310781666, -120.59042432303383, -658.5686556244011, -366.431711063902, -687.846319943955, -769.7567744646711, -902.7976224714524, -1176.2080720039723, -1032.996964929316, -1095.6464022005205, -842.426565598754, -1135.1101917663036, -279.58215642361773, -72.23755132765282, -604.2624255041878, -563.2574631644756, -363.81793385011827, -164.2090252584766, -1162.960821833819, -538.5783373830075, -1008.9813545596963, -1447.922833594227, -1179.1528928795983, -459.1005575972927, -1235.8087851230741, -1289.5149726262034, -266.31729275610223, -134.61499254065552, -475.6323766382783, -63.88649837576674, -1026.0068710182436, -499.58782595081834, -976.9961194919869, -44.80233215490015, -593.3419100642217, -1002.564136670936, -629.2359012731501, -256.55872583583533, -574.2550320870828, -182.3532162237635, -760.0912558468493, -797.2686626385738, -536.0517819437734, -720.1678455758852, -407.57637202886536, -843.8429401426472, -603.0988487108285, -1084.063446349496, -840.6401034327167, -588.3580713959719, -681.7219301836734, -503.80958569677796, -12.2278324974553, -798.5434513346434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554781726619461, "mean_inference_ms": 1.6671892688595005, "mean_action_processing_ms": 0.2765184940168722, "mean_env_wait_ms": 3.4047131024074626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011875391006469727, "StateBufferConnector_ms": 0.008118867874145508, "ViewRequirementAgentConnector_ms": 0.19761228561401367}, "num_episodes": 33, "episode_return_max": -12.2278324974553, "episode_return_min": -1447.922833594227, "episode_return_mean": -726.1132236456396, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.62932400910205, "num_env_steps_trained_throughput_per_sec": 309.62932400910205, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12746.111, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12746.035, "sample_time_ms": 1112.566, "learn_time_ms": 11559.72, "learn_throughput": 346.029, "synch_weights_time_ms": 72.928}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1e132_00003", "date": "2024-08-04_07-56-31", "timestamp": 1722738391, "time_this_iter_s": 12.932178020477295, "time_total_s": 114.82578110694885, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bf400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.82578110694885, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.563157894736843, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.965665520727633, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.798506753146649, "policy_loss": -0.009960673016030342, "vf_loss": 7.803704135616621, "vf_explained_var": 0.7468733987460534, "kl": 0.016353946796774228, "entropy": 1.4289944749325514, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -8.281168961937633, "episode_reward_min": -1447.922833594227, "episode_reward_mean": -722.75216871578, "episode_len_mean": 131.64, "episode_media": {}, "episodes_timesteps_total": 13164, "policy_reward_min": {"policy_0": -1447.922833594227}, "policy_reward_max": {"policy_0": -8.281168961937633}, "policy_reward_mean": {"policy_0": -722.75216871578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-807.0944347811383, -578.8108838094739, -1202.939911258269, -1312.919395290209, -698.9373452584684, -69.72970418965019, -59.686868045791535, -1097.9509240097664, -1317.7760123211792, -247.1051921297811, -923.1721724793364, -844.223258122342, -189.13337462692382, -1236.1291407942067, -693.7309410901106, -1241.0432310781666, -120.59042432303383, -658.5686556244011, -366.431711063902, -687.846319943955, -769.7567744646711, -902.7976224714524, -1176.2080720039723, -1032.996964929316, -1095.6464022005205, -842.426565598754, -1135.1101917663036, -279.58215642361773, -72.23755132765282, -604.2624255041878, -563.2574631644756, -363.81793385011827, -164.2090252584766, -1162.960821833819, -538.5783373830075, -1008.9813545596963, -1447.922833594227, -1179.1528928795983, -459.1005575972927, -1235.8087851230741, -1289.5149726262034, -266.31729275610223, -134.61499254065552, -475.6323766382783, -63.88649837576674, -1026.0068710182436, -499.58782595081834, -976.9961194919869, -44.80233215490015, -593.3419100642217, -1002.564136670936, -629.2359012731501, -256.55872583583533, -574.2550320870828, -182.3532162237635, -760.0912558468493, -797.2686626385738, -536.0517819437734, -720.1678455758852, -407.57637202886536, -843.8429401426472, -603.0988487108285, -1084.063446349496, -840.6401034327167, -588.3580713959719, -681.7219301836734, -503.80958569677796, -12.2278324974553, -798.5434513346434, -1296.1281199431862, -654.1989870314384, -935.109445556691, -156.5331775061727, -111.615834391963, -377.1273278002787, -358.5301289842729, -1430.3412203797072, -566.2994984254938, -1115.8935006501113, -1235.385650716674, -499.80372406822744, -1315.9454410641026, -455.222705301149, -440.630868008186, -405.66333842671105, -1034.1864015670399, -246.88098520009115, -655.709539040548, -1242.0382171116937, -962.3015637633431, -567.1405237668903, -1160.7507076954453, -1285.8277990063782, -761.2593438615446, -1003.137292334037, -553.6195641865527, -1313.1342588481598, -1352.6175131211044, -1192.1380611984257, -8.281168961937633], "episode_lengths": [142, 150, 150, 150, 131, 51, 53, 150, 150, 103, 150, 150, 63, 150, 150, 150, 79, 138, 150, 140, 132, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 102, 106, 150, 123, 150, 150, 150, 150, 150, 150, 71, 68, 150, 69, 150, 150, 150, 36, 150, 150, 123, 72, 150, 62, 150, 132, 129, 150, 150, 150, 150, 150, 150, 150, 150, 105, 36, 150, 150, 124, 150, 89, 78, 150, 111, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 84, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42], "policy_policy_0_reward": [-807.0944347811383, -578.8108838094739, -1202.939911258269, -1312.919395290209, -698.9373452584684, -69.72970418965019, -59.686868045791535, -1097.9509240097664, -1317.7760123211792, -247.1051921297811, -923.1721724793364, -844.223258122342, -189.13337462692382, -1236.1291407942067, -693.7309410901106, -1241.0432310781666, -120.59042432303383, -658.5686556244011, -366.431711063902, -687.846319943955, -769.7567744646711, -902.7976224714524, -1176.2080720039723, -1032.996964929316, -1095.6464022005205, -842.426565598754, -1135.1101917663036, -279.58215642361773, -72.23755132765282, -604.2624255041878, -563.2574631644756, -363.81793385011827, -164.2090252584766, -1162.960821833819, -538.5783373830075, -1008.9813545596963, -1447.922833594227, -1179.1528928795983, -459.1005575972927, -1235.8087851230741, -1289.5149726262034, -266.31729275610223, -134.61499254065552, -475.6323766382783, -63.88649837576674, -1026.0068710182436, -499.58782595081834, -976.9961194919869, -44.80233215490015, -593.3419100642217, -1002.564136670936, -629.2359012731501, -256.55872583583533, -574.2550320870828, -182.3532162237635, -760.0912558468493, -797.2686626385738, -536.0517819437734, -720.1678455758852, -407.57637202886536, -843.8429401426472, -603.0988487108285, -1084.063446349496, -840.6401034327167, -588.3580713959719, -681.7219301836734, -503.80958569677796, -12.2278324974553, -798.5434513346434, -1296.1281199431862, -654.1989870314384, -935.109445556691, -156.5331775061727, -111.615834391963, -377.1273278002787, -358.5301289842729, -1430.3412203797072, -566.2994984254938, -1115.8935006501113, -1235.385650716674, -499.80372406822744, -1315.9454410641026, -455.222705301149, -440.630868008186, -405.66333842671105, -1034.1864015670399, -246.88098520009115, -655.709539040548, -1242.0382171116937, -962.3015637633431, -567.1405237668903, -1160.7507076954453, -1285.8277990063782, -761.2593438615446, -1003.137292334037, -553.6195641865527, -1313.1342588481598, -1352.6175131211044, -1192.1380611984257, -8.281168961937633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533123002146377, "mean_inference_ms": 1.6666148837564243, "mean_action_processing_ms": 0.27584078854690225, "mean_env_wait_ms": 3.4090874973065604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011549949645996094, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.19680190086364746}, "num_episodes": 31, "episode_return_max": -8.281168961937633, "episode_return_min": -1447.922833594227, "episode_return_mean": -722.75216871578, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.7907558082961, "num_env_steps_trained_throughput_per_sec": 319.7907558082961, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12722.319, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12722.242, "sample_time_ms": 1111.57, "learn_time_ms": 11538.426, "learn_throughput": 346.668, "synch_weights_time_ms": 71.427}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1e132_00003", "date": "2024-08-04_07-56-44", "timestamp": 1722738404, "time_this_iter_s": 12.521072387695312, "time_total_s": 127.34685349464417, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1225f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.34685349464417, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.98333333333333, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.767806168397264, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.323797136545181, "policy_loss": -0.014789566859932771, "vf_loss": 6.333081685503324, "vf_explained_var": 0.8946366277833779, "kl": 0.018765152822985933, "entropy": 1.245354518170158, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -8.281168961937633, "episode_reward_min": -1455.130044500652, "episode_reward_mean": -673.665203058991, "episode_len_mean": 129.79, "episode_media": {}, "episodes_timesteps_total": 12979, "policy_reward_min": {"policy_0": -1455.130044500652}, "policy_reward_max": {"policy_0": -8.281168961937633}, "policy_reward_mean": {"policy_0": -673.665203058991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-563.2574631644756, -363.81793385011827, -164.2090252584766, -1162.960821833819, -538.5783373830075, -1008.9813545596963, -1447.922833594227, -1179.1528928795983, -459.1005575972927, -1235.8087851230741, -1289.5149726262034, -266.31729275610223, -134.61499254065552, -475.6323766382783, -63.88649837576674, -1026.0068710182436, -499.58782595081834, -976.9961194919869, -44.80233215490015, -593.3419100642217, -1002.564136670936, -629.2359012731501, -256.55872583583533, -574.2550320870828, -182.3532162237635, -760.0912558468493, -797.2686626385738, -536.0517819437734, -720.1678455758852, -407.57637202886536, -843.8429401426472, -603.0988487108285, -1084.063446349496, -840.6401034327167, -588.3580713959719, -681.7219301836734, -503.80958569677796, -12.2278324974553, -798.5434513346434, -1296.1281199431862, -654.1989870314384, -935.109445556691, -156.5331775061727, -111.615834391963, -377.1273278002787, -358.5301289842729, -1430.3412203797072, -566.2994984254938, -1115.8935006501113, -1235.385650716674, -499.80372406822744, -1315.9454410641026, -455.222705301149, -440.630868008186, -405.66333842671105, -1034.1864015670399, -246.88098520009115, -655.709539040548, -1242.0382171116937, -962.3015637633431, -567.1405237668903, -1160.7507076954453, -1285.8277990063782, -761.2593438615446, -1003.137292334037, -553.6195641865527, -1313.1342588481598, -1352.6175131211044, -1192.1380611984257, -8.281168961937633, -519.563328188227, -628.7663864785343, -1187.5367844364805, -715.6123034520328, -288.2299653754445, -53.78985854300373, -276.07406123831, -285.0825123943647, -1005.6969047062345, -878.32644633808, -46.18292303610017, -926.7108931971965, -789.1189454229058, -167.78891785307212, -448.177993398997, -680.7451100153727, -323.2473740723146, -482.1858045885561, -909.355514613926, -136.3065833821581, -121.74332172788942, -80.78176269967882, -443.8477119604137, -975.3221266533885, -1148.2456668464338, -1138.3178228479821, -920.8106144614401, -234.2814481529715, -89.16893066949716, -1455.130044500652], "episode_lengths": [150, 102, 106, 150, 123, 150, 150, 150, 150, 150, 150, 71, 68, 150, 69, 150, 150, 150, 36, 150, 150, 123, 72, 150, 62, 150, 132, 129, 150, 150, 150, 150, 150, 150, 150, 150, 105, 36, 150, 150, 124, 150, 89, 78, 150, 111, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 84, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 137, 49, 77, 150, 150, 150, 63, 150, 150, 56, 150, 150, 150, 150, 150, 70, 75, 55, 150, 150, 150, 150, 150, 112, 66, 150], "policy_policy_0_reward": [-563.2574631644756, -363.81793385011827, -164.2090252584766, -1162.960821833819, -538.5783373830075, -1008.9813545596963, -1447.922833594227, -1179.1528928795983, -459.1005575972927, -1235.8087851230741, -1289.5149726262034, -266.31729275610223, -134.61499254065552, -475.6323766382783, -63.88649837576674, -1026.0068710182436, -499.58782595081834, -976.9961194919869, -44.80233215490015, -593.3419100642217, -1002.564136670936, -629.2359012731501, -256.55872583583533, -574.2550320870828, -182.3532162237635, -760.0912558468493, -797.2686626385738, -536.0517819437734, -720.1678455758852, -407.57637202886536, -843.8429401426472, -603.0988487108285, -1084.063446349496, -840.6401034327167, -588.3580713959719, -681.7219301836734, -503.80958569677796, -12.2278324974553, -798.5434513346434, -1296.1281199431862, -654.1989870314384, -935.109445556691, -156.5331775061727, -111.615834391963, -377.1273278002787, -358.5301289842729, -1430.3412203797072, -566.2994984254938, -1115.8935006501113, -1235.385650716674, -499.80372406822744, -1315.9454410641026, -455.222705301149, -440.630868008186, -405.66333842671105, -1034.1864015670399, -246.88098520009115, -655.709539040548, -1242.0382171116937, -962.3015637633431, -567.1405237668903, -1160.7507076954453, -1285.8277990063782, -761.2593438615446, -1003.137292334037, -553.6195641865527, -1313.1342588481598, -1352.6175131211044, -1192.1380611984257, -8.281168961937633, -519.563328188227, -628.7663864785343, -1187.5367844364805, -715.6123034520328, -288.2299653754445, -53.78985854300373, -276.07406123831, -285.0825123943647, -1005.6969047062345, -878.32644633808, -46.18292303610017, -926.7108931971965, -789.1189454229058, -167.78891785307212, -448.177993398997, -680.7451100153727, -323.2473740723146, -482.1858045885561, -909.355514613926, -136.3065833821581, -121.74332172788942, -80.78176269967882, -443.8477119604137, -975.3221266533885, -1148.2456668464338, -1138.3178228479821, -920.8106144614401, -234.2814481529715, -89.16893066949716, -1455.130044500652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519806905019995, "mean_inference_ms": 1.6653252195330848, "mean_action_processing_ms": 0.2756259353266631, "mean_env_wait_ms": 3.4100182283181395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01163625717163086, "StateBufferConnector_ms": 0.008051872253417969, "ViewRequirementAgentConnector_ms": 0.19931268692016602}, "num_episodes": 30, "episode_return_max": -8.281168961937633, "episode_return_min": -1455.130044500652, "episode_return_mean": -673.665203058991, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.8670774254699, "num_env_steps_trained_throughput_per_sec": 305.8670774254699, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12733.269, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12733.192, "sample_time_ms": 1109.556, "learn_time_ms": 11553.096, "learn_throughput": 346.228, "synch_weights_time_ms": 69.729}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1e132_00003", "date": "2024-08-04_07-56-57", "timestamp": 1722738417, "time_this_iter_s": 13.090604066848755, "time_total_s": 140.43745756149292, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ac9d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.43745756149292, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.85555555555555, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.64622367521127, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.660969482362271, "policy_loss": -0.010858602969771406, "vf_loss": 6.667080587148666, "vf_explained_var": 0.8209002476185561, "kl": 0.01625610604091891, "entropy": 1.293193159252405, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -8.281168961937633, "episode_reward_min": -1455.130044500652, "episode_reward_mean": -696.2397442825618, "episode_len_mean": 133.23, "episode_media": {}, "episodes_timesteps_total": 13323, "policy_reward_min": {"policy_0": -1455.130044500652}, "policy_reward_max": {"policy_0": -8.281168961937633}, "policy_reward_mean": {"policy_0": -696.2397442825618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.8429401426472, -603.0988487108285, -1084.063446349496, -840.6401034327167, -588.3580713959719, -681.7219301836734, -503.80958569677796, -12.2278324974553, -798.5434513346434, -1296.1281199431862, -654.1989870314384, -935.109445556691, -156.5331775061727, -111.615834391963, -377.1273278002787, -358.5301289842729, -1430.3412203797072, -566.2994984254938, -1115.8935006501113, -1235.385650716674, -499.80372406822744, -1315.9454410641026, -455.222705301149, -440.630868008186, -405.66333842671105, -1034.1864015670399, -246.88098520009115, -655.709539040548, -1242.0382171116937, -962.3015637633431, -567.1405237668903, -1160.7507076954453, -1285.8277990063782, -761.2593438615446, -1003.137292334037, -553.6195641865527, -1313.1342588481598, -1352.6175131211044, -1192.1380611984257, -8.281168961937633, -519.563328188227, -628.7663864785343, -1187.5367844364805, -715.6123034520328, -288.2299653754445, -53.78985854300373, -276.07406123831, -285.0825123943647, -1005.6969047062345, -878.32644633808, -46.18292303610017, -926.7108931971965, -789.1189454229058, -167.78891785307212, -448.177993398997, -680.7451100153727, -323.2473740723146, -482.1858045885561, -909.355514613926, -136.3065833821581, -121.74332172788942, -80.78176269967882, -443.8477119604137, -975.3221266533885, -1148.2456668464338, -1138.3178228479821, -920.8106144614401, -234.2814481529715, -89.16893066949716, -1455.130044500652, -1271.1045733393216, -558.1955393268606, -723.9161680764829, -782.9814196702098, -1170.0383589147777, -1240.5964483536975, -519.1130918865747, -585.3187145715896, -1055.8585049157273, -894.6619437617115, -465.22135268994106, -495.19558189329115, -155.55615637309847, -457.98147113733233, -510.9663251474985, -70.21908843560237, -401.3052280928476, -1036.1987206512101, -474.441734535974, -727.6001501395659, -613.156052201831, -260.81122651672734, -1117.4966596648908, -1394.6163912604457, -773.8984190180871, -1210.501406047805, -114.82723773299513, -857.5108324679973, -935.8591288553887, -742.9203236632474], "episode_lengths": [150, 150, 150, 150, 150, 150, 105, 36, 150, 150, 124, 150, 89, 78, 150, 111, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 84, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 137, 49, 77, 150, 150, 150, 63, 150, 150, 56, 150, 150, 150, 150, 150, 70, 75, 55, 150, 150, 150, 150, 150, 112, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 117, 150, 65, 150, 150, 150, 136, 150, 81, 150, 150, 138, 150, 62, 150, 150, 150], "policy_policy_0_reward": [-843.8429401426472, -603.0988487108285, -1084.063446349496, -840.6401034327167, -588.3580713959719, -681.7219301836734, -503.80958569677796, -12.2278324974553, -798.5434513346434, -1296.1281199431862, -654.1989870314384, -935.109445556691, -156.5331775061727, -111.615834391963, -377.1273278002787, -358.5301289842729, -1430.3412203797072, -566.2994984254938, -1115.8935006501113, -1235.385650716674, -499.80372406822744, -1315.9454410641026, -455.222705301149, -440.630868008186, -405.66333842671105, -1034.1864015670399, -246.88098520009115, -655.709539040548, -1242.0382171116937, -962.3015637633431, -567.1405237668903, -1160.7507076954453, -1285.8277990063782, -761.2593438615446, -1003.137292334037, -553.6195641865527, -1313.1342588481598, -1352.6175131211044, -1192.1380611984257, -8.281168961937633, -519.563328188227, -628.7663864785343, -1187.5367844364805, -715.6123034520328, -288.2299653754445, -53.78985854300373, -276.07406123831, -285.0825123943647, -1005.6969047062345, -878.32644633808, -46.18292303610017, -926.7108931971965, -789.1189454229058, -167.78891785307212, -448.177993398997, -680.7451100153727, -323.2473740723146, -482.1858045885561, -909.355514613926, -136.3065833821581, -121.74332172788942, -80.78176269967882, -443.8477119604137, -975.3221266533885, -1148.2456668464338, -1138.3178228479821, -920.8106144614401, -234.2814481529715, -89.16893066949716, -1455.130044500652, -1271.1045733393216, -558.1955393268606, -723.9161680764829, -782.9814196702098, -1170.0383589147777, -1240.5964483536975, -519.1130918865747, -585.3187145715896, -1055.8585049157273, -894.6619437617115, -465.22135268994106, -495.19558189329115, -155.55615637309847, -457.98147113733233, -510.9663251474985, -70.21908843560237, -401.3052280928476, -1036.1987206512101, -474.441734535974, -727.6001501395659, -613.156052201831, -260.81122651672734, -1117.4966596648908, -1394.6163912604457, -773.8984190180871, -1210.501406047805, -114.82723773299513, -857.5108324679973, -935.8591288553887, -742.9203236632474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516980381514245, "mean_inference_ms": 1.6636611484895105, "mean_action_processing_ms": 0.2752227829505177, "mean_env_wait_ms": 3.409044855146037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01163625717163086, "StateBufferConnector_ms": 0.008120536804199219, "ViewRequirementAgentConnector_ms": 0.1960620880126953}, "num_episodes": 30, "episode_return_max": -8.281168961937633, "episode_return_min": -1455.130044500652, "episode_return_mean": -696.2397442825618, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.76048717602924, "num_env_steps_trained_throughput_per_sec": 322.76048717602924, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12683.712, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12683.635, "sample_time_ms": 1112.157, "learn_time_ms": 11500.875, "learn_throughput": 347.8, "synch_weights_time_ms": 69.784}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1e132_00003", "date": "2024-08-04_07-57-09", "timestamp": 1722738429, "time_this_iter_s": 12.406077861785889, "time_total_s": 152.8435354232788, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.8435354232788, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.799999999999997, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.91769596536954, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.591855596502622, "policy_loss": -0.014194438082146614, "vf_loss": 6.599926451345285, "vf_explained_var": 0.8777651210625966, "kl": 0.020834946299070605, "entropy": 1.268931388979157, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -8.281168961937633, "episode_reward_min": -1455.130044500652, "episode_reward_mean": -699.8083030980266, "episode_len_mean": 132.37, "episode_media": {}, "episodes_timesteps_total": 13237, "policy_reward_min": {"policy_0": -1455.130044500652}, "policy_reward_max": {"policy_0": -8.281168961937633}, "policy_reward_mean": {"policy_0": -699.8083030980266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-567.1405237668903, -1160.7507076954453, -1285.8277990063782, -761.2593438615446, -1003.137292334037, -553.6195641865527, -1313.1342588481598, -1352.6175131211044, -1192.1380611984257, -8.281168961937633, -519.563328188227, -628.7663864785343, -1187.5367844364805, -715.6123034520328, -288.2299653754445, -53.78985854300373, -276.07406123831, -285.0825123943647, -1005.6969047062345, -878.32644633808, -46.18292303610017, -926.7108931971965, -789.1189454229058, -167.78891785307212, -448.177993398997, -680.7451100153727, -323.2473740723146, -482.1858045885561, -909.355514613926, -136.3065833821581, -121.74332172788942, -80.78176269967882, -443.8477119604137, -975.3221266533885, -1148.2456668464338, -1138.3178228479821, -920.8106144614401, -234.2814481529715, -89.16893066949716, -1455.130044500652, -1271.1045733393216, -558.1955393268606, -723.9161680764829, -782.9814196702098, -1170.0383589147777, -1240.5964483536975, -519.1130918865747, -585.3187145715896, -1055.8585049157273, -894.6619437617115, -465.22135268994106, -495.19558189329115, -155.55615637309847, -457.98147113733233, -510.9663251474985, -70.21908843560237, -401.3052280928476, -1036.1987206512101, -474.441734535974, -727.6001501395659, -613.156052201831, -260.81122651672734, -1117.4966596648908, -1394.6163912604457, -773.8984190180871, -1210.501406047805, -114.82723773299513, -857.5108324679973, -935.8591288553887, -742.9203236632474, -489.5479011526119, -1415.172514694219, -27.013556511860607, -620.2395773757653, -953.9151476989979, -1136.9672512739776, -830.4754929792313, -687.1687733391639, -211.17574810034256, -431.68922300306485, -1254.8703181128385, -475.9362307745132, -275.683778428962, -925.2187354998092, -1117.6841456809886, -58.54978358720138, -268.4016967931079, -1354.8099459574046, -1206.215623389904, -1051.4967237547676, -114.8485554085461, -662.3319560673399, -695.5338249659103, -853.2225535314774, -1100.9794007207267, -1130.3322397162183, -676.7013578455341, -183.46089359431284, -886.9384288967539, -712.126387372252], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 137, 49, 77, 150, 150, 150, 63, 150, 150, 56, 150, 150, 150, 150, 150, 70, 75, 55, 150, 150, 150, 150, 150, 112, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 117, 150, 65, 150, 150, 150, 136, 150, 81, 150, 150, 138, 150, 62, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 90, 150, 150, 106, 83, 150, 150, 65, 123, 150, 150, 150, 75, 128, 150, 150, 150, 150, 150, 86, 150, 150], "policy_policy_0_reward": [-567.1405237668903, -1160.7507076954453, -1285.8277990063782, -761.2593438615446, -1003.137292334037, -553.6195641865527, -1313.1342588481598, -1352.6175131211044, -1192.1380611984257, -8.281168961937633, -519.563328188227, -628.7663864785343, -1187.5367844364805, -715.6123034520328, -288.2299653754445, -53.78985854300373, -276.07406123831, -285.0825123943647, -1005.6969047062345, -878.32644633808, -46.18292303610017, -926.7108931971965, -789.1189454229058, -167.78891785307212, -448.177993398997, -680.7451100153727, -323.2473740723146, -482.1858045885561, -909.355514613926, -136.3065833821581, -121.74332172788942, -80.78176269967882, -443.8477119604137, -975.3221266533885, -1148.2456668464338, -1138.3178228479821, -920.8106144614401, -234.2814481529715, -89.16893066949716, -1455.130044500652, -1271.1045733393216, -558.1955393268606, -723.9161680764829, -782.9814196702098, -1170.0383589147777, -1240.5964483536975, -519.1130918865747, -585.3187145715896, -1055.8585049157273, -894.6619437617115, -465.22135268994106, -495.19558189329115, -155.55615637309847, -457.98147113733233, -510.9663251474985, -70.21908843560237, -401.3052280928476, -1036.1987206512101, -474.441734535974, -727.6001501395659, -613.156052201831, -260.81122651672734, -1117.4966596648908, -1394.6163912604457, -773.8984190180871, -1210.501406047805, -114.82723773299513, -857.5108324679973, -935.8591288553887, -742.9203236632474, -489.5479011526119, -1415.172514694219, -27.013556511860607, -620.2395773757653, -953.9151476989979, -1136.9672512739776, -830.4754929792313, -687.1687733391639, -211.17574810034256, -431.68922300306485, -1254.8703181128385, -475.9362307745132, -275.683778428962, -925.2187354998092, -1117.6841456809886, -58.54978358720138, -268.4016967931079, -1354.8099459574046, -1206.215623389904, -1051.4967237547676, -114.8485554085461, -662.3319560673399, -695.5338249659103, -853.2225535314774, -1100.9794007207267, -1130.3322397162183, -676.7013578455341, -183.46089359431284, -886.9384288967539, -712.126387372252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515095585687715, "mean_inference_ms": 1.6640788303098557, "mean_action_processing_ms": 0.27515399451879236, "mean_env_wait_ms": 3.4128662957510527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011634588241577148, "StateBufferConnector_ms": 0.008116483688354492, "ViewRequirementAgentConnector_ms": 0.20134329795837402}, "num_episodes": 30, "episode_return_max": -8.281168961937633, "episode_return_min": -1455.130044500652, "episode_return_mean": -699.8083030980266, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.0006469482315, "num_env_steps_trained_throughput_per_sec": 316.0006469482315, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12665.891, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12665.81, "sample_time_ms": 1109.45, "learn_time_ms": 11487.42, "learn_throughput": 348.207, "synch_weights_time_ms": 68.138}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1e132_00003", "date": "2024-08-04_07-57-22", "timestamp": 1722738442, "time_this_iter_s": 12.670383930206299, "time_total_s": 165.5139193534851, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1225f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.5139193534851, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.083333333333332, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.19362046321233, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.602047631392876, "policy_loss": -0.009918560661026277, "vf_loss": 5.605816705028216, "vf_explained_var": 0.8681379610051712, "kl": 0.013972729896401385, "entropy": 1.3824344856043658, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -27.013556511860607, "episode_reward_min": -1470.8202898395082, "episode_reward_mean": -745.51328388283, "episode_len_mean": 134.93, "episode_media": {}, "episodes_timesteps_total": 13493, "policy_reward_min": {"policy_0": -1470.8202898395082}, "policy_reward_max": {"policy_0": -27.013556511860607}, "policy_reward_mean": {"policy_0": -745.51328388283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-136.3065833821581, -121.74332172788942, -80.78176269967882, -443.8477119604137, -975.3221266533885, -1148.2456668464338, -1138.3178228479821, -920.8106144614401, -234.2814481529715, -89.16893066949716, -1455.130044500652, -1271.1045733393216, -558.1955393268606, -723.9161680764829, -782.9814196702098, -1170.0383589147777, -1240.5964483536975, -519.1130918865747, -585.3187145715896, -1055.8585049157273, -894.6619437617115, -465.22135268994106, -495.19558189329115, -155.55615637309847, -457.98147113733233, -510.9663251474985, -70.21908843560237, -401.3052280928476, -1036.1987206512101, -474.441734535974, -727.6001501395659, -613.156052201831, -260.81122651672734, -1117.4966596648908, -1394.6163912604457, -773.8984190180871, -1210.501406047805, -114.82723773299513, -857.5108324679973, -935.8591288553887, -742.9203236632474, -489.5479011526119, -1415.172514694219, -27.013556511860607, -620.2395773757653, -953.9151476989979, -1136.9672512739776, -830.4754929792313, -687.1687733391639, -211.17574810034256, -431.68922300306485, -1254.8703181128385, -475.9362307745132, -275.683778428962, -925.2187354998092, -1117.6841456809886, -58.54978358720138, -268.4016967931079, -1354.8099459574046, -1206.215623389904, -1051.4967237547676, -114.8485554085461, -662.3319560673399, -695.5338249659103, -853.2225535314774, -1100.9794007207267, -1130.3322397162183, -676.7013578455341, -183.46089359431284, -886.9384288967539, -712.126387372252, -822.9711292411884, -701.6062517459269, -100.18777571123519, -791.3313019808776, -816.4292101262515, -367.1438311164561, -604.8344158201197, -1151.9405342105936, -935.2678647115771, -820.306375041743, -394.0596286895598, -874.0537245629828, -903.4192612655498, -686.5292867526316, -1278.9778312342064, -1257.894607863097, -1002.467112955513, -907.0690450952691, -780.097186526786, -744.0994462687438, -1466.530126497948, -939.9021276438662, -1470.8202898395082, -1210.2095366199999, -60.77537936897759, -800.2293252275853, -743.4923897328134, -1141.9382813140032, -606.0130616449527], "episode_lengths": [70, 75, 55, 150, 150, 150, 150, 150, 112, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 117, 150, 65, 150, 150, 150, 136, 150, 81, 150, 150, 138, 150, 62, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 90, 150, 150, 106, 83, 150, 150, 65, 123, 150, 150, 150, 75, 128, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150], "policy_policy_0_reward": [-136.3065833821581, -121.74332172788942, -80.78176269967882, -443.8477119604137, -975.3221266533885, -1148.2456668464338, -1138.3178228479821, -920.8106144614401, -234.2814481529715, -89.16893066949716, -1455.130044500652, -1271.1045733393216, -558.1955393268606, -723.9161680764829, -782.9814196702098, -1170.0383589147777, -1240.5964483536975, -519.1130918865747, -585.3187145715896, -1055.8585049157273, -894.6619437617115, -465.22135268994106, -495.19558189329115, -155.55615637309847, -457.98147113733233, -510.9663251474985, -70.21908843560237, -401.3052280928476, -1036.1987206512101, -474.441734535974, -727.6001501395659, -613.156052201831, -260.81122651672734, -1117.4966596648908, -1394.6163912604457, -773.8984190180871, -1210.501406047805, -114.82723773299513, -857.5108324679973, -935.8591288553887, -742.9203236632474, -489.5479011526119, -1415.172514694219, -27.013556511860607, -620.2395773757653, -953.9151476989979, -1136.9672512739776, -830.4754929792313, -687.1687733391639, -211.17574810034256, -431.68922300306485, -1254.8703181128385, -475.9362307745132, -275.683778428962, -925.2187354998092, -1117.6841456809886, -58.54978358720138, -268.4016967931079, -1354.8099459574046, -1206.215623389904, -1051.4967237547676, -114.8485554085461, -662.3319560673399, -695.5338249659103, -853.2225535314774, -1100.9794007207267, -1130.3322397162183, -676.7013578455341, -183.46089359431284, -886.9384288967539, -712.126387372252, -822.9711292411884, -701.6062517459269, -100.18777571123519, -791.3313019808776, -816.4292101262515, -367.1438311164561, -604.8344158201197, -1151.9405342105936, -935.2678647115771, -820.306375041743, -394.0596286895598, -874.0537245629828, -903.4192612655498, -686.5292867526316, -1278.9778312342064, -1257.894607863097, -1002.467112955513, -907.0690450952691, -780.097186526786, -744.0994462687438, -1466.530126497948, -939.9021276438662, -1470.8202898395082, -1210.2095366199999, -60.77537936897759, -800.2293252275853, -743.4923897328134, -1141.9382813140032, -606.0130616449527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519156301393345, "mean_inference_ms": 1.664382796705097, "mean_action_processing_ms": 0.2750277229052989, "mean_env_wait_ms": 3.4159293836477365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01159358024597168, "StateBufferConnector_ms": 0.008084297180175781, "ViewRequirementAgentConnector_ms": 0.2002723217010498}, "num_episodes": 29, "episode_return_max": -27.013556511860607, "episode_return_min": -1470.8202898395082, "episode_return_mean": -745.51328388283, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.95267655995144, "num_env_steps_trained_throughput_per_sec": 301.95267655995144, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12717.928, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12717.846, "sample_time_ms": 1108.852, "learn_time_ms": 11538.059, "learn_throughput": 346.679, "synch_weights_time_ms": 70.119}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1e132_00003", "date": "2024-08-04_07-57-35", "timestamp": 1722738455, "time_this_iter_s": 13.261367797851562, "time_total_s": 178.77528715133667, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac123b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.77528715133667, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.431578947368422, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.06553837259611, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.083912954727809, "policy_loss": -0.011604132926246772, "vf_loss": 6.088824166357517, "vf_explained_var": 0.9212304554258783, "kl": 0.015166554987111643, "entropy": 1.3201366640006502, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -22.893959410341587, "episode_reward_min": -1470.8202898395082, "episode_reward_mean": -763.0754386673959, "episode_len_mean": 133.94, "episode_media": {}, "episodes_timesteps_total": 13394, "policy_reward_min": {"policy_0": -1470.8202898395082}, "policy_reward_max": {"policy_0": -22.893959410341587}, "policy_reward_mean": {"policy_0": -763.0754386673959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-260.81122651672734, -1117.4966596648908, -1394.6163912604457, -773.8984190180871, -1210.501406047805, -114.82723773299513, -857.5108324679973, -935.8591288553887, -742.9203236632474, -489.5479011526119, -1415.172514694219, -27.013556511860607, -620.2395773757653, -953.9151476989979, -1136.9672512739776, -830.4754929792313, -687.1687733391639, -211.17574810034256, -431.68922300306485, -1254.8703181128385, -475.9362307745132, -275.683778428962, -925.2187354998092, -1117.6841456809886, -58.54978358720138, -268.4016967931079, -1354.8099459574046, -1206.215623389904, -1051.4967237547676, -114.8485554085461, -662.3319560673399, -695.5338249659103, -853.2225535314774, -1100.9794007207267, -1130.3322397162183, -676.7013578455341, -183.46089359431284, -886.9384288967539, -712.126387372252, -822.9711292411884, -701.6062517459269, -100.18777571123519, -791.3313019808776, -816.4292101262515, -367.1438311164561, -604.8344158201197, -1151.9405342105936, -935.2678647115771, -820.306375041743, -394.0596286895598, -874.0537245629828, -903.4192612655498, -686.5292867526316, -1278.9778312342064, -1257.894607863097, -1002.467112955513, -907.0690450952691, -780.097186526786, -744.0994462687438, -1466.530126497948, -939.9021276438662, -1470.8202898395082, -1210.2095366199999, -60.77537936897759, -800.2293252275853, -743.4923897328134, -1141.9382813140032, -606.0130616449527, -901.301447272476, -829.3196548187523, -22.893959410341587, -458.60091395362707, -1023.5896980456987, -1142.9441372809943, -911.0613997879705, -140.66870913949927, -709.0700647073494, -1218.2062384502449, -617.3712104319868, -1378.7592245489611, -535.1217657404361, -1176.0536844829587, -91.82209867487057, -1279.4318260991388, -194.69760038049256, -897.8164384000977, -1030.6458515020586, -317.1154912637447, -975.098122783267, -942.0887513221123, -65.5998546758065, -644.6606962233869, -1020.3151724373485, -262.9489948983117, -539.0762563250651, -214.269479212527, -1271.306391737893, -757.6446998444728, -120.73165775105568, -1019.5666448713065], "episode_lengths": [81, 150, 150, 138, 150, 62, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 90, 150, 150, 106, 83, 150, 150, 65, 123, 150, 150, 150, 75, 128, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 94, 150, 150, 118, 150, 150, 150, 58, 150, 111, 150, 150, 104, 150, 150, 69, 150, 150, 89, 123, 85, 150, 150, 85, 150], "policy_policy_0_reward": [-260.81122651672734, -1117.4966596648908, -1394.6163912604457, -773.8984190180871, -1210.501406047805, -114.82723773299513, -857.5108324679973, -935.8591288553887, -742.9203236632474, -489.5479011526119, -1415.172514694219, -27.013556511860607, -620.2395773757653, -953.9151476989979, -1136.9672512739776, -830.4754929792313, -687.1687733391639, -211.17574810034256, -431.68922300306485, -1254.8703181128385, -475.9362307745132, -275.683778428962, -925.2187354998092, -1117.6841456809886, -58.54978358720138, -268.4016967931079, -1354.8099459574046, -1206.215623389904, -1051.4967237547676, -114.8485554085461, -662.3319560673399, -695.5338249659103, -853.2225535314774, -1100.9794007207267, -1130.3322397162183, -676.7013578455341, -183.46089359431284, -886.9384288967539, -712.126387372252, -822.9711292411884, -701.6062517459269, -100.18777571123519, -791.3313019808776, -816.4292101262515, -367.1438311164561, -604.8344158201197, -1151.9405342105936, -935.2678647115771, -820.306375041743, -394.0596286895598, -874.0537245629828, -903.4192612655498, -686.5292867526316, -1278.9778312342064, -1257.894607863097, -1002.467112955513, -907.0690450952691, -780.097186526786, -744.0994462687438, -1466.530126497948, -939.9021276438662, -1470.8202898395082, -1210.2095366199999, -60.77537936897759, -800.2293252275853, -743.4923897328134, -1141.9382813140032, -606.0130616449527, -901.301447272476, -829.3196548187523, -22.893959410341587, -458.60091395362707, -1023.5896980456987, -1142.9441372809943, -911.0613997879705, -140.66870913949927, -709.0700647073494, -1218.2062384502449, -617.3712104319868, -1378.7592245489611, -535.1217657404361, -1176.0536844829587, -91.82209867487057, -1279.4318260991388, -194.69760038049256, -897.8164384000977, -1030.6458515020586, -317.1154912637447, -975.098122783267, -942.0887513221123, -65.5998546758065, -644.6606962233869, -1020.3151724373485, -262.9489948983117, -539.0762563250651, -214.269479212527, -1271.306391737893, -757.6446998444728, -120.73165775105568, -1019.5666448713065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517513651721786, "mean_inference_ms": 1.6648197877597009, "mean_action_processing_ms": 0.2748223187132326, "mean_env_wait_ms": 3.4195006781844426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01199197769165039, "StateBufferConnector_ms": 0.00813746452331543, "ViewRequirementAgentConnector_ms": 0.19811749458312988}, "num_episodes": 32, "episode_return_max": -22.893959410341587, "episode_return_min": -1470.8202898395082, "episode_return_mean": -763.0754386673959, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.67314606492295, "num_env_steps_trained_throughput_per_sec": 503.67314606492295, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12255.095, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12255.014, "sample_time_ms": 1112.545, "learn_time_ms": 11073.042, "learn_throughput": 361.238, "synch_weights_time_ms": 68.61}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1e132_00003", "date": "2024-08-04_07-57-43", "timestamp": 1722738463, "time_this_iter_s": 7.954887628555298, "time_total_s": 186.73017477989197, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1239a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.73017477989197, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.941666666666666, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.20626656214397, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.861727498968443, "policy_loss": -0.012332459250076984, "vf_loss": 5.867353354394436, "vf_explained_var": 0.9555330366517106, "kl": 0.015183963377724792, "entropy": 1.2617217920720578, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -22.893959410341587, "episode_reward_min": -1470.8202898395082, "episode_reward_mean": -754.3939443286316, "episode_len_mean": 135.16, "episode_media": {}, "episodes_timesteps_total": 13516, "policy_reward_min": {"policy_0": -1470.8202898395082}, "policy_reward_max": {"policy_0": -22.893959410341587}, "policy_reward_mean": {"policy_0": -754.3939443286316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1051.4967237547676, -114.8485554085461, -662.3319560673399, -695.5338249659103, -853.2225535314774, -1100.9794007207267, -1130.3322397162183, -676.7013578455341, -183.46089359431284, -886.9384288967539, -712.126387372252, -822.9711292411884, -701.6062517459269, -100.18777571123519, -791.3313019808776, -816.4292101262515, -367.1438311164561, -604.8344158201197, -1151.9405342105936, -935.2678647115771, -820.306375041743, -394.0596286895598, -874.0537245629828, -903.4192612655498, -686.5292867526316, -1278.9778312342064, -1257.894607863097, -1002.467112955513, -907.0690450952691, -780.097186526786, -744.0994462687438, -1466.530126497948, -939.9021276438662, -1470.8202898395082, -1210.2095366199999, -60.77537936897759, -800.2293252275853, -743.4923897328134, -1141.9382813140032, -606.0130616449527, -901.301447272476, -829.3196548187523, -22.893959410341587, -458.60091395362707, -1023.5896980456987, -1142.9441372809943, -911.0613997879705, -140.66870913949927, -709.0700647073494, -1218.2062384502449, -617.3712104319868, -1378.7592245489611, -535.1217657404361, -1176.0536844829587, -91.82209867487057, -1279.4318260991388, -194.69760038049256, -897.8164384000977, -1030.6458515020586, -317.1154912637447, -975.098122783267, -942.0887513221123, -65.5998546758065, -644.6606962233869, -1020.3151724373485, -262.9489948983117, -539.0762563250651, -214.269479212527, -1271.306391737893, -757.6446998444728, -120.73165775105568, -1019.5666448713065, -810.1196803178494, -961.8207258990909, -364.22173035477783, -751.2342837884306, -865.8390705224526, -1309.5625751675555, -253.7446633593007, -171.39685912543908, -1020.4854498256511, -806.586366754329, -920.8043267296887, -937.6327298935959, -693.9635459327752, -934.7515734239782, -161.85993881147212, -349.0845382703341, -973.8601405428091, -506.34119511874604, -1161.3289642160848, -852.3174535746508, -150.45745992774437, -1123.158953004345, -591.5671459623785, -738.0656931171277, -1031.0782975559503, -671.444155923599, -173.2997703009187, -995.0003482840204], "episode_lengths": [150, 75, 128, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 94, 150, 150, 118, 150, 150, 150, 58, 150, 111, 150, 150, 104, 150, 150, 69, 150, 150, 89, 123, 85, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 106, 57, 150, 150, 150, 150, 150, 150, 77, 94, 150, 150, 150, 150, 78, 150, 119, 150, 150, 150, 81, 150], "policy_policy_0_reward": [-1051.4967237547676, -114.8485554085461, -662.3319560673399, -695.5338249659103, -853.2225535314774, -1100.9794007207267, -1130.3322397162183, -676.7013578455341, -183.46089359431284, -886.9384288967539, -712.126387372252, -822.9711292411884, -701.6062517459269, -100.18777571123519, -791.3313019808776, -816.4292101262515, -367.1438311164561, -604.8344158201197, -1151.9405342105936, -935.2678647115771, -820.306375041743, -394.0596286895598, -874.0537245629828, -903.4192612655498, -686.5292867526316, -1278.9778312342064, -1257.894607863097, -1002.467112955513, -907.0690450952691, -780.097186526786, -744.0994462687438, -1466.530126497948, -939.9021276438662, -1470.8202898395082, -1210.2095366199999, -60.77537936897759, -800.2293252275853, -743.4923897328134, -1141.9382813140032, -606.0130616449527, -901.301447272476, -829.3196548187523, -22.893959410341587, -458.60091395362707, -1023.5896980456987, -1142.9441372809943, -911.0613997879705, -140.66870913949927, -709.0700647073494, -1218.2062384502449, -617.3712104319868, -1378.7592245489611, -535.1217657404361, -1176.0536844829587, -91.82209867487057, -1279.4318260991388, -194.69760038049256, -897.8164384000977, -1030.6458515020586, -317.1154912637447, -975.098122783267, -942.0887513221123, -65.5998546758065, -644.6606962233869, -1020.3151724373485, -262.9489948983117, -539.0762563250651, -214.269479212527, -1271.306391737893, -757.6446998444728, -120.73165775105568, -1019.5666448713065, -810.1196803178494, -961.8207258990909, -364.22173035477783, -751.2342837884306, -865.8390705224526, -1309.5625751675555, -253.7446633593007, -171.39685912543908, -1020.4854498256511, -806.586366754329, -920.8043267296887, -937.6327298935959, -693.9635459327752, -934.7515734239782, -161.85993881147212, -349.0845382703341, -973.8601405428091, -506.34119511874604, -1161.3289642160848, -852.3174535746508, -150.45745992774437, -1123.158953004345, -591.5671459623785, -738.0656931171277, -1031.0782975559503, -671.444155923599, -173.2997703009187, -995.0003482840204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5514078511129905, "mean_inference_ms": 1.6643245948185912, "mean_action_processing_ms": 0.27456564024148333, "mean_env_wait_ms": 3.4199492183333557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011776447296142578, "StateBufferConnector_ms": 0.00795292854309082, "ViewRequirementAgentConnector_ms": 0.19286465644836426}, "num_episodes": 28, "episode_return_max": -22.893959410341587, "episode_return_min": -1470.8202898395082, "episode_return_mean": -754.3939443286316, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.20842049441984, "num_env_steps_trained_throughput_per_sec": 319.20842049441984, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12171.267, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12171.186, "sample_time_ms": 1108.16, "learn_time_ms": 10993.172, "learn_throughput": 363.862, "synch_weights_time_ms": 69.033}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1e132_00003", "date": "2024-08-04_07-57-56", "timestamp": 1722738476, "time_this_iter_s": 12.54327917098999, "time_total_s": 199.27345395088196, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.27345395088196, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.13529411764706, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.79945504566034, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.037467763821284, "policy_loss": -0.011979888826802683, "vf_loss": 6.041630170245965, "vf_explained_var": 0.9451022836690147, "kl": 0.017653572178157145, "entropy": 1.2663918843492865, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -22.893959410341587, "episode_reward_min": -1470.8202898395082, "episode_reward_mean": -733.1898957886599, "episode_len_mean": 133.08, "episode_media": {}, "episodes_timesteps_total": 13308, "policy_reward_min": {"policy_0": -1470.8202898395082}, "policy_reward_max": {"policy_0": -22.893959410341587}, "policy_reward_mean": {"policy_0": -733.1898957886599}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.097186526786, -744.0994462687438, -1466.530126497948, -939.9021276438662, -1470.8202898395082, -1210.2095366199999, -60.77537936897759, -800.2293252275853, -743.4923897328134, -1141.9382813140032, -606.0130616449527, -901.301447272476, -829.3196548187523, -22.893959410341587, -458.60091395362707, -1023.5896980456987, -1142.9441372809943, -911.0613997879705, -140.66870913949927, -709.0700647073494, -1218.2062384502449, -617.3712104319868, -1378.7592245489611, -535.1217657404361, -1176.0536844829587, -91.82209867487057, -1279.4318260991388, -194.69760038049256, -897.8164384000977, -1030.6458515020586, -317.1154912637447, -975.098122783267, -942.0887513221123, -65.5998546758065, -644.6606962233869, -1020.3151724373485, -262.9489948983117, -539.0762563250651, -214.269479212527, -1271.306391737893, -757.6446998444728, -120.73165775105568, -1019.5666448713065, -810.1196803178494, -961.8207258990909, -364.22173035477783, -751.2342837884306, -865.8390705224526, -1309.5625751675555, -253.7446633593007, -171.39685912543908, -1020.4854498256511, -806.586366754329, -920.8043267296887, -937.6327298935959, -693.9635459327752, -934.7515734239782, -161.85993881147212, -349.0845382703341, -973.8601405428091, -506.34119511874604, -1161.3289642160848, -852.3174535746508, -150.45745992774437, -1123.158953004345, -591.5671459623785, -738.0656931171277, -1031.0782975559503, -671.444155923599, -173.2997703009187, -995.0003482840204, -1120.9560487102563, -1029.2124797394201, -517.2726699454126, -147.81545535853598, -1022.9472801216298, -413.6029186132748, -806.801003406222, -1337.5936372684687, -267.80704717801956, -702.3875417160326, -355.37583676635927, -258.8776690169974, -287.3423003588878, -1030.676945895724, -964.5390008540955, -879.4795236723431, -1305.6318390411484, -696.6716252018498, -1155.9087970000348, -991.7508508554812, -212.94279812887672, -67.18764930223863, -864.7971021945575, -293.380594600066, -355.25751127827925, -993.0339724105019, -765.560060872066, -273.62072977047745, -1245.6257667242057], "episode_lengths": [150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 94, 150, 150, 118, 150, 150, 150, 58, 150, 111, 150, 150, 104, 150, 150, 69, 150, 150, 89, 123, 85, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 106, 57, 150, 150, 150, 150, 150, 150, 77, 94, 150, 150, 150, 150, 78, 150, 119, 150, 150, 150, 81, 150, 150, 150, 115, 74, 150, 150, 150, 150, 85, 150, 150, 99, 107, 150, 150, 150, 150, 150, 150, 150, 108, 54, 150, 120, 150, 150, 150, 97, 150], "policy_policy_0_reward": [-780.097186526786, -744.0994462687438, -1466.530126497948, -939.9021276438662, -1470.8202898395082, -1210.2095366199999, -60.77537936897759, -800.2293252275853, -743.4923897328134, -1141.9382813140032, -606.0130616449527, -901.301447272476, -829.3196548187523, -22.893959410341587, -458.60091395362707, -1023.5896980456987, -1142.9441372809943, -911.0613997879705, -140.66870913949927, -709.0700647073494, -1218.2062384502449, -617.3712104319868, -1378.7592245489611, -535.1217657404361, -1176.0536844829587, -91.82209867487057, -1279.4318260991388, -194.69760038049256, -897.8164384000977, -1030.6458515020586, -317.1154912637447, -975.098122783267, -942.0887513221123, -65.5998546758065, -644.6606962233869, -1020.3151724373485, -262.9489948983117, -539.0762563250651, -214.269479212527, -1271.306391737893, -757.6446998444728, -120.73165775105568, -1019.5666448713065, -810.1196803178494, -961.8207258990909, -364.22173035477783, -751.2342837884306, -865.8390705224526, -1309.5625751675555, -253.7446633593007, -171.39685912543908, -1020.4854498256511, -806.586366754329, -920.8043267296887, -937.6327298935959, -693.9635459327752, -934.7515734239782, -161.85993881147212, -349.0845382703341, -973.8601405428091, -506.34119511874604, -1161.3289642160848, -852.3174535746508, -150.45745992774437, -1123.158953004345, -591.5671459623785, -738.0656931171277, -1031.0782975559503, -671.444155923599, -173.2997703009187, -995.0003482840204, -1120.9560487102563, -1029.2124797394201, -517.2726699454126, -147.81545535853598, -1022.9472801216298, -413.6029186132748, -806.801003406222, -1337.5936372684687, -267.80704717801956, -702.3875417160326, -355.37583676635927, -258.8776690169974, -287.3423003588878, -1030.676945895724, -964.5390008540955, -879.4795236723431, -1305.6318390411484, -696.6716252018498, -1155.9087970000348, -991.7508508554812, -212.94279812887672, -67.18764930223863, -864.7971021945575, -293.380594600066, -355.25751127827925, -993.0339724105019, -765.560060872066, -273.62072977047745, -1245.6257667242057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511820216959235, "mean_inference_ms": 1.6626528259148146, "mean_action_processing_ms": 0.2742241350395231, "mean_env_wait_ms": 3.4172168236124474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011627197265625, "StateBufferConnector_ms": 0.007946014404296875, "ViewRequirementAgentConnector_ms": 0.1926114559173584}, "num_episodes": 29, "episode_return_max": -22.893959410341587, "episode_return_min": -1470.8202898395082, "episode_return_mean": -733.1898957886599, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.0098961556203, "num_env_steps_trained_throughput_per_sec": 302.0098961556203, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12333.977, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12333.895, "sample_time_ms": 1108.65, "learn_time_ms": 11157.108, "learn_throughput": 358.516, "synch_weights_time_ms": 67.309}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1e132_00003", "date": "2024-08-04_07-58-09", "timestamp": 1722738489, "time_this_iter_s": 13.2581045627594, "time_total_s": 212.53155851364136, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ac820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.53155851364136, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.57894736842105, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.38787950078645, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.2363826011617975, "policy_loss": -0.008775116241789267, "vf_loss": 5.238760173569123, "vf_explained_var": 0.9488147251928846, "kl": 0.014463112382873077, "entropy": 1.1086476410428683, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -21.677156481481905, "episode_reward_min": -1457.3754447232677, "episode_reward_mean": -697.3199748585245, "episode_len_mean": 131.54, "episode_media": {}, "episodes_timesteps_total": 13154, "policy_reward_min": {"policy_0": -1457.3754447232677}, "policy_reward_max": {"policy_0": -21.677156481481905}, "policy_reward_mean": {"policy_0": -697.3199748585245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.5998546758065, -644.6606962233869, -1020.3151724373485, -262.9489948983117, -539.0762563250651, -214.269479212527, -1271.306391737893, -757.6446998444728, -120.73165775105568, -1019.5666448713065, -810.1196803178494, -961.8207258990909, -364.22173035477783, -751.2342837884306, -865.8390705224526, -1309.5625751675555, -253.7446633593007, -171.39685912543908, -1020.4854498256511, -806.586366754329, -920.8043267296887, -937.6327298935959, -693.9635459327752, -934.7515734239782, -161.85993881147212, -349.0845382703341, -973.8601405428091, -506.34119511874604, -1161.3289642160848, -852.3174535746508, -150.45745992774437, -1123.158953004345, -591.5671459623785, -738.0656931171277, -1031.0782975559503, -671.444155923599, -173.2997703009187, -995.0003482840204, -1120.9560487102563, -1029.2124797394201, -517.2726699454126, -147.81545535853598, -1022.9472801216298, -413.6029186132748, -806.801003406222, -1337.5936372684687, -267.80704717801956, -702.3875417160326, -355.37583676635927, -258.8776690169974, -287.3423003588878, -1030.676945895724, -964.5390008540955, -879.4795236723431, -1305.6318390411484, -696.6716252018498, -1155.9087970000348, -991.7508508554812, -212.94279812887672, -67.18764930223863, -864.7971021945575, -293.380594600066, -355.25751127827925, -993.0339724105019, -765.560060872066, -273.62072977047745, -1245.6257667242057, -21.677156481481905, -1457.3754447232677, -926.2392117033904, -531.6623868879932, -1376.9620429637307, -115.24825762751388, -204.66642917953146, -1119.2463202354593, -860.6568901674007, -1260.8571632753342, -779.8530409873532, -759.0768030437669, -825.8693052817697, -1075.199487460513, -358.4783803066955, -1123.307465911643, -877.3150062659435, -832.4688561139521, -172.24393977124132, -613.3650668141208, -792.8532757007982, -218.50496666363446, -210.98912631405753, -205.58652171699964, -419.5865312713471, -634.421930335285, -920.2778009881607, -1282.9303433350378, -529.0690291401081, -578.3459231178231, -971.2532021327082, -500.4192664674745, -614.7867737831806], "episode_lengths": [69, 150, 150, 89, 123, 85, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 106, 57, 150, 150, 150, 150, 150, 150, 77, 94, 150, 150, 150, 150, 78, 150, 119, 150, 150, 150, 81, 150, 150, 150, 115, 74, 150, 150, 150, 150, 85, 150, 150, 99, 107, 150, 150, 150, 150, 150, 150, 150, 108, 54, 150, 120, 150, 150, 150, 97, 150, 44, 150, 150, 149, 150, 69, 100, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 63, 150, 150, 100, 82, 100, 150, 150, 150, 150, 114, 123, 150, 133, 150], "policy_policy_0_reward": [-65.5998546758065, -644.6606962233869, -1020.3151724373485, -262.9489948983117, -539.0762563250651, -214.269479212527, -1271.306391737893, -757.6446998444728, -120.73165775105568, -1019.5666448713065, -810.1196803178494, -961.8207258990909, -364.22173035477783, -751.2342837884306, -865.8390705224526, -1309.5625751675555, -253.7446633593007, -171.39685912543908, -1020.4854498256511, -806.586366754329, -920.8043267296887, -937.6327298935959, -693.9635459327752, -934.7515734239782, -161.85993881147212, -349.0845382703341, -973.8601405428091, -506.34119511874604, -1161.3289642160848, -852.3174535746508, -150.45745992774437, -1123.158953004345, -591.5671459623785, -738.0656931171277, -1031.0782975559503, -671.444155923599, -173.2997703009187, -995.0003482840204, -1120.9560487102563, -1029.2124797394201, -517.2726699454126, -147.81545535853598, -1022.9472801216298, -413.6029186132748, -806.801003406222, -1337.5936372684687, -267.80704717801956, -702.3875417160326, -355.37583676635927, -258.8776690169974, -287.3423003588878, -1030.676945895724, -964.5390008540955, -879.4795236723431, -1305.6318390411484, -696.6716252018498, -1155.9087970000348, -991.7508508554812, -212.94279812887672, -67.18764930223863, -864.7971021945575, -293.380594600066, -355.25751127827925, -993.0339724105019, -765.560060872066, -273.62072977047745, -1245.6257667242057, -21.677156481481905, -1457.3754447232677, -926.2392117033904, -531.6623868879932, -1376.9620429637307, -115.24825762751388, -204.66642917953146, -1119.2463202354593, -860.6568901674007, -1260.8571632753342, -779.8530409873532, -759.0768030437669, -825.8693052817697, -1075.199487460513, -358.4783803066955, -1123.307465911643, -877.3150062659435, -832.4688561139521, -172.24393977124132, -613.3650668141208, -792.8532757007982, -218.50496666363446, -210.98912631405753, -205.58652171699964, -419.5865312713471, -634.421930335285, -920.2778009881607, -1282.9303433350378, -529.0690291401081, -578.3459231178231, -971.2532021327082, -500.4192664674745, -614.7867737831806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5507604865380809, "mean_inference_ms": 1.6626725605188826, "mean_action_processing_ms": 0.27414074143833683, "mean_env_wait_ms": 3.421789954932533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011425018310546875, "StateBufferConnector_ms": 0.007961750030517578, "ViewRequirementAgentConnector_ms": 0.1929459571838379}, "num_episodes": 33, "episode_return_max": -21.677156481481905, "episode_return_min": -1457.3754447232677, "episode_return_mean": -697.3199748585245, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.7973437335578, "num_env_steps_trained_throughput_per_sec": 355.7973437335578, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12176.259, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12176.178, "sample_time_ms": 1125.805, "learn_time_ms": 10985.186, "learn_throughput": 364.127, "synch_weights_time_ms": 64.377}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1e132_00003", "date": "2024-08-04_07-58-21", "timestamp": 1722738501, "time_this_iter_s": 11.255853414535522, "time_total_s": 223.78741192817688, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1afe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.78741192817688, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.78125, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.8711446861426, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.725057567407688, "policy_loss": -0.007655895262723788, "vf_loss": 4.725314052899678, "vf_explained_var": 0.9758907932167252, "kl": 0.016624369647858378, "entropy": 0.8156639299665888, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -21.677156481481905, "episode_reward_min": -1457.3754447232677, "episode_reward_mean": -662.4646275463689, "episode_len_mean": 128.59, "episode_media": {}, "episodes_timesteps_total": 12859, "policy_reward_min": {"policy_0": -1457.3754447232677}, "policy_reward_max": {"policy_0": -21.677156481481905}, "policy_reward_mean": {"policy_0": -662.4646275463689}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1031.0782975559503, -671.444155923599, -173.2997703009187, -995.0003482840204, -1120.9560487102563, -1029.2124797394201, -517.2726699454126, -147.81545535853598, -1022.9472801216298, -413.6029186132748, -806.801003406222, -1337.5936372684687, -267.80704717801956, -702.3875417160326, -355.37583676635927, -258.8776690169974, -287.3423003588878, -1030.676945895724, -964.5390008540955, -879.4795236723431, -1305.6318390411484, -696.6716252018498, -1155.9087970000348, -991.7508508554812, -212.94279812887672, -67.18764930223863, -864.7971021945575, -293.380594600066, -355.25751127827925, -993.0339724105019, -765.560060872066, -273.62072977047745, -1245.6257667242057, -21.677156481481905, -1457.3754447232677, -926.2392117033904, -531.6623868879932, -1376.9620429637307, -115.24825762751388, -204.66642917953146, -1119.2463202354593, -860.6568901674007, -1260.8571632753342, -779.8530409873532, -759.0768030437669, -825.8693052817697, -1075.199487460513, -358.4783803066955, -1123.307465911643, -877.3150062659435, -832.4688561139521, -172.24393977124132, -613.3650668141208, -792.8532757007982, -218.50496666363446, -210.98912631405753, -205.58652171699964, -419.5865312713471, -634.421930335285, -920.2778009881607, -1282.9303433350378, -529.0690291401081, -578.3459231178231, -971.2532021327082, -500.4192664674745, -614.7867737831806, -182.0059977460016, -1150.6922433496093, -590.7943546836466, -221.95580028101313, -1163.5770484591726, -592.8205678720802, -848.4031907093494, -216.58571719243864, -265.6540077891537, -677.1099763726553, -226.83337441806142, -296.5274698850674, -47.15643662324445, -107.23833597128719, -380.16681619721714, -223.17632024040606, -1052.653321807443, -670.0231494213909, -1020.1249919774997, -791.3653560517763, -922.0389458079205, -853.6145823052744, -661.9120506346264, -144.3394296977758, -55.285790530991235, -979.5982174080125, -1115.939299092795, -903.4864846869957, -850.3107599096709, -1140.7139354823062, -204.68522139565016, -1058.999485277516, -115.17777398059778, -109.82372714355779], "episode_lengths": [150, 150, 81, 150, 150, 150, 115, 74, 150, 150, 150, 150, 85, 150, 150, 99, 107, 150, 150, 150, 150, 150, 150, 150, 108, 54, 150, 120, 150, 150, 150, 97, 150, 44, 150, 150, 149, 150, 69, 100, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 63, 150, 150, 100, 82, 100, 150, 150, 150, 150, 114, 123, 150, 133, 150, 85, 150, 150, 103, 150, 150, 137, 85, 108, 150, 105, 126, 62, 81, 112, 71, 150, 150, 150, 150, 150, 150, 150, 77, 54, 150, 150, 150, 150, 150, 89, 150, 78, 64], "policy_policy_0_reward": [-1031.0782975559503, -671.444155923599, -173.2997703009187, -995.0003482840204, -1120.9560487102563, -1029.2124797394201, -517.2726699454126, -147.81545535853598, -1022.9472801216298, -413.6029186132748, -806.801003406222, -1337.5936372684687, -267.80704717801956, -702.3875417160326, -355.37583676635927, -258.8776690169974, -287.3423003588878, -1030.676945895724, -964.5390008540955, -879.4795236723431, -1305.6318390411484, -696.6716252018498, -1155.9087970000348, -991.7508508554812, -212.94279812887672, -67.18764930223863, -864.7971021945575, -293.380594600066, -355.25751127827925, -993.0339724105019, -765.560060872066, -273.62072977047745, -1245.6257667242057, -21.677156481481905, -1457.3754447232677, -926.2392117033904, -531.6623868879932, -1376.9620429637307, -115.24825762751388, -204.66642917953146, -1119.2463202354593, -860.6568901674007, -1260.8571632753342, -779.8530409873532, -759.0768030437669, -825.8693052817697, -1075.199487460513, -358.4783803066955, -1123.307465911643, -877.3150062659435, -832.4688561139521, -172.24393977124132, -613.3650668141208, -792.8532757007982, -218.50496666363446, -210.98912631405753, -205.58652171699964, -419.5865312713471, -634.421930335285, -920.2778009881607, -1282.9303433350378, -529.0690291401081, -578.3459231178231, -971.2532021327082, -500.4192664674745, -614.7867737831806, -182.0059977460016, -1150.6922433496093, -590.7943546836466, -221.95580028101313, -1163.5770484591726, -592.8205678720802, -848.4031907093494, -216.58571719243864, -265.6540077891537, -677.1099763726553, -226.83337441806142, -296.5274698850674, -47.15643662324445, -107.23833597128719, -380.16681619721714, -223.17632024040606, -1052.653321807443, -670.0231494213909, -1020.1249919774997, -791.3653560517763, -922.0389458079205, -853.6145823052744, -661.9120506346264, -144.3394296977758, -55.285790530991235, -979.5982174080125, -1115.939299092795, -903.4864846869957, -850.3107599096709, -1140.7139354823062, -204.68522139565016, -1058.999485277516, -115.17777398059778, -109.82372714355779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510821555375569, "mean_inference_ms": 1.663704455529318, "mean_action_processing_ms": 0.2743750882618534, "mean_env_wait_ms": 3.424570522903303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011351823806762695, "StateBufferConnector_ms": 0.007857084274291992, "ViewRequirementAgentConnector_ms": 0.1918504238128662}, "num_episodes": 34, "episode_return_max": -21.677156481481905, "episode_return_min": -1457.3754447232677, "episode_return_mean": -662.4646275463689, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.627791674771, "num_env_steps_trained_throughput_per_sec": 302.627791674771, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12206.146, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12206.068, "sample_time_ms": 1136.312, "learn_time_ms": 11005.817, "learn_throughput": 363.444, "synch_weights_time_ms": 63.131}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1e132_00003", "date": "2024-08-04_07-58-34", "timestamp": 1722738514, "time_this_iter_s": 13.229957818984985, "time_total_s": 237.01736974716187, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1adc60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.01736974716187, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.63157894736842, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.04142318765324, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.150044319033623, "policy_loss": -0.005593485729089783, "vf_loss": 5.148712374269962, "vf_explained_var": 0.9614644774546226, "kl": 0.015560702687556254, "entropy": 0.7687279412522912, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -21.677156481481905, "episode_reward_min": -1457.3754447232677, "episode_reward_mean": -607.9893013967198, "episode_len_mean": 123.96, "episode_media": {}, "episodes_timesteps_total": 12396, "policy_reward_min": {"policy_0": -1457.3754447232677}, "policy_reward_max": {"policy_0": -21.677156481481905}, "policy_reward_mean": {"policy_0": -607.9893013967198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.62072977047745, -1245.6257667242057, -21.677156481481905, -1457.3754447232677, -926.2392117033904, -531.6623868879932, -1376.9620429637307, -115.24825762751388, -204.66642917953146, -1119.2463202354593, -860.6568901674007, -1260.8571632753342, -779.8530409873532, -759.0768030437669, -825.8693052817697, -1075.199487460513, -358.4783803066955, -1123.307465911643, -877.3150062659435, -832.4688561139521, -172.24393977124132, -613.3650668141208, -792.8532757007982, -218.50496666363446, -210.98912631405753, -205.58652171699964, -419.5865312713471, -634.421930335285, -920.2778009881607, -1282.9303433350378, -529.0690291401081, -578.3459231178231, -971.2532021327082, -500.4192664674745, -614.7867737831806, -182.0059977460016, -1150.6922433496093, -590.7943546836466, -221.95580028101313, -1163.5770484591726, -592.8205678720802, -848.4031907093494, -216.58571719243864, -265.6540077891537, -677.1099763726553, -226.83337441806142, -296.5274698850674, -47.15643662324445, -107.23833597128719, -380.16681619721714, -223.17632024040606, -1052.653321807443, -670.0231494213909, -1020.1249919774997, -791.3653560517763, -922.0389458079205, -853.6145823052744, -661.9120506346264, -144.3394296977758, -55.285790530991235, -979.5982174080125, -1115.939299092795, -903.4864846869957, -850.3107599096709, -1140.7139354823062, -204.68522139565016, -1058.999485277516, -115.17777398059778, -109.82372714355779, -630.6594882343799, -753.4861240389394, -672.2222723204789, -594.7402794120561, -816.3172704657271, -809.8745640729803, -26.378319510866763, -518.0222042876167, -1119.93394714345, -1019.1297315148036, -233.48747636289025, -91.84260943676477, -138.84488720735234, -872.7863921204341, -387.6749536916487, -433.0707574256292, -459.19933819314053, -969.185985947151, -123.32108707167433, -703.2816577172182, -148.01455782866952, -936.5685810478403, -132.32500302089397, -78.38184529717722, -266.27038080081167, -98.11889963930244, -329.3652965227251, -1082.8874939082364, -848.2859027860989, -175.38793580311565, -799.0348737763026], "episode_lengths": [97, 150, 44, 150, 150, 149, 150, 69, 100, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 63, 150, 150, 100, 82, 100, 150, 150, 150, 150, 114, 123, 150, 133, 150, 85, 150, 150, 103, 150, 150, 137, 85, 108, 150, 105, 126, 62, 81, 112, 71, 150, 150, 150, 150, 150, 150, 150, 77, 54, 150, 150, 150, 150, 150, 89, 150, 78, 64, 150, 149, 150, 150, 150, 144, 47, 150, 150, 150, 99, 55, 91, 150, 94, 129, 131, 150, 70, 150, 82, 150, 71, 60, 80, 63, 132, 150, 150, 83, 150], "policy_policy_0_reward": [-273.62072977047745, -1245.6257667242057, -21.677156481481905, -1457.3754447232677, -926.2392117033904, -531.6623868879932, -1376.9620429637307, -115.24825762751388, -204.66642917953146, -1119.2463202354593, -860.6568901674007, -1260.8571632753342, -779.8530409873532, -759.0768030437669, -825.8693052817697, -1075.199487460513, -358.4783803066955, -1123.307465911643, -877.3150062659435, -832.4688561139521, -172.24393977124132, -613.3650668141208, -792.8532757007982, -218.50496666363446, -210.98912631405753, -205.58652171699964, -419.5865312713471, -634.421930335285, -920.2778009881607, -1282.9303433350378, -529.0690291401081, -578.3459231178231, -971.2532021327082, -500.4192664674745, -614.7867737831806, -182.0059977460016, -1150.6922433496093, -590.7943546836466, -221.95580028101313, -1163.5770484591726, -592.8205678720802, -848.4031907093494, -216.58571719243864, -265.6540077891537, -677.1099763726553, -226.83337441806142, -296.5274698850674, -47.15643662324445, -107.23833597128719, -380.16681619721714, -223.17632024040606, -1052.653321807443, -670.0231494213909, -1020.1249919774997, -791.3653560517763, -922.0389458079205, -853.6145823052744, -661.9120506346264, -144.3394296977758, -55.285790530991235, -979.5982174080125, -1115.939299092795, -903.4864846869957, -850.3107599096709, -1140.7139354823062, -204.68522139565016, -1058.999485277516, -115.17777398059778, -109.82372714355779, -630.6594882343799, -753.4861240389394, -672.2222723204789, -594.7402794120561, -816.3172704657271, -809.8745640729803, -26.378319510866763, -518.0222042876167, -1119.93394714345, -1019.1297315148036, -233.48747636289025, -91.84260943676477, -138.84488720735234, -872.7863921204341, -387.6749536916487, -433.0707574256292, -459.19933819314053, -969.185985947151, -123.32108707167433, -703.2816577172182, -148.01455782866952, -936.5685810478403, -132.32500302089397, -78.38184529717722, -266.27038080081167, -98.11889963930244, -329.3652965227251, -1082.8874939082364, -848.2859027860989, -175.38793580311565, -799.0348737763026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509938704227142, "mean_inference_ms": 1.6647888949518732, "mean_action_processing_ms": 0.2745915945666958, "mean_env_wait_ms": 3.4266296409058823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011841297149658203, "StateBufferConnector_ms": 0.00793600082397461, "ViewRequirementAgentConnector_ms": 0.19294452667236328}, "num_episodes": 31, "episode_return_max": -21.677156481481905, "episode_return_min": -1457.3754447232677, "episode_return_mean": -607.9893013967198, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.38357576516296, "num_env_steps_trained_throughput_per_sec": 298.38357576516296, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12295.884, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12295.808, "sample_time_ms": 1136.212, "learn_time_ms": 11094.026, "learn_throughput": 360.554, "synch_weights_time_ms": 64.734}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1e132_00003", "date": "2024-08-04_07-58-47", "timestamp": 1722738527, "time_this_iter_s": 13.418022632598877, "time_total_s": 250.43539237976074, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ae680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.43539237976074, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.405263157894737, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.20800168017547, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.0168083739777405, "policy_loss": -0.007286383864508631, "vf_loss": 5.0177183421949545, "vf_explained_var": 0.9547451627751191, "kl": 0.01436646768427939, "entropy": 0.8847953292230765, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -26.378319510866763, "episode_reward_min": -1163.9822178340191, "episode_reward_mean": -542.6767976408643, "episode_len_mean": 118.9, "episode_media": {}, "episodes_timesteps_total": 11890, "policy_reward_min": {"policy_0": -1163.9822178340191}, "policy_reward_max": {"policy_0": -26.378319510866763}, "policy_reward_mean": {"policy_0": -542.6767976408643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-971.2532021327082, -500.4192664674745, -614.7867737831806, -182.0059977460016, -1150.6922433496093, -590.7943546836466, -221.95580028101313, -1163.5770484591726, -592.8205678720802, -848.4031907093494, -216.58571719243864, -265.6540077891537, -677.1099763726553, -226.83337441806142, -296.5274698850674, -47.15643662324445, -107.23833597128719, -380.16681619721714, -223.17632024040606, -1052.653321807443, -670.0231494213909, -1020.1249919774997, -791.3653560517763, -922.0389458079205, -853.6145823052744, -661.9120506346264, -144.3394296977758, -55.285790530991235, -979.5982174080125, -1115.939299092795, -903.4864846869957, -850.3107599096709, -1140.7139354823062, -204.68522139565016, -1058.999485277516, -115.17777398059778, -109.82372714355779, -630.6594882343799, -753.4861240389394, -672.2222723204789, -594.7402794120561, -816.3172704657271, -809.8745640729803, -26.378319510866763, -518.0222042876167, -1119.93394714345, -1019.1297315148036, -233.48747636289025, -91.84260943676477, -138.84488720735234, -872.7863921204341, -387.6749536916487, -433.0707574256292, -459.19933819314053, -969.185985947151, -123.32108707167433, -703.2816577172182, -148.01455782866952, -936.5685810478403, -132.32500302089397, -78.38184529717722, -266.27038080081167, -98.11889963930244, -329.3652965227251, -1082.8874939082364, -848.2859027860989, -175.38793580311565, -799.0348737763026, -855.4094452576942, -1095.9389039488676, -754.7348210955489, -168.8192049609983, -1151.3727015929448, -189.37625176673933, -202.61715665274028, -550.1582871265816, -28.041301790095915, -988.2185964982435, -407.9064446240974, -170.52751361011596, -302.5317574495927, -150.65110047319055, -161.88579145633344, -171.8683630152661, -922.9866877485645, -569.0257588012508, -328.9442509977069, -830.5766684126385, -716.4811253577642, -89.39691118245628, -38.67204793289974, -926.7912064429469, -719.7614048328971, -1163.9822178340191, -130.71325707262767, -109.8103344779861, -772.911253439293, -469.2359975856346, -487.668050240713, -445.3154110160308], "episode_lengths": [150, 133, 150, 85, 150, 150, 103, 150, 150, 137, 85, 108, 150, 105, 126, 62, 81, 112, 71, 150, 150, 150, 150, 150, 150, 150, 77, 54, 150, 150, 150, 150, 150, 89, 150, 78, 64, 150, 149, 150, 150, 150, 144, 47, 150, 150, 150, 99, 55, 91, 150, 94, 129, 131, 150, 70, 150, 82, 150, 71, 60, 80, 63, 132, 150, 150, 83, 150, 150, 150, 134, 82, 150, 102, 90, 124, 46, 150, 108, 79, 118, 90, 81, 76, 150, 113, 98, 150, 150, 74, 54, 150, 150, 150, 67, 63, 150, 112, 150, 129], "policy_policy_0_reward": [-971.2532021327082, -500.4192664674745, -614.7867737831806, -182.0059977460016, -1150.6922433496093, -590.7943546836466, -221.95580028101313, -1163.5770484591726, -592.8205678720802, -848.4031907093494, -216.58571719243864, -265.6540077891537, -677.1099763726553, -226.83337441806142, -296.5274698850674, -47.15643662324445, -107.23833597128719, -380.16681619721714, -223.17632024040606, -1052.653321807443, -670.0231494213909, -1020.1249919774997, -791.3653560517763, -922.0389458079205, -853.6145823052744, -661.9120506346264, -144.3394296977758, -55.285790530991235, -979.5982174080125, -1115.939299092795, -903.4864846869957, -850.3107599096709, -1140.7139354823062, -204.68522139565016, -1058.999485277516, -115.17777398059778, -109.82372714355779, -630.6594882343799, -753.4861240389394, -672.2222723204789, -594.7402794120561, -816.3172704657271, -809.8745640729803, -26.378319510866763, -518.0222042876167, -1119.93394714345, -1019.1297315148036, -233.48747636289025, -91.84260943676477, -138.84488720735234, -872.7863921204341, -387.6749536916487, -433.0707574256292, -459.19933819314053, -969.185985947151, -123.32108707167433, -703.2816577172182, -148.01455782866952, -936.5685810478403, -132.32500302089397, -78.38184529717722, -266.27038080081167, -98.11889963930244, -329.3652965227251, -1082.8874939082364, -848.2859027860989, -175.38793580311565, -799.0348737763026, -855.4094452576942, -1095.9389039488676, -754.7348210955489, -168.8192049609983, -1151.3727015929448, -189.37625176673933, -202.61715665274028, -550.1582871265816, -28.041301790095915, -988.2185964982435, -407.9064446240974, -170.52751361011596, -302.5317574495927, -150.65110047319055, -161.88579145633344, -171.8683630152661, -922.9866877485645, -569.0257588012508, -328.9442509977069, -830.5766684126385, -716.4811253577642, -89.39691118245628, -38.67204793289974, -926.7912064429469, -719.7614048328971, -1163.9822178340191, -130.71325707262767, -109.8103344779861, -772.911253439293, -469.2359975856346, -487.668050240713, -445.3154110160308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5508271731505135, "mean_inference_ms": 1.664893324434112, "mean_action_processing_ms": 0.27465730010036415, "mean_env_wait_ms": 3.424231540657688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011929988861083984, "StateBufferConnector_ms": 0.00800943374633789, "ViewRequirementAgentConnector_ms": 0.1956648826599121}, "num_episodes": 32, "episode_return_max": -26.378319510866763, "episode_return_min": -1163.9822178340191, "episode_return_mean": -542.6767976408643, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.35319801799415, "num_env_steps_trained_throughput_per_sec": 313.35319801799415, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12264.642, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12264.563, "sample_time_ms": 1137.225, "learn_time_ms": 11062.059, "learn_throughput": 361.596, "synch_weights_time_ms": 64.447}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1e132_00003", "date": "2024-08-04_07-59-00", "timestamp": 1722738540, "time_this_iter_s": 12.77686357498169, "time_total_s": 263.21225595474243, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 263.21225595474243, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.57894736842105, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.9412656625112, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.070415912816922, "policy_loss": -0.011623884675403436, "vf_loss": 5.0764414404829346, "vf_explained_var": 0.963757092319429, "kl": 0.012637117746726313, "entropy": 0.8833635173117121, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -26.378319510866763, "episode_reward_min": -1223.8390334839685, "episode_reward_mean": -550.4915861166166, "episode_len_mean": 119.22, "episode_media": {}, "episodes_timesteps_total": 11922, "policy_reward_min": {"policy_0": -1223.8390334839685}, "policy_reward_max": {"policy_0": -26.378319510866763}, "policy_reward_mean": {"policy_0": -550.4915861166166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1058.999485277516, -115.17777398059778, -109.82372714355779, -630.6594882343799, -753.4861240389394, -672.2222723204789, -594.7402794120561, -816.3172704657271, -809.8745640729803, -26.378319510866763, -518.0222042876167, -1119.93394714345, -1019.1297315148036, -233.48747636289025, -91.84260943676477, -138.84488720735234, -872.7863921204341, -387.6749536916487, -433.0707574256292, -459.19933819314053, -969.185985947151, -123.32108707167433, -703.2816577172182, -148.01455782866952, -936.5685810478403, -132.32500302089397, -78.38184529717722, -266.27038080081167, -98.11889963930244, -329.3652965227251, -1082.8874939082364, -848.2859027860989, -175.38793580311565, -799.0348737763026, -855.4094452576942, -1095.9389039488676, -754.7348210955489, -168.8192049609983, -1151.3727015929448, -189.37625176673933, -202.61715665274028, -550.1582871265816, -28.041301790095915, -988.2185964982435, -407.9064446240974, -170.52751361011596, -302.5317574495927, -150.65110047319055, -161.88579145633344, -171.8683630152661, -922.9866877485645, -569.0257588012508, -328.9442509977069, -830.5766684126385, -716.4811253577642, -89.39691118245628, -38.67204793289974, -926.7912064429469, -719.7614048328971, -1163.9822178340191, -130.71325707262767, -109.8103344779861, -772.911253439293, -469.2359975856346, -487.668050240713, -445.3154110160308, -1223.8390334839685, -101.96902992189342, -575.8609462959276, -652.0452408931867, -992.7413651397758, -740.6622999168027, -178.8386166656595, -498.50138964259946, -1131.52011709207, -93.94671931414045, -375.3960834345903, -64.51795127293957, -747.0267763754291, -968.2881750739516, -161.95717219316225, -817.9029517891952, -1036.2285372104097, -549.4419310849761, -573.8915322406293, -455.0264300606972, -155.40851427706545, -536.9447434877086, -991.0669553712628, -903.8360770713681, -883.1757707215162, -27.847484198660876, -1215.4506519714553, -692.2435071301798, -67.56534425644439, -1105.8774123933158, -766.9452198013689, -1083.3647460386362, -876.2636022984831, -179.1349558396755], "episode_lengths": [150, 78, 64, 150, 149, 150, 150, 150, 144, 47, 150, 150, 150, 99, 55, 91, 150, 94, 129, 131, 150, 70, 150, 82, 150, 71, 60, 80, 63, 132, 150, 150, 83, 150, 150, 150, 134, 82, 150, 102, 90, 124, 46, 150, 108, 79, 118, 90, 81, 76, 150, 113, 98, 150, 150, 74, 54, 150, 150, 150, 67, 63, 150, 112, 150, 129, 150, 58, 150, 150, 150, 150, 82, 150, 150, 64, 114, 58, 142, 150, 77, 150, 150, 150, 150, 150, 92, 119, 150, 150, 150, 43, 150, 150, 51, 150, 150, 150, 150, 110], "policy_policy_0_reward": [-1058.999485277516, -115.17777398059778, -109.82372714355779, -630.6594882343799, -753.4861240389394, -672.2222723204789, -594.7402794120561, -816.3172704657271, -809.8745640729803, -26.378319510866763, -518.0222042876167, -1119.93394714345, -1019.1297315148036, -233.48747636289025, -91.84260943676477, -138.84488720735234, -872.7863921204341, -387.6749536916487, -433.0707574256292, -459.19933819314053, -969.185985947151, -123.32108707167433, -703.2816577172182, -148.01455782866952, -936.5685810478403, -132.32500302089397, -78.38184529717722, -266.27038080081167, -98.11889963930244, -329.3652965227251, -1082.8874939082364, -848.2859027860989, -175.38793580311565, -799.0348737763026, -855.4094452576942, -1095.9389039488676, -754.7348210955489, -168.8192049609983, -1151.3727015929448, -189.37625176673933, -202.61715665274028, -550.1582871265816, -28.041301790095915, -988.2185964982435, -407.9064446240974, -170.52751361011596, -302.5317574495927, -150.65110047319055, -161.88579145633344, -171.8683630152661, -922.9866877485645, -569.0257588012508, -328.9442509977069, -830.5766684126385, -716.4811253577642, -89.39691118245628, -38.67204793289974, -926.7912064429469, -719.7614048328971, -1163.9822178340191, -130.71325707262767, -109.8103344779861, -772.911253439293, -469.2359975856346, -487.668050240713, -445.3154110160308, -1223.8390334839685, -101.96902992189342, -575.8609462959276, -652.0452408931867, -992.7413651397758, -740.6622999168027, -178.8386166656595, -498.50138964259946, -1131.52011709207, -93.94671931414045, -375.3960834345903, -64.51795127293957, -747.0267763754291, -968.2881750739516, -161.95717219316225, -817.9029517891952, -1036.2285372104097, -549.4419310849761, -573.8915322406293, -455.0264300606972, -155.40851427706545, -536.9447434877086, -991.0669553712628, -903.8360770713681, -883.1757707215162, -27.847484198660876, -1215.4506519714553, -692.2435071301798, -67.56534425644439, -1105.8774123933158, -766.9452198013689, -1083.3647460386362, -876.2636022984831, -179.1349558396755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509772560989368, "mean_inference_ms": 1.6644681631765008, "mean_action_processing_ms": 0.2744877538996698, "mean_env_wait_ms": 3.4209154646472886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012043476104736328, "StateBufferConnector_ms": 0.007884025573730469, "ViewRequirementAgentConnector_ms": 0.1927788257598877}, "num_episodes": 34, "episode_return_max": -26.378319510866763, "episode_return_min": -1223.8390334839685, "episode_return_mean": -550.4915861166166, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.8232801688088, "num_env_steps_trained_throughput_per_sec": 313.8232801688088, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12299.935, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12299.857, "sample_time_ms": 1134.137, "learn_time_ms": 11100.579, "learn_throughput": 360.342, "synch_weights_time_ms": 64.314}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1e132_00003", "date": "2024-08-04_07-59-13", "timestamp": 1722738553, "time_this_iter_s": 12.75850796699524, "time_total_s": 275.97076392173767, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1acaf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.97076392173767, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.677777777777777, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.86517276962599, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.326517877479394, "policy_loss": -0.01013048638124019, "vf_loss": 5.329500471800566, "vf_explained_var": 0.9734320897608996, "kl": 0.01613595160051776, "entropy": 1.1329322430615625, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -27.847484198660876, "episode_reward_min": -1404.6534100332185, "episode_reward_mean": -576.0162105293743, "episode_len_mean": 122.21, "episode_media": {}, "episodes_timesteps_total": 12221, "policy_reward_min": {"policy_0": -1404.6534100332185}, "policy_reward_max": {"policy_0": -27.847484198660876}, "policy_reward_mean": {"policy_0": -576.0162105293743}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-848.2859027860989, -175.38793580311565, -799.0348737763026, -855.4094452576942, -1095.9389039488676, -754.7348210955489, -168.8192049609983, -1151.3727015929448, -189.37625176673933, -202.61715665274028, -550.1582871265816, -28.041301790095915, -988.2185964982435, -407.9064446240974, -170.52751361011596, -302.5317574495927, -150.65110047319055, -161.88579145633344, -171.8683630152661, -922.9866877485645, -569.0257588012508, -328.9442509977069, -830.5766684126385, -716.4811253577642, -89.39691118245628, -38.67204793289974, -926.7912064429469, -719.7614048328971, -1163.9822178340191, -130.71325707262767, -109.8103344779861, -772.911253439293, -469.2359975856346, -487.668050240713, -445.3154110160308, -1223.8390334839685, -101.96902992189342, -575.8609462959276, -652.0452408931867, -992.7413651397758, -740.6622999168027, -178.8386166656595, -498.50138964259946, -1131.52011709207, -93.94671931414045, -375.3960834345903, -64.51795127293957, -747.0267763754291, -968.2881750739516, -161.95717219316225, -817.9029517891952, -1036.2285372104097, -549.4419310849761, -573.8915322406293, -455.0264300606972, -155.40851427706545, -536.9447434877086, -991.0669553712628, -903.8360770713681, -883.1757707215162, -27.847484198660876, -1215.4506519714553, -692.2435071301798, -67.56534425644439, -1105.8774123933158, -766.9452198013689, -1083.3647460386362, -876.2636022984831, -179.1349558396755, -565.9160800668691, -66.60431694494973, -1207.1735742501667, -756.9603006296832, -726.0115416718616, -33.136319256275804, -669.4629504730256, -233.05017168526075, -402.19636013255615, -889.8971003992773, -1040.4175492123331, -904.1504299202819, -614.8447500085398, -185.01039674078356, -734.6211816658592, -121.95626486973784, -256.3684065867853, -525.4058145458732, -530.4509809550127, -761.598380456192, -377.9783256783519, -682.4739793031158, -186.06417999213326, -850.5825875931015, -1031.579516724349, -65.23997913444046, -327.98639765294115, -395.0507018959294, -1404.6534100332185, -815.7240597834088, -919.2888236559772], "episode_lengths": [150, 83, 150, 150, 150, 134, 82, 150, 102, 90, 124, 46, 150, 108, 79, 118, 90, 81, 76, 150, 113, 98, 150, 150, 74, 54, 150, 150, 150, 67, 63, 150, 112, 150, 129, 150, 58, 150, 150, 150, 150, 82, 150, 150, 64, 114, 58, 142, 150, 77, 150, 150, 150, 150, 150, 92, 119, 150, 150, 150, 43, 150, 150, 51, 150, 150, 150, 150, 110, 150, 50, 150, 150, 150, 51, 150, 87, 100, 150, 150, 150, 150, 78, 150, 61, 96, 150, 150, 150, 111, 150, 106, 150, 150, 54, 128, 116, 150, 150, 150], "policy_policy_0_reward": [-848.2859027860989, -175.38793580311565, -799.0348737763026, -855.4094452576942, -1095.9389039488676, -754.7348210955489, -168.8192049609983, -1151.3727015929448, -189.37625176673933, -202.61715665274028, -550.1582871265816, -28.041301790095915, -988.2185964982435, -407.9064446240974, -170.52751361011596, -302.5317574495927, -150.65110047319055, -161.88579145633344, -171.8683630152661, -922.9866877485645, -569.0257588012508, -328.9442509977069, -830.5766684126385, -716.4811253577642, -89.39691118245628, -38.67204793289974, -926.7912064429469, -719.7614048328971, -1163.9822178340191, -130.71325707262767, -109.8103344779861, -772.911253439293, -469.2359975856346, -487.668050240713, -445.3154110160308, -1223.8390334839685, -101.96902992189342, -575.8609462959276, -652.0452408931867, -992.7413651397758, -740.6622999168027, -178.8386166656595, -498.50138964259946, -1131.52011709207, -93.94671931414045, -375.3960834345903, -64.51795127293957, -747.0267763754291, -968.2881750739516, -161.95717219316225, -817.9029517891952, -1036.2285372104097, -549.4419310849761, -573.8915322406293, -455.0264300606972, -155.40851427706545, -536.9447434877086, -991.0669553712628, -903.8360770713681, -883.1757707215162, -27.847484198660876, -1215.4506519714553, -692.2435071301798, -67.56534425644439, -1105.8774123933158, -766.9452198013689, -1083.3647460386362, -876.2636022984831, -179.1349558396755, -565.9160800668691, -66.60431694494973, -1207.1735742501667, -756.9603006296832, -726.0115416718616, -33.136319256275804, -669.4629504730256, -233.05017168526075, -402.19636013255615, -889.8971003992773, -1040.4175492123331, -904.1504299202819, -614.8447500085398, -185.01039674078356, -734.6211816658592, -121.95626486973784, -256.3684065867853, -525.4058145458732, -530.4509809550127, -761.598380456192, -377.9783256783519, -682.4739793031158, -186.06417999213326, -850.5825875931015, -1031.579516724349, -65.23997913444046, -327.98639765294115, -395.0507018959294, -1404.6534100332185, -815.7240597834088, -919.2888236559772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5505599667656099, "mean_inference_ms": 1.6641686472961938, "mean_action_processing_ms": 0.2744134069966989, "mean_env_wait_ms": 3.4216834153283258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011907100677490234, "StateBufferConnector_ms": 0.007954835891723633, "ViewRequirementAgentConnector_ms": 0.1939859390258789}, "num_episodes": 31, "episode_return_max": -27.847484198660876, "episode_return_min": -1404.6534100332185, "episode_return_mean": -576.0162105293743, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.4191674417748, "num_env_steps_trained_throughput_per_sec": 503.4191674417748, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 11828.681, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11828.607, "sample_time_ms": 1135.149, "learn_time_ms": 10628.513, "learn_throughput": 376.346, "synch_weights_time_ms": 64.119}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1e132_00003", "date": "2024-08-04_07-59-21", "timestamp": 1722738561, "time_this_iter_s": 7.956954002380371, "time_total_s": 283.92771792411804, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aea70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.92771792411804, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 22.572727272727278, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.97957188487052, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.242729825526476, "policy_loss": -0.00968758896633517, "vf_loss": 5.246525834997495, "vf_explained_var": 0.9628184353932738, "kl": 0.013333413657948275, "entropy": 1.0843170809869964, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -27.847484198660876, "episode_reward_min": -1404.6534100332185, "episode_reward_mean": -604.9535240874721, "episode_len_mean": 126.93, "episode_media": {}, "episodes_timesteps_total": 12693, "policy_reward_min": {"policy_0": -1404.6534100332185}, "policy_reward_max": {"policy_0": -27.847484198660876}, "policy_reward_mean": {"policy_0": -604.9535240874721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-487.668050240713, -445.3154110160308, -1223.8390334839685, -101.96902992189342, -575.8609462959276, -652.0452408931867, -992.7413651397758, -740.6622999168027, -178.8386166656595, -498.50138964259946, -1131.52011709207, -93.94671931414045, -375.3960834345903, -64.51795127293957, -747.0267763754291, -968.2881750739516, -161.95717219316225, -817.9029517891952, -1036.2285372104097, -549.4419310849761, -573.8915322406293, -455.0264300606972, -155.40851427706545, -536.9447434877086, -991.0669553712628, -903.8360770713681, -883.1757707215162, -27.847484198660876, -1215.4506519714553, -692.2435071301798, -67.56534425644439, -1105.8774123933158, -766.9452198013689, -1083.3647460386362, -876.2636022984831, -179.1349558396755, -565.9160800668691, -66.60431694494973, -1207.1735742501667, -756.9603006296832, -726.0115416718616, -33.136319256275804, -669.4629504730256, -233.05017168526075, -402.19636013255615, -889.8971003992773, -1040.4175492123331, -904.1504299202819, -614.8447500085398, -185.01039674078356, -734.6211816658592, -121.95626486973784, -256.3684065867853, -525.4058145458732, -530.4509809550127, -761.598380456192, -377.9783256783519, -682.4739793031158, -186.06417999213326, -850.5825875931015, -1031.579516724349, -65.23997913444046, -327.98639765294115, -395.0507018959294, -1404.6534100332185, -815.7240597834088, -919.2888236559772, -927.4362871637143, -94.46462011204324, -345.1158834879743, -700.420270878286, -724.4564672694235, -250.72186500803812, -584.3200386449487, -295.78908238942535, -539.5626938237756, -105.57218699746699, -99.56134920682445, -1022.4431942486757, -1334.7787708252247, -471.16461442527014, -1001.2316533728452, -574.4187934697898, -498.2092965088976, -86.37273654291641, -1046.0445369690558, -1231.435276801101, -180.58917119552504, -1105.659727472972, -167.78987117522342, -44.66617959871848, -511.29820803988355, -50.38097022559246, -1340.6663958160775, -1186.5050613962092, -828.5133219741216, -552.2771016997365, -520.3338304174061, -807.5083993627292, -626.0789750931469], "episode_lengths": [150, 129, 150, 58, 150, 150, 150, 150, 82, 150, 150, 64, 114, 58, 142, 150, 77, 150, 150, 150, 150, 150, 92, 119, 150, 150, 150, 43, 150, 150, 51, 150, 150, 150, 150, 110, 150, 50, 150, 150, 150, 51, 150, 87, 100, 150, 150, 150, 150, 78, 150, 61, 96, 150, 150, 150, 111, 150, 106, 150, 150, 54, 128, 116, 150, 150, 150, 150, 78, 117, 150, 150, 90, 150, 150, 150, 73, 80, 150, 150, 148, 150, 150, 150, 60, 150, 150, 98, 150, 94, 62, 150, 52, 150, 150, 150, 114, 150, 150, 150], "policy_policy_0_reward": [-487.668050240713, -445.3154110160308, -1223.8390334839685, -101.96902992189342, -575.8609462959276, -652.0452408931867, -992.7413651397758, -740.6622999168027, -178.8386166656595, -498.50138964259946, -1131.52011709207, -93.94671931414045, -375.3960834345903, -64.51795127293957, -747.0267763754291, -968.2881750739516, -161.95717219316225, -817.9029517891952, -1036.2285372104097, -549.4419310849761, -573.8915322406293, -455.0264300606972, -155.40851427706545, -536.9447434877086, -991.0669553712628, -903.8360770713681, -883.1757707215162, -27.847484198660876, -1215.4506519714553, -692.2435071301798, -67.56534425644439, -1105.8774123933158, -766.9452198013689, -1083.3647460386362, -876.2636022984831, -179.1349558396755, -565.9160800668691, -66.60431694494973, -1207.1735742501667, -756.9603006296832, -726.0115416718616, -33.136319256275804, -669.4629504730256, -233.05017168526075, -402.19636013255615, -889.8971003992773, -1040.4175492123331, -904.1504299202819, -614.8447500085398, -185.01039674078356, -734.6211816658592, -121.95626486973784, -256.3684065867853, -525.4058145458732, -530.4509809550127, -761.598380456192, -377.9783256783519, -682.4739793031158, -186.06417999213326, -850.5825875931015, -1031.579516724349, -65.23997913444046, -327.98639765294115, -395.0507018959294, -1404.6534100332185, -815.7240597834088, -919.2888236559772, -927.4362871637143, -94.46462011204324, -345.1158834879743, -700.420270878286, -724.4564672694235, -250.72186500803812, -584.3200386449487, -295.78908238942535, -539.5626938237756, -105.57218699746699, -99.56134920682445, -1022.4431942486757, -1334.7787708252247, -471.16461442527014, -1001.2316533728452, -574.4187934697898, -498.2092965088976, -86.37273654291641, -1046.0445369690558, -1231.435276801101, -180.58917119552504, -1105.659727472972, -167.78987117522342, -44.66617959871848, -511.29820803988355, -50.38097022559246, -1340.6663958160775, -1186.5050613962092, -828.5133219741216, -552.2771016997365, -520.3338304174061, -807.5083993627292, -626.0789750931469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5507802364057964, "mean_inference_ms": 1.6647765417735465, "mean_action_processing_ms": 0.27439228733232657, "mean_env_wait_ms": 3.4213776016316775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012230157852172852, "StateBufferConnector_ms": 0.008018255233764648, "ViewRequirementAgentConnector_ms": 0.19807672500610352}, "num_episodes": 33, "episode_return_max": -27.847484198660876, "episode_return_min": -1404.6534100332185, "episode_return_mean": -604.9535240874721, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.6492090470083, "num_env_steps_trained_throughput_per_sec": 402.6492090470083, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11497.391, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11497.317, "sample_time_ms": 1141.501, "learn_time_ms": 10292.67, "learn_throughput": 388.626, "synch_weights_time_ms": 62.326}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1e132_00003", "date": "2024-08-04_07-59-31", "timestamp": 1722738571, "time_this_iter_s": 9.947603702545166, "time_total_s": 293.8753216266632, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac136dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 293.8753216266632, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.992857142857144, "ram_util_percent": 28.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.0125919719537, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.067455667008956, "policy_loss": -0.006245945047703571, "vf_loss": 5.066654227425655, "vf_explained_var": 0.9678882984444499, "kl": 0.01587894659505766, "entropy": 0.9815557427704334, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -29.929014851992648, "episode_reward_min": -1404.6534100332185, "episode_reward_mean": -630.8559601151595, "episode_len_mean": 129.12, "episode_media": {}, "episodes_timesteps_total": 12912, "policy_reward_min": {"policy_0": -1404.6534100332185}, "policy_reward_max": {"policy_0": -29.929014851992648}, "policy_reward_mean": {"policy_0": -630.8559601151595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-692.2435071301798, -67.56534425644439, -1105.8774123933158, -766.9452198013689, -1083.3647460386362, -876.2636022984831, -179.1349558396755, -565.9160800668691, -66.60431694494973, -1207.1735742501667, -756.9603006296832, -726.0115416718616, -33.136319256275804, -669.4629504730256, -233.05017168526075, -402.19636013255615, -889.8971003992773, -1040.4175492123331, -904.1504299202819, -614.8447500085398, -185.01039674078356, -734.6211816658592, -121.95626486973784, -256.3684065867853, -525.4058145458732, -530.4509809550127, -761.598380456192, -377.9783256783519, -682.4739793031158, -186.06417999213326, -850.5825875931015, -1031.579516724349, -65.23997913444046, -327.98639765294115, -395.0507018959294, -1404.6534100332185, -815.7240597834088, -919.2888236559772, -927.4362871637143, -94.46462011204324, -345.1158834879743, -700.420270878286, -724.4564672694235, -250.72186500803812, -584.3200386449487, -295.78908238942535, -539.5626938237756, -105.57218699746699, -99.56134920682445, -1022.4431942486757, -1334.7787708252247, -471.16461442527014, -1001.2316533728452, -574.4187934697898, -498.2092965088976, -86.37273654291641, -1046.0445369690558, -1231.435276801101, -180.58917119552504, -1105.659727472972, -167.78987117522342, -44.66617959871848, -511.29820803988355, -50.38097022559246, -1340.6663958160775, -1186.5050613962092, -828.5133219741216, -552.2771016997365, -520.3338304174061, -807.5083993627292, -626.0789750931469, -433.1705158711559, -781.325588073884, -1370.9264524137586, -907.4793028490335, -1314.9799860528071, -796.6747521762098, -934.8076855722237, -110.67260300186163, -738.3602810800977, -696.6686686496175, -634.4275322324282, -68.46740302533682, -748.20944453939, -259.67167674859587, -1095.6011567079224, -735.8205457387185, -167.6012850632013, -430.1431469203709, -843.7914962399005, -659.3185296622108, -774.2932039182245, -1010.2336004940516, -300.8607396440571, -1117.7027942719553, -993.4097843087509, -804.2281011063421, -847.151094352493, -570.6331746599341, -29.929014851992648], "episode_lengths": [150, 51, 150, 150, 150, 150, 110, 150, 50, 150, 150, 150, 51, 150, 87, 100, 150, 150, 150, 150, 78, 150, 61, 96, 150, 150, 150, 111, 150, 106, 150, 150, 54, 128, 116, 150, 150, 150, 150, 78, 117, 150, 150, 90, 150, 150, 150, 73, 80, 150, 150, 148, 150, 150, 150, 60, 150, 150, 98, 150, 94, 62, 150, 52, 150, 150, 150, 114, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 85, 150, 150, 150, 62, 150, 106, 150, 150, 76, 105, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 58], "policy_policy_0_reward": [-692.2435071301798, -67.56534425644439, -1105.8774123933158, -766.9452198013689, -1083.3647460386362, -876.2636022984831, -179.1349558396755, -565.9160800668691, -66.60431694494973, -1207.1735742501667, -756.9603006296832, -726.0115416718616, -33.136319256275804, -669.4629504730256, -233.05017168526075, -402.19636013255615, -889.8971003992773, -1040.4175492123331, -904.1504299202819, -614.8447500085398, -185.01039674078356, -734.6211816658592, -121.95626486973784, -256.3684065867853, -525.4058145458732, -530.4509809550127, -761.598380456192, -377.9783256783519, -682.4739793031158, -186.06417999213326, -850.5825875931015, -1031.579516724349, -65.23997913444046, -327.98639765294115, -395.0507018959294, -1404.6534100332185, -815.7240597834088, -919.2888236559772, -927.4362871637143, -94.46462011204324, -345.1158834879743, -700.420270878286, -724.4564672694235, -250.72186500803812, -584.3200386449487, -295.78908238942535, -539.5626938237756, -105.57218699746699, -99.56134920682445, -1022.4431942486757, -1334.7787708252247, -471.16461442527014, -1001.2316533728452, -574.4187934697898, -498.2092965088976, -86.37273654291641, -1046.0445369690558, -1231.435276801101, -180.58917119552504, -1105.659727472972, -167.78987117522342, -44.66617959871848, -511.29820803988355, -50.38097022559246, -1340.6663958160775, -1186.5050613962092, -828.5133219741216, -552.2771016997365, -520.3338304174061, -807.5083993627292, -626.0789750931469, -433.1705158711559, -781.325588073884, -1370.9264524137586, -907.4793028490335, -1314.9799860528071, -796.6747521762098, -934.8076855722237, -110.67260300186163, -738.3602810800977, -696.6686686496175, -634.4275322324282, -68.46740302533682, -748.20944453939, -259.67167674859587, -1095.6011567079224, -735.8205457387185, -167.6012850632013, -430.1431469203709, -843.7914962399005, -659.3185296622108, -774.2932039182245, -1010.2336004940516, -300.8607396440571, -1117.7027942719553, -993.4097843087509, -804.2281011063421, -847.151094352493, -570.6331746599341, -29.929014851992648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5508111468638048, "mean_inference_ms": 1.6655666147282557, "mean_action_processing_ms": 0.2743374449458575, "mean_env_wait_ms": 3.4235580341245275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012369632720947266, "StateBufferConnector_ms": 0.00806427001953125, "ViewRequirementAgentConnector_ms": 0.19900918006896973}, "num_episodes": 29, "episode_return_max": -29.929014851992648, "episode_return_min": -1404.6534100332185, "episode_return_mean": -630.8559601151595, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.4245483099064, "num_env_steps_trained_throughput_per_sec": 305.4245483099064, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12012.877, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12012.803, "sample_time_ms": 1141.152, "learn_time_ms": 10806.43, "learn_throughput": 370.15, "synch_weights_time_ms": 64.401}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "1e132_00003", "date": "2024-08-04_07-59-44", "timestamp": 1722738584, "time_this_iter_s": 13.108541011810303, "time_total_s": 306.9838626384735, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1acaf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.9838626384735, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.584210526315786, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.02097140153248, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.668499886492888, "policy_loss": -0.010983007749503788, "vf_loss": 4.672773161530495, "vf_explained_var": 0.9802648860961198, "kl": 0.015098259061778663, "entropy": 0.8448972571020325, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -25.172455968867453, "episode_reward_min": -1404.6534100332185, "episode_reward_mean": -604.0404431803975, "episode_len_mean": 126.04, "episode_media": {}, "episodes_timesteps_total": 12604, "policy_reward_min": {"policy_0": -1404.6534100332185}, "policy_reward_max": {"policy_0": -25.172455968867453}, "policy_reward_mean": {"policy_0": -604.0404431803975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.23997913444046, -327.98639765294115, -395.0507018959294, -1404.6534100332185, -815.7240597834088, -919.2888236559772, -927.4362871637143, -94.46462011204324, -345.1158834879743, -700.420270878286, -724.4564672694235, -250.72186500803812, -584.3200386449487, -295.78908238942535, -539.5626938237756, -105.57218699746699, -99.56134920682445, -1022.4431942486757, -1334.7787708252247, -471.16461442527014, -1001.2316533728452, -574.4187934697898, -498.2092965088976, -86.37273654291641, -1046.0445369690558, -1231.435276801101, -180.58917119552504, -1105.659727472972, -167.78987117522342, -44.66617959871848, -511.29820803988355, -50.38097022559246, -1340.6663958160775, -1186.5050613962092, -828.5133219741216, -552.2771016997365, -520.3338304174061, -807.5083993627292, -626.0789750931469, -433.1705158711559, -781.325588073884, -1370.9264524137586, -907.4793028490335, -1314.9799860528071, -796.6747521762098, -934.8076855722237, -110.67260300186163, -738.3602810800977, -696.6686686496175, -634.4275322324282, -68.46740302533682, -748.20944453939, -259.67167674859587, -1095.6011567079224, -735.8205457387185, -167.6012850632013, -430.1431469203709, -843.7914962399005, -659.3185296622108, -774.2932039182245, -1010.2336004940516, -300.8607396440571, -1117.7027942719553, -993.4097843087509, -804.2281011063421, -847.151094352493, -570.6331746599341, -29.929014851992648, -690.0347738863445, -25.172455968867453, -291.64435717441893, -41.570060240881226, -642.9153042243167, -580.4416776468709, -615.8475118445649, -238.76622981073695, -494.9060066059262, -101.57035311583533, -243.11434954663136, -31.406003339544277, -1271.056323671885, -86.44210843860219, -954.6981190769573, -338.10571589873797, -810.4213963499716, -952.6159716434192, -667.0032716722243, -514.0293767816522, -142.275503766444, -1148.1980716528744, -1278.7427644055942, -309.9172246156225, -78.314398656094, -259.03163742079596, -707.5810091391133, -708.419102622018, -878.6930846090888, -842.3658165098083, -234.6149927008245, -263.8395810075904], "episode_lengths": [54, 128, 116, 150, 150, 150, 150, 78, 117, 150, 150, 90, 150, 150, 150, 73, 80, 150, 150, 148, 150, 150, 150, 60, 150, 150, 98, 150, 94, 62, 150, 52, 150, 150, 150, 114, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 85, 150, 150, 150, 62, 150, 106, 150, 150, 76, 105, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 58, 150, 51, 100, 45, 138, 150, 150, 101, 136, 64, 93, 51, 150, 60, 150, 104, 150, 150, 150, 150, 79, 150, 150, 123, 72, 94, 150, 150, 150, 150, 89, 93], "policy_policy_0_reward": [-65.23997913444046, -327.98639765294115, -395.0507018959294, -1404.6534100332185, -815.7240597834088, -919.2888236559772, -927.4362871637143, -94.46462011204324, -345.1158834879743, -700.420270878286, -724.4564672694235, -250.72186500803812, -584.3200386449487, -295.78908238942535, -539.5626938237756, -105.57218699746699, -99.56134920682445, -1022.4431942486757, -1334.7787708252247, -471.16461442527014, -1001.2316533728452, -574.4187934697898, -498.2092965088976, -86.37273654291641, -1046.0445369690558, -1231.435276801101, -180.58917119552504, -1105.659727472972, -167.78987117522342, -44.66617959871848, -511.29820803988355, -50.38097022559246, -1340.6663958160775, -1186.5050613962092, -828.5133219741216, -552.2771016997365, -520.3338304174061, -807.5083993627292, -626.0789750931469, -433.1705158711559, -781.325588073884, -1370.9264524137586, -907.4793028490335, -1314.9799860528071, -796.6747521762098, -934.8076855722237, -110.67260300186163, -738.3602810800977, -696.6686686496175, -634.4275322324282, -68.46740302533682, -748.20944453939, -259.67167674859587, -1095.6011567079224, -735.8205457387185, -167.6012850632013, -430.1431469203709, -843.7914962399005, -659.3185296622108, -774.2932039182245, -1010.2336004940516, -300.8607396440571, -1117.7027942719553, -993.4097843087509, -804.2281011063421, -847.151094352493, -570.6331746599341, -29.929014851992648, -690.0347738863445, -25.172455968867453, -291.64435717441893, -41.570060240881226, -642.9153042243167, -580.4416776468709, -615.8475118445649, -238.76622981073695, -494.9060066059262, -101.57035311583533, -243.11434954663136, -31.406003339544277, -1271.056323671885, -86.44210843860219, -954.6981190769573, -338.10571589873797, -810.4213963499716, -952.6159716434192, -667.0032716722243, -514.0293767816522, -142.275503766444, -1148.1980716528744, -1278.7427644055942, -309.9172246156225, -78.314398656094, -259.03163742079596, -707.5810091391133, -708.419102622018, -878.6930846090888, -842.3658165098083, -234.6149927008245, -263.8395810075904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5505296337341377, "mean_inference_ms": 1.6663167548655908, "mean_action_processing_ms": 0.2742984333312259, "mean_env_wait_ms": 3.4225316181119805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012428998947143555, "StateBufferConnector_ms": 0.008205652236938477, "ViewRequirementAgentConnector_ms": 0.20075368881225586}, "num_episodes": 32, "episode_return_max": -25.172455968867453, "episode_return_min": -1404.6534100332185, "episode_return_mean": -604.0404431803975, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.1826727299209, "num_env_steps_trained_throughput_per_sec": 308.1826727299209, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12057.709, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12057.635, "sample_time_ms": 1142.369, "learn_time_ms": 10850.106, "learn_throughput": 368.66, "synch_weights_time_ms": 64.348}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "1e132_00003", "date": "2024-08-04_07-59-57", "timestamp": 1722738597, "time_this_iter_s": 12.992206811904907, "time_total_s": 319.9760694503784, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1aea70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.9760694503784, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.47894736842105, "ram_util_percent": 28.221052631578942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 201.09317800005277, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.7472173367937405, "policy_loss": -0.01068172464632274, "vf_loss": 4.751109478871028, "vf_explained_var": 0.9318667208775878, "kl": 0.015327539417194202, "entropy": 1.078170314989984, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -25.172455968867453, "episode_reward_min": -1426.4560349051512, "episode_reward_mean": -633.0121456652195, "episode_len_mean": 128.88, "episode_media": {}, "episodes_timesteps_total": 12888, "policy_reward_min": {"policy_0": -1426.4560349051512}, "policy_reward_max": {"policy_0": -25.172455968867453}, "policy_reward_mean": {"policy_0": -633.0121456652195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1186.5050613962092, -828.5133219741216, -552.2771016997365, -520.3338304174061, -807.5083993627292, -626.0789750931469, -433.1705158711559, -781.325588073884, -1370.9264524137586, -907.4793028490335, -1314.9799860528071, -796.6747521762098, -934.8076855722237, -110.67260300186163, -738.3602810800977, -696.6686686496175, -634.4275322324282, -68.46740302533682, -748.20944453939, -259.67167674859587, -1095.6011567079224, -735.8205457387185, -167.6012850632013, -430.1431469203709, -843.7914962399005, -659.3185296622108, -774.2932039182245, -1010.2336004940516, -300.8607396440571, -1117.7027942719553, -993.4097843087509, -804.2281011063421, -847.151094352493, -570.6331746599341, -29.929014851992648, -690.0347738863445, -25.172455968867453, -291.64435717441893, -41.570060240881226, -642.9153042243167, -580.4416776468709, -615.8475118445649, -238.76622981073695, -494.9060066059262, -101.57035311583533, -243.11434954663136, -31.406003339544277, -1271.056323671885, -86.44210843860219, -954.6981190769573, -338.10571589873797, -810.4213963499716, -952.6159716434192, -667.0032716722243, -514.0293767816522, -142.275503766444, -1148.1980716528744, -1278.7427644055942, -309.9172246156225, -78.314398656094, -259.03163742079596, -707.5810091391133, -708.419102622018, -878.6930846090888, -842.3658165098083, -234.6149927008245, -263.8395810075904, -1002.3315456206127, -85.84760044216924, -618.1523073935557, -843.6872098988997, -1018.4075480843102, -663.9393399812247, -1426.4560349051512, -397.2438019242655, -883.4931903254421, -169.87662719340395, -813.4489001622646, -764.8606788915839, -989.4892861261037, -722.8725177053336, -517.5305630428514, -541.6261091436912, -746.3851335048474, -769.6499815316378, -151.43646368707718, -1017.9018505535485, -440.3066852258937, -574.310150284131, -695.9306866323328, -418.58321376284727, -930.7852079885073, -113.21582809481221, -1110.7656979822286, -291.0563525959913, -527.4416401597264, -97.62334755136683, -984.4373734206077, -1101.7903853346613, -728.8005031567461], "episode_lengths": [150, 150, 114, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 85, 150, 150, 150, 62, 150, 106, 150, 150, 76, 105, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 58, 150, 51, 100, 45, 138, 150, 150, 101, 136, 64, 93, 51, 150, 60, 150, 104, 150, 150, 150, 150, 79, 150, 150, 123, 72, 94, 150, 150, 150, 150, 89, 93, 150, 75, 150, 150, 150, 150, 150, 127, 150, 97, 150, 150, 150, 141, 114, 118, 150, 149, 93, 150, 150, 114, 139, 150, 150, 62, 150, 83, 150, 72, 150, 150, 150], "policy_policy_0_reward": [-1186.5050613962092, -828.5133219741216, -552.2771016997365, -520.3338304174061, -807.5083993627292, -626.0789750931469, -433.1705158711559, -781.325588073884, -1370.9264524137586, -907.4793028490335, -1314.9799860528071, -796.6747521762098, -934.8076855722237, -110.67260300186163, -738.3602810800977, -696.6686686496175, -634.4275322324282, -68.46740302533682, -748.20944453939, -259.67167674859587, -1095.6011567079224, -735.8205457387185, -167.6012850632013, -430.1431469203709, -843.7914962399005, -659.3185296622108, -774.2932039182245, -1010.2336004940516, -300.8607396440571, -1117.7027942719553, -993.4097843087509, -804.2281011063421, -847.151094352493, -570.6331746599341, -29.929014851992648, -690.0347738863445, -25.172455968867453, -291.64435717441893, -41.570060240881226, -642.9153042243167, -580.4416776468709, -615.8475118445649, -238.76622981073695, -494.9060066059262, -101.57035311583533, -243.11434954663136, -31.406003339544277, -1271.056323671885, -86.44210843860219, -954.6981190769573, -338.10571589873797, -810.4213963499716, -952.6159716434192, -667.0032716722243, -514.0293767816522, -142.275503766444, -1148.1980716528744, -1278.7427644055942, -309.9172246156225, -78.314398656094, -259.03163742079596, -707.5810091391133, -708.419102622018, -878.6930846090888, -842.3658165098083, -234.6149927008245, -263.8395810075904, -1002.3315456206127, -85.84760044216924, -618.1523073935557, -843.6872098988997, -1018.4075480843102, -663.9393399812247, -1426.4560349051512, -397.2438019242655, -883.4931903254421, -169.87662719340395, -813.4489001622646, -764.8606788915839, -989.4892861261037, -722.8725177053336, -517.5305630428514, -541.6261091436912, -746.3851335048474, -769.6499815316378, -151.43646368707718, -1017.9018505535485, -440.3066852258937, -574.310150284131, -695.9306866323328, -418.58321376284727, -930.7852079885073, -113.21582809481221, -1110.7656979822286, -291.0563525959913, -527.4416401597264, -97.62334755136683, -984.4373734206077, -1101.7903853346613, -728.8005031567461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5504941344764831, "mean_inference_ms": 1.6663441485875838, "mean_action_processing_ms": 0.2743044255067818, "mean_env_wait_ms": 3.4222963628177423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011975765228271484, "StateBufferConnector_ms": 0.00829625129699707, "ViewRequirementAgentConnector_ms": 0.19705653190612793}, "num_episodes": 33, "episode_return_max": -25.172455968867453, "episode_return_min": -1426.4560349051512, "episode_return_mean": -633.0121456652195, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.1828710474562, "num_env_steps_trained_throughput_per_sec": 311.1828710474562, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12018.667, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12018.593, "sample_time_ms": 1139.861, "learn_time_ms": 10813.725, "learn_throughput": 369.9, "synch_weights_time_ms": 64.193}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "1e132_00003", "date": "2024-08-04_08-00-10", "timestamp": 1722738610, "time_this_iter_s": 12.866580486297607, "time_total_s": 332.842649936676, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ae0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.842649936676, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.149999999999995, "ram_util_percent": 28.283333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.70315245787302, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.701038117955128, "policy_loss": -0.011134790724220996, "vf_loss": 4.705953176816305, "vf_explained_var": 0.9700384886935354, "kl": 0.014057938819769333, "entropy": 1.0631777616217732, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -25.172455968867453, "episode_reward_min": -1426.4560349051512, "episode_reward_mean": -593.0895784891256, "episode_len_mean": 125.69, "episode_media": {}, "episodes_timesteps_total": 12569, "policy_reward_min": {"policy_0": -1426.4560349051512}, "policy_reward_max": {"policy_0": -25.172455968867453}, "policy_reward_mean": {"policy_0": -593.0895784891256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-993.4097843087509, -804.2281011063421, -847.151094352493, -570.6331746599341, -29.929014851992648, -690.0347738863445, -25.172455968867453, -291.64435717441893, -41.570060240881226, -642.9153042243167, -580.4416776468709, -615.8475118445649, -238.76622981073695, -494.9060066059262, -101.57035311583533, -243.11434954663136, -31.406003339544277, -1271.056323671885, -86.44210843860219, -954.6981190769573, -338.10571589873797, -810.4213963499716, -952.6159716434192, -667.0032716722243, -514.0293767816522, -142.275503766444, -1148.1980716528744, -1278.7427644055942, -309.9172246156225, -78.314398656094, -259.03163742079596, -707.5810091391133, -708.419102622018, -878.6930846090888, -842.3658165098083, -234.6149927008245, -263.8395810075904, -1002.3315456206127, -85.84760044216924, -618.1523073935557, -843.6872098988997, -1018.4075480843102, -663.9393399812247, -1426.4560349051512, -397.2438019242655, -883.4931903254421, -169.87662719340395, -813.4489001622646, -764.8606788915839, -989.4892861261037, -722.8725177053336, -517.5305630428514, -541.6261091436912, -746.3851335048474, -769.6499815316378, -151.43646368707718, -1017.9018505535485, -440.3066852258937, -574.310150284131, -695.9306866323328, -418.58321376284727, -930.7852079885073, -113.21582809481221, -1110.7656979822286, -291.0563525959913, -527.4416401597264, -97.62334755136683, -984.4373734206077, -1101.7903853346613, -728.8005031567461, -562.2915341678892, -288.5984660960522, -192.91012443466713, -404.58661325195726, -736.1940582505616, -1229.5086548358136, -318.8408627934843, -945.3092195328549, -63.80758937730969, -63.66718667215322, -366.8472896571689, -493.61955304575207, -1367.1448780359733, -1086.677641556236, -1074.7282837441098, -729.5885395541986, -761.3728293928266, -725.8610509687653, -624.8013107323587, -183.1787165418985, -576.9193729532219, -41.36781269051135, -654.7666957001446, -29.69385798528526, -523.2768693672896, -467.6099850278847, -819.607651326336, -470.65674366856626, -945.9224809365284, -710.8124909831653], "episode_lengths": [150, 150, 150, 150, 58, 150, 51, 100, 45, 138, 150, 150, 101, 136, 64, 93, 51, 150, 60, 150, 104, 150, 150, 150, 150, 79, 150, 150, 123, 72, 94, 150, 150, 150, 150, 89, 93, 150, 75, 150, 150, 150, 150, 150, 127, 150, 97, 150, 150, 150, 141, 114, 118, 150, 149, 93, 150, 150, 114, 139, 150, 150, 62, 150, 83, 150, 72, 150, 150, 150, 150, 92, 94, 149, 150, 150, 83, 150, 76, 60, 147, 129, 150, 150, 150, 128, 150, 150, 150, 75, 116, 57, 150, 48, 150, 130, 150, 150, 150, 150], "policy_policy_0_reward": [-993.4097843087509, -804.2281011063421, -847.151094352493, -570.6331746599341, -29.929014851992648, -690.0347738863445, -25.172455968867453, -291.64435717441893, -41.570060240881226, -642.9153042243167, -580.4416776468709, -615.8475118445649, -238.76622981073695, -494.9060066059262, -101.57035311583533, -243.11434954663136, -31.406003339544277, -1271.056323671885, -86.44210843860219, -954.6981190769573, -338.10571589873797, -810.4213963499716, -952.6159716434192, -667.0032716722243, -514.0293767816522, -142.275503766444, -1148.1980716528744, -1278.7427644055942, -309.9172246156225, -78.314398656094, -259.03163742079596, -707.5810091391133, -708.419102622018, -878.6930846090888, -842.3658165098083, -234.6149927008245, -263.8395810075904, -1002.3315456206127, -85.84760044216924, -618.1523073935557, -843.6872098988997, -1018.4075480843102, -663.9393399812247, -1426.4560349051512, -397.2438019242655, -883.4931903254421, -169.87662719340395, -813.4489001622646, -764.8606788915839, -989.4892861261037, -722.8725177053336, -517.5305630428514, -541.6261091436912, -746.3851335048474, -769.6499815316378, -151.43646368707718, -1017.9018505535485, -440.3066852258937, -574.310150284131, -695.9306866323328, -418.58321376284727, -930.7852079885073, -113.21582809481221, -1110.7656979822286, -291.0563525959913, -527.4416401597264, -97.62334755136683, -984.4373734206077, -1101.7903853346613, -728.8005031567461, -562.2915341678892, -288.5984660960522, -192.91012443466713, -404.58661325195726, -736.1940582505616, -1229.5086548358136, -318.8408627934843, -945.3092195328549, -63.80758937730969, -63.66718667215322, -366.8472896571689, -493.61955304575207, -1367.1448780359733, -1086.677641556236, -1074.7282837441098, -729.5885395541986, -761.3728293928266, -725.8610509687653, -624.8013107323587, -183.1787165418985, -576.9193729532219, -41.36781269051135, -654.7666957001446, -29.69385798528526, -523.2768693672896, -467.6099850278847, -819.607651326336, -470.65674366856626, -945.9224809365284, -710.8124909831653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5508130791704577, "mean_inference_ms": 1.6666623985978066, "mean_action_processing_ms": 0.27430165162556225, "mean_env_wait_ms": 3.4217166514974644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012252569198608398, "StateBufferConnector_ms": 0.008563756942749023, "ViewRequirementAgentConnector_ms": 0.20283842086791992}, "num_episodes": 30, "episode_return_max": -25.172455968867453, "episode_return_min": -1426.4560349051512, "episode_return_mean": -593.0895784891256, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.2069408841974, "num_env_steps_trained_throughput_per_sec": 304.2069408841974, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12209.326, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12209.252, "sample_time_ms": 1149.176, "learn_time_ms": 10995.809, "learn_throughput": 363.775, "synch_weights_time_ms": 63.454}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "1e132_00003", "date": "2024-08-04_08-00-23", "timestamp": 1722738623, "time_this_iter_s": 13.160719633102417, "time_total_s": 346.00336956977844, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 346.00336956977844, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.85789473684211, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.69372183879216, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.225554567823807, "policy_loss": -0.014252783844131044, "vf_loss": 5.232230397810539, "vf_explained_var": 0.9575093764811754, "kl": 0.017051501315078592, "entropy": 0.9622727617621422, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -28.149989657529737, "episode_reward_min": -1426.4560349051512, "episode_reward_mean": -611.2617534983331, "episode_len_mean": 127.83, "episode_media": {}, "episodes_timesteps_total": 12783, "policy_reward_min": {"policy_0": -1426.4560349051512}, "policy_reward_max": {"policy_0": -28.149989657529737}, "policy_reward_mean": {"policy_0": -611.2617534983331}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-708.419102622018, -878.6930846090888, -842.3658165098083, -234.6149927008245, -263.8395810075904, -1002.3315456206127, -85.84760044216924, -618.1523073935557, -843.6872098988997, -1018.4075480843102, -663.9393399812247, -1426.4560349051512, -397.2438019242655, -883.4931903254421, -169.87662719340395, -813.4489001622646, -764.8606788915839, -989.4892861261037, -722.8725177053336, -517.5305630428514, -541.6261091436912, -746.3851335048474, -769.6499815316378, -151.43646368707718, -1017.9018505535485, -440.3066852258937, -574.310150284131, -695.9306866323328, -418.58321376284727, -930.7852079885073, -113.21582809481221, -1110.7656979822286, -291.0563525959913, -527.4416401597264, -97.62334755136683, -984.4373734206077, -1101.7903853346613, -728.8005031567461, -562.2915341678892, -288.5984660960522, -192.91012443466713, -404.58661325195726, -736.1940582505616, -1229.5086548358136, -318.8408627934843, -945.3092195328549, -63.80758937730969, -63.66718667215322, -366.8472896571689, -493.61955304575207, -1367.1448780359733, -1086.677641556236, -1074.7282837441098, -729.5885395541986, -761.3728293928266, -725.8610509687653, -624.8013107323587, -183.1787165418985, -576.9193729532219, -41.36781269051135, -654.7666957001446, -29.69385798528526, -523.2768693672896, -467.6099850278847, -819.607651326336, -470.65674366856626, -945.9224809365284, -710.8124909831653, -171.4702640578007, -194.92912882976066, -1035.2035171526238, -789.5118475343984, -528.8987109841019, -369.6944708437375, -39.13622942534631, -356.0671964363186, -789.3588172104502, -1154.3561129096295, -28.149989657529737, -1056.981968501107, -73.87583050840767, -325.49647352260047, -467.24658403807234, -821.0086460259886, -496.53792481481474, -908.5973978433415, -1117.9408767222374, -281.24494799959166, -564.530321632951, -699.3492613200544, -209.34201965433138, -1056.9002962679397, -970.1968723453123, -924.7402624689736, -676.0913443793875, -127.0334111885761, -339.2518338622987, -1068.0923806238432, -234.79777372914057, -702.3579343045229], "episode_lengths": [150, 150, 150, 89, 93, 150, 75, 150, 150, 150, 150, 150, 127, 150, 97, 150, 150, 150, 141, 114, 118, 150, 149, 93, 150, 150, 114, 139, 150, 150, 62, 150, 83, 150, 72, 150, 150, 150, 150, 92, 94, 149, 150, 150, 83, 150, 76, 60, 147, 129, 150, 150, 150, 128, 150, 150, 150, 75, 116, 57, 150, 48, 150, 130, 150, 150, 150, 150, 76, 90, 150, 144, 138, 150, 54, 145, 150, 150, 58, 150, 69, 115, 150, 149, 123, 150, 150, 84, 122, 139, 117, 150, 150, 150, 150, 85, 100, 150, 75, 150], "policy_policy_0_reward": [-708.419102622018, -878.6930846090888, -842.3658165098083, -234.6149927008245, -263.8395810075904, -1002.3315456206127, -85.84760044216924, -618.1523073935557, -843.6872098988997, -1018.4075480843102, -663.9393399812247, -1426.4560349051512, -397.2438019242655, -883.4931903254421, -169.87662719340395, -813.4489001622646, -764.8606788915839, -989.4892861261037, -722.8725177053336, -517.5305630428514, -541.6261091436912, -746.3851335048474, -769.6499815316378, -151.43646368707718, -1017.9018505535485, -440.3066852258937, -574.310150284131, -695.9306866323328, -418.58321376284727, -930.7852079885073, -113.21582809481221, -1110.7656979822286, -291.0563525959913, -527.4416401597264, -97.62334755136683, -984.4373734206077, -1101.7903853346613, -728.8005031567461, -562.2915341678892, -288.5984660960522, -192.91012443466713, -404.58661325195726, -736.1940582505616, -1229.5086548358136, -318.8408627934843, -945.3092195328549, -63.80758937730969, -63.66718667215322, -366.8472896571689, -493.61955304575207, -1367.1448780359733, -1086.677641556236, -1074.7282837441098, -729.5885395541986, -761.3728293928266, -725.8610509687653, -624.8013107323587, -183.1787165418985, -576.9193729532219, -41.36781269051135, -654.7666957001446, -29.69385798528526, -523.2768693672896, -467.6099850278847, -819.607651326336, -470.65674366856626, -945.9224809365284, -710.8124909831653, -171.4702640578007, -194.92912882976066, -1035.2035171526238, -789.5118475343984, -528.8987109841019, -369.6944708437375, -39.13622942534631, -356.0671964363186, -789.3588172104502, -1154.3561129096295, -28.149989657529737, -1056.981968501107, -73.87583050840767, -325.49647352260047, -467.24658403807234, -821.0086460259886, -496.53792481481474, -908.5973978433415, -1117.9408767222374, -281.24494799959166, -564.530321632951, -699.3492613200544, -209.34201965433138, -1056.9002962679397, -970.1968723453123, -924.7402624689736, -676.0913443793875, -127.0334111885761, -339.2518338622987, -1068.0923806238432, -234.79777372914057, -702.3579343045229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.550657161951552, "mean_inference_ms": 1.6676184192303711, "mean_action_processing_ms": 0.27419229647970156, "mean_env_wait_ms": 3.423645026498789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012156248092651367, "StateBufferConnector_ms": 0.008400678634643555, "ViewRequirementAgentConnector_ms": 0.20060396194458008}, "num_episodes": 32, "episode_return_max": -28.149989657529737, "episode_return_min": -1426.4560349051512, "episode_return_mean": -611.2617534983331, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.73627865778815, "num_env_steps_trained_throughput_per_sec": 301.73627865778815, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12213.231, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12213.158, "sample_time_ms": 1146.279, "learn_time_ms": 11002.644, "learn_throughput": 363.549, "synch_weights_time_ms": 63.422}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "1e132_00003", "date": "2024-08-04_08-00-37", "timestamp": 1722738637, "time_this_iter_s": 13.267614364624023, "time_total_s": 359.27098393440247, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354070b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 359.27098393440247, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.41578947368421, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.71360842585563, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.993648354460796, "policy_loss": -0.008861104343668557, "vf_loss": 4.995267857362827, "vf_explained_var": 0.9808181579535206, "kl": 0.01630404478216105, "entropy": 0.9522193467865387, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -3.204163192140832, "episode_reward_min": -1375.80460800831, "episode_reward_mean": -561.2079321410433, "episode_len_mean": 123.48, "episode_media": {}, "episodes_timesteps_total": 12348, "policy_reward_min": {"policy_0": -1375.80460800831}, "policy_reward_max": {"policy_0": -3.204163192140832}, "policy_reward_mean": {"policy_0": -561.2079321410433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-728.8005031567461, -562.2915341678892, -288.5984660960522, -192.91012443466713, -404.58661325195726, -736.1940582505616, -1229.5086548358136, -318.8408627934843, -945.3092195328549, -63.80758937730969, -63.66718667215322, -366.8472896571689, -493.61955304575207, -1367.1448780359733, -1086.677641556236, -1074.7282837441098, -729.5885395541986, -761.3728293928266, -725.8610509687653, -624.8013107323587, -183.1787165418985, -576.9193729532219, -41.36781269051135, -654.7666957001446, -29.69385798528526, -523.2768693672896, -467.6099850278847, -819.607651326336, -470.65674366856626, -945.9224809365284, -710.8124909831653, -171.4702640578007, -194.92912882976066, -1035.2035171526238, -789.5118475343984, -528.8987109841019, -369.6944708437375, -39.13622942534631, -356.0671964363186, -789.3588172104502, -1154.3561129096295, -28.149989657529737, -1056.981968501107, -73.87583050840767, -325.49647352260047, -467.24658403807234, -821.0086460259886, -496.53792481481474, -908.5973978433415, -1117.9408767222374, -281.24494799959166, -564.530321632951, -699.3492613200544, -209.34201965433138, -1056.9002962679397, -970.1968723453123, -924.7402624689736, -676.0913443793875, -127.0334111885761, -339.2518338622987, -1068.0923806238432, -234.79777372914057, -702.3579343045229, -1157.7433682401481, -154.7990528430927, -992.388427554965, -31.52006791530769, -246.81551865842138, -3.204163192140832, -263.5097566787989, -844.6709895498975, -269.4681254582585, -604.6780326985213, -500.0407504642101, -739.9188017272463, -784.4297390132677, -1234.4168381477807, -1129.4941762960966, -519.159964621276, -377.1782416501081, -430.5349259442311, -33.75108664539717, -771.7544406368843, -206.3697017784386, -1091.0639705139304, -1125.9167190373926, -900.1694013431651, -324.0213006430726, -1375.80460800831, -70.31706821108712, -80.31682436968833, -341.56074951662464, -641.6589227040098, -85.8297508154185, -161.2272014994966, -21.54431407295261, -472.987198060877, -329.1581373958754, -800.8193769398763, -235.1919880251609], "episode_lengths": [150, 150, 92, 94, 149, 150, 150, 83, 150, 76, 60, 147, 129, 150, 150, 150, 128, 150, 150, 150, 75, 116, 57, 150, 48, 150, 130, 150, 150, 150, 150, 76, 90, 150, 144, 138, 150, 54, 145, 150, 150, 58, 150, 69, 115, 150, 149, 123, 150, 150, 84, 122, 139, 117, 150, 150, 150, 150, 85, 100, 150, 75, 150, 150, 74, 150, 59, 125, 33, 93, 150, 128, 150, 110, 150, 150, 150, 150, 150, 150, 124, 51, 150, 113, 150, 150, 150, 150, 150, 57, 81, 107, 150, 57, 105, 46, 150, 92, 150, 126], "policy_policy_0_reward": [-728.8005031567461, -562.2915341678892, -288.5984660960522, -192.91012443466713, -404.58661325195726, -736.1940582505616, -1229.5086548358136, -318.8408627934843, -945.3092195328549, -63.80758937730969, -63.66718667215322, -366.8472896571689, -493.61955304575207, -1367.1448780359733, -1086.677641556236, -1074.7282837441098, -729.5885395541986, -761.3728293928266, -725.8610509687653, -624.8013107323587, -183.1787165418985, -576.9193729532219, -41.36781269051135, -654.7666957001446, -29.69385798528526, -523.2768693672896, -467.6099850278847, -819.607651326336, -470.65674366856626, -945.9224809365284, -710.8124909831653, -171.4702640578007, -194.92912882976066, -1035.2035171526238, -789.5118475343984, -528.8987109841019, -369.6944708437375, -39.13622942534631, -356.0671964363186, -789.3588172104502, -1154.3561129096295, -28.149989657529737, -1056.981968501107, -73.87583050840767, -325.49647352260047, -467.24658403807234, -821.0086460259886, -496.53792481481474, -908.5973978433415, -1117.9408767222374, -281.24494799959166, -564.530321632951, -699.3492613200544, -209.34201965433138, -1056.9002962679397, -970.1968723453123, -924.7402624689736, -676.0913443793875, -127.0334111885761, -339.2518338622987, -1068.0923806238432, -234.79777372914057, -702.3579343045229, -1157.7433682401481, -154.7990528430927, -992.388427554965, -31.52006791530769, -246.81551865842138, -3.204163192140832, -263.5097566787989, -844.6709895498975, -269.4681254582585, -604.6780326985213, -500.0407504642101, -739.9188017272463, -784.4297390132677, -1234.4168381477807, -1129.4941762960966, -519.159964621276, -377.1782416501081, -430.5349259442311, -33.75108664539717, -771.7544406368843, -206.3697017784386, -1091.0639705139304, -1125.9167190373926, -900.1694013431651, -324.0213006430726, -1375.80460800831, -70.31706821108712, -80.31682436968833, -341.56074951662464, -641.6589227040098, -85.8297508154185, -161.2272014994966, -21.54431407295261, -472.987198060877, -329.1581373958754, -800.8193769398763, -235.1919880251609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510119650145604, "mean_inference_ms": 1.6687427281334666, "mean_action_processing_ms": 0.2741207768283513, "mean_env_wait_ms": 3.4222440875340743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012257099151611328, "StateBufferConnector_ms": 0.00832819938659668, "ViewRequirementAgentConnector_ms": 0.20462608337402344}, "num_episodes": 37, "episode_return_max": -3.204163192140832, "episode_return_min": -1375.80460800831, "episode_return_mean": -561.2079321410433, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.8282702218228, "num_env_steps_trained_throughput_per_sec": 303.8282702218228, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12189.208, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12189.134, "sample_time_ms": 1145.907, "learn_time_ms": 10979.888, "learn_throughput": 364.302, "synch_weights_time_ms": 62.557}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "1e132_00003", "date": "2024-08-04_08-00-50", "timestamp": 1722738650, "time_this_iter_s": 13.177140712738037, "time_total_s": 372.4481246471405, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354071a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.4481246471405, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.59444444444445, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.6558574974537, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.4668457540373, "policy_loss": -0.010691821690124925, "vf_loss": 4.470885593692461, "vf_explained_var": 0.9704107490678628, "kl": 0.014998688627262407, "entropy": 0.9744438325986267, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -3.204163192140832, "episode_reward_min": -1375.80460800831, "episode_reward_mean": -545.6684099273378, "episode_len_mean": 121.13, "episode_media": {}, "episodes_timesteps_total": 12113, "policy_reward_min": {"policy_0": -1375.80460800831}, "policy_reward_max": {"policy_0": -3.204163192140832}, "policy_reward_mean": {"policy_0": -545.6684099273378}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-194.92912882976066, -1035.2035171526238, -789.5118475343984, -528.8987109841019, -369.6944708437375, -39.13622942534631, -356.0671964363186, -789.3588172104502, -1154.3561129096295, -28.149989657529737, -1056.981968501107, -73.87583050840767, -325.49647352260047, -467.24658403807234, -821.0086460259886, -496.53792481481474, -908.5973978433415, -1117.9408767222374, -281.24494799959166, -564.530321632951, -699.3492613200544, -209.34201965433138, -1056.9002962679397, -970.1968723453123, -924.7402624689736, -676.0913443793875, -127.0334111885761, -339.2518338622987, -1068.0923806238432, -234.79777372914057, -702.3579343045229, -1157.7433682401481, -154.7990528430927, -992.388427554965, -31.52006791530769, -246.81551865842138, -3.204163192140832, -263.5097566787989, -844.6709895498975, -269.4681254582585, -604.6780326985213, -500.0407504642101, -739.9188017272463, -784.4297390132677, -1234.4168381477807, -1129.4941762960966, -519.159964621276, -377.1782416501081, -430.5349259442311, -33.75108664539717, -771.7544406368843, -206.3697017784386, -1091.0639705139304, -1125.9167190373926, -900.1694013431651, -324.0213006430726, -1375.80460800831, -70.31706821108712, -80.31682436968833, -341.56074951662464, -641.6589227040098, -85.8297508154185, -161.2272014994966, -21.54431407295261, -472.987198060877, -329.1581373958754, -800.8193769398763, -235.1919880251609, -34.10994877584249, -70.37085734254816, -1265.7000291983875, -1119.6029249281123, -503.0433544484108, -155.02563190419045, -391.7300467668233, -227.26258601516898, -57.74370632179056, -801.5953936523371, -409.04060669775714, -706.6782558771729, -108.98324123857611, -285.66732262499545, -647.6501899537712, -144.79602889201578, -776.2963498123545, -54.58525090510171, -398.8971577874109, -839.3246949774675, -227.42744337693702, -700.9747264903, -1112.4701641548397, -125.39780854360305, -1049.9835963246014, -538.4011789274184, -1035.9331472987767, -394.03348169378944, -572.8785657713814, -677.0513170284981, -736.407163185534, -637.4247382090648], "episode_lengths": [90, 150, 144, 138, 150, 54, 145, 150, 150, 58, 150, 69, 115, 150, 149, 123, 150, 150, 84, 122, 139, 117, 150, 150, 150, 150, 85, 100, 150, 75, 150, 150, 74, 150, 59, 125, 33, 93, 150, 128, 150, 110, 150, 150, 150, 150, 150, 150, 124, 51, 150, 113, 150, 150, 150, 150, 150, 57, 81, 107, 150, 57, 105, 46, 150, 92, 150, 126, 56, 53, 150, 150, 115, 69, 114, 122, 56, 150, 128, 150, 82, 106, 122, 67, 150, 66, 124, 150, 81, 150, 150, 69, 150, 150, 150, 107, 150, 138, 150, 150], "policy_policy_0_reward": [-194.92912882976066, -1035.2035171526238, -789.5118475343984, -528.8987109841019, -369.6944708437375, -39.13622942534631, -356.0671964363186, -789.3588172104502, -1154.3561129096295, -28.149989657529737, -1056.981968501107, -73.87583050840767, -325.49647352260047, -467.24658403807234, -821.0086460259886, -496.53792481481474, -908.5973978433415, -1117.9408767222374, -281.24494799959166, -564.530321632951, -699.3492613200544, -209.34201965433138, -1056.9002962679397, -970.1968723453123, -924.7402624689736, -676.0913443793875, -127.0334111885761, -339.2518338622987, -1068.0923806238432, -234.79777372914057, -702.3579343045229, -1157.7433682401481, -154.7990528430927, -992.388427554965, -31.52006791530769, -246.81551865842138, -3.204163192140832, -263.5097566787989, -844.6709895498975, -269.4681254582585, -604.6780326985213, -500.0407504642101, -739.9188017272463, -784.4297390132677, -1234.4168381477807, -1129.4941762960966, -519.159964621276, -377.1782416501081, -430.5349259442311, -33.75108664539717, -771.7544406368843, -206.3697017784386, -1091.0639705139304, -1125.9167190373926, -900.1694013431651, -324.0213006430726, -1375.80460800831, -70.31706821108712, -80.31682436968833, -341.56074951662464, -641.6589227040098, -85.8297508154185, -161.2272014994966, -21.54431407295261, -472.987198060877, -329.1581373958754, -800.8193769398763, -235.1919880251609, -34.10994877584249, -70.37085734254816, -1265.7000291983875, -1119.6029249281123, -503.0433544484108, -155.02563190419045, -391.7300467668233, -227.26258601516898, -57.74370632179056, -801.5953936523371, -409.04060669775714, -706.6782558771729, -108.98324123857611, -285.66732262499545, -647.6501899537712, -144.79602889201578, -776.2963498123545, -54.58525090510171, -398.8971577874109, -839.3246949774675, -227.42744337693702, -700.9747264903, -1112.4701641548397, -125.39780854360305, -1049.9835963246014, -538.4011789274184, -1035.9331472987767, -394.03348169378944, -572.8785657713814, -677.0513170284981, -736.407163185534, -637.4247382090648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5508516815834362, "mean_inference_ms": 1.6895882656140355, "mean_action_processing_ms": 0.27394762767133685, "mean_env_wait_ms": 3.4199354332414855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012382030487060547, "StateBufferConnector_ms": 0.008080005645751953, "ViewRequirementAgentConnector_ms": 0.19738245010375977}, "num_episodes": 32, "episode_return_max": -3.204163192140832, "episode_return_min": -1375.80460800831, "episode_return_mean": -545.6684099273378, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.2080846547854, "num_env_steps_trained_throughput_per_sec": 302.2080846547854, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12236.285, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12236.211, "sample_time_ms": 1182.609, "learn_time_ms": 10990.682, "learn_throughput": 363.945, "synch_weights_time_ms": 62.137}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "1e132_00003", "date": "2024-08-04_08-01-03", "timestamp": 1722738663, "time_this_iter_s": 13.248517990112305, "time_total_s": 385.6966426372528, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 385.6966426372528, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.747368421052627, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.10641349156697, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.883644996335109, "policy_loss": -0.016189710957890686, "vf_loss": 4.892468815545241, "vf_explained_var": 0.969129857296745, "kl": 0.01657406475587777, "entropy": 0.9243678157838683, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -3.204163192140832, "episode_reward_min": -1375.80460800831, "episode_reward_mean": -525.8966484062754, "episode_len_mean": 120.68, "episode_media": {}, "episodes_timesteps_total": 12068, "policy_reward_min": {"policy_0": -1375.80460800831}, "policy_reward_max": {"policy_0": -3.204163192140832}, "policy_reward_mean": {"policy_0": -525.8966484062754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154.7990528430927, -992.388427554965, -31.52006791530769, -246.81551865842138, -3.204163192140832, -263.5097566787989, -844.6709895498975, -269.4681254582585, -604.6780326985213, -500.0407504642101, -739.9188017272463, -784.4297390132677, -1234.4168381477807, -1129.4941762960966, -519.159964621276, -377.1782416501081, -430.5349259442311, -33.75108664539717, -771.7544406368843, -206.3697017784386, -1091.0639705139304, -1125.9167190373926, -900.1694013431651, -324.0213006430726, -1375.80460800831, -70.31706821108712, -80.31682436968833, -341.56074951662464, -641.6589227040098, -85.8297508154185, -161.2272014994966, -21.54431407295261, -472.987198060877, -329.1581373958754, -800.8193769398763, -235.1919880251609, -34.10994877584249, -70.37085734254816, -1265.7000291983875, -1119.6029249281123, -503.0433544484108, -155.02563190419045, -391.7300467668233, -227.26258601516898, -57.74370632179056, -801.5953936523371, -409.04060669775714, -706.6782558771729, -108.98324123857611, -285.66732262499545, -647.6501899537712, -144.79602889201578, -776.2963498123545, -54.58525090510171, -398.8971577874109, -839.3246949774675, -227.42744337693702, -700.9747264903, -1112.4701641548397, -125.39780854360305, -1049.9835963246014, -538.4011789274184, -1035.9331472987767, -394.03348169378944, -572.8785657713814, -677.0513170284981, -736.407163185534, -637.4247382090648, -273.2937190488948, -665.7883353496472, -630.6055143805955, -425.1713423442571, -239.68751099383763, -91.80575906068616, -147.29224724800542, -124.85208735020949, -651.1779726234241, -425.0991038926399, -1044.3396267781031, -618.5725561577069, -721.0778600166045, -1362.251313368157, -550.1403341397288, -179.15114313436558, -176.90300555232432, -1115.7443080967746, -306.04389608097614, -771.4143024858987, -1272.569668327925, -254.60435486316038, -261.0328594507929, -53.62768976183692, -142.7657180481092, -234.1906352298585, -1155.6309557847992, -727.2846755257685, -404.2056637396875, -1353.2905970831664, -78.74119339223996, -1129.1316495611004], "episode_lengths": [74, 150, 59, 125, 33, 93, 150, 128, 150, 110, 150, 150, 150, 150, 150, 150, 124, 51, 150, 113, 150, 150, 150, 150, 150, 57, 81, 107, 150, 57, 105, 46, 150, 92, 150, 126, 56, 53, 150, 150, 115, 69, 114, 122, 56, 150, 128, 150, 82, 106, 122, 67, 150, 66, 124, 150, 81, 150, 150, 69, 150, 150, 150, 107, 150, 138, 150, 150, 96, 150, 150, 150, 150, 82, 71, 78, 150, 150, 150, 150, 145, 150, 150, 77, 98, 150, 150, 150, 150, 150, 99, 55, 57, 87, 150, 150, 150, 150, 67, 150], "policy_policy_0_reward": [-154.7990528430927, -992.388427554965, -31.52006791530769, -246.81551865842138, -3.204163192140832, -263.5097566787989, -844.6709895498975, -269.4681254582585, -604.6780326985213, -500.0407504642101, -739.9188017272463, -784.4297390132677, -1234.4168381477807, -1129.4941762960966, -519.159964621276, -377.1782416501081, -430.5349259442311, -33.75108664539717, -771.7544406368843, -206.3697017784386, -1091.0639705139304, -1125.9167190373926, -900.1694013431651, -324.0213006430726, -1375.80460800831, -70.31706821108712, -80.31682436968833, -341.56074951662464, -641.6589227040098, -85.8297508154185, -161.2272014994966, -21.54431407295261, -472.987198060877, -329.1581373958754, -800.8193769398763, -235.1919880251609, -34.10994877584249, -70.37085734254816, -1265.7000291983875, -1119.6029249281123, -503.0433544484108, -155.02563190419045, -391.7300467668233, -227.26258601516898, -57.74370632179056, -801.5953936523371, -409.04060669775714, -706.6782558771729, -108.98324123857611, -285.66732262499545, -647.6501899537712, -144.79602889201578, -776.2963498123545, -54.58525090510171, -398.8971577874109, -839.3246949774675, -227.42744337693702, -700.9747264903, -1112.4701641548397, -125.39780854360305, -1049.9835963246014, -538.4011789274184, -1035.9331472987767, -394.03348169378944, -572.8785657713814, -677.0513170284981, -736.407163185534, -637.4247382090648, -273.2937190488948, -665.7883353496472, -630.6055143805955, -425.1713423442571, -239.68751099383763, -91.80575906068616, -147.29224724800542, -124.85208735020949, -651.1779726234241, -425.0991038926399, -1044.3396267781031, -618.5725561577069, -721.0778600166045, -1362.251313368157, -550.1403341397288, -179.15114313436558, -176.90300555232432, -1115.7443080967746, -306.04389608097614, -771.4143024858987, -1272.569668327925, -254.60435486316038, -261.0328594507929, -53.62768976183692, -142.7657180481092, -234.1906352298585, -1155.6309557847992, -727.2846755257685, -404.2056637396875, -1353.2905970831664, -78.74119339223996, -1129.1316495611004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5506705315189252, "mean_inference_ms": 1.7086781399814757, "mean_action_processing_ms": 0.27376037843411166, "mean_env_wait_ms": 3.4164515002041806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012439966201782227, "StateBufferConnector_ms": 0.008110523223876953, "ViewRequirementAgentConnector_ms": 0.19842195510864258}, "num_episodes": 32, "episode_return_max": -3.204163192140832, "episode_return_min": -1375.80460800831, "episode_return_mean": -525.8966484062754, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.4628793641443, "num_env_steps_trained_throughput_per_sec": 305.4628793641443, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12271.17, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12271.094, "sample_time_ms": 1200.157, "learn_time_ms": 11008.892, "learn_throughput": 363.343, "synch_weights_time_ms": 61.261}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "1e132_00003", "date": "2024-08-04_08-01-16", "timestamp": 1722738676, "time_this_iter_s": 13.107576131820679, "time_total_s": 398.8042187690735, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ad480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 398.8042187690735, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.5, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 216.12831486860912, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.14189532995224, "policy_loss": -0.010274503699474736, "vf_loss": 5.145307738085588, "vf_explained_var": 0.9495810414354007, "kl": 0.015450231450086024, "entropy": 0.9051207246879737, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -34.10994877584249, "episode_reward_min": -1362.251313368157, "episode_reward_mean": -530.3405247755492, "episode_len_mean": 122.41, "episode_media": {}, "episodes_timesteps_total": 12241, "policy_reward_min": {"policy_0": -1362.251313368157}, "policy_reward_max": {"policy_0": -34.10994877584249}, "policy_reward_mean": {"policy_0": -530.3405247755492}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.1581373958754, -800.8193769398763, -235.1919880251609, -34.10994877584249, -70.37085734254816, -1265.7000291983875, -1119.6029249281123, -503.0433544484108, -155.02563190419045, -391.7300467668233, -227.26258601516898, -57.74370632179056, -801.5953936523371, -409.04060669775714, -706.6782558771729, -108.98324123857611, -285.66732262499545, -647.6501899537712, -144.79602889201578, -776.2963498123545, -54.58525090510171, -398.8971577874109, -839.3246949774675, -227.42744337693702, -700.9747264903, -1112.4701641548397, -125.39780854360305, -1049.9835963246014, -538.4011789274184, -1035.9331472987767, -394.03348169378944, -572.8785657713814, -677.0513170284981, -736.407163185534, -637.4247382090648, -273.2937190488948, -665.7883353496472, -630.6055143805955, -425.1713423442571, -239.68751099383763, -91.80575906068616, -147.29224724800542, -124.85208735020949, -651.1779726234241, -425.0991038926399, -1044.3396267781031, -618.5725561577069, -721.0778600166045, -1362.251313368157, -550.1403341397288, -179.15114313436558, -176.90300555232432, -1115.7443080967746, -306.04389608097614, -771.4143024858987, -1272.569668327925, -254.60435486316038, -261.0328594507929, -53.62768976183692, -142.7657180481092, -234.1906352298585, -1155.6309557847992, -727.2846755257685, -404.2056637396875, -1353.2905970831664, -78.74119339223996, -1129.1316495611004, -255.98234195363906, -179.92270216697375, -256.1468032071412, -742.3414766964332, -953.1052499135773, -499.85574601179246, -1110.7709547346444, -863.0135845200197, -326.8784521112509, -678.7846170720723, -464.35397556458156, -249.69928611686936, -815.5984493747924, -367.02143325892115, -738.5033635212586, -397.95070277103173, -98.77119168185551, -299.93974002225997, -1229.826341752988, -611.0208292291492, -277.3535060837209, -798.1864102833207, -344.10383084645576, -67.43364547177795, -401.07204016090895, -53.29690101892932, -964.897042577853, -600.2087574126251, -417.37205607481485, -213.78746998449324, -647.6259014220349, -788.7799779809467, -561.3036861986116], "episode_lengths": [92, 150, 126, 56, 53, 150, 150, 115, 69, 114, 122, 56, 150, 128, 150, 82, 106, 122, 67, 150, 66, 124, 150, 81, 150, 150, 69, 150, 150, 150, 107, 150, 138, 150, 150, 96, 150, 150, 150, 150, 82, 71, 78, 150, 150, 150, 150, 145, 150, 150, 77, 98, 150, 150, 150, 150, 150, 99, 55, 57, 87, 150, 150, 150, 150, 67, 150, 98, 90, 77, 150, 150, 150, 150, 150, 109, 144, 150, 112, 150, 111, 150, 150, 80, 86, 150, 145, 98, 150, 107, 57, 150, 59, 150, 150, 128, 71, 150, 147, 117], "policy_policy_0_reward": [-329.1581373958754, -800.8193769398763, -235.1919880251609, -34.10994877584249, -70.37085734254816, -1265.7000291983875, -1119.6029249281123, -503.0433544484108, -155.02563190419045, -391.7300467668233, -227.26258601516898, -57.74370632179056, -801.5953936523371, -409.04060669775714, -706.6782558771729, -108.98324123857611, -285.66732262499545, -647.6501899537712, -144.79602889201578, -776.2963498123545, -54.58525090510171, -398.8971577874109, -839.3246949774675, -227.42744337693702, -700.9747264903, -1112.4701641548397, -125.39780854360305, -1049.9835963246014, -538.4011789274184, -1035.9331472987767, -394.03348169378944, -572.8785657713814, -677.0513170284981, -736.407163185534, -637.4247382090648, -273.2937190488948, -665.7883353496472, -630.6055143805955, -425.1713423442571, -239.68751099383763, -91.80575906068616, -147.29224724800542, -124.85208735020949, -651.1779726234241, -425.0991038926399, -1044.3396267781031, -618.5725561577069, -721.0778600166045, -1362.251313368157, -550.1403341397288, -179.15114313436558, -176.90300555232432, -1115.7443080967746, -306.04389608097614, -771.4143024858987, -1272.569668327925, -254.60435486316038, -261.0328594507929, -53.62768976183692, -142.7657180481092, -234.1906352298585, -1155.6309557847992, -727.2846755257685, -404.2056637396875, -1353.2905970831664, -78.74119339223996, -1129.1316495611004, -255.98234195363906, -179.92270216697375, -256.1468032071412, -742.3414766964332, -953.1052499135773, -499.85574601179246, -1110.7709547346444, -863.0135845200197, -326.8784521112509, -678.7846170720723, -464.35397556458156, -249.69928611686936, -815.5984493747924, -367.02143325892115, -738.5033635212586, -397.95070277103173, -98.77119168185551, -299.93974002225997, -1229.826341752988, -611.0208292291492, -277.3535060837209, -798.1864102833207, -344.10383084645576, -67.43364547177795, -401.07204016090895, -53.29690101892932, -964.897042577853, -600.2087574126251, -417.37205607481485, -213.78746998449324, -647.6259014220349, -788.7799779809467, -561.3036861986116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5508167225621876, "mean_inference_ms": 1.730044882694211, "mean_action_processing_ms": 0.27373762701248944, "mean_env_wait_ms": 3.413447985036916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012411832809448242, "StateBufferConnector_ms": 0.008056402206420898, "ViewRequirementAgentConnector_ms": 0.19521260261535645}, "num_episodes": 33, "episode_return_max": -34.10994877584249, "episode_return_min": -1362.251313368157, "episode_return_mean": -530.3405247755492, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.58225861537187, "num_env_steps_trained_throughput_per_sec": 310.58225861537187, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12764.507, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12764.431, "sample_time_ms": 1209.781, "learn_time_ms": 11492.627, "learn_throughput": 348.049, "synch_weights_time_ms": 61.239}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "1e132_00003", "date": "2024-08-04_08-01-29", "timestamp": 1722738689, "time_this_iter_s": 12.891331911087036, "time_total_s": 411.6955506801605, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1376d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 411.6955506801605, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.21666666666667, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.2749399205049, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.849708906312784, "policy_loss": -0.014557210631028283, "vf_loss": 4.855509267499049, "vf_explained_var": 0.9773978580410282, "kl": 0.01970110801891375, "entropy": 1.0866407557080189, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -53.29690101892932, "episode_reward_min": -1362.251313368157, "episode_reward_mean": -542.0507052546862, "episode_len_mean": 124.13, "episode_media": {}, "episodes_timesteps_total": 12413, "policy_reward_min": {"policy_0": -1362.251313368157}, "policy_reward_max": {"policy_0": -53.29690101892932}, "policy_reward_mean": {"policy_0": -542.0507052546862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-677.0513170284981, -736.407163185534, -637.4247382090648, -273.2937190488948, -665.7883353496472, -630.6055143805955, -425.1713423442571, -239.68751099383763, -91.80575906068616, -147.29224724800542, -124.85208735020949, -651.1779726234241, -425.0991038926399, -1044.3396267781031, -618.5725561577069, -721.0778600166045, -1362.251313368157, -550.1403341397288, -179.15114313436558, -176.90300555232432, -1115.7443080967746, -306.04389608097614, -771.4143024858987, -1272.569668327925, -254.60435486316038, -261.0328594507929, -53.62768976183692, -142.7657180481092, -234.1906352298585, -1155.6309557847992, -727.2846755257685, -404.2056637396875, -1353.2905970831664, -78.74119339223996, -1129.1316495611004, -255.98234195363906, -179.92270216697375, -256.1468032071412, -742.3414766964332, -953.1052499135773, -499.85574601179246, -1110.7709547346444, -863.0135845200197, -326.8784521112509, -678.7846170720723, -464.35397556458156, -249.69928611686936, -815.5984493747924, -367.02143325892115, -738.5033635212586, -397.95070277103173, -98.77119168185551, -299.93974002225997, -1229.826341752988, -611.0208292291492, -277.3535060837209, -798.1864102833207, -344.10383084645576, -67.43364547177795, -401.07204016090895, -53.29690101892932, -964.897042577853, -600.2087574126251, -417.37205607481485, -213.78746998449324, -647.6259014220349, -788.7799779809467, -561.3036861986116, -392.6411136662627, -58.619940572002484, -128.69378159511876, -116.91184780988297, -603.5593432953644, -604.3274951803759, -818.6165348501561, -533.0343525911513, -142.41703745829798, -759.0461096723864, -103.59516662580145, -692.2460857884871, -1092.416852183629, -63.04739656590807, -343.94628163502904, -149.8537298034381, -664.2772708588346, -373.7875123940988, -731.8640815723205, -698.7592835633666, -612.7825893720874, -473.6086298358522, -357.2075449410624, -1115.7555697876255, -878.1425421983439, -1277.528816940222, -873.8921641995036, -140.9381464985629, -1002.735194533569, -1142.2340462238158, -173.19500938083382, -172.10976938311597], "episode_lengths": [138, 150, 150, 96, 150, 150, 150, 150, 82, 71, 78, 150, 150, 150, 150, 145, 150, 150, 77, 98, 150, 150, 150, 150, 150, 99, 55, 57, 87, 150, 150, 150, 150, 67, 150, 98, 90, 77, 150, 150, 150, 150, 150, 109, 144, 150, 112, 150, 111, 150, 150, 80, 86, 150, 145, 98, 150, 107, 57, 150, 59, 150, 150, 128, 71, 150, 147, 117, 104, 66, 77, 72, 119, 150, 150, 124, 84, 150, 65, 135, 150, 62, 110, 82, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 75, 150, 150, 77, 80], "policy_policy_0_reward": [-677.0513170284981, -736.407163185534, -637.4247382090648, -273.2937190488948, -665.7883353496472, -630.6055143805955, -425.1713423442571, -239.68751099383763, -91.80575906068616, -147.29224724800542, -124.85208735020949, -651.1779726234241, -425.0991038926399, -1044.3396267781031, -618.5725561577069, -721.0778600166045, -1362.251313368157, -550.1403341397288, -179.15114313436558, -176.90300555232432, -1115.7443080967746, -306.04389608097614, -771.4143024858987, -1272.569668327925, -254.60435486316038, -261.0328594507929, -53.62768976183692, -142.7657180481092, -234.1906352298585, -1155.6309557847992, -727.2846755257685, -404.2056637396875, -1353.2905970831664, -78.74119339223996, -1129.1316495611004, -255.98234195363906, -179.92270216697375, -256.1468032071412, -742.3414766964332, -953.1052499135773, -499.85574601179246, -1110.7709547346444, -863.0135845200197, -326.8784521112509, -678.7846170720723, -464.35397556458156, -249.69928611686936, -815.5984493747924, -367.02143325892115, -738.5033635212586, -397.95070277103173, -98.77119168185551, -299.93974002225997, -1229.826341752988, -611.0208292291492, -277.3535060837209, -798.1864102833207, -344.10383084645576, -67.43364547177795, -401.07204016090895, -53.29690101892932, -964.897042577853, -600.2087574126251, -417.37205607481485, -213.78746998449324, -647.6259014220349, -788.7799779809467, -561.3036861986116, -392.6411136662627, -58.619940572002484, -128.69378159511876, -116.91184780988297, -603.5593432953644, -604.3274951803759, -818.6165348501561, -533.0343525911513, -142.41703745829798, -759.0461096723864, -103.59516662580145, -692.2460857884871, -1092.416852183629, -63.04739656590807, -343.94628163502904, -149.8537298034381, -664.2772708588346, -373.7875123940988, -731.8640815723205, -698.7592835633666, -612.7825893720874, -473.6086298358522, -357.2075449410624, -1115.7555697876255, -878.1425421983439, -1277.528816940222, -873.8921641995036, -140.9381464985629, -1002.735194533569, -1142.2340462238158, -173.19500938083382, -172.10976938311597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5508754668894081, "mean_inference_ms": 1.730809433828345, "mean_action_processing_ms": 0.2739325640686848, "mean_env_wait_ms": 3.416483025047222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01205587387084961, "StateBufferConnector_ms": 0.007960796356201172, "ViewRequirementAgentConnector_ms": 0.19432806968688965}, "num_episodes": 32, "episode_return_max": -53.29690101892932, "episode_return_min": -1362.251313368157, "episode_return_mean": -542.0507052546862, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.68418423025537, "num_env_steps_trained_throughput_per_sec": 308.68418423025537, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 13066.909, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13066.833, "sample_time_ms": 1201.248, "learn_time_ms": 11802.851, "learn_throughput": 338.901, "synch_weights_time_ms": 61.913}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "1e132_00003", "date": "2024-08-04_08-01-42", "timestamp": 1722738702, "time_this_iter_s": 12.970883131027222, "time_total_s": 424.66643381118774, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac137be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 424.66643381118774, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.53684210526316, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.20031938155492, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.853698420027892, "policy_loss": -0.01039663223491516, "vf_loss": 4.856209644178549, "vf_explained_var": 0.9766356912131111, "kl": 0.017717278989342382, "entropy": 0.8738222906365991, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -37.805406823865354, "episode_reward_min": -1353.2905970831664, "episode_reward_mean": -526.9835319291202, "episode_len_mean": 120.4, "episode_media": {}, "episodes_timesteps_total": 12040, "policy_reward_min": {"policy_0": -1353.2905970831664}, "policy_reward_max": {"policy_0": -37.805406823865354}, "policy_reward_mean": {"policy_0": -526.9835319291202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353.2905970831664, -78.74119339223996, -1129.1316495611004, -255.98234195363906, -179.92270216697375, -256.1468032071412, -742.3414766964332, -953.1052499135773, -499.85574601179246, -1110.7709547346444, -863.0135845200197, -326.8784521112509, -678.7846170720723, -464.35397556458156, -249.69928611686936, -815.5984493747924, -367.02143325892115, -738.5033635212586, -397.95070277103173, -98.77119168185551, -299.93974002225997, -1229.826341752988, -611.0208292291492, -277.3535060837209, -798.1864102833207, -344.10383084645576, -67.43364547177795, -401.07204016090895, -53.29690101892932, -964.897042577853, -600.2087574126251, -417.37205607481485, -213.78746998449324, -647.6259014220349, -788.7799779809467, -561.3036861986116, -392.6411136662627, -58.619940572002484, -128.69378159511876, -116.91184780988297, -603.5593432953644, -604.3274951803759, -818.6165348501561, -533.0343525911513, -142.41703745829798, -759.0461096723864, -103.59516662580145, -692.2460857884871, -1092.416852183629, -63.04739656590807, -343.94628163502904, -149.8537298034381, -664.2772708588346, -373.7875123940988, -731.8640815723205, -698.7592835633666, -612.7825893720874, -473.6086298358522, -357.2075449410624, -1115.7555697876255, -878.1425421983439, -1277.528816940222, -873.8921641995036, -140.9381464985629, -1002.735194533569, -1142.2340462238158, -173.19500938083382, -172.10976938311597, -461.0027750406361, -559.8396329551125, -905.5311345802385, -1207.349665522138, -40.17529997258892, -37.805406823865354, -716.7141075336938, -73.31226967035121, -320.7585932246636, -1171.006648894302, -851.7781822244367, -102.80419754326141, -308.0942593172621, -161.45265099258296, -511.4018221285739, -1234.7745113102276, -1013.8802821489872, -862.8795168443498, -946.4415599052061, -209.84111277691036, -149.11414221671356, -120.13122071157248, -38.49927011717593, -98.72742529997224, -608.0831156875096, -86.12255077433879, -95.25514374050911, -202.314653912585, -301.2357687657007, -1264.7614402631248, -586.0929768873959, -323.3087069152827], "episode_lengths": [150, 67, 150, 98, 90, 77, 150, 150, 150, 150, 150, 109, 144, 150, 112, 150, 111, 150, 150, 80, 86, 150, 145, 98, 150, 107, 57, 150, 59, 150, 150, 128, 71, 150, 147, 117, 104, 66, 77, 72, 119, 150, 150, 124, 84, 150, 65, 135, 150, 62, 110, 82, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 75, 150, 150, 77, 80, 143, 139, 150, 150, 65, 64, 127, 63, 133, 150, 150, 66, 131, 94, 150, 150, 150, 150, 150, 77, 97, 95, 48, 64, 150, 70, 69, 110, 150, 150, 150, 105], "policy_policy_0_reward": [-1353.2905970831664, -78.74119339223996, -1129.1316495611004, -255.98234195363906, -179.92270216697375, -256.1468032071412, -742.3414766964332, -953.1052499135773, -499.85574601179246, -1110.7709547346444, -863.0135845200197, -326.8784521112509, -678.7846170720723, -464.35397556458156, -249.69928611686936, -815.5984493747924, -367.02143325892115, -738.5033635212586, -397.95070277103173, -98.77119168185551, -299.93974002225997, -1229.826341752988, -611.0208292291492, -277.3535060837209, -798.1864102833207, -344.10383084645576, -67.43364547177795, -401.07204016090895, -53.29690101892932, -964.897042577853, -600.2087574126251, -417.37205607481485, -213.78746998449324, -647.6259014220349, -788.7799779809467, -561.3036861986116, -392.6411136662627, -58.619940572002484, -128.69378159511876, -116.91184780988297, -603.5593432953644, -604.3274951803759, -818.6165348501561, -533.0343525911513, -142.41703745829798, -759.0461096723864, -103.59516662580145, -692.2460857884871, -1092.416852183629, -63.04739656590807, -343.94628163502904, -149.8537298034381, -664.2772708588346, -373.7875123940988, -731.8640815723205, -698.7592835633666, -612.7825893720874, -473.6086298358522, -357.2075449410624, -1115.7555697876255, -878.1425421983439, -1277.528816940222, -873.8921641995036, -140.9381464985629, -1002.735194533569, -1142.2340462238158, -173.19500938083382, -172.10976938311597, -461.0027750406361, -559.8396329551125, -905.5311345802385, -1207.349665522138, -40.17529997258892, -37.805406823865354, -716.7141075336938, -73.31226967035121, -320.7585932246636, -1171.006648894302, -851.7781822244367, -102.80419754326141, -308.0942593172621, -161.45265099258296, -511.4018221285739, -1234.7745113102276, -1013.8802821489872, -862.8795168443498, -946.4415599052061, -209.84111277691036, -149.11414221671356, -120.13122071157248, -38.49927011717593, -98.72742529997224, -608.0831156875096, -86.12255077433879, -95.25514374050911, -202.314653912585, -301.2357687657007, -1264.7614402631248, -586.0929768873959, -323.3087069152827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5514658015120457, "mean_inference_ms": 1.7296096342205904, "mean_action_processing_ms": 0.2739053540066816, "mean_env_wait_ms": 3.4156141795888253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011834144592285156, "StateBufferConnector_ms": 0.007942676544189453, "ViewRequirementAgentConnector_ms": 0.19615674018859863}, "num_episodes": 32, "episode_return_max": -37.805406823865354, "episode_return_min": -1353.2905970831664, "episode_return_mean": -526.9835319291202, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.5004412282223, "num_env_steps_trained_throughput_per_sec": 305.5004412282223, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 13066.584, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13066.508, "sample_time_ms": 1199.567, "learn_time_ms": 11804.804, "learn_throughput": 338.845, "synch_weights_time_ms": 61.319}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "1e132_00003", "date": "2024-08-04_08-01-55", "timestamp": 1722738715, "time_this_iter_s": 13.106212377548218, "time_total_s": 437.77264618873596, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d8544bfd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 437.77264618873596, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.85, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 299.78934629360833, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.572741440931956, "policy_loss": -0.004399034561841594, "vf_loss": 4.5708837533990545, "vf_explained_var": 0.9447418709595998, "kl": 0.014175286740161669, "entropy": 1.2214543925598265, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -37.805406823865354, "episode_reward_min": -1297.1901164815538, "episode_reward_mean": -549.8850750435626, "episode_len_mean": 123.19, "episode_media": {}, "episodes_timesteps_total": 12319, "policy_reward_min": {"policy_0": -1297.1901164815538}, "policy_reward_max": {"policy_0": -37.805406823865354}, "policy_reward_mean": {"policy_0": -549.8850750435626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-417.37205607481485, -213.78746998449324, -647.6259014220349, -788.7799779809467, -561.3036861986116, -392.6411136662627, -58.619940572002484, -128.69378159511876, -116.91184780988297, -603.5593432953644, -604.3274951803759, -818.6165348501561, -533.0343525911513, -142.41703745829798, -759.0461096723864, -103.59516662580145, -692.2460857884871, -1092.416852183629, -63.04739656590807, -343.94628163502904, -149.8537298034381, -664.2772708588346, -373.7875123940988, -731.8640815723205, -698.7592835633666, -612.7825893720874, -473.6086298358522, -357.2075449410624, -1115.7555697876255, -878.1425421983439, -1277.528816940222, -873.8921641995036, -140.9381464985629, -1002.735194533569, -1142.2340462238158, -173.19500938083382, -172.10976938311597, -461.0027750406361, -559.8396329551125, -905.5311345802385, -1207.349665522138, -40.17529997258892, -37.805406823865354, -716.7141075336938, -73.31226967035121, -320.7585932246636, -1171.006648894302, -851.7781822244367, -102.80419754326141, -308.0942593172621, -161.45265099258296, -511.4018221285739, -1234.7745113102276, -1013.8802821489872, -862.8795168443498, -946.4415599052061, -209.84111277691036, -149.11414221671356, -120.13122071157248, -38.49927011717593, -98.72742529997224, -608.0831156875096, -86.12255077433879, -95.25514374050911, -202.314653912585, -301.2357687657007, -1264.7614402631248, -586.0929768873959, -323.3087069152827, -1077.5075239595785, -131.8653814143055, -575.6503690946593, -84.66643674874113, -542.9539450311934, -156.17730901008156, -824.8917143651273, -608.5885162791984, -465.5523324897741, -689.6806584566319, -750.3761135114252, -613.5850499541649, -962.0491027001553, -440.4197460959645, -1250.5325868461732, -518.0223855588738, -47.72171095911059, -278.12623766363265, -1297.1901164815538, -577.0434703021199, -438.6542771002712, -1103.9007040495549, -226.4637974542388, -452.24746853279987, -975.7018624729579, -492.92756817719066, -741.7287941982886, -825.8911318725675, -491.7805885363545, -768.7329061578114, -1086.7273215430755], "episode_lengths": [128, 71, 150, 147, 117, 104, 66, 77, 72, 119, 150, 150, 124, 84, 150, 65, 135, 150, 62, 110, 82, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 75, 150, 150, 77, 80, 143, 139, 150, 150, 65, 64, 127, 63, 133, 150, 150, 66, 131, 94, 150, 150, 150, 150, 150, 77, 97, 95, 48, 64, 150, 70, 69, 110, 150, 150, 150, 105, 150, 87, 115, 84, 146, 79, 150, 131, 150, 131, 150, 150, 150, 121, 150, 150, 59, 104, 150, 150, 119, 150, 114, 129, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-417.37205607481485, -213.78746998449324, -647.6259014220349, -788.7799779809467, -561.3036861986116, -392.6411136662627, -58.619940572002484, -128.69378159511876, -116.91184780988297, -603.5593432953644, -604.3274951803759, -818.6165348501561, -533.0343525911513, -142.41703745829798, -759.0461096723864, -103.59516662580145, -692.2460857884871, -1092.416852183629, -63.04739656590807, -343.94628163502904, -149.8537298034381, -664.2772708588346, -373.7875123940988, -731.8640815723205, -698.7592835633666, -612.7825893720874, -473.6086298358522, -357.2075449410624, -1115.7555697876255, -878.1425421983439, -1277.528816940222, -873.8921641995036, -140.9381464985629, -1002.735194533569, -1142.2340462238158, -173.19500938083382, -172.10976938311597, -461.0027750406361, -559.8396329551125, -905.5311345802385, -1207.349665522138, -40.17529997258892, -37.805406823865354, -716.7141075336938, -73.31226967035121, -320.7585932246636, -1171.006648894302, -851.7781822244367, -102.80419754326141, -308.0942593172621, -161.45265099258296, -511.4018221285739, -1234.7745113102276, -1013.8802821489872, -862.8795168443498, -946.4415599052061, -209.84111277691036, -149.11414221671356, -120.13122071157248, -38.49927011717593, -98.72742529997224, -608.0831156875096, -86.12255077433879, -95.25514374050911, -202.314653912585, -301.2357687657007, -1264.7614402631248, -586.0929768873959, -323.3087069152827, -1077.5075239595785, -131.8653814143055, -575.6503690946593, -84.66643674874113, -542.9539450311934, -156.17730901008156, -824.8917143651273, -608.5885162791984, -465.5523324897741, -689.6806584566319, -750.3761135114252, -613.5850499541649, -962.0491027001553, -440.4197460959645, -1250.5325868461732, -518.0223855588738, -47.72171095911059, -278.12623766363265, -1297.1901164815538, -577.0434703021199, -438.6542771002712, -1103.9007040495549, -226.4637974542388, -452.24746853279987, -975.7018624729579, -492.92756817719066, -741.7287941982886, -825.8911318725675, -491.7805885363545, -768.7329061578114, -1086.7273215430755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517237978383391, "mean_inference_ms": 1.7291108463175424, "mean_action_processing_ms": 0.2739123149770045, "mean_env_wait_ms": 3.416600741094832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011843442916870117, "StateBufferConnector_ms": 0.007859468460083008, "ViewRequirementAgentConnector_ms": 0.1998274326324463}, "num_episodes": 31, "episode_return_max": -37.805406823865354, "episode_return_min": -1297.1901164815538, "episode_return_mean": -549.8850750435626, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.64571772403184, "num_env_steps_trained_throughput_per_sec": 330.64571772403184, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12978.406, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12978.333, "sample_time_ms": 1209.234, "learn_time_ms": 11706.697, "learn_throughput": 341.685, "synch_weights_time_ms": 61.583}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "1e132_00003", "date": "2024-08-04_08-02-08", "timestamp": 1722738728, "time_this_iter_s": 12.11089539527893, "time_total_s": 449.8835415840149, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540729e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 449.8835415840149, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.97777777777778, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.21382894714674, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.436936656137307, "policy_loss": -0.007151713199467243, "vf_loss": 4.437043496221304, "vf_explained_var": 0.9791635400926073, "kl": 0.015916284585296127, "entropy": 1.1745591055601836, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -31.63164187919253, "episode_reward_min": -1394.8391521417507, "episode_reward_mean": -558.3423448984171, "episode_len_mean": 121.41, "episode_media": {}, "episodes_timesteps_total": 12141, "policy_reward_min": {"policy_0": -1394.8391521417507}, "policy_reward_max": {"policy_0": -31.63164187919253}, "policy_reward_mean": {"policy_0": -558.3423448984171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.19500938083382, -172.10976938311597, -461.0027750406361, -559.8396329551125, -905.5311345802385, -1207.349665522138, -40.17529997258892, -37.805406823865354, -716.7141075336938, -73.31226967035121, -320.7585932246636, -1171.006648894302, -851.7781822244367, -102.80419754326141, -308.0942593172621, -161.45265099258296, -511.4018221285739, -1234.7745113102276, -1013.8802821489872, -862.8795168443498, -946.4415599052061, -209.84111277691036, -149.11414221671356, -120.13122071157248, -38.49927011717593, -98.72742529997224, -608.0831156875096, -86.12255077433879, -95.25514374050911, -202.314653912585, -301.2357687657007, -1264.7614402631248, -586.0929768873959, -323.3087069152827, -1077.5075239595785, -131.8653814143055, -575.6503690946593, -84.66643674874113, -542.9539450311934, -156.17730901008156, -824.8917143651273, -608.5885162791984, -465.5523324897741, -689.6806584566319, -750.3761135114252, -613.5850499541649, -962.0491027001553, -440.4197460959645, -1250.5325868461732, -518.0223855588738, -47.72171095911059, -278.12623766363265, -1297.1901164815538, -577.0434703021199, -438.6542771002712, -1103.9007040495549, -226.4637974542388, -452.24746853279987, -975.7018624729579, -492.92756817719066, -741.7287941982886, -825.8911318725675, -491.7805885363545, -768.7329061578114, -1086.7273215430755, -240.05764769176588, -172.12792333887876, -1394.8391521417507, -580.9811636929768, -205.04029434617317, -320.3426419076499, -736.1775409394045, -89.70092518233669, -142.50792795824265, -31.63164187919253, -1034.0077671981485, -120.4202517022714, -759.4760669630047, -99.08073516509445, -95.70141477307642, -1021.159139123688, -212.71084377314082, -1210.13250263417, -822.3788364684209, -1038.8479586754, -932.5253763324956, -981.6546809039992, -180.05586729729367, -48.13312367366338, -465.4981143059118, -309.769275729829, -889.8135309235738, -1221.823890838599, -1024.9871255461242, -700.5762497318818, -1089.9712782940994, -1119.8916861323573, -218.85616068108067, -710.3504832675047, -199.85332014571006], "episode_lengths": [77, 80, 143, 139, 150, 150, 65, 64, 127, 63, 133, 150, 150, 66, 131, 94, 150, 150, 150, 150, 150, 77, 97, 95, 48, 64, 150, 70, 69, 110, 150, 150, 150, 105, 150, 87, 115, 84, 146, 79, 150, 131, 150, 131, 150, 150, 150, 121, 150, 150, 59, 104, 150, 150, 119, 150, 114, 129, 150, 150, 150, 150, 150, 150, 150, 113, 104, 150, 135, 85, 95, 150, 79, 85, 46, 150, 59, 150, 84, 66, 150, 81, 150, 150, 150, 150, 150, 68, 51, 150, 135, 150, 150, 150, 150, 150, 150, 75, 129, 115], "policy_policy_0_reward": [-173.19500938083382, -172.10976938311597, -461.0027750406361, -559.8396329551125, -905.5311345802385, -1207.349665522138, -40.17529997258892, -37.805406823865354, -716.7141075336938, -73.31226967035121, -320.7585932246636, -1171.006648894302, -851.7781822244367, -102.80419754326141, -308.0942593172621, -161.45265099258296, -511.4018221285739, -1234.7745113102276, -1013.8802821489872, -862.8795168443498, -946.4415599052061, -209.84111277691036, -149.11414221671356, -120.13122071157248, -38.49927011717593, -98.72742529997224, -608.0831156875096, -86.12255077433879, -95.25514374050911, -202.314653912585, -301.2357687657007, -1264.7614402631248, -586.0929768873959, -323.3087069152827, -1077.5075239595785, -131.8653814143055, -575.6503690946593, -84.66643674874113, -542.9539450311934, -156.17730901008156, -824.8917143651273, -608.5885162791984, -465.5523324897741, -689.6806584566319, -750.3761135114252, -613.5850499541649, -962.0491027001553, -440.4197460959645, -1250.5325868461732, -518.0223855588738, -47.72171095911059, -278.12623766363265, -1297.1901164815538, -577.0434703021199, -438.6542771002712, -1103.9007040495549, -226.4637974542388, -452.24746853279987, -975.7018624729579, -492.92756817719066, -741.7287941982886, -825.8911318725675, -491.7805885363545, -768.7329061578114, -1086.7273215430755, -240.05764769176588, -172.12792333887876, -1394.8391521417507, -580.9811636929768, -205.04029434617317, -320.3426419076499, -736.1775409394045, -89.70092518233669, -142.50792795824265, -31.63164187919253, -1034.0077671981485, -120.4202517022714, -759.4760669630047, -99.08073516509445, -95.70141477307642, -1021.159139123688, -212.71084377314082, -1210.13250263417, -822.3788364684209, -1038.8479586754, -932.5253763324956, -981.6546809039992, -180.05586729729367, -48.13312367366338, -465.4981143059118, -309.769275729829, -889.8135309235738, -1221.823890838599, -1024.9871255461242, -700.5762497318818, -1089.9712782940994, -1119.8916861323573, -218.85616068108067, -710.3504832675047, -199.85332014571006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515573409836927, "mean_inference_ms": 1.7275251936203417, "mean_action_processing_ms": 0.27379755194009975, "mean_env_wait_ms": 3.4167049674382923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011822223663330078, "StateBufferConnector_ms": 0.008313179016113281, "ViewRequirementAgentConnector_ms": 0.2034597396850586}, "num_episodes": 35, "episode_return_max": -31.63164187919253, "episode_return_min": -1394.8391521417507, "episode_return_mean": -558.3423448984171, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.18746265852843, "num_env_steps_trained_throughput_per_sec": 316.18746265852843, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12958.06, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12957.988, "sample_time_ms": 1209.914, "learn_time_ms": 11686.001, "learn_throughput": 342.29, "synch_weights_time_ms": 61.263}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "1e132_00003", "date": "2024-08-04_08-02-20", "timestamp": 1722738740, "time_this_iter_s": 12.664297342300415, "time_total_s": 462.5478389263153, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540732e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 462.5478389263153, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.85, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 250.79402095476786, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.533362304915984, "policy_loss": -0.007367855268724573, "vf_loss": 4.533536196500063, "vf_explained_var": 0.9781090850631396, "kl": 0.016255487721537065, "entropy": 1.2102375645811358, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -25.47853148752129, "episode_reward_min": -1394.8391521417507, "episode_reward_mean": -600.0839607112702, "episode_len_mean": 125.51, "episode_media": {}, "episodes_timesteps_total": 12551, "policy_reward_min": {"policy_0": -1394.8391521417507}, "policy_reward_max": {"policy_0": -25.47853148752129}, "policy_reward_mean": {"policy_0": -600.0839607112702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1264.7614402631248, -586.0929768873959, -323.3087069152827, -1077.5075239595785, -131.8653814143055, -575.6503690946593, -84.66643674874113, -542.9539450311934, -156.17730901008156, -824.8917143651273, -608.5885162791984, -465.5523324897741, -689.6806584566319, -750.3761135114252, -613.5850499541649, -962.0491027001553, -440.4197460959645, -1250.5325868461732, -518.0223855588738, -47.72171095911059, -278.12623766363265, -1297.1901164815538, -577.0434703021199, -438.6542771002712, -1103.9007040495549, -226.4637974542388, -452.24746853279987, -975.7018624729579, -492.92756817719066, -741.7287941982886, -825.8911318725675, -491.7805885363545, -768.7329061578114, -1086.7273215430755, -240.05764769176588, -172.12792333887876, -1394.8391521417507, -580.9811636929768, -205.04029434617317, -320.3426419076499, -736.1775409394045, -89.70092518233669, -142.50792795824265, -31.63164187919253, -1034.0077671981485, -120.4202517022714, -759.4760669630047, -99.08073516509445, -95.70141477307642, -1021.159139123688, -212.71084377314082, -1210.13250263417, -822.3788364684209, -1038.8479586754, -932.5253763324956, -981.6546809039992, -180.05586729729367, -48.13312367366338, -465.4981143059118, -309.769275729829, -889.8135309235738, -1221.823890838599, -1024.9871255461242, -700.5762497318818, -1089.9712782940994, -1119.8916861323573, -218.85616068108067, -710.3504832675047, -199.85332014571006, -1093.987667797026, -608.3068055837412, -75.3058832585922, -814.4373107965544, -140.62635937812297, -202.68622586890112, -683.107844316151, -1133.0703968695477, -199.67364048575314, -223.84955119552018, -737.1747507487119, -556.1742891050224, -928.449088488878, -454.76177872459294, -983.7277951107944, -329.28727446122525, -752.5038494856407, -814.260900514633, -25.47853148752129, -167.07844312169212, -115.7053691445701, -1315.9768776796836, -418.86802729022907, -147.0835651457277, -739.0468666005963, -681.2009156500533, -879.2614724808884, -390.6446782871716, -1080.5320288195287, -1183.7138846553496, -39.811208132312686], "episode_lengths": [150, 150, 105, 150, 87, 115, 84, 146, 79, 150, 131, 150, 131, 150, 150, 150, 121, 150, 150, 59, 104, 150, 150, 119, 150, 114, 129, 150, 150, 150, 150, 150, 150, 150, 113, 104, 150, 135, 85, 95, 150, 79, 85, 46, 150, 59, 150, 84, 66, 150, 81, 150, 150, 150, 150, 150, 68, 51, 150, 135, 150, 150, 150, 150, 150, 150, 75, 129, 115, 150, 134, 61, 150, 74, 150, 150, 150, 84, 99, 150, 111, 150, 107, 150, 150, 150, 150, 53, 66, 106, 150, 150, 73, 150, 150, 150, 150, 150, 150, 54], "policy_policy_0_reward": [-1264.7614402631248, -586.0929768873959, -323.3087069152827, -1077.5075239595785, -131.8653814143055, -575.6503690946593, -84.66643674874113, -542.9539450311934, -156.17730901008156, -824.8917143651273, -608.5885162791984, -465.5523324897741, -689.6806584566319, -750.3761135114252, -613.5850499541649, -962.0491027001553, -440.4197460959645, -1250.5325868461732, -518.0223855588738, -47.72171095911059, -278.12623766363265, -1297.1901164815538, -577.0434703021199, -438.6542771002712, -1103.9007040495549, -226.4637974542388, -452.24746853279987, -975.7018624729579, -492.92756817719066, -741.7287941982886, -825.8911318725675, -491.7805885363545, -768.7329061578114, -1086.7273215430755, -240.05764769176588, -172.12792333887876, -1394.8391521417507, -580.9811636929768, -205.04029434617317, -320.3426419076499, -736.1775409394045, -89.70092518233669, -142.50792795824265, -31.63164187919253, -1034.0077671981485, -120.4202517022714, -759.4760669630047, -99.08073516509445, -95.70141477307642, -1021.159139123688, -212.71084377314082, -1210.13250263417, -822.3788364684209, -1038.8479586754, -932.5253763324956, -981.6546809039992, -180.05586729729367, -48.13312367366338, -465.4981143059118, -309.769275729829, -889.8135309235738, -1221.823890838599, -1024.9871255461242, -700.5762497318818, -1089.9712782940994, -1119.8916861323573, -218.85616068108067, -710.3504832675047, -199.85332014571006, -1093.987667797026, -608.3068055837412, -75.3058832585922, -814.4373107965544, -140.62635937812297, -202.68622586890112, -683.107844316151, -1133.0703968695477, -199.67364048575314, -223.84955119552018, -737.1747507487119, -556.1742891050224, -928.449088488878, -454.76177872459294, -983.7277951107944, -329.28727446122525, -752.5038494856407, -814.260900514633, -25.47853148752129, -167.07844312169212, -115.7053691445701, -1315.9768776796836, -418.86802729022907, -147.0835651457277, -739.0468666005963, -681.2009156500533, -879.2614724808884, -390.6446782871716, -1080.5320288195287, -1183.7138846553496, -39.811208132312686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5514847818995815, "mean_inference_ms": 1.7255312541443835, "mean_action_processing_ms": 0.27385083235680097, "mean_env_wait_ms": 3.417467284235514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011614799499511719, "StateBufferConnector_ms": 0.008423566818237305, "ViewRequirementAgentConnector_ms": 0.199798583984375}, "num_episodes": 31, "episode_return_max": -25.47853148752129, "episode_return_min": -1394.8391521417507, "episode_return_mean": -600.0839607112702, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.84591572794955, "num_env_steps_trained_throughput_per_sec": 343.84591572794955, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12806.478, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12806.405, "sample_time_ms": 1183.359, "learn_time_ms": 11558.981, "learn_throughput": 346.051, "synch_weights_time_ms": 63.218}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "1e132_00003", "date": "2024-08-04_08-02-32", "timestamp": 1722738752, "time_this_iter_s": 11.645235538482666, "time_total_s": 474.193074464798, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1ae950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.193074464798, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 18.74375, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 241.19457043806713, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.138024005293846, "policy_loss": -0.007046743627385391, "vf_loss": 4.137754825502634, "vf_explained_var": 0.9898491499945521, "kl": 0.016603116706088897, "entropy": 1.5548277597874403, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -11.139609859212426, "episode_reward_min": -1394.8391521417507, "episode_reward_mean": -572.1994300399554, "episode_len_mean": 119.84, "episode_media": {}, "episodes_timesteps_total": 11984, "policy_reward_min": {"policy_0": -1394.8391521417507}, "policy_reward_max": {"policy_0": -11.139609859212426}, "policy_reward_mean": {"policy_0": -572.1994300399554}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.12792333887876, -1394.8391521417507, -580.9811636929768, -205.04029434617317, -320.3426419076499, -736.1775409394045, -89.70092518233669, -142.50792795824265, -31.63164187919253, -1034.0077671981485, -120.4202517022714, -759.4760669630047, -99.08073516509445, -95.70141477307642, -1021.159139123688, -212.71084377314082, -1210.13250263417, -822.3788364684209, -1038.8479586754, -932.5253763324956, -981.6546809039992, -180.05586729729367, -48.13312367366338, -465.4981143059118, -309.769275729829, -889.8135309235738, -1221.823890838599, -1024.9871255461242, -700.5762497318818, -1089.9712782940994, -1119.8916861323573, -218.85616068108067, -710.3504832675047, -199.85332014571006, -1093.987667797026, -608.3068055837412, -75.3058832585922, -814.4373107965544, -140.62635937812297, -202.68622586890112, -683.107844316151, -1133.0703968695477, -199.67364048575314, -223.84955119552018, -737.1747507487119, -556.1742891050224, -928.449088488878, -454.76177872459294, -983.7277951107944, -329.28727446122525, -752.5038494856407, -814.260900514633, -25.47853148752129, -167.07844312169212, -115.7053691445701, -1315.9768776796836, -418.86802729022907, -147.0835651457277, -739.0468666005963, -681.2009156500533, -879.2614724808884, -390.6446782871716, -1080.5320288195287, -1183.7138846553496, -39.811208132312686, -575.013172755814, -1327.471559846547, -310.3968811303282, -294.90392875576373, -1005.3076935138093, -119.04865819759665, -922.544449772641, -211.7537984051455, -150.02402480190088, -375.4196117533224, -285.3470968673529, -299.5368868117013, -899.4772369320906, -75.78171110826679, -243.10491388452397, -26.120637742813248, -226.9445085039059, -845.8266585848895, -175.51246437393445, -1236.6768104333119, -11.139609859212426, -1047.5475247425131, -117.40553506946883, -411.3496639113319, -64.4587726220296, -1347.9542082320604, -101.06703816295301, -802.3620647819961, -1136.4199660418028, -985.1792387785837, -1209.2864745702905, -167.04574008459633, -1097.0414587703167, -416.7634399408589, -601.8913918999809], "episode_lengths": [104, 150, 135, 85, 95, 150, 79, 85, 46, 150, 59, 150, 84, 66, 150, 81, 150, 150, 150, 150, 150, 68, 51, 150, 135, 150, 150, 150, 150, 150, 150, 75, 129, 115, 150, 134, 61, 150, 74, 150, 150, 150, 84, 99, 150, 111, 150, 107, 150, 150, 150, 150, 53, 66, 106, 150, 150, 73, 150, 150, 150, 150, 150, 150, 54, 150, 150, 128, 88, 150, 69, 150, 99, 81, 106, 104, 92, 150, 90, 86, 51, 100, 150, 76, 150, 39, 150, 82, 150, 59, 150, 71, 150, 150, 150, 150, 99, 150, 150, 150], "policy_policy_0_reward": [-172.12792333887876, -1394.8391521417507, -580.9811636929768, -205.04029434617317, -320.3426419076499, -736.1775409394045, -89.70092518233669, -142.50792795824265, -31.63164187919253, -1034.0077671981485, -120.4202517022714, -759.4760669630047, -99.08073516509445, -95.70141477307642, -1021.159139123688, -212.71084377314082, -1210.13250263417, -822.3788364684209, -1038.8479586754, -932.5253763324956, -981.6546809039992, -180.05586729729367, -48.13312367366338, -465.4981143059118, -309.769275729829, -889.8135309235738, -1221.823890838599, -1024.9871255461242, -700.5762497318818, -1089.9712782940994, -1119.8916861323573, -218.85616068108067, -710.3504832675047, -199.85332014571006, -1093.987667797026, -608.3068055837412, -75.3058832585922, -814.4373107965544, -140.62635937812297, -202.68622586890112, -683.107844316151, -1133.0703968695477, -199.67364048575314, -223.84955119552018, -737.1747507487119, -556.1742891050224, -928.449088488878, -454.76177872459294, -983.7277951107944, -329.28727446122525, -752.5038494856407, -814.260900514633, -25.47853148752129, -167.07844312169212, -115.7053691445701, -1315.9768776796836, -418.86802729022907, -147.0835651457277, -739.0468666005963, -681.2009156500533, -879.2614724808884, -390.6446782871716, -1080.5320288195287, -1183.7138846553496, -39.811208132312686, -575.013172755814, -1327.471559846547, -310.3968811303282, -294.90392875576373, -1005.3076935138093, -119.04865819759665, -922.544449772641, -211.7537984051455, -150.02402480190088, -375.4196117533224, -285.3470968673529, -299.5368868117013, -899.4772369320906, -75.78171110826679, -243.10491388452397, -26.120637742813248, -226.9445085039059, -845.8266585848895, -175.51246437393445, -1236.6768104333119, -11.139609859212426, -1047.5475247425131, -117.40553506946883, -411.3496639113319, -64.4587726220296, -1347.9542082320604, -101.06703816295301, -802.3620647819961, -1136.4199660418028, -985.1792387785837, -1209.2864745702905, -167.04574008459633, -1097.0414587703167, -416.7634399408589, -601.8913918999809]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512507693821506, "mean_inference_ms": 1.7244538909271498, "mean_action_processing_ms": 0.27376103149626796, "mean_env_wait_ms": 3.4181634960303957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011573553085327148, "StateBufferConnector_ms": 0.00852823257446289, "ViewRequirementAgentConnector_ms": 0.20175814628601074}, "num_episodes": 35, "episode_return_max": -11.139609859212426, "episode_return_min": -1394.8391521417507, "episode_return_mean": -572.1994300399554, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.29153940538924, "num_env_steps_trained_throughput_per_sec": 301.29153940538924, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12808.435, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12808.361, "sample_time_ms": 1176.103, "learn_time_ms": 11567.482, "learn_throughput": 345.797, "synch_weights_time_ms": 63.92}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "1e132_00003", "date": "2024-08-04_08-02-45", "timestamp": 1722738765, "time_this_iter_s": 13.289037466049194, "time_total_s": 487.48211193084717, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a5870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 487.48211193084717, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.53684210526316, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 201.0526272892952, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.304891408359011, "policy_loss": -0.01295062660841116, "vf_loss": 4.311183018361529, "vf_explained_var": 0.9844362697253625, "kl": 0.01509893521269987, "entropy": 1.3550183712815245, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -3.0113729247781778, "episode_reward_min": -1347.9542082320604, "episode_reward_mean": -569.01677690361, "episode_len_mean": 119.34, "episode_media": {}, "episodes_timesteps_total": 11934, "policy_reward_min": {"policy_0": -1347.9542082320604}, "policy_reward_max": {"policy_0": -3.0113729247781778}, "policy_reward_mean": {"policy_0": -569.01677690361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.85332014571006, -1093.987667797026, -608.3068055837412, -75.3058832585922, -814.4373107965544, -140.62635937812297, -202.68622586890112, -683.107844316151, -1133.0703968695477, -199.67364048575314, -223.84955119552018, -737.1747507487119, -556.1742891050224, -928.449088488878, -454.76177872459294, -983.7277951107944, -329.28727446122525, -752.5038494856407, -814.260900514633, -25.47853148752129, -167.07844312169212, -115.7053691445701, -1315.9768776796836, -418.86802729022907, -147.0835651457277, -739.0468666005963, -681.2009156500533, -879.2614724808884, -390.6446782871716, -1080.5320288195287, -1183.7138846553496, -39.811208132312686, -575.013172755814, -1327.471559846547, -310.3968811303282, -294.90392875576373, -1005.3076935138093, -119.04865819759665, -922.544449772641, -211.7537984051455, -150.02402480190088, -375.4196117533224, -285.3470968673529, -299.5368868117013, -899.4772369320906, -75.78171110826679, -243.10491388452397, -26.120637742813248, -226.9445085039059, -845.8266585848895, -175.51246437393445, -1236.6768104333119, -11.139609859212426, -1047.5475247425131, -117.40553506946883, -411.3496639113319, -64.4587726220296, -1347.9542082320604, -101.06703816295301, -802.3620647819961, -1136.4199660418028, -985.1792387785837, -1209.2864745702905, -167.04574008459633, -1097.0414587703167, -416.7634399408589, -601.8913918999809, -916.5601228402749, -1034.2218744078461, -130.86246122701482, -355.68846976118425, -825.9424243834349, -120.52579101213695, -250.31146001554956, -1312.6792285732308, -3.0113729247781778, -1021.8881038000811, -326.0855587967279, -1007.6945320908413, -720.8469391868309, -1007.2790115061823, -195.0022391104412, -1034.9156666331796, -355.1965319854155, -129.39375959435398, -1313.7995834177295, -187.47809231246057, -58.66131185861519, -801.7588427373275, -1126.5727300848446, -137.62310301457592, -45.266852229250766, -453.3248698860296, -454.9217303807867, -884.2938493945002, -1074.9910107143749, -1034.4147437505926, -10.616421747237776, -1296.058868139049, -35.018700370023815], "episode_lengths": [115, 150, 134, 61, 150, 74, 150, 150, 150, 84, 99, 150, 111, 150, 107, 150, 150, 150, 150, 53, 66, 106, 150, 150, 73, 150, 150, 150, 150, 150, 150, 54, 150, 150, 128, 88, 150, 69, 150, 99, 81, 106, 104, 92, 150, 90, 86, 51, 100, 150, 76, 150, 39, 150, 82, 150, 59, 150, 71, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 88, 108, 150, 123, 80, 150, 37, 150, 150, 150, 150, 150, 81, 150, 150, 57, 150, 97, 68, 150, 150, 79, 58, 115, 107, 150, 150, 150, 33, 150, 46], "policy_policy_0_reward": [-199.85332014571006, -1093.987667797026, -608.3068055837412, -75.3058832585922, -814.4373107965544, -140.62635937812297, -202.68622586890112, -683.107844316151, -1133.0703968695477, -199.67364048575314, -223.84955119552018, -737.1747507487119, -556.1742891050224, -928.449088488878, -454.76177872459294, -983.7277951107944, -329.28727446122525, -752.5038494856407, -814.260900514633, -25.47853148752129, -167.07844312169212, -115.7053691445701, -1315.9768776796836, -418.86802729022907, -147.0835651457277, -739.0468666005963, -681.2009156500533, -879.2614724808884, -390.6446782871716, -1080.5320288195287, -1183.7138846553496, -39.811208132312686, -575.013172755814, -1327.471559846547, -310.3968811303282, -294.90392875576373, -1005.3076935138093, -119.04865819759665, -922.544449772641, -211.7537984051455, -150.02402480190088, -375.4196117533224, -285.3470968673529, -299.5368868117013, -899.4772369320906, -75.78171110826679, -243.10491388452397, -26.120637742813248, -226.9445085039059, -845.8266585848895, -175.51246437393445, -1236.6768104333119, -11.139609859212426, -1047.5475247425131, -117.40553506946883, -411.3496639113319, -64.4587726220296, -1347.9542082320604, -101.06703816295301, -802.3620647819961, -1136.4199660418028, -985.1792387785837, -1209.2864745702905, -167.04574008459633, -1097.0414587703167, -416.7634399408589, -601.8913918999809, -916.5601228402749, -1034.2218744078461, -130.86246122701482, -355.68846976118425, -825.9424243834349, -120.52579101213695, -250.31146001554956, -1312.6792285732308, -3.0113729247781778, -1021.8881038000811, -326.0855587967279, -1007.6945320908413, -720.8469391868309, -1007.2790115061823, -195.0022391104412, -1034.9156666331796, -355.1965319854155, -129.39375959435398, -1313.7995834177295, -187.47809231246057, -58.66131185861519, -801.7588427373275, -1126.5727300848446, -137.62310301457592, -45.266852229250766, -453.3248698860296, -454.9217303807867, -884.2938493945002, -1074.9910107143749, -1034.4147437505926, -10.616421747237776, -1296.058868139049, -35.018700370023815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5513394966804878, "mean_inference_ms": 1.720952792085976, "mean_action_processing_ms": 0.2735279541950628, "mean_env_wait_ms": 3.414134840182295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01146554946899414, "StateBufferConnector_ms": 0.008073568344116211, "ViewRequirementAgentConnector_ms": 0.19801855087280273}, "num_episodes": 33, "episode_return_max": -3.0113729247781778, "episode_return_min": -1347.9542082320604, "episode_return_mean": -569.01677690361, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.70118954135967, "num_env_steps_trained_throughput_per_sec": 308.70118954135967, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12787.653, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12787.577, "sample_time_ms": 1177.832, "learn_time_ms": 11545.89, "learn_throughput": 346.444, "synch_weights_time_ms": 62.998}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "1e132_00003", "date": "2024-08-04_08-02-58", "timestamp": 1722738778, "time_this_iter_s": 12.970455884933472, "time_total_s": 500.45256781578064, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354070ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 500.45256781578064, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.731578947368423, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 251.27111887931824, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.618198881298303, "policy_loss": -0.013028839425048015, "vf_loss": 4.623947078982989, "vf_explained_var": 0.9841657321279248, "kl": 0.01650460052026877, "entropy": 1.4643692163129647, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -3.0113729247781778, "episode_reward_min": -1458.3401879834792, "episode_reward_mean": -587.0430877817561, "episode_len_mean": 120.32, "episode_media": {}, "episodes_timesteps_total": 12032, "policy_reward_min": {"policy_0": -1458.3401879834792}, "policy_reward_max": {"policy_0": -3.0113729247781778}, "policy_reward_mean": {"policy_0": -587.0430877817561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.811208132312686, -575.013172755814, -1327.471559846547, -310.3968811303282, -294.90392875576373, -1005.3076935138093, -119.04865819759665, -922.544449772641, -211.7537984051455, -150.02402480190088, -375.4196117533224, -285.3470968673529, -299.5368868117013, -899.4772369320906, -75.78171110826679, -243.10491388452397, -26.120637742813248, -226.9445085039059, -845.8266585848895, -175.51246437393445, -1236.6768104333119, -11.139609859212426, -1047.5475247425131, -117.40553506946883, -411.3496639113319, -64.4587726220296, -1347.9542082320604, -101.06703816295301, -802.3620647819961, -1136.4199660418028, -985.1792387785837, -1209.2864745702905, -167.04574008459633, -1097.0414587703167, -416.7634399408589, -601.8913918999809, -916.5601228402749, -1034.2218744078461, -130.86246122701482, -355.68846976118425, -825.9424243834349, -120.52579101213695, -250.31146001554956, -1312.6792285732308, -3.0113729247781778, -1021.8881038000811, -326.0855587967279, -1007.6945320908413, -720.8469391868309, -1007.2790115061823, -195.0022391104412, -1034.9156666331796, -355.1965319854155, -129.39375959435398, -1313.7995834177295, -187.47809231246057, -58.66131185861519, -801.7588427373275, -1126.5727300848446, -137.62310301457592, -45.266852229250766, -453.3248698860296, -454.9217303807867, -884.2938493945002, -1074.9910107143749, -1034.4147437505926, -10.616421747237776, -1296.058868139049, -35.018700370023815, -375.78670899529044, -427.06694773945236, -944.7121852506693, -259.81932198844595, -75.09450785156398, -671.2066214880916, -124.25152548199301, -886.5835875790108, -1458.3401879834792, -1419.9394357699423, -597.8188020744399, -1150.0571188067074, -302.7098325136909, -688.4367891973588, -59.84387991115732, -151.01679433499575, -301.1559106463628, -225.31212106406443, -988.0125085542471, -1011.4098290447025, -893.7521085369377, -922.6273535766915, -927.274299439921, -766.7455763947503, -749.1966659003729, -205.99514447741475, -999.3795047197206, -231.8308146060559, -1189.494096204919, -498.679344158763, -374.9169562215109], "episode_lengths": [54, 150, 150, 128, 88, 150, 69, 150, 99, 81, 106, 104, 92, 150, 90, 86, 51, 100, 150, 76, 150, 39, 150, 82, 150, 59, 150, 71, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 88, 108, 150, 123, 80, 150, 37, 150, 150, 150, 150, 150, 81, 150, 150, 57, 150, 97, 68, 150, 150, 79, 58, 115, 107, 150, 150, 150, 33, 150, 46, 134, 112, 150, 150, 58, 150, 60, 150, 150, 150, 145, 150, 146, 150, 61, 85, 150, 142, 150, 150, 150, 150, 150, 150, 150, 108, 150, 69, 150, 121, 90], "policy_policy_0_reward": [-39.811208132312686, -575.013172755814, -1327.471559846547, -310.3968811303282, -294.90392875576373, -1005.3076935138093, -119.04865819759665, -922.544449772641, -211.7537984051455, -150.02402480190088, -375.4196117533224, -285.3470968673529, -299.5368868117013, -899.4772369320906, -75.78171110826679, -243.10491388452397, -26.120637742813248, -226.9445085039059, -845.8266585848895, -175.51246437393445, -1236.6768104333119, -11.139609859212426, -1047.5475247425131, -117.40553506946883, -411.3496639113319, -64.4587726220296, -1347.9542082320604, -101.06703816295301, -802.3620647819961, -1136.4199660418028, -985.1792387785837, -1209.2864745702905, -167.04574008459633, -1097.0414587703167, -416.7634399408589, -601.8913918999809, -916.5601228402749, -1034.2218744078461, -130.86246122701482, -355.68846976118425, -825.9424243834349, -120.52579101213695, -250.31146001554956, -1312.6792285732308, -3.0113729247781778, -1021.8881038000811, -326.0855587967279, -1007.6945320908413, -720.8469391868309, -1007.2790115061823, -195.0022391104412, -1034.9156666331796, -355.1965319854155, -129.39375959435398, -1313.7995834177295, -187.47809231246057, -58.66131185861519, -801.7588427373275, -1126.5727300848446, -137.62310301457592, -45.266852229250766, -453.3248698860296, -454.9217303807867, -884.2938493945002, -1074.9910107143749, -1034.4147437505926, -10.616421747237776, -1296.058868139049, -35.018700370023815, -375.78670899529044, -427.06694773945236, -944.7121852506693, -259.81932198844595, -75.09450785156398, -671.2066214880916, -124.25152548199301, -886.5835875790108, -1458.3401879834792, -1419.9394357699423, -597.8188020744399, -1150.0571188067074, -302.7098325136909, -688.4367891973588, -59.84387991115732, -151.01679433499575, -301.1559106463628, -225.31212106406443, -988.0125085542471, -1011.4098290447025, -893.7521085369377, -922.6273535766915, -927.274299439921, -766.7455763947503, -749.1966659003729, -205.99514447741475, -999.3795047197206, -231.8308146060559, -1189.494096204919, -498.679344158763, -374.9169562215109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5513790784250535, "mean_inference_ms": 1.7201834658026283, "mean_action_processing_ms": 0.27345783291907577, "mean_env_wait_ms": 3.416648890752121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011628389358520508, "StateBufferConnector_ms": 0.008011102676391602, "ViewRequirementAgentConnector_ms": 0.20623254776000977}, "num_episodes": 31, "episode_return_max": -3.0113729247781778, "episode_return_min": -1458.3401879834792, "episode_return_mean": -587.0430877817561, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6730717603678, "num_env_steps_trained_throughput_per_sec": 307.6730717603678, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12764.143, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12764.067, "sample_time_ms": 1141.951, "learn_time_ms": 11558.518, "learn_throughput": 346.065, "synch_weights_time_ms": 62.741}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "1e132_00003", "date": "2024-08-04_08-03-11", "timestamp": 1722738791, "time_this_iter_s": 13.013472080230713, "time_total_s": 513.4660398960114, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354070af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 513.4660398960114, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.972222222222218, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 288.45879231294, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.245849036673705, "policy_loss": -0.011927735962187096, "vf_loss": 4.250889455030362, "vf_explained_var": 0.9869454036156337, "kl": 0.01567984767273932, "entropy": 1.6862175170332194, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -3.0113729247781778, "episode_reward_min": -1458.3401879834792, "episode_reward_mean": -642.6622317985093, "episode_len_mean": 125.35, "episode_media": {}, "episodes_timesteps_total": 12535, "policy_reward_min": {"policy_0": -1458.3401879834792}, "policy_reward_max": {"policy_0": -3.0113729247781778}, "policy_reward_mean": {"policy_0": -642.6622317985093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-416.7634399408589, -601.8913918999809, -916.5601228402749, -1034.2218744078461, -130.86246122701482, -355.68846976118425, -825.9424243834349, -120.52579101213695, -250.31146001554956, -1312.6792285732308, -3.0113729247781778, -1021.8881038000811, -326.0855587967279, -1007.6945320908413, -720.8469391868309, -1007.2790115061823, -195.0022391104412, -1034.9156666331796, -355.1965319854155, -129.39375959435398, -1313.7995834177295, -187.47809231246057, -58.66131185861519, -801.7588427373275, -1126.5727300848446, -137.62310301457592, -45.266852229250766, -453.3248698860296, -454.9217303807867, -884.2938493945002, -1074.9910107143749, -1034.4147437505926, -10.616421747237776, -1296.058868139049, -35.018700370023815, -375.78670899529044, -427.06694773945236, -944.7121852506693, -259.81932198844595, -75.09450785156398, -671.2066214880916, -124.25152548199301, -886.5835875790108, -1458.3401879834792, -1419.9394357699423, -597.8188020744399, -1150.0571188067074, -302.7098325136909, -688.4367891973588, -59.84387991115732, -151.01679433499575, -301.1559106463628, -225.31212106406443, -988.0125085542471, -1011.4098290447025, -893.7521085369377, -922.6273535766915, -927.274299439921, -766.7455763947503, -749.1966659003729, -205.99514447741475, -999.3795047197206, -231.8308146060559, -1189.494096204919, -498.679344158763, -374.9169562215109, -143.9249368102482, -1269.945525901079, -880.7003943276035, -1071.630272146387, -1167.129645964562, -809.1826513522457, -790.5079366507535, -399.0381409108357, -1170.173923509566, -344.4612990110192, -692.9219660130677, -709.5056826682209, -64.14771994302284, -126.41796487183437, -956.9465609162138, -229.68640288618343, -898.0264638022466, -989.6116842627921, -387.42505721784954, -1174.10243733446, -980.1767340417688, -1156.613641201675, -94.54065063433889, -358.37258893624306, -83.14995382713607, -1180.9105033372887, -857.9945561349797, -218.95073984530706, -1186.1050213890808, -974.9412454003651, -1303.743622491464, -647.1019860699811, -245.72955912041652, -142.37814068021913], "episode_lengths": [150, 150, 150, 150, 88, 108, 150, 123, 80, 150, 37, 150, 150, 150, 150, 150, 81, 150, 150, 57, 150, 97, 68, 150, 150, 79, 58, 115, 107, 150, 150, 150, 33, 150, 46, 134, 112, 150, 150, 58, 150, 60, 150, 150, 150, 145, 150, 146, 150, 61, 85, 150, 142, 150, 150, 150, 150, 150, 150, 150, 108, 150, 69, 150, 121, 90, 83, 150, 150, 150, 150, 150, 150, 121, 150, 98, 150, 150, 66, 54, 150, 101, 150, 150, 88, 150, 150, 150, 64, 108, 69, 150, 150, 87, 150, 150, 150, 150, 143, 95], "policy_policy_0_reward": [-416.7634399408589, -601.8913918999809, -916.5601228402749, -1034.2218744078461, -130.86246122701482, -355.68846976118425, -825.9424243834349, -120.52579101213695, -250.31146001554956, -1312.6792285732308, -3.0113729247781778, -1021.8881038000811, -326.0855587967279, -1007.6945320908413, -720.8469391868309, -1007.2790115061823, -195.0022391104412, -1034.9156666331796, -355.1965319854155, -129.39375959435398, -1313.7995834177295, -187.47809231246057, -58.66131185861519, -801.7588427373275, -1126.5727300848446, -137.62310301457592, -45.266852229250766, -453.3248698860296, -454.9217303807867, -884.2938493945002, -1074.9910107143749, -1034.4147437505926, -10.616421747237776, -1296.058868139049, -35.018700370023815, -375.78670899529044, -427.06694773945236, -944.7121852506693, -259.81932198844595, -75.09450785156398, -671.2066214880916, -124.25152548199301, -886.5835875790108, -1458.3401879834792, -1419.9394357699423, -597.8188020744399, -1150.0571188067074, -302.7098325136909, -688.4367891973588, -59.84387991115732, -151.01679433499575, -301.1559106463628, -225.31212106406443, -988.0125085542471, -1011.4098290447025, -893.7521085369377, -922.6273535766915, -927.274299439921, -766.7455763947503, -749.1966659003729, -205.99514447741475, -999.3795047197206, -231.8308146060559, -1189.494096204919, -498.679344158763, -374.9169562215109, -143.9249368102482, -1269.945525901079, -880.7003943276035, -1071.630272146387, -1167.129645964562, -809.1826513522457, -790.5079366507535, -399.0381409108357, -1170.173923509566, -344.4612990110192, -692.9219660130677, -709.5056826682209, -64.14771994302284, -126.41796487183437, -956.9465609162138, -229.68640288618343, -898.0264638022466, -989.6116842627921, -387.42505721784954, -1174.10243733446, -980.1767340417688, -1156.613641201675, -94.54065063433889, -358.37258893624306, -83.14995382713607, -1180.9105033372887, -857.9945561349797, -218.95073984530706, -1186.1050213890808, -974.9412454003651, -1303.743622491464, -647.1019860699811, -245.72955912041652, -142.37814068021913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512314089710071, "mean_inference_ms": 1.7188813856454197, "mean_action_processing_ms": 0.27352875123291515, "mean_env_wait_ms": 3.4201203381139527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857748031616211, "StateBufferConnector_ms": 0.008037567138671875, "ViewRequirementAgentConnector_ms": 0.20142054557800293}, "num_episodes": 34, "episode_return_max": -3.0113729247781778, "episode_return_min": -1458.3401879834792, "episode_return_mean": -642.6622317985093, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.55330821652035, "num_env_steps_trained_throughput_per_sec": 302.55330821652035, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12776.736, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12776.661, "sample_time_ms": 1133.659, "learn_time_ms": 11579.285, "learn_throughput": 345.444, "synch_weights_time_ms": 62.861}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "1e132_00003", "date": "2024-08-04_08-03-25", "timestamp": 1722738805, "time_this_iter_s": 13.233127355575562, "time_total_s": 526.6991672515869, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a5870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 526.6991672515869, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.89473684210526, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 235.16922584176064, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.878822090476751, "policy_loss": -0.005123500349873212, "vf_loss": 4.8774969192842645, "vf_explained_var": 0.9764446600029866, "kl": 0.014665526258249932, "entropy": 1.5080044526606797, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -10.616421747237776, "episode_reward_min": -1519.544098914915, "episode_reward_mean": -663.9637501046383, "episode_len_mean": 125.06, "episode_media": {}, "episodes_timesteps_total": 12506, "policy_reward_min": {"policy_0": -1519.544098914915}, "policy_reward_max": {"policy_0": -10.616421747237776}, "policy_reward_mean": {"policy_0": -663.9637501046383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.616421747237776, -1296.058868139049, -35.018700370023815, -375.78670899529044, -427.06694773945236, -944.7121852506693, -259.81932198844595, -75.09450785156398, -671.2066214880916, -124.25152548199301, -886.5835875790108, -1458.3401879834792, -1419.9394357699423, -597.8188020744399, -1150.0571188067074, -302.7098325136909, -688.4367891973588, -59.84387991115732, -151.01679433499575, -301.1559106463628, -225.31212106406443, -988.0125085542471, -1011.4098290447025, -893.7521085369377, -922.6273535766915, -927.274299439921, -766.7455763947503, -749.1966659003729, -205.99514447741475, -999.3795047197206, -231.8308146060559, -1189.494096204919, -498.679344158763, -374.9169562215109, -143.9249368102482, -1269.945525901079, -880.7003943276035, -1071.630272146387, -1167.129645964562, -809.1826513522457, -790.5079366507535, -399.0381409108357, -1170.173923509566, -344.4612990110192, -692.9219660130677, -709.5056826682209, -64.14771994302284, -126.41796487183437, -956.9465609162138, -229.68640288618343, -898.0264638022466, -989.6116842627921, -387.42505721784954, -1174.10243733446, -980.1767340417688, -1156.613641201675, -94.54065063433889, -358.37258893624306, -83.14995382713607, -1180.9105033372887, -857.9945561349797, -218.95073984530706, -1186.1050213890808, -974.9412454003651, -1303.743622491464, -647.1019860699811, -245.72955912041652, -142.37814068021913, -506.553266401418, -831.9604113216775, -233.1414465016334, -41.21600651668278, -793.5384365066304, -702.8841334463154, -306.4615723960324, -563.8603631732389, -40.31325245064439, -1415.2419450455066, -484.83486248908076, -1398.6620153110011, -805.9846831358196, -70.27832805850842, -262.3799032948586, -1504.7727226938835, -587.1774680592209, -954.9218217142276, -1474.1375325697115, -295.01036178429797, -66.68593961790152, -1519.544098914915, -931.1839767053184, -913.5759855280471, -1480.9884542486757, -1120.3348641019968, -187.43107945083193, -884.0703968279435, -82.58797589023162, -32.908287117018624, -720.0822162652105, -257.29512254587087], "episode_lengths": [33, 150, 46, 134, 112, 150, 150, 58, 150, 60, 150, 150, 150, 145, 150, 146, 150, 61, 85, 150, 142, 150, 150, 150, 150, 150, 150, 150, 108, 150, 69, 150, 121, 90, 83, 150, 150, 150, 150, 150, 150, 121, 150, 98, 150, 150, 66, 54, 150, 101, 150, 150, 88, 150, 150, 150, 64, 108, 69, 150, 150, 87, 150, 150, 150, 150, 143, 95, 150, 150, 96, 46, 150, 150, 150, 124, 52, 150, 104, 150, 150, 69, 76, 150, 150, 150, 150, 119, 62, 150, 150, 150, 150, 150, 92, 150, 62, 47, 150, 120], "policy_policy_0_reward": [-10.616421747237776, -1296.058868139049, -35.018700370023815, -375.78670899529044, -427.06694773945236, -944.7121852506693, -259.81932198844595, -75.09450785156398, -671.2066214880916, -124.25152548199301, -886.5835875790108, -1458.3401879834792, -1419.9394357699423, -597.8188020744399, -1150.0571188067074, -302.7098325136909, -688.4367891973588, -59.84387991115732, -151.01679433499575, -301.1559106463628, -225.31212106406443, -988.0125085542471, -1011.4098290447025, -893.7521085369377, -922.6273535766915, -927.274299439921, -766.7455763947503, -749.1966659003729, -205.99514447741475, -999.3795047197206, -231.8308146060559, -1189.494096204919, -498.679344158763, -374.9169562215109, -143.9249368102482, -1269.945525901079, -880.7003943276035, -1071.630272146387, -1167.129645964562, -809.1826513522457, -790.5079366507535, -399.0381409108357, -1170.173923509566, -344.4612990110192, -692.9219660130677, -709.5056826682209, -64.14771994302284, -126.41796487183437, -956.9465609162138, -229.68640288618343, -898.0264638022466, -989.6116842627921, -387.42505721784954, -1174.10243733446, -980.1767340417688, -1156.613641201675, -94.54065063433889, -358.37258893624306, -83.14995382713607, -1180.9105033372887, -857.9945561349797, -218.95073984530706, -1186.1050213890808, -974.9412454003651, -1303.743622491464, -647.1019860699811, -245.72955912041652, -142.37814068021913, -506.553266401418, -831.9604113216775, -233.1414465016334, -41.21600651668278, -793.5384365066304, -702.8841334463154, -306.4615723960324, -563.8603631732389, -40.31325245064439, -1415.2419450455066, -484.83486248908076, -1398.6620153110011, -805.9846831358196, -70.27832805850842, -262.3799032948586, -1504.7727226938835, -587.1774680592209, -954.9218217142276, -1474.1375325697115, -295.01036178429797, -66.68593961790152, -1519.544098914915, -931.1839767053184, -913.5759855280471, -1480.9884542486757, -1120.3348641019968, -187.43107945083193, -884.0703968279435, -82.58797589023162, -32.908287117018624, -720.0822162652105, -257.29512254587087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511738397385717, "mean_inference_ms": 1.716979374784078, "mean_action_processing_ms": 0.2733746582017101, "mean_env_wait_ms": 3.4225701347919353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012019634246826172, "StateBufferConnector_ms": 0.008075714111328125, "ViewRequirementAgentConnector_ms": 0.20222830772399902}, "num_episodes": 32, "episode_return_max": -10.616421747237776, "episode_return_min": -1519.544098914915, "episode_return_mean": -663.9637501046383, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.8510125215178, "num_env_steps_trained_throughput_per_sec": 303.8510125215178, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12805.268, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12805.189, "sample_time_ms": 1123.175, "learn_time_ms": 11617.993, "learn_throughput": 344.294, "synch_weights_time_ms": 63.121}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "1e132_00003", "date": "2024-08-04_08-03-38", "timestamp": 1722738818, "time_this_iter_s": 13.17735242843628, "time_total_s": 539.8765196800232, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354073b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.8765196800232, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.573684210526316, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 247.3419894774755, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.090093134343624, "policy_loss": -0.01546492738610444, "vf_loss": 4.097972265879313, "vf_explained_var": 0.9804602148632209, "kl": 0.017206476325463883, "entropy": 1.5712699677795172, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -32.908287117018624, "episode_reward_min": -1519.544098914915, "episode_reward_mean": -668.9576016122542, "episode_len_mean": 124.12, "episode_media": {}, "episodes_timesteps_total": 12412, "policy_reward_min": {"policy_0": -1519.544098914915}, "policy_reward_max": {"policy_0": -32.908287117018624}, "policy_reward_mean": {"policy_0": -668.9576016122542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1189.494096204919, -498.679344158763, -374.9169562215109, -143.9249368102482, -1269.945525901079, -880.7003943276035, -1071.630272146387, -1167.129645964562, -809.1826513522457, -790.5079366507535, -399.0381409108357, -1170.173923509566, -344.4612990110192, -692.9219660130677, -709.5056826682209, -64.14771994302284, -126.41796487183437, -956.9465609162138, -229.68640288618343, -898.0264638022466, -989.6116842627921, -387.42505721784954, -1174.10243733446, -980.1767340417688, -1156.613641201675, -94.54065063433889, -358.37258893624306, -83.14995382713607, -1180.9105033372887, -857.9945561349797, -218.95073984530706, -1186.1050213890808, -974.9412454003651, -1303.743622491464, -647.1019860699811, -245.72955912041652, -142.37814068021913, -506.553266401418, -831.9604113216775, -233.1414465016334, -41.21600651668278, -793.5384365066304, -702.8841334463154, -306.4615723960324, -563.8603631732389, -40.31325245064439, -1415.2419450455066, -484.83486248908076, -1398.6620153110011, -805.9846831358196, -70.27832805850842, -262.3799032948586, -1504.7727226938835, -587.1774680592209, -954.9218217142276, -1474.1375325697115, -295.01036178429797, -66.68593961790152, -1519.544098914915, -931.1839767053184, -913.5759855280471, -1480.9884542486757, -1120.3348641019968, -187.43107945083193, -884.0703968279435, -82.58797589023162, -32.908287117018624, -720.0822162652105, -257.29512254587087, -819.020526246199, -1287.9425306231692, -738.7613992832518, -599.2320118763826, -1165.6014822698519, -984.8503568470934, -379.43593553619274, -1169.0826504267195, -119.19833864706939, -1229.3003284085637, -60.39681709508417, -142.53613253306196, -1391.683149215655, -253.23383976570392, -380.21156707104325, -212.93343459791342, -104.50387088784626, -952.0323775661174, -1126.3096915046342, -91.24285527742981, -1057.8360073501458, -606.5483294721346, -630.859562414722, -1288.5377690636535, -274.72860339522157, -150.43014572987263, -699.3343028775514, -367.2931531980114, -74.84861984435615, -147.66729250768748, -1150.8621434130735], "episode_lengths": [150, 121, 90, 83, 150, 150, 150, 150, 150, 150, 121, 150, 98, 150, 150, 66, 54, 150, 101, 150, 150, 88, 150, 150, 150, 64, 108, 69, 150, 150, 87, 150, 150, 150, 150, 143, 95, 150, 150, 96, 46, 150, 150, 150, 124, 52, 150, 104, 150, 150, 69, 76, 150, 150, 150, 150, 119, 62, 150, 150, 150, 150, 150, 92, 150, 62, 47, 150, 120, 135, 150, 150, 150, 150, 150, 150, 150, 103, 150, 63, 87, 150, 96, 113, 81, 66, 150, 150, 50, 150, 150, 150, 150, 116, 88, 150, 95, 71, 91, 150], "policy_policy_0_reward": [-1189.494096204919, -498.679344158763, -374.9169562215109, -143.9249368102482, -1269.945525901079, -880.7003943276035, -1071.630272146387, -1167.129645964562, -809.1826513522457, -790.5079366507535, -399.0381409108357, -1170.173923509566, -344.4612990110192, -692.9219660130677, -709.5056826682209, -64.14771994302284, -126.41796487183437, -956.9465609162138, -229.68640288618343, -898.0264638022466, -989.6116842627921, -387.42505721784954, -1174.10243733446, -980.1767340417688, -1156.613641201675, -94.54065063433889, -358.37258893624306, -83.14995382713607, -1180.9105033372887, -857.9945561349797, -218.95073984530706, -1186.1050213890808, -974.9412454003651, -1303.743622491464, -647.1019860699811, -245.72955912041652, -142.37814068021913, -506.553266401418, -831.9604113216775, -233.1414465016334, -41.21600651668278, -793.5384365066304, -702.8841334463154, -306.4615723960324, -563.8603631732389, -40.31325245064439, -1415.2419450455066, -484.83486248908076, -1398.6620153110011, -805.9846831358196, -70.27832805850842, -262.3799032948586, -1504.7727226938835, -587.1774680592209, -954.9218217142276, -1474.1375325697115, -295.01036178429797, -66.68593961790152, -1519.544098914915, -931.1839767053184, -913.5759855280471, -1480.9884542486757, -1120.3348641019968, -187.43107945083193, -884.0703968279435, -82.58797589023162, -32.908287117018624, -720.0822162652105, -257.29512254587087, -819.020526246199, -1287.9425306231692, -738.7613992832518, -599.2320118763826, -1165.6014822698519, -984.8503568470934, -379.43593553619274, -1169.0826504267195, -119.19833864706939, -1229.3003284085637, -60.39681709508417, -142.53613253306196, -1391.683149215655, -253.23383976570392, -380.21156707104325, -212.93343459791342, -104.50387088784626, -952.0323775661174, -1126.3096915046342, -91.24285527742981, -1057.8360073501458, -606.5483294721346, -630.859562414722, -1288.5377690636535, -274.72860339522157, -150.43014572987263, -699.3343028775514, -367.2931531980114, -74.84861984435615, -147.66729250768748, -1150.8621434130735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510533447518714, "mean_inference_ms": 1.7154192737375886, "mean_action_processing_ms": 0.27331834475151334, "mean_env_wait_ms": 3.4244223869544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012054681777954102, "StateBufferConnector_ms": 0.008016347885131836, "ViewRequirementAgentConnector_ms": 0.201737642288208}, "num_episodes": 31, "episode_return_max": -32.908287117018624, "episode_return_min": -1519.544098914915, "episode_return_mean": -668.9576016122542, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.44556320255464, "num_env_steps_trained_throughput_per_sec": 312.44556320255464, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12789.669, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12789.588, "sample_time_ms": 1124.355, "learn_time_ms": 11602.171, "learn_throughput": 344.763, "synch_weights_time_ms": 62.207}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "1e132_00003", "date": "2024-08-04_08-03-51", "timestamp": 1722738831, "time_this_iter_s": 12.815032243728638, "time_total_s": 552.6915519237518, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540716c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 552.6915519237518, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.92222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 272.4101767162482, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.422533912211657, "policy_loss": -0.007804804022210495, "vf_loss": 4.421754172195991, "vf_explained_var": 0.9817827536414067, "kl": 0.01938359460182255, "entropy": 1.3806877604996164, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -31.53667361575349, "episode_reward_min": -1519.544098914915, "episode_reward_mean": -605.6027727715343, "episode_len_mean": 121.35, "episode_media": {}, "episodes_timesteps_total": 12135, "policy_reward_min": {"policy_0": -1519.544098914915}, "policy_reward_max": {"policy_0": -31.53667361575349}, "policy_reward_mean": {"policy_0": -605.6027727715343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142.37814068021913, -506.553266401418, -831.9604113216775, -233.1414465016334, -41.21600651668278, -793.5384365066304, -702.8841334463154, -306.4615723960324, -563.8603631732389, -40.31325245064439, -1415.2419450455066, -484.83486248908076, -1398.6620153110011, -805.9846831358196, -70.27832805850842, -262.3799032948586, -1504.7727226938835, -587.1774680592209, -954.9218217142276, -1474.1375325697115, -295.01036178429797, -66.68593961790152, -1519.544098914915, -931.1839767053184, -913.5759855280471, -1480.9884542486757, -1120.3348641019968, -187.43107945083193, -884.0703968279435, -82.58797589023162, -32.908287117018624, -720.0822162652105, -257.29512254587087, -819.020526246199, -1287.9425306231692, -738.7613992832518, -599.2320118763826, -1165.6014822698519, -984.8503568470934, -379.43593553619274, -1169.0826504267195, -119.19833864706939, -1229.3003284085637, -60.39681709508417, -142.53613253306196, -1391.683149215655, -253.23383976570392, -380.21156707104325, -212.93343459791342, -104.50387088784626, -952.0323775661174, -1126.3096915046342, -91.24285527742981, -1057.8360073501458, -606.5483294721346, -630.859562414722, -1288.5377690636535, -274.72860339522157, -150.43014572987263, -699.3343028775514, -367.2931531980114, -74.84861984435615, -147.66729250768748, -1150.8621434130735, -696.4317791292377, -227.76131749982903, -251.39192694698107, -1155.927765257851, -1457.89387984172, -931.5336813118442, -52.0023055197044, -187.54698126512162, -206.83543704440112, -218.86838430830758, -515.5815660006332, -466.11286183137076, -1036.324531175493, -31.53667361575349, -896.3070943686271, -394.34257985685406, -694.2917310096745, -503.1525100264134, -185.83270017194374, -970.6008570711632, -1009.1716547311008, -206.18552164522325, -517.1431762336, -529.7096226045852, -902.4501833074252, -146.32134640083777, -65.31599026124175, -135.31962840666327, -196.24701093484035, -768.1872857086386, -229.89226879950706, -814.555670196886, -826.1618891064597, -997.1358991242566, -34.53957973921253, -832.8116909900407], "episode_lengths": [95, 150, 150, 96, 46, 150, 150, 150, 124, 52, 150, 104, 150, 150, 69, 76, 150, 150, 150, 150, 119, 62, 150, 150, 150, 150, 150, 92, 150, 62, 47, 150, 120, 135, 150, 150, 150, 150, 150, 150, 150, 103, 150, 63, 87, 150, 96, 113, 81, 66, 150, 150, 50, 150, 150, 150, 150, 116, 88, 150, 95, 71, 91, 150, 150, 104, 99, 150, 150, 150, 53, 92, 115, 105, 124, 150, 150, 48, 150, 118, 150, 103, 105, 150, 150, 109, 150, 150, 150, 86, 55, 76, 81, 150, 86, 150, 150, 150, 57, 150], "policy_policy_0_reward": [-142.37814068021913, -506.553266401418, -831.9604113216775, -233.1414465016334, -41.21600651668278, -793.5384365066304, -702.8841334463154, -306.4615723960324, -563.8603631732389, -40.31325245064439, -1415.2419450455066, -484.83486248908076, -1398.6620153110011, -805.9846831358196, -70.27832805850842, -262.3799032948586, -1504.7727226938835, -587.1774680592209, -954.9218217142276, -1474.1375325697115, -295.01036178429797, -66.68593961790152, -1519.544098914915, -931.1839767053184, -913.5759855280471, -1480.9884542486757, -1120.3348641019968, -187.43107945083193, -884.0703968279435, -82.58797589023162, -32.908287117018624, -720.0822162652105, -257.29512254587087, -819.020526246199, -1287.9425306231692, -738.7613992832518, -599.2320118763826, -1165.6014822698519, -984.8503568470934, -379.43593553619274, -1169.0826504267195, -119.19833864706939, -1229.3003284085637, -60.39681709508417, -142.53613253306196, -1391.683149215655, -253.23383976570392, -380.21156707104325, -212.93343459791342, -104.50387088784626, -952.0323775661174, -1126.3096915046342, -91.24285527742981, -1057.8360073501458, -606.5483294721346, -630.859562414722, -1288.5377690636535, -274.72860339522157, -150.43014572987263, -699.3343028775514, -367.2931531980114, -74.84861984435615, -147.66729250768748, -1150.8621434130735, -696.4317791292377, -227.76131749982903, -251.39192694698107, -1155.927765257851, -1457.89387984172, -931.5336813118442, -52.0023055197044, -187.54698126512162, -206.83543704440112, -218.86838430830758, -515.5815660006332, -466.11286183137076, -1036.324531175493, -31.53667361575349, -896.3070943686271, -394.34257985685406, -694.2917310096745, -503.1525100264134, -185.83270017194374, -970.6008570711632, -1009.1716547311008, -206.18552164522325, -517.1431762336, -529.7096226045852, -902.4501833074252, -146.32134640083777, -65.31599026124175, -135.31962840666327, -196.24701093484035, -768.1872857086386, -229.89226879950706, -814.555670196886, -826.1618891064597, -997.1358991242566, -34.53957973921253, -832.8116909900407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511115769837488, "mean_inference_ms": 1.7146563118783475, "mean_action_processing_ms": 0.2732142630267829, "mean_env_wait_ms": 3.427109765292154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011682987213134766, "StateBufferConnector_ms": 0.007901430130004883, "ViewRequirementAgentConnector_ms": 0.19207382202148438}, "num_episodes": 36, "episode_return_max": -31.53667361575349, "episode_return_min": -1519.544098914915, "episode_return_mean": -605.6027727715343, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.8147023996109, "num_env_steps_trained_throughput_per_sec": 303.8147023996109, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12796.934, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12796.852, "sample_time_ms": 1139.337, "learn_time_ms": 11594.605, "learn_throughput": 344.988, "synch_weights_time_ms": 62.049}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "1e132_00003", "date": "2024-08-04_08-04-04", "timestamp": 1722738844, "time_this_iter_s": 13.177371501922607, "time_total_s": 565.8689234256744, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354072a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 565.8689234256744, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.74736842105263, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 265.71674159963925, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.511757862816254, "policy_loss": -0.012448946273798356, "vf_loss": 4.5174237156907715, "vf_explained_var": 0.9864504822840293, "kl": 0.015437752104359485, "entropy": 1.639069059987863, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -31.53667361575349, "episode_reward_min": -1457.89387984172, "episode_reward_mean": -604.2544352631435, "episode_len_mean": 121.15, "episode_media": {}, "episodes_timesteps_total": 12115, "policy_reward_min": {"policy_0": -1457.89387984172}, "policy_reward_max": {"policy_0": -31.53667361575349}, "policy_reward_mean": {"policy_0": -604.2544352631435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.908287117018624, -720.0822162652105, -257.29512254587087, -819.020526246199, -1287.9425306231692, -738.7613992832518, -599.2320118763826, -1165.6014822698519, -984.8503568470934, -379.43593553619274, -1169.0826504267195, -119.19833864706939, -1229.3003284085637, -60.39681709508417, -142.53613253306196, -1391.683149215655, -253.23383976570392, -380.21156707104325, -212.93343459791342, -104.50387088784626, -952.0323775661174, -1126.3096915046342, -91.24285527742981, -1057.8360073501458, -606.5483294721346, -630.859562414722, -1288.5377690636535, -274.72860339522157, -150.43014572987263, -699.3343028775514, -367.2931531980114, -74.84861984435615, -147.66729250768748, -1150.8621434130735, -696.4317791292377, -227.76131749982903, -251.39192694698107, -1155.927765257851, -1457.89387984172, -931.5336813118442, -52.0023055197044, -187.54698126512162, -206.83543704440112, -218.86838430830758, -515.5815660006332, -466.11286183137076, -1036.324531175493, -31.53667361575349, -896.3070943686271, -394.34257985685406, -694.2917310096745, -503.1525100264134, -185.83270017194374, -970.6008570711632, -1009.1716547311008, -206.18552164522325, -517.1431762336, -529.7096226045852, -902.4501833074252, -146.32134640083777, -65.31599026124175, -135.31962840666327, -196.24701093484035, -768.1872857086386, -229.89226879950706, -814.555670196886, -826.1618891064597, -997.1358991242566, -34.53957973921253, -832.8116909900407, -942.0279294368501, -192.770793014957, -295.58575331052083, -62.235899613096976, -102.30403844818899, -963.0043672555527, -234.45129914989525, -822.8774489437014, -94.93039729863965, -60.29331669828446, -965.7210458304136, -1309.1013213957704, -772.2604913472356, -1036.9878473972035, -503.31091026966703, -1038.2314306290696, -215.56524141061098, -978.4182238404637, -136.25701528757634, -552.5760842732961, -114.24246837559178, -1241.9003193336516, -1364.7891401958334, -1244.1714850446886, -139.0978221495446, -800.595973273264, -782.1258997738352, -1293.0527672825256, -1303.9881745407042, -904.4027891767632], "episode_lengths": [47, 150, 120, 135, 150, 150, 150, 150, 150, 150, 150, 103, 150, 63, 87, 150, 96, 113, 81, 66, 150, 150, 50, 150, 150, 150, 150, 116, 88, 150, 95, 71, 91, 150, 150, 104, 99, 150, 150, 150, 53, 92, 115, 105, 124, 150, 150, 48, 150, 118, 150, 103, 105, 150, 150, 109, 150, 150, 150, 86, 55, 76, 81, 150, 86, 150, 150, 150, 57, 150, 150, 108, 78, 69, 70, 150, 66, 150, 77, 51, 150, 150, 150, 150, 139, 150, 83, 150, 98, 133, 83, 150, 150, 150, 72, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-32.908287117018624, -720.0822162652105, -257.29512254587087, -819.020526246199, -1287.9425306231692, -738.7613992832518, -599.2320118763826, -1165.6014822698519, -984.8503568470934, -379.43593553619274, -1169.0826504267195, -119.19833864706939, -1229.3003284085637, -60.39681709508417, -142.53613253306196, -1391.683149215655, -253.23383976570392, -380.21156707104325, -212.93343459791342, -104.50387088784626, -952.0323775661174, -1126.3096915046342, -91.24285527742981, -1057.8360073501458, -606.5483294721346, -630.859562414722, -1288.5377690636535, -274.72860339522157, -150.43014572987263, -699.3343028775514, -367.2931531980114, -74.84861984435615, -147.66729250768748, -1150.8621434130735, -696.4317791292377, -227.76131749982903, -251.39192694698107, -1155.927765257851, -1457.89387984172, -931.5336813118442, -52.0023055197044, -187.54698126512162, -206.83543704440112, -218.86838430830758, -515.5815660006332, -466.11286183137076, -1036.324531175493, -31.53667361575349, -896.3070943686271, -394.34257985685406, -694.2917310096745, -503.1525100264134, -185.83270017194374, -970.6008570711632, -1009.1716547311008, -206.18552164522325, -517.1431762336, -529.7096226045852, -902.4501833074252, -146.32134640083777, -65.31599026124175, -135.31962840666327, -196.24701093484035, -768.1872857086386, -229.89226879950706, -814.555670196886, -826.1618891064597, -997.1358991242566, -34.53957973921253, -832.8116909900407, -942.0279294368501, -192.770793014957, -295.58575331052083, -62.235899613096976, -102.30403844818899, -963.0043672555527, -234.45129914989525, -822.8774489437014, -94.93039729863965, -60.29331669828446, -965.7210458304136, -1309.1013213957704, -772.2604913472356, -1036.9878473972035, -503.31091026966703, -1038.2314306290696, -215.56524141061098, -978.4182238404637, -136.25701528757634, -552.5760842732961, -114.24246837559178, -1241.9003193336516, -1364.7891401958334, -1244.1714850446886, -139.0978221495446, -800.595973273264, -782.1258997738352, -1293.0527672825256, -1303.9881745407042, -904.4027891767632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509671381579211, "mean_inference_ms": 1.7139523438077662, "mean_action_processing_ms": 0.2732357487088725, "mean_env_wait_ms": 3.428440722063531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011972427368164062, "StateBufferConnector_ms": 0.007982969284057617, "ViewRequirementAgentConnector_ms": 0.19440555572509766}, "num_episodes": 30, "episode_return_max": -31.53667361575349, "episode_return_min": -1457.89387984172, "episode_return_mean": -604.2544352631435, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.100691148035, "num_env_steps_trained_throughput_per_sec": 368.100691148035, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12673.84, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12673.756, "sample_time_ms": 1131.947, "learn_time_ms": 11479.449, "learn_throughput": 348.449, "synch_weights_time_ms": 61.454}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "1e132_00003", "date": "2024-08-04_08-04-15", "timestamp": 1722738855, "time_this_iter_s": 10.877501487731934, "time_total_s": 576.7464249134064, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540731c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 576.7464249134064, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 19.600000000000005, "ram_util_percent": 28.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 276.0932846327623, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.576442847649257, "policy_loss": -0.012088552753508945, "vf_loss": 4.580862158536911, "vf_explained_var": 0.9760840368767579, "kl": 0.017422707554760615, "entropy": 1.7097499515861272, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -9.241023197915794, "episode_reward_min": -1483.8516548245348, "episode_reward_mean": -648.392275041229, "episode_len_mean": 125.57, "episode_media": {}, "episodes_timesteps_total": 12557, "policy_reward_min": {"policy_0": -1483.8516548245348}, "policy_reward_max": {"policy_0": -9.241023197915794}, "policy_reward_mean": {"policy_0": -648.392275041229}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1150.8621434130735, -696.4317791292377, -227.76131749982903, -251.39192694698107, -1155.927765257851, -1457.89387984172, -931.5336813118442, -52.0023055197044, -187.54698126512162, -206.83543704440112, -218.86838430830758, -515.5815660006332, -466.11286183137076, -1036.324531175493, -31.53667361575349, -896.3070943686271, -394.34257985685406, -694.2917310096745, -503.1525100264134, -185.83270017194374, -970.6008570711632, -1009.1716547311008, -206.18552164522325, -517.1431762336, -529.7096226045852, -902.4501833074252, -146.32134640083777, -65.31599026124175, -135.31962840666327, -196.24701093484035, -768.1872857086386, -229.89226879950706, -814.555670196886, -826.1618891064597, -997.1358991242566, -34.53957973921253, -832.8116909900407, -942.0279294368501, -192.770793014957, -295.58575331052083, -62.235899613096976, -102.30403844818899, -963.0043672555527, -234.45129914989525, -822.8774489437014, -94.93039729863965, -60.29331669828446, -965.7210458304136, -1309.1013213957704, -772.2604913472356, -1036.9878473972035, -503.31091026966703, -1038.2314306290696, -215.56524141061098, -978.4182238404637, -136.25701528757634, -552.5760842732961, -114.24246837559178, -1241.9003193336516, -1364.7891401958334, -1244.1714850446886, -139.0978221495446, -800.595973273264, -782.1258997738352, -1293.0527672825256, -1303.9881745407042, -904.4027891767632, -794.1886838706582, -866.8484662831727, -1200.6812616149925, -693.0978911902397, -1040.3480200734418, -222.1750435486478, -1164.4155872242993, -698.1146305442426, -574.6357032679554, -1224.7202880193379, -205.3630590433939, -616.7262754581571, -116.21881929868006, -1389.334500043921, -664.064687405834, -902.3637464280629, -330.0001551730652, -752.8902344318216, -803.5916803286226, -264.1943292489956, -1483.8516548245348, -9.241023197915794, -586.3966930568114, -600.4441227740783, -1318.9776503121886, -478.4724532934534, -1086.6935062375658, -948.6643630505599, -1046.67423559289, -475.8275293789859, -82.01915943117203, -605.2661620862638, -683.161069535034], "episode_lengths": [150, 150, 104, 99, 150, 150, 150, 53, 92, 115, 105, 124, 150, 150, 48, 150, 118, 150, 103, 105, 150, 150, 109, 150, 150, 150, 86, 55, 76, 81, 150, 86, 150, 150, 150, 57, 150, 150, 108, 78, 69, 70, 150, 66, 150, 77, 51, 150, 150, 150, 150, 139, 150, 83, 150, 98, 133, 83, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 107, 150, 150, 104, 150, 35, 150, 134, 150, 130, 150, 150, 150, 107, 69, 150, 127], "policy_policy_0_reward": [-1150.8621434130735, -696.4317791292377, -227.76131749982903, -251.39192694698107, -1155.927765257851, -1457.89387984172, -931.5336813118442, -52.0023055197044, -187.54698126512162, -206.83543704440112, -218.86838430830758, -515.5815660006332, -466.11286183137076, -1036.324531175493, -31.53667361575349, -896.3070943686271, -394.34257985685406, -694.2917310096745, -503.1525100264134, -185.83270017194374, -970.6008570711632, -1009.1716547311008, -206.18552164522325, -517.1431762336, -529.7096226045852, -902.4501833074252, -146.32134640083777, -65.31599026124175, -135.31962840666327, -196.24701093484035, -768.1872857086386, -229.89226879950706, -814.555670196886, -826.1618891064597, -997.1358991242566, -34.53957973921253, -832.8116909900407, -942.0279294368501, -192.770793014957, -295.58575331052083, -62.235899613096976, -102.30403844818899, -963.0043672555527, -234.45129914989525, -822.8774489437014, -94.93039729863965, -60.29331669828446, -965.7210458304136, -1309.1013213957704, -772.2604913472356, -1036.9878473972035, -503.31091026966703, -1038.2314306290696, -215.56524141061098, -978.4182238404637, -136.25701528757634, -552.5760842732961, -114.24246837559178, -1241.9003193336516, -1364.7891401958334, -1244.1714850446886, -139.0978221495446, -800.595973273264, -782.1258997738352, -1293.0527672825256, -1303.9881745407042, -904.4027891767632, -794.1886838706582, -866.8484662831727, -1200.6812616149925, -693.0978911902397, -1040.3480200734418, -222.1750435486478, -1164.4155872242993, -698.1146305442426, -574.6357032679554, -1224.7202880193379, -205.3630590433939, -616.7262754581571, -116.21881929868006, -1389.334500043921, -664.064687405834, -902.3637464280629, -330.0001551730652, -752.8902344318216, -803.5916803286226, -264.1943292489956, -1483.8516548245348, -9.241023197915794, -586.3966930568114, -600.4441227740783, -1318.9776503121886, -478.4724532934534, -1086.6935062375658, -948.6643630505599, -1046.67423559289, -475.8275293789859, -82.01915943117203, -605.2661620862638, -683.161069535034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509583563746898, "mean_inference_ms": 1.7130558942023197, "mean_action_processing_ms": 0.273248657703845, "mean_env_wait_ms": 3.4294299736645373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015928268432617188, "StateBufferConnector_ms": 0.007843255996704102, "ViewRequirementAgentConnector_ms": 0.19100284576416016}, "num_episodes": 33, "episode_return_max": -9.241023197915794, "episode_return_min": -1483.8516548245348, "episode_return_mean": -648.392275041229, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.9078678702158, "num_env_steps_trained_throughput_per_sec": 305.9078678702158, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12716.35, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12716.266, "sample_time_ms": 1134.614, "learn_time_ms": 11517.587, "learn_throughput": 347.295, "synch_weights_time_ms": 63.146}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "1e132_00003", "date": "2024-08-04_08-04-28", "timestamp": 1722738868, "time_this_iter_s": 13.090019702911377, "time_total_s": 589.8364446163177, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1af400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 589.8364446163177, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.568421052631578, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 237.27078335086506, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.537822035203377, "policy_loss": -0.014075857854428856, "vf_loss": 4.544302262862524, "vf_explained_var": 0.9769497898096839, "kl": 0.017258834787511054, "entropy": 1.7083005992074807, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -9.241023197915794, "episode_reward_min": -1488.9242596434553, "episode_reward_mean": -684.0787776977212, "episode_len_mean": 124.73, "episode_media": {}, "episodes_timesteps_total": 12473, "policy_reward_min": {"policy_0": -1488.9242596434553}, "policy_reward_max": {"policy_0": -9.241023197915794}, "policy_reward_mean": {"policy_0": -684.0787776977212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-814.555670196886, -826.1618891064597, -997.1358991242566, -34.53957973921253, -832.8116909900407, -942.0279294368501, -192.770793014957, -295.58575331052083, -62.235899613096976, -102.30403844818899, -963.0043672555527, -234.45129914989525, -822.8774489437014, -94.93039729863965, -60.29331669828446, -965.7210458304136, -1309.1013213957704, -772.2604913472356, -1036.9878473972035, -503.31091026966703, -1038.2314306290696, -215.56524141061098, -978.4182238404637, -136.25701528757634, -552.5760842732961, -114.24246837559178, -1241.9003193336516, -1364.7891401958334, -1244.1714850446886, -139.0978221495446, -800.595973273264, -782.1258997738352, -1293.0527672825256, -1303.9881745407042, -904.4027891767632, -794.1886838706582, -866.8484662831727, -1200.6812616149925, -693.0978911902397, -1040.3480200734418, -222.1750435486478, -1164.4155872242993, -698.1146305442426, -574.6357032679554, -1224.7202880193379, -205.3630590433939, -616.7262754581571, -116.21881929868006, -1389.334500043921, -664.064687405834, -902.3637464280629, -330.0001551730652, -752.8902344318216, -803.5916803286226, -264.1943292489956, -1483.8516548245348, -9.241023197915794, -586.3966930568114, -600.4441227740783, -1318.9776503121886, -478.4724532934534, -1086.6935062375658, -948.6643630505599, -1046.67423559289, -475.8275293789859, -82.01915943117203, -605.2661620862638, -683.161069535034, -756.6945755714062, -1185.263535147786, -839.8249739641128, -163.02777358019534, -140.86188998896833, -178.24882429585708, -38.52605160131814, -745.6930278678548, -99.13152736336224, -829.0469046801562, -476.0799800297634, -125.93976449972234, -601.948260511665, -1488.9242596434553, -1433.1316397971013, -983.7512493769788, -349.19021629743736, -375.0408040585117, -40.21737744597561, -566.2021109273824, -1235.9377681584363, -142.57157832089027, -1086.9922863051506, -198.1044403659613, -296.85206944527533, -713.0808647818459, -1482.6138191914788, -1172.885584126996, -692.2668599344395, -1449.9766404807335, -604.0596391082012, -13.646364480459217], "episode_lengths": [150, 150, 150, 57, 150, 150, 108, 78, 69, 70, 150, 66, 150, 77, 51, 150, 150, 150, 150, 139, 150, 83, 150, 98, 133, 83, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 107, 150, 150, 104, 150, 35, 150, 134, 150, 130, 150, 150, 150, 107, 69, 150, 127, 150, 150, 150, 73, 57, 87, 44, 150, 64, 150, 100, 88, 132, 150, 150, 150, 88, 96, 55, 150, 150, 53, 150, 95, 106, 149, 150, 150, 150, 150, 150, 38], "policy_policy_0_reward": [-814.555670196886, -826.1618891064597, -997.1358991242566, -34.53957973921253, -832.8116909900407, -942.0279294368501, -192.770793014957, -295.58575331052083, -62.235899613096976, -102.30403844818899, -963.0043672555527, -234.45129914989525, -822.8774489437014, -94.93039729863965, -60.29331669828446, -965.7210458304136, -1309.1013213957704, -772.2604913472356, -1036.9878473972035, -503.31091026966703, -1038.2314306290696, -215.56524141061098, -978.4182238404637, -136.25701528757634, -552.5760842732961, -114.24246837559178, -1241.9003193336516, -1364.7891401958334, -1244.1714850446886, -139.0978221495446, -800.595973273264, -782.1258997738352, -1293.0527672825256, -1303.9881745407042, -904.4027891767632, -794.1886838706582, -866.8484662831727, -1200.6812616149925, -693.0978911902397, -1040.3480200734418, -222.1750435486478, -1164.4155872242993, -698.1146305442426, -574.6357032679554, -1224.7202880193379, -205.3630590433939, -616.7262754581571, -116.21881929868006, -1389.334500043921, -664.064687405834, -902.3637464280629, -330.0001551730652, -752.8902344318216, -803.5916803286226, -264.1943292489956, -1483.8516548245348, -9.241023197915794, -586.3966930568114, -600.4441227740783, -1318.9776503121886, -478.4724532934534, -1086.6935062375658, -948.6643630505599, -1046.67423559289, -475.8275293789859, -82.01915943117203, -605.2661620862638, -683.161069535034, -756.6945755714062, -1185.263535147786, -839.8249739641128, -163.02777358019534, -140.86188998896833, -178.24882429585708, -38.52605160131814, -745.6930278678548, -99.13152736336224, -829.0469046801562, -476.0799800297634, -125.93976449972234, -601.948260511665, -1488.9242596434553, -1433.1316397971013, -983.7512493769788, -349.19021629743736, -375.0408040585117, -40.21737744597561, -566.2021109273824, -1235.9377681584363, -142.57157832089027, -1086.9922863051506, -198.1044403659613, -296.85206944527533, -713.0808647818459, -1482.6138191914788, -1172.885584126996, -692.2668599344395, -1449.9766404807335, -604.0596391082012, -13.646364480459217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511277336461663, "mean_inference_ms": 1.711846712098626, "mean_action_processing_ms": 0.2731860149332985, "mean_env_wait_ms": 3.4315657848590644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016001224517822266, "StateBufferConnector_ms": 0.007890462875366211, "ViewRequirementAgentConnector_ms": 0.1922743320465088}, "num_episodes": 32, "episode_return_max": -9.241023197915794, "episode_return_min": -1488.9242596434553, "episode_return_mean": -684.0787776977212, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.8939146575004, "num_env_steps_trained_throughput_per_sec": 303.8939146575004, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12869.287, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12869.202, "sample_time_ms": 1138.236, "learn_time_ms": 11668.062, "learn_throughput": 342.816, "synch_weights_time_ms": 62.019}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "1e132_00003", "date": "2024-08-04_08-04-41", "timestamp": 1722738881, "time_this_iter_s": 13.173219203948975, "time_total_s": 603.0096638202667, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1afd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 603.0096638202667, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.742105263157892, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 301.2980287472407, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.5634931852420175, "policy_loss": -0.007935271815222222, "vf_loss": 4.564188349743684, "vf_explained_var": 0.9858581756552061, "kl": 0.01649757925115414, "entropy": 1.8380929640183845, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -9.241023197915794, "episode_reward_min": -1490.0291201764346, "episode_reward_mean": -708.5445975229002, "episode_len_mean": 127.52, "episode_media": {}, "episodes_timesteps_total": 12752, "policy_reward_min": {"policy_0": -1490.0291201764346}, "policy_reward_max": {"policy_0": -9.241023197915794}, "policy_reward_mean": {"policy_0": -708.5445975229002}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800.595973273264, -782.1258997738352, -1293.0527672825256, -1303.9881745407042, -904.4027891767632, -794.1886838706582, -866.8484662831727, -1200.6812616149925, -693.0978911902397, -1040.3480200734418, -222.1750435486478, -1164.4155872242993, -698.1146305442426, -574.6357032679554, -1224.7202880193379, -205.3630590433939, -616.7262754581571, -116.21881929868006, -1389.334500043921, -664.064687405834, -902.3637464280629, -330.0001551730652, -752.8902344318216, -803.5916803286226, -264.1943292489956, -1483.8516548245348, -9.241023197915794, -586.3966930568114, -600.4441227740783, -1318.9776503121886, -478.4724532934534, -1086.6935062375658, -948.6643630505599, -1046.67423559289, -475.8275293789859, -82.01915943117203, -605.2661620862638, -683.161069535034, -756.6945755714062, -1185.263535147786, -839.8249739641128, -163.02777358019534, -140.86188998896833, -178.24882429585708, -38.52605160131814, -745.6930278678548, -99.13152736336224, -829.0469046801562, -476.0799800297634, -125.93976449972234, -601.948260511665, -1488.9242596434553, -1433.1316397971013, -983.7512493769788, -349.19021629743736, -375.0408040585117, -40.21737744597561, -566.2021109273824, -1235.9377681584363, -142.57157832089027, -1086.9922863051506, -198.1044403659613, -296.85206944527533, -713.0808647818459, -1482.6138191914788, -1172.885584126996, -692.2668599344395, -1449.9766404807335, -604.0596391082012, -13.646364480459217, -934.2283216427993, -909.466102266181, -1200.4474535871939, -164.4583054617137, -187.60737670176914, -303.6933729978329, -1000.6552026924874, -881.5528243587726, -295.0965340205548, -520.1267096641216, -1297.4910791304321, -347.1107904468812, -610.3807625405612, -1108.6703644629536, -183.17080000658814, -826.7762063267842, -320.6466076691761, -1490.0291201764346, -537.6021436531798, -1006.225716705387, -982.5701595246643, -1335.0985104587853, -816.6984566868755, -100.52226658918309, -858.7681980391081, -227.81965958324474, -37.417890310546085, -1387.9445951837145, -967.0341344445983, -495.58913629253453], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 107, 150, 150, 104, 150, 35, 150, 134, 150, 130, 150, 150, 150, 107, 69, 150, 127, 150, 150, 150, 73, 57, 87, 44, 150, 64, 150, 100, 88, 132, 150, 150, 150, 88, 96, 55, 150, 150, 53, 150, 95, 106, 149, 150, 150, 150, 150, 150, 38, 150, 150, 150, 79, 98, 120, 150, 150, 110, 150, 150, 89, 150, 150, 59, 150, 111, 150, 150, 150, 150, 150, 150, 73, 150, 71, 53, 150, 150, 150], "policy_policy_0_reward": [-800.595973273264, -782.1258997738352, -1293.0527672825256, -1303.9881745407042, -904.4027891767632, -794.1886838706582, -866.8484662831727, -1200.6812616149925, -693.0978911902397, -1040.3480200734418, -222.1750435486478, -1164.4155872242993, -698.1146305442426, -574.6357032679554, -1224.7202880193379, -205.3630590433939, -616.7262754581571, -116.21881929868006, -1389.334500043921, -664.064687405834, -902.3637464280629, -330.0001551730652, -752.8902344318216, -803.5916803286226, -264.1943292489956, -1483.8516548245348, -9.241023197915794, -586.3966930568114, -600.4441227740783, -1318.9776503121886, -478.4724532934534, -1086.6935062375658, -948.6643630505599, -1046.67423559289, -475.8275293789859, -82.01915943117203, -605.2661620862638, -683.161069535034, -756.6945755714062, -1185.263535147786, -839.8249739641128, -163.02777358019534, -140.86188998896833, -178.24882429585708, -38.52605160131814, -745.6930278678548, -99.13152736336224, -829.0469046801562, -476.0799800297634, -125.93976449972234, -601.948260511665, -1488.9242596434553, -1433.1316397971013, -983.7512493769788, -349.19021629743736, -375.0408040585117, -40.21737744597561, -566.2021109273824, -1235.9377681584363, -142.57157832089027, -1086.9922863051506, -198.1044403659613, -296.85206944527533, -713.0808647818459, -1482.6138191914788, -1172.885584126996, -692.2668599344395, -1449.9766404807335, -604.0596391082012, -13.646364480459217, -934.2283216427993, -909.466102266181, -1200.4474535871939, -164.4583054617137, -187.60737670176914, -303.6933729978329, -1000.6552026924874, -881.5528243587726, -295.0965340205548, -520.1267096641216, -1297.4910791304321, -347.1107904468812, -610.3807625405612, -1108.6703644629536, -183.17080000658814, -826.7762063267842, -320.6466076691761, -1490.0291201764346, -537.6021436531798, -1006.225716705387, -982.5701595246643, -1335.0985104587853, -816.6984566868755, -100.52226658918309, -858.7681980391081, -227.81965958324474, -37.417890310546085, -1387.9445951837145, -967.0341344445983, -495.58913629253453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511778831704877, "mean_inference_ms": 1.7121949933636251, "mean_action_processing_ms": 0.2733240502706251, "mean_env_wait_ms": 3.435333995320002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01587986946105957, "StateBufferConnector_ms": 0.00792074203491211, "ViewRequirementAgentConnector_ms": 0.19204068183898926}, "num_episodes": 30, "episode_return_max": -9.241023197915794, "episode_return_min": -1490.0291201764346, "episode_return_mean": -708.5445975229002, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.18860246803075, "num_env_steps_trained_throughput_per_sec": 299.18860246803075, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12878.619, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12878.534, "sample_time_ms": 1140.58, "learn_time_ms": 11674.469, "learn_throughput": 342.628, "synch_weights_time_ms": 62.61}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "1e132_00003", "date": "2024-08-04_08-04-55", "timestamp": 1722738895, "time_this_iter_s": 13.381208181381226, "time_total_s": 616.390872001648, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354072a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.390872001648, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.594736842105267, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 306.26526661713916, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.1245255373418335, "policy_loss": -0.010206341778393834, "vf_loss": 4.126627709964911, "vf_explained_var": 0.981846066750586, "kl": 0.01838202947474201, "entropy": 1.6773533072322606, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -13.646364480459217, "episode_reward_min": -1490.0291201764346, "episode_reward_mean": -656.1880882358545, "episode_len_mean": 123.91, "episode_media": {}, "episodes_timesteps_total": 12391, "policy_reward_min": {"policy_0": -1490.0291201764346}, "policy_reward_max": {"policy_0": -13.646364480459217}, "policy_reward_mean": {"policy_0": -656.1880882358545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-948.6643630505599, -1046.67423559289, -475.8275293789859, -82.01915943117203, -605.2661620862638, -683.161069535034, -756.6945755714062, -1185.263535147786, -839.8249739641128, -163.02777358019534, -140.86188998896833, -178.24882429585708, -38.52605160131814, -745.6930278678548, -99.13152736336224, -829.0469046801562, -476.0799800297634, -125.93976449972234, -601.948260511665, -1488.9242596434553, -1433.1316397971013, -983.7512493769788, -349.19021629743736, -375.0408040585117, -40.21737744597561, -566.2021109273824, -1235.9377681584363, -142.57157832089027, -1086.9922863051506, -198.1044403659613, -296.85206944527533, -713.0808647818459, -1482.6138191914788, -1172.885584126996, -692.2668599344395, -1449.9766404807335, -604.0596391082012, -13.646364480459217, -934.2283216427993, -909.466102266181, -1200.4474535871939, -164.4583054617137, -187.60737670176914, -303.6933729978329, -1000.6552026924874, -881.5528243587726, -295.0965340205548, -520.1267096641216, -1297.4910791304321, -347.1107904468812, -610.3807625405612, -1108.6703644629536, -183.17080000658814, -826.7762063267842, -320.6466076691761, -1490.0291201764346, -537.6021436531798, -1006.225716705387, -982.5701595246643, -1335.0985104587853, -816.6984566868755, -100.52226658918309, -858.7681980391081, -227.81965958324474, -37.417890310546085, -1387.9445951837145, -967.0341344445983, -495.58913629253453, -1073.5818647433946, -363.78600511949304, -1072.3165272925785, -827.5606982611937, -1068.9846332813688, -125.19702564054707, -1338.2014120660854, -856.1311877830103, -1333.6395187960377, -830.2901183744965, -974.886272050349, -206.27371080325216, -742.5219931839788, -151.2785480539649, -666.3908119769683, -212.31986580483866, -335.5240625025001, -115.44845150511219, -865.8001082018407, -1107.5394516719139, -591.3357772743404, -143.74420759867976, -130.35260183521265, -479.7832380342697, -253.17734603984317, -309.32621493746825, -269.59043448697753, -1073.7949276816473, -492.8051056746372, -657.0161831421891, -633.1006229516087, -634.8659147668214], "episode_lengths": [150, 150, 107, 69, 150, 127, 150, 150, 150, 73, 57, 87, 44, 150, 64, 150, 100, 88, 132, 150, 150, 150, 88, 96, 55, 150, 150, 53, 150, 95, 106, 149, 150, 150, 150, 150, 150, 38, 150, 150, 150, 79, 98, 120, 150, 150, 110, 150, 150, 89, 150, 150, 59, 150, 111, 150, 150, 150, 150, 150, 150, 73, 150, 71, 53, 150, 150, 150, 150, 109, 150, 150, 150, 68, 150, 150, 150, 150, 150, 66, 150, 81, 150, 112, 127, 78, 150, 150, 150, 65, 110, 136, 95, 78, 75, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-948.6643630505599, -1046.67423559289, -475.8275293789859, -82.01915943117203, -605.2661620862638, -683.161069535034, -756.6945755714062, -1185.263535147786, -839.8249739641128, -163.02777358019534, -140.86188998896833, -178.24882429585708, -38.52605160131814, -745.6930278678548, -99.13152736336224, -829.0469046801562, -476.0799800297634, -125.93976449972234, -601.948260511665, -1488.9242596434553, -1433.1316397971013, -983.7512493769788, -349.19021629743736, -375.0408040585117, -40.21737744597561, -566.2021109273824, -1235.9377681584363, -142.57157832089027, -1086.9922863051506, -198.1044403659613, -296.85206944527533, -713.0808647818459, -1482.6138191914788, -1172.885584126996, -692.2668599344395, -1449.9766404807335, -604.0596391082012, -13.646364480459217, -934.2283216427993, -909.466102266181, -1200.4474535871939, -164.4583054617137, -187.60737670176914, -303.6933729978329, -1000.6552026924874, -881.5528243587726, -295.0965340205548, -520.1267096641216, -1297.4910791304321, -347.1107904468812, -610.3807625405612, -1108.6703644629536, -183.17080000658814, -826.7762063267842, -320.6466076691761, -1490.0291201764346, -537.6021436531798, -1006.225716705387, -982.5701595246643, -1335.0985104587853, -816.6984566868755, -100.52226658918309, -858.7681980391081, -227.81965958324474, -37.417890310546085, -1387.9445951837145, -967.0341344445983, -495.58913629253453, -1073.5818647433946, -363.78600511949304, -1072.3165272925785, -827.5606982611937, -1068.9846332813688, -125.19702564054707, -1338.2014120660854, -856.1311877830103, -1333.6395187960377, -830.2901183744965, -974.886272050349, -206.27371080325216, -742.5219931839788, -151.2785480539649, -666.3908119769683, -212.31986580483866, -335.5240625025001, -115.44845150511219, -865.8001082018407, -1107.5394516719139, -591.3357772743404, -143.74420759867976, -130.35260183521265, -479.7832380342697, -253.17734603984317, -309.32621493746825, -269.59043448697753, -1073.7949276816473, -492.8051056746372, -657.0161831421891, -633.1006229516087, -634.8659147668214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511646380401459, "mean_inference_ms": 1.7107970157500691, "mean_action_processing_ms": 0.2731947063878165, "mean_env_wait_ms": 3.436745260035055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012173652648925781, "StateBufferConnector_ms": 0.00801706314086914, "ViewRequirementAgentConnector_ms": 0.19484949111938477}, "num_episodes": 32, "episode_return_max": -13.646364480459217, "episode_return_min": -1490.0291201764346, "episode_return_mean": -656.1880882358545, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.61482154171534, "num_env_steps_trained_throughput_per_sec": 304.61482154171534, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12896.001, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12895.919, "sample_time_ms": 1144.259, "learn_time_ms": 11687.306, "learn_throughput": 342.252, "synch_weights_time_ms": 63.48}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "training_iteration": 50, "trial_id": "1e132_00003", "date": "2024-08-04_08-05-08", "timestamp": 1722738908, "time_this_iter_s": 13.143907070159912, "time_total_s": 629.5347790718079, "pid": 607259, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.96, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac1376d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 629.5347790718079, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.683333333333334, "ram_util_percent": 28.3}}
