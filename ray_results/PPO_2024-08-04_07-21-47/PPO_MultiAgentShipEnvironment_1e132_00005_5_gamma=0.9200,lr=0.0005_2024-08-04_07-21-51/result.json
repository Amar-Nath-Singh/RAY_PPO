{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9254003977092604, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.641738626360894, "policy_loss": -0.006308395962211459, "vf_loss": 9.646788629889489, "vf_explained_var": 0.014442185312509537, "kl": 0.007014562068055359, "entropy": 1.445047976449132, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -62.42932905719129, "episode_reward_min": -1329.3793986954845, "episode_reward_mean": -706.892516408891, "episode_len_mean": 118.29166666666667, "episode_media": {}, "episodes_timesteps_total": 2839, "policy_reward_min": {"policy_0": -1329.3793986954845}, "policy_reward_max": {"policy_0": -62.42932905719129}, "policy_reward_mean": {"policy_0": -706.892516408891}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1071.743943735095, -1267.5912382084293, -1097.075332402709, -230.83013756295824, -136.6833033006681, -312.92137651033005, -245.56237973981894, -186.51552576774253, -1146.6067585404335, -1207.3501680289737, -1302.8831933224553, -840.0720693701983, -1239.674653913102, -1023.3488157121485, -122.41266824813289, -62.42932905719129, -338.87035135502435, -308.7365209934552, -1163.1265390085593, -984.7829024419622, -754.8637767773198, -152.25315140968223, -439.7068597115094, -1329.3793986954845], "episode_lengths": [150, 150, 150, 87, 62, 105, 89, 69, 150, 150, 150, 150, 150, 150, 54, 63, 114, 83, 150, 150, 150, 64, 99, 150], "policy_policy_0_reward": [-1071.743943735095, -1267.5912382084293, -1097.075332402709, -230.83013756295824, -136.6833033006681, -312.92137651033005, -245.56237973981894, -186.51552576774253, -1146.6067585404335, -1207.3501680289737, -1302.8831933224553, -840.0720693701983, -1239.674653913102, -1023.3488157121485, -122.41266824813289, -62.42932905719129, -338.87035135502435, -308.7365209934552, -1163.1265390085593, -984.7829024419622, -754.8637767773198, -152.25315140968223, -439.7068597115094, -1329.3793986954845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5743872489704743, "mean_inference_ms": 1.6688210865024928, "mean_action_processing_ms": 0.28342666721239596, "mean_env_wait_ms": 3.413032114212149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011644760767618815, "StateBufferConnector_ms": 0.008283058802286783, "ViewRequirementAgentConnector_ms": 0.18046398957570395}, "num_episodes": 24, "episode_return_max": -62.42932905719129, "episode_return_min": -1329.3793986954845, "episode_return_mean": -706.892516408891, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.6235706904797, "num_env_steps_trained_throughput_per_sec": 359.6235706904797, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11122.75, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11122.692, "sample_time_ms": 1129.616, "learn_time_ms": 9926.685, "learn_throughput": 402.954, "synch_weights_time_ms": 65.667}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1e132_00005", "date": "2024-08-04_08-16-28", "timestamp": 1722739588, "time_this_iter_s": 11.133907794952393, "time_total_s": 11.133907794952393, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3541343a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.133907794952393, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.50625, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.49339511419336, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 9.508910703659058, "policy_loss": -0.007107311675402646, "vf_loss": 9.514281936486562, "vf_explained_var": 0.07771722233543793, "kl": 0.009399404396966323, "entropy": 1.4381204172968864, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -8.128347144621138, "episode_reward_min": -1404.7029239565845, "episode_reward_mean": -784.9624430892005, "episode_len_mean": 124.22, "episode_media": {}, "episodes_timesteps_total": 6211, "policy_reward_min": {"policy_0": -1404.7029239565845}, "policy_reward_max": {"policy_0": -8.128347144621138}, "policy_reward_mean": {"policy_0": -784.9624430892005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1071.743943735095, -1267.5912382084293, -1097.075332402709, -230.83013756295824, -136.6833033006681, -312.92137651033005, -245.56237973981894, -186.51552576774253, -1146.6067585404335, -1207.3501680289737, -1302.8831933224553, -840.0720693701983, -1239.674653913102, -1023.3488157121485, -122.41266824813289, -62.42932905719129, -338.87035135502435, -308.7365209934552, -1163.1265390085593, -984.7829024419622, -754.8637767773198, -152.25315140968223, -439.7068597115094, -1329.3793986954845, -1167.206355217067, -1074.5189817073604, -651.5832309081152, -134.25894001711816, -1072.0232943997792, -1362.868413819867, -948.9901095000946, -1252.1192601459793, -909.9136473656299, -100.9940953007901, -970.8812146122574, -877.3997269398377, -1110.9537313856076, -123.34663322999808, -588.6984358161327, -8.128347144621138, -1081.1321548340761, -144.05945166331537, -1243.3921967410276, -1404.7029239565845, -884.4160994082991, -995.6689126379368, -784.9600817230306, -1179.3968315578213, -1261.0657455478897, -950.0229450664025], "episode_lengths": [150, 150, 150, 87, 62, 105, 89, 69, 150, 150, 150, 150, 150, 150, 54, 63, 114, 83, 150, 150, 150, 64, 99, 150, 150, 150, 126, 55, 150, 150, 150, 150, 150, 56, 150, 150, 150, 53, 113, 40, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1071.743943735095, -1267.5912382084293, -1097.075332402709, -230.83013756295824, -136.6833033006681, -312.92137651033005, -245.56237973981894, -186.51552576774253, -1146.6067585404335, -1207.3501680289737, -1302.8831933224553, -840.0720693701983, -1239.674653913102, -1023.3488157121485, -122.41266824813289, -62.42932905719129, -338.87035135502435, -308.7365209934552, -1163.1265390085593, -984.7829024419622, -754.8637767773198, -152.25315140968223, -439.7068597115094, -1329.3793986954845, -1167.206355217067, -1074.5189817073604, -651.5832309081152, -134.25894001711816, -1072.0232943997792, -1362.868413819867, -948.9901095000946, -1252.1192601459793, -909.9136473656299, -100.9940953007901, -970.8812146122574, -877.3997269398377, -1110.9537313856076, -123.34663322999808, -588.6984358161327, -8.128347144621138, -1081.1321548340761, -144.05945166331537, -1243.3921967410276, -1404.7029239565845, -884.4160994082991, -995.6689126379368, -784.9600817230306, -1179.3968315578213, -1261.0657455478897, -950.0229450664025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5708240207084938, "mean_inference_ms": 1.672562717699091, "mean_action_processing_ms": 0.2838376136993432, "mean_env_wait_ms": 3.426243513454418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013777732849121094, "StateBufferConnector_ms": 0.00838470458984375, "ViewRequirementAgentConnector_ms": 0.18436431884765625}, "num_episodes": 26, "episode_return_max": -8.128347144621138, "episode_return_min": -1404.7029239565845, "episode_return_mean": -784.9624430892005, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.9854217435229, "num_env_steps_trained_throughput_per_sec": 302.9854217435229, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12162.358, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12162.3, "sample_time_ms": 1130.072, "learn_time_ms": 10966.855, "learn_throughput": 364.735, "synch_weights_time_ms": 64.604}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1e132_00005", "date": "2024-08-04_08-16-42", "timestamp": 1722739602, "time_this_iter_s": 13.215311527252197, "time_total_s": 24.34921932220459, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540735b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24.34921932220459, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.86842105263158, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.732535281218588, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 7.7411122183005014, "policy_loss": -0.014944040459037447, "vf_loss": 7.752929213146369, "vf_explained_var": 0.39174092647929987, "kl": 0.01633882841715604, "entropy": 1.4069091121355692, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -8.128347144621138, "episode_reward_min": -1404.7029239565845, "episode_reward_mean": -770.3117524956344, "episode_len_mean": 126.18823529411765, "episode_media": {}, "episodes_timesteps_total": 10726, "policy_reward_min": {"policy_0": -1404.7029239565845}, "policy_reward_max": {"policy_0": -8.128347144621138}, "policy_reward_mean": {"policy_0": -770.3117524956344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1071.743943735095, -1267.5912382084293, -1097.075332402709, -230.83013756295824, -136.6833033006681, -312.92137651033005, -245.56237973981894, -186.51552576774253, -1146.6067585404335, -1207.3501680289737, -1302.8831933224553, -840.0720693701983, -1239.674653913102, -1023.3488157121485, -122.41266824813289, -62.42932905719129, -338.87035135502435, -308.7365209934552, -1163.1265390085593, -984.7829024419622, -754.8637767773198, -152.25315140968223, -439.7068597115094, -1329.3793986954845, -1167.206355217067, -1074.5189817073604, -651.5832309081152, -134.25894001711816, -1072.0232943997792, -1362.868413819867, -948.9901095000946, -1252.1192601459793, -909.9136473656299, -100.9940953007901, -970.8812146122574, -877.3997269398377, -1110.9537313856076, -123.34663322999808, -588.6984358161327, -8.128347144621138, -1081.1321548340761, -144.05945166331537, -1243.3921967410276, -1404.7029239565845, -884.4160994082991, -995.6689126379368, -784.9600817230306, -1179.3968315578213, -1261.0657455478897, -950.0229450664025, -297.11795146116424, -82.25572994058736, -1071.1743813968735, -1090.800576661475, -950.5768233678189, -973.6437907251435, -969.3060944483915, -367.4440451509281, -377.3332798629831, -1028.9076863640603, -1275.6308482500292, -767.29926208198, -1191.6786517592036, -471.18699129671995, -925.9332418343266, -1096.5556973318448, -181.3842583170959, -474.95323364504526, -742.3662036878234, -547.2819051347957, -1020.3589391322316, -1138.3618611198738, -958.3604222106371, -1065.2829574958148, -604.3019012776704, -35.013830908902136, -1080.1477126306668, -1092.1139732852675, -192.1895801546146, -1156.6738679235457, -930.1585211341405, -63.553621472957985, -1273.3192363487374, -47.413151027785815, -688.2965788277673], "episode_lengths": [150, 150, 150, 87, 62, 105, 89, 69, 150, 150, 150, 150, 150, 150, 54, 63, 114, 83, 150, 150, 150, 64, 99, 150, 150, 150, 126, 55, 150, 150, 150, 150, 150, 56, 150, 150, 150, 53, 113, 40, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 108, 72, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 129, 150, 150, 59, 128, 150, 150, 150, 150, 150, 150, 117, 53, 150, 150, 64, 150, 150, 38, 150, 62, 127], "policy_policy_0_reward": [-1071.743943735095, -1267.5912382084293, -1097.075332402709, -230.83013756295824, -136.6833033006681, -312.92137651033005, -245.56237973981894, -186.51552576774253, -1146.6067585404335, -1207.3501680289737, -1302.8831933224553, -840.0720693701983, -1239.674653913102, -1023.3488157121485, -122.41266824813289, -62.42932905719129, -338.87035135502435, -308.7365209934552, -1163.1265390085593, -984.7829024419622, -754.8637767773198, -152.25315140968223, -439.7068597115094, -1329.3793986954845, -1167.206355217067, -1074.5189817073604, -651.5832309081152, -134.25894001711816, -1072.0232943997792, -1362.868413819867, -948.9901095000946, -1252.1192601459793, -909.9136473656299, -100.9940953007901, -970.8812146122574, -877.3997269398377, -1110.9537313856076, -123.34663322999808, -588.6984358161327, -8.128347144621138, -1081.1321548340761, -144.05945166331537, -1243.3921967410276, -1404.7029239565845, -884.4160994082991, -995.6689126379368, -784.9600817230306, -1179.3968315578213, -1261.0657455478897, -950.0229450664025, -297.11795146116424, -82.25572994058736, -1071.1743813968735, -1090.800576661475, -950.5768233678189, -973.6437907251435, -969.3060944483915, -367.4440451509281, -377.3332798629831, -1028.9076863640603, -1275.6308482500292, -767.29926208198, -1191.6786517592036, -471.18699129671995, -925.9332418343266, -1096.5556973318448, -181.3842583170959, -474.95323364504526, -742.3662036878234, -547.2819051347957, -1020.3589391322316, -1138.3618611198738, -958.3604222106371, -1065.2829574958148, -604.3019012776704, -35.013830908902136, -1080.1477126306668, -1092.1139732852675, -192.1895801546146, -1156.6738679235457, -930.1585211341405, -63.553621472957985, -1273.3192363487374, -47.413151027785815, -688.2965788277673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5691931099736239, "mean_inference_ms": 1.6742635435965105, "mean_action_processing_ms": 0.28312295221196493, "mean_env_wait_ms": 3.4306021240773537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013691397274241728, "StateBufferConnector_ms": 0.008623740252326517, "ViewRequirementAgentConnector_ms": 0.18767525168026195}, "num_episodes": 35, "episode_return_max": -8.128347144621138, "episode_return_min": -1404.7029239565845, "episode_return_mean": -770.3117524956344, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.980026727345, "num_env_steps_trained_throughput_per_sec": 302.980026727345, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12508.973, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12508.909, "sample_time_ms": 1130.272, "learn_time_ms": 11312.373, "learn_throughput": 353.595, "synch_weights_time_ms": 65.495}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1e132_00005", "date": "2024-08-04_08-16-55", "timestamp": 1722739615, "time_this_iter_s": 13.214223861694336, "time_total_s": 37.563443183898926, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354134040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.563443183898926, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.821052631578944, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.23989070554574, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 5.999387028316657, "policy_loss": -0.009943708089122084, "vf_loss": 6.006750576694807, "vf_explained_var": 0.7983543859173854, "kl": 0.013601872167009787, "entropy": 1.402124188343684, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -8.128347144621138, "episode_reward_min": -1404.7029239565845, "episode_reward_mean": -734.1812101050245, "episode_len_mean": 125.27, "episode_media": {}, "episodes_timesteps_total": 12527, "policy_reward_min": {"policy_0": -1404.7029239565845}, "policy_reward_max": {"policy_0": -8.128347144621138}, "policy_reward_mean": {"policy_0": -734.1812101050245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-984.7829024419622, -754.8637767773198, -152.25315140968223, -439.7068597115094, -1329.3793986954845, -1167.206355217067, -1074.5189817073604, -651.5832309081152, -134.25894001711816, -1072.0232943997792, -1362.868413819867, -948.9901095000946, -1252.1192601459793, -909.9136473656299, -100.9940953007901, -970.8812146122574, -877.3997269398377, -1110.9537313856076, -123.34663322999808, -588.6984358161327, -8.128347144621138, -1081.1321548340761, -144.05945166331537, -1243.3921967410276, -1404.7029239565845, -884.4160994082991, -995.6689126379368, -784.9600817230306, -1179.3968315578213, -1261.0657455478897, -950.0229450664025, -297.11795146116424, -82.25572994058736, -1071.1743813968735, -1090.800576661475, -950.5768233678189, -973.6437907251435, -969.3060944483915, -367.4440451509281, -377.3332798629831, -1028.9076863640603, -1275.6308482500292, -767.29926208198, -1191.6786517592036, -471.18699129671995, -925.9332418343266, -1096.5556973318448, -181.3842583170959, -474.95323364504526, -742.3662036878234, -547.2819051347957, -1020.3589391322316, -1138.3618611198738, -958.3604222106371, -1065.2829574958148, -604.3019012776704, -35.013830908902136, -1080.1477126306668, -1092.1139732852675, -192.1895801546146, -1156.6738679235457, -930.1585211341405, -63.553621472957985, -1273.3192363487374, -47.413151027785815, -688.2965788277673, -149.40614242993811, -941.9590144350205, -830.9428018153062, -59.74850931144544, -1102.5838467708202, -1112.451354089945, -368.9002730117271, -740.3626171839202, -926.0311113069089, -924.0611047646247, -1131.495838675018, -1186.5741386679053, -503.2368413810592, -48.560748299706646, -1093.6157482319989, -906.6605957015605, -731.3795509342477, -429.1452280969285, -1020.6332464752346, -141.98746991662358, -284.0674237038798, -266.31758872128006, -1060.38845721512, -699.5453896690701, -854.6245259591885, -11.855416291419523, -885.9748286758663, -53.24850668736221, -1097.2526109216728, -60.867324686203226, -78.81342503267315, -659.633256996051, -619.1313322797192, -264.60008481151067], "episode_lengths": [150, 150, 64, 99, 150, 150, 150, 126, 55, 150, 150, 150, 150, 150, 56, 150, 150, 150, 53, 113, 40, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 108, 72, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 129, 150, 150, 59, 128, 150, 150, 150, 150, 150, 150, 117, 53, 150, 150, 64, 150, 150, 38, 150, 62, 127, 60, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 137, 97, 150, 78, 78, 81, 150, 139, 150, 33, 150, 48, 150, 54, 57, 148, 120, 98], "policy_policy_0_reward": [-984.7829024419622, -754.8637767773198, -152.25315140968223, -439.7068597115094, -1329.3793986954845, -1167.206355217067, -1074.5189817073604, -651.5832309081152, -134.25894001711816, -1072.0232943997792, -1362.868413819867, -948.9901095000946, -1252.1192601459793, -909.9136473656299, -100.9940953007901, -970.8812146122574, -877.3997269398377, -1110.9537313856076, -123.34663322999808, -588.6984358161327, -8.128347144621138, -1081.1321548340761, -144.05945166331537, -1243.3921967410276, -1404.7029239565845, -884.4160994082991, -995.6689126379368, -784.9600817230306, -1179.3968315578213, -1261.0657455478897, -950.0229450664025, -297.11795146116424, -82.25572994058736, -1071.1743813968735, -1090.800576661475, -950.5768233678189, -973.6437907251435, -969.3060944483915, -367.4440451509281, -377.3332798629831, -1028.9076863640603, -1275.6308482500292, -767.29926208198, -1191.6786517592036, -471.18699129671995, -925.9332418343266, -1096.5556973318448, -181.3842583170959, -474.95323364504526, -742.3662036878234, -547.2819051347957, -1020.3589391322316, -1138.3618611198738, -958.3604222106371, -1065.2829574958148, -604.3019012776704, -35.013830908902136, -1080.1477126306668, -1092.1139732852675, -192.1895801546146, -1156.6738679235457, -930.1585211341405, -63.553621472957985, -1273.3192363487374, -47.413151027785815, -688.2965788277673, -149.40614242993811, -941.9590144350205, -830.9428018153062, -59.74850931144544, -1102.5838467708202, -1112.451354089945, -368.9002730117271, -740.3626171839202, -926.0311113069089, -924.0611047646247, -1131.495838675018, -1186.5741386679053, -503.2368413810592, -48.560748299706646, -1093.6157482319989, -906.6605957015605, -731.3795509342477, -429.1452280969285, -1020.6332464752346, -141.98746991662358, -284.0674237038798, -266.31758872128006, -1060.38845721512, -699.5453896690701, -854.6245259591885, -11.855416291419523, -885.9748286758663, -53.24850668736221, -1097.2526109216728, -60.867324686203226, -78.81342503267315, -659.633256996051, -619.1313322797192, -264.60008481151067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5661990502614717, "mean_inference_ms": 1.6741736744810711, "mean_action_processing_ms": 0.28317521652293637, "mean_env_wait_ms": 3.433640572076836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013792991638183594, "StateBufferConnector_ms": 0.008733034133911133, "ViewRequirementAgentConnector_ms": 0.18963623046875}, "num_episodes": 34, "episode_return_max": -8.128347144621138, "episode_return_min": -1404.7029239565845, "episode_return_mean": -734.1812101050245, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.80902250954733, "num_env_steps_trained_throughput_per_sec": 305.80902250954733, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12651.748, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12651.683, "sample_time_ms": 1126.255, "learn_time_ms": 11459.886, "learn_throughput": 349.044, "synch_weights_time_ms": 64.769}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1e132_00005", "date": "2024-08-04_08-17-08", "timestamp": 1722739628, "time_this_iter_s": 13.093967914581299, "time_total_s": 50.657411098480225, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.657411098480225, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.97894736842105, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.47368035316467, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 5.185483295222124, "policy_loss": -0.008467534783509716, "vf_loss": 5.191966485977173, "vf_explained_var": 0.8660729100306829, "kl": 0.010670688908168325, "entropy": 1.4978806746502717, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -11.855416291419523, "episode_reward_min": -1339.976466750773, "episode_reward_mean": -725.9289838377606, "episode_len_mean": 127.22, "episode_media": {}, "episodes_timesteps_total": 12722, "policy_reward_min": {"policy_0": -1339.976466750773}, "policy_reward_max": {"policy_0": -11.855416291419523}, "policy_reward_mean": {"policy_0": -725.9289838377606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1261.0657455478897, -950.0229450664025, -297.11795146116424, -82.25572994058736, -1071.1743813968735, -1090.800576661475, -950.5768233678189, -973.6437907251435, -969.3060944483915, -367.4440451509281, -377.3332798629831, -1028.9076863640603, -1275.6308482500292, -767.29926208198, -1191.6786517592036, -471.18699129671995, -925.9332418343266, -1096.5556973318448, -181.3842583170959, -474.95323364504526, -742.3662036878234, -547.2819051347957, -1020.3589391322316, -1138.3618611198738, -958.3604222106371, -1065.2829574958148, -604.3019012776704, -35.013830908902136, -1080.1477126306668, -1092.1139732852675, -192.1895801546146, -1156.6738679235457, -930.1585211341405, -63.553621472957985, -1273.3192363487374, -47.413151027785815, -688.2965788277673, -149.40614242993811, -941.9590144350205, -830.9428018153062, -59.74850931144544, -1102.5838467708202, -1112.451354089945, -368.9002730117271, -740.3626171839202, -926.0311113069089, -924.0611047646247, -1131.495838675018, -1186.5741386679053, -503.2368413810592, -48.560748299706646, -1093.6157482319989, -906.6605957015605, -731.3795509342477, -429.1452280969285, -1020.6332464752346, -141.98746991662358, -284.0674237038798, -266.31758872128006, -1060.38845721512, -699.5453896690701, -854.6245259591885, -11.855416291419523, -885.9748286758663, -53.24850668736221, -1097.2526109216728, -60.867324686203226, -78.81342503267315, -659.633256996051, -619.1313322797192, -264.60008481151067, -125.56672580172142, -374.42289299086053, -1053.1569470896952, -484.23725269981895, -1154.2214778250855, -1102.5122453438519, -707.83017646182, -1110.2162136609247, -607.7224243506278, -1009.3341718394731, -983.6800638916249, -686.293099726827, -1067.7955410091154, -66.62220445614375, -416.8613094177381, -564.1063451966085, -1139.9749953398298, -845.3059540615338, -1126.4692781919537, -956.7103431801447, -182.3881757176977, -803.3610484653389, -1113.1928451226077, -338.10967783025484, -887.4626563328053, -1184.724395320924, -232.90912219771255, -1242.2124820684032, -1339.976466750773], "episode_lengths": [150, 150, 108, 72, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 129, 150, 150, 59, 128, 150, 150, 150, 150, 150, 150, 117, 53, 150, 150, 64, 150, 150, 38, 150, 62, 127, 60, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 137, 97, 150, 78, 78, 81, 150, 139, 150, 33, 150, 48, 150, 54, 57, 148, 120, 98, 64, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 102, 112, 150, 150, 150, 150, 71, 145, 150, 150, 150, 150, 88, 150, 150], "policy_policy_0_reward": [-1261.0657455478897, -950.0229450664025, -297.11795146116424, -82.25572994058736, -1071.1743813968735, -1090.800576661475, -950.5768233678189, -973.6437907251435, -969.3060944483915, -367.4440451509281, -377.3332798629831, -1028.9076863640603, -1275.6308482500292, -767.29926208198, -1191.6786517592036, -471.18699129671995, -925.9332418343266, -1096.5556973318448, -181.3842583170959, -474.95323364504526, -742.3662036878234, -547.2819051347957, -1020.3589391322316, -1138.3618611198738, -958.3604222106371, -1065.2829574958148, -604.3019012776704, -35.013830908902136, -1080.1477126306668, -1092.1139732852675, -192.1895801546146, -1156.6738679235457, -930.1585211341405, -63.553621472957985, -1273.3192363487374, -47.413151027785815, -688.2965788277673, -149.40614242993811, -941.9590144350205, -830.9428018153062, -59.74850931144544, -1102.5838467708202, -1112.451354089945, -368.9002730117271, -740.3626171839202, -926.0311113069089, -924.0611047646247, -1131.495838675018, -1186.5741386679053, -503.2368413810592, -48.560748299706646, -1093.6157482319989, -906.6605957015605, -731.3795509342477, -429.1452280969285, -1020.6332464752346, -141.98746991662358, -284.0674237038798, -266.31758872128006, -1060.38845721512, -699.5453896690701, -854.6245259591885, -11.855416291419523, -885.9748286758663, -53.24850668736221, -1097.2526109216728, -60.867324686203226, -78.81342503267315, -659.633256996051, -619.1313322797192, -264.60008481151067, -125.56672580172142, -374.42289299086053, -1053.1569470896952, -484.23725269981895, -1154.2214778250855, -1102.5122453438519, -707.83017646182, -1110.2162136609247, -607.7224243506278, -1009.3341718394731, -983.6800638916249, -686.293099726827, -1067.7955410091154, -66.62220445614375, -416.8613094177381, -564.1063451966085, -1139.9749953398298, -845.3059540615338, -1126.4692781919537, -956.7103431801447, -182.3881757176977, -803.3610484653389, -1113.1928451226077, -338.10967783025484, -887.4626563328053, -1184.724395320924, -232.90912219771255, -1242.2124820684032, -1339.976466750773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5638342149171401, "mean_inference_ms": 1.672529617491587, "mean_action_processing_ms": 0.28191305829703905, "mean_env_wait_ms": 3.428403156131951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013201713562011719, "StateBufferConnector_ms": 0.008636713027954102, "ViewRequirementAgentConnector_ms": 0.18843746185302734}, "num_episodes": 29, "episode_return_max": -11.855416291419523, "episode_return_min": -1339.976466750773, "episode_return_mean": -725.9289838377606, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.1295428815468, "num_env_steps_trained_throughput_per_sec": 313.1295428815468, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12676.254, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12676.189, "sample_time_ms": 1117.986, "learn_time_ms": 11487.968, "learn_throughput": 348.19, "synch_weights_time_ms": 69.461}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1e132_00005", "date": "2024-08-04_08-17-21", "timestamp": 1722739641, "time_this_iter_s": 12.787162780761719, "time_total_s": 63.44457387924194, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354135fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.44457387924194, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.083333333333332, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.43731067876021, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 4.121454106767972, "policy_loss": -0.012060366918255265, "vf_loss": 4.130665237953266, "vf_explained_var": 0.9143643625080585, "kl": 0.014984265690168285, "entropy": 1.4760134380310774, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -11.855416291419523, "episode_reward_min": -1372.3088204202402, "episode_reward_mean": -720.2140976631819, "episode_len_mean": 125.11, "episode_media": {}, "episodes_timesteps_total": 12511, "policy_reward_min": {"policy_0": -1372.3088204202402}, "policy_reward_max": {"policy_0": -11.855416291419523}, "policy_reward_mean": {"policy_0": -720.2140976631819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.013830908902136, -1080.1477126306668, -1092.1139732852675, -192.1895801546146, -1156.6738679235457, -930.1585211341405, -63.553621472957985, -1273.3192363487374, -47.413151027785815, -688.2965788277673, -149.40614242993811, -941.9590144350205, -830.9428018153062, -59.74850931144544, -1102.5838467708202, -1112.451354089945, -368.9002730117271, -740.3626171839202, -926.0311113069089, -924.0611047646247, -1131.495838675018, -1186.5741386679053, -503.2368413810592, -48.560748299706646, -1093.6157482319989, -906.6605957015605, -731.3795509342477, -429.1452280969285, -1020.6332464752346, -141.98746991662358, -284.0674237038798, -266.31758872128006, -1060.38845721512, -699.5453896690701, -854.6245259591885, -11.855416291419523, -885.9748286758663, -53.24850668736221, -1097.2526109216728, -60.867324686203226, -78.81342503267315, -659.633256996051, -619.1313322797192, -264.60008481151067, -125.56672580172142, -374.42289299086053, -1053.1569470896952, -484.23725269981895, -1154.2214778250855, -1102.5122453438519, -707.83017646182, -1110.2162136609247, -607.7224243506278, -1009.3341718394731, -983.6800638916249, -686.293099726827, -1067.7955410091154, -66.62220445614375, -416.8613094177381, -564.1063451966085, -1139.9749953398298, -845.3059540615338, -1126.4692781919537, -956.7103431801447, -182.3881757176977, -803.3610484653389, -1113.1928451226077, -338.10967783025484, -887.4626563328053, -1184.724395320924, -232.90912219771255, -1242.2124820684032, -1339.976466750773, -1276.0355503389542, -960.4712627838135, -968.5018066985882, -517.899550235601, -109.38207271882808, -1112.7389285860052, -1355.7691097637085, -1369.6397734296565, -1273.36158398777, -263.88863496117216, -131.4511926593858, -1364.676922914018, -313.3277489149289, -41.40022606474007, -1372.3088204202402, -570.8851959595399, -650.4120307600524, -892.5501827307565, -780.6566965981805, -126.51524483545371, -891.5376373606078, -1079.5551577004856, -535.2962062787399, -599.8429573127212, -1132.6059706117242, -1067.4228156759211, -550.9635268093378], "episode_lengths": [53, 150, 150, 64, 150, 150, 38, 150, 62, 127, 60, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 137, 97, 150, 78, 78, 81, 150, 139, 150, 33, 150, 48, 150, 54, 57, 148, 120, 98, 64, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 102, 112, 150, 150, 150, 150, 71, 145, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 90, 61, 150, 111, 56, 150, 122, 137, 150, 150, 50, 150, 150, 104, 150, 150, 150, 150], "policy_policy_0_reward": [-35.013830908902136, -1080.1477126306668, -1092.1139732852675, -192.1895801546146, -1156.6738679235457, -930.1585211341405, -63.553621472957985, -1273.3192363487374, -47.413151027785815, -688.2965788277673, -149.40614242993811, -941.9590144350205, -830.9428018153062, -59.74850931144544, -1102.5838467708202, -1112.451354089945, -368.9002730117271, -740.3626171839202, -926.0311113069089, -924.0611047646247, -1131.495838675018, -1186.5741386679053, -503.2368413810592, -48.560748299706646, -1093.6157482319989, -906.6605957015605, -731.3795509342477, -429.1452280969285, -1020.6332464752346, -141.98746991662358, -284.0674237038798, -266.31758872128006, -1060.38845721512, -699.5453896690701, -854.6245259591885, -11.855416291419523, -885.9748286758663, -53.24850668736221, -1097.2526109216728, -60.867324686203226, -78.81342503267315, -659.633256996051, -619.1313322797192, -264.60008481151067, -125.56672580172142, -374.42289299086053, -1053.1569470896952, -484.23725269981895, -1154.2214778250855, -1102.5122453438519, -707.83017646182, -1110.2162136609247, -607.7224243506278, -1009.3341718394731, -983.6800638916249, -686.293099726827, -1067.7955410091154, -66.62220445614375, -416.8613094177381, -564.1063451966085, -1139.9749953398298, -845.3059540615338, -1126.4692781919537, -956.7103431801447, -182.3881757176977, -803.3610484653389, -1113.1928451226077, -338.10967783025484, -887.4626563328053, -1184.724395320924, -232.90912219771255, -1242.2124820684032, -1339.976466750773, -1276.0355503389542, -960.4712627838135, -968.5018066985882, -517.899550235601, -109.38207271882808, -1112.7389285860052, -1355.7691097637085, -1369.6397734296565, -1273.36158398777, -263.88863496117216, -131.4511926593858, -1364.676922914018, -313.3277489149289, -41.40022606474007, -1372.3088204202402, -570.8851959595399, -650.4120307600524, -892.5501827307565, -780.6566965981805, -126.51524483545371, -891.5376373606078, -1079.5551577004856, -535.2962062787399, -599.8429573127212, -1132.6059706117242, -1067.4228156759211, -550.9635268093378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611884506410643, "mean_inference_ms": 1.6696127710624935, "mean_action_processing_ms": 0.2816622256830283, "mean_env_wait_ms": 3.4274139169603206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013122081756591797, "StateBufferConnector_ms": 0.00858449935913086, "ViewRequirementAgentConnector_ms": 0.18997812271118164}, "num_episodes": 27, "episode_return_max": -11.855416291419523, "episode_return_min": -1372.3088204202402, "episode_return_mean": -720.2140976631819, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.5545503283681, "num_env_steps_trained_throughput_per_sec": 305.5545503283681, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12745.372, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12745.307, "sample_time_ms": 1116.351, "learn_time_ms": 11558.406, "learn_throughput": 346.068, "synch_weights_time_ms": 69.769}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1e132_00005", "date": "2024-08-04_08-17-34", "timestamp": 1722739654, "time_this_iter_s": 13.105100870132446, "time_total_s": 76.54967474937439, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354134040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.54967474937439, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.084210526315786, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.31102196375528, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 3.511853839084506, "policy_loss": -0.011369287795969286, "vf_loss": 3.5198658044139544, "vf_explained_var": 0.9494266622389357, "kl": 0.017531048949846688, "entropy": 1.48891744154195, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -11.855416291419523, "episode_reward_min": -1385.9414259067562, "episode_reward_mean": -705.9767730566215, "episode_len_mean": 126.17, "episode_media": {}, "episodes_timesteps_total": 12617, "policy_reward_min": {"policy_0": -1385.9414259067562}, "policy_reward_max": {"policy_0": -11.855416291419523}, "policy_reward_mean": {"policy_0": -705.9767730566215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-699.5453896690701, -854.6245259591885, -11.855416291419523, -885.9748286758663, -53.24850668736221, -1097.2526109216728, -60.867324686203226, -78.81342503267315, -659.633256996051, -619.1313322797192, -264.60008481151067, -125.56672580172142, -374.42289299086053, -1053.1569470896952, -484.23725269981895, -1154.2214778250855, -1102.5122453438519, -707.83017646182, -1110.2162136609247, -607.7224243506278, -1009.3341718394731, -983.6800638916249, -686.293099726827, -1067.7955410091154, -66.62220445614375, -416.8613094177381, -564.1063451966085, -1139.9749953398298, -845.3059540615338, -1126.4692781919537, -956.7103431801447, -182.3881757176977, -803.3610484653389, -1113.1928451226077, -338.10967783025484, -887.4626563328053, -1184.724395320924, -232.90912219771255, -1242.2124820684032, -1339.976466750773, -1276.0355503389542, -960.4712627838135, -968.5018066985882, -517.899550235601, -109.38207271882808, -1112.7389285860052, -1355.7691097637085, -1369.6397734296565, -1273.36158398777, -263.88863496117216, -131.4511926593858, -1364.676922914018, -313.3277489149289, -41.40022606474007, -1372.3088204202402, -570.8851959595399, -650.4120307600524, -892.5501827307565, -780.6566965981805, -126.51524483545371, -891.5376373606078, -1079.5551577004856, -535.2962062787399, -599.8429573127212, -1132.6059706117242, -1067.4228156759211, -550.9635268093378, -1074.6869233679945, -554.7009414397065, -249.2847904067198, -1225.3001087649627, -226.75946300132455, -949.795222971238, -244.61483722977508, -1062.6359490378218, -633.1212950401862, -1385.9414259067562, -717.7608449038142, -347.1830159768234, -242.7543258569871, -951.0263759696454, -885.7405090988495, -569.4626678102859, -78.54039863971099, -597.4381791655718, -302.8662437388211, -753.1953408962816, -672.0226159413421, -944.6547813545347, -1219.9209247157073, -924.5615661997291, -467.3693460546909, -772.6191162006469, -793.3690122543371, -70.21373215469279, -1060.818076385736, -211.31190117094246, -61.53898110244333, -742.6517486071185, -101.79660283336845], "episode_lengths": [139, 150, 33, 150, 48, 150, 54, 57, 148, 120, 98, 64, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 102, 112, 150, 150, 150, 150, 71, 145, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 90, 61, 150, 111, 56, 150, 122, 137, 150, 150, 50, 150, 150, 104, 150, 150, 150, 150, 150, 115, 69, 150, 94, 150, 78, 150, 140, 150, 150, 95, 150, 150, 150, 150, 44, 119, 101, 150, 150, 150, 150, 150, 150, 145, 150, 55, 150, 62, 66, 150, 47], "policy_policy_0_reward": [-699.5453896690701, -854.6245259591885, -11.855416291419523, -885.9748286758663, -53.24850668736221, -1097.2526109216728, -60.867324686203226, -78.81342503267315, -659.633256996051, -619.1313322797192, -264.60008481151067, -125.56672580172142, -374.42289299086053, -1053.1569470896952, -484.23725269981895, -1154.2214778250855, -1102.5122453438519, -707.83017646182, -1110.2162136609247, -607.7224243506278, -1009.3341718394731, -983.6800638916249, -686.293099726827, -1067.7955410091154, -66.62220445614375, -416.8613094177381, -564.1063451966085, -1139.9749953398298, -845.3059540615338, -1126.4692781919537, -956.7103431801447, -182.3881757176977, -803.3610484653389, -1113.1928451226077, -338.10967783025484, -887.4626563328053, -1184.724395320924, -232.90912219771255, -1242.2124820684032, -1339.976466750773, -1276.0355503389542, -960.4712627838135, -968.5018066985882, -517.899550235601, -109.38207271882808, -1112.7389285860052, -1355.7691097637085, -1369.6397734296565, -1273.36158398777, -263.88863496117216, -131.4511926593858, -1364.676922914018, -313.3277489149289, -41.40022606474007, -1372.3088204202402, -570.8851959595399, -650.4120307600524, -892.5501827307565, -780.6566965981805, -126.51524483545371, -891.5376373606078, -1079.5551577004856, -535.2962062787399, -599.8429573127212, -1132.6059706117242, -1067.4228156759211, -550.9635268093378, -1074.6869233679945, -554.7009414397065, -249.2847904067198, -1225.3001087649627, -226.75946300132455, -949.795222971238, -244.61483722977508, -1062.6359490378218, -633.1212950401862, -1385.9414259067562, -717.7608449038142, -347.1830159768234, -242.7543258569871, -951.0263759696454, -885.7405090988495, -569.4626678102859, -78.54039863971099, -597.4381791655718, -302.8662437388211, -753.1953408962816, -672.0226159413421, -944.6547813545347, -1219.9209247157073, -924.5615661997291, -467.3693460546909, -772.6191162006469, -793.3690122543371, -70.21373215469279, -1060.818076385736, -211.31190117094246, -61.53898110244333, -742.6517486071185, -101.79660283336845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.559952771204374, "mean_inference_ms": 1.6695750467998687, "mean_action_processing_ms": 0.2811104162374528, "mean_env_wait_ms": 3.4289580078953144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012840032577514648, "StateBufferConnector_ms": 0.008277654647827148, "ViewRequirementAgentConnector_ms": 0.19212126731872559}, "num_episodes": 33, "episode_return_max": -11.855416291419523, "episode_return_min": -1385.9414259067562, "episode_return_mean": -705.9767730566215, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.7707961253356, "num_env_steps_trained_throughput_per_sec": 306.7707961253356, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12787.328, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12787.263, "sample_time_ms": 1117.416, "learn_time_ms": 11598.929, "learn_throughput": 344.859, "synch_weights_time_ms": 70.143}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1e132_00005", "date": "2024-08-04_08-17-47", "timestamp": 1722739667, "time_this_iter_s": 13.05119514465332, "time_total_s": 89.60086989402771, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d7ac121750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.60086989402771, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.333333333333336, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.03172479271889, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 3.234762158493201, "policy_loss": -0.008845109083146478, "vf_loss": 3.2407799659917753, "vf_explained_var": 0.970379888266325, "kl": 0.014879893385356505, "entropy": 1.4867500158647695, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -41.40022606474007, "episode_reward_min": -1385.9414259067562, "episode_reward_mean": -712.2289141178798, "episode_len_mean": 128.05, "episode_media": {}, "episodes_timesteps_total": 12805, "policy_reward_min": {"policy_0": -1385.9414259067562}, "policy_reward_max": {"policy_0": -41.40022606474007}, "policy_reward_mean": {"policy_0": -712.2289141178798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1113.1928451226077, -338.10967783025484, -887.4626563328053, -1184.724395320924, -232.90912219771255, -1242.2124820684032, -1339.976466750773, -1276.0355503389542, -960.4712627838135, -968.5018066985882, -517.899550235601, -109.38207271882808, -1112.7389285860052, -1355.7691097637085, -1369.6397734296565, -1273.36158398777, -263.88863496117216, -131.4511926593858, -1364.676922914018, -313.3277489149289, -41.40022606474007, -1372.3088204202402, -570.8851959595399, -650.4120307600524, -892.5501827307565, -780.6566965981805, -126.51524483545371, -891.5376373606078, -1079.5551577004856, -535.2962062787399, -599.8429573127212, -1132.6059706117242, -1067.4228156759211, -550.9635268093378, -1074.6869233679945, -554.7009414397065, -249.2847904067198, -1225.3001087649627, -226.75946300132455, -949.795222971238, -244.61483722977508, -1062.6359490378218, -633.1212950401862, -1385.9414259067562, -717.7608449038142, -347.1830159768234, -242.7543258569871, -951.0263759696454, -885.7405090988495, -569.4626678102859, -78.54039863971099, -597.4381791655718, -302.8662437388211, -753.1953408962816, -672.0226159413421, -944.6547813545347, -1219.9209247157073, -924.5615661997291, -467.3693460546909, -772.6191162006469, -793.3690122543371, -70.21373215469279, -1060.818076385736, -211.31190117094246, -61.53898110244333, -742.6517486071185, -101.79660283336845, -775.7913045172658, -1300.417483219029, -507.724510144185, -1151.6440670053166, -1006.7558841347691, -475.6073686480903, -417.78799172330946, -185.68009354852222, -1085.838192031046, -1183.6480307101144, -369.6504309906089, -272.2048341588962, -984.1546026152607, -1278.7368631288048, -1225.2809749756684, -182.574187085924, -559.5150893666273, -896.0932464267264, -224.58659623517295, -126.3223282861266, -536.8757654413338, -154.7432166299741, -948.3326469245997, -613.4106617461154, -1294.7204793431558, -1182.7789813829663, -335.4862989645831, -1176.7411348160756, -564.208006368441, -102.7286031824161, -951.0923468401705, -209.82685236633955, -198.59062189735667], "episode_lengths": [150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 90, 61, 150, 111, 56, 150, 122, 137, 150, 150, 50, 150, 150, 104, 150, 150, 150, 150, 150, 115, 69, 150, 94, 150, 78, 150, 140, 150, 150, 95, 150, 150, 150, 150, 44, 119, 101, 150, 150, 150, 150, 150, 150, 145, 150, 55, 150, 62, 66, 150, 47, 150, 150, 141, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 81, 70, 113, 64, 150, 119, 150, 150, 93, 150, 150, 78, 150, 78, 77], "policy_policy_0_reward": [-1113.1928451226077, -338.10967783025484, -887.4626563328053, -1184.724395320924, -232.90912219771255, -1242.2124820684032, -1339.976466750773, -1276.0355503389542, -960.4712627838135, -968.5018066985882, -517.899550235601, -109.38207271882808, -1112.7389285860052, -1355.7691097637085, -1369.6397734296565, -1273.36158398777, -263.88863496117216, -131.4511926593858, -1364.676922914018, -313.3277489149289, -41.40022606474007, -1372.3088204202402, -570.8851959595399, -650.4120307600524, -892.5501827307565, -780.6566965981805, -126.51524483545371, -891.5376373606078, -1079.5551577004856, -535.2962062787399, -599.8429573127212, -1132.6059706117242, -1067.4228156759211, -550.9635268093378, -1074.6869233679945, -554.7009414397065, -249.2847904067198, -1225.3001087649627, -226.75946300132455, -949.795222971238, -244.61483722977508, -1062.6359490378218, -633.1212950401862, -1385.9414259067562, -717.7608449038142, -347.1830159768234, -242.7543258569871, -951.0263759696454, -885.7405090988495, -569.4626678102859, -78.54039863971099, -597.4381791655718, -302.8662437388211, -753.1953408962816, -672.0226159413421, -944.6547813545347, -1219.9209247157073, -924.5615661997291, -467.3693460546909, -772.6191162006469, -793.3690122543371, -70.21373215469279, -1060.818076385736, -211.31190117094246, -61.53898110244333, -742.6517486071185, -101.79660283336845, -775.7913045172658, -1300.417483219029, -507.724510144185, -1151.6440670053166, -1006.7558841347691, -475.6073686480903, -417.78799172330946, -185.68009354852222, -1085.838192031046, -1183.6480307101144, -369.6504309906089, -272.2048341588962, -984.1546026152607, -1278.7368631288048, -1225.2809749756684, -182.574187085924, -559.5150893666273, -896.0932464267264, -224.58659623517295, -126.3223282861266, -536.8757654413338, -154.7432166299741, -948.3326469245997, -613.4106617461154, -1294.7204793431558, -1182.7789813829663, -335.4862989645831, -1176.7411348160756, -564.208006368441, -102.7286031824161, -951.0923468401705, -209.82685236633955, -198.59062189735667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588300933577464, "mean_inference_ms": 1.6707796301275468, "mean_action_processing_ms": 0.2803964060284574, "mean_env_wait_ms": 3.43476377065954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013020515441894531, "StateBufferConnector_ms": 0.008157491683959961, "ViewRequirementAgentConnector_ms": 0.19737529754638672}, "num_episodes": 33, "episode_return_max": -41.40022606474007, "episode_return_min": -1385.9414259067562, "episode_return_mean": -712.2289141178798, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4267384779309, "num_env_steps_trained_throughput_per_sec": 307.4267384779309, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12815.317, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12815.252, "sample_time_ms": 1116.566, "learn_time_ms": 11628.617, "learn_throughput": 343.979, "synch_weights_time_ms": 69.278}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1e132_00005", "date": "2024-08-04_08-18-00", "timestamp": 1722739680, "time_this_iter_s": 13.023088932037354, "time_total_s": 102.62395882606506, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a5870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.62395882606506, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.71578947368421, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.3638096968333, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 3.090770286694169, "policy_loss": -0.010730223324693118, "vf_loss": 3.098535115023454, "vf_explained_var": 0.968626597026984, "kl": 0.015619713990455853, "entropy": 1.585486296315988, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -31.576199709570197, "episode_reward_min": -1386.8430542870724, "episode_reward_mean": -682.8725394171928, "episode_len_mean": 126.16, "episode_media": {}, "episodes_timesteps_total": 12616, "policy_reward_min": {"policy_0": -1386.8430542870724}, "policy_reward_max": {"policy_0": -31.576199709570197}, "policy_reward_mean": {"policy_0": -682.8725394171928}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-535.2962062787399, -599.8429573127212, -1132.6059706117242, -1067.4228156759211, -550.9635268093378, -1074.6869233679945, -554.7009414397065, -249.2847904067198, -1225.3001087649627, -226.75946300132455, -949.795222971238, -244.61483722977508, -1062.6359490378218, -633.1212950401862, -1385.9414259067562, -717.7608449038142, -347.1830159768234, -242.7543258569871, -951.0263759696454, -885.7405090988495, -569.4626678102859, -78.54039863971099, -597.4381791655718, -302.8662437388211, -753.1953408962816, -672.0226159413421, -944.6547813545347, -1219.9209247157073, -924.5615661997291, -467.3693460546909, -772.6191162006469, -793.3690122543371, -70.21373215469279, -1060.818076385736, -211.31190117094246, -61.53898110244333, -742.6517486071185, -101.79660283336845, -775.7913045172658, -1300.417483219029, -507.724510144185, -1151.6440670053166, -1006.7558841347691, -475.6073686480903, -417.78799172330946, -185.68009354852222, -1085.838192031046, -1183.6480307101144, -369.6504309906089, -272.2048341588962, -984.1546026152607, -1278.7368631288048, -1225.2809749756684, -182.574187085924, -559.5150893666273, -896.0932464267264, -224.58659623517295, -126.3223282861266, -536.8757654413338, -154.7432166299741, -948.3326469245997, -613.4106617461154, -1294.7204793431558, -1182.7789813829663, -335.4862989645831, -1176.7411348160756, -564.208006368441, -102.7286031824161, -951.0923468401705, -209.82685236633955, -198.59062189735667, -934.7812876283629, -349.0232123342324, -1218.201156727239, -31.576199709570197, -661.5170886880376, -891.9617551083884, -203.6723004268227, -380.69401195964497, -1335.5621263005173, -418.4715580044891, -255.8526358915388, -915.4819256561093, -806.7889283470647, -1201.398238390362, -69.34400593773589, -1172.1879445288644, -203.7807431135754, -911.5799350147635, -1386.8430542870724, -1199.7764950621429, -568.64602486725, -1053.5722367986164, -1046.5589036108868, -1031.9062907030811, -924.6132266177277, -1022.4558154870363, -261.86543234407554, -180.67897322958052, -187.1239992024833], "episode_lengths": [104, 150, 150, 150, 150, 150, 115, 69, 150, 94, 150, 78, 150, 140, 150, 150, 95, 150, 150, 150, 150, 44, 119, 101, 150, 150, 150, 150, 150, 150, 145, 150, 55, 150, 62, 66, 150, 47, 150, 150, 141, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 81, 70, 113, 64, 150, 119, 150, 150, 93, 150, 150, 78, 150, 78, 77, 150, 109, 150, 44, 150, 150, 103, 107, 150, 104, 92, 150, 150, 150, 57, 150, 67, 150, 150, 150, 120, 150, 150, 150, 150, 150, 82, 93, 77], "policy_policy_0_reward": [-535.2962062787399, -599.8429573127212, -1132.6059706117242, -1067.4228156759211, -550.9635268093378, -1074.6869233679945, -554.7009414397065, -249.2847904067198, -1225.3001087649627, -226.75946300132455, -949.795222971238, -244.61483722977508, -1062.6359490378218, -633.1212950401862, -1385.9414259067562, -717.7608449038142, -347.1830159768234, -242.7543258569871, -951.0263759696454, -885.7405090988495, -569.4626678102859, -78.54039863971099, -597.4381791655718, -302.8662437388211, -753.1953408962816, -672.0226159413421, -944.6547813545347, -1219.9209247157073, -924.5615661997291, -467.3693460546909, -772.6191162006469, -793.3690122543371, -70.21373215469279, -1060.818076385736, -211.31190117094246, -61.53898110244333, -742.6517486071185, -101.79660283336845, -775.7913045172658, -1300.417483219029, -507.724510144185, -1151.6440670053166, -1006.7558841347691, -475.6073686480903, -417.78799172330946, -185.68009354852222, -1085.838192031046, -1183.6480307101144, -369.6504309906089, -272.2048341588962, -984.1546026152607, -1278.7368631288048, -1225.2809749756684, -182.574187085924, -559.5150893666273, -896.0932464267264, -224.58659623517295, -126.3223282861266, -536.8757654413338, -154.7432166299741, -948.3326469245997, -613.4106617461154, -1294.7204793431558, -1182.7789813829663, -335.4862989645831, -1176.7411348160756, -564.208006368441, -102.7286031824161, -951.0923468401705, -209.82685236633955, -198.59062189735667, -934.7812876283629, -349.0232123342324, -1218.201156727239, -31.576199709570197, -661.5170886880376, -891.9617551083884, -203.6723004268227, -380.69401195964497, -1335.5621263005173, -418.4715580044891, -255.8526358915388, -915.4819256561093, -806.7889283470647, -1201.398238390362, -69.34400593773589, -1172.1879445288644, -203.7807431135754, -911.5799350147635, -1386.8430542870724, -1199.7764950621429, -568.64602486725, -1053.5722367986164, -1046.5589036108868, -1031.9062907030811, -924.6132266177277, -1022.4558154870363, -261.86543234407554, -180.67897322958052, -187.1239992024833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5583875453946147, "mean_inference_ms": 1.6720968389557604, "mean_action_processing_ms": 0.27977941484885316, "mean_env_wait_ms": 3.445064652077983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012707948684692383, "StateBufferConnector_ms": 0.007947206497192383, "ViewRequirementAgentConnector_ms": 0.1963334083557129}, "num_episodes": 29, "episode_return_max": -31.576199709570197, "episode_return_min": -1386.8430542870724, "episode_return_mean": -682.8725394171928, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.14838909905393, "num_env_steps_trained_throughput_per_sec": 335.14838909905393, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12717.507, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12717.44, "sample_time_ms": 1116.191, "learn_time_ms": 11528.905, "learn_throughput": 346.954, "synch_weights_time_ms": 71.556}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1e132_00005", "date": "2024-08-04_08-18-12", "timestamp": 1722739692, "time_this_iter_s": 11.94806432723999, "time_total_s": 114.57202315330505, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d354134040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.57202315330505, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.752941176470586, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.02579224308332, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 2.688042803729574, "policy_loss": -0.010003609433382129, "vf_loss": 2.6953060140212375, "vf_explained_var": 0.9831115250165264, "kl": 0.014550925386993185, "entropy": 1.6977397434413433, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -15.004850177195891, "episode_reward_min": -1484.165705488273, "episode_reward_mean": -733.1800324703902, "episode_len_mean": 126.86, "episode_media": {}, "episodes_timesteps_total": 12686, "policy_reward_min": {"policy_0": -1484.165705488273}, "policy_reward_max": {"policy_0": -15.004850177195891}, "policy_reward_mean": {"policy_0": -733.1800324703902}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.53898110244333, -742.6517486071185, -101.79660283336845, -775.7913045172658, -1300.417483219029, -507.724510144185, -1151.6440670053166, -1006.7558841347691, -475.6073686480903, -417.78799172330946, -185.68009354852222, -1085.838192031046, -1183.6480307101144, -369.6504309906089, -272.2048341588962, -984.1546026152607, -1278.7368631288048, -1225.2809749756684, -182.574187085924, -559.5150893666273, -896.0932464267264, -224.58659623517295, -126.3223282861266, -536.8757654413338, -154.7432166299741, -948.3326469245997, -613.4106617461154, -1294.7204793431558, -1182.7789813829663, -335.4862989645831, -1176.7411348160756, -564.208006368441, -102.7286031824161, -951.0923468401705, -209.82685236633955, -198.59062189735667, -934.7812876283629, -349.0232123342324, -1218.201156727239, -31.576199709570197, -661.5170886880376, -891.9617551083884, -203.6723004268227, -380.69401195964497, -1335.5621263005173, -418.4715580044891, -255.8526358915388, -915.4819256561093, -806.7889283470647, -1201.398238390362, -69.34400593773589, -1172.1879445288644, -203.7807431135754, -911.5799350147635, -1386.8430542870724, -1199.7764950621429, -568.64602486725, -1053.5722367986164, -1046.5589036108868, -1031.9062907030811, -924.6132266177277, -1022.4558154870363, -261.86543234407554, -180.67897322958052, -187.1239992024833, -1042.6806982592475, -1336.7730944760365, -1484.165705488273, -576.7777466296884, -302.374813753917, -15.004850177195891, -1318.947190166202, -478.90872693310615, -1325.8824808036445, -367.08668919134436, -891.1171735981175, -221.77758916938677, -24.547028930218595, -1203.6326596933175, -678.4035960921001, -1383.0810123146125, -1295.1442286845465, -1279.2028986028324, -470.66267233063627, -804.9061595700693, -1094.0680017235004, -1051.7095478921462, -282.15849460188684, -167.454311720466, -1269.043205484116, -1107.8132865230898, -879.7646543022402, -212.60201685591736, -415.0807257311743, -820.4767267461899, -953.5821755429126, -1259.1757737934997, -925.3719023891773, -1213.2911570859799, -953.8817184070224], "episode_lengths": [66, 150, 47, 150, 150, 141, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 81, 70, 113, 64, 150, 119, 150, 150, 93, 150, 150, 78, 150, 78, 77, 150, 109, 150, 44, 150, 150, 103, 107, 150, 104, 92, 150, 150, 150, 57, 150, 67, 150, 150, 150, 120, 150, 150, 150, 150, 150, 82, 93, 77, 150, 150, 150, 117, 94, 37, 150, 150, 150, 129, 150, 77, 41, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 59, 150, 150, 150, 91, 99, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-61.53898110244333, -742.6517486071185, -101.79660283336845, -775.7913045172658, -1300.417483219029, -507.724510144185, -1151.6440670053166, -1006.7558841347691, -475.6073686480903, -417.78799172330946, -185.68009354852222, -1085.838192031046, -1183.6480307101144, -369.6504309906089, -272.2048341588962, -984.1546026152607, -1278.7368631288048, -1225.2809749756684, -182.574187085924, -559.5150893666273, -896.0932464267264, -224.58659623517295, -126.3223282861266, -536.8757654413338, -154.7432166299741, -948.3326469245997, -613.4106617461154, -1294.7204793431558, -1182.7789813829663, -335.4862989645831, -1176.7411348160756, -564.208006368441, -102.7286031824161, -951.0923468401705, -209.82685236633955, -198.59062189735667, -934.7812876283629, -349.0232123342324, -1218.201156727239, -31.576199709570197, -661.5170886880376, -891.9617551083884, -203.6723004268227, -380.69401195964497, -1335.5621263005173, -418.4715580044891, -255.8526358915388, -915.4819256561093, -806.7889283470647, -1201.398238390362, -69.34400593773589, -1172.1879445288644, -203.7807431135754, -911.5799350147635, -1386.8430542870724, -1199.7764950621429, -568.64602486725, -1053.5722367986164, -1046.5589036108868, -1031.9062907030811, -924.6132266177277, -1022.4558154870363, -261.86543234407554, -180.67897322958052, -187.1239992024833, -1042.6806982592475, -1336.7730944760365, -1484.165705488273, -576.7777466296884, -302.374813753917, -15.004850177195891, -1318.947190166202, -478.90872693310615, -1325.8824808036445, -367.08668919134436, -891.1171735981175, -221.77758916938677, -24.547028930218595, -1203.6326596933175, -678.4035960921001, -1383.0810123146125, -1295.1442286845465, -1279.2028986028324, -470.66267233063627, -804.9061595700693, -1094.0680017235004, -1051.7095478921462, -282.15849460188684, -167.454311720466, -1269.043205484116, -1107.8132865230898, -879.7646543022402, -212.60201685591736, -415.0807257311743, -820.4767267461899, -953.5821755429126, -1259.1757737934997, -925.3719023891773, -1213.2911570859799, -953.8817184070224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565990243301289, "mean_inference_ms": 1.6711040772705876, "mean_action_processing_ms": 0.27886942839027684, "mean_env_wait_ms": 3.452221482111983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012652397155761719, "StateBufferConnector_ms": 0.007944107055664062, "ViewRequirementAgentConnector_ms": 0.19670939445495605}, "num_episodes": 35, "episode_return_max": -15.004850177195891, "episode_return_min": -1484.165705488273, "episode_return_mean": -733.1800324703902, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6284247791992, "num_env_steps_trained_throughput_per_sec": 307.6284247791992, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12746.027, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12745.961, "sample_time_ms": 1116.609, "learn_time_ms": 11557.826, "learn_throughput": 346.086, "synch_weights_time_ms": 70.739}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1e132_00005", "date": "2024-08-04_08-18-25", "timestamp": 1722739705, "time_this_iter_s": 13.014717102050781, "time_total_s": 127.58674025535583, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.58674025535583, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.333333333333332, "ram_util_percent": 28.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 213.36528732776642, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 2.1247287306934597, "policy_loss": -0.0074608683547315495, "vf_loss": 2.129848852256934, "vf_explained_var": 0.9774653708562255, "kl": 0.01254108440410467, "entropy": 1.674709322055181, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -15.004850177195891, "episode_reward_min": -1484.165705488273, "episode_reward_mean": -764.0683636651171, "episode_len_mean": 128.3, "episode_media": {}, "episodes_timesteps_total": 12830, "policy_reward_min": {"policy_0": -1484.165705488273}, "policy_reward_max": {"policy_0": -15.004850177195891}, "policy_reward_mean": {"policy_0": -764.0683636651171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335.4862989645831, -1176.7411348160756, -564.208006368441, -102.7286031824161, -951.0923468401705, -209.82685236633955, -198.59062189735667, -934.7812876283629, -349.0232123342324, -1218.201156727239, -31.576199709570197, -661.5170886880376, -891.9617551083884, -203.6723004268227, -380.69401195964497, -1335.5621263005173, -418.4715580044891, -255.8526358915388, -915.4819256561093, -806.7889283470647, -1201.398238390362, -69.34400593773589, -1172.1879445288644, -203.7807431135754, -911.5799350147635, -1386.8430542870724, -1199.7764950621429, -568.64602486725, -1053.5722367986164, -1046.5589036108868, -1031.9062907030811, -924.6132266177277, -1022.4558154870363, -261.86543234407554, -180.67897322958052, -187.1239992024833, -1042.6806982592475, -1336.7730944760365, -1484.165705488273, -576.7777466296884, -302.374813753917, -15.004850177195891, -1318.947190166202, -478.90872693310615, -1325.8824808036445, -367.08668919134436, -891.1171735981175, -221.77758916938677, -24.547028930218595, -1203.6326596933175, -678.4035960921001, -1383.0810123146125, -1295.1442286845465, -1279.2028986028324, -470.66267233063627, -804.9061595700693, -1094.0680017235004, -1051.7095478921462, -282.15849460188684, -167.454311720466, -1269.043205484116, -1107.8132865230898, -879.7646543022402, -212.60201685591736, -415.0807257311743, -820.4767267461899, -953.5821755429126, -1259.1757737934997, -925.3719023891773, -1213.2911570859799, -953.8817184070224, -416.99898866818234, -402.549430594101, -1393.8093025822418, -1124.8757338022317, -1051.20471272326, -88.52476347159542, -303.0076792128342, -487.5039934818699, -775.6356911409546, -1021.1097811583393, -1052.9678968466571, -1039.2881680643093, -891.3679425425447, -60.31138874118045, -783.7069359105255, -959.7423887054792, -555.7704367352909, -936.7712020391712, -1183.563457511349, -962.4511139170934, -216.7942075434605, -1005.5012050142127, -973.6099960823824, -1033.8032337203665, -512.6170214840281, -875.360425286157, -847.6281313851832, -1308.5193709500566, -670.7016831201862], "episode_lengths": [93, 150, 150, 78, 150, 78, 77, 150, 109, 150, 44, 150, 150, 103, 107, 150, 104, 92, 150, 150, 150, 57, 150, 67, 150, 150, 150, 120, 150, 150, 150, 150, 150, 82, 93, 77, 150, 150, 150, 117, 94, 37, 150, 150, 150, 129, 150, 77, 41, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 59, 150, 150, 150, 91, 99, 150, 150, 150, 150, 150, 150, 96, 101, 150, 150, 150, 70, 82, 108, 150, 150, 150, 150, 150, 45, 142, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 138, 150, 150], "policy_policy_0_reward": [-335.4862989645831, -1176.7411348160756, -564.208006368441, -102.7286031824161, -951.0923468401705, -209.82685236633955, -198.59062189735667, -934.7812876283629, -349.0232123342324, -1218.201156727239, -31.576199709570197, -661.5170886880376, -891.9617551083884, -203.6723004268227, -380.69401195964497, -1335.5621263005173, -418.4715580044891, -255.8526358915388, -915.4819256561093, -806.7889283470647, -1201.398238390362, -69.34400593773589, -1172.1879445288644, -203.7807431135754, -911.5799350147635, -1386.8430542870724, -1199.7764950621429, -568.64602486725, -1053.5722367986164, -1046.5589036108868, -1031.9062907030811, -924.6132266177277, -1022.4558154870363, -261.86543234407554, -180.67897322958052, -187.1239992024833, -1042.6806982592475, -1336.7730944760365, -1484.165705488273, -576.7777466296884, -302.374813753917, -15.004850177195891, -1318.947190166202, -478.90872693310615, -1325.8824808036445, -367.08668919134436, -891.1171735981175, -221.77758916938677, -24.547028930218595, -1203.6326596933175, -678.4035960921001, -1383.0810123146125, -1295.1442286845465, -1279.2028986028324, -470.66267233063627, -804.9061595700693, -1094.0680017235004, -1051.7095478921462, -282.15849460188684, -167.454311720466, -1269.043205484116, -1107.8132865230898, -879.7646543022402, -212.60201685591736, -415.0807257311743, -820.4767267461899, -953.5821755429126, -1259.1757737934997, -925.3719023891773, -1213.2911570859799, -953.8817184070224, -416.99898866818234, -402.549430594101, -1393.8093025822418, -1124.8757338022317, -1051.20471272326, -88.52476347159542, -303.0076792128342, -487.5039934818699, -775.6356911409546, -1021.1097811583393, -1052.9678968466571, -1039.2881680643093, -891.3679425425447, -60.31138874118045, -783.7069359105255, -959.7423887054792, -555.7704367352909, -936.7712020391712, -1183.563457511349, -962.4511139170934, -216.7942075434605, -1005.5012050142127, -973.6099960823824, -1033.8032337203665, -512.6170214840281, -875.360425286157, -847.6281313851832, -1308.5193709500566, -670.7016831201862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555411649289776, "mean_inference_ms": 1.6687756276245214, "mean_action_processing_ms": 0.2780103452694441, "mean_env_wait_ms": 3.456638537417638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012422323226928711, "StateBufferConnector_ms": 0.007892370223999023, "ViewRequirementAgentConnector_ms": 0.192183256149292}, "num_episodes": 29, "episode_return_max": -15.004850177195891, "episode_return_min": -1484.165705488273, "episode_return_mean": -764.0683636651171, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.02035788481606, "num_env_steps_trained_throughput_per_sec": 304.02035788481606, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12949.455, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12949.386, "sample_time_ms": 1118.619, "learn_time_ms": 11759.309, "learn_throughput": 340.156, "synch_weights_time_ms": 70.659}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1e132_00005", "date": "2024-08-04_08-18-38", "timestamp": 1722739718, "time_this_iter_s": 13.170804500579834, "time_total_s": 140.75754475593567, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344737880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.75754475593567, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.942105263157895, "ram_util_percent": 28.21578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.9337998330593, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 2.1264968823641537, "policy_loss": -0.00663205577050879, "vf_loss": 2.1306005875890452, "vf_explained_var": 0.9801309191311399, "kl": 0.013474636049371243, "entropy": 1.6657565931479137, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -15.004850177195891, "episode_reward_min": -1484.165705488273, "episode_reward_mean": -792.259844184568, "episode_len_mean": 131.66, "episode_media": {}, "episodes_timesteps_total": 13166, "policy_reward_min": {"policy_0": -1484.165705488273}, "policy_reward_max": {"policy_0": -15.004850177195891}, "policy_reward_mean": {"policy_0": -792.259844184568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1053.5722367986164, -1046.5589036108868, -1031.9062907030811, -924.6132266177277, -1022.4558154870363, -261.86543234407554, -180.67897322958052, -187.1239992024833, -1042.6806982592475, -1336.7730944760365, -1484.165705488273, -576.7777466296884, -302.374813753917, -15.004850177195891, -1318.947190166202, -478.90872693310615, -1325.8824808036445, -367.08668919134436, -891.1171735981175, -221.77758916938677, -24.547028930218595, -1203.6326596933175, -678.4035960921001, -1383.0810123146125, -1295.1442286845465, -1279.2028986028324, -470.66267233063627, -804.9061595700693, -1094.0680017235004, -1051.7095478921462, -282.15849460188684, -167.454311720466, -1269.043205484116, -1107.8132865230898, -879.7646543022402, -212.60201685591736, -415.0807257311743, -820.4767267461899, -953.5821755429126, -1259.1757737934997, -925.3719023891773, -1213.2911570859799, -953.8817184070224, -416.99898866818234, -402.549430594101, -1393.8093025822418, -1124.8757338022317, -1051.20471272326, -88.52476347159542, -303.0076792128342, -487.5039934818699, -775.6356911409546, -1021.1097811583393, -1052.9678968466571, -1039.2881680643093, -891.3679425425447, -60.31138874118045, -783.7069359105255, -959.7423887054792, -555.7704367352909, -936.7712020391712, -1183.563457511349, -962.4511139170934, -216.7942075434605, -1005.5012050142127, -973.6099960823824, -1033.8032337203665, -512.6170214840281, -875.360425286157, -847.6281313851832, -1308.5193709500566, -670.7016831201862, -1128.1015094910206, -911.2719701669411, -1276.4833564939152, -233.56580476559006, -1394.063754768536, -1107.7219233753644, -1319.4241411771563, -1121.1911466498484, -959.0359013539138, -410.32930876827726, -939.8915791144502, -572.3875891260105, -404.9620299713476, -1008.8735112652561, -1048.4205419483335, -391.44077939784097, -440.34667163890725, -443.67070656365945, -986.4207073947624, -353.143993473467, -628.1752753061071, -239.20885557408482, -1151.210659343526, -579.201161194773, -79.34614024809257, -968.3173529589345, -1311.0456105158303, -67.71056231829566], "episode_lengths": [150, 150, 150, 150, 150, 82, 93, 77, 150, 150, 150, 117, 94, 37, 150, 150, 150, 129, 150, 77, 41, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 59, 150, 150, 150, 91, 99, 150, 150, 150, 150, 150, 150, 96, 101, 150, 150, 150, 70, 82, 108, 150, 150, 150, 150, 150, 45, 142, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 128, 150, 121, 139, 150, 150, 150, 139, 100, 150, 137, 129, 80, 150, 150, 48, 150, 150, 66], "policy_policy_0_reward": [-1053.5722367986164, -1046.5589036108868, -1031.9062907030811, -924.6132266177277, -1022.4558154870363, -261.86543234407554, -180.67897322958052, -187.1239992024833, -1042.6806982592475, -1336.7730944760365, -1484.165705488273, -576.7777466296884, -302.374813753917, -15.004850177195891, -1318.947190166202, -478.90872693310615, -1325.8824808036445, -367.08668919134436, -891.1171735981175, -221.77758916938677, -24.547028930218595, -1203.6326596933175, -678.4035960921001, -1383.0810123146125, -1295.1442286845465, -1279.2028986028324, -470.66267233063627, -804.9061595700693, -1094.0680017235004, -1051.7095478921462, -282.15849460188684, -167.454311720466, -1269.043205484116, -1107.8132865230898, -879.7646543022402, -212.60201685591736, -415.0807257311743, -820.4767267461899, -953.5821755429126, -1259.1757737934997, -925.3719023891773, -1213.2911570859799, -953.8817184070224, -416.99898866818234, -402.549430594101, -1393.8093025822418, -1124.8757338022317, -1051.20471272326, -88.52476347159542, -303.0076792128342, -487.5039934818699, -775.6356911409546, -1021.1097811583393, -1052.9678968466571, -1039.2881680643093, -891.3679425425447, -60.31138874118045, -783.7069359105255, -959.7423887054792, -555.7704367352909, -936.7712020391712, -1183.563457511349, -962.4511139170934, -216.7942075434605, -1005.5012050142127, -973.6099960823824, -1033.8032337203665, -512.6170214840281, -875.360425286157, -847.6281313851832, -1308.5193709500566, -670.7016831201862, -1128.1015094910206, -911.2719701669411, -1276.4833564939152, -233.56580476559006, -1394.063754768536, -1107.7219233753644, -1319.4241411771563, -1121.1911466498484, -959.0359013539138, -410.32930876827726, -939.8915791144502, -572.3875891260105, -404.9620299713476, -1008.8735112652561, -1048.4205419483335, -391.44077939784097, -440.34667163890725, -443.67070656365945, -986.4207073947624, -353.143993473467, -628.1752753061071, -239.20885557408482, -1151.210659343526, -579.201161194773, -79.34614024809257, -968.3173529589345, -1311.0456105158303, -67.71056231829566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546531799910766, "mean_inference_ms": 1.6675981866098957, "mean_action_processing_ms": 0.27753383630298695, "mean_env_wait_ms": 3.4626741356540243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012453794479370117, "StateBufferConnector_ms": 0.007852554321289062, "ViewRequirementAgentConnector_ms": 0.19259333610534668}, "num_episodes": 28, "episode_return_max": -15.004850177195891, "episode_return_min": -1484.165705488273, "episode_return_mean": -792.259844184568, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.0395260656781, "num_env_steps_trained_throughput_per_sec": 310.0395260656781, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12919.418, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12919.348, "sample_time_ms": 1122.718, "learn_time_ms": 11724.694, "learn_throughput": 341.16, "synch_weights_time_ms": 71.142}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1e132_00005", "date": "2024-08-04_08-18-51", "timestamp": 1722739731, "time_this_iter_s": 12.91292667388916, "time_total_s": 153.67047142982483, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447b8e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.67047142982483, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.92105263157895, "ram_util_percent": 28.284210526315793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.593666857481, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 2.2041420264790457, "policy_loss": -0.009303905466610255, "vf_loss": 2.210725883767009, "vf_explained_var": 0.9804928068692486, "kl": 0.014474232523919757, "entropy": 1.7478210726131995, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -1.4435175392410025, "episode_reward_min": -1394.063754768536, "episode_reward_mean": -787.0624428915119, "episode_len_mean": 132.84, "episode_media": {}, "episodes_timesteps_total": 13284, "policy_reward_min": {"policy_0": -1394.063754768536}, "policy_reward_max": {"policy_0": -1.4435175392410025}, "policy_reward_mean": {"policy_0": -787.0624428915119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1094.0680017235004, -1051.7095478921462, -282.15849460188684, -167.454311720466, -1269.043205484116, -1107.8132865230898, -879.7646543022402, -212.60201685591736, -415.0807257311743, -820.4767267461899, -953.5821755429126, -1259.1757737934997, -925.3719023891773, -1213.2911570859799, -953.8817184070224, -416.99898866818234, -402.549430594101, -1393.8093025822418, -1124.8757338022317, -1051.20471272326, -88.52476347159542, -303.0076792128342, -487.5039934818699, -775.6356911409546, -1021.1097811583393, -1052.9678968466571, -1039.2881680643093, -891.3679425425447, -60.31138874118045, -783.7069359105255, -959.7423887054792, -555.7704367352909, -936.7712020391712, -1183.563457511349, -962.4511139170934, -216.7942075434605, -1005.5012050142127, -973.6099960823824, -1033.8032337203665, -512.6170214840281, -875.360425286157, -847.6281313851832, -1308.5193709500566, -670.7016831201862, -1128.1015094910206, -911.2719701669411, -1276.4833564939152, -233.56580476559006, -1394.063754768536, -1107.7219233753644, -1319.4241411771563, -1121.1911466498484, -959.0359013539138, -410.32930876827726, -939.8915791144502, -572.3875891260105, -404.9620299713476, -1008.8735112652561, -1048.4205419483335, -391.44077939784097, -440.34667163890725, -443.67070656365945, -986.4207073947624, -353.143993473467, -628.1752753061071, -239.20885557408482, -1151.210659343526, -579.201161194773, -79.34614024809257, -968.3173529589345, -1311.0456105158303, -67.71056231829566, -473.02782439967854, -743.0150423375898, -845.8639295384006, -195.49410362436706, -1142.1407217444155, -1165.8992408116214, -1219.5539932028912, -512.113102639499, -518.05538049717, -480.7168950905138, -1073.0715506679273, -1178.7749662724052, -879.5393590338157, -858.5513824640626, -282.19644548363027, -1.4435175392410025, -280.79114724275087, -685.8902626062307, -1246.4200151876248, -881.3431404454866, -867.7271958547733, -1203.0815850442725, -32.86753090699696, -402.83738459196275, -1255.841573598528, -1099.4489415729101, -1188.533470203868, -975.87206094975], "episode_lengths": [150, 150, 97, 59, 150, 150, 150, 91, 99, 150, 150, 150, 150, 150, 150, 96, 101, 150, 150, 150, 70, 82, 108, 150, 150, 150, 150, 150, 45, 142, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 128, 150, 121, 139, 150, 150, 150, 139, 100, 150, 137, 129, 80, 150, 150, 48, 150, 150, 66, 109, 150, 150, 73, 150, 150, 150, 150, 133, 127, 150, 150, 150, 150, 114, 30, 112, 150, 150, 148, 150, 150, 52, 117, 150, 150, 150, 150], "policy_policy_0_reward": [-1094.0680017235004, -1051.7095478921462, -282.15849460188684, -167.454311720466, -1269.043205484116, -1107.8132865230898, -879.7646543022402, -212.60201685591736, -415.0807257311743, -820.4767267461899, -953.5821755429126, -1259.1757737934997, -925.3719023891773, -1213.2911570859799, -953.8817184070224, -416.99898866818234, -402.549430594101, -1393.8093025822418, -1124.8757338022317, -1051.20471272326, -88.52476347159542, -303.0076792128342, -487.5039934818699, -775.6356911409546, -1021.1097811583393, -1052.9678968466571, -1039.2881680643093, -891.3679425425447, -60.31138874118045, -783.7069359105255, -959.7423887054792, -555.7704367352909, -936.7712020391712, -1183.563457511349, -962.4511139170934, -216.7942075434605, -1005.5012050142127, -973.6099960823824, -1033.8032337203665, -512.6170214840281, -875.360425286157, -847.6281313851832, -1308.5193709500566, -670.7016831201862, -1128.1015094910206, -911.2719701669411, -1276.4833564939152, -233.56580476559006, -1394.063754768536, -1107.7219233753644, -1319.4241411771563, -1121.1911466498484, -959.0359013539138, -410.32930876827726, -939.8915791144502, -572.3875891260105, -404.9620299713476, -1008.8735112652561, -1048.4205419483335, -391.44077939784097, -440.34667163890725, -443.67070656365945, -986.4207073947624, -353.143993473467, -628.1752753061071, -239.20885557408482, -1151.210659343526, -579.201161194773, -79.34614024809257, -968.3173529589345, -1311.0456105158303, -67.71056231829566, -473.02782439967854, -743.0150423375898, -845.8639295384006, -195.49410362436706, -1142.1407217444155, -1165.8992408116214, -1219.5539932028912, -512.113102639499, -518.05538049717, -480.7168950905138, -1073.0715506679273, -1178.7749662724052, -879.5393590338157, -858.5513824640626, -282.19644548363027, -1.4435175392410025, -280.79114724275087, -685.8902626062307, -1246.4200151876248, -881.3431404454866, -867.7271958547733, -1203.0815850442725, -32.86753090699696, -402.83738459196275, -1255.841573598528, -1099.4489415729101, -1188.533470203868, -975.87206094975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537978997997693, "mean_inference_ms": 1.6672689018155946, "mean_action_processing_ms": 0.2773997434721427, "mean_env_wait_ms": 3.4699089308516657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012449979782104492, "StateBufferConnector_ms": 0.007917165756225586, "ViewRequirementAgentConnector_ms": 0.1958150863647461}, "num_episodes": 28, "episode_return_max": -1.4435175392410025, "episode_return_min": -1394.063754768536, "episode_return_mean": -787.0624428915119, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.65609637931533, "num_env_steps_trained_throughput_per_sec": 300.65609637931533, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12929.622, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12929.553, "sample_time_ms": 1138.796, "learn_time_ms": 11718.091, "learn_throughput": 341.353, "synch_weights_time_ms": 71.871}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1e132_00005", "date": "2024-08-04_08-19-05", "timestamp": 1722739745, "time_this_iter_s": 13.317302227020264, "time_total_s": 166.9877736568451, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344737f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.9877736568451, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.03684210526316, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 214.57841667135557, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 2.063569663092494, "policy_loss": -0.003484509182938685, "vf_loss": 2.0648966669415434, "vf_explained_var": 0.9834215893720587, "kl": 0.01168107360611734, "entropy": 1.7870974154522021, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -1.4435175392410025, "episode_reward_min": -1462.8075215651356, "episode_reward_mean": -809.717687431116, "episode_len_mean": 136.48, "episode_media": {}, "episodes_timesteps_total": 13648, "policy_reward_min": {"policy_0": -1462.8075215651356}, "policy_reward_max": {"policy_0": -1.4435175392410025}, "policy_reward_mean": {"policy_0": -809.717687431116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-555.7704367352909, -936.7712020391712, -1183.563457511349, -962.4511139170934, -216.7942075434605, -1005.5012050142127, -973.6099960823824, -1033.8032337203665, -512.6170214840281, -875.360425286157, -847.6281313851832, -1308.5193709500566, -670.7016831201862, -1128.1015094910206, -911.2719701669411, -1276.4833564939152, -233.56580476559006, -1394.063754768536, -1107.7219233753644, -1319.4241411771563, -1121.1911466498484, -959.0359013539138, -410.32930876827726, -939.8915791144502, -572.3875891260105, -404.9620299713476, -1008.8735112652561, -1048.4205419483335, -391.44077939784097, -440.34667163890725, -443.67070656365945, -986.4207073947624, -353.143993473467, -628.1752753061071, -239.20885557408482, -1151.210659343526, -579.201161194773, -79.34614024809257, -968.3173529589345, -1311.0456105158303, -67.71056231829566, -473.02782439967854, -743.0150423375898, -845.8639295384006, -195.49410362436706, -1142.1407217444155, -1165.8992408116214, -1219.5539932028912, -512.113102639499, -518.05538049717, -480.7168950905138, -1073.0715506679273, -1178.7749662724052, -879.5393590338157, -858.5513824640626, -282.19644548363027, -1.4435175392410025, -280.79114724275087, -685.8902626062307, -1246.4200151876248, -881.3431404454866, -867.7271958547733, -1203.0815850442725, -32.86753090699696, -402.83738459196275, -1255.841573598528, -1099.4489415729101, -1188.533470203868, -975.87206094975, -618.886284166004, -404.5440791489524, -1462.8075215651356, -1058.491267225263, -290.0573712929676, -1150.4214282847545, -1018.0903598627273, -713.0311185371811, -1418.9419446989214, -75.51072404841244, -555.0633836722537, -786.1686129165821, -1048.9191456925303, -650.6435609332991, -1331.4247066965481, -986.8132227638614, -678.1089057267488, -1138.9439912046653, -345.98670457679685, -170.80082383951623, -491.86902623877154, -1045.7458535230442, -1288.2607018370165, -1413.7693709715768, -773.1067270652187, -363.9443529771147, -1072.8719438262967, -1141.8918372206126, -813.150834633341, -1056.5554550492427, -1358.781690210695], "episode_lengths": [150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 128, 150, 121, 139, 150, 150, 150, 139, 100, 150, 137, 129, 80, 150, 150, 48, 150, 150, 66, 109, 150, 150, 73, 150, 150, 150, 150, 133, 127, 150, 150, 150, 150, 114, 30, 112, 150, 150, 148, 150, 150, 52, 117, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 51, 121, 150, 150, 137, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-555.7704367352909, -936.7712020391712, -1183.563457511349, -962.4511139170934, -216.7942075434605, -1005.5012050142127, -973.6099960823824, -1033.8032337203665, -512.6170214840281, -875.360425286157, -847.6281313851832, -1308.5193709500566, -670.7016831201862, -1128.1015094910206, -911.2719701669411, -1276.4833564939152, -233.56580476559006, -1394.063754768536, -1107.7219233753644, -1319.4241411771563, -1121.1911466498484, -959.0359013539138, -410.32930876827726, -939.8915791144502, -572.3875891260105, -404.9620299713476, -1008.8735112652561, -1048.4205419483335, -391.44077939784097, -440.34667163890725, -443.67070656365945, -986.4207073947624, -353.143993473467, -628.1752753061071, -239.20885557408482, -1151.210659343526, -579.201161194773, -79.34614024809257, -968.3173529589345, -1311.0456105158303, -67.71056231829566, -473.02782439967854, -743.0150423375898, -845.8639295384006, -195.49410362436706, -1142.1407217444155, -1165.8992408116214, -1219.5539932028912, -512.113102639499, -518.05538049717, -480.7168950905138, -1073.0715506679273, -1178.7749662724052, -879.5393590338157, -858.5513824640626, -282.19644548363027, -1.4435175392410025, -280.79114724275087, -685.8902626062307, -1246.4200151876248, -881.3431404454866, -867.7271958547733, -1203.0815850442725, -32.86753090699696, -402.83738459196275, -1255.841573598528, -1099.4489415729101, -1188.533470203868, -975.87206094975, -618.886284166004, -404.5440791489524, -1462.8075215651356, -1058.491267225263, -290.0573712929676, -1150.4214282847545, -1018.0903598627273, -713.0311185371811, -1418.9419446989214, -75.51072404841244, -555.0633836722537, -786.1686129165821, -1048.9191456925303, -650.6435609332991, -1331.4247066965481, -986.8132227638614, -678.1089057267488, -1138.9439912046653, -345.98670457679685, -170.80082383951623, -491.86902623877154, -1045.7458535230442, -1288.2607018370165, -1413.7693709715768, -773.1067270652187, -363.9443529771147, -1072.8719438262967, -1141.8918372206126, -813.150834633341, -1056.5554550492427, -1358.781690210695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535714449634657, "mean_inference_ms": 1.668838134177638, "mean_action_processing_ms": 0.2771000432571831, "mean_env_wait_ms": 3.481011266821235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012071609497070312, "StateBufferConnector_ms": 0.007860898971557617, "ViewRequirementAgentConnector_ms": 0.19536232948303223}, "num_episodes": 31, "episode_return_max": -1.4435175392410025, "episode_return_min": -1462.8075215651356, "episode_return_mean": -809.717687431116, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.47889775310256, "num_env_steps_trained_throughput_per_sec": 313.47889775310256, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12897.619, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12897.55, "sample_time_ms": 1144.002, "learn_time_ms": 11680.57, "learn_throughput": 342.449, "synch_weights_time_ms": 72.184}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1e132_00005", "date": "2024-08-04_08-19-18", "timestamp": 1722739758, "time_this_iter_s": 12.772917747497559, "time_total_s": 179.76069140434265, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344736170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.76069140434265, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.155555555555555, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.10806966821352, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 2.062412460024158, "policy_loss": -0.004898247589638535, "vf_loss": 2.064845052609841, "vf_explained_var": 0.9884930158033967, "kl": 0.013110008572963745, "entropy": 1.5633957891414563, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -1.4435175392410025, "episode_reward_min": -1491.5060412345572, "episode_reward_mean": -788.2777924545146, "episode_len_mean": 133.9, "episode_media": {}, "episodes_timesteps_total": 13390, "policy_reward_min": {"policy_0": -1491.5060412345572}, "policy_reward_max": {"policy_0": -1.4435175392410025}, "policy_reward_mean": {"policy_0": -788.2777924545146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1151.210659343526, -579.201161194773, -79.34614024809257, -968.3173529589345, -1311.0456105158303, -67.71056231829566, -473.02782439967854, -743.0150423375898, -845.8639295384006, -195.49410362436706, -1142.1407217444155, -1165.8992408116214, -1219.5539932028912, -512.113102639499, -518.05538049717, -480.7168950905138, -1073.0715506679273, -1178.7749662724052, -879.5393590338157, -858.5513824640626, -282.19644548363027, -1.4435175392410025, -280.79114724275087, -685.8902626062307, -1246.4200151876248, -881.3431404454866, -867.7271958547733, -1203.0815850442725, -32.86753090699696, -402.83738459196275, -1255.841573598528, -1099.4489415729101, -1188.533470203868, -975.87206094975, -618.886284166004, -404.5440791489524, -1462.8075215651356, -1058.491267225263, -290.0573712929676, -1150.4214282847545, -1018.0903598627273, -713.0311185371811, -1418.9419446989214, -75.51072404841244, -555.0633836722537, -786.1686129165821, -1048.9191456925303, -650.6435609332991, -1331.4247066965481, -986.8132227638614, -678.1089057267488, -1138.9439912046653, -345.98670457679685, -170.80082383951623, -491.86902623877154, -1045.7458535230442, -1288.2607018370165, -1413.7693709715768, -773.1067270652187, -363.9443529771147, -1072.8719438262967, -1141.8918372206126, -813.150834633341, -1056.5554550492427, -1358.781690210695, -1107.6250674399835, -1100.19786162854, -757.8639558581202, -838.6468618620471, -313.7643402475701, -1082.1844450665233, -1491.5060412345572, -483.82304301182353, -137.08641600823387, -1111.2364365064695, -244.87877786758727, -214.92083359846382, -1005.5878247231541, -534.7502816101642, -1419.7017251210318, -267.26663990445957, -894.2244494195129, -1078.0037352415543, -487.31282217564643, -1012.9407537068757, -465.9322355061716, -344.7151699675686, -1053.4801967644846, -122.26263252260303, -1353.3994654139333, -389.1725562141184, -1325.6571313541065, -395.2038248325159, -892.6755490151751, -1396.8096852066506, -445.47702833997215, -419.9276273504781, -137.33515193986176, -1154.571859509595, -777.0906187440198], "episode_lengths": [150, 150, 48, 150, 150, 66, 109, 150, 150, 73, 150, 150, 150, 150, 133, 127, 150, 150, 150, 150, 114, 30, 112, 150, 150, 148, 150, 150, 52, 117, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 51, 121, 150, 150, 137, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 108, 78, 150, 89, 63, 150, 150, 150, 112, 150, 150, 135, 150, 150, 114, 150, 81, 150, 148, 150, 110, 150, 150, 129, 127, 63, 150, 150], "policy_policy_0_reward": [-1151.210659343526, -579.201161194773, -79.34614024809257, -968.3173529589345, -1311.0456105158303, -67.71056231829566, -473.02782439967854, -743.0150423375898, -845.8639295384006, -195.49410362436706, -1142.1407217444155, -1165.8992408116214, -1219.5539932028912, -512.113102639499, -518.05538049717, -480.7168950905138, -1073.0715506679273, -1178.7749662724052, -879.5393590338157, -858.5513824640626, -282.19644548363027, -1.4435175392410025, -280.79114724275087, -685.8902626062307, -1246.4200151876248, -881.3431404454866, -867.7271958547733, -1203.0815850442725, -32.86753090699696, -402.83738459196275, -1255.841573598528, -1099.4489415729101, -1188.533470203868, -975.87206094975, -618.886284166004, -404.5440791489524, -1462.8075215651356, -1058.491267225263, -290.0573712929676, -1150.4214282847545, -1018.0903598627273, -713.0311185371811, -1418.9419446989214, -75.51072404841244, -555.0633836722537, -786.1686129165821, -1048.9191456925303, -650.6435609332991, -1331.4247066965481, -986.8132227638614, -678.1089057267488, -1138.9439912046653, -345.98670457679685, -170.80082383951623, -491.86902623877154, -1045.7458535230442, -1288.2607018370165, -1413.7693709715768, -773.1067270652187, -363.9443529771147, -1072.8719438262967, -1141.8918372206126, -813.150834633341, -1056.5554550492427, -1358.781690210695, -1107.6250674399835, -1100.19786162854, -757.8639558581202, -838.6468618620471, -313.7643402475701, -1082.1844450665233, -1491.5060412345572, -483.82304301182353, -137.08641600823387, -1111.2364365064695, -244.87877786758727, -214.92083359846382, -1005.5878247231541, -534.7502816101642, -1419.7017251210318, -267.26663990445957, -894.2244494195129, -1078.0037352415543, -487.31282217564643, -1012.9407537068757, -465.9322355061716, -344.7151699675686, -1053.4801967644846, -122.26263252260303, -1353.3994654139333, -389.1725562141184, -1325.6571313541065, -395.2038248325159, -892.6755490151751, -1396.8096852066506, -445.47702833997215, -419.9276273504781, -137.33515193986176, -1154.571859509595, -777.0906187440198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55336696826685, "mean_inference_ms": 1.669559664623722, "mean_action_processing_ms": 0.27691773713023193, "mean_env_wait_ms": 3.4886880777077147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012204647064208984, "StateBufferConnector_ms": 0.00795435905456543, "ViewRequirementAgentConnector_ms": 0.19521284103393555}, "num_episodes": 35, "episode_return_max": -1.4435175392410025, "episode_return_min": -1491.5060412345572, "episode_return_mean": -788.2777924545146, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.55114219879033, "num_env_steps_trained_throughput_per_sec": 293.55114219879033, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12982.817, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12982.747, "sample_time_ms": 1151.141, "learn_time_ms": 11760.685, "learn_throughput": 340.116, "synch_weights_time_ms": 70.119}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1e132_00005", "date": "2024-08-04_08-19-31", "timestamp": 1722739771, "time_this_iter_s": 13.63853669166565, "time_total_s": 193.3992280960083, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344737250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 193.3992280960083, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.026315789473685, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 201.1191117723783, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 2.0771200839430093, "policy_loss": -0.013004193237672249, "vf_loss": 2.086986530820529, "vf_explained_var": 0.9915565821652611, "kl": 0.016477880193269824, "entropy": 1.5782559608419737, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -2.4184427760900844, "episode_reward_min": -1491.5060412345572, "episode_reward_mean": -761.3516858190358, "episode_len_mean": 133.0, "episode_media": {}, "episodes_timesteps_total": 13300, "policy_reward_min": {"policy_0": -1491.5060412345572}, "policy_reward_max": {"policy_0": -2.4184427760900844}, "policy_reward_mean": {"policy_0": -761.3516858190358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-402.83738459196275, -1255.841573598528, -1099.4489415729101, -1188.533470203868, -975.87206094975, -618.886284166004, -404.5440791489524, -1462.8075215651356, -1058.491267225263, -290.0573712929676, -1150.4214282847545, -1018.0903598627273, -713.0311185371811, -1418.9419446989214, -75.51072404841244, -555.0633836722537, -786.1686129165821, -1048.9191456925303, -650.6435609332991, -1331.4247066965481, -986.8132227638614, -678.1089057267488, -1138.9439912046653, -345.98670457679685, -170.80082383951623, -491.86902623877154, -1045.7458535230442, -1288.2607018370165, -1413.7693709715768, -773.1067270652187, -363.9443529771147, -1072.8719438262967, -1141.8918372206126, -813.150834633341, -1056.5554550492427, -1358.781690210695, -1107.6250674399835, -1100.19786162854, -757.8639558581202, -838.6468618620471, -313.7643402475701, -1082.1844450665233, -1491.5060412345572, -483.82304301182353, -137.08641600823387, -1111.2364365064695, -244.87877786758727, -214.92083359846382, -1005.5878247231541, -534.7502816101642, -1419.7017251210318, -267.26663990445957, -894.2244494195129, -1078.0037352415543, -487.31282217564643, -1012.9407537068757, -465.9322355061716, -344.7151699675686, -1053.4801967644846, -122.26263252260303, -1353.3994654139333, -389.1725562141184, -1325.6571313541065, -395.2038248325159, -892.6755490151751, -1396.8096852066506, -445.47702833997215, -419.9276273504781, -137.33515193986176, -1154.571859509595, -777.0906187440198, -62.037027972446225, -309.85975914972653, -96.50846155191567, -1054.065717794697, -1162.9893196801556, -392.5808724053567, -2.4184427760900844, -837.7651102390105, -139.50204441364053, -1378.9043815716411, -1057.8108184660257, -885.7744927100007, -1089.4925440220657, -550.0333327286091, -844.324772268213, -1122.4683845640182, -349.27774257721387, -402.012416379974, -548.8489165879288, -302.65956107550744, -503.8711881363415, -654.9922039783835, -1382.6094112115086, -949.3297836765827, -88.50801050130978, -358.9700500453041, -41.39788482346741, -682.6853086749632, -980.1011956848384], "episode_lengths": [117, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 51, 121, 150, 150, 137, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 108, 78, 150, 89, 63, 150, 150, 150, 112, 150, 150, 135, 150, 150, 114, 150, 81, 150, 148, 150, 110, 150, 150, 129, 127, 63, 150, 150, 57, 133, 77, 150, 150, 142, 39, 150, 79, 150, 150, 150, 150, 143, 150, 150, 150, 125, 122, 122, 116, 150, 150, 150, 59, 108, 50, 150, 150], "policy_policy_0_reward": [-402.83738459196275, -1255.841573598528, -1099.4489415729101, -1188.533470203868, -975.87206094975, -618.886284166004, -404.5440791489524, -1462.8075215651356, -1058.491267225263, -290.0573712929676, -1150.4214282847545, -1018.0903598627273, -713.0311185371811, -1418.9419446989214, -75.51072404841244, -555.0633836722537, -786.1686129165821, -1048.9191456925303, -650.6435609332991, -1331.4247066965481, -986.8132227638614, -678.1089057267488, -1138.9439912046653, -345.98670457679685, -170.80082383951623, -491.86902623877154, -1045.7458535230442, -1288.2607018370165, -1413.7693709715768, -773.1067270652187, -363.9443529771147, -1072.8719438262967, -1141.8918372206126, -813.150834633341, -1056.5554550492427, -1358.781690210695, -1107.6250674399835, -1100.19786162854, -757.8639558581202, -838.6468618620471, -313.7643402475701, -1082.1844450665233, -1491.5060412345572, -483.82304301182353, -137.08641600823387, -1111.2364365064695, -244.87877786758727, -214.92083359846382, -1005.5878247231541, -534.7502816101642, -1419.7017251210318, -267.26663990445957, -894.2244494195129, -1078.0037352415543, -487.31282217564643, -1012.9407537068757, -465.9322355061716, -344.7151699675686, -1053.4801967644846, -122.26263252260303, -1353.3994654139333, -389.1725562141184, -1325.6571313541065, -395.2038248325159, -892.6755490151751, -1396.8096852066506, -445.47702833997215, -419.9276273504781, -137.33515193986176, -1154.571859509595, -777.0906187440198, -62.037027972446225, -309.85975914972653, -96.50846155191567, -1054.065717794697, -1162.9893196801556, -392.5808724053567, -2.4184427760900844, -837.7651102390105, -139.50204441364053, -1378.9043815716411, -1057.8108184660257, -885.7744927100007, -1089.4925440220657, -550.0333327286091, -844.324772268213, -1122.4683845640182, -349.27774257721387, -402.012416379974, -548.8489165879288, -302.65956107550744, -503.8711881363415, -654.9922039783835, -1382.6094112115086, -949.3297836765827, -88.50801050130978, -358.9700500453041, -41.39788482346741, -682.6853086749632, -980.1011956848384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529414924057217, "mean_inference_ms": 1.6678895158333544, "mean_action_processing_ms": 0.27620506103944076, "mean_env_wait_ms": 3.4895230083452544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012001991271972656, "StateBufferConnector_ms": 0.007811784744262695, "ViewRequirementAgentConnector_ms": 0.19156336784362793}, "num_episodes": 29, "episode_return_max": -2.4184427760900844, "episode_return_min": -1491.5060412345572, "episode_return_mean": -761.3516858190358, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.5776130534144, "num_env_steps_trained_throughput_per_sec": 310.5776130534144, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12961.646, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12961.572, "sample_time_ms": 1155.184, "learn_time_ms": 11736.006, "learn_throughput": 340.831, "synch_weights_time_ms": 69.585}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1e132_00005", "date": "2024-08-04_08-19-44", "timestamp": 1722739784, "time_this_iter_s": 12.893068552017212, "time_total_s": 206.2922966480255, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3541370a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.2922966480255, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.05263157894737, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225.52621899644535, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.6716874906172354, "policy_loss": -0.002489693604972369, "vf_loss": 1.6721108823393782, "vf_explained_var": 0.9878406756247083, "kl": 0.011231585198387014, "entropy": 1.8001990377902986, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -2.4184427760900844, "episode_reward_min": -1491.5060412345572, "episode_reward_mean": -686.9917285190512, "episode_len_mean": 127.04, "episode_media": {}, "episodes_timesteps_total": 12704, "policy_reward_min": {"policy_0": -1491.5060412345572}, "policy_reward_max": {"policy_0": -2.4184427760900844}, "policy_reward_mean": {"policy_0": -686.9917285190512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1072.8719438262967, -1141.8918372206126, -813.150834633341, -1056.5554550492427, -1358.781690210695, -1107.6250674399835, -1100.19786162854, -757.8639558581202, -838.6468618620471, -313.7643402475701, -1082.1844450665233, -1491.5060412345572, -483.82304301182353, -137.08641600823387, -1111.2364365064695, -244.87877786758727, -214.92083359846382, -1005.5878247231541, -534.7502816101642, -1419.7017251210318, -267.26663990445957, -894.2244494195129, -1078.0037352415543, -487.31282217564643, -1012.9407537068757, -465.9322355061716, -344.7151699675686, -1053.4801967644846, -122.26263252260303, -1353.3994654139333, -389.1725562141184, -1325.6571313541065, -395.2038248325159, -892.6755490151751, -1396.8096852066506, -445.47702833997215, -419.9276273504781, -137.33515193986176, -1154.571859509595, -777.0906187440198, -62.037027972446225, -309.85975914972653, -96.50846155191567, -1054.065717794697, -1162.9893196801556, -392.5808724053567, -2.4184427760900844, -837.7651102390105, -139.50204441364053, -1378.9043815716411, -1057.8108184660257, -885.7744927100007, -1089.4925440220657, -550.0333327286091, -844.324772268213, -1122.4683845640182, -349.27774257721387, -402.012416379974, -548.8489165879288, -302.65956107550744, -503.8711881363415, -654.9922039783835, -1382.6094112115086, -949.3297836765827, -88.50801050130978, -358.9700500453041, -41.39788482346741, -682.6853086749632, -980.1011956848384, -844.8875790686748, -899.4291588217981, -171.47628065799202, -1424.6312602109685, -1309.9648466511994, -153.71311832294992, -934.6674582145766, -821.7869541646319, -400.81682433966546, -1141.298388868548, -296.28225712144234, -39.592379567777726, -801.6257574921875, -231.1901639400542, -682.2134735988224, -116.23215277835888, -1182.943072446312, -216.32639569123165, -980.5764143424784, -525.7157116825156, -322.6270136551005, -39.60744517146483, -602.0947002879238, -111.47927817091487, -988.1154641257444, -1142.9726168618358, -479.5654672645869, -642.0062794811996, -236.3319247305981, -926.9476110884656, -99.77144156440978], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 108, 78, 150, 89, 63, 150, 150, 150, 112, 150, 150, 135, 150, 150, 114, 150, 81, 150, 148, 150, 110, 150, 150, 129, 127, 63, 150, 150, 57, 133, 77, 150, 150, 142, 39, 150, 79, 150, 150, 150, 150, 143, 150, 150, 150, 125, 122, 122, 116, 150, 150, 150, 59, 108, 50, 150, 150, 150, 150, 82, 150, 150, 86, 150, 150, 150, 150, 103, 51, 150, 73, 150, 53, 150, 70, 150, 111, 109, 49, 150, 73, 150, 150, 112, 150, 150, 150, 53], "policy_policy_0_reward": [-1072.8719438262967, -1141.8918372206126, -813.150834633341, -1056.5554550492427, -1358.781690210695, -1107.6250674399835, -1100.19786162854, -757.8639558581202, -838.6468618620471, -313.7643402475701, -1082.1844450665233, -1491.5060412345572, -483.82304301182353, -137.08641600823387, -1111.2364365064695, -244.87877786758727, -214.92083359846382, -1005.5878247231541, -534.7502816101642, -1419.7017251210318, -267.26663990445957, -894.2244494195129, -1078.0037352415543, -487.31282217564643, -1012.9407537068757, -465.9322355061716, -344.7151699675686, -1053.4801967644846, -122.26263252260303, -1353.3994654139333, -389.1725562141184, -1325.6571313541065, -395.2038248325159, -892.6755490151751, -1396.8096852066506, -445.47702833997215, -419.9276273504781, -137.33515193986176, -1154.571859509595, -777.0906187440198, -62.037027972446225, -309.85975914972653, -96.50846155191567, -1054.065717794697, -1162.9893196801556, -392.5808724053567, -2.4184427760900844, -837.7651102390105, -139.50204441364053, -1378.9043815716411, -1057.8108184660257, -885.7744927100007, -1089.4925440220657, -550.0333327286091, -844.324772268213, -1122.4683845640182, -349.27774257721387, -402.012416379974, -548.8489165879288, -302.65956107550744, -503.8711881363415, -654.9922039783835, -1382.6094112115086, -949.3297836765827, -88.50801050130978, -358.9700500453041, -41.39788482346741, -682.6853086749632, -980.1011956848384, -844.8875790686748, -899.4291588217981, -171.47628065799202, -1424.6312602109685, -1309.9648466511994, -153.71311832294992, -934.6674582145766, -821.7869541646319, -400.81682433966546, -1141.298388868548, -296.28225712144234, -39.592379567777726, -801.6257574921875, -231.1901639400542, -682.2134735988224, -116.23215277835888, -1182.943072446312, -216.32639569123165, -980.5764143424784, -525.7157116825156, -322.6270136551005, -39.60744517146483, -602.0947002879238, -111.47927817091487, -988.1154641257444, -1142.9726168618358, -479.5654672645869, -642.0062794811996, -236.3319247305981, -926.9476110884656, -99.77144156440978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525439965920027, "mean_inference_ms": 1.6677401405534968, "mean_action_processing_ms": 0.27615244069888223, "mean_env_wait_ms": 3.493856998781811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012233257293701172, "StateBufferConnector_ms": 0.007850408554077148, "ViewRequirementAgentConnector_ms": 0.19133591651916504}, "num_episodes": 31, "episode_return_max": -2.4184427760900844, "episode_return_min": -1491.5060412345572, "episode_return_mean": -686.9917285190512, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.0212853100953, "num_env_steps_trained_throughput_per_sec": 305.0212853100953, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12969.124, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12969.05, "sample_time_ms": 1162.239, "learn_time_ms": 11737.703, "learn_throughput": 340.782, "synch_weights_time_ms": 68.311}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1e132_00005", "date": "2024-08-04_08-19-57", "timestamp": 1722739797, "time_this_iter_s": 13.126597881317139, "time_total_s": 219.41889452934265, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447b8940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.41889452934265, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.22222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.7530867755413, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.9949925704548757, "policy_loss": -0.0031077357734223673, "vf_loss": 1.9958961450184385, "vf_explained_var": 0.9858092820892731, "kl": 0.011936595043334833, "entropy": 1.831653657183051, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -2.4184427760900844, "episode_reward_min": -1569.3972255191943, "episode_reward_mean": -695.2122173580009, "episode_len_mean": 126.54, "episode_media": {}, "episodes_timesteps_total": 12654, "policy_reward_min": {"policy_0": -1569.3972255191943}, "policy_reward_max": {"policy_0": -2.4184427760900844}, "policy_reward_mean": {"policy_0": -695.2122173580009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1396.8096852066506, -445.47702833997215, -419.9276273504781, -137.33515193986176, -1154.571859509595, -777.0906187440198, -62.037027972446225, -309.85975914972653, -96.50846155191567, -1054.065717794697, -1162.9893196801556, -392.5808724053567, -2.4184427760900844, -837.7651102390105, -139.50204441364053, -1378.9043815716411, -1057.8108184660257, -885.7744927100007, -1089.4925440220657, -550.0333327286091, -844.324772268213, -1122.4683845640182, -349.27774257721387, -402.012416379974, -548.8489165879288, -302.65956107550744, -503.8711881363415, -654.9922039783835, -1382.6094112115086, -949.3297836765827, -88.50801050130978, -358.9700500453041, -41.39788482346741, -682.6853086749632, -980.1011956848384, -844.8875790686748, -899.4291588217981, -171.47628065799202, -1424.6312602109685, -1309.9648466511994, -153.71311832294992, -934.6674582145766, -821.7869541646319, -400.81682433966546, -1141.298388868548, -296.28225712144234, -39.592379567777726, -801.6257574921875, -231.1901639400542, -682.2134735988224, -116.23215277835888, -1182.943072446312, -216.32639569123165, -980.5764143424784, -525.7157116825156, -322.6270136551005, -39.60744517146483, -602.0947002879238, -111.47927817091487, -988.1154641257444, -1142.9726168618358, -479.5654672645869, -642.0062794811996, -236.3319247305981, -926.9476110884656, -99.77144156440978, -1189.7580921710082, -1440.1339211576335, -1083.0528760467948, -475.61649183035263, -1046.370873552076, -1141.638084052378, -615.4708774458398, -520.9106613069828, -905.8331356776457, -646.0098406203023, -1086.3060520531587, -946.5239044155285, -599.0515137233158, -360.2251363276345, -569.1926708297032, -1161.4122228912229, -1104.9460467947902, -1295.8086103259195, -813.0845931302505, -1569.3972255191943, -411.5326162705134, -893.7339101882802, -37.15794494467926, -359.24639690512794, -1434.4082871918392, -591.3779724021229, -43.959681658259406, -1486.3802630256528, -171.88597400217276, -977.4358204952129, -2.637417729120209, -1107.1527524611786, -980.4433216460965, -1123.2265298661778], "episode_lengths": [150, 129, 127, 63, 150, 150, 57, 133, 77, 150, 150, 142, 39, 150, 79, 150, 150, 150, 150, 143, 150, 150, 150, 125, 122, 122, 116, 150, 150, 150, 59, 108, 50, 150, 150, 150, 150, 82, 150, 150, 86, 150, 150, 150, 150, 103, 51, 150, 73, 150, 53, 150, 70, 150, 111, 109, 49, 150, 73, 150, 150, 112, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 121, 142, 131, 150, 150, 150, 150, 150, 101, 150, 52, 123, 150, 119, 49, 150, 86, 150, 33, 150, 150, 150], "policy_policy_0_reward": [-1396.8096852066506, -445.47702833997215, -419.9276273504781, -137.33515193986176, -1154.571859509595, -777.0906187440198, -62.037027972446225, -309.85975914972653, -96.50846155191567, -1054.065717794697, -1162.9893196801556, -392.5808724053567, -2.4184427760900844, -837.7651102390105, -139.50204441364053, -1378.9043815716411, -1057.8108184660257, -885.7744927100007, -1089.4925440220657, -550.0333327286091, -844.324772268213, -1122.4683845640182, -349.27774257721387, -402.012416379974, -548.8489165879288, -302.65956107550744, -503.8711881363415, -654.9922039783835, -1382.6094112115086, -949.3297836765827, -88.50801050130978, -358.9700500453041, -41.39788482346741, -682.6853086749632, -980.1011956848384, -844.8875790686748, -899.4291588217981, -171.47628065799202, -1424.6312602109685, -1309.9648466511994, -153.71311832294992, -934.6674582145766, -821.7869541646319, -400.81682433966546, -1141.298388868548, -296.28225712144234, -39.592379567777726, -801.6257574921875, -231.1901639400542, -682.2134735988224, -116.23215277835888, -1182.943072446312, -216.32639569123165, -980.5764143424784, -525.7157116825156, -322.6270136551005, -39.60744517146483, -602.0947002879238, -111.47927817091487, -988.1154641257444, -1142.9726168618358, -479.5654672645869, -642.0062794811996, -236.3319247305981, -926.9476110884656, -99.77144156440978, -1189.7580921710082, -1440.1339211576335, -1083.0528760467948, -475.61649183035263, -1046.370873552076, -1141.638084052378, -615.4708774458398, -520.9106613069828, -905.8331356776457, -646.0098406203023, -1086.3060520531587, -946.5239044155285, -599.0515137233158, -360.2251363276345, -569.1926708297032, -1161.4122228912229, -1104.9460467947902, -1295.8086103259195, -813.0845931302505, -1569.3972255191943, -411.5326162705134, -893.7339101882802, -37.15794494467926, -359.24639690512794, -1434.4082871918392, -591.3779724021229, -43.959681658259406, -1486.3802630256528, -171.88597400217276, -977.4358204952129, -2.637417729120209, -1107.1527524611786, -980.4433216460965, -1123.2265298661778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526773794723132, "mean_inference_ms": 1.668085087393021, "mean_action_processing_ms": 0.2759299731605102, "mean_env_wait_ms": 3.5003040537301526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012028932571411133, "StateBufferConnector_ms": 0.007918119430541992, "ViewRequirementAgentConnector_ms": 0.19463133811950684}, "num_episodes": 34, "episode_return_max": -2.4184427760900844, "episode_return_min": -1569.3972255191943, "episode_return_mean": -695.2122173580009, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.99295042908113, "num_env_steps_trained_throughput_per_sec": 310.99295042908113, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12954.204, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12954.13, "sample_time_ms": 1171.134, "learn_time_ms": 11712.899, "learn_throughput": 341.504, "synch_weights_time_ms": 69.312}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1e132_00005", "date": "2024-08-04_08-20-10", "timestamp": 1722739810, "time_this_iter_s": 12.874930143356323, "time_total_s": 232.29382467269897, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ba050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.29382467269897, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.515789473684208, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 247.2619431634744, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.919958779339989, "policy_loss": -0.006874059663581041, "vf_loss": 1.9244329380492369, "vf_explained_var": 0.9864728584264716, "kl": 0.01289097507024053, "entropy": 1.7828820740183196, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -2.637417729120209, "episode_reward_min": -1569.3972255191943, "episode_reward_mean": -673.9735693291988, "episode_len_mean": 123.45, "episode_media": {}, "episodes_timesteps_total": 12345, "policy_reward_min": {"policy_0": -1569.3972255191943}, "policy_reward_max": {"policy_0": -2.637417729120209}, "policy_reward_mean": {"policy_0": -673.9735693291988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-358.9700500453041, -41.39788482346741, -682.6853086749632, -980.1011956848384, -844.8875790686748, -899.4291588217981, -171.47628065799202, -1424.6312602109685, -1309.9648466511994, -153.71311832294992, -934.6674582145766, -821.7869541646319, -400.81682433966546, -1141.298388868548, -296.28225712144234, -39.592379567777726, -801.6257574921875, -231.1901639400542, -682.2134735988224, -116.23215277835888, -1182.943072446312, -216.32639569123165, -980.5764143424784, -525.7157116825156, -322.6270136551005, -39.60744517146483, -602.0947002879238, -111.47927817091487, -988.1154641257444, -1142.9726168618358, -479.5654672645869, -642.0062794811996, -236.3319247305981, -926.9476110884656, -99.77144156440978, -1189.7580921710082, -1440.1339211576335, -1083.0528760467948, -475.61649183035263, -1046.370873552076, -1141.638084052378, -615.4708774458398, -520.9106613069828, -905.8331356776457, -646.0098406203023, -1086.3060520531587, -946.5239044155285, -599.0515137233158, -360.2251363276345, -569.1926708297032, -1161.4122228912229, -1104.9460467947902, -1295.8086103259195, -813.0845931302505, -1569.3972255191943, -411.5326162705134, -893.7339101882802, -37.15794494467926, -359.24639690512794, -1434.4082871918392, -591.3779724021229, -43.959681658259406, -1486.3802630256528, -171.88597400217276, -977.4358204952129, -2.637417729120209, -1107.1527524611786, -980.4433216460965, -1123.2265298661778, -305.3992672480611, -660.4878680972396, -72.81702661843097, -1378.9410125999937, -1184.7782543375563, -288.76212462998774, -173.14442387687905, -475.7027413489291, -304.4782787341785, -724.2212902280926, -1216.0664583716962, -847.1484478425483, -110.19074050069969, -328.4933778700256, -1195.945474934033, -35.52154570932325, -1216.5636278188488, -19.429455086665506, -458.20388501677513, -943.6783376459907, -534.4843323016512, -42.324896289549564, -245.02283088866884, -166.28119769787054, -269.49013292153336, -1140.549722428673, -880.877259558158, -595.7482951845686, -904.5473214535052, -921.8058105431239, -734.8864468654526], "episode_lengths": [108, 50, 150, 150, 150, 150, 82, 150, 150, 86, 150, 150, 150, 150, 103, 51, 150, 73, 150, 53, 150, 70, 150, 111, 109, 49, 150, 73, 150, 150, 112, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 121, 142, 131, 150, 150, 150, 150, 150, 101, 150, 52, 123, 150, 119, 49, 150, 86, 150, 33, 150, 150, 150, 79, 150, 57, 150, 150, 112, 79, 121, 86, 150, 150, 150, 62, 96, 150, 52, 150, 36, 150, 150, 150, 53, 102, 78, 76, 150, 150, 150, 150, 150, 135], "policy_policy_0_reward": [-358.9700500453041, -41.39788482346741, -682.6853086749632, -980.1011956848384, -844.8875790686748, -899.4291588217981, -171.47628065799202, -1424.6312602109685, -1309.9648466511994, -153.71311832294992, -934.6674582145766, -821.7869541646319, -400.81682433966546, -1141.298388868548, -296.28225712144234, -39.592379567777726, -801.6257574921875, -231.1901639400542, -682.2134735988224, -116.23215277835888, -1182.943072446312, -216.32639569123165, -980.5764143424784, -525.7157116825156, -322.6270136551005, -39.60744517146483, -602.0947002879238, -111.47927817091487, -988.1154641257444, -1142.9726168618358, -479.5654672645869, -642.0062794811996, -236.3319247305981, -926.9476110884656, -99.77144156440978, -1189.7580921710082, -1440.1339211576335, -1083.0528760467948, -475.61649183035263, -1046.370873552076, -1141.638084052378, -615.4708774458398, -520.9106613069828, -905.8331356776457, -646.0098406203023, -1086.3060520531587, -946.5239044155285, -599.0515137233158, -360.2251363276345, -569.1926708297032, -1161.4122228912229, -1104.9460467947902, -1295.8086103259195, -813.0845931302505, -1569.3972255191943, -411.5326162705134, -893.7339101882802, -37.15794494467926, -359.24639690512794, -1434.4082871918392, -591.3779724021229, -43.959681658259406, -1486.3802630256528, -171.88597400217276, -977.4358204952129, -2.637417729120209, -1107.1527524611786, -980.4433216460965, -1123.2265298661778, -305.3992672480611, -660.4878680972396, -72.81702661843097, -1378.9410125999937, -1184.7782543375563, -288.76212462998774, -173.14442387687905, -475.7027413489291, -304.4782787341785, -724.2212902280926, -1216.0664583716962, -847.1484478425483, -110.19074050069969, -328.4933778700256, -1195.945474934033, -35.52154570932325, -1216.5636278188488, -19.429455086665506, -458.20388501677513, -943.6783376459907, -534.4843323016512, -42.324896289549564, -245.02283088866884, -166.28119769787054, -269.49013292153336, -1140.549722428673, -880.877259558158, -595.7482951845686, -904.5473214535052, -921.8058105431239, -734.8864468654526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552797551980773, "mean_inference_ms": 1.6688431800206451, "mean_action_processing_ms": 0.27597625850457635, "mean_env_wait_ms": 3.505048389210215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011985540390014648, "StateBufferConnector_ms": 0.00795602798461914, "ViewRequirementAgentConnector_ms": 0.19452619552612305}, "num_episodes": 31, "episode_return_max": -2.637417729120209, "episode_return_min": -1569.3972255191943, "episode_return_mean": -673.9735693291988, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.5441384078317, "num_env_steps_trained_throughput_per_sec": 303.5441384078317, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13078.468, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13078.396, "sample_time_ms": 1172.698, "learn_time_ms": 11838.799, "learn_throughput": 337.872, "synch_weights_time_ms": 66.116}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1e132_00005", "date": "2024-08-04_08-20-24", "timestamp": 1722739824, "time_this_iter_s": 13.19102144241333, "time_total_s": 245.4848461151123, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a5870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.4848461151123, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.400000000000002, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 215.83696738084157, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.7433797725786766, "policy_loss": -0.006131473891340041, "vf_loss": 1.7469205508008598, "vf_explained_var": 0.9859664347022772, "kl": 0.01384539033533656, "entropy": 1.783878914391001, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -2.637417729120209, "episode_reward_min": -1569.3972255191943, "episode_reward_mean": -731.6597055680251, "episode_len_mean": 127.89, "episode_media": {}, "episodes_timesteps_total": 12789, "policy_reward_min": {"policy_0": -1569.3972255191943}, "policy_reward_max": {"policy_0": -2.637417729120209}, "policy_reward_mean": {"policy_0": -731.6597055680251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1142.9726168618358, -479.5654672645869, -642.0062794811996, -236.3319247305981, -926.9476110884656, -99.77144156440978, -1189.7580921710082, -1440.1339211576335, -1083.0528760467948, -475.61649183035263, -1046.370873552076, -1141.638084052378, -615.4708774458398, -520.9106613069828, -905.8331356776457, -646.0098406203023, -1086.3060520531587, -946.5239044155285, -599.0515137233158, -360.2251363276345, -569.1926708297032, -1161.4122228912229, -1104.9460467947902, -1295.8086103259195, -813.0845931302505, -1569.3972255191943, -411.5326162705134, -893.7339101882802, -37.15794494467926, -359.24639690512794, -1434.4082871918392, -591.3779724021229, -43.959681658259406, -1486.3802630256528, -171.88597400217276, -977.4358204952129, -2.637417729120209, -1107.1527524611786, -980.4433216460965, -1123.2265298661778, -305.3992672480611, -660.4878680972396, -72.81702661843097, -1378.9410125999937, -1184.7782543375563, -288.76212462998774, -173.14442387687905, -475.7027413489291, -304.4782787341785, -724.2212902280926, -1216.0664583716962, -847.1484478425483, -110.19074050069969, -328.4933778700256, -1195.945474934033, -35.52154570932325, -1216.5636278188488, -19.429455086665506, -458.20388501677513, -943.6783376459907, -534.4843323016512, -42.324896289549564, -245.02283088866884, -166.28119769787054, -269.49013292153336, -1140.549722428673, -880.877259558158, -595.7482951845686, -904.5473214535052, -921.8058105431239, -734.8864468654526, -665.4504965759915, -722.0822735256529, -929.2816225647764, -1145.5164668638367, -981.0456430328901, -452.51365302268556, -785.8976392904091, -1339.9640028637712, -122.9640385133033, -159.67724424970032, -251.60415957959324, -874.1004725980777, -1225.3816286407027, -854.356632625741, -1124.8759786305202, -1328.5438419595741, -1430.2357323976148, -43.85293389035995, -33.04542921606536, -1071.993460278857, -973.3333463012084, -280.43510904555575, -842.2674712615368, -777.4241991456557, -986.9181517382226, -1398.3587456241085, -204.51432549851918, -761.5217653104561, -1303.9051482591492], "episode_lengths": [150, 112, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 121, 142, 131, 150, 150, 150, 150, 150, 101, 150, 52, 123, 150, 119, 49, 150, 86, 150, 33, 150, 150, 150, 79, 150, 57, 150, 150, 112, 79, 121, 86, 150, 150, 150, 62, 96, 150, 52, 150, 36, 150, 150, 150, 53, 102, 78, 76, 150, 150, 150, 150, 150, 135, 139, 150, 150, 150, 150, 150, 150, 150, 91, 78, 73, 147, 150, 150, 150, 150, 150, 50, 45, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150], "policy_policy_0_reward": [-1142.9726168618358, -479.5654672645869, -642.0062794811996, -236.3319247305981, -926.9476110884656, -99.77144156440978, -1189.7580921710082, -1440.1339211576335, -1083.0528760467948, -475.61649183035263, -1046.370873552076, -1141.638084052378, -615.4708774458398, -520.9106613069828, -905.8331356776457, -646.0098406203023, -1086.3060520531587, -946.5239044155285, -599.0515137233158, -360.2251363276345, -569.1926708297032, -1161.4122228912229, -1104.9460467947902, -1295.8086103259195, -813.0845931302505, -1569.3972255191943, -411.5326162705134, -893.7339101882802, -37.15794494467926, -359.24639690512794, -1434.4082871918392, -591.3779724021229, -43.959681658259406, -1486.3802630256528, -171.88597400217276, -977.4358204952129, -2.637417729120209, -1107.1527524611786, -980.4433216460965, -1123.2265298661778, -305.3992672480611, -660.4878680972396, -72.81702661843097, -1378.9410125999937, -1184.7782543375563, -288.76212462998774, -173.14442387687905, -475.7027413489291, -304.4782787341785, -724.2212902280926, -1216.0664583716962, -847.1484478425483, -110.19074050069969, -328.4933778700256, -1195.945474934033, -35.52154570932325, -1216.5636278188488, -19.429455086665506, -458.20388501677513, -943.6783376459907, -534.4843323016512, -42.324896289549564, -245.02283088866884, -166.28119769787054, -269.49013292153336, -1140.549722428673, -880.877259558158, -595.7482951845686, -904.5473214535052, -921.8058105431239, -734.8864468654526, -665.4504965759915, -722.0822735256529, -929.2816225647764, -1145.5164668638367, -981.0456430328901, -452.51365302268556, -785.8976392904091, -1339.9640028637712, -122.9640385133033, -159.67724424970032, -251.60415957959324, -874.1004725980777, -1225.3816286407027, -854.356632625741, -1124.8759786305202, -1328.5438419595741, -1430.2357323976148, -43.85293389035995, -33.04542921606536, -1071.993460278857, -973.3333463012084, -280.43510904555575, -842.2674712615368, -777.4241991456557, -986.9181517382226, -1398.3587456241085, -204.51432549851918, -761.5217653104561, -1303.9051482591492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532568909334201, "mean_inference_ms": 1.6688085791219287, "mean_action_processing_ms": 0.27585926170768, "mean_env_wait_ms": 3.510031495009267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011907577514648438, "StateBufferConnector_ms": 0.00792384147644043, "ViewRequirementAgentConnector_ms": 0.19362497329711914}, "num_episodes": 29, "episode_return_max": -2.637417729120209, "episode_return_min": -1569.3972255191943, "episode_return_mean": -731.6597055680251, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.6266495283314, "num_env_steps_trained_throughput_per_sec": 305.6266495283314, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13086.985, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13086.912, "sample_time_ms": 1172.17, "learn_time_ms": 11847.909, "learn_throughput": 337.612, "synch_weights_time_ms": 66.05}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1e132_00005", "date": "2024-08-04_08-20-37", "timestamp": 1722739837, "time_this_iter_s": 13.099507331848145, "time_total_s": 258.58435344696045, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447372e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.58435344696045, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.88947368421053, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 256.92545850078267, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.2915535596509775, "policy_loss": -0.0032350619934732095, "vf_loss": 1.292877933010459, "vf_explained_var": 0.9926619513581196, "kl": 0.010532199873099082, "entropy": 1.9575134873390199, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -2.637417729120209, "episode_reward_min": -1486.3802630256528, "episode_reward_mean": -750.2024050966451, "episode_len_mean": 128.91, "episode_media": {}, "episodes_timesteps_total": 12891, "policy_reward_min": {"policy_0": -1486.3802630256528}, "policy_reward_max": {"policy_0": -2.637417729120209}, "policy_reward_mean": {"policy_0": -750.2024050966451}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-359.24639690512794, -1434.4082871918392, -591.3779724021229, -43.959681658259406, -1486.3802630256528, -171.88597400217276, -977.4358204952129, -2.637417729120209, -1107.1527524611786, -980.4433216460965, -1123.2265298661778, -305.3992672480611, -660.4878680972396, -72.81702661843097, -1378.9410125999937, -1184.7782543375563, -288.76212462998774, -173.14442387687905, -475.7027413489291, -304.4782787341785, -724.2212902280926, -1216.0664583716962, -847.1484478425483, -110.19074050069969, -328.4933778700256, -1195.945474934033, -35.52154570932325, -1216.5636278188488, -19.429455086665506, -458.20388501677513, -943.6783376459907, -534.4843323016512, -42.324896289549564, -245.02283088866884, -166.28119769787054, -269.49013292153336, -1140.549722428673, -880.877259558158, -595.7482951845686, -904.5473214535052, -921.8058105431239, -734.8864468654526, -665.4504965759915, -722.0822735256529, -929.2816225647764, -1145.5164668638367, -981.0456430328901, -452.51365302268556, -785.8976392904091, -1339.9640028637712, -122.9640385133033, -159.67724424970032, -251.60415957959324, -874.1004725980777, -1225.3816286407027, -854.356632625741, -1124.8759786305202, -1328.5438419595741, -1430.2357323976148, -43.85293389035995, -33.04542921606536, -1071.993460278857, -973.3333463012084, -280.43510904555575, -842.2674712615368, -777.4241991456557, -986.9181517382226, -1398.3587456241085, -204.51432549851918, -761.5217653104561, -1303.9051482591492, -1296.0191142958129, -1485.3856291149543, -217.62306805094192, -447.2090605066099, -610.1737172572022, -1098.3303311080072, -1322.7548160266306, -944.487274091121, -786.4692618870437, -484.2146281512765, -1165.6076302090892, -1170.2282769180608, -1002.8229262225581, -806.7166795642879, -1274.4255342802765, -369.2471967268518, -905.8611190128645, -1241.8758751794549, -773.7277332431506, -1397.9094011249285, -458.98219889110237, -1073.421531033979, -422.2228469917524, -380.65236569987496, -1307.7353274308055, -986.6065598575021, -66.79155162217408, -1005.460521709929, -792.0704189200425], "episode_lengths": [123, 150, 119, 49, 150, 86, 150, 33, 150, 150, 150, 79, 150, 57, 150, 150, 112, 79, 121, 86, 150, 150, 150, 62, 96, 150, 52, 150, 36, 150, 150, 150, 53, 102, 78, 76, 150, 150, 150, 150, 150, 135, 139, 150, 150, 150, 150, 150, 150, 150, 91, 78, 73, 147, 150, 150, 150, 150, 150, 50, 45, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 103, 121, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 42, 150, 150], "policy_policy_0_reward": [-359.24639690512794, -1434.4082871918392, -591.3779724021229, -43.959681658259406, -1486.3802630256528, -171.88597400217276, -977.4358204952129, -2.637417729120209, -1107.1527524611786, -980.4433216460965, -1123.2265298661778, -305.3992672480611, -660.4878680972396, -72.81702661843097, -1378.9410125999937, -1184.7782543375563, -288.76212462998774, -173.14442387687905, -475.7027413489291, -304.4782787341785, -724.2212902280926, -1216.0664583716962, -847.1484478425483, -110.19074050069969, -328.4933778700256, -1195.945474934033, -35.52154570932325, -1216.5636278188488, -19.429455086665506, -458.20388501677513, -943.6783376459907, -534.4843323016512, -42.324896289549564, -245.02283088866884, -166.28119769787054, -269.49013292153336, -1140.549722428673, -880.877259558158, -595.7482951845686, -904.5473214535052, -921.8058105431239, -734.8864468654526, -665.4504965759915, -722.0822735256529, -929.2816225647764, -1145.5164668638367, -981.0456430328901, -452.51365302268556, -785.8976392904091, -1339.9640028637712, -122.9640385133033, -159.67724424970032, -251.60415957959324, -874.1004725980777, -1225.3816286407027, -854.356632625741, -1124.8759786305202, -1328.5438419595741, -1430.2357323976148, -43.85293389035995, -33.04542921606536, -1071.993460278857, -973.3333463012084, -280.43510904555575, -842.2674712615368, -777.4241991456557, -986.9181517382226, -1398.3587456241085, -204.51432549851918, -761.5217653104561, -1303.9051482591492, -1296.0191142958129, -1485.3856291149543, -217.62306805094192, -447.2090605066099, -610.1737172572022, -1098.3303311080072, -1322.7548160266306, -944.487274091121, -786.4692618870437, -484.2146281512765, -1165.6076302090892, -1170.2282769180608, -1002.8229262225581, -806.7166795642879, -1274.4255342802765, -369.2471967268518, -905.8611190128645, -1241.8758751794549, -773.7277332431506, -1397.9094011249285, -458.98219889110237, -1073.421531033979, -422.2228469917524, -380.65236569987496, -1307.7353274308055, -986.6065598575021, -66.79155162217408, -1005.460521709929, -792.0704189200425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531928452700845, "mean_inference_ms": 1.667326809808876, "mean_action_processing_ms": 0.2758083924912878, "mean_env_wait_ms": 3.5121996222016594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011957168579101562, "StateBufferConnector_ms": 0.0078067779541015625, "ViewRequirementAgentConnector_ms": 0.19107508659362793}, "num_episodes": 29, "episode_return_max": -2.637417729120209, "episode_return_min": -1486.3802630256528, "episode_return_mean": -750.2024050966451, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.06292369896573, "num_env_steps_trained_throughput_per_sec": 315.06292369896573, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13040.872, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13040.797, "sample_time_ms": 1170.941, "learn_time_ms": 11801.271, "learn_throughput": 338.947, "synch_weights_time_ms": 67.812}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1e132_00005", "date": "2024-08-04_08-20-49", "timestamp": 1722739849, "time_this_iter_s": 12.707933187484741, "time_total_s": 271.2922866344452, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447360e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 271.2922866344452, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.616666666666667, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 254.7965732852618, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.3341653928160668, "policy_loss": -0.00704912968891828, "vf_loss": 1.3390742532288036, "vf_explained_var": 0.9891968604798118, "kl": 0.011615628948735942, "entropy": 1.8286045219749212, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -33.04542921606536, "episode_reward_min": -1485.3856291149543, "episode_reward_mean": -802.634322301531, "episode_len_mean": 136.2, "episode_media": {}, "episodes_timesteps_total": 13620, "policy_reward_min": {"policy_0": -1485.3856291149543}, "policy_reward_max": {"policy_0": -33.04542921606536}, "policy_reward_mean": {"policy_0": -802.634322301531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-458.20388501677513, -943.6783376459907, -534.4843323016512, -42.324896289549564, -245.02283088866884, -166.28119769787054, -269.49013292153336, -1140.549722428673, -880.877259558158, -595.7482951845686, -904.5473214535052, -921.8058105431239, -734.8864468654526, -665.4504965759915, -722.0822735256529, -929.2816225647764, -1145.5164668638367, -981.0456430328901, -452.51365302268556, -785.8976392904091, -1339.9640028637712, -122.9640385133033, -159.67724424970032, -251.60415957959324, -874.1004725980777, -1225.3816286407027, -854.356632625741, -1124.8759786305202, -1328.5438419595741, -1430.2357323976148, -43.85293389035995, -33.04542921606536, -1071.993460278857, -973.3333463012084, -280.43510904555575, -842.2674712615368, -777.4241991456557, -986.9181517382226, -1398.3587456241085, -204.51432549851918, -761.5217653104561, -1303.9051482591492, -1296.0191142958129, -1485.3856291149543, -217.62306805094192, -447.2090605066099, -610.1737172572022, -1098.3303311080072, -1322.7548160266306, -944.487274091121, -786.4692618870437, -484.2146281512765, -1165.6076302090892, -1170.2282769180608, -1002.8229262225581, -806.7166795642879, -1274.4255342802765, -369.2471967268518, -905.8611190128645, -1241.8758751794549, -773.7277332431506, -1397.9094011249285, -458.98219889110237, -1073.421531033979, -422.2228469917524, -380.65236569987496, -1307.7353274308055, -986.6065598575021, -66.79155162217408, -1005.460521709929, -792.0704189200425, -214.99676050095948, -170.82359299576154, -1012.473170779661, -511.63614192725754, -500.6929588384325, -670.0605818291676, -1165.846264061046, -674.8764436908942, -1211.934805092085, -1035.8890878011775, -921.207137559666, -1182.883960376635, -975.3326428059858, -1273.0127277635647, -1151.6351429381534, -644.0351842400358, -678.2410916700044, -393.77873089532324, -483.20219249302266, -453.80272860048683, -1070.2184153003502, -118.34465878026192, -1459.6587289126585, -1294.1702459710905, -741.4812827571775, -898.6083076424234, -1053.9502735825572, -848.8612283160567, -1247.7830656028643], "episode_lengths": [150, 150, 150, 53, 102, 78, 76, 150, 150, 150, 150, 150, 135, 139, 150, 150, 150, 150, 150, 150, 150, 91, 78, 73, 147, 150, 150, 150, 150, 150, 50, 45, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 103, 121, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 42, 150, 150, 91, 64, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 135, 150, 71, 150, 150, 136, 150, 150, 150, 150], "policy_policy_0_reward": [-458.20388501677513, -943.6783376459907, -534.4843323016512, -42.324896289549564, -245.02283088866884, -166.28119769787054, -269.49013292153336, -1140.549722428673, -880.877259558158, -595.7482951845686, -904.5473214535052, -921.8058105431239, -734.8864468654526, -665.4504965759915, -722.0822735256529, -929.2816225647764, -1145.5164668638367, -981.0456430328901, -452.51365302268556, -785.8976392904091, -1339.9640028637712, -122.9640385133033, -159.67724424970032, -251.60415957959324, -874.1004725980777, -1225.3816286407027, -854.356632625741, -1124.8759786305202, -1328.5438419595741, -1430.2357323976148, -43.85293389035995, -33.04542921606536, -1071.993460278857, -973.3333463012084, -280.43510904555575, -842.2674712615368, -777.4241991456557, -986.9181517382226, -1398.3587456241085, -204.51432549851918, -761.5217653104561, -1303.9051482591492, -1296.0191142958129, -1485.3856291149543, -217.62306805094192, -447.2090605066099, -610.1737172572022, -1098.3303311080072, -1322.7548160266306, -944.487274091121, -786.4692618870437, -484.2146281512765, -1165.6076302090892, -1170.2282769180608, -1002.8229262225581, -806.7166795642879, -1274.4255342802765, -369.2471967268518, -905.8611190128645, -1241.8758751794549, -773.7277332431506, -1397.9094011249285, -458.98219889110237, -1073.421531033979, -422.2228469917524, -380.65236569987496, -1307.7353274308055, -986.6065598575021, -66.79155162217408, -1005.460521709929, -792.0704189200425, -214.99676050095948, -170.82359299576154, -1012.473170779661, -511.63614192725754, -500.6929588384325, -670.0605818291676, -1165.846264061046, -674.8764436908942, -1211.934805092085, -1035.8890878011775, -921.207137559666, -1182.883960376635, -975.3326428059858, -1273.0127277635647, -1151.6351429381534, -644.0351842400358, -678.2410916700044, -393.77873089532324, -483.20219249302266, -453.80272860048683, -1070.2184153003502, -118.34465878026192, -1459.6587289126585, -1294.1702459710905, -741.4812827571775, -898.6083076424234, -1053.9502735825572, -848.8612283160567, -1247.7830656028643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533164056417471, "mean_inference_ms": 1.6672339461908194, "mean_action_processing_ms": 0.27567797584614545, "mean_env_wait_ms": 3.517602672560916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012186050415039062, "StateBufferConnector_ms": 0.007822990417480469, "ViewRequirementAgentConnector_ms": 0.1947038173675537}, "num_episodes": 29, "episode_return_max": -33.04542921606536, "episode_return_min": -1485.3856291149543, "episode_return_mean": -802.634322301531, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0525143669012, "num_env_steps_trained_throughput_per_sec": 303.0525143669012, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13070.617, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13070.542, "sample_time_ms": 1169.084, "learn_time_ms": 11833.776, "learn_throughput": 338.016, "synch_weights_time_ms": 66.904}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1e132_00005", "date": "2024-08-04_08-21-03", "timestamp": 1722739863, "time_this_iter_s": 13.21151351928711, "time_total_s": 284.5038001537323, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447b9360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 284.5038001537323, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.931578947368422, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.3992571592331, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.5560766670232018, "policy_loss": -0.00886555739416508, "vf_loss": 1.5629951756447553, "vf_explained_var": 0.9868677007034421, "kl": 0.010590385777929139, "entropy": 1.7102919836839041, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -49.5865648958106, "episode_reward_min": -1487.3913732786464, "episode_reward_mean": -810.1162636795228, "episode_len_mean": 134.51, "episode_media": {}, "episodes_timesteps_total": 13451, "policy_reward_min": {"policy_0": -1487.3913732786464}, "policy_reward_max": {"policy_0": -49.5865648958106}, "policy_reward_mean": {"policy_0": -810.1162636795228}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-842.2674712615368, -777.4241991456557, -986.9181517382226, -1398.3587456241085, -204.51432549851918, -761.5217653104561, -1303.9051482591492, -1296.0191142958129, -1485.3856291149543, -217.62306805094192, -447.2090605066099, -610.1737172572022, -1098.3303311080072, -1322.7548160266306, -944.487274091121, -786.4692618870437, -484.2146281512765, -1165.6076302090892, -1170.2282769180608, -1002.8229262225581, -806.7166795642879, -1274.4255342802765, -369.2471967268518, -905.8611190128645, -1241.8758751794549, -773.7277332431506, -1397.9094011249285, -458.98219889110237, -1073.421531033979, -422.2228469917524, -380.65236569987496, -1307.7353274308055, -986.6065598575021, -66.79155162217408, -1005.460521709929, -792.0704189200425, -214.99676050095948, -170.82359299576154, -1012.473170779661, -511.63614192725754, -500.6929588384325, -670.0605818291676, -1165.846264061046, -674.8764436908942, -1211.934805092085, -1035.8890878011775, -921.207137559666, -1182.883960376635, -975.3326428059858, -1273.0127277635647, -1151.6351429381534, -644.0351842400358, -678.2410916700044, -393.77873089532324, -483.20219249302266, -453.80272860048683, -1070.2184153003502, -118.34465878026192, -1459.6587289126585, -1294.1702459710905, -741.4812827571775, -898.6083076424234, -1053.9502735825572, -848.8612283160567, -1247.7830656028643, -149.71239919948883, -270.606481487962, -66.87455973355395, -960.0945899483573, -86.04020691374735, -1004.1989159448433, -1020.0904099617708, -101.53514529224226, -1401.7448024272096, -1095.523439484413, -581.8852409135428, -1215.3556942095993, -1078.436405717089, -643.7437831680751, -1174.974822169314, -87.57243683830036, -142.7689249406665, -894.1751428151035, -961.4189995240537, -1036.3806667826975, -1011.3582465320683, -1007.2998630509629, -1197.9165874372757, -49.5865648958106, -920.2627639109463, -263.0279818862731, -202.87728228010968, -835.3433194298807, -1487.3913732786464, -220.85892571583963, -461.1579533759499, -1231.5569540511015, -432.8620196019576, -1074.7243769048232, -1012.8891324379142], "episode_lengths": [150, 150, 150, 150, 89, 150, 150, 150, 150, 103, 121, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 42, 150, 150, 91, 64, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 135, 150, 71, 150, 150, 136, 150, 150, 150, 150, 82, 79, 64, 149, 52, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 59, 55, 150, 150, 150, 150, 150, 150, 49, 150, 89, 150, 150, 150, 102, 102, 150, 98, 150, 150], "policy_policy_0_reward": [-842.2674712615368, -777.4241991456557, -986.9181517382226, -1398.3587456241085, -204.51432549851918, -761.5217653104561, -1303.9051482591492, -1296.0191142958129, -1485.3856291149543, -217.62306805094192, -447.2090605066099, -610.1737172572022, -1098.3303311080072, -1322.7548160266306, -944.487274091121, -786.4692618870437, -484.2146281512765, -1165.6076302090892, -1170.2282769180608, -1002.8229262225581, -806.7166795642879, -1274.4255342802765, -369.2471967268518, -905.8611190128645, -1241.8758751794549, -773.7277332431506, -1397.9094011249285, -458.98219889110237, -1073.421531033979, -422.2228469917524, -380.65236569987496, -1307.7353274308055, -986.6065598575021, -66.79155162217408, -1005.460521709929, -792.0704189200425, -214.99676050095948, -170.82359299576154, -1012.473170779661, -511.63614192725754, -500.6929588384325, -670.0605818291676, -1165.846264061046, -674.8764436908942, -1211.934805092085, -1035.8890878011775, -921.207137559666, -1182.883960376635, -975.3326428059858, -1273.0127277635647, -1151.6351429381534, -644.0351842400358, -678.2410916700044, -393.77873089532324, -483.20219249302266, -453.80272860048683, -1070.2184153003502, -118.34465878026192, -1459.6587289126585, -1294.1702459710905, -741.4812827571775, -898.6083076424234, -1053.9502735825572, -848.8612283160567, -1247.7830656028643, -149.71239919948883, -270.606481487962, -66.87455973355395, -960.0945899483573, -86.04020691374735, -1004.1989159448433, -1020.0904099617708, -101.53514529224226, -1401.7448024272096, -1095.523439484413, -581.8852409135428, -1215.3556942095993, -1078.436405717089, -643.7437831680751, -1174.974822169314, -87.57243683830036, -142.7689249406665, -894.1751428151035, -961.4189995240537, -1036.3806667826975, -1011.3582465320683, -1007.2998630509629, -1197.9165874372757, -49.5865648958106, -920.2627639109463, -263.0279818862731, -202.87728228010968, -835.3433194298807, -1487.3913732786464, -220.85892571583963, -461.1579533759499, -1231.5569540511015, -432.8620196019576, -1074.7243769048232, -1012.8891324379142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533851217536337, "mean_inference_ms": 1.6681241648546514, "mean_action_processing_ms": 0.27574503262070643, "mean_env_wait_ms": 3.524917325199184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012537479400634766, "StateBufferConnector_ms": 0.008258581161499023, "ViewRequirementAgentConnector_ms": 0.1958911418914795}, "num_episodes": 35, "episode_return_max": -49.5865648958106, "episode_return_min": -1487.3913732786464, "episode_return_mean": -810.1162636795228, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.3833919868707, "num_env_steps_trained_throughput_per_sec": 322.3833919868707, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12980.952, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12980.877, "sample_time_ms": 1153.697, "learn_time_ms": 11760.937, "learn_throughput": 340.109, "synch_weights_time_ms": 65.461}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1e132_00005", "date": "2024-08-04_08-21-15", "timestamp": 1722739875, "time_this_iter_s": 12.4194655418396, "time_total_s": 296.9232656955719, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447372e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.9232656955719, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.41111111111111, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 216.00806858738264, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.3955055858939887, "policy_loss": -0.007852919750682, "vf_loss": 1.4008752095823487, "vf_explained_var": 0.993209226988256, "kl": 0.013255752751380594, "entropy": 1.678507547204693, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -49.5865648958106, "episode_reward_min": -1487.3913732786464, "episode_reward_mean": -759.8447830374618, "episode_len_mean": 130.39, "episode_media": {}, "episodes_timesteps_total": 13039, "policy_reward_min": {"policy_0": -1487.3913732786464}, "policy_reward_max": {"policy_0": -49.5865648958106}, "policy_reward_mean": {"policy_0": -759.8447830374618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-380.65236569987496, -1307.7353274308055, -986.6065598575021, -66.79155162217408, -1005.460521709929, -792.0704189200425, -214.99676050095948, -170.82359299576154, -1012.473170779661, -511.63614192725754, -500.6929588384325, -670.0605818291676, -1165.846264061046, -674.8764436908942, -1211.934805092085, -1035.8890878011775, -921.207137559666, -1182.883960376635, -975.3326428059858, -1273.0127277635647, -1151.6351429381534, -644.0351842400358, -678.2410916700044, -393.77873089532324, -483.20219249302266, -453.80272860048683, -1070.2184153003502, -118.34465878026192, -1459.6587289126585, -1294.1702459710905, -741.4812827571775, -898.6083076424234, -1053.9502735825572, -848.8612283160567, -1247.7830656028643, -149.71239919948883, -270.606481487962, -66.87455973355395, -960.0945899483573, -86.04020691374735, -1004.1989159448433, -1020.0904099617708, -101.53514529224226, -1401.7448024272096, -1095.523439484413, -581.8852409135428, -1215.3556942095993, -1078.436405717089, -643.7437831680751, -1174.974822169314, -87.57243683830036, -142.7689249406665, -894.1751428151035, -961.4189995240537, -1036.3806667826975, -1011.3582465320683, -1007.2998630509629, -1197.9165874372757, -49.5865648958106, -920.2627639109463, -263.0279818862731, -202.87728228010968, -835.3433194298807, -1487.3913732786464, -220.85892571583963, -461.1579533759499, -1231.5569540511015, -432.8620196019576, -1074.7243769048232, -1012.8891324379142, -1201.3238823980957, -966.5872890883319, -993.9972759948329, -153.8696815367678, -422.73155097926747, -1331.945408443325, -239.15861901691406, -950.2428456761468, -494.3957041337018, -156.69515636360504, -1070.2954489079134, -1359.0116283925913, -1007.6900345104997, -211.39604323666128, -956.2302277752734, -1102.5432475836317, -1009.434489474311, -1193.2524010002314, -975.906967522273, -1121.2678139439781, -300.2295916376592, -225.93026079131425, -473.2461199496215, -1121.2225476996641, -479.8269451151468, -1109.7043690340467, -691.6256505635691, -261.0553432518816, -59.401938899194185, -363.25910959906435], "episode_lengths": [150, 150, 150, 42, 150, 150, 91, 64, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 135, 150, 71, 150, 150, 136, 150, 150, 150, 150, 82, 79, 64, 149, 52, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 59, 55, 150, 150, 150, 150, 150, 150, 49, 150, 89, 150, 150, 150, 102, 102, 150, 98, 150, 150, 150, 150, 150, 62, 100, 150, 108, 150, 150, 75, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 109, 77, 150, 150, 150, 150, 150, 104, 52, 125], "policy_policy_0_reward": [-380.65236569987496, -1307.7353274308055, -986.6065598575021, -66.79155162217408, -1005.460521709929, -792.0704189200425, -214.99676050095948, -170.82359299576154, -1012.473170779661, -511.63614192725754, -500.6929588384325, -670.0605818291676, -1165.846264061046, -674.8764436908942, -1211.934805092085, -1035.8890878011775, -921.207137559666, -1182.883960376635, -975.3326428059858, -1273.0127277635647, -1151.6351429381534, -644.0351842400358, -678.2410916700044, -393.77873089532324, -483.20219249302266, -453.80272860048683, -1070.2184153003502, -118.34465878026192, -1459.6587289126585, -1294.1702459710905, -741.4812827571775, -898.6083076424234, -1053.9502735825572, -848.8612283160567, -1247.7830656028643, -149.71239919948883, -270.606481487962, -66.87455973355395, -960.0945899483573, -86.04020691374735, -1004.1989159448433, -1020.0904099617708, -101.53514529224226, -1401.7448024272096, -1095.523439484413, -581.8852409135428, -1215.3556942095993, -1078.436405717089, -643.7437831680751, -1174.974822169314, -87.57243683830036, -142.7689249406665, -894.1751428151035, -961.4189995240537, -1036.3806667826975, -1011.3582465320683, -1007.2998630509629, -1197.9165874372757, -49.5865648958106, -920.2627639109463, -263.0279818862731, -202.87728228010968, -835.3433194298807, -1487.3913732786464, -220.85892571583963, -461.1579533759499, -1231.5569540511015, -432.8620196019576, -1074.7243769048232, -1012.8891324379142, -1201.3238823980957, -966.5872890883319, -993.9972759948329, -153.8696815367678, -422.73155097926747, -1331.945408443325, -239.15861901691406, -950.2428456761468, -494.3957041337018, -156.69515636360504, -1070.2954489079134, -1359.0116283925913, -1007.6900345104997, -211.39604323666128, -956.2302277752734, -1102.5432475836317, -1009.434489474311, -1193.2524010002314, -975.906967522273, -1121.2678139439781, -300.2295916376592, -225.93026079131425, -473.2461199496215, -1121.2225476996641, -479.8269451151468, -1109.7043690340467, -691.6256505635691, -261.0553432518816, -59.401938899194185, -363.25910959906435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533660219367711, "mean_inference_ms": 1.6680802180354026, "mean_action_processing_ms": 0.27556531630814657, "mean_env_wait_ms": 3.5258690978691503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012347698211669922, "StateBufferConnector_ms": 0.008244752883911133, "ViewRequirementAgentConnector_ms": 0.19404244422912598}, "num_episodes": 30, "episode_return_max": -49.5865648958106, "episode_return_min": -1487.3913732786464, "episode_return_mean": -759.8447830374618, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.5948069961038, "num_env_steps_trained_throughput_per_sec": 331.5948069961038, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12911.24, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12911.166, "sample_time_ms": 1150.852, "learn_time_ms": 11694.138, "learn_throughput": 342.052, "synch_weights_time_ms": 65.392}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1e132_00005", "date": "2024-08-04_08-21-27", "timestamp": 1722739887, "time_this_iter_s": 12.074740648269653, "time_total_s": 308.99800634384155, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447360e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.99800634384155, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.629411764705882, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 227.21371064186096, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.5729336189106107, "policy_loss": -0.008722694922471418, "vf_loss": 1.5790224825963377, "vf_explained_var": 0.9956558526183168, "kl": 0.014064063152030333, "entropy": 1.7898198318978151, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -9.945166579435549, "episode_reward_min": -1487.3913732786464, "episode_reward_mean": -725.0234552670638, "episode_len_mean": 127.47, "episode_media": {}, "episodes_timesteps_total": 12747, "policy_reward_min": {"policy_0": -1487.3913732786464}, "policy_reward_max": {"policy_0": -9.945166579435549}, "policy_reward_mean": {"policy_0": -725.0234552670638}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-741.4812827571775, -898.6083076424234, -1053.9502735825572, -848.8612283160567, -1247.7830656028643, -149.71239919948883, -270.606481487962, -66.87455973355395, -960.0945899483573, -86.04020691374735, -1004.1989159448433, -1020.0904099617708, -101.53514529224226, -1401.7448024272096, -1095.523439484413, -581.8852409135428, -1215.3556942095993, -1078.436405717089, -643.7437831680751, -1174.974822169314, -87.57243683830036, -142.7689249406665, -894.1751428151035, -961.4189995240537, -1036.3806667826975, -1011.3582465320683, -1007.2998630509629, -1197.9165874372757, -49.5865648958106, -920.2627639109463, -263.0279818862731, -202.87728228010968, -835.3433194298807, -1487.3913732786464, -220.85892571583963, -461.1579533759499, -1231.5569540511015, -432.8620196019576, -1074.7243769048232, -1012.8891324379142, -1201.3238823980957, -966.5872890883319, -993.9972759948329, -153.8696815367678, -422.73155097926747, -1331.945408443325, -239.15861901691406, -950.2428456761468, -494.3957041337018, -156.69515636360504, -1070.2954489079134, -1359.0116283925913, -1007.6900345104997, -211.39604323666128, -956.2302277752734, -1102.5432475836317, -1009.434489474311, -1193.2524010002314, -975.906967522273, -1121.2678139439781, -300.2295916376592, -225.93026079131425, -473.2461199496215, -1121.2225476996641, -479.8269451151468, -1109.7043690340467, -691.6256505635691, -261.0553432518816, -59.401938899194185, -363.25910959906435, -325.6151495967352, -866.7130080135913, -9.945166579435549, -178.40105736247125, -986.4836871182192, -424.3436369210991, -724.3894582381549, -230.36932822929575, -425.25858559195785, -934.7282074916602, -58.990583672297674, -399.29622525972064, -1092.9851791254696, -972.9838089104735, -1221.4048884670053, -1006.6887706263246, -108.05062642080092, -311.35216312345887, -924.9717390549163, -528.6522945238243, -137.20205816345884, -150.35076197175317, -1017.4219681985163, -1253.2378708610477, -966.2849836333716, -879.8252668860009, -713.3327912675012, -1157.200683174438, -927.8358690952418, -1391.6215464459733], "episode_lengths": [136, 150, 150, 150, 150, 82, 79, 64, 149, 52, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 59, 55, 150, 150, 150, 150, 150, 150, 49, 150, 89, 150, 150, 150, 102, 102, 150, 98, 150, 150, 150, 150, 150, 62, 100, 150, 108, 150, 150, 75, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 109, 77, 150, 150, 150, 150, 150, 104, 52, 125, 111, 150, 35, 137, 150, 117, 150, 75, 115, 150, 54, 121, 150, 150, 150, 150, 69, 91, 150, 150, 82, 76, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-741.4812827571775, -898.6083076424234, -1053.9502735825572, -848.8612283160567, -1247.7830656028643, -149.71239919948883, -270.606481487962, -66.87455973355395, -960.0945899483573, -86.04020691374735, -1004.1989159448433, -1020.0904099617708, -101.53514529224226, -1401.7448024272096, -1095.523439484413, -581.8852409135428, -1215.3556942095993, -1078.436405717089, -643.7437831680751, -1174.974822169314, -87.57243683830036, -142.7689249406665, -894.1751428151035, -961.4189995240537, -1036.3806667826975, -1011.3582465320683, -1007.2998630509629, -1197.9165874372757, -49.5865648958106, -920.2627639109463, -263.0279818862731, -202.87728228010968, -835.3433194298807, -1487.3913732786464, -220.85892571583963, -461.1579533759499, -1231.5569540511015, -432.8620196019576, -1074.7243769048232, -1012.8891324379142, -1201.3238823980957, -966.5872890883319, -993.9972759948329, -153.8696815367678, -422.73155097926747, -1331.945408443325, -239.15861901691406, -950.2428456761468, -494.3957041337018, -156.69515636360504, -1070.2954489079134, -1359.0116283925913, -1007.6900345104997, -211.39604323666128, -956.2302277752734, -1102.5432475836317, -1009.434489474311, -1193.2524010002314, -975.906967522273, -1121.2678139439781, -300.2295916376592, -225.93026079131425, -473.2461199496215, -1121.2225476996641, -479.8269451151468, -1109.7043690340467, -691.6256505635691, -261.0553432518816, -59.401938899194185, -363.25910959906435, -325.6151495967352, -866.7130080135913, -9.945166579435549, -178.40105736247125, -986.4836871182192, -424.3436369210991, -724.3894582381549, -230.36932822929575, -425.25858559195785, -934.7282074916602, -58.990583672297674, -399.29622525972064, -1092.9851791254696, -972.9838089104735, -1221.4048884670053, -1006.6887706263246, -108.05062642080092, -311.35216312345887, -924.9717390549163, -528.6522945238243, -137.20205816345884, -150.35076197175317, -1017.4219681985163, -1253.2378708610477, -966.2849836333716, -879.8252668860009, -713.3327912675012, -1157.200683174438, -927.8358690952418, -1391.6215464459733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530238319450758, "mean_inference_ms": 1.6678337195469373, "mean_action_processing_ms": 0.27546978049100806, "mean_env_wait_ms": 3.526375840158644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012278318405151367, "StateBufferConnector_ms": 0.00821542739868164, "ViewRequirementAgentConnector_ms": 0.1904127597808838}, "num_episodes": 30, "episode_return_max": -9.945166579435549, "episode_return_min": -1487.3913732786464, "episode_return_mean": -725.0234552670638, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.5239785757364, "num_env_steps_trained_throughput_per_sec": 301.5239785757364, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12875.21, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12875.136, "sample_time_ms": 1152.062, "learn_time_ms": 11655.837, "learn_throughput": 343.176, "synch_weights_time_ms": 66.453}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "1e132_00005", "date": "2024-08-04_08-21-41", "timestamp": 1722739901, "time_this_iter_s": 13.278242588043213, "time_total_s": 322.27624893188477, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e8700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.27624893188477, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.947368421052634, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 202.66874047120413, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.5300071824962893, "policy_loss": -0.009189405169551416, "vf_loss": 1.5369016060605645, "vf_explained_var": 0.9960485802342495, "kl": 0.012355978753657857, "entropy": 1.762160075455904, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -9.945166579435549, "episode_reward_min": -1496.000461037621, "episode_reward_mean": -703.7659667831703, "episode_len_mean": 123.75, "episode_media": {}, "episodes_timesteps_total": 12375, "policy_reward_min": {"policy_0": -1496.000461037621}, "policy_reward_max": {"policy_0": -9.945166579435549}, "policy_reward_mean": {"policy_0": -703.7659667831703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1487.3913732786464, -220.85892571583963, -461.1579533759499, -1231.5569540511015, -432.8620196019576, -1074.7243769048232, -1012.8891324379142, -1201.3238823980957, -966.5872890883319, -993.9972759948329, -153.8696815367678, -422.73155097926747, -1331.945408443325, -239.15861901691406, -950.2428456761468, -494.3957041337018, -156.69515636360504, -1070.2954489079134, -1359.0116283925913, -1007.6900345104997, -211.39604323666128, -956.2302277752734, -1102.5432475836317, -1009.434489474311, -1193.2524010002314, -975.906967522273, -1121.2678139439781, -300.2295916376592, -225.93026079131425, -473.2461199496215, -1121.2225476996641, -479.8269451151468, -1109.7043690340467, -691.6256505635691, -261.0553432518816, -59.401938899194185, -363.25910959906435, -325.6151495967352, -866.7130080135913, -9.945166579435549, -178.40105736247125, -986.4836871182192, -424.3436369210991, -724.3894582381549, -230.36932822929575, -425.25858559195785, -934.7282074916602, -58.990583672297674, -399.29622525972064, -1092.9851791254696, -972.9838089104735, -1221.4048884670053, -1006.6887706263246, -108.05062642080092, -311.35216312345887, -924.9717390549163, -528.6522945238243, -137.20205816345884, -150.35076197175317, -1017.4219681985163, -1253.2378708610477, -966.2849836333716, -879.8252668860009, -713.3327912675012, -1157.200683174438, -927.8358690952418, -1391.6215464459733, -374.24903036084606, -1107.0349676192689, -90.9287197856577, -1018.7920450338199, -29.102523453784585, -95.47025497909328, -1369.4386029192424, -1496.000461037621, -347.34938074699875, -1235.6397191990511, -1014.0368022146422, -240.29626673497182, -935.7048854931057, -101.10901985309026, -1216.5129761723288, -810.974616892404, -131.1328778593128, -56.058335013638, -1037.7192101846856, -241.92479543769332, -54.2468764383918, -1248.517819149438, -276.64222208500206, -18.087321357979626, -156.26336159432825, -525.7000249376218, -351.47376648463916, -32.1713963415797, -1446.4724350448116, -1426.3922156038998, -1272.1355158024726, -1149.0626807200213, -1219.0998598556332], "episode_lengths": [150, 102, 102, 150, 98, 150, 150, 150, 150, 150, 62, 100, 150, 108, 150, 150, 75, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 109, 77, 150, 150, 150, 150, 150, 104, 52, 125, 111, 150, 35, 137, 150, 117, 150, 75, 115, 150, 54, 121, 150, 150, 150, 150, 69, 91, 150, 150, 82, 76, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 60, 150, 49, 65, 150, 150, 102, 150, 150, 95, 150, 57, 150, 150, 76, 41, 150, 100, 46, 150, 126, 42, 92, 150, 150, 40, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1487.3913732786464, -220.85892571583963, -461.1579533759499, -1231.5569540511015, -432.8620196019576, -1074.7243769048232, -1012.8891324379142, -1201.3238823980957, -966.5872890883319, -993.9972759948329, -153.8696815367678, -422.73155097926747, -1331.945408443325, -239.15861901691406, -950.2428456761468, -494.3957041337018, -156.69515636360504, -1070.2954489079134, -1359.0116283925913, -1007.6900345104997, -211.39604323666128, -956.2302277752734, -1102.5432475836317, -1009.434489474311, -1193.2524010002314, -975.906967522273, -1121.2678139439781, -300.2295916376592, -225.93026079131425, -473.2461199496215, -1121.2225476996641, -479.8269451151468, -1109.7043690340467, -691.6256505635691, -261.0553432518816, -59.401938899194185, -363.25910959906435, -325.6151495967352, -866.7130080135913, -9.945166579435549, -178.40105736247125, -986.4836871182192, -424.3436369210991, -724.3894582381549, -230.36932822929575, -425.25858559195785, -934.7282074916602, -58.990583672297674, -399.29622525972064, -1092.9851791254696, -972.9838089104735, -1221.4048884670053, -1006.6887706263246, -108.05062642080092, -311.35216312345887, -924.9717390549163, -528.6522945238243, -137.20205816345884, -150.35076197175317, -1017.4219681985163, -1253.2378708610477, -966.2849836333716, -879.8252668860009, -713.3327912675012, -1157.200683174438, -927.8358690952418, -1391.6215464459733, -374.24903036084606, -1107.0349676192689, -90.9287197856577, -1018.7920450338199, -29.102523453784585, -95.47025497909328, -1369.4386029192424, -1496.000461037621, -347.34938074699875, -1235.6397191990511, -1014.0368022146422, -240.29626673497182, -935.7048854931057, -101.10901985309026, -1216.5129761723288, -810.974616892404, -131.1328778593128, -56.058335013638, -1037.7192101846856, -241.92479543769332, -54.2468764383918, -1248.517819149438, -276.64222208500206, -18.087321357979626, -156.26336159432825, -525.7000249376218, -351.47376648463916, -32.1713963415797, -1446.4724350448116, -1426.3922156038998, -1272.1355158024726, -1149.0626807200213, -1219.0998598556332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522983266518658, "mean_inference_ms": 1.666462579867828, "mean_action_processing_ms": 0.27520357247961996, "mean_env_wait_ms": 3.5229148935277066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012277603149414062, "StateBufferConnector_ms": 0.0078046321868896484, "ViewRequirementAgentConnector_ms": 0.18946576118469238}, "num_episodes": 33, "episode_return_max": -9.945166579435549, "episode_return_min": -1496.000461037621, "episode_return_mean": -703.7659667831703, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.1963470233849, "num_env_steps_trained_throughput_per_sec": 315.1963470233849, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12856.337, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12856.265, "sample_time_ms": 1149.775, "learn_time_ms": 11639.462, "learn_throughput": 343.658, "synch_weights_time_ms": 66.246}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "1e132_00005", "date": "2024-08-04_08-21-53", "timestamp": 1722739913, "time_this_iter_s": 12.702253103256226, "time_total_s": 334.978502035141, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.978502035141, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.477777777777778, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 255.71673596302668, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.5774111745258173, "policy_loss": -0.010788039800536353, "vf_loss": 1.585176244750619, "vf_explained_var": 0.9978086798762281, "kl": 0.01591672711292631, "entropy": 1.6037647660821677, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -9.945166579435549, "episode_reward_min": -1496.000461037621, "episode_reward_mean": -684.5225292277291, "episode_len_mean": 126.23, "episode_media": {}, "episodes_timesteps_total": 12623, "policy_reward_min": {"policy_0": -1496.000461037621}, "policy_reward_max": {"policy_0": -9.945166579435549}, "policy_reward_mean": {"policy_0": -684.5225292277291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-225.93026079131425, -473.2461199496215, -1121.2225476996641, -479.8269451151468, -1109.7043690340467, -691.6256505635691, -261.0553432518816, -59.401938899194185, -363.25910959906435, -325.6151495967352, -866.7130080135913, -9.945166579435549, -178.40105736247125, -986.4836871182192, -424.3436369210991, -724.3894582381549, -230.36932822929575, -425.25858559195785, -934.7282074916602, -58.990583672297674, -399.29622525972064, -1092.9851791254696, -972.9838089104735, -1221.4048884670053, -1006.6887706263246, -108.05062642080092, -311.35216312345887, -924.9717390549163, -528.6522945238243, -137.20205816345884, -150.35076197175317, -1017.4219681985163, -1253.2378708610477, -966.2849836333716, -879.8252668860009, -713.3327912675012, -1157.200683174438, -927.8358690952418, -1391.6215464459733, -374.24903036084606, -1107.0349676192689, -90.9287197856577, -1018.7920450338199, -29.102523453784585, -95.47025497909328, -1369.4386029192424, -1496.000461037621, -347.34938074699875, -1235.6397191990511, -1014.0368022146422, -240.29626673497182, -935.7048854931057, -101.10901985309026, -1216.5129761723288, -810.974616892404, -131.1328778593128, -56.058335013638, -1037.7192101846856, -241.92479543769332, -54.2468764383918, -1248.517819149438, -276.64222208500206, -18.087321357979626, -156.26336159432825, -525.7000249376218, -351.47376648463916, -32.1713963415797, -1446.4724350448116, -1426.3922156038998, -1272.1355158024726, -1149.0626807200213, -1219.0998598556332, -385.62768195852163, -949.8210397964452, -561.3842230690182, -1431.6207672533153, -1207.4217314619673, -256.5381478839778, -595.4026702123207, -440.3573898981326, -306.285713946371, -1115.9821424754186, -1015.6917992423693, -695.1591934103926, -146.9524139223488, -1057.1297616098873, -775.3487053008756, -978.2255235425655, -676.814201652239, -1118.8110042039066, -416.8713602802094, -665.6351812568042, -655.084082030992, -270.8859239234226, -928.8954919031853, -955.1401093090697, -551.0145098752091, -1209.5373669196988, -459.56983899307505, -1388.0943121063774], "episode_lengths": [77, 150, 150, 150, 150, 150, 104, 52, 125, 111, 150, 35, 137, 150, 117, 150, 75, 115, 150, 54, 121, 150, 150, 150, 150, 69, 91, 150, 150, 82, 76, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 60, 150, 49, 65, 150, 150, 102, 150, 150, 95, 150, 57, 150, 150, 76, 41, 150, 100, 46, 150, 126, 42, 92, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 130, 100, 150, 150, 150, 55, 150, 150, 150, 150, 150, 124, 150, 150, 128, 150, 150, 150, 150, 138, 150], "policy_policy_0_reward": [-225.93026079131425, -473.2461199496215, -1121.2225476996641, -479.8269451151468, -1109.7043690340467, -691.6256505635691, -261.0553432518816, -59.401938899194185, -363.25910959906435, -325.6151495967352, -866.7130080135913, -9.945166579435549, -178.40105736247125, -986.4836871182192, -424.3436369210991, -724.3894582381549, -230.36932822929575, -425.25858559195785, -934.7282074916602, -58.990583672297674, -399.29622525972064, -1092.9851791254696, -972.9838089104735, -1221.4048884670053, -1006.6887706263246, -108.05062642080092, -311.35216312345887, -924.9717390549163, -528.6522945238243, -137.20205816345884, -150.35076197175317, -1017.4219681985163, -1253.2378708610477, -966.2849836333716, -879.8252668860009, -713.3327912675012, -1157.200683174438, -927.8358690952418, -1391.6215464459733, -374.24903036084606, -1107.0349676192689, -90.9287197856577, -1018.7920450338199, -29.102523453784585, -95.47025497909328, -1369.4386029192424, -1496.000461037621, -347.34938074699875, -1235.6397191990511, -1014.0368022146422, -240.29626673497182, -935.7048854931057, -101.10901985309026, -1216.5129761723288, -810.974616892404, -131.1328778593128, -56.058335013638, -1037.7192101846856, -241.92479543769332, -54.2468764383918, -1248.517819149438, -276.64222208500206, -18.087321357979626, -156.26336159432825, -525.7000249376218, -351.47376648463916, -32.1713963415797, -1446.4724350448116, -1426.3922156038998, -1272.1355158024726, -1149.0626807200213, -1219.0998598556332, -385.62768195852163, -949.8210397964452, -561.3842230690182, -1431.6207672533153, -1207.4217314619673, -256.5381478839778, -595.4026702123207, -440.3573898981326, -306.285713946371, -1115.9821424754186, -1015.6917992423693, -695.1591934103926, -146.9524139223488, -1057.1297616098873, -775.3487053008756, -978.2255235425655, -676.814201652239, -1118.8110042039066, -416.8713602802094, -665.6351812568042, -655.084082030992, -270.8859239234226, -928.8954919031853, -955.1401093090697, -551.0145098752091, -1209.5373669196988, -459.56983899307505, -1388.0943121063774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520401181614659, "mean_inference_ms": 1.6659478919084707, "mean_action_processing_ms": 0.2748389844074609, "mean_env_wait_ms": 3.5205583814912704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012255668640136719, "StateBufferConnector_ms": 0.007915496826171875, "ViewRequirementAgentConnector_ms": 0.19295120239257812}, "num_episodes": 28, "episode_return_max": -9.945166579435549, "episode_return_min": -1496.000461037621, "episode_return_mean": -684.5225292277291, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.6130201945298, "num_env_steps_trained_throughput_per_sec": 318.6130201945298, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12800.395, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12800.322, "sample_time_ms": 1148.919, "learn_time_ms": 11583.356, "learn_throughput": 345.323, "synch_weights_time_ms": 67.263}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "1e132_00005", "date": "2024-08-04_08-22-06", "timestamp": 1722739926, "time_this_iter_s": 12.566985368728638, "time_total_s": 347.54548740386963, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344736170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.54548740386963, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.355555555555554, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.146541061004, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.5400560558773577, "policy_loss": -0.012662581671611406, "vf_loss": 1.5495409129808346, "vf_explained_var": 0.9938788941130042, "kl": 0.0166723058679054, "entropy": 1.5673493781437478, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -18.087321357979626, "episode_reward_min": -1496.000461037621, "episode_reward_mean": -747.4558772401101, "episode_len_mean": 132.6, "episode_media": {}, "episodes_timesteps_total": 13260, "policy_reward_min": {"policy_0": -1496.000461037621}, "policy_reward_max": {"policy_0": -18.087321357979626}, "policy_reward_mean": {"policy_0": -747.4558772401101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150.35076197175317, -1017.4219681985163, -1253.2378708610477, -966.2849836333716, -879.8252668860009, -713.3327912675012, -1157.200683174438, -927.8358690952418, -1391.6215464459733, -374.24903036084606, -1107.0349676192689, -90.9287197856577, -1018.7920450338199, -29.102523453784585, -95.47025497909328, -1369.4386029192424, -1496.000461037621, -347.34938074699875, -1235.6397191990511, -1014.0368022146422, -240.29626673497182, -935.7048854931057, -101.10901985309026, -1216.5129761723288, -810.974616892404, -131.1328778593128, -56.058335013638, -1037.7192101846856, -241.92479543769332, -54.2468764383918, -1248.517819149438, -276.64222208500206, -18.087321357979626, -156.26336159432825, -525.7000249376218, -351.47376648463916, -32.1713963415797, -1446.4724350448116, -1426.3922156038998, -1272.1355158024726, -1149.0626807200213, -1219.0998598556332, -385.62768195852163, -949.8210397964452, -561.3842230690182, -1431.6207672533153, -1207.4217314619673, -256.5381478839778, -595.4026702123207, -440.3573898981326, -306.285713946371, -1115.9821424754186, -1015.6917992423693, -695.1591934103926, -146.9524139223488, -1057.1297616098873, -775.3487053008756, -978.2255235425655, -676.814201652239, -1118.8110042039066, -416.8713602802094, -665.6351812568042, -655.084082030992, -270.8859239234226, -928.8954919031853, -955.1401093090697, -551.0145098752091, -1209.5373669196988, -459.56983899307505, -1388.0943121063774, -983.0000796370924, -397.6146267229105, -849.201313127366, -582.0707660010925, -577.2760886610995, -978.4635486982213, -245.33443014377852, -595.48612768479, -374.82578975020874, -215.21141044387048, -1098.0985001893564, -885.370149649751, -1234.5614727759707, -385.2968434830991, -597.8556752435661, -140.25219874650514, -374.23492436151224, -1041.5619308961786, -825.9068528818608, -939.3842625147938, -1142.8462142364788, -447.1976270136855, -1022.276605385179, -901.0034700912205, -929.6029362379068, -602.9793436593646, -948.7475285610391, -1179.7349684357268, -1065.4095872191222, -1386.6274361792093], "episode_lengths": [76, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 60, 150, 49, 65, 150, 150, 102, 150, 150, 95, 150, 57, 150, 150, 76, 41, 150, 100, 46, 150, 126, 42, 92, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 130, 100, 150, 150, 150, 55, 150, 150, 150, 150, 150, 124, 150, 150, 128, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 111, 150, 101, 150, 135, 150, 150, 150, 150, 120, 150, 75, 127, 150, 150, 150, 150, 135, 150, 150, 150, 148, 150, 150, 150, 150], "policy_policy_0_reward": [-150.35076197175317, -1017.4219681985163, -1253.2378708610477, -966.2849836333716, -879.8252668860009, -713.3327912675012, -1157.200683174438, -927.8358690952418, -1391.6215464459733, -374.24903036084606, -1107.0349676192689, -90.9287197856577, -1018.7920450338199, -29.102523453784585, -95.47025497909328, -1369.4386029192424, -1496.000461037621, -347.34938074699875, -1235.6397191990511, -1014.0368022146422, -240.29626673497182, -935.7048854931057, -101.10901985309026, -1216.5129761723288, -810.974616892404, -131.1328778593128, -56.058335013638, -1037.7192101846856, -241.92479543769332, -54.2468764383918, -1248.517819149438, -276.64222208500206, -18.087321357979626, -156.26336159432825, -525.7000249376218, -351.47376648463916, -32.1713963415797, -1446.4724350448116, -1426.3922156038998, -1272.1355158024726, -1149.0626807200213, -1219.0998598556332, -385.62768195852163, -949.8210397964452, -561.3842230690182, -1431.6207672533153, -1207.4217314619673, -256.5381478839778, -595.4026702123207, -440.3573898981326, -306.285713946371, -1115.9821424754186, -1015.6917992423693, -695.1591934103926, -146.9524139223488, -1057.1297616098873, -775.3487053008756, -978.2255235425655, -676.814201652239, -1118.8110042039066, -416.8713602802094, -665.6351812568042, -655.084082030992, -270.8859239234226, -928.8954919031853, -955.1401093090697, -551.0145098752091, -1209.5373669196988, -459.56983899307505, -1388.0943121063774, -983.0000796370924, -397.6146267229105, -849.201313127366, -582.0707660010925, -577.2760886610995, -978.4635486982213, -245.33443014377852, -595.48612768479, -374.82578975020874, -215.21141044387048, -1098.0985001893564, -885.370149649751, -1234.5614727759707, -385.2968434830991, -597.8556752435661, -140.25219874650514, -374.23492436151224, -1041.5619308961786, -825.9068528818608, -939.3842625147938, -1142.8462142364788, -447.1976270136855, -1022.276605385179, -901.0034700912205, -929.6029362379068, -602.9793436593646, -948.7475285610391, -1179.7349684357268, -1065.4095872191222, -1386.6274361792093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519028986848468, "mean_inference_ms": 1.665465470176577, "mean_action_processing_ms": 0.2747034777059431, "mean_env_wait_ms": 3.5211053624001414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012251615524291992, "StateBufferConnector_ms": 0.007955074310302734, "ViewRequirementAgentConnector_ms": 0.1958751678466797}, "num_episodes": 30, "episode_return_max": -18.087321357979626, "episode_return_min": -1496.000461037621, "episode_return_mean": -747.4558772401101, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.37824273925656, "num_env_steps_trained_throughput_per_sec": 299.37824273925656, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12850.294, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12850.221, "sample_time_ms": 1145.519, "learn_time_ms": 11637.914, "learn_throughput": 343.704, "synch_weights_time_ms": 65.995}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "1e132_00005", "date": "2024-08-04_08-22-19", "timestamp": 1722739939, "time_this_iter_s": 13.373779058456421, "time_total_s": 360.91926646232605, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e8700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 360.91926646232605, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.905263157894737, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.44873702923456, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.8293200585991145, "policy_loss": -0.007092228335386608, "vf_loss": 1.8337460066502294, "vf_explained_var": 0.990528853610158, "kl": 0.014097658966761628, "entropy": 1.5325121981402239, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -32.1713963415797, "episode_reward_min": -1446.4724350448116, "episode_reward_mean": -717.6853517775339, "episode_len_mean": 134.24, "episode_media": {}, "episodes_timesteps_total": 13424, "policy_reward_min": {"policy_0": -1446.4724350448116}, "policy_reward_max": {"policy_0": -32.1713963415797}, "policy_reward_mean": {"policy_0": -717.6853517775339}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156.26336159432825, -525.7000249376218, -351.47376648463916, -32.1713963415797, -1446.4724350448116, -1426.3922156038998, -1272.1355158024726, -1149.0626807200213, -1219.0998598556332, -385.62768195852163, -949.8210397964452, -561.3842230690182, -1431.6207672533153, -1207.4217314619673, -256.5381478839778, -595.4026702123207, -440.3573898981326, -306.285713946371, -1115.9821424754186, -1015.6917992423693, -695.1591934103926, -146.9524139223488, -1057.1297616098873, -775.3487053008756, -978.2255235425655, -676.814201652239, -1118.8110042039066, -416.8713602802094, -665.6351812568042, -655.084082030992, -270.8859239234226, -928.8954919031853, -955.1401093090697, -551.0145098752091, -1209.5373669196988, -459.56983899307505, -1388.0943121063774, -983.0000796370924, -397.6146267229105, -849.201313127366, -582.0707660010925, -577.2760886610995, -978.4635486982213, -245.33443014377852, -595.48612768479, -374.82578975020874, -215.21141044387048, -1098.0985001893564, -885.370149649751, -1234.5614727759707, -385.2968434830991, -597.8556752435661, -140.25219874650514, -374.23492436151224, -1041.5619308961786, -825.9068528818608, -939.3842625147938, -1142.8462142364788, -447.1976270136855, -1022.276605385179, -901.0034700912205, -929.6029362379068, -602.9793436593646, -948.7475285610391, -1179.7349684357268, -1065.4095872191222, -1386.6274361792093, -972.9677069335653, -467.2945167918778, -1151.7424722828894, -487.5528760910093, -97.22615096526333, -997.6571430708882, -595.3001837541929, -1163.309201798101, -823.4888504707658, -934.9462877098035, -898.7513132943936, -44.988528716162605, -142.42159074090583, -694.7786489522979, -355.7090132185274, -1101.2386320629425, -414.41208071653256, -961.6100978021625, -49.73369818235663, -931.5224729590742, -260.74760031653574, -258.626171793042, -205.58854042362782, -196.17307583162568, -1058.221559351363, -1148.6491818025236, -174.59704130131502, -470.35787737422737, -516.2360118678188, -684.4495506595483, -492.8643742773642, -1169.5276904782365, -104.33878330737156], "episode_lengths": [92, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 130, 100, 150, 150, 150, 55, 150, 150, 150, 150, 150, 124, 150, 150, 128, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 111, 150, 101, 150, 135, 150, 150, 150, 150, 120, 150, 75, 127, 150, 150, 150, 150, 135, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 46, 51, 133, 85, 150, 140, 150, 35, 150, 93, 150, 89, 73, 150, 150, 97, 107, 150, 150, 150, 150, 69], "policy_policy_0_reward": [-156.26336159432825, -525.7000249376218, -351.47376648463916, -32.1713963415797, -1446.4724350448116, -1426.3922156038998, -1272.1355158024726, -1149.0626807200213, -1219.0998598556332, -385.62768195852163, -949.8210397964452, -561.3842230690182, -1431.6207672533153, -1207.4217314619673, -256.5381478839778, -595.4026702123207, -440.3573898981326, -306.285713946371, -1115.9821424754186, -1015.6917992423693, -695.1591934103926, -146.9524139223488, -1057.1297616098873, -775.3487053008756, -978.2255235425655, -676.814201652239, -1118.8110042039066, -416.8713602802094, -665.6351812568042, -655.084082030992, -270.8859239234226, -928.8954919031853, -955.1401093090697, -551.0145098752091, -1209.5373669196988, -459.56983899307505, -1388.0943121063774, -983.0000796370924, -397.6146267229105, -849.201313127366, -582.0707660010925, -577.2760886610995, -978.4635486982213, -245.33443014377852, -595.48612768479, -374.82578975020874, -215.21141044387048, -1098.0985001893564, -885.370149649751, -1234.5614727759707, -385.2968434830991, -597.8556752435661, -140.25219874650514, -374.23492436151224, -1041.5619308961786, -825.9068528818608, -939.3842625147938, -1142.8462142364788, -447.1976270136855, -1022.276605385179, -901.0034700912205, -929.6029362379068, -602.9793436593646, -948.7475285610391, -1179.7349684357268, -1065.4095872191222, -1386.6274361792093, -972.9677069335653, -467.2945167918778, -1151.7424722828894, -487.5528760910093, -97.22615096526333, -997.6571430708882, -595.3001837541929, -1163.309201798101, -823.4888504707658, -934.9462877098035, -898.7513132943936, -44.988528716162605, -142.42159074090583, -694.7786489522979, -355.7090132185274, -1101.2386320629425, -414.41208071653256, -961.6100978021625, -49.73369818235663, -931.5224729590742, -260.74760031653574, -258.626171793042, -205.58854042362782, -196.17307583162568, -1058.221559351363, -1148.6491818025236, -174.59704130131502, -470.35787737422737, -516.2360118678188, -684.4495506595483, -492.8643742773642, -1169.5276904782365, -104.33878330737156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521886389640239, "mean_inference_ms": 1.667093375094483, "mean_action_processing_ms": 0.27469145549841256, "mean_env_wait_ms": 3.522481723710643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011970281600952148, "StateBufferConnector_ms": 0.00795125961303711, "ViewRequirementAgentConnector_ms": 0.19663000106811523}, "num_episodes": 33, "episode_return_max": -32.1713963415797, "episode_return_min": -1446.4724350448116, "episode_return_mean": -717.6853517775339, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.8778661811581, "num_env_steps_trained_throughput_per_sec": 299.8778661811581, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12866.405, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12866.332, "sample_time_ms": 1159.078, "learn_time_ms": 11638.51, "learn_throughput": 343.687, "synch_weights_time_ms": 67.949}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "1e132_00005", "date": "2024-08-04_08-22-33", "timestamp": 1722739953, "time_this_iter_s": 13.351391077041626, "time_total_s": 374.2706575393677, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447baa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 374.2706575393677, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.894736842105264, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.91043348113695, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.4506048946330945, "policy_loss": -0.004296742931668026, "vf_loss": 1.4523688602571687, "vf_explained_var": 0.9895224553222458, "kl": 0.013418393023357582, "entropy": 1.5090345786263546, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -44.988528716162605, "episode_reward_min": -1388.0943121063774, "episode_reward_mean": -672.2887530305825, "episode_len_mean": 131.3, "episode_media": {}, "episodes_timesteps_total": 13130, "policy_reward_min": {"policy_0": -1388.0943121063774}, "policy_reward_max": {"policy_0": -44.988528716162605}, "policy_reward_mean": {"policy_0": -672.2887530305825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-955.1401093090697, -551.0145098752091, -1209.5373669196988, -459.56983899307505, -1388.0943121063774, -983.0000796370924, -397.6146267229105, -849.201313127366, -582.0707660010925, -577.2760886610995, -978.4635486982213, -245.33443014377852, -595.48612768479, -374.82578975020874, -215.21141044387048, -1098.0985001893564, -885.370149649751, -1234.5614727759707, -385.2968434830991, -597.8556752435661, -140.25219874650514, -374.23492436151224, -1041.5619308961786, -825.9068528818608, -939.3842625147938, -1142.8462142364788, -447.1976270136855, -1022.276605385179, -901.0034700912205, -929.6029362379068, -602.9793436593646, -948.7475285610391, -1179.7349684357268, -1065.4095872191222, -1386.6274361792093, -972.9677069335653, -467.2945167918778, -1151.7424722828894, -487.5528760910093, -97.22615096526333, -997.6571430708882, -595.3001837541929, -1163.309201798101, -823.4888504707658, -934.9462877098035, -898.7513132943936, -44.988528716162605, -142.42159074090583, -694.7786489522979, -355.7090132185274, -1101.2386320629425, -414.41208071653256, -961.6100978021625, -49.73369818235663, -931.5224729590742, -260.74760031653574, -258.626171793042, -205.58854042362782, -196.17307583162568, -1058.221559351363, -1148.6491818025236, -174.59704130131502, -470.35787737422737, -516.2360118678188, -684.4495506595483, -492.8643742773642, -1169.5276904782365, -104.33878330737156, -1252.4893841519097, -803.247450148134, -131.92470601747445, -331.6443811994675, -1018.1049668281868, -530.5324878312753, -166.1243345263792, -207.21543625195503, -1038.806694155119, -940.6682405616867, -204.54258436003806, -451.4701512632334, -580.7297669226854, -1228.9253204076197, -537.6668567209194, -1332.3336362844125, -913.4752037797717, -154.4794446815499, -431.16867382784756, -1074.0693821003224, -1097.403464363469, -398.4411183740522, -147.11130426240294, -972.1828524000106, -62.85161343857141, -1056.759887242673, -580.2622747076363, -341.21041181341303, -289.39738166941726, -74.0901909115019, -439.99795895902827, -901.7299717623822], "episode_lengths": [150, 150, 150, 138, 150, 150, 150, 150, 150, 111, 150, 101, 150, 135, 150, 150, 150, 150, 120, 150, 75, 127, 150, 150, 150, 150, 135, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 46, 51, 133, 85, 150, 140, 150, 35, 150, 93, 150, 89, 73, 150, 150, 97, 107, 150, 150, 150, 150, 69, 150, 150, 75, 90, 150, 150, 75, 124, 150, 150, 61, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 136, 97, 150, 61, 150, 150, 150, 122, 54, 105, 150], "policy_policy_0_reward": [-955.1401093090697, -551.0145098752091, -1209.5373669196988, -459.56983899307505, -1388.0943121063774, -983.0000796370924, -397.6146267229105, -849.201313127366, -582.0707660010925, -577.2760886610995, -978.4635486982213, -245.33443014377852, -595.48612768479, -374.82578975020874, -215.21141044387048, -1098.0985001893564, -885.370149649751, -1234.5614727759707, -385.2968434830991, -597.8556752435661, -140.25219874650514, -374.23492436151224, -1041.5619308961786, -825.9068528818608, -939.3842625147938, -1142.8462142364788, -447.1976270136855, -1022.276605385179, -901.0034700912205, -929.6029362379068, -602.9793436593646, -948.7475285610391, -1179.7349684357268, -1065.4095872191222, -1386.6274361792093, -972.9677069335653, -467.2945167918778, -1151.7424722828894, -487.5528760910093, -97.22615096526333, -997.6571430708882, -595.3001837541929, -1163.309201798101, -823.4888504707658, -934.9462877098035, -898.7513132943936, -44.988528716162605, -142.42159074090583, -694.7786489522979, -355.7090132185274, -1101.2386320629425, -414.41208071653256, -961.6100978021625, -49.73369818235663, -931.5224729590742, -260.74760031653574, -258.626171793042, -205.58854042362782, -196.17307583162568, -1058.221559351363, -1148.6491818025236, -174.59704130131502, -470.35787737422737, -516.2360118678188, -684.4495506595483, -492.8643742773642, -1169.5276904782365, -104.33878330737156, -1252.4893841519097, -803.247450148134, -131.92470601747445, -331.6443811994675, -1018.1049668281868, -530.5324878312753, -166.1243345263792, -207.21543625195503, -1038.806694155119, -940.6682405616867, -204.54258436003806, -451.4701512632334, -580.7297669226854, -1228.9253204076197, -537.6668567209194, -1332.3336362844125, -913.4752037797717, -154.4794446815499, -431.16867382784756, -1074.0693821003224, -1097.403464363469, -398.4411183740522, -147.11130426240294, -972.1828524000106, -62.85161343857141, -1056.759887242673, -580.2622747076363, -341.21041181341303, -289.39738166941726, -74.0901909115019, -439.99795895902827, -901.7299717623822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524939191488388, "mean_inference_ms": 1.6682754774640136, "mean_action_processing_ms": 0.2746294835130515, "mean_env_wait_ms": 3.523182846242055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012094497680664062, "StateBufferConnector_ms": 0.007844209671020508, "ViewRequirementAgentConnector_ms": 0.19413089752197266}, "num_episodes": 32, "episode_return_max": -44.988528716162605, "episode_return_min": -1388.0943121063774, "episode_return_mean": -672.2887530305825, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.41539051009005, "num_env_steps_trained_throughput_per_sec": 300.41539051009005, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12889.108, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12889.036, "sample_time_ms": 1161.389, "learn_time_ms": 11659.502, "learn_throughput": 343.068, "synch_weights_time_ms": 67.347}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "1e132_00005", "date": "2024-08-04_08-22-46", "timestamp": 1722739966, "time_this_iter_s": 13.327382564544678, "time_total_s": 387.59804010391235, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bb6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 387.59804010391235, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.842105263157894, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 221.30971737702689, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.3384506807352106, "policy_loss": -0.011694229557421446, "vf_loss": 1.3475500939413905, "vf_explained_var": 0.99547723090897, "kl": 0.01382217872323965, "entropy": 1.696220025792718, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -44.12361816717089, "episode_reward_min": -1386.6274361792093, "episode_reward_mean": -652.0159743182501, "episode_len_mean": 126.8, "episode_media": {}, "episodes_timesteps_total": 12680, "policy_reward_min": {"policy_0": -1386.6274361792093}, "policy_reward_max": {"policy_0": -44.12361816717089}, "policy_reward_mean": {"policy_0": -652.0159743182501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-602.9793436593646, -948.7475285610391, -1179.7349684357268, -1065.4095872191222, -1386.6274361792093, -972.9677069335653, -467.2945167918778, -1151.7424722828894, -487.5528760910093, -97.22615096526333, -997.6571430708882, -595.3001837541929, -1163.309201798101, -823.4888504707658, -934.9462877098035, -898.7513132943936, -44.988528716162605, -142.42159074090583, -694.7786489522979, -355.7090132185274, -1101.2386320629425, -414.41208071653256, -961.6100978021625, -49.73369818235663, -931.5224729590742, -260.74760031653574, -258.626171793042, -205.58854042362782, -196.17307583162568, -1058.221559351363, -1148.6491818025236, -174.59704130131502, -470.35787737422737, -516.2360118678188, -684.4495506595483, -492.8643742773642, -1169.5276904782365, -104.33878330737156, -1252.4893841519097, -803.247450148134, -131.92470601747445, -331.6443811994675, -1018.1049668281868, -530.5324878312753, -166.1243345263792, -207.21543625195503, -1038.806694155119, -940.6682405616867, -204.54258436003806, -451.4701512632334, -580.7297669226854, -1228.9253204076197, -537.6668567209194, -1332.3336362844125, -913.4752037797717, -154.4794446815499, -431.16867382784756, -1074.0693821003224, -1097.403464363469, -398.4411183740522, -147.11130426240294, -972.1828524000106, -62.85161343857141, -1056.759887242673, -580.2622747076363, -341.21041181341303, -289.39738166941726, -74.0901909115019, -439.99795895902827, -901.7299717623822, -895.869488421487, -1231.1798984780967, -967.252545183678, -1021.3080278030445, -1097.5323031837954, -793.9815006593619, -1273.868672559075, -1128.8949120523132, -44.12361816717089, -997.2441212304524, -166.75988773369573, -203.935063657334, -160.51010643046945, -715.590564632818, -1084.9658743727605, -850.4121688517813, -843.8107319957991, -133.58754372266546, -901.9131254857405, -1158.6262566967955, -590.5163899936807, -80.1269644132635, -310.74641099038394, -485.13455209603103, -260.5035619832599, -402.3159860442172, -876.0001315937194, -953.8504337915346, -73.57985421984351, -595.8714141034186], "episode_lengths": [148, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 46, 51, 133, 85, 150, 140, 150, 35, 150, 93, 150, 89, 73, 150, 150, 97, 107, 150, 150, 150, 150, 69, 150, 150, 75, 90, 150, 150, 75, 124, 150, 150, 61, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 136, 97, 150, 61, 150, 150, 150, 122, 54, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 75, 86, 79, 150, 150, 150, 150, 80, 150, 150, 150, 57, 104, 113, 106, 150, 150, 150, 46, 150], "policy_policy_0_reward": [-602.9793436593646, -948.7475285610391, -1179.7349684357268, -1065.4095872191222, -1386.6274361792093, -972.9677069335653, -467.2945167918778, -1151.7424722828894, -487.5528760910093, -97.22615096526333, -997.6571430708882, -595.3001837541929, -1163.309201798101, -823.4888504707658, -934.9462877098035, -898.7513132943936, -44.988528716162605, -142.42159074090583, -694.7786489522979, -355.7090132185274, -1101.2386320629425, -414.41208071653256, -961.6100978021625, -49.73369818235663, -931.5224729590742, -260.74760031653574, -258.626171793042, -205.58854042362782, -196.17307583162568, -1058.221559351363, -1148.6491818025236, -174.59704130131502, -470.35787737422737, -516.2360118678188, -684.4495506595483, -492.8643742773642, -1169.5276904782365, -104.33878330737156, -1252.4893841519097, -803.247450148134, -131.92470601747445, -331.6443811994675, -1018.1049668281868, -530.5324878312753, -166.1243345263792, -207.21543625195503, -1038.806694155119, -940.6682405616867, -204.54258436003806, -451.4701512632334, -580.7297669226854, -1228.9253204076197, -537.6668567209194, -1332.3336362844125, -913.4752037797717, -154.4794446815499, -431.16867382784756, -1074.0693821003224, -1097.403464363469, -398.4411183740522, -147.11130426240294, -972.1828524000106, -62.85161343857141, -1056.759887242673, -580.2622747076363, -341.21041181341303, -289.39738166941726, -74.0901909115019, -439.99795895902827, -901.7299717623822, -895.869488421487, -1231.1798984780967, -967.252545183678, -1021.3080278030445, -1097.5323031837954, -793.9815006593619, -1273.868672559075, -1128.8949120523132, -44.12361816717089, -997.2441212304524, -166.75988773369573, -203.935063657334, -160.51010643046945, -715.590564632818, -1084.9658743727605, -850.4121688517813, -843.8107319957991, -133.58754372266546, -901.9131254857405, -1158.6262566967955, -590.5163899936807, -80.1269644132635, -310.74641099038394, -485.13455209603103, -260.5035619832599, -402.3159860442172, -876.0001315937194, -953.8504337915346, -73.57985421984351, -595.8714141034186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523850306434884, "mean_inference_ms": 1.6896232222590828, "mean_action_processing_ms": 0.2746283375841423, "mean_env_wait_ms": 3.5224940929331314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012504339218139648, "StateBufferConnector_ms": 0.007936239242553711, "ViewRequirementAgentConnector_ms": 0.19132590293884277}, "num_episodes": 30, "episode_return_max": -44.12361816717089, "episode_return_min": -1386.6274361792093, "episode_return_mean": -652.0159743182501, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.3736134302827, "num_env_steps_trained_throughput_per_sec": 292.3736134302827, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12987.634, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12987.562, "sample_time_ms": 1200.07, "learn_time_ms": 11721.078, "learn_throughput": 341.266, "synch_weights_time_ms": 65.615}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "1e132_00005", "date": "2024-08-04_08-23-00", "timestamp": 1722739980, "time_this_iter_s": 13.693122863769531, "time_total_s": 401.2911629676819, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.2911629676819, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.394736842105264, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 236.3592855334282, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.2698687299154698, "policy_loss": -0.015062440798889536, "vf_loss": 1.2815751551029584, "vf_explained_var": 0.9987043171500166, "kl": 0.017626326367098977, "entropy": 1.6924716483801603, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -9.373730170500709, "episode_reward_min": -1507.2791853481033, "episode_reward_mean": -635.8486755760568, "episode_len_mean": 125.26, "episode_media": {}, "episodes_timesteps_total": 12526, "policy_reward_min": {"policy_0": -1507.2791853481033}, "policy_reward_max": {"policy_0": -9.373730170500709}, "policy_reward_mean": {"policy_0": -635.8486755760568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-684.4495506595483, -492.8643742773642, -1169.5276904782365, -104.33878330737156, -1252.4893841519097, -803.247450148134, -131.92470601747445, -331.6443811994675, -1018.1049668281868, -530.5324878312753, -166.1243345263792, -207.21543625195503, -1038.806694155119, -940.6682405616867, -204.54258436003806, -451.4701512632334, -580.7297669226854, -1228.9253204076197, -537.6668567209194, -1332.3336362844125, -913.4752037797717, -154.4794446815499, -431.16867382784756, -1074.0693821003224, -1097.403464363469, -398.4411183740522, -147.11130426240294, -972.1828524000106, -62.85161343857141, -1056.759887242673, -580.2622747076363, -341.21041181341303, -289.39738166941726, -74.0901909115019, -439.99795895902827, -901.7299717623822, -895.869488421487, -1231.1798984780967, -967.252545183678, -1021.3080278030445, -1097.5323031837954, -793.9815006593619, -1273.868672559075, -1128.8949120523132, -44.12361816717089, -997.2441212304524, -166.75988773369573, -203.935063657334, -160.51010643046945, -715.590564632818, -1084.9658743727605, -850.4121688517813, -843.8107319957991, -133.58754372266546, -901.9131254857405, -1158.6262566967955, -590.5163899936807, -80.1269644132635, -310.74641099038394, -485.13455209603103, -260.5035619832599, -402.3159860442172, -876.0001315937194, -953.8504337915346, -73.57985421984351, -595.8714141034186, -985.4551072703019, -1126.1587624169574, -713.0772948564979, -1010.6358337203342, -285.5312630569911, -888.7418716541912, -453.1449147597323, -1239.3390451899174, -788.0712482690545, -1095.4043220630756, -325.8713879654549, -106.72847759838002, -1187.985066388528, -88.47902645884037, -807.28089340559, -83.51932389963716, -798.1729514236337, -400.57078969986, -1194.1289537289922, -1178.9611514083579, -9.373730170500709, -225.65648920994255, -25.108893815008987, -150.29021847136173, -685.7322191810106, -1507.2791853481033, -386.566744824501, -1029.3243001783055, -63.599260009406024, -861.0708910633319, -723.1854971360607, -223.6385599800235, -437.2066286115665, -57.32721317747782], "episode_lengths": [150, 150, 150, 69, 150, 150, 75, 90, 150, 150, 75, 124, 150, 150, 61, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 136, 97, 150, 61, 150, 150, 150, 122, 54, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 75, 86, 79, 150, 150, 150, 150, 80, 150, 150, 150, 57, 104, 113, 106, 150, 150, 150, 46, 150, 150, 150, 150, 150, 102, 150, 134, 150, 150, 150, 150, 76, 150, 64, 150, 67, 150, 122, 150, 150, 33, 94, 43, 76, 150, 150, 126, 150, 61, 150, 150, 85, 150, 60], "policy_policy_0_reward": [-684.4495506595483, -492.8643742773642, -1169.5276904782365, -104.33878330737156, -1252.4893841519097, -803.247450148134, -131.92470601747445, -331.6443811994675, -1018.1049668281868, -530.5324878312753, -166.1243345263792, -207.21543625195503, -1038.806694155119, -940.6682405616867, -204.54258436003806, -451.4701512632334, -580.7297669226854, -1228.9253204076197, -537.6668567209194, -1332.3336362844125, -913.4752037797717, -154.4794446815499, -431.16867382784756, -1074.0693821003224, -1097.403464363469, -398.4411183740522, -147.11130426240294, -972.1828524000106, -62.85161343857141, -1056.759887242673, -580.2622747076363, -341.21041181341303, -289.39738166941726, -74.0901909115019, -439.99795895902827, -901.7299717623822, -895.869488421487, -1231.1798984780967, -967.252545183678, -1021.3080278030445, -1097.5323031837954, -793.9815006593619, -1273.868672559075, -1128.8949120523132, -44.12361816717089, -997.2441212304524, -166.75988773369573, -203.935063657334, -160.51010643046945, -715.590564632818, -1084.9658743727605, -850.4121688517813, -843.8107319957991, -133.58754372266546, -901.9131254857405, -1158.6262566967955, -590.5163899936807, -80.1269644132635, -310.74641099038394, -485.13455209603103, -260.5035619832599, -402.3159860442172, -876.0001315937194, -953.8504337915346, -73.57985421984351, -595.8714141034186, -985.4551072703019, -1126.1587624169574, -713.0772948564979, -1010.6358337203342, -285.5312630569911, -888.7418716541912, -453.1449147597323, -1239.3390451899174, -788.0712482690545, -1095.4043220630756, -325.8713879654549, -106.72847759838002, -1187.985066388528, -88.47902645884037, -807.28089340559, -83.51932389963716, -798.1729514236337, -400.57078969986, -1194.1289537289922, -1178.9611514083579, -9.373730170500709, -225.65648920994255, -25.108893815008987, -150.29021847136173, -685.7322191810106, -1507.2791853481033, -386.566744824501, -1029.3243001783055, -63.599260009406024, -861.0708910633319, -723.1854971360607, -223.6385599800235, -437.2066286115665, -57.32721317747782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522659602428471, "mean_inference_ms": 1.7128897313106186, "mean_action_processing_ms": 0.27437060902241805, "mean_env_wait_ms": 3.5179773216291763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012571096420288086, "StateBufferConnector_ms": 0.007984399795532227, "ViewRequirementAgentConnector_ms": 0.19143438339233398}, "num_episodes": 34, "episode_return_max": -9.373730170500709, "episode_return_min": -1507.2791853481033, "episode_return_mean": -635.8486755760568, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.69572502135276, "num_env_steps_trained_throughput_per_sec": 303.69572502135276, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12984.838, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12984.767, "sample_time_ms": 1205.205, "learn_time_ms": 11713.28, "learn_throughput": 341.493, "synch_weights_time_ms": 65.484}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "1e132_00005", "date": "2024-08-04_08-23-13", "timestamp": 1722739993, "time_this_iter_s": 13.184082984924316, "time_total_s": 414.4752459526062, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3541341f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 414.4752459526062, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.894736842105264, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.68510081966718, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.5357940405607224, "policy_loss": -0.012847861073290308, "vf_loss": 1.5453767861550054, "vf_explained_var": 0.9966936357940237, "kl": 0.0171082584831917, "entropy": 1.5652943022549153, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -9.373730170500709, "episode_reward_min": -1507.2791853481033, "episode_reward_mean": -626.8433342402053, "episode_len_mean": 124.22, "episode_media": {}, "episodes_timesteps_total": 12422, "policy_reward_min": {"policy_0": -1507.2791853481033}, "policy_reward_max": {"policy_0": -9.373730170500709}, "policy_reward_mean": {"policy_0": -626.8433342402053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-580.2622747076363, -341.21041181341303, -289.39738166941726, -74.0901909115019, -439.99795895902827, -901.7299717623822, -895.869488421487, -1231.1798984780967, -967.252545183678, -1021.3080278030445, -1097.5323031837954, -793.9815006593619, -1273.868672559075, -1128.8949120523132, -44.12361816717089, -997.2441212304524, -166.75988773369573, -203.935063657334, -160.51010643046945, -715.590564632818, -1084.9658743727605, -850.4121688517813, -843.8107319957991, -133.58754372266546, -901.9131254857405, -1158.6262566967955, -590.5163899936807, -80.1269644132635, -310.74641099038394, -485.13455209603103, -260.5035619832599, -402.3159860442172, -876.0001315937194, -953.8504337915346, -73.57985421984351, -595.8714141034186, -985.4551072703019, -1126.1587624169574, -713.0772948564979, -1010.6358337203342, -285.5312630569911, -888.7418716541912, -453.1449147597323, -1239.3390451899174, -788.0712482690545, -1095.4043220630756, -325.8713879654549, -106.72847759838002, -1187.985066388528, -88.47902645884037, -807.28089340559, -83.51932389963716, -798.1729514236337, -400.57078969986, -1194.1289537289922, -1178.9611514083579, -9.373730170500709, -225.65648920994255, -25.108893815008987, -150.29021847136173, -685.7322191810106, -1507.2791853481033, -386.566744824501, -1029.3243001783055, -63.599260009406024, -861.0708910633319, -723.1854971360607, -223.6385599800235, -437.2066286115665, -57.32721317747782, -867.0507535048945, -298.61235964307104, -734.0861488506632, -704.2290519004094, -933.7875252474072, -127.56721952039302, -139.16130423592753, -619.853132113061, -1059.207770854055, -944.9060945508742, -429.4727385593474, -963.6756063096284, -1089.4221449589718, -1027.8405271338702, -171.97292625905547, -1021.5114596952415, -420.5062498880577, -1095.1751131178942, -99.81658498075784, -219.24871375941126, -24.511490272448384, -157.74385819130035, -785.6512096172764, -1006.6107575477278, -305.4632864902137, -758.079248403473, -978.5291294837317, -244.68318916822724, -1204.004504868636, -182.63550811250303], "episode_lengths": [150, 150, 122, 54, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 150, 75, 86, 79, 150, 150, 150, 150, 80, 150, 150, 150, 57, 104, 113, 106, 150, 150, 150, 46, 150, 150, 150, 150, 150, 102, 150, 134, 150, 150, 150, 150, 76, 150, 64, 150, 67, 150, 122, 150, 150, 33, 94, 43, 76, 150, 150, 126, 150, 61, 150, 150, 85, 150, 60, 150, 102, 150, 150, 150, 82, 84, 149, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 66, 112, 45, 62, 150, 150, 105, 150, 150, 92, 150, 79], "policy_policy_0_reward": [-580.2622747076363, -341.21041181341303, -289.39738166941726, -74.0901909115019, -439.99795895902827, -901.7299717623822, -895.869488421487, -1231.1798984780967, -967.252545183678, -1021.3080278030445, -1097.5323031837954, -793.9815006593619, -1273.868672559075, -1128.8949120523132, -44.12361816717089, -997.2441212304524, -166.75988773369573, -203.935063657334, -160.51010643046945, -715.590564632818, -1084.9658743727605, -850.4121688517813, -843.8107319957991, -133.58754372266546, -901.9131254857405, -1158.6262566967955, -590.5163899936807, -80.1269644132635, -310.74641099038394, -485.13455209603103, -260.5035619832599, -402.3159860442172, -876.0001315937194, -953.8504337915346, -73.57985421984351, -595.8714141034186, -985.4551072703019, -1126.1587624169574, -713.0772948564979, -1010.6358337203342, -285.5312630569911, -888.7418716541912, -453.1449147597323, -1239.3390451899174, -788.0712482690545, -1095.4043220630756, -325.8713879654549, -106.72847759838002, -1187.985066388528, -88.47902645884037, -807.28089340559, -83.51932389963716, -798.1729514236337, -400.57078969986, -1194.1289537289922, -1178.9611514083579, -9.373730170500709, -225.65648920994255, -25.108893815008987, -150.29021847136173, -685.7322191810106, -1507.2791853481033, -386.566744824501, -1029.3243001783055, -63.599260009406024, -861.0708910633319, -723.1854971360607, -223.6385599800235, -437.2066286115665, -57.32721317747782, -867.0507535048945, -298.61235964307104, -734.0861488506632, -704.2290519004094, -933.7875252474072, -127.56721952039302, -139.16130423592753, -619.853132113061, -1059.207770854055, -944.9060945508742, -429.4727385593474, -963.6756063096284, -1089.4221449589718, -1027.8405271338702, -171.97292625905547, -1021.5114596952415, -420.5062498880577, -1095.1751131178942, -99.81658498075784, -219.24871375941126, -24.511490272448384, -157.74385819130035, -785.6512096172764, -1006.6107575477278, -305.4632864902137, -758.079248403473, -978.5291294837317, -244.68318916822724, -1204.004504868636, -182.63550811250303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522317795846089, "mean_inference_ms": 1.7319612399590536, "mean_action_processing_ms": 0.2742240341584562, "mean_env_wait_ms": 3.51522414363044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012211322784423828, "StateBufferConnector_ms": 0.008006811141967773, "ViewRequirementAgentConnector_ms": 0.19223308563232422}, "num_episodes": 30, "episode_return_max": -9.373730170500709, "episode_return_min": -1507.2791853481033, "episode_return_mean": -626.8433342402053, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.3168695800597, "num_env_steps_trained_throughput_per_sec": 308.3168695800597, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 13041.447, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13041.374, "sample_time_ms": 1210.055, "learn_time_ms": 11763.245, "learn_throughput": 340.042, "synch_weights_time_ms": 67.273}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "1e132_00005", "date": "2024-08-04_08-23-26", "timestamp": 1722740006, "time_this_iter_s": 12.987184047698975, "time_total_s": 427.4624300003052, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.4624300003052, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.210526315789473, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 207.96351805726687, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.5316996466989319, "policy_loss": -0.0126192745801139, "vf_loss": 1.541191104085495, "vf_explained_var": 0.9968661584580938, "kl": 0.016413697254999256, "entropy": 1.5491908957560858, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -9.373730170500709, "episode_reward_min": -1507.2791853481033, "episode_reward_mean": -598.3413876462417, "episode_len_mean": 121.65, "episode_media": {}, "episodes_timesteps_total": 12165, "policy_reward_min": {"policy_0": -1507.2791853481033}, "policy_reward_max": {"policy_0": -9.373730170500709}, "policy_reward_mean": {"policy_0": -598.3413876462417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-985.4551072703019, -1126.1587624169574, -713.0772948564979, -1010.6358337203342, -285.5312630569911, -888.7418716541912, -453.1449147597323, -1239.3390451899174, -788.0712482690545, -1095.4043220630756, -325.8713879654549, -106.72847759838002, -1187.985066388528, -88.47902645884037, -807.28089340559, -83.51932389963716, -798.1729514236337, -400.57078969986, -1194.1289537289922, -1178.9611514083579, -9.373730170500709, -225.65648920994255, -25.108893815008987, -150.29021847136173, -685.7322191810106, -1507.2791853481033, -386.566744824501, -1029.3243001783055, -63.599260009406024, -861.0708910633319, -723.1854971360607, -223.6385599800235, -437.2066286115665, -57.32721317747782, -867.0507535048945, -298.61235964307104, -734.0861488506632, -704.2290519004094, -933.7875252474072, -127.56721952039302, -139.16130423592753, -619.853132113061, -1059.207770854055, -944.9060945508742, -429.4727385593474, -963.6756063096284, -1089.4221449589718, -1027.8405271338702, -171.97292625905547, -1021.5114596952415, -420.5062498880577, -1095.1751131178942, -99.81658498075784, -219.24871375941126, -24.511490272448384, -157.74385819130035, -785.6512096172764, -1006.6107575477278, -305.4632864902137, -758.079248403473, -978.5291294837317, -244.68318916822724, -1204.004504868636, -182.63550811250303, -383.7888418131147, -478.0218643310603, -763.6903671012501, -1110.5650303471773, -929.8656201984257, -1157.2963441046893, -528.3890231050397, -606.803135505809, -1412.8593275142468, -227.84254327305564, -1063.599018113971, -1083.6146946463614, -220.77856197580059, -369.4427373613174, -335.1735041799632, -105.82048945264768, -1103.2218027815707, -127.822038697008, -1004.2043448569102, -68.83901836180354, -422.55573613196253, -125.03787425905956, -75.02898995394501, -916.237948924982, -499.86799262395147, -59.337189756092954, -369.33729939908324, -1043.310972681923, -73.21334860024176, -116.69424872893833, -480.0171030993836, -1038.8413718542456, -22.912758985596778, -299.2971785047779, -1358.879971091783, -94.29734865752475], "episode_lengths": [150, 150, 150, 150, 102, 150, 134, 150, 150, 150, 150, 76, 150, 64, 150, 67, 150, 122, 150, 150, 33, 94, 43, 76, 150, 150, 126, 150, 61, 150, 150, 85, 150, 60, 150, 102, 150, 150, 150, 82, 84, 149, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 66, 112, 45, 62, 150, 150, 105, 150, 150, 92, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 93, 150, 109, 74, 150, 65, 150, 76, 126, 78, 55, 150, 150, 62, 113, 150, 60, 64, 150, 150, 46, 82, 150, 75], "policy_policy_0_reward": [-985.4551072703019, -1126.1587624169574, -713.0772948564979, -1010.6358337203342, -285.5312630569911, -888.7418716541912, -453.1449147597323, -1239.3390451899174, -788.0712482690545, -1095.4043220630756, -325.8713879654549, -106.72847759838002, -1187.985066388528, -88.47902645884037, -807.28089340559, -83.51932389963716, -798.1729514236337, -400.57078969986, -1194.1289537289922, -1178.9611514083579, -9.373730170500709, -225.65648920994255, -25.108893815008987, -150.29021847136173, -685.7322191810106, -1507.2791853481033, -386.566744824501, -1029.3243001783055, -63.599260009406024, -861.0708910633319, -723.1854971360607, -223.6385599800235, -437.2066286115665, -57.32721317747782, -867.0507535048945, -298.61235964307104, -734.0861488506632, -704.2290519004094, -933.7875252474072, -127.56721952039302, -139.16130423592753, -619.853132113061, -1059.207770854055, -944.9060945508742, -429.4727385593474, -963.6756063096284, -1089.4221449589718, -1027.8405271338702, -171.97292625905547, -1021.5114596952415, -420.5062498880577, -1095.1751131178942, -99.81658498075784, -219.24871375941126, -24.511490272448384, -157.74385819130035, -785.6512096172764, -1006.6107575477278, -305.4632864902137, -758.079248403473, -978.5291294837317, -244.68318916822724, -1204.004504868636, -182.63550811250303, -383.7888418131147, -478.0218643310603, -763.6903671012501, -1110.5650303471773, -929.8656201984257, -1157.2963441046893, -528.3890231050397, -606.803135505809, -1412.8593275142468, -227.84254327305564, -1063.599018113971, -1083.6146946463614, -220.77856197580059, -369.4427373613174, -335.1735041799632, -105.82048945264768, -1103.2218027815707, -127.822038697008, -1004.2043448569102, -68.83901836180354, -422.55573613196253, -125.03787425905956, -75.02898995394501, -916.237948924982, -499.86799262395147, -59.337189756092954, -369.33729939908324, -1043.310972681923, -73.21334860024176, -116.69424872893833, -480.0171030993836, -1038.8413718542456, -22.912758985596778, -299.2971785047779, -1358.879971091783, -94.29734865752475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527308923247961, "mean_inference_ms": 1.7357353950051047, "mean_action_processing_ms": 0.27412284578933555, "mean_env_wait_ms": 3.5122796249190578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0118408203125, "StateBufferConnector_ms": 0.007883548736572266, "ViewRequirementAgentConnector_ms": 0.1935102939605713}, "num_episodes": 36, "episode_return_max": -9.373730170500709, "episode_return_min": -1507.2791853481033, "episode_return_mean": -598.3413876462417, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.7462704185982, "num_env_steps_trained_throughput_per_sec": 296.7462704185982, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 13183.108, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13183.035, "sample_time_ms": 1222.546, "learn_time_ms": 11893.032, "learn_throughput": 336.331, "synch_weights_time_ms": 66.646}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "1e132_00005", "date": "2024-08-04_08-23-40", "timestamp": 1722740020, "time_this_iter_s": 13.493146896362305, "time_total_s": 440.9555768966675, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 440.9555768966675, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.76842105263158, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225.84116587638854, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.4945411135752995, "policy_loss": -0.011565295927963841, "vf_loss": 1.5027325552577773, "vf_explained_var": 0.9967720762516061, "kl": 0.017729719172712065, "entropy": 1.7209012548128764, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -22.912758985596778, "episode_reward_min": -1578.8294484631201, "episode_reward_mean": -634.9649640969309, "episode_len_mean": 124.44, "episode_media": {}, "episodes_timesteps_total": 12444, "policy_reward_min": {"policy_0": -1578.8294484631201}, "policy_reward_max": {"policy_0": -22.912758985596778}, "policy_reward_mean": {"policy_0": -634.9649640969309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-223.6385599800235, -437.2066286115665, -57.32721317747782, -867.0507535048945, -298.61235964307104, -734.0861488506632, -704.2290519004094, -933.7875252474072, -127.56721952039302, -139.16130423592753, -619.853132113061, -1059.207770854055, -944.9060945508742, -429.4727385593474, -963.6756063096284, -1089.4221449589718, -1027.8405271338702, -171.97292625905547, -1021.5114596952415, -420.5062498880577, -1095.1751131178942, -99.81658498075784, -219.24871375941126, -24.511490272448384, -157.74385819130035, -785.6512096172764, -1006.6107575477278, -305.4632864902137, -758.079248403473, -978.5291294837317, -244.68318916822724, -1204.004504868636, -182.63550811250303, -383.7888418131147, -478.0218643310603, -763.6903671012501, -1110.5650303471773, -929.8656201984257, -1157.2963441046893, -528.3890231050397, -606.803135505809, -1412.8593275142468, -227.84254327305564, -1063.599018113971, -1083.6146946463614, -220.77856197580059, -369.4427373613174, -335.1735041799632, -105.82048945264768, -1103.2218027815707, -127.822038697008, -1004.2043448569102, -68.83901836180354, -422.55573613196253, -125.03787425905956, -75.02898995394501, -916.237948924982, -499.86799262395147, -59.337189756092954, -369.33729939908324, -1043.310972681923, -73.21334860024176, -116.69424872893833, -480.0171030993836, -1038.8413718542456, -22.912758985596778, -299.2971785047779, -1358.879971091783, -94.29734865752475, -878.0312465861202, -1132.1246221072454, -1432.6882458784453, -363.8881483273197, -1191.7159706548061, -1205.5509658224464, -158.347614225613, -1315.1849706295002, -125.05964334666815, -915.5054114109527, -164.0328066501904, -449.5933824702861, -436.9313378190676, -183.42424446519897, -878.4862027181259, -984.0165411113837, -330.6746827259913, -1386.953182979444, -1176.708095205597, -602.3498844028102, -1154.9605387820363, -828.0680883401781, -1578.8294484631201, -948.1030934092636, -125.34684189212095, -221.7704343384572, -730.3167177042911, -1459.6682651182712, -479.43513800356425, -1040.5200425413334, -208.51695158092474], "episode_lengths": [85, 150, 60, 150, 102, 150, 150, 150, 82, 84, 149, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 66, 112, 45, 62, 150, 150, 105, 150, 150, 92, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 93, 150, 109, 74, 150, 65, 150, 76, 126, 78, 55, 150, 150, 62, 113, 150, 60, 64, 150, 150, 46, 82, 150, 75, 150, 150, 150, 150, 150, 150, 96, 150, 75, 150, 88, 150, 97, 92, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 78, 94, 150, 150, 150, 150, 88], "policy_policy_0_reward": [-223.6385599800235, -437.2066286115665, -57.32721317747782, -867.0507535048945, -298.61235964307104, -734.0861488506632, -704.2290519004094, -933.7875252474072, -127.56721952039302, -139.16130423592753, -619.853132113061, -1059.207770854055, -944.9060945508742, -429.4727385593474, -963.6756063096284, -1089.4221449589718, -1027.8405271338702, -171.97292625905547, -1021.5114596952415, -420.5062498880577, -1095.1751131178942, -99.81658498075784, -219.24871375941126, -24.511490272448384, -157.74385819130035, -785.6512096172764, -1006.6107575477278, -305.4632864902137, -758.079248403473, -978.5291294837317, -244.68318916822724, -1204.004504868636, -182.63550811250303, -383.7888418131147, -478.0218643310603, -763.6903671012501, -1110.5650303471773, -929.8656201984257, -1157.2963441046893, -528.3890231050397, -606.803135505809, -1412.8593275142468, -227.84254327305564, -1063.599018113971, -1083.6146946463614, -220.77856197580059, -369.4427373613174, -335.1735041799632, -105.82048945264768, -1103.2218027815707, -127.822038697008, -1004.2043448569102, -68.83901836180354, -422.55573613196253, -125.03787425905956, -75.02898995394501, -916.237948924982, -499.86799262395147, -59.337189756092954, -369.33729939908324, -1043.310972681923, -73.21334860024176, -116.69424872893833, -480.0171030993836, -1038.8413718542456, -22.912758985596778, -299.2971785047779, -1358.879971091783, -94.29734865752475, -878.0312465861202, -1132.1246221072454, -1432.6882458784453, -363.8881483273197, -1191.7159706548061, -1205.5509658224464, -158.347614225613, -1315.1849706295002, -125.05964334666815, -915.5054114109527, -164.0328066501904, -449.5933824702861, -436.9313378190676, -183.42424446519897, -878.4862027181259, -984.0165411113837, -330.6746827259913, -1386.953182979444, -1176.708095205597, -602.3498844028102, -1154.9605387820363, -828.0680883401781, -1578.8294484631201, -948.1030934092636, -125.34684189212095, -221.7704343384572, -730.3167177042911, -1459.6682651182712, -479.43513800356425, -1040.5200425413334, -208.51695158092474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524396220464258, "mean_inference_ms": 1.7332926397438408, "mean_action_processing_ms": 0.27411380833225824, "mean_env_wait_ms": 3.5122116662798737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011995553970336914, "StateBufferConnector_ms": 0.007925987243652344, "ViewRequirementAgentConnector_ms": 0.1923079490661621}, "num_episodes": 31, "episode_return_max": -22.912758985596778, "episode_return_min": -1578.8294484631201, "episode_return_mean": -634.9649640969309, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.3203999317621, "num_env_steps_trained_throughput_per_sec": 312.3203999317621, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 13137.25, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13137.177, "sample_time_ms": 1219.241, "learn_time_ms": 11852.205, "learn_throughput": 337.49, "synch_weights_time_ms": 64.919}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "1e132_00005", "date": "2024-08-04_08-23-53", "timestamp": 1722740033, "time_this_iter_s": 12.819248914718628, "time_total_s": 453.7748258113861, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 453.7748258113861, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.788888888888888, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.4643138686816, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.720967371823887, "policy_loss": -0.01681657760151817, "vf_loss": 1.7345429046079517, "vf_explained_var": 0.9970230551436543, "kl": 0.016927819737490322, "entropy": 1.4452111045519511, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -22.912758985596778, "episode_reward_min": -1578.8294484631201, "episode_reward_mean": -625.9113393939602, "episode_len_mean": 124.8, "episode_media": {}, "episodes_timesteps_total": 12480, "policy_reward_min": {"policy_0": -1578.8294484631201}, "policy_reward_max": {"policy_0": -22.912758985596778}, "policy_reward_mean": {"policy_0": -625.9113393939602}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.63550811250303, -383.7888418131147, -478.0218643310603, -763.6903671012501, -1110.5650303471773, -929.8656201984257, -1157.2963441046893, -528.3890231050397, -606.803135505809, -1412.8593275142468, -227.84254327305564, -1063.599018113971, -1083.6146946463614, -220.77856197580059, -369.4427373613174, -335.1735041799632, -105.82048945264768, -1103.2218027815707, -127.822038697008, -1004.2043448569102, -68.83901836180354, -422.55573613196253, -125.03787425905956, -75.02898995394501, -916.237948924982, -499.86799262395147, -59.337189756092954, -369.33729939908324, -1043.310972681923, -73.21334860024176, -116.69424872893833, -480.0171030993836, -1038.8413718542456, -22.912758985596778, -299.2971785047779, -1358.879971091783, -94.29734865752475, -878.0312465861202, -1132.1246221072454, -1432.6882458784453, -363.8881483273197, -1191.7159706548061, -1205.5509658224464, -158.347614225613, -1315.1849706295002, -125.05964334666815, -915.5054114109527, -164.0328066501904, -449.5933824702861, -436.9313378190676, -183.42424446519897, -878.4862027181259, -984.0165411113837, -330.6746827259913, -1386.953182979444, -1176.708095205597, -602.3498844028102, -1154.9605387820363, -828.0680883401781, -1578.8294484631201, -948.1030934092636, -125.34684189212095, -221.7704343384572, -730.3167177042911, -1459.6682651182712, -479.43513800356425, -1040.5200425413334, -208.51695158092474, -1099.3654174944452, -140.88117587090844, -690.7911344071589, -171.64970901035133, -884.071103906033, -391.6758130648881, -1132.7072638736252, -259.20978546955564, -73.40259184769513, -503.1911099276757, -632.0083675867038, -702.3195449504046, -558.0820661694189, -613.3730372276218, -105.38314086535165, -1225.7003288177125, -825.538158922004, -982.7746199887772, -1229.5379833314278, -436.96413926767696, -1174.5822654719339, -116.10647554890308, -156.64223975588936, -67.43049600122923, -306.84780325394905, -159.08084182356203, -216.8448578109058, -1487.019036911071, -638.9523138188011, -498.7562214922555, -635.1548077139853, -129.14617899611488], "episode_lengths": [79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 93, 150, 109, 74, 150, 65, 150, 76, 126, 78, 55, 150, 150, 62, 113, 150, 60, 64, 150, 150, 46, 82, 150, 75, 150, 150, 150, 150, 150, 150, 96, 150, 75, 150, 88, 150, 97, 92, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 78, 94, 150, 150, 150, 150, 88, 150, 92, 150, 80, 150, 133, 150, 110, 61, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 130, 150, 65, 106, 43, 130, 89, 105, 150, 150, 144, 150, 74], "policy_policy_0_reward": [-182.63550811250303, -383.7888418131147, -478.0218643310603, -763.6903671012501, -1110.5650303471773, -929.8656201984257, -1157.2963441046893, -528.3890231050397, -606.803135505809, -1412.8593275142468, -227.84254327305564, -1063.599018113971, -1083.6146946463614, -220.77856197580059, -369.4427373613174, -335.1735041799632, -105.82048945264768, -1103.2218027815707, -127.822038697008, -1004.2043448569102, -68.83901836180354, -422.55573613196253, -125.03787425905956, -75.02898995394501, -916.237948924982, -499.86799262395147, -59.337189756092954, -369.33729939908324, -1043.310972681923, -73.21334860024176, -116.69424872893833, -480.0171030993836, -1038.8413718542456, -22.912758985596778, -299.2971785047779, -1358.879971091783, -94.29734865752475, -878.0312465861202, -1132.1246221072454, -1432.6882458784453, -363.8881483273197, -1191.7159706548061, -1205.5509658224464, -158.347614225613, -1315.1849706295002, -125.05964334666815, -915.5054114109527, -164.0328066501904, -449.5933824702861, -436.9313378190676, -183.42424446519897, -878.4862027181259, -984.0165411113837, -330.6746827259913, -1386.953182979444, -1176.708095205597, -602.3498844028102, -1154.9605387820363, -828.0680883401781, -1578.8294484631201, -948.1030934092636, -125.34684189212095, -221.7704343384572, -730.3167177042911, -1459.6682651182712, -479.43513800356425, -1040.5200425413334, -208.51695158092474, -1099.3654174944452, -140.88117587090844, -690.7911344071589, -171.64970901035133, -884.071103906033, -391.6758130648881, -1132.7072638736252, -259.20978546955564, -73.40259184769513, -503.1911099276757, -632.0083675867038, -702.3195449504046, -558.0820661694189, -613.3730372276218, -105.38314086535165, -1225.7003288177125, -825.538158922004, -982.7746199887772, -1229.5379833314278, -436.96413926767696, -1174.5822654719339, -116.10647554890308, -156.64223975588936, -67.43049600122923, -306.84780325394905, -159.08084182356203, -216.8448578109058, -1487.019036911071, -638.9523138188011, -498.7562214922555, -635.1548077139853, -129.14617899611488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526488401074928, "mean_inference_ms": 1.7324235822969638, "mean_action_processing_ms": 0.2740670396718535, "mean_env_wait_ms": 3.513634113476203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012508869171142578, "StateBufferConnector_ms": 0.008038997650146484, "ViewRequirementAgentConnector_ms": 0.19221758842468262}, "num_episodes": 32, "episode_return_max": -22.912758985596778, "episode_return_min": -1578.8294484631201, "episode_return_mean": -625.9113393939602, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.47511825636917, "num_env_steps_trained_throughput_per_sec": 306.47511825636917, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 13173.363, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13173.289, "sample_time_ms": 1218.342, "learn_time_ms": 11888.975, "learn_throughput": 336.446, "synch_weights_time_ms": 65.151}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "1e132_00005", "date": "2024-08-04_08-24-06", "timestamp": 1722740046, "time_this_iter_s": 13.06540060043335, "time_total_s": 466.84022641181946, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bbc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 466.84022641181946, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.13684210526316, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 279.53599012295405, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.2596787552038828, "policy_loss": -0.014180475979325516, "vf_loss": 1.2704946062217155, "vf_explained_var": 0.9990666887412468, "kl": 0.01769238105138508, "entropy": 1.738517480591933, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -22.803417348454253, "episode_reward_min": -1578.8294484631201, "episode_reward_mean": -643.76776214739, "episode_len_mean": 124.9, "episode_media": {}, "episodes_timesteps_total": 12490, "policy_reward_min": {"policy_0": -1578.8294484631201}, "policy_reward_max": {"policy_0": -22.803417348454253}, "policy_reward_mean": {"policy_0": -643.76776214739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1043.310972681923, -73.21334860024176, -116.69424872893833, -480.0171030993836, -1038.8413718542456, -22.912758985596778, -299.2971785047779, -1358.879971091783, -94.29734865752475, -878.0312465861202, -1132.1246221072454, -1432.6882458784453, -363.8881483273197, -1191.7159706548061, -1205.5509658224464, -158.347614225613, -1315.1849706295002, -125.05964334666815, -915.5054114109527, -164.0328066501904, -449.5933824702861, -436.9313378190676, -183.42424446519897, -878.4862027181259, -984.0165411113837, -330.6746827259913, -1386.953182979444, -1176.708095205597, -602.3498844028102, -1154.9605387820363, -828.0680883401781, -1578.8294484631201, -948.1030934092636, -125.34684189212095, -221.7704343384572, -730.3167177042911, -1459.6682651182712, -479.43513800356425, -1040.5200425413334, -208.51695158092474, -1099.3654174944452, -140.88117587090844, -690.7911344071589, -171.64970901035133, -884.071103906033, -391.6758130648881, -1132.7072638736252, -259.20978546955564, -73.40259184769513, -503.1911099276757, -632.0083675867038, -702.3195449504046, -558.0820661694189, -613.3730372276218, -105.38314086535165, -1225.7003288177125, -825.538158922004, -982.7746199887772, -1229.5379833314278, -436.96413926767696, -1174.5822654719339, -116.10647554890308, -156.64223975588936, -67.43049600122923, -306.84780325394905, -159.08084182356203, -216.8448578109058, -1487.019036911071, -638.9523138188011, -498.7562214922555, -635.1548077139853, -129.14617899611488, -56.79824405398272, -453.401841318309, -1283.3076395772532, -549.6385925780842, -1000.971193940052, -325.2247282935888, -1035.0509322163434, -956.9388422564434, -211.8463391201763, -281.9763197431635, -1101.0693171225112, -959.0670380375587, -444.90037842487465, -1249.5705907697472, -1365.3848786751375, -89.29710689505278, -220.26621516591973, -1490.7245246233915, -952.0642381216974, -128.62738335640066, -48.01879601927836, -357.26945620571894, -22.803417348454253, -281.08875244370137, -263.442165557723, -1121.0455658316805, -958.2622272864879, -309.26239724305043], "episode_lengths": [150, 60, 64, 150, 150, 46, 82, 150, 75, 150, 150, 150, 150, 150, 150, 96, 150, 75, 150, 88, 150, 97, 92, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 78, 94, 150, 150, 150, 150, 88, 150, 92, 150, 80, 150, 133, 150, 110, 61, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 130, 150, 65, 106, 43, 130, 89, 105, 150, 150, 144, 150, 74, 57, 150, 150, 150, 150, 121, 150, 150, 94, 117, 150, 150, 144, 150, 150, 75, 89, 150, 150, 73, 59, 125, 52, 95, 113, 150, 150, 114], "policy_policy_0_reward": [-1043.310972681923, -73.21334860024176, -116.69424872893833, -480.0171030993836, -1038.8413718542456, -22.912758985596778, -299.2971785047779, -1358.879971091783, -94.29734865752475, -878.0312465861202, -1132.1246221072454, -1432.6882458784453, -363.8881483273197, -1191.7159706548061, -1205.5509658224464, -158.347614225613, -1315.1849706295002, -125.05964334666815, -915.5054114109527, -164.0328066501904, -449.5933824702861, -436.9313378190676, -183.42424446519897, -878.4862027181259, -984.0165411113837, -330.6746827259913, -1386.953182979444, -1176.708095205597, -602.3498844028102, -1154.9605387820363, -828.0680883401781, -1578.8294484631201, -948.1030934092636, -125.34684189212095, -221.7704343384572, -730.3167177042911, -1459.6682651182712, -479.43513800356425, -1040.5200425413334, -208.51695158092474, -1099.3654174944452, -140.88117587090844, -690.7911344071589, -171.64970901035133, -884.071103906033, -391.6758130648881, -1132.7072638736252, -259.20978546955564, -73.40259184769513, -503.1911099276757, -632.0083675867038, -702.3195449504046, -558.0820661694189, -613.3730372276218, -105.38314086535165, -1225.7003288177125, -825.538158922004, -982.7746199887772, -1229.5379833314278, -436.96413926767696, -1174.5822654719339, -116.10647554890308, -156.64223975588936, -67.43049600122923, -306.84780325394905, -159.08084182356203, -216.8448578109058, -1487.019036911071, -638.9523138188011, -498.7562214922555, -635.1548077139853, -129.14617899611488, -56.79824405398272, -453.401841318309, -1283.3076395772532, -549.6385925780842, -1000.971193940052, -325.2247282935888, -1035.0509322163434, -956.9388422564434, -211.8463391201763, -281.9763197431635, -1101.0693171225112, -959.0670380375587, -444.90037842487465, -1249.5705907697472, -1365.3848786751375, -89.29710689505278, -220.26621516591973, -1490.7245246233915, -952.0642381216974, -128.62738335640066, -48.01879601927836, -357.26945620571894, -22.803417348454253, -281.08875244370137, -263.442165557723, -1121.0455658316805, -958.2622272864879, -309.26239724305043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524587675001068, "mean_inference_ms": 1.729728878634957, "mean_action_processing_ms": 0.2738419153272736, "mean_env_wait_ms": 3.511941040739241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012455224990844727, "StateBufferConnector_ms": 0.008073091506958008, "ViewRequirementAgentConnector_ms": 0.19383788108825684}, "num_episodes": 28, "episode_return_max": -22.803417348454253, "episode_return_min": -1578.8294484631201, "episode_return_mean": -643.76776214739, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.9316046349493, "num_env_steps_trained_throughput_per_sec": 308.9316046349493, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 13212.706, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13212.629, "sample_time_ms": 1214.266, "learn_time_ms": 11931.602, "learn_throughput": 335.244, "synch_weights_time_ms": 65.925}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "1e132_00005", "date": "2024-08-04_08-24-19", "timestamp": 1722740059, "time_this_iter_s": 12.961386680603027, "time_total_s": 479.8016130924225, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ba050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 479.8016130924225, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.144444444444446, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.49983262022337, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.4903715362772345, "policy_loss": -0.007216723179832722, "vf_loss": 1.4947564107676348, "vf_explained_var": 0.9980120253438751, "kl": 0.01502011694531878, "entropy": 1.7217204282681147, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -22.803417348454253, "episode_reward_min": -1490.7245246233915, "episode_reward_mean": -638.6211390412418, "episode_len_mean": 127.62, "episode_media": {}, "episodes_timesteps_total": 12762, "policy_reward_min": {"policy_0": -1490.7245246233915}, "policy_reward_max": {"policy_0": -22.803417348454253}, "policy_reward_mean": {"policy_0": -638.6211390412418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-221.7704343384572, -730.3167177042911, -1459.6682651182712, -479.43513800356425, -1040.5200425413334, -208.51695158092474, -1099.3654174944452, -140.88117587090844, -690.7911344071589, -171.64970901035133, -884.071103906033, -391.6758130648881, -1132.7072638736252, -259.20978546955564, -73.40259184769513, -503.1911099276757, -632.0083675867038, -702.3195449504046, -558.0820661694189, -613.3730372276218, -105.38314086535165, -1225.7003288177125, -825.538158922004, -982.7746199887772, -1229.5379833314278, -436.96413926767696, -1174.5822654719339, -116.10647554890308, -156.64223975588936, -67.43049600122923, -306.84780325394905, -159.08084182356203, -216.8448578109058, -1487.019036911071, -638.9523138188011, -498.7562214922555, -635.1548077139853, -129.14617899611488, -56.79824405398272, -453.401841318309, -1283.3076395772532, -549.6385925780842, -1000.971193940052, -325.2247282935888, -1035.0509322163434, -956.9388422564434, -211.8463391201763, -281.9763197431635, -1101.0693171225112, -959.0670380375587, -444.90037842487465, -1249.5705907697472, -1365.3848786751375, -89.29710689505278, -220.26621516591973, -1490.7245246233915, -952.0642381216974, -128.62738335640066, -48.01879601927836, -357.26945620571894, -22.803417348454253, -281.08875244370137, -263.442165557723, -1121.0455658316805, -958.2622272864879, -309.26239724305043, -1127.1954553125088, -384.2869165432797, -354.6388786973753, -282.85237305858465, -577.314596860947, -178.5349911722742, -837.7944008565926, -117.77747238307931, -1407.9167084688117, -341.8543492668887, -741.3427343160345, -1352.4424133716486, -1142.1500823526599, -178.31002568614073, -530.4309232104395, -1086.587199560343, -205.7313465386222, -116.39088285534183, -988.0437627429967, -653.1123273668937, -1155.7740774185065, -419.2361786653587, -527.414066849624, -816.6729631974822, -1019.7469058216058, -139.24888579411615, -673.7157446844869, -940.8888288544895, -1160.320349517588, -617.9041158401396, -175.65365685686132, -1254.7451036461944, -1171.7073711155952, -1281.6411131300013], "episode_lengths": [94, 150, 150, 150, 150, 88, 150, 92, 150, 80, 150, 133, 150, 110, 61, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 130, 150, 65, 106, 43, 130, 89, 105, 150, 150, 144, 150, 74, 57, 150, 150, 150, 150, 121, 150, 150, 94, 117, 150, 150, 144, 150, 150, 75, 89, 150, 150, 73, 59, 125, 52, 95, 113, 150, 150, 114, 150, 150, 120, 127, 150, 78, 150, 72, 150, 141, 150, 150, 150, 99, 144, 150, 85, 73, 150, 150, 150, 141, 150, 150, 150, 79, 150, 150, 150, 150, 85, 150, 150, 150], "policy_policy_0_reward": [-221.7704343384572, -730.3167177042911, -1459.6682651182712, -479.43513800356425, -1040.5200425413334, -208.51695158092474, -1099.3654174944452, -140.88117587090844, -690.7911344071589, -171.64970901035133, -884.071103906033, -391.6758130648881, -1132.7072638736252, -259.20978546955564, -73.40259184769513, -503.1911099276757, -632.0083675867038, -702.3195449504046, -558.0820661694189, -613.3730372276218, -105.38314086535165, -1225.7003288177125, -825.538158922004, -982.7746199887772, -1229.5379833314278, -436.96413926767696, -1174.5822654719339, -116.10647554890308, -156.64223975588936, -67.43049600122923, -306.84780325394905, -159.08084182356203, -216.8448578109058, -1487.019036911071, -638.9523138188011, -498.7562214922555, -635.1548077139853, -129.14617899611488, -56.79824405398272, -453.401841318309, -1283.3076395772532, -549.6385925780842, -1000.971193940052, -325.2247282935888, -1035.0509322163434, -956.9388422564434, -211.8463391201763, -281.9763197431635, -1101.0693171225112, -959.0670380375587, -444.90037842487465, -1249.5705907697472, -1365.3848786751375, -89.29710689505278, -220.26621516591973, -1490.7245246233915, -952.0642381216974, -128.62738335640066, -48.01879601927836, -357.26945620571894, -22.803417348454253, -281.08875244370137, -263.442165557723, -1121.0455658316805, -958.2622272864879, -309.26239724305043, -1127.1954553125088, -384.2869165432797, -354.6388786973753, -282.85237305858465, -577.314596860947, -178.5349911722742, -837.7944008565926, -117.77747238307931, -1407.9167084688117, -341.8543492668887, -741.3427343160345, -1352.4424133716486, -1142.1500823526599, -178.31002568614073, -530.4309232104395, -1086.587199560343, -205.7313465386222, -116.39088285534183, -988.0437627429967, -653.1123273668937, -1155.7740774185065, -419.2361786653587, -527.414066849624, -816.6729631974822, -1019.7469058216058, -139.24888579411615, -673.7157446844869, -940.8888288544895, -1160.320349517588, -617.9041158401396, -175.65365685686132, -1254.7451036461944, -1171.7073711155952, -1281.6411131300013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526408654414064, "mean_inference_ms": 1.72772259947015, "mean_action_processing_ms": 0.27405727164420957, "mean_env_wait_ms": 3.514608716341881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012560606002807617, "StateBufferConnector_ms": 0.008330106735229492, "ViewRequirementAgentConnector_ms": 0.19866704940795898}, "num_episodes": 34, "episode_return_max": -22.803417348454253, "episode_return_min": -1490.7245246233915, "episode_return_mean": -638.6211390412418, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.1727691824909, "num_env_steps_trained_throughput_per_sec": 305.1727691824909, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 13187.337, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13187.26, "sample_time_ms": 1211.128, "learn_time_ms": 11905.979, "learn_throughput": 335.966, "synch_weights_time_ms": 69.314}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "1e132_00005", "date": "2024-08-04_08-24-32", "timestamp": 1722740072, "time_this_iter_s": 13.120521068572998, "time_total_s": 492.9221341609955, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 492.9221341609955, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.81578947368421, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 209.3778711815675, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000002, "total_loss": 1.3527356952584038, "policy_loss": -0.016525079771721116, "vf_loss": 1.3653392296905318, "vf_explained_var": 0.9988685879235466, "kl": 0.02042068194056507, "entropy": 1.6259011206527552, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -22.803417348454253, "episode_reward_min": -1490.7245246233915, "episode_reward_mean": -660.4057282969926, "episode_len_mean": 126.7, "episode_media": {}, "episodes_timesteps_total": 12670, "policy_reward_min": {"policy_0": -1490.7245246233915}, "policy_reward_max": {"policy_0": -22.803417348454253}, "policy_reward_mean": {"policy_0": -660.4057282969926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-159.08084182356203, -216.8448578109058, -1487.019036911071, -638.9523138188011, -498.7562214922555, -635.1548077139853, -129.14617899611488, -56.79824405398272, -453.401841318309, -1283.3076395772532, -549.6385925780842, -1000.971193940052, -325.2247282935888, -1035.0509322163434, -956.9388422564434, -211.8463391201763, -281.9763197431635, -1101.0693171225112, -959.0670380375587, -444.90037842487465, -1249.5705907697472, -1365.3848786751375, -89.29710689505278, -220.26621516591973, -1490.7245246233915, -952.0642381216974, -128.62738335640066, -48.01879601927836, -357.26945620571894, -22.803417348454253, -281.08875244370137, -263.442165557723, -1121.0455658316805, -958.2622272864879, -309.26239724305043, -1127.1954553125088, -384.2869165432797, -354.6388786973753, -282.85237305858465, -577.314596860947, -178.5349911722742, -837.7944008565926, -117.77747238307931, -1407.9167084688117, -341.8543492668887, -741.3427343160345, -1352.4424133716486, -1142.1500823526599, -178.31002568614073, -530.4309232104395, -1086.587199560343, -205.7313465386222, -116.39088285534183, -988.0437627429967, -653.1123273668937, -1155.7740774185065, -419.2361786653587, -527.414066849624, -816.6729631974822, -1019.7469058216058, -139.24888579411615, -673.7157446844869, -940.8888288544895, -1160.320349517588, -617.9041158401396, -175.65365685686132, -1254.7451036461944, -1171.7073711155952, -1281.6411131300013, -1348.881346666681, -366.24306137985894, -88.08277936175094, -1276.9468309320591, -695.5712975342793, -202.6075495542095, -1030.3037811960894, -1423.552041529366, -990.1375996524305, -101.81156202327384, -1122.7189414148786, -90.08073697196866, -731.0847948807507, -813.9780377200713, -51.247323582168875, -979.0499961979586, -1285.8273891594897, -642.3336985703625, -104.28921657197205, -945.9181732088259, -148.98556569835102, -276.20339257915026, -428.07925076977745, -929.4101995758053, -939.6601849581871, -966.3805104753994, -1302.2788554239246, -321.24840418878614, -1029.3379829897065, -92.35726148769872, -74.31448063803195], "episode_lengths": [89, 105, 150, 150, 144, 150, 74, 57, 150, 150, 150, 150, 121, 150, 150, 94, 117, 150, 150, 144, 150, 150, 75, 89, 150, 150, 73, 59, 125, 52, 95, 113, 150, 150, 114, 150, 150, 120, 127, 150, 78, 150, 72, 150, 141, 150, 150, 150, 99, 144, 150, 85, 73, 150, 150, 150, 141, 150, 150, 150, 79, 150, 150, 150, 150, 85, 150, 150, 150, 150, 130, 77, 150, 150, 89, 150, 150, 150, 66, 150, 68, 150, 150, 52, 150, 150, 150, 65, 150, 81, 110, 150, 150, 150, 150, 150, 120, 150, 70, 58], "policy_policy_0_reward": [-159.08084182356203, -216.8448578109058, -1487.019036911071, -638.9523138188011, -498.7562214922555, -635.1548077139853, -129.14617899611488, -56.79824405398272, -453.401841318309, -1283.3076395772532, -549.6385925780842, -1000.971193940052, -325.2247282935888, -1035.0509322163434, -956.9388422564434, -211.8463391201763, -281.9763197431635, -1101.0693171225112, -959.0670380375587, -444.90037842487465, -1249.5705907697472, -1365.3848786751375, -89.29710689505278, -220.26621516591973, -1490.7245246233915, -952.0642381216974, -128.62738335640066, -48.01879601927836, -357.26945620571894, -22.803417348454253, -281.08875244370137, -263.442165557723, -1121.0455658316805, -958.2622272864879, -309.26239724305043, -1127.1954553125088, -384.2869165432797, -354.6388786973753, -282.85237305858465, -577.314596860947, -178.5349911722742, -837.7944008565926, -117.77747238307931, -1407.9167084688117, -341.8543492668887, -741.3427343160345, -1352.4424133716486, -1142.1500823526599, -178.31002568614073, -530.4309232104395, -1086.587199560343, -205.7313465386222, -116.39088285534183, -988.0437627429967, -653.1123273668937, -1155.7740774185065, -419.2361786653587, -527.414066849624, -816.6729631974822, -1019.7469058216058, -139.24888579411615, -673.7157446844869, -940.8888288544895, -1160.320349517588, -617.9041158401396, -175.65365685686132, -1254.7451036461944, -1171.7073711155952, -1281.6411131300013, -1348.881346666681, -366.24306137985894, -88.08277936175094, -1276.9468309320591, -695.5712975342793, -202.6075495542095, -1030.3037811960894, -1423.552041529366, -990.1375996524305, -101.81156202327384, -1122.7189414148786, -90.08073697196866, -731.0847948807507, -813.9780377200713, -51.247323582168875, -979.0499961979586, -1285.8273891594897, -642.3336985703625, -104.28921657197205, -945.9181732088259, -148.98556569835102, -276.20339257915026, -428.07925076977745, -929.4101995758053, -939.6601849581871, -966.3805104753994, -1302.2788554239246, -321.24840418878614, -1029.3379829897065, -92.35726148769872, -74.31448063803195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526644431469094, "mean_inference_ms": 1.7265941094510344, "mean_action_processing_ms": 0.2739759727006263, "mean_env_wait_ms": 3.513430121706909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012419939041137695, "StateBufferConnector_ms": 0.008155345916748047, "ViewRequirementAgentConnector_ms": 0.19773650169372559}, "num_episodes": 31, "episode_return_max": -22.803417348454253, "episode_return_min": -1490.7245246233915, "episode_return_mean": -660.4057282969926, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.57503461621116, "num_env_steps_trained_throughput_per_sec": 299.57503461621116, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 13188.686, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13188.607, "sample_time_ms": 1209.522, "learn_time_ms": 11910.671, "learn_throughput": 335.833, "synch_weights_time_ms": 67.571}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "1e132_00005", "date": "2024-08-04_08-24-45", "timestamp": 1722740085, "time_this_iter_s": 13.365558862686157, "time_total_s": 506.28769302368164, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447badd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.28769302368164, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.10526315789474, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 197.420839124918, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.3880962057970465, "policy_loss": -0.019390453635908973, "vf_loss": 1.402657794393599, "vf_explained_var": 0.9989027752851446, "kl": 0.016595865503738146, "entropy": 1.4989798481265704, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -51.247323582168875, "episode_reward_min": -1530.5988490288685, "episode_reward_mean": -671.679379468972, "episode_len_mean": 129.37, "episode_media": {}, "episodes_timesteps_total": 12937, "policy_reward_min": {"policy_0": -1530.5988490288685}, "policy_reward_max": {"policy_0": -51.247323582168875}, "policy_reward_mean": {"policy_0": -671.679379468972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-263.442165557723, -1121.0455658316805, -958.2622272864879, -309.26239724305043, -1127.1954553125088, -384.2869165432797, -354.6388786973753, -282.85237305858465, -577.314596860947, -178.5349911722742, -837.7944008565926, -117.77747238307931, -1407.9167084688117, -341.8543492668887, -741.3427343160345, -1352.4424133716486, -1142.1500823526599, -178.31002568614073, -530.4309232104395, -1086.587199560343, -205.7313465386222, -116.39088285534183, -988.0437627429967, -653.1123273668937, -1155.7740774185065, -419.2361786653587, -527.414066849624, -816.6729631974822, -1019.7469058216058, -139.24888579411615, -673.7157446844869, -940.8888288544895, -1160.320349517588, -617.9041158401396, -175.65365685686132, -1254.7451036461944, -1171.7073711155952, -1281.6411131300013, -1348.881346666681, -366.24306137985894, -88.08277936175094, -1276.9468309320591, -695.5712975342793, -202.6075495542095, -1030.3037811960894, -1423.552041529366, -990.1375996524305, -101.81156202327384, -1122.7189414148786, -90.08073697196866, -731.0847948807507, -813.9780377200713, -51.247323582168875, -979.0499961979586, -1285.8273891594897, -642.3336985703625, -104.28921657197205, -945.9181732088259, -148.98556569835102, -276.20339257915026, -428.07925076977745, -929.4101995758053, -939.6601849581871, -966.3805104753994, -1302.2788554239246, -321.24840418878614, -1029.3379829897065, -92.35726148769872, -74.31448063803195, -150.7502857890648, -116.33041337669957, -968.8625605709678, -369.46635810153555, -949.9210036064918, -284.0889239636129, -362.65523390035617, -109.7051811658876, -820.0334814332311, -1500.3271016264277, -349.25656466797477, -321.7414539375808, -761.8742676091522, -569.3893641673519, -105.51161637983347, -532.4692971945985, -1244.1201592622133, -1003.7416587351739, -566.1130557393759, -355.2096728976206, -235.86211476245032, -101.12213076277612, -1322.4763942396735, -454.3790162084084, -323.64010316925754, -1111.8505212981559, -735.7233116560097, -176.20131608944766, -1530.5988490288685, -1080.2582512608558, -1243.9464794704181], "episode_lengths": [113, 150, 150, 114, 150, 150, 120, 127, 150, 78, 150, 72, 150, 141, 150, 150, 150, 99, 144, 150, 85, 73, 150, 150, 150, 141, 150, 150, 150, 79, 150, 150, 150, 150, 85, 150, 150, 150, 150, 130, 77, 150, 150, 89, 150, 150, 150, 66, 150, 68, 150, 150, 52, 150, 150, 150, 65, 150, 81, 110, 150, 150, 150, 150, 150, 120, 150, 70, 58, 77, 89, 150, 144, 150, 103, 150, 76, 150, 150, 148, 107, 150, 150, 72, 150, 150, 150, 150, 150, 91, 85, 150, 146, 114, 150, 150, 78, 150, 150, 150], "policy_policy_0_reward": [-263.442165557723, -1121.0455658316805, -958.2622272864879, -309.26239724305043, -1127.1954553125088, -384.2869165432797, -354.6388786973753, -282.85237305858465, -577.314596860947, -178.5349911722742, -837.7944008565926, -117.77747238307931, -1407.9167084688117, -341.8543492668887, -741.3427343160345, -1352.4424133716486, -1142.1500823526599, -178.31002568614073, -530.4309232104395, -1086.587199560343, -205.7313465386222, -116.39088285534183, -988.0437627429967, -653.1123273668937, -1155.7740774185065, -419.2361786653587, -527.414066849624, -816.6729631974822, -1019.7469058216058, -139.24888579411615, -673.7157446844869, -940.8888288544895, -1160.320349517588, -617.9041158401396, -175.65365685686132, -1254.7451036461944, -1171.7073711155952, -1281.6411131300013, -1348.881346666681, -366.24306137985894, -88.08277936175094, -1276.9468309320591, -695.5712975342793, -202.6075495542095, -1030.3037811960894, -1423.552041529366, -990.1375996524305, -101.81156202327384, -1122.7189414148786, -90.08073697196866, -731.0847948807507, -813.9780377200713, -51.247323582168875, -979.0499961979586, -1285.8273891594897, -642.3336985703625, -104.28921657197205, -945.9181732088259, -148.98556569835102, -276.20339257915026, -428.07925076977745, -929.4101995758053, -939.6601849581871, -966.3805104753994, -1302.2788554239246, -321.24840418878614, -1029.3379829897065, -92.35726148769872, -74.31448063803195, -150.7502857890648, -116.33041337669957, -968.8625605709678, -369.46635810153555, -949.9210036064918, -284.0889239636129, -362.65523390035617, -109.7051811658876, -820.0334814332311, -1500.3271016264277, -349.25656466797477, -321.7414539375808, -761.8742676091522, -569.3893641673519, -105.51161637983347, -532.4692971945985, -1244.1201592622133, -1003.7416587351739, -566.1130557393759, -355.2096728976206, -235.86211476245032, -101.12213076277612, -1322.4763942396735, -454.3790162084084, -323.64010316925754, -1111.8505212981559, -735.7233116560097, -176.20131608944766, -1530.5988490288685, -1080.2582512608558, -1243.9464794704181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552816300851517, "mean_inference_ms": 1.7255380714887816, "mean_action_processing_ms": 0.27413819285968405, "mean_env_wait_ms": 3.5163994539116517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012729406356811523, "StateBufferConnector_ms": 0.008209466934204102, "ViewRequirementAgentConnector_ms": 0.19630718231201172}, "num_episodes": 31, "episode_return_max": -51.247323582168875, "episode_return_min": -1530.5988490288685, "episode_return_mean": -671.679379468972, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8532187796873, "num_env_steps_trained_throughput_per_sec": 306.8532187796873, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 13160.751, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13160.672, "sample_time_ms": 1210.373, "learn_time_ms": 11880.876, "learn_throughput": 336.676, "synch_weights_time_ms": 68.58}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "1e132_00005", "date": "2024-08-04_08-24-58", "timestamp": 1722740098, "time_this_iter_s": 13.048282146453857, "time_total_s": 519.3359751701355, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540e96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 519.3359751701355, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.022222222222222, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.12716183861096, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.7624206604125598, "policy_loss": -0.015474781933395814, "vf_loss": 1.7739500153188905, "vf_explained_var": 0.9972766426081459, "kl": 0.01364263218808143, "entropy": 1.4735755850871404, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -51.247323582168875, "episode_reward_min": -1530.5988490288685, "episode_reward_mean": -644.8541297776935, "episode_len_mean": 127.83, "episode_media": {}, "episodes_timesteps_total": 12783, "policy_reward_min": {"policy_0": -1530.5988490288685}, "policy_reward_max": {"policy_0": -51.247323582168875}, "policy_reward_mean": {"policy_0": -644.8541297776935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-617.9041158401396, -175.65365685686132, -1254.7451036461944, -1171.7073711155952, -1281.6411131300013, -1348.881346666681, -366.24306137985894, -88.08277936175094, -1276.9468309320591, -695.5712975342793, -202.6075495542095, -1030.3037811960894, -1423.552041529366, -990.1375996524305, -101.81156202327384, -1122.7189414148786, -90.08073697196866, -731.0847948807507, -813.9780377200713, -51.247323582168875, -979.0499961979586, -1285.8273891594897, -642.3336985703625, -104.28921657197205, -945.9181732088259, -148.98556569835102, -276.20339257915026, -428.07925076977745, -929.4101995758053, -939.6601849581871, -966.3805104753994, -1302.2788554239246, -321.24840418878614, -1029.3379829897065, -92.35726148769872, -74.31448063803195, -150.7502857890648, -116.33041337669957, -968.8625605709678, -369.46635810153555, -949.9210036064918, -284.0889239636129, -362.65523390035617, -109.7051811658876, -820.0334814332311, -1500.3271016264277, -349.25656466797477, -321.7414539375808, -761.8742676091522, -569.3893641673519, -105.51161637983347, -532.4692971945985, -1244.1201592622133, -1003.7416587351739, -566.1130557393759, -355.2096728976206, -235.86211476245032, -101.12213076277612, -1322.4763942396735, -454.3790162084084, -323.64010316925754, -1111.8505212981559, -735.7233116560097, -176.20131608944766, -1530.5988490288685, -1080.2582512608558, -1243.9464794704181, -467.52245692285976, -134.06279241140834, -510.95609768441597, -497.1339559292234, -89.80682861937457, -1225.6900562309386, -310.14172155067223, -248.14182406501348, -678.9347904271499, -333.0270335567794, -1405.0214041729184, -1338.946050995627, -541.3456720455989, -829.0437175561982, -624.800455121809, -629.4825374540603, -1042.8461867919784, -985.353285442556, -177.2492977946729, -308.9101945637693, -679.7291947491537, -833.6387982609768, -944.3654099563198, -138.36611476789002, -1377.3644595766048, -653.7922897122053, -77.35767092763872, -192.3152212267917, -449.77987059429586, -482.2785213363693, -86.15642891302132, -109.42613963102185, -1024.226749226507], "episode_lengths": [150, 85, 150, 150, 150, 150, 130, 77, 150, 150, 89, 150, 150, 150, 66, 150, 68, 150, 150, 52, 150, 150, 150, 65, 150, 81, 110, 150, 150, 150, 150, 150, 120, 150, 70, 58, 77, 89, 150, 144, 150, 103, 150, 76, 150, 150, 148, 107, 150, 150, 72, 150, 150, 150, 150, 150, 91, 85, 150, 146, 114, 150, 150, 78, 150, 150, 150, 122, 69, 150, 150, 76, 150, 115, 135, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 84, 104, 150, 150, 150, 77, 150, 150, 62, 137, 150, 150, 69, 72, 150], "policy_policy_0_reward": [-617.9041158401396, -175.65365685686132, -1254.7451036461944, -1171.7073711155952, -1281.6411131300013, -1348.881346666681, -366.24306137985894, -88.08277936175094, -1276.9468309320591, -695.5712975342793, -202.6075495542095, -1030.3037811960894, -1423.552041529366, -990.1375996524305, -101.81156202327384, -1122.7189414148786, -90.08073697196866, -731.0847948807507, -813.9780377200713, -51.247323582168875, -979.0499961979586, -1285.8273891594897, -642.3336985703625, -104.28921657197205, -945.9181732088259, -148.98556569835102, -276.20339257915026, -428.07925076977745, -929.4101995758053, -939.6601849581871, -966.3805104753994, -1302.2788554239246, -321.24840418878614, -1029.3379829897065, -92.35726148769872, -74.31448063803195, -150.7502857890648, -116.33041337669957, -968.8625605709678, -369.46635810153555, -949.9210036064918, -284.0889239636129, -362.65523390035617, -109.7051811658876, -820.0334814332311, -1500.3271016264277, -349.25656466797477, -321.7414539375808, -761.8742676091522, -569.3893641673519, -105.51161637983347, -532.4692971945985, -1244.1201592622133, -1003.7416587351739, -566.1130557393759, -355.2096728976206, -235.86211476245032, -101.12213076277612, -1322.4763942396735, -454.3790162084084, -323.64010316925754, -1111.8505212981559, -735.7233116560097, -176.20131608944766, -1530.5988490288685, -1080.2582512608558, -1243.9464794704181, -467.52245692285976, -134.06279241140834, -510.95609768441597, -497.1339559292234, -89.80682861937457, -1225.6900562309386, -310.14172155067223, -248.14182406501348, -678.9347904271499, -333.0270335567794, -1405.0214041729184, -1338.946050995627, -541.3456720455989, -829.0437175561982, -624.800455121809, -629.4825374540603, -1042.8461867919784, -985.353285442556, -177.2492977946729, -308.9101945637693, -679.7291947491537, -833.6387982609768, -944.3654099563198, -138.36611476789002, -1377.3644595766048, -653.7922897122053, -77.35767092763872, -192.3152212267917, -449.77987059429586, -482.2785213363693, -86.15642891302132, -109.42613963102185, -1024.226749226507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531204413463771, "mean_inference_ms": 1.7232946077104119, "mean_action_processing_ms": 0.2740379600565776, "mean_env_wait_ms": 3.515659359604877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012356281280517578, "StateBufferConnector_ms": 0.007960796356201172, "ViewRequirementAgentConnector_ms": 0.202178955078125}, "num_episodes": 33, "episode_return_max": -51.247323582168875, "episode_return_min": -1530.5988490288685, "episode_return_mean": -644.8541297776935, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.598437059605, "num_env_steps_trained_throughput_per_sec": 302.598437059605, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 13114.521, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13114.443, "sample_time_ms": 1170.072, "learn_time_ms": 11873.945, "learn_throughput": 336.872, "synch_weights_time_ms": 69.547}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "1e132_00005", "date": "2024-08-04_08-25-12", "timestamp": 1722740112, "time_this_iter_s": 13.23192811012268, "time_total_s": 532.5679032802582, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3540ea320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 532.5679032802582, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.026315789473685, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.81238166093826, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.5415577925120791, "policy_loss": -0.013970842396277779, "vf_loss": 1.5507433157414199, "vf_explained_var": 0.9977896889671684, "kl": 0.016448505737086352, "entropy": 1.492371338357528, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -10.75202981845176, "episode_reward_min": -1530.5988490288685, "episode_reward_mean": -612.1906180164075, "episode_len_mean": 125.86, "episode_media": {}, "episodes_timesteps_total": 12586, "policy_reward_min": {"policy_0": -1530.5988490288685}, "policy_reward_max": {"policy_0": -10.75202981845176}, "policy_reward_mean": {"policy_0": -612.1906180164075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.24840418878614, -1029.3379829897065, -92.35726148769872, -74.31448063803195, -150.7502857890648, -116.33041337669957, -968.8625605709678, -369.46635810153555, -949.9210036064918, -284.0889239636129, -362.65523390035617, -109.7051811658876, -820.0334814332311, -1500.3271016264277, -349.25656466797477, -321.7414539375808, -761.8742676091522, -569.3893641673519, -105.51161637983347, -532.4692971945985, -1244.1201592622133, -1003.7416587351739, -566.1130557393759, -355.2096728976206, -235.86211476245032, -101.12213076277612, -1322.4763942396735, -454.3790162084084, -323.64010316925754, -1111.8505212981559, -735.7233116560097, -176.20131608944766, -1530.5988490288685, -1080.2582512608558, -1243.9464794704181, -467.52245692285976, -134.06279241140834, -510.95609768441597, -497.1339559292234, -89.80682861937457, -1225.6900562309386, -310.14172155067223, -248.14182406501348, -678.9347904271499, -333.0270335567794, -1405.0214041729184, -1338.946050995627, -541.3456720455989, -829.0437175561982, -624.800455121809, -629.4825374540603, -1042.8461867919784, -985.353285442556, -177.2492977946729, -308.9101945637693, -679.7291947491537, -833.6387982609768, -944.3654099563198, -138.36611476789002, -1377.3644595766048, -653.7922897122053, -77.35767092763872, -192.3152212267917, -449.77987059429586, -482.2785213363693, -86.15642891302132, -109.42613963102185, -1024.226749226507, -288.6185252665793, -1238.9313639621869, -1204.7219309588515, -1098.557106621359, -1234.6192301292303, -308.3952282268174, -929.4062277769882, -139.9497539823216, -120.30678276418224, -251.45059826835265, -1085.5268246955568, -513.1422904854146, -552.9142953985394, -980.8334067404661, -335.2492213713747, -466.4760359150801, -161.01816537752953, -198.33823692787766, -550.0905355976826, -185.34280943868941, -1178.7513179889215, -602.3050524745139, -1309.881905464318, -1287.7001183400216, -1032.5460369164562, -1316.678994110697, -39.94452431899797, -10.75202981845176, -97.3909118874145, -321.4903832116439, -80.87212954664847, -1394.7623280660741], "episode_lengths": [120, 150, 70, 58, 77, 89, 150, 144, 150, 103, 150, 76, 150, 150, 148, 107, 150, 150, 72, 150, 150, 150, 150, 150, 91, 85, 150, 146, 114, 150, 150, 78, 150, 150, 150, 122, 69, 150, 150, 76, 150, 115, 135, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 84, 104, 150, 150, 150, 77, 150, 150, 62, 137, 150, 150, 69, 72, 150, 119, 150, 150, 150, 150, 103, 150, 72, 69, 137, 150, 150, 150, 150, 116, 138, 77, 99, 150, 98, 150, 150, 150, 150, 150, 150, 59, 36, 63, 114, 76, 150], "policy_policy_0_reward": [-321.24840418878614, -1029.3379829897065, -92.35726148769872, -74.31448063803195, -150.7502857890648, -116.33041337669957, -968.8625605709678, -369.46635810153555, -949.9210036064918, -284.0889239636129, -362.65523390035617, -109.7051811658876, -820.0334814332311, -1500.3271016264277, -349.25656466797477, -321.7414539375808, -761.8742676091522, -569.3893641673519, -105.51161637983347, -532.4692971945985, -1244.1201592622133, -1003.7416587351739, -566.1130557393759, -355.2096728976206, -235.86211476245032, -101.12213076277612, -1322.4763942396735, -454.3790162084084, -323.64010316925754, -1111.8505212981559, -735.7233116560097, -176.20131608944766, -1530.5988490288685, -1080.2582512608558, -1243.9464794704181, -467.52245692285976, -134.06279241140834, -510.95609768441597, -497.1339559292234, -89.80682861937457, -1225.6900562309386, -310.14172155067223, -248.14182406501348, -678.9347904271499, -333.0270335567794, -1405.0214041729184, -1338.946050995627, -541.3456720455989, -829.0437175561982, -624.800455121809, -629.4825374540603, -1042.8461867919784, -985.353285442556, -177.2492977946729, -308.9101945637693, -679.7291947491537, -833.6387982609768, -944.3654099563198, -138.36611476789002, -1377.3644595766048, -653.7922897122053, -77.35767092763872, -192.3152212267917, -449.77987059429586, -482.2785213363693, -86.15642891302132, -109.42613963102185, -1024.226749226507, -288.6185252665793, -1238.9313639621869, -1204.7219309588515, -1098.557106621359, -1234.6192301292303, -308.3952282268174, -929.4062277769882, -139.9497539823216, -120.30678276418224, -251.45059826835265, -1085.5268246955568, -513.1422904854146, -552.9142953985394, -980.8334067404661, -335.2492213713747, -466.4760359150801, -161.01816537752953, -198.33823692787766, -550.0905355976826, -185.34280943868941, -1178.7513179889215, -602.3050524745139, -1309.881905464318, -1287.7001183400216, -1032.5460369164562, -1316.678994110697, -39.94452431899797, -10.75202981845176, -97.3909118874145, -321.4903832116439, -80.87212954664847, -1394.7623280660741]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532293768749982, "mean_inference_ms": 1.7213552689414953, "mean_action_processing_ms": 0.27405201369971116, "mean_env_wait_ms": 3.5130671131234164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012616157531738281, "StateBufferConnector_ms": 0.008057832717895508, "ViewRequirementAgentConnector_ms": 0.20467686653137207}, "num_episodes": 32, "episode_return_max": -10.75202981845176, "episode_return_min": -1530.5988490288685, "episode_return_mean": -612.1906180164075, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.0625527652542, "num_env_steps_trained_throughput_per_sec": 289.0625527652542, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 13181.197, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13181.114, "sample_time_ms": 1161.544, "learn_time_ms": 11948.223, "learn_throughput": 334.778, "synch_weights_time_ms": 70.46}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "1e132_00005", "date": "2024-08-04_08-25-26", "timestamp": 1722740126, "time_this_iter_s": 13.8508939743042, "time_total_s": 546.4187972545624, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ad360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 546.4187972545624, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.615000000000002, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 214.56464197238287, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.5979290150105954, "policy_loss": -0.009918147331336512, "vf_loss": 1.6037222490335503, "vf_explained_var": 0.9964032171294093, "kl": 0.014230630828266536, "entropy": 1.4427803265551726, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -10.75202981845176, "episode_reward_min": -1462.120714175788, "episode_reward_mean": -611.2060932821134, "episode_len_mean": 124.87, "episode_media": {}, "episodes_timesteps_total": 12487, "policy_reward_min": {"policy_0": -1462.120714175788}, "policy_reward_max": {"policy_0": -10.75202981845176}, "policy_reward_mean": {"policy_0": -611.2060932821134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1243.9464794704181, -467.52245692285976, -134.06279241140834, -510.95609768441597, -497.1339559292234, -89.80682861937457, -1225.6900562309386, -310.14172155067223, -248.14182406501348, -678.9347904271499, -333.0270335567794, -1405.0214041729184, -1338.946050995627, -541.3456720455989, -829.0437175561982, -624.800455121809, -629.4825374540603, -1042.8461867919784, -985.353285442556, -177.2492977946729, -308.9101945637693, -679.7291947491537, -833.6387982609768, -944.3654099563198, -138.36611476789002, -1377.3644595766048, -653.7922897122053, -77.35767092763872, -192.3152212267917, -449.77987059429586, -482.2785213363693, -86.15642891302132, -109.42613963102185, -1024.226749226507, -288.6185252665793, -1238.9313639621869, -1204.7219309588515, -1098.557106621359, -1234.6192301292303, -308.3952282268174, -929.4062277769882, -139.9497539823216, -120.30678276418224, -251.45059826835265, -1085.5268246955568, -513.1422904854146, -552.9142953985394, -980.8334067404661, -335.2492213713747, -466.4760359150801, -161.01816537752953, -198.33823692787766, -550.0905355976826, -185.34280943868941, -1178.7513179889215, -602.3050524745139, -1309.881905464318, -1287.7001183400216, -1032.5460369164562, -1316.678994110697, -39.94452431899797, -10.75202981845176, -97.3909118874145, -321.4903832116439, -80.87212954664847, -1394.7623280660741, -1100.4890924780088, -701.7185700522793, -150.1030924518409, -929.6390423249885, -1140.4652365521579, -843.8695094391865, -863.4738621229195, -226.19240737358535, -224.4392247378684, -994.3621288350879, -90.96632385293893, -44.090296994776125, -65.25249102011874, -247.9044201127352, -394.88434553042185, -962.3985107655287, -110.08814255819868, -1001.4166926023352, -269.7493334700119, -1462.120714175788, -191.69864447357324, -858.5382539059054, -180.66098696775413, -1098.3921461578407, -665.7999691873009, -685.7859916007866, -252.38050443857213, -890.1814393570997, -752.8375812635097, -623.4554832710824, -426.01228279141174, -214.65828322212064, -819.2232776938362, -449.23703669429875], "episode_lengths": [150, 122, 69, 150, 150, 76, 150, 115, 135, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 84, 104, 150, 150, 150, 77, 150, 150, 62, 137, 150, 150, 69, 72, 150, 119, 150, 150, 150, 150, 103, 150, 72, 69, 137, 150, 150, 150, 150, 116, 138, 77, 99, 150, 98, 150, 150, 150, 150, 150, 150, 59, 36, 63, 114, 76, 150, 150, 150, 80, 150, 150, 150, 150, 102, 109, 150, 65, 56, 46, 76, 120, 150, 64, 150, 98, 150, 99, 150, 86, 150, 150, 150, 103, 150, 150, 150, 126, 99, 150, 150], "policy_policy_0_reward": [-1243.9464794704181, -467.52245692285976, -134.06279241140834, -510.95609768441597, -497.1339559292234, -89.80682861937457, -1225.6900562309386, -310.14172155067223, -248.14182406501348, -678.9347904271499, -333.0270335567794, -1405.0214041729184, -1338.946050995627, -541.3456720455989, -829.0437175561982, -624.800455121809, -629.4825374540603, -1042.8461867919784, -985.353285442556, -177.2492977946729, -308.9101945637693, -679.7291947491537, -833.6387982609768, -944.3654099563198, -138.36611476789002, -1377.3644595766048, -653.7922897122053, -77.35767092763872, -192.3152212267917, -449.77987059429586, -482.2785213363693, -86.15642891302132, -109.42613963102185, -1024.226749226507, -288.6185252665793, -1238.9313639621869, -1204.7219309588515, -1098.557106621359, -1234.6192301292303, -308.3952282268174, -929.4062277769882, -139.9497539823216, -120.30678276418224, -251.45059826835265, -1085.5268246955568, -513.1422904854146, -552.9142953985394, -980.8334067404661, -335.2492213713747, -466.4760359150801, -161.01816537752953, -198.33823692787766, -550.0905355976826, -185.34280943868941, -1178.7513179889215, -602.3050524745139, -1309.881905464318, -1287.7001183400216, -1032.5460369164562, -1316.678994110697, -39.94452431899797, -10.75202981845176, -97.3909118874145, -321.4903832116439, -80.87212954664847, -1394.7623280660741, -1100.4890924780088, -701.7185700522793, -150.1030924518409, -929.6390423249885, -1140.4652365521579, -843.8695094391865, -863.4738621229195, -226.19240737358535, -224.4392247378684, -994.3621288350879, -90.96632385293893, -44.090296994776125, -65.25249102011874, -247.9044201127352, -394.88434553042185, -962.3985107655287, -110.08814255819868, -1001.4166926023352, -269.7493334700119, -1462.120714175788, -191.69864447357324, -858.5382539059054, -180.66098696775413, -1098.3921461578407, -665.7999691873009, -685.7859916007866, -252.38050443857213, -890.1814393570997, -752.8375812635097, -623.4554832710824, -426.01228279141174, -214.65828322212064, -819.2232776938362, -449.23703669429875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553024129144707, "mean_inference_ms": 1.7196050093049928, "mean_action_processing_ms": 0.2740094890467047, "mean_env_wait_ms": 3.512291059557495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012256383895874023, "StateBufferConnector_ms": 0.00815129280090332, "ViewRequirementAgentConnector_ms": 0.21399903297424316}, "num_episodes": 34, "episode_return_max": -10.75202981845176, "episode_return_min": -1462.120714175788, "episode_return_mean": -611.2060932821134, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.34092817246744, "num_env_steps_trained_throughput_per_sec": 411.34092817246744, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12856.26, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12856.177, "sample_time_ms": 1157.286, "learn_time_ms": 11629.271, "learn_throughput": 343.96, "synch_weights_time_ms": 68.737}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "1e132_00005", "date": "2024-08-04_08-25-35", "timestamp": 1722740135, "time_this_iter_s": 9.73652172088623, "time_total_s": 556.1553189754486, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d9967a5870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 556.1553189754486, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 20.37142857142857, "ram_util_percent": 28.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.40964026848476, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.7540180314953129, "policy_loss": -0.014878014715698858, "vf_loss": 1.7644049835080902, "vf_explained_var": 0.9964150497689843, "kl": 0.015448491869725937, "entropy": 1.4348428120215735, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -10.75202981845176, "episode_reward_min": -1462.120714175788, "episode_reward_mean": -612.2054586799056, "episode_len_mean": 122.3, "episode_media": {}, "episodes_timesteps_total": 12230, "policy_reward_min": {"policy_0": -1462.120714175788}, "policy_reward_max": {"policy_0": -10.75202981845176}, "policy_reward_mean": {"policy_0": -612.2054586799056}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-482.2785213363693, -86.15642891302132, -109.42613963102185, -1024.226749226507, -288.6185252665793, -1238.9313639621869, -1204.7219309588515, -1098.557106621359, -1234.6192301292303, -308.3952282268174, -929.4062277769882, -139.9497539823216, -120.30678276418224, -251.45059826835265, -1085.5268246955568, -513.1422904854146, -552.9142953985394, -980.8334067404661, -335.2492213713747, -466.4760359150801, -161.01816537752953, -198.33823692787766, -550.0905355976826, -185.34280943868941, -1178.7513179889215, -602.3050524745139, -1309.881905464318, -1287.7001183400216, -1032.5460369164562, -1316.678994110697, -39.94452431899797, -10.75202981845176, -97.3909118874145, -321.4903832116439, -80.87212954664847, -1394.7623280660741, -1100.4890924780088, -701.7185700522793, -150.1030924518409, -929.6390423249885, -1140.4652365521579, -843.8695094391865, -863.4738621229195, -226.19240737358535, -224.4392247378684, -994.3621288350879, -90.96632385293893, -44.090296994776125, -65.25249102011874, -247.9044201127352, -394.88434553042185, -962.3985107655287, -110.08814255819868, -1001.4166926023352, -269.7493334700119, -1462.120714175788, -191.69864447357324, -858.5382539059054, -180.66098696775413, -1098.3921461578407, -665.7999691873009, -685.7859916007866, -252.38050443857213, -890.1814393570997, -752.8375812635097, -623.4554832710824, -426.01228279141174, -214.65828322212064, -819.2232776938362, -449.23703669429875, -645.6581928375155, -51.86587680333442, -603.3145545698052, -598.6210265070233, -99.0114932171561, -23.28473664371389, -960.166059083287, -1099.0188769317713, -105.59619738610549, -942.8397228762595, -1137.3244949786185, -1175.3878720064006, -136.46794001752426, -978.2780841235549, -616.0852356480259, -1171.9197834092038, -255.99369776987467, -621.2709171480495, -1137.0203498790174, -89.09239542836353, -260.46394921914435, -1015.8198984707817, -1298.788440467538, -279.57909631023387, -541.154501291727, -1401.8358588541837, -405.62232516962706, -1097.6046958479658, -131.01052980530844, -188.91160565741862], "episode_lengths": [150, 69, 72, 150, 119, 150, 150, 150, 150, 103, 150, 72, 69, 137, 150, 150, 150, 150, 116, 138, 77, 99, 150, 98, 150, 150, 150, 150, 150, 150, 59, 36, 63, 114, 76, 150, 150, 150, 80, 150, 150, 150, 150, 102, 109, 150, 65, 56, 46, 76, 120, 150, 64, 150, 98, 150, 99, 150, 86, 150, 150, 150, 103, 150, 150, 150, 126, 99, 150, 150, 150, 61, 150, 150, 53, 42, 150, 150, 73, 150, 150, 150, 76, 150, 150, 150, 108, 150, 150, 61, 101, 150, 150, 113, 148, 150, 119, 150, 89, 90], "policy_policy_0_reward": [-482.2785213363693, -86.15642891302132, -109.42613963102185, -1024.226749226507, -288.6185252665793, -1238.9313639621869, -1204.7219309588515, -1098.557106621359, -1234.6192301292303, -308.3952282268174, -929.4062277769882, -139.9497539823216, -120.30678276418224, -251.45059826835265, -1085.5268246955568, -513.1422904854146, -552.9142953985394, -980.8334067404661, -335.2492213713747, -466.4760359150801, -161.01816537752953, -198.33823692787766, -550.0905355976826, -185.34280943868941, -1178.7513179889215, -602.3050524745139, -1309.881905464318, -1287.7001183400216, -1032.5460369164562, -1316.678994110697, -39.94452431899797, -10.75202981845176, -97.3909118874145, -321.4903832116439, -80.87212954664847, -1394.7623280660741, -1100.4890924780088, -701.7185700522793, -150.1030924518409, -929.6390423249885, -1140.4652365521579, -843.8695094391865, -863.4738621229195, -226.19240737358535, -224.4392247378684, -994.3621288350879, -90.96632385293893, -44.090296994776125, -65.25249102011874, -247.9044201127352, -394.88434553042185, -962.3985107655287, -110.08814255819868, -1001.4166926023352, -269.7493334700119, -1462.120714175788, -191.69864447357324, -858.5382539059054, -180.66098696775413, -1098.3921461578407, -665.7999691873009, -685.7859916007866, -252.38050443857213, -890.1814393570997, -752.8375812635097, -623.4554832710824, -426.01228279141174, -214.65828322212064, -819.2232776938362, -449.23703669429875, -645.6581928375155, -51.86587680333442, -603.3145545698052, -598.6210265070233, -99.0114932171561, -23.28473664371389, -960.166059083287, -1099.0188769317713, -105.59619738610549, -942.8397228762595, -1137.3244949786185, -1175.3878720064006, -136.46794001752426, -978.2780841235549, -616.0852356480259, -1171.9197834092038, -255.99369776987467, -621.2709171480495, -1137.0203498790174, -89.09239542836353, -260.46394921914435, -1015.8198984707817, -1298.788440467538, -279.57909631023387, -541.154501291727, -1401.8358588541837, -405.62232516962706, -1097.6046958479658, -131.01052980530844, -188.91160565741862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530387134570769, "mean_inference_ms": 1.7185523328857772, "mean_action_processing_ms": 0.2740676479586693, "mean_env_wait_ms": 3.5111513549225286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531757354736328, "StateBufferConnector_ms": 0.008117914199829102, "ViewRequirementAgentConnector_ms": 0.2134838104248047}, "num_episodes": 30, "episode_return_max": -10.75202981845176, "episode_return_min": -1462.120714175788, "episode_return_mean": -612.2054586799056, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.82854460150423, "num_env_steps_trained_throughput_per_sec": 309.82854460150423, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12799.343, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12799.264, "sample_time_ms": 1144.565, "learn_time_ms": 11585.243, "learn_throughput": 345.267, "synch_weights_time_ms": 68.585}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "1e132_00005", "date": "2024-08-04_08-25-48", "timestamp": 1722740148, "time_this_iter_s": 12.9220449924469, "time_total_s": 569.0773639678955, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d344735c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 569.0773639678955, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.96111111111111, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.61759404142697, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.5225530872742334, "policy_loss": -0.01956896193053884, "vf_loss": 1.53701420382907, "vf_explained_var": 0.9981207057833672, "kl": 0.01750540573921173, "entropy": 1.4377506917963425, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -3.926543951280073, "episode_reward_min": -1465.5715207276062, "episode_reward_mean": -581.9393921883776, "episode_len_mean": 120.37, "episode_media": {}, "episodes_timesteps_total": 12037, "policy_reward_min": {"policy_0": -1465.5715207276062}, "policy_reward_max": {"policy_0": -3.926543951280073}, "policy_reward_mean": {"policy_0": -581.9393921883776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1394.7623280660741, -1100.4890924780088, -701.7185700522793, -150.1030924518409, -929.6390423249885, -1140.4652365521579, -843.8695094391865, -863.4738621229195, -226.19240737358535, -224.4392247378684, -994.3621288350879, -90.96632385293893, -44.090296994776125, -65.25249102011874, -247.9044201127352, -394.88434553042185, -962.3985107655287, -110.08814255819868, -1001.4166926023352, -269.7493334700119, -1462.120714175788, -191.69864447357324, -858.5382539059054, -180.66098696775413, -1098.3921461578407, -665.7999691873009, -685.7859916007866, -252.38050443857213, -890.1814393570997, -752.8375812635097, -623.4554832710824, -426.01228279141174, -214.65828322212064, -819.2232776938362, -449.23703669429875, -645.6581928375155, -51.86587680333442, -603.3145545698052, -598.6210265070233, -99.0114932171561, -23.28473664371389, -960.166059083287, -1099.0188769317713, -105.59619738610549, -942.8397228762595, -1137.3244949786185, -1175.3878720064006, -136.46794001752426, -978.2780841235549, -616.0852356480259, -1171.9197834092038, -255.99369776987467, -621.2709171480495, -1137.0203498790174, -89.09239542836353, -260.46394921914435, -1015.8198984707817, -1298.788440467538, -279.57909631023387, -541.154501291727, -1401.8358588541837, -405.62232516962706, -1097.6046958479658, -131.01052980530844, -188.91160565741862, -244.3295635466782, -85.68636324535406, -1431.8525100942102, -28.60332747079152, -400.9215824881019, -595.4643801779553, -129.23654489032023, -863.2473859502857, -363.99277897879443, -935.9638120838699, -218.451298466527, -426.97008498023905, -373.67838978683835, -1167.3316471832647, -644.985470156709, -932.4920474084945, -335.6879558689736, -568.5899386919376, -47.89492221013565, -532.3202286380833, -3.926543951280073, -51.64412359366407, -1258.6579674183247, -293.0007795038351, -1071.2631993833975, -381.3177043776015, -379.8994435563602, -468.5048552636987, -118.62833079403791, -56.39999486062925, -198.26912037709218, -20.94117057200879, -1465.5715207276062, -374.8993466162354, -1327.058830623945], "episode_lengths": [150, 150, 150, 80, 150, 150, 150, 150, 102, 109, 150, 65, 56, 46, 76, 120, 150, 64, 150, 98, 150, 99, 150, 86, 150, 150, 150, 103, 150, 150, 150, 126, 99, 150, 150, 150, 61, 150, 150, 53, 42, 150, 150, 73, 150, 150, 150, 76, 150, 150, 150, 108, 150, 150, 61, 101, 150, 150, 113, 148, 150, 119, 150, 89, 90, 96, 72, 150, 47, 129, 150, 78, 150, 133, 150, 101, 138, 130, 150, 150, 150, 106, 150, 49, 150, 35, 59, 150, 114, 150, 118, 132, 150, 72, 66, 104, 40, 150, 105, 150], "policy_policy_0_reward": [-1394.7623280660741, -1100.4890924780088, -701.7185700522793, -150.1030924518409, -929.6390423249885, -1140.4652365521579, -843.8695094391865, -863.4738621229195, -226.19240737358535, -224.4392247378684, -994.3621288350879, -90.96632385293893, -44.090296994776125, -65.25249102011874, -247.9044201127352, -394.88434553042185, -962.3985107655287, -110.08814255819868, -1001.4166926023352, -269.7493334700119, -1462.120714175788, -191.69864447357324, -858.5382539059054, -180.66098696775413, -1098.3921461578407, -665.7999691873009, -685.7859916007866, -252.38050443857213, -890.1814393570997, -752.8375812635097, -623.4554832710824, -426.01228279141174, -214.65828322212064, -819.2232776938362, -449.23703669429875, -645.6581928375155, -51.86587680333442, -603.3145545698052, -598.6210265070233, -99.0114932171561, -23.28473664371389, -960.166059083287, -1099.0188769317713, -105.59619738610549, -942.8397228762595, -1137.3244949786185, -1175.3878720064006, -136.46794001752426, -978.2780841235549, -616.0852356480259, -1171.9197834092038, -255.99369776987467, -621.2709171480495, -1137.0203498790174, -89.09239542836353, -260.46394921914435, -1015.8198984707817, -1298.788440467538, -279.57909631023387, -541.154501291727, -1401.8358588541837, -405.62232516962706, -1097.6046958479658, -131.01052980530844, -188.91160565741862, -244.3295635466782, -85.68636324535406, -1431.8525100942102, -28.60332747079152, -400.9215824881019, -595.4643801779553, -129.23654489032023, -863.2473859502857, -363.99277897879443, -935.9638120838699, -218.451298466527, -426.97008498023905, -373.67838978683835, -1167.3316471832647, -644.985470156709, -932.4920474084945, -335.6879558689736, -568.5899386919376, -47.89492221013565, -532.3202286380833, -3.926543951280073, -51.64412359366407, -1258.6579674183247, -293.0007795038351, -1071.2631993833975, -381.3177043776015, -379.8994435563602, -468.5048552636987, -118.62833079403791, -56.39999486062925, -198.26912037709218, -20.94117057200879, -1465.5715207276062, -374.8993466162354, -1327.058830623945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531796459496361, "mean_inference_ms": 1.7176241354704962, "mean_action_processing_ms": 0.27385330189062196, "mean_env_wait_ms": 3.5110868816711256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012288570404052734, "StateBufferConnector_ms": 0.007934331893920898, "ViewRequirementAgentConnector_ms": 0.20159482955932617}, "num_episodes": 35, "episode_return_max": -3.926543951280073, "episode_return_min": -1465.5715207276062, "episode_return_mean": -581.9393921883776, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.23169110633575, "num_env_steps_trained_throughput_per_sec": 310.23169110633575, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12807.966, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12807.886, "sample_time_ms": 1142.117, "learn_time_ms": 11596.824, "learn_throughput": 344.922, "synch_weights_time_ms": 68.083}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "1e132_00005", "date": "2024-08-04_08-26-01", "timestamp": 1722740161, "time_this_iter_s": 12.906224727630615, "time_total_s": 581.9835886955261, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bb880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 581.9835886955261, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.38888888888889, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.98674548069636, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.4695255987035731, "policy_loss": -0.01434120502769171, "vf_loss": 1.479542459671696, "vf_explained_var": 0.9977892837797602, "kl": 0.014889495217964118, "entropy": 1.425045379747947, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -3.926543951280073, "episode_reward_min": -1465.5715207276062, "episode_reward_mean": -603.7884132765362, "episode_len_mean": 121.73, "episode_media": {}, "episodes_timesteps_total": 12173, "policy_reward_min": {"policy_0": -1465.5715207276062}, "policy_reward_max": {"policy_0": -3.926543951280073}, "policy_reward_mean": {"policy_0": -603.7884132765362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-426.01228279141174, -214.65828322212064, -819.2232776938362, -449.23703669429875, -645.6581928375155, -51.86587680333442, -603.3145545698052, -598.6210265070233, -99.0114932171561, -23.28473664371389, -960.166059083287, -1099.0188769317713, -105.59619738610549, -942.8397228762595, -1137.3244949786185, -1175.3878720064006, -136.46794001752426, -978.2780841235549, -616.0852356480259, -1171.9197834092038, -255.99369776987467, -621.2709171480495, -1137.0203498790174, -89.09239542836353, -260.46394921914435, -1015.8198984707817, -1298.788440467538, -279.57909631023387, -541.154501291727, -1401.8358588541837, -405.62232516962706, -1097.6046958479658, -131.01052980530844, -188.91160565741862, -244.3295635466782, -85.68636324535406, -1431.8525100942102, -28.60332747079152, -400.9215824881019, -595.4643801779553, -129.23654489032023, -863.2473859502857, -363.99277897879443, -935.9638120838699, -218.451298466527, -426.97008498023905, -373.67838978683835, -1167.3316471832647, -644.985470156709, -932.4920474084945, -335.6879558689736, -568.5899386919376, -47.89492221013565, -532.3202286380833, -3.926543951280073, -51.64412359366407, -1258.6579674183247, -293.0007795038351, -1071.2631993833975, -381.3177043776015, -379.8994435563602, -468.5048552636987, -118.62833079403791, -56.39999486062925, -198.26912037709218, -20.94117057200879, -1465.5715207276062, -374.8993466162354, -1327.058830623945, -938.1506964350762, -210.0652593932134, -73.00717876320964, -972.7902917041912, -143.9682828748024, -7.558817611359659, -793.347215241235, -1358.0561228236909, -849.2384301515119, -989.6026792686631, -171.731000883077, -1184.6461604818053, -314.7082395217108, -1230.7197234032935, -609.4340666400782, -126.18374197206826, -831.7294723415077, -1237.8630788849225, -853.0409040042468, -814.6144545289947, -676.6340708131604, -38.39907262814808, -1163.1190656759236, -321.74381441882565, -871.1133296361825, -1057.051788862243, -1147.9607217131963, -995.2409586952688, -718.2248836090002, -314.64304768602756, -588.4323042895008], "episode_lengths": [126, 99, 150, 150, 150, 61, 150, 150, 53, 42, 150, 150, 73, 150, 150, 150, 76, 150, 150, 150, 108, 150, 150, 61, 101, 150, 150, 113, 148, 150, 119, 150, 89, 90, 96, 72, 150, 47, 129, 150, 78, 150, 133, 150, 101, 138, 130, 150, 150, 150, 106, 150, 49, 150, 35, 59, 150, 114, 150, 118, 132, 150, 72, 66, 104, 40, 150, 105, 150, 150, 94, 63, 150, 77, 38, 150, 150, 150, 150, 80, 150, 110, 150, 150, 76, 150, 150, 150, 150, 150, 52, 150, 110, 150, 150, 150, 150, 150, 90, 150], "policy_policy_0_reward": [-426.01228279141174, -214.65828322212064, -819.2232776938362, -449.23703669429875, -645.6581928375155, -51.86587680333442, -603.3145545698052, -598.6210265070233, -99.0114932171561, -23.28473664371389, -960.166059083287, -1099.0188769317713, -105.59619738610549, -942.8397228762595, -1137.3244949786185, -1175.3878720064006, -136.46794001752426, -978.2780841235549, -616.0852356480259, -1171.9197834092038, -255.99369776987467, -621.2709171480495, -1137.0203498790174, -89.09239542836353, -260.46394921914435, -1015.8198984707817, -1298.788440467538, -279.57909631023387, -541.154501291727, -1401.8358588541837, -405.62232516962706, -1097.6046958479658, -131.01052980530844, -188.91160565741862, -244.3295635466782, -85.68636324535406, -1431.8525100942102, -28.60332747079152, -400.9215824881019, -595.4643801779553, -129.23654489032023, -863.2473859502857, -363.99277897879443, -935.9638120838699, -218.451298466527, -426.97008498023905, -373.67838978683835, -1167.3316471832647, -644.985470156709, -932.4920474084945, -335.6879558689736, -568.5899386919376, -47.89492221013565, -532.3202286380833, -3.926543951280073, -51.64412359366407, -1258.6579674183247, -293.0007795038351, -1071.2631993833975, -381.3177043776015, -379.8994435563602, -468.5048552636987, -118.62833079403791, -56.39999486062925, -198.26912037709218, -20.94117057200879, -1465.5715207276062, -374.8993466162354, -1327.058830623945, -938.1506964350762, -210.0652593932134, -73.00717876320964, -972.7902917041912, -143.9682828748024, -7.558817611359659, -793.347215241235, -1358.0561228236909, -849.2384301515119, -989.6026792686631, -171.731000883077, -1184.6461604818053, -314.7082395217108, -1230.7197234032935, -609.4340666400782, -126.18374197206826, -831.7294723415077, -1237.8630788849225, -853.0409040042468, -814.6144545289947, -676.6340708131604, -38.39907262814808, -1163.1190656759236, -321.74381441882565, -871.1133296361825, -1057.051788862243, -1147.9607217131963, -995.2409586952688, -718.2248836090002, -314.64304768602756, -588.4323042895008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531102365118469, "mean_inference_ms": 1.7161817809877598, "mean_action_processing_ms": 0.27389347633119765, "mean_env_wait_ms": 3.50903830173494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01300191879272461, "StateBufferConnector_ms": 0.007753133773803711, "ViewRequirementAgentConnector_ms": 0.1914217472076416}, "num_episodes": 31, "episode_return_max": -3.926543951280073, "episode_return_min": -1465.5715207276062, "episode_return_mean": -603.7884132765362, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.1536915691269, "num_env_steps_trained_throughput_per_sec": 305.1536915691269, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12813.618, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12813.54, "sample_time_ms": 1143.838, "learn_time_ms": 11601.689, "learn_throughput": 344.777, "synch_weights_time_ms": 67.16}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "1e132_00005", "date": "2024-08-04_08-26-14", "timestamp": 1722740174, "time_this_iter_s": 13.119874477386475, "time_total_s": 595.1034631729126, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447ad2d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 595.1034631729126, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.826315789473682, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.6086372077465, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.5103554838026563, "policy_loss": -0.01199774944204061, "vf_loss": 1.5181064888834954, "vf_explained_var": 0.9974676799649994, "kl": 0.01461791296769661, "entropy": 1.386363659054041, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -3.926543951280073, "episode_reward_min": -1541.616173586684, "episode_reward_mean": -562.4740257147593, "episode_len_mean": 119.56, "episode_media": {}, "episodes_timesteps_total": 11956, "policy_reward_min": {"policy_0": -1541.616173586684}, "policy_reward_max": {"policy_0": -3.926543951280073}, "policy_reward_mean": {"policy_0": -562.4740257147593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-244.3295635466782, -85.68636324535406, -1431.8525100942102, -28.60332747079152, -400.9215824881019, -595.4643801779553, -129.23654489032023, -863.2473859502857, -363.99277897879443, -935.9638120838699, -218.451298466527, -426.97008498023905, -373.67838978683835, -1167.3316471832647, -644.985470156709, -932.4920474084945, -335.6879558689736, -568.5899386919376, -47.89492221013565, -532.3202286380833, -3.926543951280073, -51.64412359366407, -1258.6579674183247, -293.0007795038351, -1071.2631993833975, -381.3177043776015, -379.8994435563602, -468.5048552636987, -118.62833079403791, -56.39999486062925, -198.26912037709218, -20.94117057200879, -1465.5715207276062, -374.8993466162354, -1327.058830623945, -938.1506964350762, -210.0652593932134, -73.00717876320964, -972.7902917041912, -143.9682828748024, -7.558817611359659, -793.347215241235, -1358.0561228236909, -849.2384301515119, -989.6026792686631, -171.731000883077, -1184.6461604818053, -314.7082395217108, -1230.7197234032935, -609.4340666400782, -126.18374197206826, -831.7294723415077, -1237.8630788849225, -853.0409040042468, -814.6144545289947, -676.6340708131604, -38.39907262814808, -1163.1190656759236, -321.74381441882565, -871.1133296361825, -1057.051788862243, -1147.9607217131963, -995.2409586952688, -718.2248836090002, -314.64304768602756, -588.4323042895008, -515.6872049720686, -1008.668937504516, -326.5904272577414, -207.94094499712153, -268.4587291101501, -49.17424047062796, -1088.6892357413424, -153.2080356665589, -462.5338533157303, -284.61162240633615, -84.1166292492861, -813.8970284116167, -105.51547286062852, -208.44417875806946, -124.33730942105845, -1347.8406821767653, -632.4110039883521, -354.5780862452013, -205.60769647283408, -550.0644081545005, -477.6387531110214, -227.57948690830133, -194.1132479449915, -845.2775555365741, -491.2294897182732, -600.6468248854729, -1541.616173586684, -161.8385612486389, -458.0468527922097, -149.46467204868947, -779.4337531245056, -948.9710462474451, -177.98320291415675, -1000.4851853350442], "episode_lengths": [96, 72, 150, 47, 129, 150, 78, 150, 133, 150, 101, 138, 130, 150, 150, 150, 106, 150, 49, 150, 35, 59, 150, 114, 150, 118, 132, 150, 72, 66, 104, 40, 150, 105, 150, 150, 94, 63, 150, 77, 38, 150, 150, 150, 150, 80, 150, 110, 150, 150, 76, 150, 150, 150, 150, 150, 52, 150, 110, 150, 150, 150, 150, 150, 90, 150, 138, 150, 108, 88, 127, 47, 150, 86, 150, 109, 65, 150, 65, 97, 77, 150, 150, 118, 95, 150, 118, 92, 85, 150, 135, 150, 150, 91, 138, 82, 150, 150, 81, 150], "policy_policy_0_reward": [-244.3295635466782, -85.68636324535406, -1431.8525100942102, -28.60332747079152, -400.9215824881019, -595.4643801779553, -129.23654489032023, -863.2473859502857, -363.99277897879443, -935.9638120838699, -218.451298466527, -426.97008498023905, -373.67838978683835, -1167.3316471832647, -644.985470156709, -932.4920474084945, -335.6879558689736, -568.5899386919376, -47.89492221013565, -532.3202286380833, -3.926543951280073, -51.64412359366407, -1258.6579674183247, -293.0007795038351, -1071.2631993833975, -381.3177043776015, -379.8994435563602, -468.5048552636987, -118.62833079403791, -56.39999486062925, -198.26912037709218, -20.94117057200879, -1465.5715207276062, -374.8993466162354, -1327.058830623945, -938.1506964350762, -210.0652593932134, -73.00717876320964, -972.7902917041912, -143.9682828748024, -7.558817611359659, -793.347215241235, -1358.0561228236909, -849.2384301515119, -989.6026792686631, -171.731000883077, -1184.6461604818053, -314.7082395217108, -1230.7197234032935, -609.4340666400782, -126.18374197206826, -831.7294723415077, -1237.8630788849225, -853.0409040042468, -814.6144545289947, -676.6340708131604, -38.39907262814808, -1163.1190656759236, -321.74381441882565, -871.1133296361825, -1057.051788862243, -1147.9607217131963, -995.2409586952688, -718.2248836090002, -314.64304768602756, -588.4323042895008, -515.6872049720686, -1008.668937504516, -326.5904272577414, -207.94094499712153, -268.4587291101501, -49.17424047062796, -1088.6892357413424, -153.2080356665589, -462.5338533157303, -284.61162240633615, -84.1166292492861, -813.8970284116167, -105.51547286062852, -208.44417875806946, -124.33730942105845, -1347.8406821767653, -632.4110039883521, -354.5780862452013, -205.60769647283408, -550.0644081545005, -477.6387531110214, -227.57948690830133, -194.1132479449915, -845.2775555365741, -491.2294897182732, -600.6468248854729, -1541.616173586684, -161.8385612486389, -458.0468527922097, -149.46467204868947, -779.4337531245056, -948.9710462474451, -177.98320291415675, -1000.4851853350442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531357564869346, "mean_inference_ms": 1.7151029712030863, "mean_action_processing_ms": 0.27392943538744896, "mean_env_wait_ms": 3.506775544680354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012749195098876953, "StateBufferConnector_ms": 0.007859468460083008, "ViewRequirementAgentConnector_ms": 0.19478678703308105}, "num_episodes": 34, "episode_return_max": -3.926543951280073, "episode_return_min": -1541.616173586684, "episode_return_mean": -562.4740257147593, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.63940231903916, "num_env_steps_trained_throughput_per_sec": 308.63940231903916, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12814.844, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12814.771, "sample_time_ms": 1138.985, "learn_time_ms": 11609.909, "learn_throughput": 344.533, "synch_weights_time_ms": 65.039}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "1e132_00005", "date": "2024-08-04_08-26-27", "timestamp": 1722740187, "time_this_iter_s": 12.972857475280762, "time_total_s": 608.0763206481934, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bbf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 608.0763206481934, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.921052631578945, "ram_util_percent": 28.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.35806626677513, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.625413136308392, "policy_loss": -0.01127837982494384, "vf_loss": 1.6325712788850069, "vf_explained_var": 0.9975182361279925, "kl": 0.014138105984253949, "entropy": 1.2119299608593186, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -7.558817611359659, "episode_reward_min": -1541.616173586684, "episode_reward_mean": -538.880037441702, "episode_len_mean": 118.06, "episode_media": {}, "episodes_timesteps_total": 11806, "policy_reward_min": {"policy_0": -1541.616173586684}, "policy_reward_max": {"policy_0": -7.558817611359659}, "policy_reward_mean": {"policy_0": -538.880037441702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-972.7902917041912, -143.9682828748024, -7.558817611359659, -793.347215241235, -1358.0561228236909, -849.2384301515119, -989.6026792686631, -171.731000883077, -1184.6461604818053, -314.7082395217108, -1230.7197234032935, -609.4340666400782, -126.18374197206826, -831.7294723415077, -1237.8630788849225, -853.0409040042468, -814.6144545289947, -676.6340708131604, -38.39907262814808, -1163.1190656759236, -321.74381441882565, -871.1133296361825, -1057.051788862243, -1147.9607217131963, -995.2409586952688, -718.2248836090002, -314.64304768602756, -588.4323042895008, -515.6872049720686, -1008.668937504516, -326.5904272577414, -207.94094499712153, -268.4587291101501, -49.17424047062796, -1088.6892357413424, -153.2080356665589, -462.5338533157303, -284.61162240633615, -84.1166292492861, -813.8970284116167, -105.51547286062852, -208.44417875806946, -124.33730942105845, -1347.8406821767653, -632.4110039883521, -354.5780862452013, -205.60769647283408, -550.0644081545005, -477.6387531110214, -227.57948690830133, -194.1132479449915, -845.2775555365741, -491.2294897182732, -600.6468248854729, -1541.616173586684, -161.8385612486389, -458.0468527922097, -149.46467204868947, -779.4337531245056, -948.9710462474451, -177.98320291415675, -1000.4851853350442, -895.7789920627508, -374.32832764538426, -125.7180912409008, -921.513547719264, -273.02665806729294, -491.8681630103764, -210.29612153467494, -69.53908169468441, -615.3858110063267, -419.40906312464045, -74.5728175774133, -258.4293924945902, -601.4785050211968, -776.9937444783393, -126.36507655619931, -1060.4356369332663, -600.5310351122215, -339.77528544183775, -24.287071472971164, -140.96678904853383, -241.79337916902423, -517.1123273183603, -221.08398527757126, -807.5904911758004, -58.30276776441379, -53.25619457316061, -1209.3536319243717, -38.6161750355527, -737.6746433049768, -152.49399901179132, -1127.3116777713044, -31.792441200592613, -218.09953045188848, -843.512202318348, -65.14185909213519, -597.0176186376397, -188.68321948696425, -1149.972116466294], "episode_lengths": [150, 77, 38, 150, 150, 150, 150, 80, 150, 110, 150, 150, 76, 150, 150, 150, 150, 150, 52, 150, 110, 150, 150, 150, 150, 150, 90, 150, 138, 150, 108, 88, 127, 47, 150, 86, 150, 109, 65, 150, 65, 97, 77, 150, 150, 118, 95, 150, 118, 92, 85, 150, 135, 150, 150, 91, 138, 82, 150, 150, 81, 150, 150, 127, 77, 150, 107, 150, 83, 48, 130, 118, 56, 99, 150, 150, 74, 150, 150, 122, 47, 74, 140, 150, 91, 150, 55, 62, 150, 50, 150, 71, 150, 43, 93, 150, 63, 150, 101, 150], "policy_policy_0_reward": [-972.7902917041912, -143.9682828748024, -7.558817611359659, -793.347215241235, -1358.0561228236909, -849.2384301515119, -989.6026792686631, -171.731000883077, -1184.6461604818053, -314.7082395217108, -1230.7197234032935, -609.4340666400782, -126.18374197206826, -831.7294723415077, -1237.8630788849225, -853.0409040042468, -814.6144545289947, -676.6340708131604, -38.39907262814808, -1163.1190656759236, -321.74381441882565, -871.1133296361825, -1057.051788862243, -1147.9607217131963, -995.2409586952688, -718.2248836090002, -314.64304768602756, -588.4323042895008, -515.6872049720686, -1008.668937504516, -326.5904272577414, -207.94094499712153, -268.4587291101501, -49.17424047062796, -1088.6892357413424, -153.2080356665589, -462.5338533157303, -284.61162240633615, -84.1166292492861, -813.8970284116167, -105.51547286062852, -208.44417875806946, -124.33730942105845, -1347.8406821767653, -632.4110039883521, -354.5780862452013, -205.60769647283408, -550.0644081545005, -477.6387531110214, -227.57948690830133, -194.1132479449915, -845.2775555365741, -491.2294897182732, -600.6468248854729, -1541.616173586684, -161.8385612486389, -458.0468527922097, -149.46467204868947, -779.4337531245056, -948.9710462474451, -177.98320291415675, -1000.4851853350442, -895.7789920627508, -374.32832764538426, -125.7180912409008, -921.513547719264, -273.02665806729294, -491.8681630103764, -210.29612153467494, -69.53908169468441, -615.3858110063267, -419.40906312464045, -74.5728175774133, -258.4293924945902, -601.4785050211968, -776.9937444783393, -126.36507655619931, -1060.4356369332663, -600.5310351122215, -339.77528544183775, -24.287071472971164, -140.96678904853383, -241.79337916902423, -517.1123273183603, -221.08398527757126, -807.5904911758004, -58.30276776441379, -53.25619457316061, -1209.3536319243717, -38.6161750355527, -737.6746433049768, -152.49399901179132, -1127.3116777713044, -31.792441200592613, -218.09953045188848, -843.512202318348, -65.14185909213519, -597.0176186376397, -188.68321948696425, -1149.972116466294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530691134496064, "mean_inference_ms": 1.7140032655012707, "mean_action_processing_ms": 0.2737710816620364, "mean_env_wait_ms": 3.506326599248227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012582063674926758, "StateBufferConnector_ms": 0.007871866226196289, "ViewRequirementAgentConnector_ms": 0.19885754585266113}, "num_episodes": 38, "episode_return_max": -7.558817611359659, "episode_return_min": -1541.616173586684, "episode_return_mean": -538.880037441702, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.89657823061987, "num_env_steps_trained_throughput_per_sec": 369.89657823061987, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12585.494, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12585.421, "sample_time_ms": 1145.661, "learn_time_ms": 11377.748, "learn_throughput": 351.563, "synch_weights_time_ms": 61.188}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "1e132_00005", "date": "2024-08-04_08-26-38", "timestamp": 1722740198, "time_this_iter_s": 10.825838804244995, "time_total_s": 618.9021594524384, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bb880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 618.9021594524384, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 19.71333333333333, "ram_util_percent": 28.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.76208097139994, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.5211225892727573, "policy_loss": -0.014836550487477023, "vf_loss": 1.5305672995746136, "vf_explained_var": 0.9984089088315765, "kl": 0.01836721337992158, "entropy": 1.1832006013020873, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -12.052029145355208, "episode_reward_min": -1541.616173586684, "episode_reward_mean": -472.4343453426856, "episode_len_mean": 113.02, "episode_media": {}, "episodes_timesteps_total": 11302, "policy_reward_min": {"policy_0": -1541.616173586684}, "policy_reward_max": {"policy_0": -12.052029145355208}, "policy_reward_mean": {"policy_0": -472.4343453426856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-462.5338533157303, -284.61162240633615, -84.1166292492861, -813.8970284116167, -105.51547286062852, -208.44417875806946, -124.33730942105845, -1347.8406821767653, -632.4110039883521, -354.5780862452013, -205.60769647283408, -550.0644081545005, -477.6387531110214, -227.57948690830133, -194.1132479449915, -845.2775555365741, -491.2294897182732, -600.6468248854729, -1541.616173586684, -161.8385612486389, -458.0468527922097, -149.46467204868947, -779.4337531245056, -948.9710462474451, -177.98320291415675, -1000.4851853350442, -895.7789920627508, -374.32832764538426, -125.7180912409008, -921.513547719264, -273.02665806729294, -491.8681630103764, -210.29612153467494, -69.53908169468441, -615.3858110063267, -419.40906312464045, -74.5728175774133, -258.4293924945902, -601.4785050211968, -776.9937444783393, -126.36507655619931, -1060.4356369332663, -600.5310351122215, -339.77528544183775, -24.287071472971164, -140.96678904853383, -241.79337916902423, -517.1123273183603, -221.08398527757126, -807.5904911758004, -58.30276776441379, -53.25619457316061, -1209.3536319243717, -38.6161750355527, -737.6746433049768, -152.49399901179132, -1127.3116777713044, -31.792441200592613, -218.09953045188848, -843.512202318348, -65.14185909213519, -597.0176186376397, -188.68321948696425, -1149.972116466294, -38.76391664148835, -187.9646689130929, -1164.7722152466476, -79.08405313994508, -227.0159383785422, -33.08720533430431, -1191.7442462207803, -768.9408163353687, -79.19509267440979, -422.90344569227045, -84.5426021138611, -431.10231831506536, -205.00970166834878, -886.4100416346256, -108.03337858635479, -849.6048137792603, -136.78504428062752, -12.052029145355208, -678.1630610962676, -437.46320687531306, -296.30401111558643, -223.20977753769688, -1448.2759967931395, -1020.0312986217829, -171.70449096006118, -645.448051447586, -1148.9739195812529, -256.2404866127167, -82.11763196127926, -386.6279618603914, -921.9514269921178, -349.39648742270793, -1039.7645542847451, -591.4210750841356, -549.1024516193125, -202.43686821666756], "episode_lengths": [150, 109, 65, 150, 65, 97, 77, 150, 150, 118, 95, 150, 118, 92, 85, 150, 135, 150, 150, 91, 138, 82, 150, 150, 81, 150, 150, 127, 77, 150, 107, 150, 83, 48, 130, 118, 56, 99, 150, 150, 74, 150, 150, 122, 47, 74, 140, 150, 91, 150, 55, 62, 150, 50, 150, 71, 150, 43, 93, 150, 63, 150, 101, 150, 47, 91, 150, 59, 104, 47, 150, 150, 60, 127, 64, 136, 86, 150, 70, 150, 78, 42, 150, 127, 109, 104, 150, 150, 92, 150, 150, 93, 62, 119, 150, 117, 150, 150, 150, 89], "policy_policy_0_reward": [-462.5338533157303, -284.61162240633615, -84.1166292492861, -813.8970284116167, -105.51547286062852, -208.44417875806946, -124.33730942105845, -1347.8406821767653, -632.4110039883521, -354.5780862452013, -205.60769647283408, -550.0644081545005, -477.6387531110214, -227.57948690830133, -194.1132479449915, -845.2775555365741, -491.2294897182732, -600.6468248854729, -1541.616173586684, -161.8385612486389, -458.0468527922097, -149.46467204868947, -779.4337531245056, -948.9710462474451, -177.98320291415675, -1000.4851853350442, -895.7789920627508, -374.32832764538426, -125.7180912409008, -921.513547719264, -273.02665806729294, -491.8681630103764, -210.29612153467494, -69.53908169468441, -615.3858110063267, -419.40906312464045, -74.5728175774133, -258.4293924945902, -601.4785050211968, -776.9937444783393, -126.36507655619931, -1060.4356369332663, -600.5310351122215, -339.77528544183775, -24.287071472971164, -140.96678904853383, -241.79337916902423, -517.1123273183603, -221.08398527757126, -807.5904911758004, -58.30276776441379, -53.25619457316061, -1209.3536319243717, -38.6161750355527, -737.6746433049768, -152.49399901179132, -1127.3116777713044, -31.792441200592613, -218.09953045188848, -843.512202318348, -65.14185909213519, -597.0176186376397, -188.68321948696425, -1149.972116466294, -38.76391664148835, -187.9646689130929, -1164.7722152466476, -79.08405313994508, -227.0159383785422, -33.08720533430431, -1191.7442462207803, -768.9408163353687, -79.19509267440979, -422.90344569227045, -84.5426021138611, -431.10231831506536, -205.00970166834878, -886.4100416346256, -108.03337858635479, -849.6048137792603, -136.78504428062752, -12.052029145355208, -678.1630610962676, -437.46320687531306, -296.30401111558643, -223.20977753769688, -1448.2759967931395, -1020.0312986217829, -171.70449096006118, -645.448051447586, -1148.9739195812529, -256.2404866127167, -82.11763196127926, -386.6279618603914, -921.9514269921178, -349.39648742270793, -1039.7645542847451, -591.4210750841356, -549.1024516193125, -202.43686821666756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534366135743867, "mean_inference_ms": 1.714164993386033, "mean_action_processing_ms": 0.27400248404649585, "mean_env_wait_ms": 3.5061981302165206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012083768844604492, "StateBufferConnector_ms": 0.014955759048461914, "ViewRequirementAgentConnector_ms": 0.19790124893188477}, "num_episodes": 36, "episode_return_max": -12.052029145355208, "episode_return_min": -1541.616173586684, "episode_return_mean": -472.4343453426856, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.96661844106865, "num_env_steps_trained_throughput_per_sec": 403.96661844106865, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12240.449, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12240.378, "sample_time_ms": 1135.906, "learn_time_ms": 11042.98, "learn_throughput": 362.221, "synch_weights_time_ms": 60.671}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "1e132_00005", "date": "2024-08-04_08-26-48", "timestamp": 1722740208, "time_this_iter_s": 9.914105415344238, "time_total_s": 628.8162648677826, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447bba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 628.8162648677826, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 20.47142857142857, "ram_util_percent": 28.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.40514870683353, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0005000000000000002, "total_loss": 1.7201423855808875, "policy_loss": -0.013205945459776557, "vf_loss": 1.7288640728220344, "vf_explained_var": 0.9975132033228874, "kl": 0.015364319292226989, "entropy": 1.250368647898237, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -12.052029145355208, "episode_reward_min": -1492.5394578207408, "episode_reward_mean": -481.77201824620084, "episode_len_mean": 114.38, "episode_media": {}, "episodes_timesteps_total": 11438, "policy_reward_min": {"policy_0": -1492.5394578207408}, "policy_reward_max": {"policy_0": -12.052029145355208}, "policy_reward_mean": {"policy_0": -481.77201824620084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-615.3858110063267, -419.40906312464045, -74.5728175774133, -258.4293924945902, -601.4785050211968, -776.9937444783393, -126.36507655619931, -1060.4356369332663, -600.5310351122215, -339.77528544183775, -24.287071472971164, -140.96678904853383, -241.79337916902423, -517.1123273183603, -221.08398527757126, -807.5904911758004, -58.30276776441379, -53.25619457316061, -1209.3536319243717, -38.6161750355527, -737.6746433049768, -152.49399901179132, -1127.3116777713044, -31.792441200592613, -218.09953045188848, -843.512202318348, -65.14185909213519, -597.0176186376397, -188.68321948696425, -1149.972116466294, -38.76391664148835, -187.9646689130929, -1164.7722152466476, -79.08405313994508, -227.0159383785422, -33.08720533430431, -1191.7442462207803, -768.9408163353687, -79.19509267440979, -422.90344569227045, -84.5426021138611, -431.10231831506536, -205.00970166834878, -886.4100416346256, -108.03337858635479, -849.6048137792603, -136.78504428062752, -12.052029145355208, -678.1630610962676, -437.46320687531306, -296.30401111558643, -223.20977753769688, -1448.2759967931395, -1020.0312986217829, -171.70449096006118, -645.448051447586, -1148.9739195812529, -256.2404866127167, -82.11763196127926, -386.6279618603914, -921.9514269921178, -349.39648742270793, -1039.7645542847451, -591.4210750841356, -549.1024516193125, -202.43686821666756, -580.1835622216863, -86.58126498395343, -387.0873164500147, -331.5699085239531, -46.55633454011633, -580.125557748577, -27.14240614846796, -124.5516764379154, -1059.2807051746518, -466.2314728907356, -592.3628298761334, -347.9586633327601, -102.50188988888488, -15.117657014273219, -650.5141289030346, -490.9638926748474, -96.99381318369103, -667.6011442066376, -1237.1937312567995, -696.2667621893601, -799.9057165547118, -334.6030019890329, -622.5658241688899, -571.7857595974882, -178.55309423328734, -1099.526439619389, -940.8665769054369, -675.6690405871929, -132.2883679032817, -43.16028760523526, -1382.505822943527, -161.77162183137972, -1492.5394578207408, -501.59332078316385], "episode_lengths": [130, 118, 56, 99, 150, 150, 74, 150, 150, 122, 47, 74, 140, 150, 91, 150, 55, 62, 150, 50, 150, 71, 150, 43, 93, 150, 63, 150, 101, 150, 47, 91, 150, 59, 104, 47, 150, 150, 60, 127, 64, 136, 86, 150, 70, 150, 78, 42, 150, 127, 109, 104, 150, 150, 92, 150, 150, 93, 62, 119, 150, 117, 150, 150, 150, 89, 150, 65, 150, 133, 63, 150, 50, 95, 150, 150, 150, 124, 76, 42, 150, 135, 81, 141, 150, 150, 150, 88, 150, 150, 95, 150, 150, 150, 97, 50, 150, 96, 150, 145], "policy_policy_0_reward": [-615.3858110063267, -419.40906312464045, -74.5728175774133, -258.4293924945902, -601.4785050211968, -776.9937444783393, -126.36507655619931, -1060.4356369332663, -600.5310351122215, -339.77528544183775, -24.287071472971164, -140.96678904853383, -241.79337916902423, -517.1123273183603, -221.08398527757126, -807.5904911758004, -58.30276776441379, -53.25619457316061, -1209.3536319243717, -38.6161750355527, -737.6746433049768, -152.49399901179132, -1127.3116777713044, -31.792441200592613, -218.09953045188848, -843.512202318348, -65.14185909213519, -597.0176186376397, -188.68321948696425, -1149.972116466294, -38.76391664148835, -187.9646689130929, -1164.7722152466476, -79.08405313994508, -227.0159383785422, -33.08720533430431, -1191.7442462207803, -768.9408163353687, -79.19509267440979, -422.90344569227045, -84.5426021138611, -431.10231831506536, -205.00970166834878, -886.4100416346256, -108.03337858635479, -849.6048137792603, -136.78504428062752, -12.052029145355208, -678.1630610962676, -437.46320687531306, -296.30401111558643, -223.20977753769688, -1448.2759967931395, -1020.0312986217829, -171.70449096006118, -645.448051447586, -1148.9739195812529, -256.2404866127167, -82.11763196127926, -386.6279618603914, -921.9514269921178, -349.39648742270793, -1039.7645542847451, -591.4210750841356, -549.1024516193125, -202.43686821666756, -580.1835622216863, -86.58126498395343, -387.0873164500147, -331.5699085239531, -46.55633454011633, -580.125557748577, -27.14240614846796, -124.5516764379154, -1059.2807051746518, -466.2314728907356, -592.3628298761334, -347.9586633327601, -102.50188988888488, -15.117657014273219, -650.5141289030346, -490.9638926748474, -96.99381318369103, -667.6011442066376, -1237.1937312567995, -696.2667621893601, -799.9057165547118, -334.6030019890329, -622.5658241688899, -571.7857595974882, -178.55309423328734, -1099.526439619389, -940.8665769054369, -675.6690405871929, -132.2883679032817, -43.16028760523526, -1382.505822943527, -161.77162183137972, -1492.5394578207408, -501.59332078316385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536463171753334, "mean_inference_ms": 1.7134883790297832, "mean_action_processing_ms": 0.27375760920561915, "mean_env_wait_ms": 3.5056978844436744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012276411056518555, "StateBufferConnector_ms": 0.014943838119506836, "ViewRequirementAgentConnector_ms": 0.1969141960144043}, "num_episodes": 34, "episode_return_max": -12.052029145355208, "episode_return_min": -1492.5394578207408, "episode_return_mean": -481.77201824620084, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.918245565988, "num_env_steps_trained_throughput_per_sec": 310.918245565988, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12223.406, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12223.335, "sample_time_ms": 1132.573, "learn_time_ms": 11029.549, "learn_throughput": 362.662, "synch_weights_time_ms": 60.395}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "training_iteration": 50, "trial_id": "1e132_00005", "date": "2024-08-04_08-27-01", "timestamp": 1722740221, "time_this_iter_s": 12.877693891525269, "time_total_s": 641.6939587593079, "pid": 610570, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.92, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x74d3447baa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 641.6939587593079, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.099999999999998, "ram_util_percent": 28.3}}
